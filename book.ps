%!PS-Adobe-2.0
%%Creator: dvips(k) 5.98 Copyright 2009 Radical Eye Software
%%Title: book.dvi
%%CreationDate: Sun Nov  4 16:25:00 2012
%%Pages: 390
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Helvetica-Bold Times-Bold Times-Roman Times-Italic
%%+ Courier Times-BoldItalic Courier-Bold Courier-Oblique
%%DocumentPaperSizes: Letter
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -R -q -t letter book.dvi -o book.ps
%DVIPSParameters: dpi=600
%DVIPSSource:  TeX output 2012.11.04:1624
%%BeginProcSet: tex.pro 0 0
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/CharBuilder{save 3 1 roll S A/base get 2 index get S
/BitMaps get S get/Cd X pop/ctr 0 N Cdx 0 Cx Cy Ch sub Cx Cw add Cy
setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx sub Cy .1 sub]{Ci}imagemask
restore}B/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc 0 0
% File 8r.enc  TeX Base 1 Encoding  Revision 2.0  2002-10-30
%
% @@psencodingfile@{
%   author    = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry,
%                W. Schmidt, P. Lehman",
%   version   = "2.0",
%   date      = "27nov06",
%   filename  = "8r.enc",
%   email     = "tex-fonts@@tug.org",
%   docstring = "This is the encoding vector for Type1 and TrueType
%                fonts to be used with TeX.  This file is part of the
%                PSNFSS bundle, version 9"
% @}
% 
% The idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard encoding, ISO Latin 1, Windows ANSI including the euro symbol,
% MacRoman, and some extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% These are /dotlessj /ff /ffi /ffl.
% 
% (4) hyphen appears twice for compatibility with both ASCII and Windows.
%
% (5) /Euro was assigned to 128, as in Windows ANSI
%
% (6) Missing characters from MacRoman encoding incorporated as follows:
%
%     PostScript      MacRoman        TeXBase1
%     --------------  --------------  --------------
%     /notequal       173             0x16
%     /infinity       176             0x17
%     /lessequal      178             0x18
%     /greaterequal   179             0x19
%     /partialdiff    182             0x1A
%     /summation      183             0x1B
%     /product        184             0x1C
%     /pi             185             0x1D
%     /integral       186             0x81
%     /Omega          189             0x8D
%     /radical        195             0x8E
%     /approxequal    197             0x8F
%     /Delta          198             0x9D
%     /lozenge        215             0x9E
%
/TeXBase1Encoding [
% 0x00
 /.notdef /dotaccent /fi /fl
 /fraction /hungarumlaut /Lslash /lslash
 /ogonek /ring /.notdef /breve
 /minus /.notdef /Zcaron /zcaron
% 0x10
 /caron /dotlessi /dotlessj /ff
 /ffi /ffl /notequal /infinity
 /lessequal /greaterequal /partialdiff /summation
 /product /pi /grave /quotesingle
% 0x20
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus
 /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three
 /four /five /six /seven
 /eight /nine /colon /semicolon
 /less /equal /greater /question
% 0x40
 /at /A /B /C
 /D /E /F /G
 /H /I /J /K
 /L /M /N /O
% 0x50
 /P /Q /R /S
 /T /U /V /W
 /X /Y /Z /bracketleft
 /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c
 /d /e /f /g
 /h /i /j /k
 /l /m /n /o
% 0x70
 /p /q /r /s
 /t /u /v /w
 /x /y /z /braceleft
 /bar /braceright /asciitilde /.notdef
% 0x80
 /Euro /integral /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /Omega /radical /approxequal
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /Delta /lozenge /Ydieresis
% 0xA0
 /.notdef /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot /hyphen /registered /macron
% 0xB0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde
 /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def


%%EndProcSet
%%BeginProcSet: texps.pro 0 0
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]FontType 0
ne{/Metrics exch def dict begin Encoding{exch dup type/integertype ne{
pop pop 1 sub dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get
div def}ifelse}forall Metrics/Metrics currentdict end def}{{1 index type
/nametype eq{exit}if exch pop}loop}ifelse[2 index currentdict end
definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{dup
sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1 roll
mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def dup[
exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}if}
forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}def
end

%%EndProcSet
%%BeginProcSet: special.pro 0 0
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/setpagedevice{pop}N/copypage{}N/p 3 def
@MacSetUp}N/doclip{psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll
newpath 4 copy 4 2 roll moveto 6 -1 roll S lineto S lineto S lineto
closepath clip newpath moveto}N/endTexFig{end psf$SavedState restore}N
/@beginspecial{SDict begin/SpecialSave save N gsave normalscale
currentpoint TR @SpecialDefaults count/ocount X/dcount countdictstack N}
N/@setspecial{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs
neg 0 rlineto closepath clip}if ho vo TR hsc vsc scale ang rotate
rwiSeen{rwi urx llx sub div rhiSeen{rhi ury lly sub div}{dup}ifelse
scale llx neg lly neg TR}{rhiSeen{rhi ury lly sub div dup scale llx neg
lly neg TR}if}ifelse CLIP 2 eq{newpath llx lly moveto urx lly lineto urx
ury lineto llx ury lineto closepath clip}if/showpage{}N/erasepage{}N
/setpagedevice{pop}N/copypage{}N newpath}N/@endspecial{count ocount sub{
pop}repeat countdictstack dcount sub{end}repeat grestore SpecialSave
restore end}N/@defspecial{SDict begin}N/@fedspecial{end}B/li{lineto}B
/rl{rlineto}B/rc{rcurveto}B/np{/SaveX currentpoint/SaveY X N 1
setlinecap newpath}N/st{stroke SaveX SaveY moveto}N/fil{fill SaveX SaveY
moveto}N/ellipse{/endangle X/startangle X/yrad X/xrad X/savematrix
matrix currentmatrix N TR xrad yrad scale 0 0 1 startangle endangle arc
savematrix setmatrix}N end

%%EndProcSet
%%BeginProcSet: color.pro 0 0
%!
TeXDict begin/setcmykcolor where{pop}{/setcmykcolor{dup 10 eq{pop
setrgbcolor}{1 sub 4 1 roll 3{3 index add neg dup 0 lt{pop 0}if 3 1 roll
}repeat setrgbcolor pop}ifelse}B}ifelse/TeXcolorcmyk{setcmykcolor}def
/TeXcolorrgb{setrgbcolor}def/TeXcolorgrey{setgray}def/TeXcolorgray{
setgray}def/TeXcolorhsb{sethsbcolor}def/currentcmykcolor where{pop}{
/currentcmykcolor{currentrgbcolor 10}B}ifelse/DC{exch dup userdict exch
known{pop pop}{X}ifelse}B/GreenYellow{0.15 0 0.69 0 setcmykcolor}DC
/Yellow{0 0 1 0 setcmykcolor}DC/Goldenrod{0 0.10 0.84 0 setcmykcolor}DC
/Dandelion{0 0.29 0.84 0 setcmykcolor}DC/Apricot{0 0.32 0.52 0
setcmykcolor}DC/Peach{0 0.50 0.70 0 setcmykcolor}DC/Melon{0 0.46 0.50 0
setcmykcolor}DC/YellowOrange{0 0.42 1 0 setcmykcolor}DC/Orange{0 0.61
0.87 0 setcmykcolor}DC/BurntOrange{0 0.51 1 0 setcmykcolor}DC
/Bittersweet{0 0.75 1 0.24 setcmykcolor}DC/RedOrange{0 0.77 0.87 0
setcmykcolor}DC/Mahogany{0 0.85 0.87 0.35 setcmykcolor}DC/Maroon{0 0.87
0.68 0.32 setcmykcolor}DC/BrickRed{0 0.89 0.94 0.28 setcmykcolor}DC/Red{
0 1 1 0 setcmykcolor}DC/OrangeRed{0 1 0.50 0 setcmykcolor}DC/RubineRed{
0 1 0.13 0 setcmykcolor}DC/WildStrawberry{0 0.96 0.39 0 setcmykcolor}DC
/Salmon{0 0.53 0.38 0 setcmykcolor}DC/CarnationPink{0 0.63 0 0
setcmykcolor}DC/Magenta{0 1 0 0 setcmykcolor}DC/VioletRed{0 0.81 0 0
setcmykcolor}DC/Rhodamine{0 0.82 0 0 setcmykcolor}DC/Mulberry{0.34 0.90
0 0.02 setcmykcolor}DC/RedViolet{0.07 0.90 0 0.34 setcmykcolor}DC
/Fuchsia{0.47 0.91 0 0.08 setcmykcolor}DC/Lavender{0 0.48 0 0
setcmykcolor}DC/Thistle{0.12 0.59 0 0 setcmykcolor}DC/Orchid{0.32 0.64 0
0 setcmykcolor}DC/DarkOrchid{0.40 0.80 0.20 0 setcmykcolor}DC/Purple{
0.45 0.86 0 0 setcmykcolor}DC/Plum{0.50 1 0 0 setcmykcolor}DC/Violet{
0.79 0.88 0 0 setcmykcolor}DC/RoyalPurple{0.75 0.90 0 0 setcmykcolor}DC
/BlueViolet{0.86 0.91 0 0.04 setcmykcolor}DC/Periwinkle{0.57 0.55 0 0
setcmykcolor}DC/CadetBlue{0.62 0.57 0.23 0 setcmykcolor}DC
/CornflowerBlue{0.65 0.13 0 0 setcmykcolor}DC/MidnightBlue{0.98 0.13 0
0.43 setcmykcolor}DC/NavyBlue{0.94 0.54 0 0 setcmykcolor}DC/RoyalBlue{1
0.50 0 0 setcmykcolor}DC/Blue{1 1 0 0 setcmykcolor}DC/Cerulean{0.94 0.11
0 0 setcmykcolor}DC/Cyan{1 0 0 0 setcmykcolor}DC/ProcessBlue{0.96 0 0 0
setcmykcolor}DC/SkyBlue{0.62 0 0.12 0 setcmykcolor}DC/Turquoise{0.85 0
0.20 0 setcmykcolor}DC/TealBlue{0.86 0 0.34 0.02 setcmykcolor}DC
/Aquamarine{0.82 0 0.30 0 setcmykcolor}DC/BlueGreen{0.85 0 0.33 0
setcmykcolor}DC/Emerald{1 0 0.50 0 setcmykcolor}DC/JungleGreen{0.99 0
0.52 0 setcmykcolor}DC/SeaGreen{0.69 0 0.50 0 setcmykcolor}DC/Green{1 0
1 0 setcmykcolor}DC/ForestGreen{0.91 0 0.88 0.12 setcmykcolor}DC
/PineGreen{0.92 0 0.59 0.25 setcmykcolor}DC/LimeGreen{0.50 0 1 0
setcmykcolor}DC/YellowGreen{0.44 0 0.74 0 setcmykcolor}DC/SpringGreen{
0.26 0 0.76 0 setcmykcolor}DC/OliveGreen{0.64 0 0.95 0.40 setcmykcolor}
DC/RawSienna{0 0.72 1 0.45 setcmykcolor}DC/Sepia{0 0.83 1 0.70
setcmykcolor}DC/Brown{0 0.81 1 0.60 setcmykcolor}DC/Tan{0.14 0.42 0.56 0
setcmykcolor}DC/Gray{0 0 0 0.50 setcmykcolor}DC/Black{0 0 0 1
setcmykcolor}DC/White{0 0 0 0 setcmykcolor}DC end

%%EndProcSet
TeXDict begin @defspecial

 systemdict /pdfmark known{userdict /?pdfmark systemdict /exec get
put}{userdict /?pdfmark systemdict /pop get put userdict /pdfmark systemdict
/cleartomark get put}ifelse

 /DvipsToPDF{72.27 mul Resolution div} def/PDFToDvips{72.27 div Resolution
mul} def/BPToDvips{72 div Resolution mul}def/BorderArrayPatch{[exch{dup
dup type/integertype eq exch type/realtype eq or{BPToDvips}if}forall]}def/HyperBorder
{1 PDFToDvips} def/H.V {pdf@hoff pdf@voff null} def/H.B {/Rect[pdf@llx
pdf@lly pdf@urx pdf@ury]} def/H.S {currentpoint HyperBorder add /pdf@lly
exch def dup DvipsToPDF 72 add /pdf@hoff exch def HyperBorder sub /pdf@llx
exch def} def/H.L {2 sub dup/HyperBasePt exch def PDFToDvips /HyperBaseDvips
exch def currentpoint HyperBaseDvips sub /pdf@ury exch def/pdf@urx
exch def} def/H.A {H.L currentpoint exch pop vsize 72 sub exch DvipsToPDF
HyperBasePt sub sub /pdf@voff exch def} def/H.R {currentpoint HyperBorder
sub /pdf@ury exch def HyperBorder add /pdf@urx exch def currentpoint
exch pop vsize 72 sub exch DvipsToPDF sub /pdf@voff exch def} def
 
@fedspecial end TeXDict begin
40258431 52099146 1000 600 600 (book.dvi) @start /Fa
133[33 37 37 54 37 37 21 29 25 37 37 37 37 58 21 37 21
21 37 37 25 33 37 33 37 33 7[54 54 71 54 54 46 42 50
54 42 54 54 66 46 2[25 54 54 42 46 54 50 50 54 5[21 21
37 37 1[37 1[37 37 37 37 37 21 19 25 19 2[25 25 25 4[30
31[42 2[{TeXBase1Encoding ReEncodeFont}68 74.7198 /Times-Roman
rf /Fb 133[45 8[45 45 45 1[45 45 12[45 53[45 45 40[{
TeXBase1Encoding ReEncodeFont}9 74.7198 /Courier-Oblique
rf /Fc 133[45 45 45 45 2[45 45 45 45 45 45 45 45 3[45
3[45 45 45 5[45 1[45 39[45 5[45 45[{TeXBase1Encoding ReEncodeFont}20
74.7198 /Courier-Bold rf /Fd 39[93 93[60 66 66 93 66
73 40 66 47 73 73 73 73 106 33 66 1[33 73 73 40 66 73
66 73 66 6[73 80 1[113 80 86 73 80 86 93 80 93 86 100
73 86 66 33 86 93 73 80 86 86 86 86 1[73 4[40 66 66 66
66 66 66 66 66 66 66 33 33 40 33 2[40 40 33 35[73 73
2[{TeXBase1Encoding ReEncodeFont}72 119.552 /Helvetica-Bold
rf /Fe 106[23 149[{TeXBase1Encoding ReEncodeFont}1 66.4176
/Times-Roman rf /Ff 136[55 1[46 23 4[42 5[23 46 104[{
TeXBase1Encoding ReEncodeFont}6 83.022 /Times-BoldItalic
rf /Fg 60[45 25[45 20[45 21[45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 1[45 45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 33[{
TeXBase1Encoding ReEncodeFont}96 74.7198 /Courier rf
/Fh 39[112 93[72 80 80 112 80 88 48 80 56 88 88 88 88
128 40 80 40 40 88 88 48 80 88 80 88 80 6[88 96 1[135
96 104 88 96 104 112 96 112 104 120 88 104 1[40 104 112
88 96 104 104 104 104 1[88 4[48 80 80 80 80 80 80 80
80 80 80 40 40 48 40 2[48 48 5[68 48 33[{TeXBase1Encoding ReEncodeFont}
71 143.462 /Helvetica-Bold rf /Fi 7[42 31[60 93[32 37
37 55 37 42 23 32 32 42 42 42 42 60 23 37 23 23 42 42
23 37 42 37 42 42 9[69 1[60 46 42 51 60 51 60 55 69 46
55 1[28 60 60 51 51 60 55 51 51 1[42 4[28 42 42 42 42
42 42 42 42 42 42 1[21 28 21 4[28 5[28 29[42 42 2[{
TeXBase1Encoding ReEncodeFont}68 83.022 /Times-Italic
rf /Fj 7[42 1[42 13[37 15[60 14[51 3[60 48[37 21[45 40
1[40 37 42 42 60 42 42 23 32 28 42 42 42 42 65 23 42
23 23 42 42 28 37 42 37 42 37 1[42 1[28 1[28 51 60 60
78 60 60 51 46 55 60 46 60 60 74 51 60 32 28 60 60 46
51 60 55 55 60 1[37 1[47 1[23 23 42 42 42 42 42 42 42
42 42 42 23 21 28 21 47 42 28 28 28 65 69 42 42 34 28
29[46 46 2[{TeXBase1Encoding ReEncodeFont}96 83.022 /Times-Roman
rf /Fk 39[65 93[37 42 42 60 42 46 28 32 37 46 46 42 46
69 23 46 28 23 46 42 28 37 46 37 46 42 6[55 2[83 60 60
55 46 60 65 51 65 60 78 55 65 42 32 65 65 51 55 60 60
55 60 7[42 42 42 42 42 42 42 42 42 42 1[21 28 21 2[28
28 28 35[46 46 2[{TeXBase1Encoding ReEncodeFont}69 83.022
/Times-Bold rf /Fl 39[134 94[96 2[96 105 57 96 67 105
105 105 105 153 48 96 1[48 105 105 57 96 105 96 105 96
11[124 105 115 124 134 115 2[143 105 3[124 1[105 1[124
124 124 124 7[96 96 96 96 96 96 96 96 96 2[48 57 45[{
TeXBase1Encoding ReEncodeFont}48 172.154 /Helvetica-Bold
rf /Fm 137[46 51 1[46 32 1[51 51 2[23 2[23 51 1[28 46
51 9[51 5[51 2[65 55 2[69 4[60 65 2[60 22[28 45[{
TeXBase1Encoding ReEncodeFont}21 83.022 /Helvetica-Bold
rf /Fn 137[115 126 1[115 80 1[126 126 2[57 2[57 126 1[69
115 126 9[126 5[126 2[161 138 2[172 4[149 161 2[149 22[69
45[{TeXBase1Encoding ReEncodeFont}21 206.584 /Helvetica-Bold
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%BeginPaperSize: Letter
/setpagedevice where
{ pop << /PageSize [612 792] >> setpagedevice }
{ /letter where { pop letter } if }
ifelse
%%EndPaperSize
 end
%%EndSetup
%%Page: 1 1
TeXDict begin 1 0 bop -600 -600 a
SDict begin [/Producer (dvips + Distiller)/Title ()/Subject ()/Creator
(LaTeX with hyperref package)/Author ()/Keywords () /DOCINFO pdfmark
end
 -600 -600 a -600 -600
a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray -611 -810 a
SDict begin H.S end
 -611 -810 a
0 TeXcolorgray 0 TeXcolorgray -611 -810 a
SDict begin H.R end
 -611 -810 a
-611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.1) cvn /DEST pdfmark end
 -611 -810 a Black Black Black -2 -11 a
SDict begin [/Count -0/Dest (1.0) cvn/Title (The ZeroMQ Guide for PHP Developers)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (2.0) cvn/Title (Dedication) /OUT pdfmark
end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (3.0) cvn/Title (Table of Contents) /OUT
pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (4.0) cvn/Title (List of Figures) /OUT
pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -5/Dest (5.0) cvn/Title (Preface) /OUT pdfmark
end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (5.1.1) cvn/Title (1. \330MQ in a Hundred Words)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (5.2.1) cvn/Title (2. The Zen of Zero)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (5.3.1) cvn/Title (3. How the Guide Happened)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (5.4.1) cvn/Title (4. Audience) /OUT pdfmark
end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (5.5.1) cvn/Title (5. Acknowledgements)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -13/Dest (6.0) cvn/Title (Chapter 1. Basics) /OUT
pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.6.1) cvn/Title (1.1. Fixing the World)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.7.1) cvn/Title (1.2. Audience for This Book)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (6.8.1) cvn/Title (1.3. Getting the Examples)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.9.1) cvn/Title (1.4. Ask and Ye Shall Receive)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.10.1) cvn/Title (1.5. A Minor Note on Strings)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (6.11.1) cvn/Title (1.6. Version Reporting)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.12.1) cvn/Title (1.7. Getting the Message Out)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.13.1) cvn/Title (1.8. Divide and Conquer)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -2/Dest (6.14.1) cvn/Title (1.9. Programming with \330MQ)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.14.1.2) cvn/Title (1.9.1. Getting the Context Right)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.14.2.2) cvn/Title (1.9.2. Making a Clean Exit)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (6.15.1) cvn/Title (1.10. Why We Needed \330MQ)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.16.1) cvn/Title (1.11. Socket Scalability)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (6.17.1) cvn/Title (1.12. Upgrading from \330MQ/2.2 to \330MQ/3.2)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (6.18.1) cvn/Title (1.13. Warning Unstable Paradigms!)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -12/Dest (7.0) cvn/Title (Chapter 2. Sockets and Patterns)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -5/Dest (7.19.1) cvn/Title (2.1. The Socket API)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.19.3.2) cvn/Title (2.1.1. Plugging Sockets Into the Topology)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.19.4.2) cvn/Title (2.1.2. Using Sockets to Carry Data)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.19.5.2) cvn/Title (2.1.3. Unicast Transports)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.19.6.2) cvn/Title (2.1.4. \330MQ is Not a Neutral Carrier)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.19.7.2) cvn/Title (2.1.5. I/O Threads)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -9/Dest (7.20.1) cvn/Title (2.2. Messaging Patterns)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.8.2) cvn/Title (2.2.1. Highlevel Messaging Patterns)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.9.2) cvn/Title (2.2.2. Working with Messages)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.10.2) cvn/Title (2.2.3. Handling Multiple Sockets)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.11.2) cvn/Title (2.2.4. Multipart Messages)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.12.2) cvn/Title (2.2.5. Intermediaries and Proxies)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.13.2) cvn/Title (2.2.6. The Dynamic Discovery Problem)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.14.2) cvn/Title (2.2.7. Shared Queue \(DEALER and ROUTER sockets\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.15.2) cvn/Title (2.2.8. \330MQ's Builtin Proxy Function)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.20.16.2) cvn/Title (2.2.9. Transport Bridging)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.21.1) cvn/Title (2.3. Handling Errors and ETERM)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.22.1) cvn/Title (2.4. Handling Interrupt Signals)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.23.1) cvn/Title (2.5. Detecting Memory Leaks)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.24.1) cvn/Title (2.6. Multithreading with \330MQ)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.25.1) cvn/Title (2.7. Signaling between Threads \(PAIR sockets\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.26.1) cvn/Title (2.8. Node Coordination)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.27.1) cvn/Title (2.9. Zero Copy) /OUT
pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.28.1) cvn/Title (2.10. PubSub Message Envelopes)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (7.29.1) cvn/Title (2.11. High Water Marks)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (7.30.1) cvn/Title (2.12. Missing Message Problem Solver)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -9/Dest (8.0) cvn/Title (Chapter 3. Advanced RequestReply Patterns)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.31.1) cvn/Title (3.1. RequestReply Envelopes)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (8.32.1) cvn/Title (3.2. Custom RequestReply Routing)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.33.1) cvn/Title (3.3. ROUTERtoDEALER Routing)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.34.1) cvn/Title (3.4. LeastRecently Used Routing \(LRU Pattern\))
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (8.35.1) cvn/Title (3.5. Addressbased Routing)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.36.1) cvn/Title (3.6. A RequestReply Message Broker)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.37.1) cvn/Title (3.7. A HighLevel API for \330MQ)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (8.38.1) cvn/Title (3.8. Asynchronous ClientServer)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -8/Dest (8.39.1) cvn/Title (3.9. Worked Example: InterBroker Routing)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.17.2) cvn/Title (3.9.1. Establishing the Details)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.18.2) cvn/Title (3.9.2. Architecture of a Single Cluster)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.19.2) cvn/Title (3.9.3. Scaling to Multiple Clusters)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.20.2) cvn/Title (3.9.4. Federation vs. Peering)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.21.2) cvn/Title (3.9.5. The Naming Ceremony)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.22.2) cvn/Title (3.9.6. Prototyping the State Flow)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.23.2) cvn/Title (3.9.7. Prototyping the Local and Cloud Flows)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (8.39.24.2) cvn/Title (3.9.8. Putting it All Together)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -15/Dest (9.0) cvn/Title (Chapter 4. Reliable RequestReply Patterns)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.40.1) cvn/Title (4.1. What is "Reliability"?)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.41.1) cvn/Title (4.2. Designing Reliability)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.42.1) cvn/Title (4.3. Clientside Reliability \(Lazy Pirate Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.43.1) cvn/Title (4.4. Basic Reliable Queuing \(Simple Pirate Pattern\))
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.44.1) cvn/Title (4.5. Robust Reliable Queuing \(Paranoid Pirate Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.45.1) cvn/Title (4.6. Heartbeating)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.46.1) cvn/Title (4.7. Contracts and Protocols)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.47.1) cvn/Title (4.8. ServiceOriented Reliable Queuing \(Majordomo Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.48.1) cvn/Title (4.9. Asynchronous Majordomo Pattern)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.49.1) cvn/Title (4.10. Service Discovery)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.50.1) cvn/Title (4.11. Idempotent Services)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.51.1) cvn/Title (4.12. Disconnected Reliability \(Titanic Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -5/Dest (9.52.1) cvn/Title (4.13. Highavailability Pair \(Binary Star Pattern\))
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.52.25.2) cvn/Title (4.13.1. Overview)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.52.26.2) cvn/Title (4.13.2. Detailed Requirements)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.52.27.2) cvn/Title (4.13.3. Preventing SplitBrain Syndrome)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.52.28.2) cvn/Title (4.13.4. Binary Star Implementation)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.52.29.2) cvn/Title (4.13.5. Binary Star Reactor)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -3/Dest (9.53.1) cvn/Title (4.14. Brokerless Reliability \(Freelance Pattern\))
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.53.30.2) cvn/Title (4.14.1. Model One Simple Retry and Failover)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.53.31.2) cvn/Title (4.14.2. Model Two Brutal Shotgun Massacre)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (9.53.32.2) cvn/Title (4.14.3. Model Three Complex and Nasty)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (9.54.1) cvn/Title (4.15. Conclusion) /OUT
pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -5/Dest (10.0) cvn/Title (Chapter 5. Advanced PublishSubscribe Patterns)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.55.1) cvn/Title (5.1. Slow Subscriber Detection \(Suicidal Snail Pattern\))
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (10.56.1) cvn/Title (5.2. Highspeed Subscribers \(Black Box Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -7/Dest (10.57.1) cvn/Title (5.3. A Shared KeyValue Cache \(Clone Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.33.2) cvn/Title (5.3.1. Distributing KeyValue Updates)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.34.2) cvn/Title (5.3.2. Getting a Snapshot)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.35.2) cvn/Title (5.3.3. Republishing Updates)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.36.2) cvn/Title (5.3.4. Clone Subtrees)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.37.2) cvn/Title (5.3.5. Ephemeral Values)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.38.2) cvn/Title (5.3.6. Clone Server Reliability)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.57.39.2) cvn/Title (5.3.7. Clone Protocol Specification)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (10.58.1) cvn/Title (5.4. The Espresso Pattern)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (10.59.1) cvn/Title (5.5. Last Value Caching)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -14/Dest (11.0) cvn/Title (Chapter 6. The Human Scale)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.60.1) cvn/Title (6.1. The Tale of Two Bridges)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.61.1) cvn/Title (6.2. Code on the Human Scale)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.62.1) cvn/Title (6.3. Psychology of Software Development)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -3/Dest (11.63.1) cvn/Title (6.4. The Bad, the Ugly, and the Delicious)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.63.40.2) cvn/Title (6.4.1. TrashOriented Design)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.63.41.2) cvn/Title (6.4.2. ComplexityOriented Design)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.63.42.2) cvn/Title (6.4.3. SimplicityOriented Design)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -5/Dest (11.64.1) cvn/Title (6.5. Message Oriented Pattern for Elastic Design)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.64.43.2) cvn/Title (6.5.1. Step 1: Internalize the Semantics)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.64.44.2) cvn/Title (6.5.2. Step 2: Draw a Rough Architecture)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.64.45.2) cvn/Title (6.5.3. Step 3: Decide on the Contracts)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.64.46.2) cvn/Title (6.5.4. Step 4: Write a Minimal EndtoEnd Solution)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.64.47.2) cvn/Title (6.5.5. Step 5: Solve One Problem and Repeat)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -4/Dest (11.65.1) cvn/Title (6.6. Unprotocols)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.65.48.2) cvn/Title (6.6.1. Why Unprotocols?)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.65.49.2) cvn/Title (6.6.2. How to Write Unprotocols)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.65.50.2) cvn/Title (6.6.3. Why use the GPLv3 for Public Specifications?)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.65.51.2) cvn/Title (6.6.4. Using ABNF)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -6/Dest (11.66.1) cvn/Title (6.7. Serializing your Data)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.66.52.2) cvn/Title (6.7.1. Cheap and Nasty)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.66.53.2) cvn/Title (6.7.2. \330MQ Framing)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.66.54.2) cvn/Title (6.7.3. Serialization Languages)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.66.55.2) cvn/Title (6.7.4. Serialization Libraries)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.66.56.2) cvn/Title (6.7.5. Handwritten Binary Serialization)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.66.57.2) cvn/Title (6.7.6. Code Generation)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.67.1) cvn/Title (6.8. Transferring Files)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -3/Dest (11.68.1) cvn/Title (6.9. Heartbeating)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.68.58.2) cvn/Title (6.9.1. Shrugging It Off)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.68.59.2) cvn/Title (6.9.2. OneWay Heartbeats)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.68.60.2) cvn/Title (6.9.3. PingPong Heartbeats)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.69.1) cvn/Title (6.10. State Machines)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.70.1) cvn/Title (6.11. Authentication using SASL)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -9/Dest (11.71.1) cvn/Title (6.12. Largescale File Publishing)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.61.2) cvn/Title (6.12.1. Why make FileMQ?)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.62.2) cvn/Title (6.12.2. Initial Design Cut the API)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.63.2) cvn/Title (6.12.3. Initial Design Cut the Protocol)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.64.2) cvn/Title (6.12.4. Building and Trying FileMQ)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.65.2) cvn/Title (6.12.5. Internal Architecture)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.66.2) cvn/Title (6.12.6. Public API)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.67.2) cvn/Title (6.12.7. Design Notes)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.68.2) cvn/Title (6.12.8. Reliabilty)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.71.69.2) cvn/Title (6.12.9. Configuration)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (11.72.1) cvn/Title (6.13. File Stability)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (11.73.1) cvn/Title (6.14. Test Use Case)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -8/Dest (12.0) cvn/Title (Chapter 7. The \330MQ Community)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.74.1) cvn/Title (7.1. Architecture of the \330MQ Community)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -7/Dest (12.75.1) cvn/Title (7.2. How to Make Really Large Architectures)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.70.2) cvn/Title (7.2.1. The Game)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.71.2) cvn/Title (7.2.2. The Contract)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.72.2) cvn/Title (7.2.3. The Process)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.73.2) cvn/Title (7.2.4. Crazy, Beautiful, and Easy)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.74.2) cvn/Title (7.2.5. Stranger, meet Stranger)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.75.2) cvn/Title (7.2.6. Infinite Property)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.75.76.2) cvn/Title (7.2.7. Care and Feeding)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -8/Dest (12.76.1) cvn/Title (7.3. The \330MQ Process C4)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.77.2) cvn/Title (7.3.1. Language)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.78.2) cvn/Title (7.3.2. Goals) /OUT
pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.79.2) cvn/Title (7.3.3. Preliminaries)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.80.2) cvn/Title (7.3.4. Licensing and Ownership)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.81.2) cvn/Title (7.3.5. Patch Requirements)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.82.2) cvn/Title (7.3.6. Development Process)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.83.2) cvn/Title (7.3.7. Creating Stable Releases)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.76.84.2) cvn/Title (7.3.8. Evolution of Public Contracts)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.77.1) cvn/Title (7.4. Worked Example)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -12/Dest (12.78.1) cvn/Title (7.5. Git Branches Considered Harmful)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.85.2) cvn/Title (7.5.1. Simplicity vs. Complexity)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.86.2) cvn/Title (7.5.2. Change Latency)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.87.2) cvn/Title (7.5.3. Learning Curve)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.88.2) cvn/Title (7.5.4. Cost of Failure)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.89.2) cvn/Title (7.5.5. Upfront Coordination)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.90.2) cvn/Title (7.5.6. Scalability)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.91.2) cvn/Title (7.5.7. Surprise and Expectations)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.92.2) cvn/Title (7.5.8. Economics of Participation)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.93.2) cvn/Title (7.5.9. Robustness in Conflict)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.94.2) cvn/Title (7.5.10. Guarantees of Isolation)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.95.2) cvn/Title (7.5.11. Visibility)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.78.96.2) cvn/Title (7.5.12. Conclusions)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.79.1) cvn/Title (7.6. The Myth of Intelligent Design)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.80.1) cvn/Title (7.7. Burnout) /OUT
pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -16/Dest (12.81.1) cvn/Title (7.8. Patterns for The Game)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.97.2) cvn/Title (7.8.1. The Lazy Perfectionist)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.98.2) cvn/Title (7.8.2. The Benevolent Tyrant)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.99.2) cvn/Title (7.8.3. The Earth and Sky)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.100.2) cvn/Title (7.8.4. The Open Door)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.101.2) cvn/Title (7.8.5. The Laughing Clown)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.102.2) cvn/Title (7.8.6. The Mindful General)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.103.2) cvn/Title (7.8.7. The Social Engineer)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.104.2) cvn/Title (7.8.8. The Constant Gardener)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.105.2) cvn/Title (7.8.9. The Rolling Stone)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.106.2) cvn/Title (7.8.10. The Pirate Gang)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.107.2) cvn/Title (7.8.11. The Flash Mob)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.108.2) cvn/Title (7.8.12. The Canary Watcher)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.109.2) cvn/Title (7.8.13. The Hangman)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.110.2) cvn/Title (7.8.14. The Historian)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.111.2) cvn/Title (7.8.15. The Provocateur)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (12.81.112.2) cvn/Title (7.8.16. The Mystic)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -8/Dest (13.0) cvn/Title (Chapter 8. A Universe of Moving Pieces)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.82.1) cvn/Title (8.1. Design for The Real World)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -4/Dest (13.83.1) cvn/Title (8.2. The Secret Life of WiFi)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.83.113.2) cvn/Title (8.2.1. Why Mesh isn't Here Yet)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.83.114.2) cvn/Title (8.2.2. Some Physics)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.83.115.2) cvn/Title (8.2.3. What's the Current Status?)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.83.116.2) cvn/Title (8.2.4. Conclusions)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -5/Dest (13.84.1) cvn/Title (8.3. Discovery) /OUT
pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.84.117.2) cvn/Title (8.3.1. Preemptive Discovery over Raw Sockets)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.84.118.2) cvn/Title (8.3.2. Cooperative Discovery using UDP Broadcasts)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.84.119.2) cvn/Title (8.3.3. Multiple Nodes on One Device)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.84.120.2) cvn/Title (8.3.4. Designing the API)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.84.121.2) cvn/Title (8.3.5. More about UDP)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.85.1) cvn/Title (8.4. Spinning off a Library Project)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -3/Dest (13.86.1) cvn/Title (8.5. Pointtopoint Messaging)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.86.122.2) cvn/Title (8.5.1. UDP Beacon Framing)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.86.123.2) cvn/Title (8.5.2. True Peer Connectivity \(Harmony Pattern\))
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.86.124.2) cvn/Title (8.5.3. Detecting Disappearances)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.87.1) cvn/Title (8.6. Group Messaging)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -6/Dest (13.88.1) cvn/Title (8.7. Testing and Simulation)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.88.125.2) cvn/Title (8.7.1. On Assertions)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.88.126.2) cvn/Title (8.7.2. On Upfront Testing)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.88.127.2) cvn/Title (8.7.3. The ZyRE Tester)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.88.128.2) cvn/Title (8.7.4. Test Results)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (13.88.129.2) cvn/Title (8.7.5. Tracing Activity)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.88.130.2) cvn/Title (8.7.6. Dealing with Blocked Peers)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (13.89.1) cvn/Title (8.8. More Coming Soon)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -4/Dest (14.0) cvn/Title (Chapter 9. Postface)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -4/Dest (14.90.1) cvn/Title (9.1. Tales from Out There)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (14.90.131.2) cvn/Title (9.1.1. Rob Gagnon's Story)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (14.90.132.2) cvn/Title (9.1.2. Tom van Leeuwen's Story)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (14.90.133.2) cvn/Title (9.1.3. Michael Jakl's Story)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (14.90.134.2) cvn/Title (9.1.4. Vadim Shalts's Story)
/OUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/Count -0/Dest (14.91.1) cvn/Title (9.2. How the Guide Happened)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (14.92.1) cvn/Title (9.3. Removing Friction)
/OUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin [/Count -0/Dest (14.93.1) cvn/Title (9.4. Licensing) /OUT
pdfmark end
 -2
-11 a -2 -11 a
SDict begin [/PageMode /UseOutlines/Page 1/View [/Fit] /DOCVIEW pdfmark
end
 -2 -11 a -2 -11 a
SDict begin [ {Catalog}<<>> /PUT pdfmark end
 -2 -11 a -2 -11 a
SDict begin H.S end
 -2
-11 a -2 -11 a
SDict begin 12 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (Doc-Start) cvn /DEST pdfmark end
 -2 -11 a -2 -11 a
SDict begin [ {Catalog} << /PageLabels<</Nums[0<</P(1)>>1<</P(2)>>2<</P(3)>>3<</P(iv)>>4<</P(v)>>5<</P(vi)>>6<</P(vii)>>7<</P(viii)>>8<</P(ix)>>9<</P(x)>>10<</P(xi)>>11<</P(xii)>>12<</P(xiii)>>13<</P(xiv)>>14<</P(1)>>15<</P(2)>>16<</P(3)>>17<</P(4)>>18<</P(5)>>19<</P(6)>>20<</P(7)>>21<</P(8)>>22<</P(9)>>23<</P(10)>>24<</P(11)>>25<</P(12)>>26<</P(13)>>27<</P(14)>>28<</P(15)>>29<</P(16)>>30<</P(17)>>31<</P(18)>>32<</P(19)>>33<</P(20)>>34<</P(21)>>35<</P(22)>>36<</P(23)>>37<</P(24)>>38<</P(25)>>39<</P(26)>>40<</P(27)>>41<</P(28)>>42<</P(29)>>43<</P(30)>>44<</P(31)>>45<</P(32)>>46<</P(33)>>47<</P(34)>>48<</P(35)>>49<</P(36)>>50<</P(37)>>51<</P(38)>>52<</P(39)>>53<</P(40)>>54<</P(41)>>55<</P(42)>>56<</P(43)>>57<</P(44)>>58<</P(45)>>59<</P(46)>>60<</P(47)>>61<</P(48)>>62<</P(49)>>63<</P(50)>>64<</P(51)>>65<</P(52)>>66<</P(53)>>67<</P(54)>>68<</P(55)>>69<</P(56)>>70<</P(57)>>71<</P(58)>>72<</P(59)>>73<</P(60)>>74<</P(61)>>75<</P(62)>>76<</P(63)>>77<</P(64)>>78<</P(65)>>79<</P(66)>>80<</P(67)>>81<</P(68)>>82<</P(69)>>83<</P(70)>>84<</P(71)>>85<</P(72)>>86<</P(73)>>87<</P(74)>>88<</P(75)>>89<</P(76)>>90<</P(77)>>91<</P(78)>>92<</P(79)>>93<</P(80)>>94<</P(81)>>95<</P(82)>>96<</P(83)>>97<</P(84)>>98<</P(85)>>99<</P(86)>>100<</P(87)>>101<</P(88)>>102<</P(89)>>103<</P(90)>>104<</P(91)>>105<</P(92)>>106<</P(93)>>107<</P(94)>>108<</P(95)>>109<</P(96)>>110<</P(97)>>111<</P(98)>>112<</P(99)>>113<</P(100)>>114<</P(101)>>115<</P(102)>>116<</P(103)>>117<</P(104)>>118<</P(105)>>119<</P(106)>>120<</P(107)>>121<</P(108)>>122<</P(109)>>123<</P(110)>>124<</P(111)>>125<</P(112)>>126<</P(113)>>127<</P(114)>>128<</P(115)>>129<</P(116)>>130<</P(117)>>131<</P(118)>>132<</P(119)>>133<</P(120)>>134<</P(121)>>135<</P(122)>>136<</P(123)>>137<</P(124)>>138<</P(125)>>139<</P(126)>>140<</P(127)>>141<</P(128)>>142<</P(129)>>143<</P(130)>>144<</P(131)>>145<</P(132)>>146<</P(133)>>147<</P(134)>>148<</P(135)>>149<</P(136)>>150<</P(137)>>151<</P(138)>>152<</P(139)>>153<</P(140)>>154<</P(141)>>155<</P(142)>>156<</P(143)>>157<</P(144)>>158<</P(145)>>159<</P(146)>>160<</P(147)>>161<</P(148)>>162<</P(149)>>163<</P(150)>>164<</P(151)>>165<</P(152)>>166<</P(153)>>167<</P(154)>>168<</P(155)>>169<</P(156)>>170<</P(157)>>171<</P(158)>>172<</P(159)>>173<</P(160)>>174<</P(161)>>175<</P(162)>>176<</P(163)>>177<</P(164)>>178<</P(165)>>179<</P(166)>>180<</P(167)>>181<</P(168)>>182<</P(169)>>183<</P(170)>>184<</P(171)>>185<</P(172)>>186<</P(173)>>187<</P(174)>>188<</P(175)>>189<</P(176)>>190<</P(177)>>191<</P(178)>>192<</P(179)>>193<</P(180)>>194<</P(181)>>195<</P(182)>>196<</P(183)>>197<</P(184)>>198<</P(185)>>199<</P(186)>>200<</P(187)>>201<</P(188)>>202<</P(189)>>203<</P(190)>>204<</P(191)>>205<</P(192)>>206<</P(193)>>207<</P(194)>>208<</P(195)>>209<</P(196)>>210<</P(197)>>211<</P(198)>>212<</P(199)>>213<</P(200)>>214<</P(201)>>215<</P(202)>>216<</P(203)>>217<</P(204)>>218<</P(205)>>219<</P(206)>>220<</P(207)>>221<</P(208)>>222<</P(209)>>223<</P(210)>>224<</P(211)>>225<</P(212)>>226<</P(213)>>227<</P(214)>>228<</P(215)>>229<</P(216)>>230<</P(217)>>231<</P(218)>>232<</P(219)>>233<</P(220)>>234<</P(221)>>235<</P(222)>>236<</P(223)>>237<</P(224)>>238<</P(225)>>239<</P(226)>>240<</P(227)>>241<</P(228)>>242<</P(229)>>243<</P(230)>>244<</P(231)>>245<</P(232)>>246<</P(233)>>247<</P(234)>>248<</P(235)>>249<</P(236)>>250<</P(237)>>251<</P(238)>>252<</P(239)>>253<</P(240)>>254<</P(241)>>255<</P(242)>>256<</P(243)>>257<</P(244)>>258<</P(245)>>259<</P(246)>>260<</P(247)>>261<</P(248)>>262<</P(249)>>263<</P(250)>>264<</P(251)>>265<</P(252)>>266<</P(253)>>267<</P(254)>>268<</P(255)>>269<</P(256)>>270<</P(257)>>271<</P(258)>>272<</P(259)>>273<</P(260)>>274<</P(261)>>275<</P(262)>>276<</P(263)>>277<</P(264)>>278<</P(265)>>279<</P(266)>>280<</P(267)>>281<</P(268)>>282<</P(269)>>283<</P(270)>>284<</P(271)>>285<</P(272)>>286<</P(273)>>287<</P(274)>>288<</P(275)>>289<</P(276)>>290<</P(277)>>291<</P(278)>>292<</P(279)>>293<</P(280)>>294<</P(281)>>295<</P(282)>>296<</P(283)>>297<</P(284)>>298<</P(285)>>299<</P(286)>>300<</P(287)>>301<</P(288)>>302<</P(289)>>303<</P(290)>>304<</P(291)>>305<</P(292)>>306<</P(293)>>307<</P(294)>>308<</P(295)>>309<</P(296)>>310<</P(297)>>311<</P(298)>>312<</P(299)>>313<</P(300)>>314<</P(301)>>315<</P(302)>>316<</P(303)>>317<</P(304)>>318<</P(305)>>319<</P(306)>>320<</P(307)>>321<</P(308)>>322<</P(309)>>323<</P(310)>>324<</P(311)>>325<</P(312)>>326<</P(313)>>327<</P(314)>>328<</P(315)>>329<</P(316)>>330<</P(317)>>331<</P(318)>>332<</P(319)>>333<</P(320)>>334<</P(321)>>335<</P(322)>>336<</P(323)>>337<</P(324)>>338<</P(325)>>339<</P(326)>>340<</P(327)>>341<</P(328)>>342<</P(329)>>343<</P(330)>>344<</P(331)>>345<</P(332)>>346<</P(333)>>347<</P(334)>>348<</P(335)>>349<</P(336)>>350<</P(337)>>351<</P(338)>>352<</P(339)>>353<</P(340)>>354<</P(341)>>355<</P(342)>>356<</P(343)>>357<</P(344)>>358<</P(345)>>359<</P(346)>>360<</P(347)>>361<</P(348)>>362<</P(349)>>363<</P(350)>>364<</P(351)>>365<</P(352)>>366<</P(353)>>367<</P(354)>>368<</P(355)>>369<</P(356)>>370<</P(357)>>371<</P(358)>>372<</P(359)>>373<</P(360)>>374<</P(361)>>375<</P(362)>>376<</P(363)>>377<</P(364)>>378<</P(365)>>379<</P(366)>>380<</P(367)>>381<</P(368)>>382<</P(369)>>383<</P(370)>>384<</P(371)>>385<</P(372)>>386<</P(373)>>387<</P(374)>>388<</P(375)>>389<</P(376)>>]>>
>> /PUT pdfmark end
 -2
-11 a -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 12 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:0) cvn /DEST pdfmark end
 -2
-11 a 550 140 a Fn(The)58 b(Zer)l(oMQ)f(Guide)h(-)g(f)l(or)f(PHP)1387
409 y(De)m(veloper)m(s)2494 409 y
SDict begin H.S end
 2494 409 a 2494 409
a
SDict begin 32.348 H.A end
 2494 409 a 2494 409 a
SDict begin [/View [/XYZ H.V]/Dest (1.0) cvn /DEST pdfmark end
 2494 409 a Black Black eop end
%%Page: 2 2
TeXDict begin 2 1 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.2) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 72 a Fm(The)22 b(Zer)n(oMQ)i(Guide)e(-)h(f)n(or)g(PHP)g
(De)o(veloper)o(s)p Black Black eop end
%%Page: 3 3
TeXDict begin 3 2 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.3) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 115 a Fl(Dedication)878 115 y
SDict begin H.S end
 878 115
a 878 115 a
SDict begin 26.957 H.A end
 878 115 a 878 115 a
SDict begin [/View [/XYZ H.V]/Dest (2.0) cvn /DEST pdfmark end
 878 115 a 396 443 a Fk(By)21
b(Pieter)f(Hintjens)396 717 y Fj(Please)h(use)g(the)f(issue)h(track)o
(er)e(\(https://github)m(.com/imatix/zguide/issues\))14
b(for)20 b(all)h(comments)e(and)g(errata.)h(This)396
825 y(v)o(ersion)f(co)o(v)o(ers)g(the)h(latest)h(stable)g(release)f(of)
g(\330MQ)g(\(3.2\))f(and)h(w)o(as)h(published)d(on)i(Sun)g(4)g(No)o(v)o
(ember)m(,)e(2012.)g(If)396 933 y(you)i(are)g(using)f(older)h(v)o
(ersions)f(of)h(\330MQ)g(then)g(some)g(of)g(the)g(e)o(xamples)f(and)h
(e)o(xplanations)e(w)o(on')o(t)h(be)h(accurate.)396 1207
y(The)g(Guide)g(is)h(originally)e(in)h(C)h(\(http://zguide.zeromq.or)o
(g)o(/pag)o(e:all\),)14 b(b)n(ut)20 b(also)h(in)f(PHP)396
1315 y(\(http://zguide.zeromq.or)o(g)o(/ph)o(p:all\),)14
b(Python)19 b(\(http://zguide.zeromq.or)o(g)o(/p)o(y:all\))o(,)c(Lua)
396 1422 y(\(http://zguide.zeromq.or)o(g)o(/lua:all\),)f(and)20
b(Hax)o(e)f(\(http://zguide.zeromq.or)o(g/h)o(x:all\))o(.)c(W)-7
b(e')l(v)o(e)20 b(also)g(translated)396 1530 y(most)g(of)g(the)h(e)o
(xamples)e(into)h(C++,)g(C#,)h(CL,)f(Delphi,)g(Erlang,)f(F#,)h(Felix,)g
(Hask)o(ell,)g(Ja)n(v)n(a,)h(Objecti)n(v)o(e-C,)e(Ruby)-5
b(,)396 1638 y(Ada,)20 b(Basic,)h(Clojure,)f(Go,)g(Hax)o(e,)f(Node.js,)
h(ooc,)f(Perl,)h(and)g(Scala.)p Black Black eop end
%%Page: 4 4
TeXDict begin 4 3 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.iv) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 115 a Fl(T)-14 b(ab)n(le)48 b(of)g(Contents)1435
115 y
SDict begin H.S end
 1435 115 a 1435 115 a
SDict begin 26.957 H.A end
 1435 115 a 1435 115 a
SDict begin [/View [/XYZ H.V]/Dest (3.0) cvn /DEST pdfmark end
 1435
115 a 0 TeXcolorgray 396 257 a
SDict begin H.S end
 396 257 a Fk(Pr)o(eface)664
257 y
SDict begin 13 H.L end
 664 257 a 664 257 a
SDict begin [/Subtype /Link/Dest (0:15) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 664 257 a Black Black 19 w
Fk(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3796 257
a
SDict begin H.S end
 3796 257 a Fk(xii)3884 257 y
SDict begin 13 H.L end
 3884 257 a 3884 257 a
SDict begin [/Subtype /Link/Dest (0:15) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 257 a Black 0 TeXcolorgray 596 385 a
SDict begin H.S end
 596 385 a Fj(1.)20
b(\330MQ)g(in)g(a)h(Hundred)d(W)-7 b(ords)1562 385 y
SDict begin 13 H.L end

1562 385 a 1562 385 a
SDict begin [/Subtype /Link/Dest (0:17) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1562 385 a Black Black 13 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3796 385 a
SDict begin H.S end
 3796 385 a Fj(xii)3884 385 y
SDict begin 13 H.L end
 3884 385 a 3884
385 a
SDict begin [/Subtype /Link/Dest (0:17) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 385 a Black 0 TeXcolorgray 596 493 a
SDict begin H.S end
 596 493
a Fj(2.)20 b(The)f(Zen)h(of)g(Zero)1226 493 y
SDict begin 13 H.L end
 1226 493
a 1226 493 a
SDict begin [/Subtype /Link/Dest (0:21) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1226 493 a Black Black 17 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3796 493 a
SDict begin H.S end
 3796 493 a Fj(xii)3884 493 y
SDict begin 13 H.L end
 3884 493 a 3884
493 a
SDict begin [/Subtype /Link/Dest (0:21) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 493 a Black 0 TeXcolorgray 596 601 a
SDict begin H.S end
 596 601
a Fj(3.)g(Ho)n(w)g(the)g(Guide)f(Happened)1543 601 y
SDict begin 13 H.L end

1543 601 a 1543 601 a
SDict begin [/Subtype /Link/Dest (0:26) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1543 601 a Black Black 11 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3796 601 a
SDict begin H.S end
 3796 601 a Fj(xii)3884 601
y
SDict begin 13 H.L end
 3884 601 a 3884 601 a
SDict begin [/Subtype /Link/Dest (0:26) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 601 a Black 0 TeXcolorgray
596 709 a
SDict begin H.S end
 596 709 a Fj(4.)h(Audience)999 709 y
SDict begin 13 H.L end
 999 709
a 999 709 a
SDict begin [/Subtype /Link/Dest (0:37) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 999 709 a Black Black 16 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3772 709 a
SDict begin H.S end
 3772 709 a Fj(xiii)3883 709 y
SDict begin 13 H.L end
 3883 709 a 3883
709 a
SDict begin [/Subtype /Link/Dest (0:37) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3883 709 a Black 0 TeXcolorgray 596 817 a
SDict begin H.S end
 596 817
a Fj(5.)g(Ackno)n(wledgements)1340 817 y
SDict begin 13 H.L end
 1340 817 a 1340
817 a
SDict begin [/Subtype /Link/Dest (0:40) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1340 817 a Black Black 7 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3772 817 a
SDict begin H.S end
 3772 817 a Fj(xiii)3883 817 y
SDict begin 13 H.L end
 3883 817 a 3883
817 a
SDict begin [/Subtype /Link/Dest (0:40) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3883 817 a Black 0 TeXcolorgray 396 945 a
SDict begin H.S end
 396 945
a Fk(1.)g(Basics)700 945 y
SDict begin 13 H.L end
 700 945 a 700 945 a
SDict begin [/Subtype /Link/Dest (0:basics) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 700 945
a Black Black 3 w Fk(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3842 945
a
SDict begin H.S end
 3842 945 a Fk(1)3884 945 y
SDict begin 13 H.L end
 3884 945 a 3884 945 a
SDict begin [/Subtype /Link/Dest (0:basics) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
945 a Black 0 TeXcolorgray 596 1073 a
SDict begin H.S end
 596 1073 a Fj(1.1.)f(Fixing)g
(the)i(W)-7 b(orld)1307 1073 y
SDict begin 13 H.L end
 1307 1073 a 1307 1073
a
SDict begin [/Subtype /Link/Dest (0:49) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1307 1073 a Black Black 19 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3842 1073 a
SDict begin H.S end
 3842 1073
a Fj(1)3884 1073 y
SDict begin 13 H.L end
 3884 1073 a 3884 1073 a
SDict begin [/Subtype /Link/Dest (0:49) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1073
a Black 0 TeXcolorgray 596 1181 a
SDict begin H.S end
 596 1181 a Fj(1.2.)19
b(Audience)g(for)g(This)i(Book)1547 1181 y
SDict begin 13 H.L end
 1547 1181
a 1547 1181 a
SDict begin [/Subtype /Link/Dest (0:70) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1547 1181 a Black Black 7 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3842 1181 a
SDict begin H.S end
 3842 1181 a Fj(2)3884 1181 y
SDict begin 13 H.L end
 3884 1181 a
3884 1181 a
SDict begin [/Subtype /Link/Dest (0:70) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1181 a Black 0 TeXcolorgray 596 1289
a
SDict begin H.S end
 596 1289 a Fj(1.3.)e(Getting)h(the)g(Examples)1462
1289 y
SDict begin 13 H.L end
 1462 1289 a 1462 1289 a
SDict begin [/Subtype /Link/Dest (0:75) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1462 1289 a Black Black
9 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3842 1289 a
SDict begin H.S end
 3842
1289 a Fj(2)3884 1289 y
SDict begin 13 H.L end
 3884 1289 a 3884 1289 a
SDict begin [/Subtype /Link/Dest (0:75) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
1289 a Black 0 TeXcolorgray 596 1396 a
SDict begin H.S end
 596 1396 a Fj(1.4.)f(Ask)h(and)g
(Y)-8 b(e)20 b(Shall)h(Recei)n(v)o(e)1602 1396 y
SDict begin 13 H.L end
 1602
1396 a 1602 1396 a
SDict begin [/Subtype /Link/Dest (0:82) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1602 1396 a Black Black 15 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3842 1396 a
SDict begin H.S end
 3842 1396 a Fj(3)3884
1396 y
SDict begin 13 H.L end
 3884 1396 a 3884 1396 a
SDict begin [/Subtype /Link/Dest (0:82) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1396 a Black 0 TeXcolorgray
596 1504 a
SDict begin H.S end
 596 1504 a Fj(1.5.)e(A)i(Minor)e(Note)h(on)g(Strings)1572
1504 y
SDict begin 13 H.L end
 1572 1504 a 1572 1504 a
SDict begin [/Subtype /Link/Dest (0:126) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1572 1504 a Black Black
3 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3842 1504 a
SDict begin H.S end
 3842 1504 a Fj(7)3884 1504 y
SDict begin 13 H.L end
 3884 1504 a
3884 1504 a
SDict begin [/Subtype /Link/Dest (0:126) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1504 a Black 0 TeXcolorgray 596 1612
a
SDict begin H.S end
 596 1612 a Fj(1.6.)f(V)-9 b(ersion)19 b(Reporting)1349
1612 y
SDict begin 13 H.L end
 1349 1612 a 1349 1612 a
SDict begin [/Subtype /Link/Dest (0:151) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1349 1612 a Black Black
19 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3842 1612 a
SDict begin H.S end
 3842 1612 a Fj(9)3884
1612 y
SDict begin 13 H.L end
 3884 1612 a 3884 1612 a
SDict begin [/Subtype /Link/Dest (0:151) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1612 a Black 0 TeXcolorgray
596 1720 a
SDict begin H.S end
 596 1720 a Fj(1.7.)g(Getting)h(the)g(Message)g(Out)1569
1720 y
SDict begin 13 H.L end
 1569 1720 a 1569 1720 a
SDict begin [/Subtype /Link/Dest (0:158) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1569 1720 a Black Black
6 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3842 1720 a
SDict begin H.S end
 3842 1720 a Fj(9)3884 1720 y
SDict begin 13 H.L end
 3884 1720 a
3884 1720 a
SDict begin [/Subtype /Link/Dest (0:158) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1720 a Black 0 TeXcolorgray 596 1828
a
SDict begin H.S end
 596 1828 a Fj(1.8.)f(Di)n(vide)g(and)h(Conquer)1414
1828 y
SDict begin 13 H.L end
 1414 1828 a 1414 1828 a
SDict begin [/Subtype /Link/Dest (0:215) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1414 1828 a Black Black
16 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 1828 a
SDict begin H.S end

3800 1828 a Fj(13)3884 1828 y
SDict begin 13 H.L end
 3884 1828 a 3884 1828 a
SDict begin [/Subtype /Link/Dest (0:215) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 1828 a Black 0 TeXcolorgray 596 1936 a
SDict begin H.S end
 596 1936
a Fj(1.9.)f(Programming)e(with)k(\330MQ)1581 1936 y
SDict begin 13 H.L end
 1581
1936 a 1581 1936 a
SDict begin [/Subtype /Link/Dest (0:265) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1581 1936 a Black Black 15 w Fj(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 1936 a
SDict begin H.S end
 3800 1936 a Fj(18)3884 1936 y
SDict begin 13 H.L end
 3884 1936 a
3884 1936 a
SDict begin [/Subtype /Link/Dest (0:265) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1936 a Black 0 TeXcolorgray 795 2044
a
SDict begin H.S end
 795 2044 a Fj(1.9.1.)d(Getting)i(the)g(Conte)o(xt)g(Right)1862
2044 y
SDict begin 13 H.L end
 1862 2044 a 1862 2044 a
SDict begin [/Subtype /Link/Dest (0:285) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1862 2044 a Black Black
4 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 2044 a
SDict begin H.S end
 3800 2044 a Fj(20)3884 2044 y
SDict begin 13 H.L end
 3884 2044 a
3884 2044 a
SDict begin [/Subtype /Link/Dest (0:285) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 2044 a Black 0 TeXcolorgray 795 2152
a
SDict begin H.S end
 795 2152 a Fj(1.9.2.)e(Making)h(a)i(Clean)f(Exit)1692
2152 y
SDict begin 13 H.L end
 1692 2152 a 1692 2152 a
SDict begin [/Subtype /Link/Dest (0:299) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1692 2152 a Black Black
8 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 2152 a
SDict begin H.S end
 3800
2152 a Fj(21)3884 2152 y
SDict begin 13 H.L end
 3884 2152 a 3884 2152 a
SDict begin [/Subtype /Link/Dest (0:299) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
2152 a Black 0 TeXcolorgray 596 2260 a
SDict begin H.S end
 596 2260 a Fj(1.10.)e(Why)i(W)-7
b(e)21 b(Needed)f(\330MQ)1562 2260 y
SDict begin 13 H.L end
 1562 2260 a 1562
2260 a
SDict begin [/Subtype /Link/Dest (0:322) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1562 2260 a Black Black 13 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 2260 a
SDict begin H.S end
 3800 2260 a Fj(22)3884 2260 y
SDict begin 13 H.L end
 3884 2260 a
3884 2260 a
SDict begin [/Subtype /Link/Dest (0:322) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 2260 a Black 0 TeXcolorgray 596 2368
a
SDict begin H.S end
 596 2368 a Fj(1.11.)e(Sock)o(et)i(Scalability)1384
2368 y
SDict begin 13 H.L end
 1384 2368 a 1384 2368 a
SDict begin [/Subtype /Link/Dest (0:403) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1384 2368 a Black Black
4 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black 0 TeXcolorgray 3800 2368 a
SDict begin H.S end
 3800 2368 a Fj(26)3884
2368 y
SDict begin 13 H.L end
 3884 2368 a 3884 2368 a
SDict begin [/Subtype /Link/Dest (0:403) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 2368 a Black 0 TeXcolorgray
596 2476 a
SDict begin H.S end
 596 2476 a Fj(1.12.)e(Upgrading)g(from)h(\330MQ/2.2)h(to)g
(\330MQ/3.2)2089 2476 y
SDict begin 13 H.L end
 2089 2476 a 2089 2476 a
SDict begin [/Subtype /Link/Dest (0:410) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2089
2476 a Black Black 5 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 2476 a
SDict begin H.S end

3800 2476 a Fj(27)3884 2476 y
SDict begin 13 H.L end
 3884 2476 a 3884 2476 a
SDict begin [/Subtype /Link/Dest (0:410) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 2476 a Black 0 TeXcolorgray 596 2584 a
SDict begin H.S end
 596 2584
a Fj(1.13.)e(W)-7 b(arning)20 b(-)g(Unstable)g(P)o(aradigms!)1830
2584 y
SDict begin 13 H.L end
 1830 2584 a 1830 2584 a
SDict begin [/Subtype /Link/Dest (0:432) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1830 2584 a Black Black
15 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black 0 TeXcolorgray 3800 2584 a
SDict begin H.S end
 3800 2584 a Fj(28)3884
2584 y
SDict begin 13 H.L end
 3884 2584 a 3884 2584 a
SDict begin [/Subtype /Link/Dest (0:432) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 2584 a Black 0 TeXcolorgray
396 2712 a
SDict begin H.S end
 396 2712 a Fk(2.)g(Sock)o(ets)h(and)f(P)o(atter)o(ns)1220
2712 y
SDict begin 13 H.L end
 1220 2712 a 1220 2712 a
SDict begin [/Subtype /Link/Dest (0:sockets-and-patterns) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1220 2712 a Black Black
2 w Fk(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
2712 a
SDict begin H.S end
 3800 2712 a Fk(29)3884 2712 y
SDict begin 13 H.L end
 3884 2712 a 3884
2712 a
SDict begin [/Subtype /Link/Dest (0:sockets-and-patterns) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 2712 a Black 0 TeXcolorgray 596 2839 a
SDict begin H.S end
 596
2839 a Fj(2.1.)f(The)h(Sock)o(et)g(API)1271 2839 y
SDict begin 13 H.L end
 1271
2839 a 1271 2839 a
SDict begin [/Subtype /Link/Dest (0:478) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1271 2839 a Black Black 14 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
2839 a
SDict begin H.S end
 3800 2839 a Fj(29)3884 2839 y
SDict begin 13 H.L end
 3884 2839 a 3884
2839 a
SDict begin [/Subtype /Link/Dest (0:478) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 2839 a Black 0 TeXcolorgray 795 2947 a
SDict begin H.S end
 795
2947 a Fj(2.1.1.)e(Plugging)h(Sock)o(ets)h(Into)g(the)g(T)-7
b(opology)2197 2947 y
SDict begin 13 H.L end
 2197 2947 a 2197 2947 a
SDict begin [/Subtype /Link/Dest (0:500) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2197 2947
a Black Black 1 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 2947 a
SDict begin H.S end
 3800 2947 a Fj(30)3884 2947
y
SDict begin 13 H.L end
 3884 2947 a 3884 2947 a
SDict begin [/Subtype /Link/Dest (0:500) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 2947 a Black 0 TeXcolorgray
795 3055 a
SDict begin H.S end
 795 3055 a Fj(2.1.2.)18 b(Using)i(Sock)o(ets)h(to)f(Carry)g
(Data)1952 3055 y
SDict begin 13 H.L end
 1952 3055 a 1952 3055 a
SDict begin [/Subtype /Link/Dest (0:543) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1952 3055 a
Black Black 18 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 3055 a
SDict begin H.S end
 3800
3055 a Fj(31)3884 3055 y
SDict begin 13 H.L end
 3884 3055 a 3884 3055 a
SDict begin [/Subtype /Link/Dest (0:543) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
3055 a Black 0 TeXcolorgray 795 3163 a
SDict begin H.S end
 795 3163 a Fj(2.1.3.)e(Unicast)j
(T)m(ransports)1631 3163 y
SDict begin 13 H.L end
 1631 3163 a 1631 3163 a
SDict begin [/Subtype /Link/Dest (0:566) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1631
3163 a Black Black 6 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 3163 a
SDict begin H.S end

3800 3163 a Fj(33)3884 3163 y
SDict begin 13 H.L end
 3884 3163 a 3884 3163 a
SDict begin [/Subtype /Link/Dest (0:566) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 3163 a Black 0 TeXcolorgray 795 3271 a
SDict begin H.S end
 795 3271
a Fj(2.1.4.)d(\330MQ)j(is)g(Not)f(a)h(Neutral)f(Carrier)2002
3271 y
SDict begin 13 H.L end
 2002 3271 a 2002 3271 a
SDict begin [/Subtype /Link/Dest (0:590) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2002 3271 a Black Black
9 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 3271 a
SDict begin H.S end

3800 3271 a Fj(33)3884 3271 y
SDict begin 13 H.L end
 3884 3271 a 3884 3271 a
SDict begin [/Subtype /Link/Dest (0:590) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 3271 a Black 0 TeXcolorgray 795 3379 a
SDict begin H.S end
 795 3379
a Fj(2.1.5.)e(I/O)j(Threads)1403 3379 y
SDict begin 13 H.L end
 1403 3379 a 1403
3379 a
SDict begin [/Subtype /Link/Dest (0:611) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1403 3379 a Black Black 6 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 3379 a
SDict begin H.S end
 3800
3379 a Fj(34)3884 3379 y
SDict begin 13 H.L end
 3884 3379 a 3884 3379 a
SDict begin [/Subtype /Link/Dest (0:611) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
3379 a Black 0 TeXcolorgray 596 3487 a
SDict begin H.S end
 596 3487 a Fj(2.2.)e(Messaging)g
(P)o(atterns)1388 3487 y
SDict begin 13 H.L end
 1388 3487 a 1388 3487 a
SDict begin [/Subtype /Link/Dest (0:619) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1388
3487 a Black Black Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 3487 a
SDict begin H.S end
 3800
3487 a Fj(35)3884 3487 y
SDict begin 13 H.L end
 3884 3487 a 3884 3487 a
SDict begin [/Subtype /Link/Dest (0:619) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
3487 a Black 0 TeXcolorgray 795 3595 a
SDict begin H.S end
 795 3595 a Fj(2.2.1.)f(High-le)n
(v)o(el)h(Messaging)g(P)o(atterns)2022 3595 y
SDict begin 13 H.L end
 2022 3595
a 2022 3595 a
SDict begin [/Subtype /Link/Dest (0:662) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2022 3595 a Black Black 10 w Fj(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 3595 a
SDict begin H.S end
 3800 3595 a Fj(36)3884 3595
y
SDict begin 13 H.L end
 3884 3595 a 3884 3595 a
SDict begin [/Subtype /Link/Dest (0:662) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 3595 a Black 0 TeXcolorgray
795 3703 a
SDict begin H.S end
 795 3703 a Fj(2.2.2.)f(W)-7 b(orking)20 b(with)g(Messages)
1803 3703 y
SDict begin 13 H.L end
 1803 3703 a 1803 3703 a
SDict begin [/Subtype /Link/Dest (0:669) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1803 3703 a Black
Black Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
3703 a
SDict begin H.S end
 3800 3703 a Fj(36)3884 3703 y
SDict begin 13 H.L end
 3884 3703 a 3884
3703 a
SDict begin [/Subtype /Link/Dest (0:669) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 3703 a Black 0 TeXcolorgray 795 3811 a
SDict begin H.S end
 795
3811 a Fj(2.2.3.)e(Handling)h(Multiple)h(Sock)o(ets)1897
3811 y
SDict begin 13 H.L end
 1897 3811 a 1897 3811 a
SDict begin [/Subtype /Link/Dest (0:727) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1897 3811 a Black Black
10 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black 0 TeXcolorgray 3800 3811 a
SDict begin H.S end
 3800 3811 a Fj(38)3884
3811 y
SDict begin 13 H.L end
 3884 3811 a 3884 3811 a
SDict begin [/Subtype /Link/Dest (0:727) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 3811 a Black 0 TeXcolorgray
795 3919 a
SDict begin H.S end
 795 3919 a Fj(2.2.4.)e(Multi-part)h(Messages)1687
3919 y
SDict begin 13 H.L end
 1687 3919 a 1687 3919 a
SDict begin [/Subtype /Link/Dest (0:755) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1687 3919 a Black Black
13 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 3919 a
SDict begin H.S end
 3800
3919 a Fj(41)3884 3919 y
SDict begin 13 H.L end
 3884 3919 a 3884 3919 a
SDict begin [/Subtype /Link/Dest (0:755) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
3919 a Black 0 TeXcolorgray 795 4027 a
SDict begin H.S end
 795 4027 a Fj(2.2.5.)f
(Intermediaries)h(and)g(Proxies)1893 4027 y
SDict begin 13 H.L end
 1893 4027
a 1893 4027 a
SDict begin [/Subtype /Link/Dest (0:785) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1893 4027 a Black Black 14 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 4027 a
SDict begin H.S end
 3800 4027 a Fj(42)3884 4027 y
SDict begin 13 H.L end
 3884 4027 a
3884 4027 a
SDict begin [/Subtype /Link/Dest (0:785) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4027 a Black 0 TeXcolorgray 795 4135
a
SDict begin H.S end
 795 4135 a Fj(2.2.6.)f(The)i(Dynamic)f(Disco)o(v)o(ery)g(Problem)2120
4135 y
SDict begin 13 H.L end
 2120 4135 a 2120 4135 a
SDict begin [/Subtype /Link/Dest (0:789) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2120 4135 a Black Black
16 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
4135 a
SDict begin H.S end
 3800 4135 a Fj(42)3884 4135 y
SDict begin 13 H.L end
 3884 4135 a 3884
4135 a
SDict begin [/Subtype /Link/Dest (0:789) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4135 a Black 0 TeXcolorgray 795 4242 a
SDict begin H.S end
 795
4242 a Fj(2.2.7.)f(Shared)i(Queue)f(\(DEALER)h(and)g(R)m(OUTER)g(sock)o
(ets\))2629 4242 y
SDict begin 13 H.L end
 2629 4242 a 2629 4242 a
SDict begin [/Subtype /Link/Dest (0:816) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2629 4242
a Black Black 5 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black 0 TeXcolorgray 3800 4242 a
SDict begin H.S end
 3800 4242 a Fj(46)3884
4242 y
SDict begin 13 H.L end
 3884 4242 a 3884 4242 a
SDict begin [/Subtype /Link/Dest (0:816) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4242 a Black 0 TeXcolorgray
795 4350 a
SDict begin H.S end
 795 4350 a Fj(2.2.8.)e(\330MQ')-5 b(s)21 b(Built-in)f(Proxy)
f(Function)2067 4350 y
SDict begin 13 H.L end
 2067 4350 a 2067 4350 a
SDict begin [/Subtype /Link/Dest (0:861) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2067 4350
a Black Black 6 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 4350 a
SDict begin H.S end
 3800 4350 a Fj(53)3884 4350 y
SDict begin 13 H.L end
 3884 4350 a
3884 4350 a
SDict begin [/Subtype /Link/Dest (0:861) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4350 a Black 0 TeXcolorgray 795 4458
a
SDict begin H.S end
 795 4458 a Fj(2.2.9.)f(T)m(ransport)h(Bridging)1640
4458 y
SDict begin 13 H.L end
 1640 4458 a 1640 4458 a
SDict begin [/Subtype /Link/Dest (0:873) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1640 4458 a Black Black
18 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 4458 a
SDict begin H.S end
 3800 4458 a Fj(53)3884 4458
y
SDict begin 13 H.L end
 3884 4458 a 3884 4458 a
SDict begin [/Subtype /Link/Dest (0:873) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4458 a Black 0 TeXcolorgray
596 4566 a
SDict begin H.S end
 596 4566 a Fj(2.3.)g(Handling)g(Errors)g(and)g(ETERM)1721
4566 y
SDict begin 13 H.L end
 1721 4566 a 1721 4566 a
SDict begin [/Subtype /Link/Dest (0:888) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1721 4566 a Black Black
20 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
4566 a
SDict begin H.S end
 3800 4566 a Fj(55)3884 4566 y
SDict begin 13 H.L end
 3884 4566 a 3884
4566 a
SDict begin [/Subtype /Link/Dest (0:888) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4566 a Black 0 TeXcolorgray 596 4674 a
SDict begin H.S end
 596
4674 a Fj(2.4.)g(Handling)g(Interrupt)f(Signals)1627
4674 y
SDict begin 13 H.L end
 1627 4674 a 1627 4674 a
SDict begin [/Subtype /Link/Dest (0:953) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1627 4674 a Black Black
10 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black 0 TeXcolorgray 3800 4674 a
SDict begin H.S end
 3800 4674 a
Fj(61)3884 4674 y
SDict begin 13 H.L end
 3884 4674 a 3884 4674 a
SDict begin [/Subtype /Link/Dest (0:953) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4674 a
Black 0 TeXcolorgray 596 4782 a
SDict begin H.S end
 596 4782 a Fj(2.5.)h(Detecting)g
(Memory)g(Leaks)1590 4782 y
SDict begin 13 H.L end
 1590 4782 a 1590 4782 a
SDict begin [/Subtype /Link/Dest (0:985) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1590
4782 a Black Black 6 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black 0 TeXcolorgray 3800 4782 a
SDict begin H.S end
 3800 4782 a
Fj(61)3884 4782 y
SDict begin 13 H.L end
 3884 4782 a 3884 4782 a
SDict begin [/Subtype /Link/Dest (0:985) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4782 a
Black 0 TeXcolorgray 596 4890 a
SDict begin H.S end
 596 4890 a Fj(2.6.)g(Multithreading)f
(with)i(\330MQ)1622 4890 y
SDict begin 13 H.L end
 1622 4890 a 1622 4890 a
SDict begin [/Subtype /Link/Dest (0:1007) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1622
4890 a Black Black 15 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
4890 a
SDict begin H.S end
 3800 4890 a Fj(62)3884 4890 y
SDict begin 13 H.L end
 3884 4890 a 3884
4890 a
SDict begin [/Subtype /Link/Dest (0:1007) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 4890 a Black 0 TeXcolorgray 596 4998 a
SDict begin H.S end
 596
4998 a Fj(2.7.)f(Signaling)g(between)g(Threads)g(\(P)-8
b(AIR)21 b(sock)o(ets\))2167 4998 y
SDict begin 13 H.L end
 2167 4998 a 2167
4998 a
SDict begin [/Subtype /Link/Dest (0:1066) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2167 4998 a Black Black 10 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 4998 a
SDict begin H.S end

3800 4998 a Fj(67)3884 4998 y
SDict begin 13 H.L end
 3884 4998 a 3884 4998 a
SDict begin [/Subtype /Link/Dest (0:1066) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 4998 a Black 0 TeXcolorgray 596 5106 a
SDict begin H.S end
 596 5106
a Fj(2.8.)e(Node)g(Coordination)1382 5106 y
SDict begin 13 H.L end
 1382 5106
a 1382 5106 a
SDict begin [/Subtype /Link/Dest (0:1106) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1382 5106 a Black Black 6 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 5106 a
SDict begin H.S end
 3800 5106 a Fj(71)3884 5106 y
SDict begin 13 H.L end
 3884 5106 a
3884 5106 a
SDict begin [/Subtype /Link/Dest (0:1106) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 5106 a Black Black 3823 5569 a Fi(iv)p
Black eop end
%%Page: 5 5
TeXDict begin 5 4 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.v) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black 0 TeXcolorgray 596 72 a
SDict begin H.S end
 596 72 a Fj(2.9.)19
b(Zero)g(Cop)o(y)1098 72 y
SDict begin 13 H.L end
 1098 72 a 1098 72 a
SDict begin [/Subtype /Link/Dest (0:1146) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1098 72
a Black Black Fj(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 72 a
SDict begin H.S end
 3800 72 a Fj(75)3884 72 y
SDict begin 13 H.L end
 3884 72 a 3884 72
a
SDict begin [/Subtype /Link/Dest (0:1146) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 72 a Black 0 TeXcolorgray 596 180 a
SDict begin H.S end
 596 180 a
Fj(2.10.)f(Pub-Sub)h(Message)h(En)m(v)o(elopes)1744 180
y
SDict begin 13 H.L end
 1744 180 a 1744 180 a
SDict begin [/Subtype /Link/Dest (0:1156) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1744 180 a Black Black 18 w Fj(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black 0 TeXcolorgray 3800 180 a
SDict begin H.S end
 3800 180 a Fj(75)3884
180 y
SDict begin 13 H.L end
 3884 180 a 3884 180 a
SDict begin [/Subtype /Link/Dest (0:1156) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 180 a Black 0 TeXcolorgray
596 288 a
SDict begin H.S end
 596 288 a Fj(2.11.)e(High)i(W)-7 b(ater)21
b(Marks)1399 288 y
SDict begin 13 H.L end
 1399 288 a 1399 288 a
SDict begin [/Subtype /Link/Dest (0:1183) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1399 288 a Black
Black 10 w Fj(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 288 a
SDict begin H.S end
 3800 288 a Fj(77)3884 288 y
SDict begin 13 H.L end

3884 288 a 3884 288 a
SDict begin [/Subtype /Link/Dest (0:1183) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 288 a Black 0 TeXcolorgray
596 396 a
SDict begin H.S end
 596 396 a Fj(2.12.)d(Missing)j(Message)f(Problem)f(Solv)o(er)
1901 396 y
SDict begin 13 H.L end
 1901 396 a 1901 396 a
SDict begin [/Subtype /Link/Dest (0:1196) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1901 396 a Black Black
6 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black 0 TeXcolorgray 3800 396 a
SDict begin H.S end
 3800 396 a Fj(78)3884
396 y
SDict begin 13 H.L end
 3884 396 a 3884 396 a
SDict begin [/Subtype /Link/Dest (0:1196) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 396 a Black 0 TeXcolorgray
396 524 a
SDict begin H.S end
 396 524 a Fk(3.)h(Adv)o(anced)g(Request-Reply)g(P)o(atter)o
(ns)1695 524 y
SDict begin 13 H.L end
 1695 524 a 1695 524 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1695 524 a Black
Black 5 w Fk(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 524 a
SDict begin H.S end

3800 524 a Fk(82)3884 524 y
SDict begin 13 H.L end
 3884 524 a 3884 524 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
524 a Black 0 TeXcolorgray 596 652 a
SDict begin H.S end
 596 652 a Fj(3.1.)f(Request-Reply)
g(En)m(v)o(elopes)1599 652 y
SDict begin 13 H.L end
 1599 652 a 1599 652 a
SDict begin [/Subtype /Link/Dest (0:1236) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1599
652 a Black Black 18 w Fj(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 652 a
SDict begin H.S end
 3800 652 a Fj(82)3884 652 y
SDict begin 13 H.L end

3884 652 a 3884 652 a
SDict begin [/Subtype /Link/Dest (0:1236) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 652 a Black 0 TeXcolorgray
596 760 a
SDict begin H.S end
 596 760 a Fj(3.2.)g(Custom)h(Request-Reply)f(Routing)1803
760 y
SDict begin 13 H.L end
 1803 760 a 1803 760 a
SDict begin [/Subtype /Link/Dest (0:1306) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1803 760 a Black Black Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 760 a
SDict begin H.S end

3800 760 a Fj(86)3884 760 y
SDict begin 13 H.L end
 3884 760 a 3884 760 a
SDict begin [/Subtype /Link/Dest (0:1306) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884
760 a Black 0 TeXcolorgray 596 868 a
SDict begin H.S end
 596 868 a Fj(3.3.)g(R)m
(OUTER-to-DEALER)g(Routing)1807 868 y
SDict begin 13 H.L end
 1807 868 a 1807
868 a
SDict begin [/Subtype /Link/Dest (0:1332) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1807 868 a Black Black 17 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 868 a
SDict begin H.S end
 3800 868 a Fj(87)3884 868 y
SDict begin 13 H.L end

3884 868 a 3884 868 a
SDict begin [/Subtype /Link/Dest (0:1332) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 868 a Black 0 TeXcolorgray
596 976 a
SDict begin H.S end
 596 976 a Fj(3.4.)g(Least-Recently)g(Used)i(Routing)e(\(LR)m
(U)h(P)o(attern\))2218 976 y
SDict begin 13 H.L end
 2218 976 a 2218 976 a
SDict begin [/Subtype /Link/Dest (0:1365) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2218
976 a Black Black 1 w Fj(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
976 a
SDict begin H.S end
 3800 976 a Fj(91)3884 976 y
SDict begin 13 H.L end
 3884 976 a 3884 976
a
SDict begin [/Subtype /Link/Dest (0:1365) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 976 a Black 0 TeXcolorgray 596 1084 a
SDict begin H.S end
 596 1084
a Fj(3.5.)f(Address-based)f(Routing)1519 1084 y
SDict begin 13 H.L end
 1519
1084 a 1519 1084 a
SDict begin [/Subtype /Link/Dest (0:1414) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1519 1084 a Black Black 15 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 1084 a
SDict begin H.S end
 3800 1084 a Fj(94)3884 1084 y
SDict begin 13 H.L end
 3884 1084 a
3884 1084 a
SDict begin [/Subtype /Link/Dest (0:1414) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3884 1084 a Black 0 TeXcolorgray 596 1192
a
SDict begin H.S end
 596 1192 a Fj(3.6.)h(A)i(Request-Reply)e(Message)h(Brok)o(er)1878
1192 y
SDict begin 13 H.L end
 1878 1192 a 1878 1192 a
SDict begin [/Subtype /Link/Dest (0:1474) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1878 1192 a Black Black
9 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 1192 a
SDict begin H.S end

3800 1192 a Fj(98)3884 1192 y
SDict begin 13 H.L end
 3884 1192 a 3884 1192 a
SDict begin [/Subtype /Link/Dest (0:1474) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3884 1192 a Black 0 TeXcolorgray 596 1300 a
SDict begin H.S end
 596 1300
a Fj(3.7.)f(A)i(High-Le)n(v)o(el)d(API)i(for)g(\330MQ)1688
1300 y
SDict begin 13 H.L end
 1688 1300 a 1688 1300 a
SDict begin [/Subtype /Link/Dest (0:1552) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1688 1300 a Black Black
12 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1300 a
SDict begin H.S end
 3759 1300 a Fj(107)3885 1300 y
SDict begin 13 H.L end
 3885 1300
a 3885 1300 a
SDict begin [/Subtype /Link/Dest (0:1552) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1300 a Black 0 TeXcolorgray 596 1407
a
SDict begin H.S end
 596 1407 a Fj(3.8.)f(Asynchronous)e(Client-Serv)o(er)1689
1407 y
SDict begin 13 H.L end
 1689 1407 a 1689 1407 a
SDict begin [/Subtype /Link/Dest (0:1627) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1689 1407 a Black Black
11 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1407 a
SDict begin H.S end
 3759 1407 a Fj(113)3885 1407 y
SDict begin 13 H.L end
 3885 1407
a 3885 1407 a
SDict begin [/Subtype /Link/Dest (0:1627) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1407 a Black 0 TeXcolorgray 596 1515
a
SDict begin H.S end
 596 1515 a Fj(3.9.)i(W)-7 b(ork)o(ed)20 b(Example:)e(Inter)n(-Brok)o
(er)h(Routing)2063 1515 y
SDict begin 13 H.L end
 2063 1515 a 2063 1515 a
SDict begin [/Subtype /Link/Dest (0:1685) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2063
1515 a Black Black 10 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 1515 a
SDict begin H.S end
 3759 1515
a Fj(119)3885 1515 y
SDict begin 13 H.L end
 3885 1515 a 3885 1515 a
SDict begin [/Subtype /Link/Dest (0:1685) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1515
a Black 0 TeXcolorgray 795 1623 a
SDict begin H.S end
 795 1623 a Fj(3.9.1.)f(Establishing)i
(the)g(Details)1791 1623 y
SDict begin 13 H.L end
 1791 1623 a 1791 1623 a
SDict begin [/Subtype /Link/Dest (0:1689) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1791
1623 a Black Black 12 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 1623 a
SDict begin H.S end
 3759
1623 a Fj(119)3885 1623 y
SDict begin 13 H.L end
 3885 1623 a 3885 1623 a
SDict begin [/Subtype /Link/Dest (0:1689) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
1623 a Black 0 TeXcolorgray 795 1731 a
SDict begin H.S end
 795 1731 a Fj(3.9.2.)e
(Architecture)h(of)h(a)h(Single)f(Cluster)2059 1731 y
SDict begin 13 H.L end

2059 1731 a 2059 1731 a
SDict begin [/Subtype /Link/Dest (0:1713) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2059 1731 a Black Black 14 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1731 a
SDict begin H.S end
 3759 1731 a Fj(120)3885 1731 y
SDict begin 13 H.L end
 3885 1731
a 3885 1731 a
SDict begin [/Subtype /Link/Dest (0:1713) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1731 a Black 0 TeXcolorgray 795 1839
a
SDict begin H.S end
 795 1839 a Fj(3.9.3.)e(Scaling)i(to)g(Multiple)g(Clusters)1936
1839 y
SDict begin 13 H.L end
 1936 1839 a 1936 1839 a
SDict begin [/Subtype /Link/Dest (0:1723) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1936 1839 a Black Black
13 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1839 a
SDict begin H.S end
 3759 1839 a Fj(121)3885 1839 y
SDict begin 13 H.L end
 3885 1839
a 3885 1839 a
SDict begin [/Subtype /Link/Dest (0:1723) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1839 a Black 0 TeXcolorgray 795 1947
a
SDict begin H.S end
 795 1947 a Fj(3.9.4.)e(Federation)h(vs.)h(Peering)1748
1947 y
SDict begin 13 H.L end
 1748 1947 a 1748 1947 a
SDict begin [/Subtype /Link/Dest (0:1772) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1748 1947 a Black Black
14 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1947 a
SDict begin H.S end
 3759 1947 a Fj(125)3885 1947 y
SDict begin 13 H.L end
 3885 1947
a 3885 1947 a
SDict begin [/Subtype /Link/Dest (0:1772) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1947 a Black 0 TeXcolorgray 795 2055
a
SDict begin H.S end
 795 2055 a Fj(3.9.5.)e(The)i(Naming)f(Ceremon)o(y)1787
2055 y
SDict begin 13 H.L end
 1787 2055 a 1787 2055 a
SDict begin [/Subtype /Link/Dest (0:1794) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1787 2055 a Black Black
16 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2055 a
SDict begin H.S end
 3759 2055 a Fj(126)3885 2055
y
SDict begin 13 H.L end
 3885 2055 a 3885 2055 a
SDict begin [/Subtype /Link/Dest (0:1794) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2055 a Black 0 TeXcolorgray
795 2163 a
SDict begin H.S end
 795 2163 a Fj(3.9.6.)f(Prototyping)g(the)i(State)h(Flo)n(w)
1893 2163 y
SDict begin 13 H.L end
 1893 2163 a 1893 2163 a
SDict begin [/Subtype /Link/Dest (0:1844) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1893 2163 a Black
Black 14 w Fj(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 2163
a
SDict begin H.S end
 3759 2163 a Fj(128)3885 2163 y
SDict begin 13 H.L end
 3885 2163 a 3885 2163
a
SDict begin [/Subtype /Link/Dest (0:1844) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2163 a Black 0 TeXcolorgray 795 2271 a
SDict begin H.S end
 795 2271
a Fj(3.9.7.)d(Prototyping)g(the)i(Local)g(and)g(Cloud)g(Flo)n(ws)2313
2271 y
SDict begin 13 H.L end
 2313 2271 a 2313 2271 a
SDict begin [/Subtype /Link/Dest (0:1879) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2313 2271 a Black Black
9 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2271 a
SDict begin H.S end
 3759 2271 a Fj(133)3885 2271
y
SDict begin 13 H.L end
 3885 2271 a 3885 2271 a
SDict begin [/Subtype /Link/Dest (0:1879) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2271 a Black 0 TeXcolorgray
795 2379 a
SDict begin H.S end
 795 2379 a Fj(3.9.8.)e(Putting)i(it)h(All)g(T)-7
b(ogether)1752 2379 y
SDict begin 13 H.L end
 1752 2379 a 1752 2379 a
SDict begin [/Subtype /Link/Dest (0:1915) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1752 2379
a Black Black 10 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2379 a
SDict begin H.S end
 3759 2379 a Fj(139)3885 2379
y
SDict begin 13 H.L end
 3885 2379 a 3885 2379 a
SDict begin [/Subtype /Link/Dest (0:1915) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2379 a Black 0 TeXcolorgray
396 2507 a
SDict begin H.S end
 396 2507 a Fk(4.)20 b(Reliable)h(Request-Reply)e(P)o(atter)o
(ns)1631 2507 y
SDict begin 13 H.L end
 1631 2507 a 1631 2507 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1631 2507 a Black
Black 6 w Fk(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2507 a
SDict begin H.S end
 3759 2507 a Fk(147)3885 2507 y
SDict begin 13 H.L end
 3885 2507
a 3885 2507 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2507 a Black 0 TeXcolorgray 596 2635
a
SDict begin H.S end
 596 2635 a Fj(4.1.)g(What)h(is)i("Reliability"?)1474
2635 y
SDict begin 13 H.L end
 1474 2635 a 1474 2635 a
SDict begin [/Subtype /Link/Dest (0:1968) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1474 2635 a Black Black
18 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2635 a
SDict begin H.S end
 3759 2635 a Fj(147)3885 2635 y
SDict begin 13 H.L end
 3885 2635
a 3885 2635 a
SDict begin [/Subtype /Link/Dest (0:1968) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2635 a Black 0 TeXcolorgray 596 2742
a
SDict begin H.S end
 596 2742 a Fj(4.2.)d(Designing)g(Reliability)1454 2742
y
SDict begin 13 H.L end
 1454 2742 a 1454 2742 a
SDict begin [/Subtype /Link/Dest (0:1990) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1454 2742 a Black Black 17
w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2742 a
SDict begin H.S end
 3759 2742 a Fj(148)3885
2742 y
SDict begin 13 H.L end
 3885 2742 a 3885 2742 a
SDict begin [/Subtype /Link/Dest (0:1990) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2742 a Black 0 TeXcolorgray
596 2850 a
SDict begin H.S end
 596 2850 a Fj(4.3.)g(Client-side)h(Reliability)g(\(Lazy)g
(Pirate)g(P)o(attern\))2189 2850 y
SDict begin 13 H.L end
 2189 2850 a 2189 2850
a
SDict begin [/Subtype /Link/Dest (0:2014) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2189 2850 a Black Black 9 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 2850
a
SDict begin H.S end
 3759 2850 a Fj(149)3885 2850 y
SDict begin 13 H.L end
 3885 2850 a 3885 2850
a
SDict begin [/Subtype /Link/Dest (0:2014) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2850 a Black 0 TeXcolorgray 596 2958 a
SDict begin H.S end
 596 2958
a Fj(4.4.)f(Basic)i(Reliable)f(Queuing)f(\(Simple)h(Pirate)g(P)o
(attern\))2311 2958 y
SDict begin 13 H.L end
 2311 2958 a 2311 2958 a
SDict begin [/Subtype /Link/Dest (0:2055) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2311 2958
a Black Black 11 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2958 a
SDict begin H.S end
 3759 2958
a Fj(153)3885 2958 y
SDict begin 13 H.L end
 3885 2958 a 3885 2958 a
SDict begin [/Subtype /Link/Dest (0:2055) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2958
a Black 0 TeXcolorgray 596 3066 a
SDict begin H.S end
 596 3066 a Fj(4.5.)f(Rob)n(ust)h
(Reliable)h(Queuing)d(\(P)o(aranoid)h(Pirate)h(P)o(attern\))2419
3066 y
SDict begin 13 H.L end
 2419 3066 a 2419 3066 a
SDict begin [/Subtype /Link/Dest (0:2077) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2419 3066 a Black Black
7 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3066 a
SDict begin H.S end
 3759
3066 a Fj(157)3885 3066 y
SDict begin 13 H.L end
 3885 3066 a 3885 3066 a
SDict begin [/Subtype /Link/Dest (0:2077) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3066 a Black 0 TeXcolorgray 596 3174 a
SDict begin H.S end
 596 3174 a Fj(4.6.)f
(Heartbeating)1172 3174 y
SDict begin 13 H.L end
 1172 3174 a 1172 3174 a
SDict begin [/Subtype /Link/Dest (0:2112) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1172
3174 a Black Black 9 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 3174 a
SDict begin H.S end
 3759 3174 a Fj(164)3885 3174
y
SDict begin 13 H.L end
 3885 3174 a 3885 3174 a
SDict begin [/Subtype /Link/Dest (0:2112) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3174 a Black 0 TeXcolorgray
596 3282 a
SDict begin H.S end
 596 3282 a Fj(4.7.)g(Contracts)h(and)f(Protocols)1535
3282 y
SDict begin 13 H.L end
 1535 3282 a 1535 3282 a
SDict begin [/Subtype /Link/Dest (0:2141) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1535 3282 a Black Black
19 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3282 a
SDict begin H.S end
 3759 3282 a Fj(165)3885 3282 y
SDict begin 13 H.L end
 3885 3282
a 3885 3282 a
SDict begin [/Subtype /Link/Dest (0:2141) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3282 a Black 0 TeXcolorgray 596 3390
a
SDict begin H.S end
 596 3390 a Fj(4.8.)g(Service-Oriented)f(Reliable)i(Queuing)f
(\(Majordomo)e(P)o(attern\))2636 3390 y
SDict begin 13 H.L end
 2636 3390 a 2636
3390 a
SDict begin [/Subtype /Link/Dest (0:2160) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2636 3390 a Black Black 18 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3390 a
SDict begin H.S end
 3759
3390 a Fj(166)3885 3390 y
SDict begin 13 H.L end
 3885 3390 a 3885 3390 a
SDict begin [/Subtype /Link/Dest (0:2160) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3390 a Black 0 TeXcolorgray 596 3498 a
SDict begin H.S end
 596 3498 a Fj(4.9.)i
(Asynchronous)e(Majordomo)h(P)o(attern)1889 3498 y
SDict begin 13 H.L end
 1889
3498 a 1889 3498 a
SDict begin [/Subtype /Link/Dest (0:2228) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1889 3498 a Black Black 18 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 3498 a
SDict begin H.S end
 3759 3498
a Fj(190)3885 3498 y
SDict begin 13 H.L end
 3885 3498 a 3885 3498 a
SDict begin [/Subtype /Link/Dest (0:2228) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3498
a Black 0 TeXcolorgray 596 3606 a
SDict begin H.S end
 596 3606 a Fj(4.10.)g(Service)i
(Disco)o(v)o(ery)1393 3606 y
SDict begin 13 H.L end
 1393 3606 a 1393 3606 a
SDict begin [/Subtype /Link/Dest (0:2267) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

1393 3606 a Black Black 16 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3606
a
SDict begin H.S end
 3759 3606 a Fj(197)3885 3606 y
SDict begin 13 H.L end
 3885 3606 a 3885 3606
a
SDict begin [/Subtype /Link/Dest (0:2267) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3606 a Black 0 TeXcolorgray 596 3714 a
SDict begin H.S end
 596 3714
a Fj(4.11.)e(Idempotent)g(Services)1463 3714 y
SDict begin 13 H.L end
 1463 3714
a 1463 3714 a
SDict begin [/Subtype /Link/Dest (0:2277) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1463 3714 a Black Black 8 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3714 a
SDict begin H.S end
 3759 3714 a Fj(198)3885 3714 y
SDict begin 13 H.L end
 3885 3714
a 3885 3714 a
SDict begin [/Subtype /Link/Dest (0:2277) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3714 a Black 0 TeXcolorgray 596 3822
a
SDict begin H.S end
 596 3822 a Fj(4.12.)g(Disconnected)h(Reliability)h(\(T)m(itanic)g(P)o
(attern\))2170 3822 y
SDict begin 13 H.L end
 2170 3822 a 2170 3822 a
SDict begin [/Subtype /Link/Dest (0:2303) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2170 3822
a Black Black 7 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3822
a
SDict begin H.S end
 3759 3822 a Fj(199)3885 3822 y
SDict begin 13 H.L end
 3885 3822 a 3885 3822
a
SDict begin [/Subtype /Link/Dest (0:2303) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3822 a Black 0 TeXcolorgray 596 3930 a
SDict begin H.S end
 596 3930
a Fj(4.13.)e(High-a)n(v)n(ailability)h(P)o(air)h(\(Binary)f(Star)i(P)o
(attern\))2212 3930 y
SDict begin 13 H.L end
 2212 3930 a 2212 3930 a
SDict begin [/Subtype /Link/Dest (0:2407) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2212 3930
a Black Black 7 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3930 a
SDict begin H.S end
 3759 3930 a Fj(210)3885 3930 y
SDict begin 13 H.L end
 3885 3930
a 3885 3930 a
SDict begin [/Subtype /Link/Dest (0:2407) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3930 a Black 0 TeXcolorgray 795 4038
a
SDict begin H.S end
 795 4038 a Fj(4.13.1.)d(Ov)o(ervie)n(w)1370 4038 y
SDict begin 13 H.L end

1370 4038 a 1370 4038 a
SDict begin [/Subtype /Link/Dest (0:2409) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1370 4038 a Black Black 18 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 4038 a
SDict begin H.S end
 3759
4038 a Fj(210)3885 4038 y
SDict begin 13 H.L end
 3885 4038 a 3885 4038 a
SDict begin [/Subtype /Link/Dest (0:2409) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
4038 a Black 0 TeXcolorgray 795 4146 a
SDict begin H.S end
 795 4146 a Fj(4.13.2.)g
(Detailed)i(Requirements)1809 4146 y
SDict begin 13 H.L end
 1809 4146 a 1809
4146 a
SDict begin [/Subtype /Link/Dest (0:2465) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1809 4146 a Black Black 15 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4146 a
SDict begin H.S end
 3759 4146
a Fj(213)3885 4146 y
SDict begin 13 H.L end
 3885 4146 a 3885 4146 a
SDict begin [/Subtype /Link/Dest (0:2465) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4146
a Black 0 TeXcolorgray 795 4253 a
SDict begin H.S end
 795 4253 a Fj(4.13.3.)e(Pre)n(v)o
(enting)g(Split-Brain)i(Syndrome)2155 4253 y
SDict begin 13 H.L end
 2155 4253
a 2155 4253 a
SDict begin [/Subtype /Link/Dest (0:2558) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2155 4253 a Black Black 1 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4253 a
SDict begin H.S end
 3759 4253
a Fj(215)3885 4253 y
SDict begin 13 H.L end
 3885 4253 a 3885 4253 a
SDict begin [/Subtype /Link/Dest (0:2558) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4253
a Black 0 TeXcolorgray 795 4361 a
SDict begin H.S end
 795 4361 a Fj(4.13.4.)e(Binary)i
(Star)g(Implementation)1974 4361 y
SDict begin 13 H.L end
 1974 4361 a 1974 4361
a
SDict begin [/Subtype /Link/Dest (0:2566) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1974 4361 a Black Black 16 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4361 a
SDict begin H.S end
 3759 4361 a Fj(216)3885 4361 y
SDict begin 13 H.L end
 3885 4361
a 3885 4361 a
SDict begin [/Subtype /Link/Dest (0:2566) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4361 a Black 0 TeXcolorgray 795 4469
a
SDict begin H.S end
 795 4469 a Fj(4.13.5.)e(Binary)i(Star)g(Reactor)1704
4469 y
SDict begin 13 H.L end
 1704 4469 a 1704 4469 a
SDict begin [/Subtype /Link/Dest (0:2601) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1704 4469 a Black Black
16 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4469 a
SDict begin H.S end
 3759 4469
a Fj(217)3885 4469 y
SDict begin 13 H.L end
 3885 4469 a 3885 4469 a
SDict begin [/Subtype /Link/Dest (0:2601) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4469
a Black 0 TeXcolorgray 596 4577 a
SDict begin H.S end
 596 4577 a Fj(4.14.)e(Brok)o(erless)i
(Reliability)h(\(Freelance)e(P)o(attern\))2163 4577 y
SDict begin 13 H.L end

2163 4577 a 2163 4577 a
SDict begin [/Subtype /Link/Dest (0:2615) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2163 4577 a Black Black 14 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4577 a
SDict begin H.S end
 3759 4577
a Fj(218)3885 4577 y
SDict begin 13 H.L end
 3885 4577 a 3885 4577 a
SDict begin [/Subtype /Link/Dest (0:2615) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4577
a Black 0 TeXcolorgray 795 4685 a
SDict begin H.S end
 795 4685 a Fj(4.14.1.)f(Model)h(One)h
(-)h(Simple)f(Retry)g(and)g(F)o(ailo)o(v)o(er)2366 4685
y
SDict begin 13 H.L end
 2366 4685 a 2366 4685 a
SDict begin [/Subtype /Link/Dest (0:2646) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2366 4685 a Black Black -2
w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4685 a
SDict begin H.S end
 3759 4685
a Fj(220)3885 4685 y
SDict begin 13 H.L end
 3885 4685 a 3885 4685 a
SDict begin [/Subtype /Link/Dest (0:2646) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4685
a Black 0 TeXcolorgray 795 4793 a
SDict begin H.S end
 795 4793 a Fj(4.14.2.)e(Model)h(T)-7
b(w)o(o)21 b(-)f(Brutal)h(Shotgun)d(Massacre)2335 4793
y
SDict begin 13 H.L end
 2335 4793 a 2335 4793 a
SDict begin [/Subtype /Link/Dest (0:2666) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2335 4793 a Black Black 8 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4793 a
SDict begin H.S end
 3759 4793 a Fj(223)3885 4793 y
SDict begin 13 H.L end
 3885 4793
a 3885 4793 a
SDict begin [/Subtype /Link/Dest (0:2666) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4793 a Black 0 TeXcolorgray 795 4901
a
SDict begin H.S end
 795 4901 a Fj(4.14.3.)g(Model)h(Three)h(-)g(Comple)o(x)f(and)h(Nasty)
2203 4901 y
SDict begin 13 H.L end
 2203 4901 a 2203 4901 a
SDict begin [/Subtype /Link/Dest (0:2711) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2203 4901 a Black
Black 16 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4901 a
SDict begin H.S end
 3759 4901 a Fj(227)3885 4901 y
SDict begin 13 H.L end
 3885 4901
a 3885 4901 a
SDict begin [/Subtype /Link/Dest (0:2711) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4901 a Black 0 TeXcolorgray 596 5009
a
SDict begin H.S end
 596 5009 a Fj(4.15.)e(Conclusion)1162 5009 y
SDict begin 13 H.L end
 1162 5009
a 1162 5009 a
SDict begin [/Subtype /Link/Dest (0:2748) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1162 5009 a Black Black 19 w Fj(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 5009 a
SDict begin H.S end
 3759
5009 a Fj(229)3885 5009 y
SDict begin 13 H.L end
 3885 5009 a 3885 5009 a
SDict begin [/Subtype /Link/Dest (0:2748) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
5009 a Black Black 3846 5569 a Fi(v)p Black eop end
%%Page: 6 6
TeXDict begin 6 5 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.vi) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black 0 TeXcolorgray 396 72 a
SDict begin H.S end
 396 72 a Fk(5.)20
b(Adv)o(anced)g(Publish-Subscribe)i(P)o(atter)o(ns)1820
72 y
SDict begin 13 H.L end
 1820 72 a 1820 72 a
SDict begin [/Subtype /Link/Dest (0:advanced-pub-sub) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1820 72 a Black Black 4 w Fk(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 72
a
SDict begin H.S end
 3759 72 a Fk(230)3885 72 y
SDict begin 13 H.L end
 3885 72 a 3885 72 a
SDict begin [/Subtype /Link/Dest (0:advanced-pub-sub) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885
72 a Black 0 TeXcolorgray 596 200 a
SDict begin H.S end
 596 200 a Fj(5.1.)d(Slo)n(w)h
(Subscriber)f(Detection)h(\(Suicidal)f(Snail)i(P)o(attern\))2425
200 y
SDict begin 13 H.L end
 2425 200 a 2425 200 a
SDict begin [/Subtype /Link/Dest (0:2774) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2425 200 a Black Black 1
w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 200 a
SDict begin H.S end
 3759
200 a Fj(230)3885 200 y
SDict begin 13 H.L end
 3885 200 a 3885 200 a
SDict begin [/Subtype /Link/Dest (0:2774) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 200
a Black 0 TeXcolorgray 596 308 a
SDict begin H.S end
 596 308 a Fj(5.2.)e(High-speed)f
(Subscribers)h(\(Black)i(Box)f(P)o(attern\))2217 308
y
SDict begin 13 H.L end
 2217 308 a 2217 308 a
SDict begin [/Subtype /Link/Dest (0:2807) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2217 308 a Black Black 2 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 308
a
SDict begin H.S end
 3759 308 a Fj(233)3885 308 y
SDict begin 13 H.L end
 3885 308 a 3885 308 a
SDict begin [/Subtype /Link/Dest (0:2807) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3885 308 a Black 0 TeXcolorgray 596 416 a
SDict begin H.S end
 596 416 a Fj(5.3.)f(A)i
(Shared)e(K)n(e)o(y-V)-9 b(alue)18 b(Cache)i(\(Clone)g(P)o(attern\))
2183 416 y
SDict begin 13 H.L end
 2183 416 a 2183 416 a
SDict begin [/Subtype /Link/Dest (0:2856) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2183 416 a Black Black
15 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 416 a
SDict begin H.S end
 3759 416 a Fj(236)3885 416
y
SDict begin 13 H.L end
 3885 416 a 3885 416 a
SDict begin [/Subtype /Link/Dest (0:2856) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 416 a Black 0 TeXcolorgray
795 524 a
SDict begin H.S end
 795 524 a Fj(5.3.1.)e(Distrib)n(uting)i(K)n(e)o(y-V)-9
b(alue)18 b(Updates)2068 524 y
SDict begin 13 H.L end
 2068 524 a 2068 524 a
SDict begin [/Subtype /Link/Dest (0:2895) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

2068 524 a Black Black 5 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 524 a
SDict begin H.S end
 3759 524 a
Fj(237)3885 524 y
SDict begin 13 H.L end
 3885 524 a 3885 524 a
SDict begin [/Subtype /Link/Dest (0:2895) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 524 a Black
0 TeXcolorgray 795 632 a
SDict begin H.S end
 795 632 a Fj(5.3.2.)g(Getting)i(a)h(Snapshot)
1636 632 y
SDict begin 13 H.L end
 1636 632 a 1636 632 a
SDict begin [/Subtype /Link/Dest (0:2930) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1636 632 a Black Black
1 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 632
a
SDict begin H.S end
 3759 632 a Fj(239)3885 632 y
SDict begin 13 H.L end
 3885 632 a 3885 632 a
SDict begin [/Subtype /Link/Dest (0:2930) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3885 632 a Black 0 TeXcolorgray 795 740 a
SDict begin H.S end
 795 740 a Fj(5.3.3.)d
(Republishing)h(Updates)1739 740 y
SDict begin 13 H.L end
 1739 740 a 1739 740
a
SDict begin [/Subtype /Link/Dest (0:2974) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1739 740 a Black Black 2 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 740 a
SDict begin H.S end
 3759
740 a Fj(241)3885 740 y
SDict begin 13 H.L end
 3885 740 a 3885 740 a
SDict begin [/Subtype /Link/Dest (0:2974) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 740
a Black 0 TeXcolorgray 795 848 a
SDict begin H.S end
 795 848 a Fj(5.3.4.)f(Clone)i
(Subtrees)1508 848 y
SDict begin 13 H.L end
 1508 848 a 1508 848 a
SDict begin [/Subtype /Link/Dest (0:3005) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1508 848 a
Black Black 5 w Fj(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 848 a
SDict begin H.S end
 3759 848 a Fj(242)3885 848 y
SDict begin 13 H.L end
 3885 848 a 3885
848 a
SDict begin [/Subtype /Link/Dest (0:3005) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 848 a Black 0 TeXcolorgray 795 956 a
SDict begin H.S end
 795 956
a Fj(5.3.5.)e(Ephemeral)h(V)-9 b(alues)1605 956 y
SDict begin 13 H.L end
 1605
956 a 1605 956 a
SDict begin [/Subtype /Link/Dest (0:3023) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1605 956 a Black Black 12 w Fj(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 956 a
SDict begin H.S end
 3759 956 a Fj(243)3885 956 y
SDict begin 13 H.L end
 3885 956 a 3885
956 a
SDict begin [/Subtype /Link/Dest (0:3023) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 956 a Black 0 TeXcolorgray 795 1064 a
SDict begin H.S end
 795
1064 a Fj(5.3.6.)18 b(Clone)i(Serv)o(er)g(Reliability)1809
1064 y
SDict begin 13 H.L end
 1809 1064 a 1809 1064 a
SDict begin [/Subtype /Link/Dest (0:3041) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1809 1064 a Black Black
15 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1064 a
SDict begin H.S end
 3759 1064 a Fj(244)3885 1064 y
SDict begin 13 H.L end
 3885 1064
a 3885 1064 a
SDict begin [/Subtype /Link/Dest (0:3041) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1064 a Black 0 TeXcolorgray 795 1172
a
SDict begin H.S end
 795 1172 a Fj(5.3.7.)e(Clone)i(Protocol)g(Speci\002cation)1959
1172 y
SDict begin 13 H.L end
 1959 1172 a 1959 1172 a
SDict begin [/Subtype /Link/Dest (0:3160) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1959 1172 a Black Black
11 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 1172
a
SDict begin H.S end
 3759 1172 a Fj(250)3885 1172 y
SDict begin 13 H.L end
 3885 1172 a 3885 1172
a
SDict begin [/Subtype /Link/Dest (0:3160) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1172 a Black 0 TeXcolorgray 596 1280 a
SDict begin H.S end
 596 1280
a Fj(5.4.)f(The)h(Espresso)g(P)o(attern)1442 1280 y
SDict begin 13 H.L end
 1442
1280 a 1442 1280 a
SDict begin [/Subtype /Link/Dest (0:3167) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1442 1280 a Black Black 9 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 1280 a
SDict begin H.S end
 3759
1280 a Fj(250)3885 1280 y
SDict begin 13 H.L end
 3885 1280 a 3885 1280 a
SDict begin [/Subtype /Link/Dest (0:3167) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
1280 a Black 0 TeXcolorgray 596 1388 a
SDict begin H.S end
 596 1388 a Fj(5.5.)f(Last)i(V)-9
b(alue)19 b(Caching)1392 1388 y
SDict begin 13 H.L end
 1392 1388 a 1392 1388
a
SDict begin [/Subtype /Link/Dest (0:3174) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1392 1388 a Black Black 17 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1388 a
SDict begin H.S end
 3759 1388 a Fj(250)3885 1388 y
SDict begin 13 H.L end
 3885 1388
a 3885 1388 a
SDict begin [/Subtype /Link/Dest (0:3174) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1388 a Black 0 TeXcolorgray 396 1515
a
SDict begin H.S end
 396 1515 a Fk(6.)h(The)h(Human)g(Scale)1112 1515 y
SDict begin 13 H.L end

1112 1515 a 1112 1515 a
SDict begin [/Subtype /Link/Dest (0:the-human-scale) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1112 1515 a Black Black 7 w Fk(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 1515
a
SDict begin H.S end
 3759 1515 a Fk(253)3885 1515 y
SDict begin 13 H.L end
 3885 1515 a 3885 1515
a
SDict begin [/Subtype /Link/Dest (0:the-human-scale) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1515 a Black 0 TeXcolorgray 596 1643 a
SDict begin H.S end
 596 1643
a Fj(6.1.)e(The)h(T)-7 b(ale)20 b(of)g(T)-7 b(w)o(o)21
b(Bridges)1567 1643 y
SDict begin 13 H.L end
 1567 1643 a 1567 1643 a
SDict begin [/Subtype /Link/Dest (0:3235) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1567 1643
a Black Black 8 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1643 a
SDict begin H.S end
 3759 1643 a Fj(253)3885 1643 y
SDict begin 13 H.L end
 3885 1643
a 3885 1643 a
SDict begin [/Subtype /Link/Dest (0:3235) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1643 a Black 0 TeXcolorgray 596 1751
a
SDict begin H.S end
 596 1751 a Fj(6.2.)e(Code)h(on)g(the)g(Human)f(Scale)1608
1751 y
SDict begin 13 H.L end
 1608 1751 a 1608 1751 a
SDict begin [/Subtype /Link/Dest (0:3241) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1608 1751 a Black Black
9 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 1751 a
SDict begin H.S end
 3759 1751 a Fj(254)3885 1751
y
SDict begin 13 H.L end
 3885 1751 a 3885 1751 a
SDict begin [/Subtype /Link/Dest (0:3241) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1751 a Black 0 TeXcolorgray
596 1859 a
SDict begin H.S end
 596 1859 a Fj(6.3.)g(Psychology)f(of)i(Softw)o(are)g(De)n(v)
o(elopment)2006 1859 y
SDict begin 13 H.L end
 2006 1859 a 2006 1859 a
SDict begin [/Subtype /Link/Dest (0:3251) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2006 1859
a Black Black 5 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1859 a
SDict begin H.S end
 3759 1859 a Fj(255)3885
1859 y
SDict begin 13 H.L end
 3885 1859 a 3885 1859 a
SDict begin [/Subtype /Link/Dest (0:3251) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1859 a Black 0 TeXcolorgray
596 1967 a
SDict begin H.S end
 596 1967 a Fj(6.4.)f(The)h(Bad,)g(the)g(Ugly)-5
b(,)19 b(and)h(the)g(Delicious)1972 1967 y
SDict begin 13 H.L end
 1972 1967
a 1972 1967 a
SDict begin [/Subtype /Link/Dest (0:3294) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1972 1967 a Black Black 18 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1967 a
SDict begin H.S end
 3759 1967 a Fj(256)3885 1967 y
SDict begin 13 H.L end
 3885 1967
a 3885 1967 a
SDict begin [/Subtype /Link/Dest (0:3294) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1967 a Black 0 TeXcolorgray 795 2075
a
SDict begin H.S end
 795 2075 a Fj(6.4.1.)e(T)m(rash-Oriented)g(Design)1763
2075 y
SDict begin 13 H.L end
 1763 2075 a 1763 2075 a
SDict begin [/Subtype /Link/Dest (0:3302) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1763 2075 a Black Black
20 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 2075 a
SDict begin H.S end
 3759
2075 a Fj(257)3885 2075 y
SDict begin 13 H.L end
 3885 2075 a 3885 2075 a
SDict begin [/Subtype /Link/Dest (0:3302) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
2075 a Black 0 TeXcolorgray 795 2183 a
SDict begin H.S end
 795 2183 a Fj(6.4.2.)g(Comple)o
(xity-Oriented)f(Design)1968 2183 y
SDict begin 13 H.L end
 1968 2183 a 1968
2183 a
SDict begin [/Subtype /Link/Dest (0:3333) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1968 2183 a Black Black 2 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2183 a
SDict begin H.S end
 3759 2183 a Fj(258)3885
2183 y
SDict begin 13 H.L end
 3885 2183 a 3885 2183 a
SDict begin [/Subtype /Link/Dest (0:3333) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2183 a Black 0 TeXcolorgray
795 2291 a
SDict begin H.S end
 795 2291 a Fj(6.4.3.)h(Simplicity-Oriented)g(Design)1923
2291 y
SDict begin 13 H.L end
 1923 2291 a 1923 2291 a
SDict begin [/Subtype /Link/Dest (0:3364) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1923 2291 a Black Black
5 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2291 a
SDict begin H.S end
 3759 2291 a Fj(260)3885
2291 y
SDict begin 13 H.L end
 3885 2291 a 3885 2291 a
SDict begin [/Subtype /Link/Dest (0:3364) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2291 a Black 0 TeXcolorgray
596 2399 a
SDict begin H.S end
 596 2399 a Fj(6.5.)h(Message)h(Oriented)f(P)o(attern)h(for)g
(Elastic)g(Design)2218 2399 y
SDict begin 13 H.L end
 2218 2399 a 2218 2399 a
SDict begin [/Subtype /Link/Dest (0:3393) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

2218 2399 a Black Black 1 w Fj(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2399 a
SDict begin H.S end
 3759 2399 a Fj(261)3885
2399 y
SDict begin 13 H.L end
 3885 2399 a 3885 2399 a
SDict begin [/Subtype /Link/Dest (0:3393) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2399 a Black 0 TeXcolorgray
795 2507 a
SDict begin H.S end
 795 2507 a Fj(6.5.1.)e(Step)j(1:)f(Internalize)f(the)h
(Semantics)2096 2507 y
SDict begin 13 H.L end
 2096 2507 a 2096 2507 a
SDict begin [/Subtype /Link/Dest (0:3415) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2096 2507
a Black Black 19 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 2507
a
SDict begin H.S end
 3759 2507 a Fj(262)3885 2507 y
SDict begin 13 H.L end
 3885 2507 a 3885 2507
a
SDict begin [/Subtype /Link/Dest (0:3415) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2507 a Black 0 TeXcolorgray 795 2615 a
SDict begin H.S end
 795 2615
a Fj(6.5.2.)e(Step)j(2:)f(Dra)o(w)g(a)h(Rough)e(Architecture)2177
2615 y
SDict begin 13 H.L end
 2177 2615 a 2177 2615 a
SDict begin [/Subtype /Link/Dest (0:3421) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2177 2615 a Black Black
Fj(.)p Black Black(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2615 a
SDict begin H.S end
 3759 2615
a Fj(262)3885 2615 y
SDict begin 13 H.L end
 3885 2615 a 3885 2615 a
SDict begin [/Subtype /Link/Dest (0:3421) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2615
a Black 0 TeXcolorgray 795 2723 a
SDict begin H.S end
 795 2723 a Fj(6.5.3.)f(Step)j(3:)f
(Decide)g(on)g(the)g(Contracts)2057 2723 y
SDict begin 13 H.L end
 2057 2723
a 2057 2723 a
SDict begin [/Subtype /Link/Dest (0:3426) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2057 2723 a Black Black 16 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 2723
a
SDict begin H.S end
 3759 2723 a Fj(262)3885 2723 y
SDict begin 13 H.L end
 3885 2723 a 3885 2723
a
SDict begin [/Subtype /Link/Dest (0:3426) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2723 a Black 0 TeXcolorgray 795 2830 a
SDict begin H.S end
 795 2830
a Fj(6.5.4.)e(Step)j(4:)f(Write)h(a)f(Minimal)g(End-to-End)d(Solution)
2521 2830 y
SDict begin 13 H.L end
 2521 2830 a 2521 2830 a
SDict begin [/Subtype /Link/Dest (0:3441) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2521 2830 a Black
Black 9 w Fj(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2830 a
SDict begin H.S end
 3759 2830 a Fj(263)3885 2830
y
SDict begin 13 H.L end
 3885 2830 a 3885 2830 a
SDict begin [/Subtype /Link/Dest (0:3441) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2830 a Black 0 TeXcolorgray
795 2938 a
SDict begin H.S end
 795 2938 a Fj(6.5.5.)h(Step)j(5:)f(Solv)o(e)g(One)g(Problem)
f(and)g(Repeat)2297 2938 y
SDict begin 13 H.L end
 2297 2938 a 2297 2938 a
SDict begin [/Subtype /Link/Dest (0:3448) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2297
2938 a Black Black 5 w Fj(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2938 a
SDict begin H.S end
 3759 2938 a Fj(264)3885 2938 y
SDict begin 13 H.L end
 3885 2938
a 3885 2938 a
SDict begin [/Subtype /Link/Dest (0:3448) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2938 a Black 0 TeXcolorgray 596 3046
a
SDict begin H.S end
 596 3046 a Fj(6.6.)g(Unprotocols)1154 3046 y
SDict begin 13 H.L end
 1154 3046
a 1154 3046 a
SDict begin [/Subtype /Link/Dest (0:3453) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1154 3046 a Black Black 6 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3046 a
SDict begin H.S end
 3759 3046 a Fj(264)3885 3046 y
SDict begin 13 H.L end
 3885 3046
a 3885 3046 a
SDict begin [/Subtype /Link/Dest (0:3453) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3046 a Black 0 TeXcolorgray 795 3154
a
SDict begin H.S end
 795 3154 a Fj(6.6.1.)f(Why)i(Unprotocols?)1634 3154
y
SDict begin 13 H.L end
 1634 3154 a 1634 3154 a
SDict begin [/Subtype /Link/Dest (0:3455) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1634 3154 a Black Black 3 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3154
a
SDict begin H.S end
 3759 3154 a Fj(264)3885 3154 y
SDict begin 13 H.L end
 3885 3154 a 3885 3154
a
SDict begin [/Subtype /Link/Dest (0:3455) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3154 a Black 0 TeXcolorgray 795 3262 a
SDict begin H.S end
 795 3262
a Fj(6.6.2.)e(Ho)n(w)i(to)h(Write)g(Unprotocols)1891
3262 y
SDict begin 13 H.L end
 1891 3262 a 1891 3262 a
SDict begin [/Subtype /Link/Dest (0:3466) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1891 3262 a Black Black
16 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3262 a
SDict begin H.S end
 3759
3262 a Fj(265)3885 3262 y
SDict begin 13 H.L end
 3885 3262 a 3885 3262 a
SDict begin [/Subtype /Link/Dest (0:3466) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3262 a Black 0 TeXcolorgray 795 3370 a
SDict begin H.S end
 795 3370 a Fj(6.6.3.)d(Why)i
(use)g(the)h(GPLv3)e(for)h(Public)g(Speci\002cations?)2553
3370 y
SDict begin 13 H.L end
 2553 3370 a 2553 3370 a
SDict begin [/Subtype /Link/Dest (0:3504) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2553 3370 a Black Black
18 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 3370 a
SDict begin H.S end
 3759 3370 a Fj(266)3885
3370 y
SDict begin 13 H.L end
 3885 3370 a 3885 3370 a
SDict begin [/Subtype /Link/Dest (0:3504) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3370 a Black 0 TeXcolorgray
795 3478 a
SDict begin H.S end
 795 3478 a Fj(6.6.4.)e(Using)i(ABNF)1442 3478
y
SDict begin 13 H.L end
 1442 3478 a 1442 3478 a
SDict begin [/Subtype /Link/Dest (0:3514) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1442 3478 a Black Black 9 w
Fj(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3478 a
SDict begin H.S end
 3759
3478 a Fj(266)3885 3478 y
SDict begin 13 H.L end
 3885 3478 a 3885 3478 a
SDict begin [/Subtype /Link/Dest (0:3514) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3478 a Black 0 TeXcolorgray 596 3586 a
SDict begin H.S end
 596 3586 a Fj(6.7.)f
(Serializing)g(your)g(Data)1451 3586 y
SDict begin 13 H.L end
 1451 3586 a 1451
3586 a
SDict begin [/Subtype /Link/Dest (0:3525) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1451 3586 a Black Black 20 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3586 a
SDict begin H.S end
 3759 3586 a Fj(267)3885 3586 y
SDict begin 13 H.L end
 3885 3586
a 3885 3586 a
SDict begin [/Subtype /Link/Dest (0:3525) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3586 a Black 0 TeXcolorgray 795 3694
a
SDict begin H.S end
 795 3694 a Fj(6.7.1.)f(Cheap)i(and)g(Nasty)1570 3694
y
SDict begin 13 H.L end
 1570 3694 a 1570 3694 a
SDict begin [/Subtype /Link/Dest (0:3529) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1570 3694 a Black Black 5 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3694
a
SDict begin H.S end
 3759 3694 a Fj(268)3885 3694 y
SDict begin 13 H.L end
 3885 3694 a 3885 3694
a
SDict begin [/Subtype /Link/Dest (0:3529) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3694 a Black 0 TeXcolorgray 795 3802 a
SDict begin H.S end
 795 3802
a Fj(6.7.2.)e(\330MQ)j(Framing)1500 3802 y
SDict begin 13 H.L end
 1500 3802
a 1500 3802 a
SDict begin [/Subtype /Link/Dest (0:3565) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1500 3802 a Black Black 13 w Fj(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 3802 a
SDict begin H.S end
 3759 3802
a Fj(269)3885 3802 y
SDict begin 13 H.L end
 3885 3802 a 3885 3802 a
SDict begin [/Subtype /Link/Dest (0:3565) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3802
a Black 0 TeXcolorgray 795 3910 a
SDict begin H.S end
 795 3910 a Fj(6.7.3.)d(Serialization)
i(Languages)1805 3910 y
SDict begin 13 H.L end
 1805 3910 a 1805 3910 a
SDict begin [/Subtype /Link/Dest (0:3575) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1805
3910 a Black Black -2 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3910 a
SDict begin H.S end
 3759
3910 a Fj(270)3885 3910 y
SDict begin 13 H.L end
 3885 3910 a 3885 3910 a
SDict begin [/Subtype /Link/Dest (0:3575) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3910 a Black 0 TeXcolorgray 795 4018 a
SDict begin H.S end
 795 4018 a Fj(6.7.4.)e
(Serialization)i(Libraries)1744 4018 y
SDict begin 13 H.L end
 1744 4018 a 1744
4018 a
SDict begin [/Subtype /Link/Dest (0:3589) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1744 4018 a Black Black 18 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4018 a
SDict begin H.S end
 3759 4018
a Fj(271)3885 4018 y
SDict begin 13 H.L end
 3885 4018 a 3885 4018 a
SDict begin [/Subtype /Link/Dest (0:3589) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4018
a Black 0 TeXcolorgray 795 4126 a
SDict begin H.S end
 795 4126 a Fj(6.7.5.)e(Hand-written)h
(Binary)g(Serialization)2133 4126 y
SDict begin 13 H.L end
 2133 4126 a 2133
4126 a
SDict begin [/Subtype /Link/Dest (0:3603) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2133 4126 a Black Black 3 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 4126
a
SDict begin H.S end
 3759 4126 a Fj(272)3885 4126 y
SDict begin 13 H.L end
 3885 4126 a 3885 4126
a
SDict begin [/Subtype /Link/Dest (0:3603) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4126 a Black 0 TeXcolorgray 795 4234 a
SDict begin H.S end
 795 4234
a Fj(6.7.6.)f(Code)i(Generation)1569 4234 y
SDict begin 13 H.L end
 1569 4234
a 1569 4234 a
SDict begin [/Subtype /Link/Dest (0:3636) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1569 4234 a Black Black 6 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4234 a
SDict begin H.S end
 3759 4234
a Fj(273)3885 4234 y
SDict begin 13 H.L end
 3885 4234 a 3885 4234 a
SDict begin [/Subtype /Link/Dest (0:3636) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4234
a Black 0 TeXcolorgray 596 4341 a
SDict begin H.S end
 596 4341 a Fj(6.8.)f(T)m(ransferring)
f(Files)1335 4341 y
SDict begin 13 H.L end
 1335 4341 a 1335 4341 a
SDict begin [/Subtype /Link/Dest (0:3718) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1335 4341
a Black Black 12 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 4341 a
SDict begin H.S end
 3759
4341 a Fj(279)3885 4341 y
SDict begin 13 H.L end
 3885 4341 a 3885 4341 a
SDict begin [/Subtype /Link/Dest (0:3718) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
4341 a Black 0 TeXcolorgray 596 4449 a
SDict begin H.S end
 596 4449 a Fj(6.9.)h
(Heartbeating)1172 4449 y
SDict begin 13 H.L end
 1172 4449 a 1172 4449 a
SDict begin [/Subtype /Link/Dest (0:3805) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1172
4449 a Black Black 9 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 4449 a
SDict begin H.S end
 3759 4449 a Fj(285)3885 4449
y
SDict begin 13 H.L end
 3885 4449 a 3885 4449 a
SDict begin [/Subtype /Link/Dest (0:3805) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4449 a Black 0 TeXcolorgray
795 4557 a
SDict begin H.S end
 795 4557 a Fj(6.9.1.)f(Shrugging)g(It)j(Of)n(f)1555
4557 y
SDict begin 13 H.L end
 1555 4557 a 1555 4557 a
SDict begin [/Subtype /Link/Dest (0:3809) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1555 4557 a Black Black
-1 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4557 a
SDict begin H.S end
 3759 4557 a Fj(285)3885 4557 y
SDict begin 13 H.L end
 3885 4557
a 3885 4557 a
SDict begin [/Subtype /Link/Dest (0:3809) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4557 a Black 0 TeXcolorgray 795 4665
a
SDict begin H.S end
 795 4665 a Fj(6.9.2.)d(One-W)-7 b(ay)20 b(Heartbeats)1695
4665 y
SDict begin 13 H.L end
 1695 4665 a 1695 4665 a
SDict begin [/Subtype /Link/Dest (0:3819) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1695 4665 a Black Black
5 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4665 a
SDict begin H.S end
 3759 4665 a Fj(285)3885 4665 y
SDict begin 13 H.L end
 3885 4665
a 3885 4665 a
SDict begin [/Subtype /Link/Dest (0:3819) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4665 a Black 0 TeXcolorgray 795 4773
a
SDict begin H.S end
 795 4773 a Fj(6.9.3.)e(Ping-Pong)h(Heartbeats)1730
4773 y
SDict begin 13 H.L end
 1730 4773 a 1730 4773 a
SDict begin [/Subtype /Link/Dest (0:3833) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1730 4773 a Black Black
11 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 4773 a
SDict begin H.S end
 3759 4773 a Fj(286)3885 4773
y
SDict begin 13 H.L end
 3885 4773 a 3885 4773 a
SDict begin [/Subtype /Link/Dest (0:3833) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4773 a Black 0 TeXcolorgray
596 4881 a
SDict begin H.S end
 596 4881 a Fj(6.10.)f(State)j(Machines)1293
4881 y
SDict begin 13 H.L end
 1293 4881 a 1293 4881 a
SDict begin [/Subtype /Link/Dest (0:3837) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1293 4881 a Black Black
12 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4881 a
SDict begin H.S end
 3759 4881 a Fj(286)3885 4881 y
SDict begin 13 H.L end
 3885 4881
a 3885 4881 a
SDict begin [/Subtype /Link/Dest (0:3837) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4881 a Black 0 TeXcolorgray 596 4989
a
SDict begin H.S end
 596 4989 a Fj(6.11.)d(Authentication)h(using)g(SASL)1700
4989 y
SDict begin 13 H.L end
 1700 4989 a 1700 4989 a
SDict begin [/Subtype /Link/Dest (0:3939) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1700 4989 a Black Black
20 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4989 a
SDict begin H.S end
 3759 4989
a Fj(293)3885 4989 y
SDict begin 13 H.L end
 3885 4989 a 3885 4989 a
SDict begin [/Subtype /Link/Dest (0:3939) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4989
a Black 0 TeXcolorgray 596 5097 a
SDict begin H.S end
 596 5097 a Fj(6.12.)f(Lar)o(ge-scale)
h(File)i(Publishing)1696 5097 y
SDict begin 13 H.L end
 1696 5097 a 1696 5097
a
SDict begin [/Subtype /Link/Dest (0:3964) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1696 5097 a Black Black 4 w Fj(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 5097 a
SDict begin H.S end
 3759 5097 a Fj(295)3885
5097 y
SDict begin 13 H.L end
 3885 5097 a 3885 5097 a
SDict begin [/Subtype /Link/Dest (0:3964) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 5097 a Black Black
3823 5569 a Fi(vi)p Black eop end
%%Page: 7 7
TeXDict begin 7 6 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.vii) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black 0 TeXcolorgray 795 72 a
SDict begin H.S end
 795 72 a Fj(6.12.1.)18
b(Why)i(mak)o(e)f(FileMQ?)1725 72 y
SDict begin 13 H.L end
 1725 72 a 1725 72
a
SDict begin [/Subtype /Link/Dest (0:3968) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1725 72 a Black Black 16 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 72 a
SDict begin H.S end
 3759 72
a Fj(295)3885 72 y
SDict begin 13 H.L end
 3885 72 a 3885 72 a
SDict begin [/Subtype /Link/Dest (0:3968) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 72 a Black
0 TeXcolorgray 795 180 a
SDict begin H.S end
 795 180 a Fj(6.12.2.)f(Initial)i(Design)g(Cut)
h(-)f(the)g(API)1964 180 y
SDict begin 13 H.L end
 1964 180 a 1964 180 a
SDict begin [/Subtype /Link/Dest (0:3976) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1964
180 a Black Black 6 w Fj(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 180 a
SDict begin H.S end
 3759 180 a Fj(295)3885 180 y
SDict begin 13 H.L end
 3885 180 a 3885
180 a
SDict begin [/Subtype /Link/Dest (0:3976) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 180 a Black 0 TeXcolorgray 795 288 a
SDict begin H.S end
 795 288
a Fj(6.12.3.)e(Initial)i(Design)g(Cut)h(-)f(the)g(Protocol)2113
288 y
SDict begin 13 H.L end
 2113 288 a 2113 288 a
SDict begin [/Subtype /Link/Dest (0:3983) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2113 288 a Black Black 2
w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 288 a
SDict begin H.S end
 3759 288 a Fj(296)3885
288 y
SDict begin 13 H.L end
 3885 288 a 3885 288 a
SDict begin [/Subtype /Link/Dest (0:3983) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 288 a Black 0 TeXcolorgray
795 396 a
SDict begin H.S end
 795 396 a Fj(6.12.4.)e(Building)h(and)h(T)m(rying)f(FileMQ)
2003 396 y
SDict begin 13 H.L end
 2003 396 a 2003 396 a
SDict begin [/Subtype /Link/Dest (0:3993) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2003 396 a Black Black
8 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 396 a
SDict begin H.S end
 3759 396 a Fj(298)3885 396 y
SDict begin 13 H.L end
 3885 396 a 3885
396 a
SDict begin [/Subtype /Link/Dest (0:3993) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 396 a Black 0 TeXcolorgray 795 504 a
SDict begin H.S end
 795 504
a Fj(6.12.5.)f(Internal)h(Architecture)1740 504 y
SDict begin 13 H.L end
 1740
504 a 1740 504 a
SDict begin [/Subtype /Link/Dest (0:4005) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1740 504 a Black Black 1 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 504 a
SDict begin H.S end
 3759 504 a Fj(298)3885 504 y
SDict begin 13 H.L end
 3885 504 a 3885
504 a
SDict begin [/Subtype /Link/Dest (0:4005) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 504 a Black 0 TeXcolorgray 795 612 a
SDict begin H.S end
 795 612
a Fj(6.12.6.)f(Public)i(API)1411 612 y
SDict begin 13 H.L end
 1411 612 a 1411
612 a
SDict begin [/Subtype /Link/Dest (0:4041) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1411 612 a Black Black 19 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 612 a
SDict begin H.S end
 3759
612 a Fj(300)3885 612 y
SDict begin 13 H.L end
 3885 612 a 3885 612 a
SDict begin [/Subtype /Link/Dest (0:4041) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 612
a Black 0 TeXcolorgray 795 720 a
SDict begin H.S end
 795 720 a Fj(6.12.7.)e(Design)i(Notes)
1494 720 y
SDict begin 13 H.L end
 1494 720 a 1494 720 a
SDict begin [/Subtype /Link/Dest (0:4052) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1494 720 a Black Black
19 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 720
a
SDict begin H.S end
 3759 720 a Fj(300)3885 720 y
SDict begin 13 H.L end
 3885 720 a 3885 720 a
SDict begin [/Subtype /Link/Dest (0:4052) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3885 720 a Black 0 TeXcolorgray 795 828 a
SDict begin H.S end
 795 828 a Fj(6.12.8.)e
(Reliabilty)1372 828 y
SDict begin 13 H.L end
 1372 828 a 1372 828 a
SDict begin [/Subtype /Link/Dest (0:4070) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1372 828
a Black Black 16 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 828 a
SDict begin H.S end
 3759 828 a Fj(301)3885 828 y
SDict begin 13 H.L end
 3885 828 a 3885
828 a
SDict begin [/Subtype /Link/Dest (0:4070) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 828 a Black 0 TeXcolorgray 795 936 a
SDict begin H.S end
 795 936
a Fj(6.12.9.)g(Con\002guration)1508 936 y
SDict begin 13 H.L end
 1508 936 a
1508 936 a
SDict begin [/Subtype /Link/Dest (0:4078) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1508 936 a Black Black 5 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 936 a
SDict begin H.S end
 3759 936 a Fj(301)3885
936 y
SDict begin 13 H.L end
 3885 936 a 3885 936 a
SDict begin [/Subtype /Link/Dest (0:4078) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 936 a Black 0 TeXcolorgray
596 1044 a
SDict begin H.S end
 596 1044 a Fj(6.13.)g(File)j(Stability)1214
1044 y
SDict begin 13 H.L end
 1214 1044 a 1214 1044 a
SDict begin [/Subtype /Link/Dest (0:4096) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1214 1044 a Black Black
8 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 1044 a
SDict begin H.S end
 3759 1044 a Fj(302)3885 1044
y
SDict begin 13 H.L end
 3885 1044 a 3885 1044 a
SDict begin [/Subtype /Link/Dest (0:4096) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1044 a Black 0 TeXcolorgray
596 1152 a
SDict begin H.S end
 596 1152 a Fj(6.14.)d(T)-6 b(est)21 b(Use)g(Case)1251
1152 y
SDict begin 13 H.L end
 1251 1152 a 1251 1152 a
SDict begin [/Subtype /Link/Dest (0:4101) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1251 1152 a Black Black
13 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 1152 a
SDict begin H.S end
 3759
1152 a Fj(303)3885 1152 y
SDict begin 13 H.L end
 3885 1152 a 3885 1152 a
SDict begin [/Subtype /Link/Dest (0:4101) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
1152 a Black 0 TeXcolorgray 396 1280 a
SDict begin H.S end
 396 1280 a Fk(7.)f(The)h(\330MQ)
g(Community)1292 1280 y
SDict begin 13 H.L end
 1292 1280 a 1292 1280 a
SDict begin [/Subtype /Link/Dest (0:the-community) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1292
1280 a Black Black 13 w Fk(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1280 a
SDict begin H.S end
 3759 1280 a Fk(305)3885
1280 y
SDict begin 13 H.L end
 3885 1280 a 3885 1280 a
SDict begin [/Subtype /Link/Dest (0:the-community) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1280 a Black 0 TeXcolorgray
596 1407 a
SDict begin H.S end
 596 1407 a Fj(7.1.)e(Architecture)f(of)i(the)h(\330MQ)f
(Community)2002 1407 y
SDict begin 13 H.L end
 2002 1407 a 2002 1407 a
SDict begin [/Subtype /Link/Dest (0:4141) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2002 1407
a Black Black 9 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1407 a
SDict begin H.S end
 3759 1407 a Fj(306)3885
1407 y
SDict begin 13 H.L end
 3885 1407 a 3885 1407 a
SDict begin [/Subtype /Link/Dest (0:4141) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1407 a Black 0 TeXcolorgray
596 1515 a
SDict begin H.S end
 596 1515 a Fj(7.2.)f(Ho)n(w)h(to)g(Mak)o(e)g(Really)h(Lar)o
(ge)e(Architectures)2115 1515 y
SDict begin 13 H.L end
 2115 1515 a 2115 1515
a
SDict begin [/Subtype /Link/Dest (0:4160) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2115 1515 a Black Black Fj(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1515 a
SDict begin H.S end
 3759 1515 a Fj(307)3885 1515 y
SDict begin 13 H.L end
 3885 1515
a 3885 1515 a
SDict begin [/Subtype /Link/Dest (0:4160) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1515 a Black 0 TeXcolorgray 795 1623
a
SDict begin H.S end
 795 1623 a Fj(7.2.1.)f(The)i(Game)1351 1623 y
SDict begin 13 H.L end
 1351
1623 a 1351 1623 a
SDict begin [/Subtype /Link/Dest (0:4169) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1351 1623 a Black Black 17 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1623 a
SDict begin H.S end
 3759 1623 a Fj(307)3885 1623 y
SDict begin 13 H.L end
 3885 1623
a 3885 1623 a
SDict begin [/Subtype /Link/Dest (0:4169) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1623 a Black 0 TeXcolorgray 795 1731
a
SDict begin H.S end
 795 1731 a Fj(7.2.2.)e(The)i(Contract)1439 1731 y
SDict begin 13 H.L end
 1439
1731 a 1439 1731 a
SDict begin [/Subtype /Link/Dest (0:4174) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1439 1731 a Black Black 12 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 1731 a
SDict begin H.S end
 3759
1731 a Fj(308)3885 1731 y
SDict begin 13 H.L end
 3885 1731 a 3885 1731 a
SDict begin [/Subtype /Link/Dest (0:4174) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
1731 a Black 0 TeXcolorgray 795 1839 a
SDict begin H.S end
 795 1839 a Fj(7.2.3.)e(The)i
(Process)1406 1839 y
SDict begin 13 H.L end
 1406 1839 a 1406 1839 a
SDict begin [/Subtype /Link/Dest (0:4191) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1406 1839
a Black Black 3 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 1839 a
SDict begin H.S end
 3759
1839 a Fj(309)3885 1839 y
SDict begin 13 H.L end
 3885 1839 a 3885 1839 a
SDict begin [/Subtype /Link/Dest (0:4191) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
1839 a Black 0 TeXcolorgray 795 1947 a
SDict begin H.S end
 795 1947 a Fj(7.2.4.)e(Crazy)-5
b(,)20 b(Beautiful,)f(and)h(Easy)1890 1947 y
SDict begin 13 H.L end
 1890 1947
a 1890 1947 a
SDict begin [/Subtype /Link/Dest (0:4198) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1890 1947 a Black Black 17 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1947 a
SDict begin H.S end
 3759 1947 a Fj(310)3885
1947 y
SDict begin 13 H.L end
 3885 1947 a 3885 1947 a
SDict begin [/Subtype /Link/Dest (0:4198) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1947 a Black 0 TeXcolorgray
795 2055 a
SDict begin H.S end
 795 2055 a Fj(7.2.5.)e(Stranger)m(,)h(meet)h(Stranger)1787
2055 y
SDict begin 13 H.L end
 1787 2055 a 1787 2055 a
SDict begin [/Subtype /Link/Dest (0:4205) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1787 2055 a Black Black
16 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2055 a
SDict begin H.S end
 3759 2055 a Fj(310)3885 2055
y
SDict begin 13 H.L end
 3885 2055 a 3885 2055 a
SDict begin [/Subtype /Link/Dest (0:4205) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2055 a Black 0 TeXcolorgray
795 2163 a
SDict begin H.S end
 795 2163 a Fj(7.2.6.)e(In\002nite)i(Property)1551
2163 y
SDict begin 13 H.L end
 1551 2163 a 1551 2163 a
SDict begin [/Subtype /Link/Dest (0:4213) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1551 2163 a Black Black
3 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2163 a
SDict begin H.S end
 3759 2163 a Fj(311)3885 2163 y
SDict begin 13 H.L end
 3885 2163
a 3885 2163 a
SDict begin [/Subtype /Link/Dest (0:4213) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2163 a Black 0 TeXcolorgray 795 2271
a
SDict begin H.S end
 795 2271 a Fj(7.2.7.)e(Care)j(and)e(Feeding)1589 2271
y
SDict begin 13 H.L end
 1589 2271 a 1589 2271 a
SDict begin [/Subtype /Link/Dest (0:4220) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1589 2271 a Black Black 7 w
Fj(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2271 a
SDict begin H.S end
 3759 2271 a Fj(311)3885
2271 y
SDict begin 13 H.L end
 3885 2271 a 3885 2271 a
SDict begin [/Subtype /Link/Dest (0:4220) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2271 a Black 0 TeXcolorgray
596 2379 a
SDict begin H.S end
 596 2379 a Fj(7.3.)g(The)h(\330MQ)g(Process)g(-)h(C4)1525
2379 y
SDict begin 13 H.L end
 1525 2379 a 1525 2379 a
SDict begin [/Subtype /Link/Dest (0:4235) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1525 2379 a Black Black
9 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2379 a
SDict begin H.S end
 3759 2379
a Fj(312)3885 2379 y
SDict begin 13 H.L end
 3885 2379 a 3885 2379 a
SDict begin [/Subtype /Link/Dest (0:4235) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2379
a Black 0 TeXcolorgray 795 2487 a
SDict begin H.S end
 795 2487 a Fj(7.3.1.)d(Language)1332
2487 y
SDict begin 13 H.L end
 1332 2487 a 1332 2487 a
SDict begin [/Subtype /Link/Dest (0:4241) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1332 2487 a Black Black
15 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2487 a
SDict begin H.S end
 3759 2487 a Fj(312)3885
2487 y
SDict begin 13 H.L end
 3885 2487 a 3885 2487 a
SDict begin [/Subtype /Link/Dest (0:4241) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2487 a Black 0 TeXcolorgray
795 2595 a
SDict begin H.S end
 795 2595 a Fj(7.3.2.)g(Goals)1196 2595 y
SDict begin 13 H.L end
 1196
2595 a 1196 2595 a
SDict begin [/Subtype /Link/Dest (0:4248) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1196 2595 a Black Black 6 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2595 a
SDict begin H.S end
 3759 2595
a Fj(313)3885 2595 y
SDict begin 13 H.L end
 3885 2595 a 3885 2595 a
SDict begin [/Subtype /Link/Dest (0:4248) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2595
a Black 0 TeXcolorgray 795 2703 a
SDict begin H.S end
 795 2703 a Fj(7.3.3.)g(Preliminaries)
1446 2703 y
SDict begin 13 H.L end
 1446 2703 a 1446 2703 a
SDict begin [/Subtype /Link/Dest (0:4276) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1446 2703 a Black
Black 5 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2703 a
SDict begin H.S end
 3759 2703 a Fj(315)3885 2703 y
SDict begin 13 H.L end
 3885 2703
a 3885 2703 a
SDict begin [/Subtype /Link/Dest (0:4276) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2703 a Black 0 TeXcolorgray 795 2811
a
SDict begin H.S end
 795 2811 a Fj(7.3.4.)g(Licensing)i(and)f(Ownership)1857
2811 y
SDict begin 13 H.L end
 1857 2811 a 1857 2811 a
SDict begin [/Subtype /Link/Dest (0:4303) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1857 2811 a Black Black
9 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2811 a
SDict begin H.S end
 3759 2811 a Fj(316)3885
2811 y
SDict begin 13 H.L end
 3885 2811 a 3885 2811 a
SDict begin [/Subtype /Link/Dest (0:4303) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2811 a Black 0 TeXcolorgray
795 2918 a
SDict begin H.S end
 795 2918 a Fj(7.3.5.)f(P)o(atch)i(Requirements)1669
2918 y
SDict begin 13 H.L end
 1669 2918 a 1669 2918 a
SDict begin [/Subtype /Link/Dest (0:4320) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1669 2918 a Black Black
10 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2918 a
SDict begin H.S end
 3759 2918 a Fj(317)3885 2918
y
SDict begin 13 H.L end
 3885 2918 a 3885 2918 a
SDict begin [/Subtype /Link/Dest (0:4320) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2918 a Black 0 TeXcolorgray
795 3026 a
SDict begin H.S end
 795 3026 a Fj(7.3.6.)e(De)n(v)o(elopment)g(Process)1721
3026 y
SDict begin 13 H.L end
 1721 3026 a 1721 3026 a
SDict begin [/Subtype /Link/Dest (0:4347) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1721 3026 a Black Black
20 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 3026 a
SDict begin H.S end
 3759 3026 a Fj(318)3885 3026
y
SDict begin 13 H.L end
 3885 3026 a 3885 3026 a
SDict begin [/Subtype /Link/Dest (0:4347) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3026 a Black 0 TeXcolorgray
795 3134 a
SDict begin H.S end
 795 3134 a Fj(7.3.7.)g(Creating)i(Stable)g(Releases)1827
3134 y
SDict begin 13 H.L end
 1827 3134 a 1827 3134 a
SDict begin [/Subtype /Link/Dest (0:4407) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1827 3134 a Black Black
18 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3134 a
SDict begin H.S end
 3759
3134 a Fj(321)3885 3134 y
SDict begin 13 H.L end
 3885 3134 a 3885 3134 a
SDict begin [/Subtype /Link/Dest (0:4407) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3134 a Black 0 TeXcolorgray 795 3242 a
SDict begin H.S end
 795 3242 a Fj(7.3.8.)e(Ev)n
(olution)h(of)h(Public)g(Contracts)1991 3242 y
SDict begin 13 H.L end
 1991 3242
a 1991 3242 a
SDict begin [/Subtype /Link/Dest (0:4431) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1991 3242 a Black Black -1 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3242 a
SDict begin H.S end
 3759 3242 a Fj(322)3885 3242 y
SDict begin 13 H.L end
 3885 3242
a 3885 3242 a
SDict begin [/Subtype /Link/Dest (0:4431) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3242 a Black 0 TeXcolorgray 596 3350
a
SDict begin H.S end
 596 3350 a Fj(7.4.)f(W)-7 b(ork)o(ed)20 b(Example)1319
3350 y
SDict begin 13 H.L end
 1319 3350 a 1319 3350 a
SDict begin [/Subtype /Link/Dest (0:4471) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1319 3350 a Black Black
7 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3350 a
SDict begin H.S end
 3759
3350 a Fj(324)3885 3350 y
SDict begin 13 H.L end
 3885 3350 a 3885 3350 a
SDict begin [/Subtype /Link/Dest (0:4471) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3350 a Black 0 TeXcolorgray 596 3458 a
SDict begin H.S end
 596 3458 a Fj(7.5.)f(Git)i
(Branches)e(Considered)g(Harmful)1879 3458 y
SDict begin 13 H.L end
 1879 3458
a 1879 3458 a
SDict begin [/Subtype /Link/Dest (0:4510) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1879 3458 a Black Black 8 w Fj(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3458
a
SDict begin H.S end
 3759 3458 a Fj(327)3885 3458 y
SDict begin 13 H.L end
 3885 3458 a 3885 3458
a
SDict begin [/Subtype /Link/Dest (0:4510) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3458 a Black 0 TeXcolorgray 795 3566 a
SDict begin H.S end
 795 3566
a Fj(7.5.1.)f(Simplicity)i(vs.)g(Comple)o(xity)1877 3566
y
SDict begin 13 H.L end
 1877 3566 a 1877 3566 a
SDict begin [/Subtype /Link/Dest (0:4524) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1877 3566 a Black Black 10
w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3566 a
SDict begin H.S end
 3759 3566 a Fj(328)3885 3566 y
SDict begin 13 H.L end
 3885 3566
a 3885 3566 a
SDict begin [/Subtype /Link/Dest (0:4524) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3566 a Black 0 TeXcolorgray 795 3674
a
SDict begin H.S end
 795 3674 a Fj(7.5.2.)e(Change)i(Latenc)o(y)1545 3674
y
SDict begin 13 H.L end
 1545 3674 a 1545 3674 a
SDict begin [/Subtype /Link/Dest (0:4530) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1545 3674 a Black Black 9 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3674 a
SDict begin H.S end
 3759 3674 a Fj(328)3885 3674 y
SDict begin 13 H.L end
 3885 3674
a 3885 3674 a
SDict begin [/Subtype /Link/Dest (0:4530) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3674 a Black 0 TeXcolorgray 795 3782
a
SDict begin H.S end
 795 3782 a Fj(7.5.3.)e(Learning)h(Curv)o(e)1526 3782
y
SDict begin 13 H.L end
 1526 3782 a 1526 3782 a
SDict begin [/Subtype /Link/Dest (0:4535) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1526 3782 a Black Black 8 w
Fj(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 3782 a
SDict begin H.S end
 3759 3782 a Fj(329)3885
3782 y
SDict begin 13 H.L end
 3885 3782 a 3885 3782 a
SDict begin [/Subtype /Link/Dest (0:4535) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3782 a Black 0 TeXcolorgray
795 3890 a
SDict begin H.S end
 795 3890 a Fj(7.5.4.)f(Cost)j(of)f(F)o(ailure)1500
3890 y
SDict begin 13 H.L end
 1500 3890 a 1500 3890 a
SDict begin [/Subtype /Link/Dest (0:4540) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1500 3890 a Black Black
13 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3890
a
SDict begin H.S end
 3759 3890 a Fj(329)3885 3890 y
SDict begin 13 H.L end
 3885 3890 a 3885 3890
a
SDict begin [/Subtype /Link/Dest (0:4540) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3890 a Black 0 TeXcolorgray 795 3998 a
SDict begin H.S end
 795 3998
a Fj(7.5.5.)e(Upfront)h(Coordination)1727 3998 y
SDict begin 13 H.L end
 1727
3998 a 1727 3998 a
SDict begin [/Subtype /Link/Dest (0:4545) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1727 3998 a Black Black 14 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 3998 a
SDict begin H.S end
 3759 3998 a Fj(329)3885 3998 y
SDict begin 13 H.L end
 3885 3998
a 3885 3998 a
SDict begin [/Subtype /Link/Dest (0:4545) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3998 a Black 0 TeXcolorgray 795 4106
a
SDict begin H.S end
 795 4106 a Fj(7.5.6.)f(Scalability)1358 4106 y
SDict begin 13 H.L end
 1358
4106 a 1358 4106 a
SDict begin [/Subtype /Link/Dest (0:4550) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1358 4106 a Black Black 10 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4106 a
SDict begin H.S end
 3759 4106 a Fj(329)3885 4106 y
SDict begin 13 H.L end
 3885 4106
a 3885 4106 a
SDict begin [/Subtype /Link/Dest (0:4550) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4106 a Black 0 TeXcolorgray 795 4214
a
SDict begin H.S end
 795 4214 a Fj(7.5.7.)g(Surprise)i(and)f(Expectations)1871
4214 y
SDict begin 13 H.L end
 1871 4214 a 1871 4214 a
SDict begin [/Subtype /Link/Dest (0:4556) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1871 4214 a Black Black
16 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4214 a
SDict begin H.S end
 3759 4214 a Fj(330)3885 4214 y
SDict begin 13 H.L end
 3885 4214
a 3885 4214 a
SDict begin [/Subtype /Link/Dest (0:4556) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4214 a Black 0 TeXcolorgray 795 4322
a
SDict begin H.S end
 795 4322 a Fj(7.5.8.)f(Economics)h(of)h(P)o(articipation)1907
4322 y
SDict begin 13 H.L end
 1907 4322 a 1907 4322 a
SDict begin [/Subtype /Link/Dest (0:4562) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1907 4322 a Black Black
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 4322 a
SDict begin H.S end
 3759
4322 a Fj(330)3885 4322 y
SDict begin 13 H.L end
 3885 4322 a 3885 4322 a
SDict begin [/Subtype /Link/Dest (0:4562) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
4322 a Black 0 TeXcolorgray 795 4429 a
SDict begin H.S end
 795 4429 a Fj(7.5.9.)e(Rob)n
(ustness)j(in)f(Con\003ict)1753 4429 y
SDict begin 13 H.L end
 1753 4429 a 1753
4429 a
SDict begin [/Subtype /Link/Dest (0:4567) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1753 4429 a Black Black 9 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4429 a
SDict begin H.S end
 3759 4429
a Fj(330)3885 4429 y
SDict begin 13 H.L end
 3885 4429 a 3885 4429 a
SDict begin [/Subtype /Link/Dest (0:4567) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4429
a Black 0 TeXcolorgray 795 4537 a
SDict begin H.S end
 795 4537 a Fj(7.5.10.)e(Guarantees)h
(of)h(Isolation)1820 4537 y
SDict begin 13 H.L end
 1820 4537 a 1820 4537 a
SDict begin [/Subtype /Link/Dest (0:4572) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1820
4537 a Black Black 4 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 4537 a
SDict begin H.S end
 3759 4537 a Fj(330)3885 4537
y
SDict begin 13 H.L end
 3885 4537 a 3885 4537 a
SDict begin [/Subtype /Link/Dest (0:4572) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4537 a Black 0 TeXcolorgray
795 4645 a
SDict begin H.S end
 795 4645 a Fj(7.5.11.)e(V)-5 b(isibility)1353
4645 y
SDict begin 13 H.L end
 1353 4645 a 1353 4645 a
SDict begin [/Subtype /Link/Dest (0:4577) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1353 4645 a Black Black
15 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4645 a
SDict begin H.S end
 3759 4645 a Fj(330)3885 4645 y
SDict begin 13 H.L end
 3885 4645
a 3885 4645 a
SDict begin [/Subtype /Link/Dest (0:4577) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4645 a Black 0 TeXcolorgray 795 4753
a
SDict begin H.S end
 795 4753 a Fj(7.5.12.)18 b(Conclusions)1456 4753 y
SDict begin 13 H.L end

1456 4753 a 1456 4753 a
SDict begin [/Subtype /Link/Dest (0:4582) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1456 4753 a Black Black 15 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 4753 a
SDict begin H.S end
 3759 4753 a Fj(331)3885
4753 y
SDict begin 13 H.L end
 3885 4753 a 3885 4753 a
SDict begin [/Subtype /Link/Dest (0:4582) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4753 a Black 0 TeXcolorgray
596 4861 a
SDict begin H.S end
 596 4861 a Fj(7.6.)h(The)h(Myth)f(of)h(Intelligent)f(Design)
1779 4861 y
SDict begin 13 H.L end
 1779 4861 a 1779 4861 a
SDict begin [/Subtype /Link/Dest (0:4587) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1779 4861 a Black
Black 4 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 4861
a
SDict begin H.S end
 3759 4861 a Fj(331)3885 4861 y
SDict begin 13 H.L end
 3885 4861 a 3885 4861
a
SDict begin [/Subtype /Link/Dest (0:4587) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4861 a Black 0 TeXcolorgray 596 4969 a
SDict begin H.S end
 596 4969
a Fj(7.7.)g(Burnout)1015 4969 y
SDict begin 13 H.L end
 1015 4969 a 1015 4969
a
SDict begin [/Subtype /Link/Dest (0:4630) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1015 4969 a Black Black Fj(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4969 a
SDict begin H.S end
 3759 4969 a Fj(333)3885 4969 y
SDict begin 13 H.L end
 3885 4969
a 3885 4969 a
SDict begin [/Subtype /Link/Dest (0:4630) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4969 a Black 0 TeXcolorgray 596 5077
a
SDict begin H.S end
 596 5077 a Fj(7.8.)g(P)o(atterns)h(for)f(The)h(Game)1494
5077 y
SDict begin 13 H.L end
 1494 5077 a 1494 5077 a
SDict begin [/Subtype /Link/Dest (0:4654) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1494 5077 a Black Black
19 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 5077
a
SDict begin H.S end
 3759 5077 a Fj(334)3885 5077 y
SDict begin 13 H.L end
 3885 5077 a 3885 5077
a
SDict begin [/Subtype /Link/Dest (0:4654) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 5077 a Black Black 3800 5569 a Fi(vii)p Black
eop end
%%Page: 8 8
TeXDict begin 8 7 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.viii) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black 0 TeXcolorgray 795 72 a
SDict begin H.S end
 795 72 a Fj(7.8.1.)18
b(The)i(Lazy)g(Perfectionist)1760 72 y
SDict begin 13 H.L end
 1760 72 a 1760
72 a
SDict begin [/Subtype /Link/Dest (0:4657) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1760 72 a Black Black 2 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 72 a
SDict begin H.S end
 3759 72 a Fj(334)3885
72 y
SDict begin 13 H.L end
 3885 72 a 3885 72 a
SDict begin [/Subtype /Link/Dest (0:4657) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 72 a Black 0 TeXcolorgray
795 180 a
SDict begin H.S end
 795 180 a Fj(7.8.2.)e(The)i(Bene)n(v)n(olent)f(T)-7
b(yrant)1763 180 y
SDict begin 13 H.L end
 1763 180 a 1763 180 a
SDict begin [/Subtype /Link/Dest (0:4663) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1763 180 a Black
Black 20 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 180
a
SDict begin H.S end
 3759 180 a Fj(335)3885 180 y
SDict begin 13 H.L end
 3885 180 a 3885 180 a
SDict begin [/Subtype /Link/Dest (0:4663) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3885 180 a Black 0 TeXcolorgray 795 288 a
SDict begin H.S end
 795 288 a Fj(7.8.3.)18
b(The)i(Earth)g(and)f(Sk)o(y)1622 288 y
SDict begin 13 H.L end
 1622 288 a 1622
288 a
SDict begin [/Subtype /Link/Dest (0:4668) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1622 288 a Black Black 15 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 288 a
SDict begin H.S end
 3759 288 a Fj(335)3885
288 y
SDict begin 13 H.L end
 3885 288 a 3885 288 a
SDict begin [/Subtype /Link/Dest (0:4668) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 288 a Black 0 TeXcolorgray
795 396 a
SDict begin H.S end
 795 396 a Fj(7.8.4.)f(The)i(Open)g(Door)1525
396 y
SDict begin 13 H.L end
 1525 396 a 1525 396 a
SDict begin [/Subtype /Link/Dest (0:4673) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1525 396 a Black Black 9
w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 396 a
SDict begin H.S end
 3759 396 a Fj(335)3885
396 y
SDict begin 13 H.L end
 3885 396 a 3885 396 a
SDict begin [/Subtype /Link/Dest (0:4673) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 396 a Black 0 TeXcolorgray
795 504 a
SDict begin H.S end
 795 504 a Fj(7.8.5.)e(The)i(Laughing)e(Clo)n(wn)1711
504 y
SDict begin 13 H.L end
 1711 504 a 1711 504 a
SDict begin [/Subtype /Link/Dest (0:4678) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1711 504 a Black Black 9
w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 504 a
SDict begin H.S end
 3759 504 a
Fj(335)3885 504 y
SDict begin 13 H.L end
 3885 504 a 3885 504 a
SDict begin [/Subtype /Link/Dest (0:4678) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 504 a Black
0 TeXcolorgray 795 612 a
SDict begin H.S end
 795 612 a Fj(7.8.6.)g(The)i(Mindful)f(General)
1709 612 y
SDict begin 13 H.L end
 1709 612 a 1709 612 a
SDict begin [/Subtype /Link/Dest (0:4683) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1709 612 a Black Black
11 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 612 a
SDict begin H.S end
 3759 612 a
Fj(336)3885 612 y
SDict begin 13 H.L end
 3885 612 a 3885 612 a
SDict begin [/Subtype /Link/Dest (0:4683) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 612 a Black
0 TeXcolorgray 795 720 a
SDict begin H.S end
 795 720 a Fj(7.8.7.)f(The)i(Social)g(Engineer)
1682 720 y
SDict begin 13 H.L end
 1682 720 a 1682 720 a
SDict begin [/Subtype /Link/Dest (0:4688) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1682 720 a Black Black
18 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 720 a
SDict begin H.S end
 3759 720 a Fj(336)3885 720 y
SDict begin 13 H.L end
 3885 720 a 3885
720 a
SDict begin [/Subtype /Link/Dest (0:4688) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 720 a Black 0 TeXcolorgray 795 828 a
SDict begin H.S end
 795 828
a Fj(7.8.8.)e(The)i(Constant)g(Gardener)1779 828 y
SDict begin 13 H.L end
 1779
828 a 1779 828 a
SDict begin [/Subtype /Link/Dest (0:4693) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1779 828 a Black Black 4 w Fj(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 828 a
SDict begin H.S end
 3759 828 a Fj(336)3885
828 y
SDict begin 13 H.L end
 3885 828 a 3885 828 a
SDict begin [/Subtype /Link/Dest (0:4693) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 828 a Black 0 TeXcolorgray
795 936 a
SDict begin H.S end
 795 936 a Fj(7.8.9.)e(The)i(Rolling)g(Stone)1612
936 y
SDict begin 13 H.L end
 1612 936 a 1612 936 a
SDict begin [/Subtype /Link/Dest (0:4698) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1612 936 a Black Black 5
w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 936 a
SDict begin H.S end
 3759 936 a Fj(336)3885 936 y
SDict begin 13 H.L end
 3885 936 a 3885
936 a
SDict begin [/Subtype /Link/Dest (0:4698) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 936 a Black 0 TeXcolorgray 795 1044 a
SDict begin H.S end
 795
1044 a Fj(7.8.10.)e(The)i(Pirate)g(Gang)1589 1044 y
SDict begin 13 H.L end
 1589
1044 a 1589 1044 a
SDict begin [/Subtype /Link/Dest (0:4703) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1589 1044 a Black Black 7 w Fj(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1044 a
SDict begin H.S end
 3759 1044 a Fj(337)3885
1044 y
SDict begin 13 H.L end
 3885 1044 a 3885 1044 a
SDict begin [/Subtype /Link/Dest (0:4703) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1044 a Black 0 TeXcolorgray
795 1152 a
SDict begin H.S end
 795 1152 a Fj(7.8.11.)e(The)i(Flash)g(Mob)1552
1152 y
SDict begin 13 H.L end
 1552 1152 a 1552 1152 a
SDict begin [/Subtype /Link/Dest (0:4708) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1552 1152 a Black Black
2 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1152 a
SDict begin H.S end
 3759 1152 a Fj(337)3885 1152 y
SDict begin 13 H.L end
 3885 1152
a 3885 1152 a
SDict begin [/Subtype /Link/Dest (0:4708) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1152 a Black 0 TeXcolorgray 795 1260
a
SDict begin H.S end
 795 1260 a Fj(7.8.12.)e(The)i(Canary)f(W)-7 b(atcher)1729
1260 y
SDict begin 13 H.L end
 1729 1260 a 1729 1260 a
SDict begin [/Subtype /Link/Dest (0:4713) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1729 1260 a Black Black
12 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 1260 a
SDict begin H.S end
 3759 1260 a Fj(337)3885 1260
y
SDict begin 13 H.L end
 3885 1260 a 3885 1260 a
SDict begin [/Subtype /Link/Dest (0:4713) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1260 a Black 0 TeXcolorgray
795 1368 a
SDict begin H.S end
 795 1368 a Fj(7.8.13.)18 b(The)i(Hangman)1519
1368 y
SDict begin 13 H.L end
 1519 1368 a 1519 1368 a
SDict begin [/Subtype /Link/Dest (0:4718) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1519 1368 a Black Black
15 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 1368 a
SDict begin H.S end
 3759 1368
a Fj(337)3885 1368 y
SDict begin 13 H.L end
 3885 1368 a 3885 1368 a
SDict begin [/Subtype /Link/Dest (0:4718) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1368
a Black 0 TeXcolorgray 795 1476 a
SDict begin H.S end
 795 1476 a Fj(7.8.14.)e(The)i
(Historian)1504 1476 y
SDict begin 13 H.L end
 1504 1476 a 1504 1476 a
SDict begin [/Subtype /Link/Dest (0:4723) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1504 1476
a Black Black 9 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1476 a
SDict begin H.S end
 3759 1476 a Fj(337)3885 1476 y
SDict begin 13 H.L end
 3885 1476
a 3885 1476 a
SDict begin [/Subtype /Link/Dest (0:4723) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1476 a Black 0 TeXcolorgray 795 1583
a
SDict begin H.S end
 795 1583 a Fj(7.8.15.)e(The)i(Pro)o(v)n(ocateur)1595
1583 y
SDict begin 13 H.L end
 1595 1583 a 1595 1583 a
SDict begin [/Subtype /Link/Dest (0:4728) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1595 1583 a Black Black
1 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 1583 a
SDict begin H.S end
 3759 1583
a Fj(338)3885 1583 y
SDict begin 13 H.L end
 3885 1583 a 3885 1583 a
SDict begin [/Subtype /Link/Dest (0:4728) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1583
a Black 0 TeXcolorgray 795 1691 a
SDict begin H.S end
 795 1691 a Fj(7.8.16.)e(The)i(Mystic)
1425 1691 y
SDict begin 13 H.L end
 1425 1691 a 1425 1691 a
SDict begin [/Subtype /Link/Dest (0:4734) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1425 1691 a Black
Black 5 w Fj(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 1691 a
SDict begin H.S end
 3759 1691 a Fj(338)3885 1691
y
SDict begin 13 H.L end
 3885 1691 a 3885 1691 a
SDict begin [/Subtype /Link/Dest (0:4734) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1691 a Black 0 TeXcolorgray
396 1819 a
SDict begin H.S end
 396 1819 a Fk(8.)g(A)h(Uni)o(v)o(erse)g(of)f(Mo)o(ving)g
(Pieces)1492 1819 y
SDict begin 13 H.L end
 1492 1819 a 1492 1819 a
SDict begin [/Subtype /Link/Dest (0:moving-pieces) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1492 1819
a Black Black Fk(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1819 a
SDict begin H.S end
 3759 1819 a Fk(339)3885
1819 y
SDict begin 13 H.L end
 3885 1819 a 3885 1819 a
SDict begin [/Subtype /Link/Dest (0:moving-pieces) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1819 a Black 0 TeXcolorgray
596 1947 a
SDict begin H.S end
 596 1947 a Fj(8.1.)f(Design)h(for)f(The)h(Real)h(W)-7
b(orld)1643 1947 y
SDict begin 13 H.L end
 1643 1947 a 1643 1947 a
SDict begin [/Subtype /Link/Dest (0:4752) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1643 1947
a Black Black 15 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 1947
a
SDict begin H.S end
 3759 1947 a Fj(339)3885 1947 y
SDict begin 13 H.L end
 3885 1947 a 3885 1947
a
SDict begin [/Subtype /Link/Dest (0:4752) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 1947 a Black 0 TeXcolorgray 596 2055 a
SDict begin H.S end
 596 2055
a Fj(8.2.)19 b(The)h(Secret)g(Life)g(of)g(W)m(iFi)1535
2055 y
SDict begin 13 H.L end
 1535 2055 a 1535 2055 a
SDict begin [/Subtype /Link/Dest (0:4794) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1535 2055 a Black Black
19 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2055 a
SDict begin H.S end
 3759 2055 a Fj(341)3885 2055 y
SDict begin 13 H.L end
 3885 2055
a 3885 2055 a
SDict begin [/Subtype /Link/Dest (0:4794) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2055 a Black 0 TeXcolorgray 795 2163
a
SDict begin H.S end
 795 2163 a Fj(8.2.1.)e(Why)i(Mesh)g(isn')o(t)g(Here)g(Y)-8
b(et)1850 2163 y
SDict begin 13 H.L end
 1850 2163 a 1850 2163 a
SDict begin [/Subtype /Link/Dest (0:4797) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1850 2163 a
Black Black 16 w Fj(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 2163 a
SDict begin H.S end
 3759
2163 a Fj(341)3885 2163 y
SDict begin 13 H.L end
 3885 2163 a 3885 2163 a
SDict begin [/Subtype /Link/Dest (0:4797) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
2163 a Black 0 TeXcolorgray 795 2271 a
SDict begin H.S end
 795 2271 a Fj(8.2.2.)18
b(Some)i(Physics)1466 2271 y
SDict begin 13 H.L end
 1466 2271 a 1466 2271 a
SDict begin [/Subtype /Link/Dest (0:4806) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

1466 2271 a Black Black 5 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 2271
a
SDict begin H.S end
 3759 2271 a Fj(342)3885 2271 y
SDict begin 13 H.L end
 3885 2271 a 3885 2271
a
SDict begin [/Subtype /Link/Dest (0:4806) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2271 a Black 0 TeXcolorgray 795 2379 a
SDict begin H.S end
 795 2379
a Fj(8.2.3.)e(What')-5 b(s)21 b(the)f(Current)g(Status?)1895
2379 y
SDict begin 13 H.L end
 1895 2379 a 1895 2379 a
SDict begin [/Subtype /Link/Dest (0:4821) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1895 2379 a Black Black
12 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 2379 a
SDict begin H.S end
 3759
2379 a Fj(343)3885 2379 y
SDict begin 13 H.L end
 3885 2379 a 3885 2379 a
SDict begin [/Subtype /Link/Dest (0:4821) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
2379 a Black 0 TeXcolorgray 795 2487 a
SDict begin H.S end
 795 2487 a Fj(8.2.4.)e
(Conclusions)1414 2487 y
SDict begin 13 H.L end
 1414 2487 a 1414 2487 a
SDict begin [/Subtype /Link/Dest (0:4833) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1414
2487 a Black Black 16 w Fj(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2487 a
SDict begin H.S end
 3759 2487
a Fj(344)3885 2487 y
SDict begin 13 H.L end
 3885 2487 a 3885 2487 a
SDict begin [/Subtype /Link/Dest (0:4833) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2487
a Black 0 TeXcolorgray 596 2595 a
SDict begin H.S end
 596 2595 a Fj(8.3.)h(Disco)o(v)o(ery)
1082 2595 y
SDict begin 13 H.L end
 1082 2595 a 1082 2595 a
SDict begin [/Subtype /Link/Dest (0:4838) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1082 2595 a Black
Black 16 w Fj(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2595 a
SDict begin H.S end
 3759 2595 a Fj(345)3885
2595 y
SDict begin 13 H.L end
 3885 2595 a 3885 2595 a
SDict begin [/Subtype /Link/Dest (0:4838) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2595 a Black 0 TeXcolorgray
795 2703 a
SDict begin H.S end
 795 2703 a Fj(8.3.1.)f(Preempti)n(v)o(e)h(Disco)o(v)o(ery)f
(o)o(v)o(er)h(Ra)o(w)i(Sock)o(ets)2353 2703 y
SDict begin 13 H.L end
 2353 2703
a 2353 2703 a
SDict begin [/Subtype /Link/Dest (0:4844) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2353 2703 a Black Black 11 w Fj(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2703 a
SDict begin H.S end
 3759 2703 a Fj(345)3885
2703 y
SDict begin 13 H.L end
 3885 2703 a 3885 2703 a
SDict begin [/Subtype /Link/Dest (0:4844) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2703 a Black 0 TeXcolorgray
795 2811 a
SDict begin H.S end
 795 2811 a Fj(8.3.2.)d(Cooperati)n(v)o(e)h(Disco)o(v)o(ery)f
(using)i(UDP)h(Broadcasts)2538 2811 y
SDict begin 13 H.L end
 2538 2811 a 2538
2811 a
SDict begin [/Subtype /Link/Dest (0:4866) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2538 2811 a Black Black 13 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 2811 a
SDict begin H.S end
 3759 2811 a Fj(347)3885
2811 y
SDict begin 13 H.L end
 3885 2811 a 3885 2811 a
SDict begin [/Subtype /Link/Dest (0:4866) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 2811 a Black 0 TeXcolorgray
795 2918 a
SDict begin H.S end
 795 2918 a Fj(8.3.3.)d(Multiple)i(Nodes)g(on)g(One)g(De)n
(vice)2039 2918 y
SDict begin 13 H.L end
 2039 2918 a 2039 2918 a
SDict begin [/Subtype /Link/Dest (0:4900) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2039 2918 a
Black Black 14 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 2918 a
SDict begin H.S end
 3759
2918 a Fj(349)3885 2918 y
SDict begin 13 H.L end
 3885 2918 a 3885 2918 a
SDict begin [/Subtype /Link/Dest (0:4900) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
2918 a Black 0 TeXcolorgray 795 3026 a
SDict begin H.S end
 795 3026 a Fj(8.3.4.)e
(Designing)h(the)i(API)1621 3026 y
SDict begin 13 H.L end
 1621 3026 a 1621 3026
a
SDict begin [/Subtype /Link/Dest (0:4908) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1621 3026 a Black Black 16 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 3026 a
SDict begin H.S end
 3759 3026 a Fj(350)3885
3026 y
SDict begin 13 H.L end
 3885 3026 a 3885 3026 a
SDict begin [/Subtype /Link/Dest (0:4908) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3026 a Black 0 TeXcolorgray
795 3134 a
SDict begin H.S end
 795 3134 a Fj(8.3.5.)d(More)i(about)f(UDP)1574
3134 y
SDict begin 13 H.L end
 1574 3134 a 1574 3134 a
SDict begin [/Subtype /Link/Dest (0:4944) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1574 3134 a Black Black
1 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 3134
a
SDict begin H.S end
 3759 3134 a Fj(352)3885 3134 y
SDict begin 13 H.L end
 3885 3134 a 3885 3134
a
SDict begin [/Subtype /Link/Dest (0:4944) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3134 a Black 0 TeXcolorgray 596 3242 a
SDict begin H.S end
 596 3242
a Fj(8.4.)g(Spinning)f(of)n(f)i(a)h(Library)d(Project)1740
3242 y
SDict begin 13 H.L end
 1740 3242 a 1740 3242 a
SDict begin [/Subtype /Link/Dest (0:4952) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1740 3242 a Black Black
1 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 3242 a
SDict begin H.S end
 3759 3242 a Fj(352)3885 3242
y
SDict begin 13 H.L end
 3885 3242 a 3885 3242 a
SDict begin [/Subtype /Link/Dest (0:4952) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3242 a Black 0 TeXcolorgray
596 3350 a
SDict begin H.S end
 596 3350 a Fj(8.5.)h(Point-to-point)e(Messaging)1588
3350 y
SDict begin 13 H.L end
 1588 3350 a 1588 3350 a
SDict begin [/Subtype /Link/Dest (0:4982) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1588 3350 a Black Black
8 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 3350 a
SDict begin H.S end
 3759 3350
a Fj(354)3885 3350 y
SDict begin 13 H.L end
 3885 3350 a 3885 3350 a
SDict begin [/Subtype /Link/Dest (0:4982) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3350
a Black 0 TeXcolorgray 795 3458 a
SDict begin H.S end
 795 3458 a Fj(8.5.1.)h(UDP)j(Beacon)f
(Framing)1742 3458 y
SDict begin 13 H.L end
 1742 3458 a 1742 3458 a
SDict begin [/Subtype /Link/Dest (0:5003) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1742 3458
a Black Black -1 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 3458 a
SDict begin H.S end
 3759 3458
a Fj(354)3885 3458 y
SDict begin 13 H.L end
 3885 3458 a 3885 3458 a
SDict begin [/Subtype /Link/Dest (0:5003) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3458
a Black 0 TeXcolorgray 795 3566 a
SDict begin H.S end
 795 3566 a Fj(8.5.2.)e(T)m(rue)i
(Peer)g(Connecti)n(vity)f(\(Harmon)o(y)f(P)o(attern\))2417
3566 y
SDict begin 13 H.L end
 2417 3566 a 2417 3566 a
SDict begin [/Subtype /Link/Dest (0:5028) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 2417 3566 a Black Black
9 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3566 a
SDict begin H.S end
 3759
3566 a Fj(356)3885 3566 y
SDict begin 13 H.L end
 3885 3566 a 3885 3566 a
SDict begin [/Subtype /Link/Dest (0:5028) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3566 a Black 0 TeXcolorgray 795 3674 a
SDict begin H.S end
 795 3674 a Fj(8.5.3.)g
(Detecting)i(Disappearances)1869 3674 y
SDict begin 13 H.L end
 1869 3674 a 1869
3674 a
SDict begin [/Subtype /Link/Dest (0:5071) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1869 3674 a Black Black 18 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3674 a
SDict begin H.S end
 3759
3674 a Fj(358)3885 3674 y
SDict begin 13 H.L end
 3885 3674 a 3885 3674 a
SDict begin [/Subtype /Link/Dest (0:5071) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3674 a Black 0 TeXcolorgray 596 3782 a
SDict begin H.S end
 596 3782 a Fj(8.6.)f(Group)g
(Messaging)1335 3782 y
SDict begin 13 H.L end
 1335 3782 a 1335 3782 a
SDict begin [/Subtype /Link/Dest (0:5089) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1335 3782
a Black Black 12 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 3782 a
SDict begin H.S end
 3759
3782 a Fj(358)3885 3782 y
SDict begin 13 H.L end
 3885 3782 a 3885 3782 a
SDict begin [/Subtype /Link/Dest (0:5089) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885
3782 a Black 0 TeXcolorgray 596 3890 a
SDict begin H.S end
 596 3890 a Fj(8.7.)g(T)-6
b(esting)20 b(and)f(Simulation)1511 3890 y
SDict begin 13 H.L end
 1511 3890
a 1511 3890 a
SDict begin [/Subtype /Link/Dest (0:5127) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1511 3890 a Black Black 2 w Fj(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 3890 a
SDict begin H.S end
 3759 3890
a Fj(360)3885 3890 y
SDict begin 13 H.L end
 3885 3890 a 3885 3890 a
SDict begin [/Subtype /Link/Dest (0:5127) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3890
a Black 0 TeXcolorgray 795 3998 a
SDict begin H.S end
 795 3998 a Fj(8.7.1.)f(On)j
(Assertions)1476 3998 y
SDict begin 13 H.L end
 1476 3998 a 1476 3998 a
SDict begin [/Subtype /Link/Dest (0:5129) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1476
3998 a Black Black 16 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 3998 a
SDict begin H.S end
 3759 3998
a Fj(360)3885 3998 y
SDict begin 13 H.L end
 3885 3998 a 3885 3998 a
SDict begin [/Subtype /Link/Dest (0:5129) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 3998
a Black 0 TeXcolorgray 795 4106 a
SDict begin H.S end
 795 4106 a Fj(8.7.2.)d(On)j(Up-front)
d(T)-6 b(esting)1680 4106 y
SDict begin 13 H.L end
 1680 4106 a 1680 4106 a
SDict begin [/Subtype /Link/Dest (0:5138) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1680
4106 a Black Black 20 w Fj(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 4106 a
SDict begin H.S end
 3759 4106 a Fj(361)3885 4106
y
SDict begin 13 H.L end
 3885 4106 a 3885 4106 a
SDict begin [/Subtype /Link/Dest (0:5138) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4106 a Black 0 TeXcolorgray
795 4214 a
SDict begin H.S end
 795 4214 a Fj(8.7.3.)18 b(The)i(ZyRE)g(T)-6
b(ester)1573 4214 y
SDict begin 13 H.L end
 1573 4214 a 1573 4214 a
SDict begin [/Subtype /Link/Dest (0:5148) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1573 4214
a Black Black 2 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4214 a
SDict begin H.S end
 3759 4214 a Fj(362)3885 4214 y
SDict begin 13 H.L end
 3885 4214
a 3885 4214 a
SDict begin [/Subtype /Link/Dest (0:5148) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4214 a Black 0 TeXcolorgray 795 4322
a
SDict begin H.S end
 795 4322 a Fj(8.7.4.)18 b(T)-6 b(est)21 b(Results)1404
4322 y
SDict begin 13 H.L end
 1404 4322 a 1404 4322 a
SDict begin [/Subtype /Link/Dest (0:5179) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1404 4322 a Black Black
5 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 4322 a
SDict begin H.S end
 3759 4322 a Fj(365)3885
4322 y
SDict begin 13 H.L end
 3885 4322 a 3885 4322 a
SDict begin [/Subtype /Link/Dest (0:5179) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4322 a Black 0 TeXcolorgray
795 4429 a
SDict begin H.S end
 795 4429 a Fj(8.7.5.)d(T)m(racing)h(Acti)n(vity)1549
4429 y
SDict begin 13 H.L end
 1549 4429 a 1549 4429 a
SDict begin [/Subtype /Link/Dest (0:5207) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1549 4429 a Black Black
5 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4429 a
SDict begin H.S end
 3759 4429 a Fj(367)3885 4429 y
SDict begin 13 H.L end
 3885 4429
a 3885 4429 a
SDict begin [/Subtype /Link/Dest (0:5207) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4429 a Black 0 TeXcolorgray 795 4537
a
SDict begin H.S end
 795 4537 a Fj(8.7.6.)f(Dealing)i(with)g(Block)o(ed)g(Peers)1931
4537 y
SDict begin 13 H.L end
 1931 4537 a 1931 4537 a
SDict begin [/Subtype /Link/Dest (0:5222) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1931 4537 a Black Black
18 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4537 a
SDict begin H.S end
 3759 4537 a Fj(367)3885 4537 y
SDict begin 13 H.L end
 3885 4537
a 3885 4537 a
SDict begin [/Subtype /Link/Dest (0:5222) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4537 a Black 0 TeXcolorgray 596 4645
a
SDict begin H.S end
 596 4645 a Fj(8.8.)f(More)g(Coming)h(Soon)1402 4645
y
SDict begin 13 H.L end
 1402 4645 a 1402 4645 a
SDict begin [/Subtype /Link/Dest (0:5246) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1402 4645 a Black Black 7 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 4645 a
SDict begin H.S end
 3759 4645 a Fj(370)3885
4645 y
SDict begin 13 H.L end
 3885 4645 a 3885 4645 a
SDict begin [/Subtype /Link/Dest (0:5246) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 4645 a Black Black
3777 5569 a Fi(viii)p Black eop end
%%Page: 9 9
TeXDict begin 9 8 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.ix) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black 0 TeXcolorgray 396 72 a
SDict begin H.S end
 396 72 a Fk(9.)20
b(P)n(ostface)774 72 y
SDict begin 13 H.L end
 774 72 a 774 72 a
SDict begin [/Subtype /Link/Dest (0:postface) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 774 72 a Black
Black 12 w Fk(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 72 a
SDict begin H.S end
 3759 72 a Fk(371)3885 72 y
SDict begin 13 H.L end
 3885 72 a 3885 72
a
SDict begin [/Subtype /Link/Dest (0:postface) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 72 a Black 0 TeXcolorgray 596 200 a
SDict begin H.S end
 596 200 a
Fj(9.1.)f(T)-7 b(ales)21 b(from)e(Out)h(There)1457 200
y
SDict begin 13 H.L end
 1457 200 a 1457 200 a
SDict begin [/Subtype /Link/Dest (0:5251) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1457 200 a Black Black 14 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 200 a
SDict begin H.S end
 3759 200 a Fj(371)3885 200
y
SDict begin 13 H.L end
 3885 200 a 3885 200 a
SDict begin [/Subtype /Link/Dest (0:5251) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 200 a Black 0 TeXcolorgray
795 308 a
SDict begin H.S end
 795 308 a Fj(9.1.1.)e(Rob)i(Gagnon')-5 b(s)19
b(Story)1681 308 y
SDict begin 13 H.L end
 1681 308 a 1681 308 a
SDict begin [/Subtype /Link/Dest (0:5254) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1681 308 a Black
Black 19 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 308 a
SDict begin H.S end
 3759 308 a Fj(371)3885 308 y
SDict begin 13 H.L end
 3885 308 a 3885
308 a
SDict begin [/Subtype /Link/Dest (0:5254) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 308 a Black 0 TeXcolorgray 795 416 a
SDict begin H.S end
 795 416
a Fj(9.1.2.)f(T)-7 b(om)20 b(v)n(an)g(Leeuwen')-5 b(s)19
b(Story)1873 416 y
SDict begin 13 H.L end
 1873 416 a 1873 416 a
SDict begin [/Subtype /Link/Dest (0:5258) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1873 416 a Black
Black 14 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 416 a
SDict begin H.S end
 3759 416 a Fj(371)3885 416
y
SDict begin 13 H.L end
 3885 416 a 3885 416 a
SDict begin [/Subtype /Link/Dest (0:5258) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 416 a Black 0 TeXcolorgray
795 524 a
SDict begin H.S end
 795 524 a Fj(9.1.3.)f(Michael)i(Jakl')-5 b(s)21
b(Story)1686 524 y
SDict begin 13 H.L end
 1686 524 a 1686 524 a
SDict begin [/Subtype /Link/Dest (0:5263) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1686 524 a Black
Black 14 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 524 a
SDict begin H.S end
 3759 524 a Fj(371)3885 524 y
SDict begin 13 H.L end
 3885 524 a 3885
524 a
SDict begin [/Subtype /Link/Dest (0:5263) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 524 a Black 0 TeXcolorgray 795 632 a
SDict begin H.S end
 795 632
a Fj(9.1.4.)d(V)-9 b(adim)20 b(Shalts')-5 b(s)21 b(Story)1700
632 y
SDict begin 13 H.L end
 1700 632 a 1700 632 a
SDict begin [/Subtype /Link/Dest (0:5267) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1700 632 a Black Black Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 632
a
SDict begin H.S end
 3759 632 a Fj(372)3885 632 y
SDict begin 13 H.L end
 3885 632 a 3885 632 a
SDict begin [/Subtype /Link/Dest (0:5267) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end

3885 632 a Black 0 TeXcolorgray 596 740 a
SDict begin H.S end
 596 740 a Fj(9.2.)e(Ho)n(w)h
(the)g(Guide)g(Happened)1606 740 y
SDict begin 13 H.L end
 1606 740 a 1606 740
a
SDict begin [/Subtype /Link/Dest (0:5272) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1606 740 a Black Black 11 w Fj(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 740 a
SDict begin H.S end
 3759
740 a Fj(372)3885 740 y
SDict begin 13 H.L end
 3885 740 a 3885 740 a
SDict begin [/Subtype /Link/Dest (0:5272) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 740
a Black 0 TeXcolorgray 596 848 a
SDict begin H.S end
 596 848 a Fj(9.3.)f(Remo)o(ving)f
(Friction)1370 848 y
SDict begin 13 H.L end
 1370 848 a 1370 848 a
SDict begin [/Subtype /Link/Dest (0:5283) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1370 848 a
Black Black 18 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 848 a
SDict begin H.S end
 3759 848 a Fj(373)3885 848 y
SDict begin 13 H.L end
 3885 848 a 3885
848 a
SDict begin [/Subtype /Link/Dest (0:5283) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 848 a Black 0 TeXcolorgray 596 956 a
SDict begin H.S end
 596 956
a Fj(9.4.)h(Licensing)1070 956 y
SDict begin 13 H.L end
 1070 956 a 1070 956
a
SDict begin [/Subtype /Link/Dest (0:5328) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1070 956 a Black Black 7 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 956 a
SDict begin H.S end
 3759 956 a Fj(375)3885 956 y
SDict begin 13 H.L end
 3885 956 a 3885
956 a
SDict begin [/Subtype /Link/Dest (0:5328) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3885 956 a Black Black 3823 5569 a Fi(ix)p Black
eop end
%%Page: 10 10
TeXDict begin 10 9 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.x) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 115 a Fl(List)48 b(of)g(Figures)1184 115
y
SDict begin H.S end
 1184 115 a 1184 115 a
SDict begin 26.957 H.A end
 1184 115 a 1184 115 a
SDict begin [/View [/XYZ H.V]/Dest (4.0) cvn /DEST pdfmark end
 1184 115
a 0 TeXcolorgray 396 257 a
SDict begin H.S end
 396 257 a Fj(1-1.)19 b(Request-Reply)1043
257 y
SDict begin 13 H.L end
 1043 257 a 1043 257 a
SDict begin [/Subtype /Link/Dest (0:figure-1) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1043 257 a Black Black 13
w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3842 257 a
SDict begin H.S end
 3842 257 a Fj(4)3884 257 y
SDict begin 13 H.L end
 3884 257 a 3884
257 a
SDict begin [/Subtype /Link/Dest (0:figure-1) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 257 a Black 0 TeXcolorgray 396 365 a
SDict begin H.S end
 396 365
a Fj(1-2.)g(A)i(terrible)f(accident...)1231 365 y
SDict begin 13 H.L end
 1231
365 a 1231 365 a
SDict begin [/Subtype /Link/Dest (0:figure-2) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1231 365 a Black Black 12 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3842 365 a
SDict begin H.S end
 3842 365 a Fj(6)3884 365 y
SDict begin 13 H.L end
 3884 365 a 3884
365 a
SDict begin [/Subtype /Link/Dest (0:figure-2) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 365 a Black 0 TeXcolorgray 396 473 a
SDict begin H.S end
 396 473
a Fj(1-3.)f(A)i(\330MQ)g(string)1034 473 y
SDict begin 13 H.L end
 1034 473 a
1034 473 a
SDict begin [/Subtype /Link/Dest (0:figure-3) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1034 473 a Black Black 2 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3842 473 a
SDict begin H.S end
 3842 473 a Fj(8)3884 473 y
SDict begin 13 H.L end
 3884 473 a 3884
473 a
SDict begin [/Subtype /Link/Dest (0:figure-3) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 473 a Black 0 TeXcolorgray 396 581 a
SDict begin H.S end
 396 581
a Fj(1-4.)e(Publish-Subscribe)1155 581 y
SDict begin 13 H.L end
 1155 581 a 1155
581 a
SDict begin [/Subtype /Link/Dest (0:figure-4) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1155 581 a Black Black 5 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black 0 TeXcolorgray 3800 581 a
SDict begin H.S end
 3800 581 a Fj(10)3884
581 y
SDict begin 13 H.L end
 3884 581 a 3884 581 a
SDict begin [/Subtype /Link/Dest (0:figure-4) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 581 a Black 0 TeXcolorgray
396 689 a
SDict begin H.S end
 396 689 a Fj(1-5.)g(P)o(arallel)i(Pipeline)1095
689 y
SDict begin 13 H.L end
 1095 689 a 1095 689 a
SDict begin [/Subtype /Link/Dest (0:figure-5) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1095 689 a Black Black 3
w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 689 a
SDict begin H.S end

3800 689 a Fj(15)3884 689 y
SDict begin 13 H.L end
 3884 689 a 3884 689 a
SDict begin [/Subtype /Link/Dest (0:figure-5) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
689 a Black 0 TeXcolorgray 396 797 a
SDict begin H.S end
 396 797 a Fj(1-6.)e(F)o(air)i
(Queuing)990 797 y
SDict begin 13 H.L end
 990 797 a 990 797 a
SDict begin [/Subtype /Link/Dest (0:figure-6) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 990 797 a Black
Black 4 w Fj(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 797 a
SDict begin H.S end
 3800 797
a Fj(18)3884 797 y
SDict begin 13 H.L end
 3884 797 a 3884 797 a
SDict begin [/Subtype /Link/Dest (0:figure-6) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 797 a Black
0 TeXcolorgray 396 905 a
SDict begin H.S end
 396 905 a Fj(1-7.)e(Messaging)h(as)h(it)g
(Starts)1275 905 y
SDict begin 13 H.L end
 1275 905 a 1275 905 a
SDict begin [/Subtype /Link/Dest (0:figure-7) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1275 905 a Black
Black 10 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 905 a
SDict begin H.S end
 3800 905 a Fj(23)3884 905 y
SDict begin 13 H.L end

3884 905 a 3884 905 a
SDict begin [/Subtype /Link/Dest (0:figure-7) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 905 a Black 0 TeXcolorgray
396 1013 a
SDict begin H.S end
 396 1013 a Fj(1-8.)e(Messaging)h(as)h(it)g(Becomes)1391
1013 y
SDict begin 13 H.L end
 1391 1013 a 1391 1013 a
SDict begin [/Subtype /Link/Dest (0:figure-8) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1391 1013 a Black Black
18 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 1013 a
SDict begin H.S end
 3800 1013 a Fj(25)3884 1013 y
SDict begin 13 H.L end
 3884 1013 a
3884 1013 a
SDict begin [/Subtype /Link/Dest (0:figure-8) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 1013 a Black 0 TeXcolorgray 396 1121
a
SDict begin H.S end
 396 1121 a Fj(2-1.)e(TCP)i(sock)o(ets)g(are)f(1)g(to)h(1)1298
1121 y
SDict begin 13 H.L end
 1298 1121 a 1298 1121 a
SDict begin [/Subtype /Link/Dest (0:figure-9) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1298 1121 a Black Black
7 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 1121 a
SDict begin H.S end
 3800
1121 a Fj(32)3884 1121 y
SDict begin 13 H.L end
 3884 1121 a 3884 1121 a
SDict begin [/Subtype /Link/Dest (0:figure-9) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
1121 a Black 0 TeXcolorgray 396 1229 a
SDict begin H.S end
 396 1229 a Fj(2-2.)e(HTTP)i(On)f
(the)g(W)m(ire)1184 1229 y
SDict begin 13 H.L end
 1184 1229 a 1184 1229 a
SDict begin [/Subtype /Link/Dest (0:figure-10) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1184
1229 a Black Black 18 w Fj(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 1229 a
SDict begin H.S end
 3800
1229 a Fj(33)3884 1229 y
SDict begin 13 H.L end
 3884 1229 a 3884 1229 a
SDict begin [/Subtype /Link/Dest (0:figure-10) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
1229 a Black 0 TeXcolorgray 396 1337 a
SDict begin H.S end
 396 1337 a Fj(2-3.)f(\330MQ)i
(On)f(the)g(W)m(ire)1170 1337 y
SDict begin 13 H.L end
 1170 1337 a 1170 1337
a
SDict begin [/Subtype /Link/Dest (0:figure-11) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1170 1337 a Black Black 11 w Fj(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 1337 a
SDict begin H.S end
 3800 1337 a Fj(34)3884 1337
y
SDict begin 13 H.L end
 3884 1337 a 3884 1337 a
SDict begin [/Subtype /Link/Dest (0:figure-11) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 1337 a Black 0 TeXcolorgray
396 1445 a
SDict begin H.S end
 396 1445 a Fj(2-4.)f(Small-scale)i(Pub-Sub)d(Netw)o(ork)1554
1445 y
SDict begin 13 H.L end
 1554 1445 a 1554 1445 a
SDict begin [/Subtype /Link/Dest (0:figure-12) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1554 1445 a Black Black
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 1445 a
SDict begin H.S end

3800 1445 a Fj(43)3884 1445 y
SDict begin 13 H.L end
 3884 1445 a 3884 1445 a
SDict begin [/Subtype /Link/Dest (0:figure-12) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

3884 1445 a Black 0 TeXcolorgray 396 1553 a
SDict begin H.S end
 396 1553
a Fj(2-5.)h(Pub-Sub)g(Netw)o(ork)h(with)g(a)h(Proxy)1592
1553 y
SDict begin 13 H.L end
 1592 1553 a 1592 1553 a
SDict begin [/Subtype /Link/Dest (0:figure-13) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1592 1553 a Black Black
4 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 1553 a
SDict begin H.S end
 3800 1553 a Fj(44)3884 1553
y
SDict begin 13 H.L end
 3884 1553 a 3884 1553 a
SDict begin [/Subtype /Link/Dest (0:figure-13) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 1553 a Black 0 TeXcolorgray
396 1660 a
SDict begin H.S end
 396 1660 a Fj(2-6.)e(Extended)g(Publish-Subscribe)1490
1660 y
SDict begin 13 H.L end
 1490 1660 a 1490 1660 a
SDict begin [/Subtype /Link/Dest (0:figure-14) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1490 1660 a Black Black
2 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 1660 a
SDict begin H.S end

3800 1660 a Fj(45)3884 1660 y
SDict begin 13 H.L end
 3884 1660 a 3884 1660 a
SDict begin [/Subtype /Link/Dest (0:figure-14) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

3884 1660 a Black 0 TeXcolorgray 396 1768 a
SDict begin H.S end
 396 1768
a Fj(2-7.)g(Load-balancing)e(of)j(Requests)1480 1768
y
SDict begin 13 H.L end
 1480 1768 a 1480 1768 a
SDict begin [/Subtype /Link/Dest (0:figure-15) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1480 1768 a Black Black 12
w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 1768 a
SDict begin H.S end

3800 1768 a Fj(46)3884 1768 y
SDict begin 13 H.L end
 3884 1768 a 3884 1768 a
SDict begin [/Subtype /Link/Dest (0:figure-15) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

3884 1768 a Black 0 TeXcolorgray 396 1876 a
SDict begin H.S end
 396 1876
a Fj(2-8.)f(Extended)g(Request-reply)1351 1876 y
SDict begin 13 H.L end
 1351
1876 a 1351 1876 a
SDict begin [/Subtype /Link/Dest (0:figure-16) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1351 1876 a Black Black 17 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 1876 a
SDict begin H.S end
 3800
1876 a Fj(48)3884 1876 y
SDict begin 13 H.L end
 3884 1876 a 3884 1876 a
SDict begin [/Subtype /Link/Dest (0:figure-16) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
1876 a Black 0 TeXcolorgray 396 1984 a
SDict begin H.S end
 396 1984 a Fj(2-9.)g
(Request-reply)g(Brok)o(er)1266 1984 y
SDict begin 13 H.L end
 1266 1984 a 1266
1984 a
SDict begin [/Subtype /Link/Dest (0:figure-17) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1266 1984 a Black Black 19 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 1984 a
SDict begin H.S end
 3800
1984 a Fj(51)3884 1984 y
SDict begin 13 H.L end
 3884 1984 a 3884 1984 a
SDict begin [/Subtype /Link/Dest (0:figure-17) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
1984 a Black 0 TeXcolorgray 396 2092 a
SDict begin H.S end
 396 2092 a Fj(2-10.)g(Pub-Sub)g
(F)o(orw)o(arder)f(Proxy)1461 2092 y
SDict begin 13 H.L end
 1461 2092 a 1461
2092 a
SDict begin [/Subtype /Link/Dest (0:figure-18) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1461 2092 a Black Black 10 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 2092 a
SDict begin H.S end
 3800
2092 a Fj(54)3884 2092 y
SDict begin 13 H.L end
 3884 2092 a 3884 2092 a
SDict begin [/Subtype /Link/Dest (0:figure-18) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
2092 a Black 0 TeXcolorgray 396 2200 a
SDict begin H.S end
 396 2200 a Fj(2-11.)h(P)o
(arallel)h(Pipeline)g(with)g(Kill)h(Signaling)1794 2200
y
SDict begin 13 H.L end
 1794 2200 a 1794 2200 a
SDict begin [/Subtype /Link/Dest (0:figure-19) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1794 2200 a Black Black 9 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
2200 a
SDict begin H.S end
 3800 2200 a Fj(57)3884 2200 y
SDict begin 13 H.L end
 3884 2200 a 3884
2200 a
SDict begin [/Subtype /Link/Dest (0:figure-19) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 2200 a Black 0 TeXcolorgray 396 2308 a
SDict begin H.S end
 396
2308 a Fj(2-12.)e(Multithreaded)f(Serv)o(er)1298 2308
y
SDict begin 13 H.L end
 1298 2308 a 1298 2308 a
SDict begin [/Subtype /Link/Dest (0:figure-20) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1298 2308 a Black Black 7 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 2308 a
SDict begin H.S end
 3800
2308 a Fj(66)3884 2308 y
SDict begin 13 H.L end
 3884 2308 a 3884 2308 a
SDict begin [/Subtype /Link/Dest (0:figure-20) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
2308 a Black 0 TeXcolorgray 396 2416 a
SDict begin H.S end
 396 2416 a Fj(2-13.)h(The)h
(Relay)g(Race)1120 2416 y
SDict begin 13 H.L end
 1120 2416 a 1120 2416 a
SDict begin [/Subtype /Link/Dest (0:figure-21) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1120
2416 a Black Black 19 w Fj(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 2416 a
SDict begin H.S end
 3800
2416 a Fj(69)3884 2416 y
SDict begin 13 H.L end
 3884 2416 a 3884 2416 a
SDict begin [/Subtype /Link/Dest (0:figure-21) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
2416 a Black 0 TeXcolorgray 396 2524 a
SDict begin H.S end
 396 2524 a Fj(2-14.)f(Pub-Sub)g
(Synchronization)1445 2524 y
SDict begin 13 H.L end
 1445 2524 a 1445 2524 a
SDict begin [/Subtype /Link/Dest (0:figure-22) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

1445 2524 a Black Black 6 w Fj(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
2524 a
SDict begin H.S end
 3800 2524 a Fj(72)3884 2524 y
SDict begin 13 H.L end
 3884 2524 a 3884
2524 a
SDict begin [/Subtype /Link/Dest (0:figure-22) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 2524 a Black 0 TeXcolorgray 396 2632 a
SDict begin H.S end
 396
2632 a Fj(2-15.)g(Pub-Sub)g(En)m(v)o(elope)e(with)k(Separate)e(K)n(e)o
(y)1837 2632 y
SDict begin 13 H.L end
 1837 2632 a 1837 2632 a
SDict begin [/Subtype /Link/Dest (0:figure-23) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1837 2632 a Black
Black 8 w Fj(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black 0 TeXcolorgray 3800 2632 a
SDict begin H.S end
 3800 2632 a
Fj(76)3884 2632 y
SDict begin 13 H.L end
 3884 2632 a 3884 2632 a
SDict begin [/Subtype /Link/Dest (0:figure-23) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 2632 a
Black 0 TeXcolorgray 396 2740 a
SDict begin H.S end
 396 2740 a Fj(2-16.)g(Pub-Sub)g(En)m(v)
o(elope)e(with)k(Sender)e(Address)1919 2740 y
SDict begin 13 H.L end
 1919 2740
a 1919 2740 a
SDict begin [/Subtype /Link/Dest (0:figure-24) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1919 2740 a Black Black 9 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 2740 a
SDict begin H.S end

3800 2740 a Fj(77)3884 2740 y
SDict begin 13 H.L end
 3884 2740 a 3884 2740 a
SDict begin [/Subtype /Link/Dest (0:figure-24) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

3884 2740 a Black 0 TeXcolorgray 396 2848 a
SDict begin H.S end
 396 2848
a Fj(2-17.)g(Missing)h(Message)h(Problem)e(Solv)o(er)1709
2848 y
SDict begin 13 H.L end
 1709 2848 a 1709 2848 a
SDict begin [/Subtype /Link/Dest (0:figure-25) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1709 2848 a Black Black
11 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 2848 a
SDict begin H.S end
 3800 2848 a Fj(79)3884 2848
y
SDict begin 13 H.L end
 3884 2848 a 3884 2848 a
SDict begin [/Subtype /Link/Dest (0:figure-25) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 2848 a Black 0 TeXcolorgray
396 2956 a
SDict begin H.S end
 396 2956 a Fj(3-1.)g(Single-hop)g(Request-reply)f(En)m(v)o
(elope)1732 2956 y
SDict begin 13 H.L end
 1732 2956 a 1732 2956 a
SDict begin [/Subtype /Link/Dest (0:figure-26) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1732 2956
a Black Black 9 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 2956 a
SDict begin H.S end
 3800 2956 a Fj(83)3884 2956
y
SDict begin 13 H.L end
 3884 2956 a 3884 2956 a
SDict begin [/Subtype /Link/Dest (0:figure-26) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 2956 a Black 0 TeXcolorgray
396 3064 a
SDict begin H.S end
 396 3064 a Fj(3-2.)h(Multihop)g(Request-reply)g(En)m(v)o
(elope)1677 3064 y
SDict begin 13 H.L end
 1677 3064 a 1677 3064 a
SDict begin [/Subtype /Link/Dest (0:figure-27) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1677 3064
a Black Black 2 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 3064 a
SDict begin H.S end
 3800 3064 a Fj(84)3884 3064
y
SDict begin 13 H.L end
 3884 3064 a 3884 3064 a
SDict begin [/Subtype /Link/Dest (0:figure-27) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3064 a Black 0 TeXcolorgray
396 3171 a
SDict begin H.S end
 396 3171 a Fj(3-3.)g(R)m(OUTER)i(In)m(v)o(ents)e(a)h(UUID)
1424 3171 y
SDict begin 13 H.L end
 1424 3171 a 1424 3171 a
SDict begin [/Subtype /Link/Dest (0:figure-28) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1424 3171 a Black
Black 6 w Fj(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
3171 a
SDict begin H.S end
 3800 3171 a Fj(84)3884 3171 y
SDict begin 13 H.L end
 3884 3171 a 3884
3171 a
SDict begin [/Subtype /Link/Dest (0:figure-28) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3171 a Black 0 TeXcolorgray 396 3279 a
SDict begin H.S end
 396
3279 a Fj(3-4.)f(R)m(OUTER)i(uses)g(Identity)e(If)h(It)g(kno)n(ws)g(It)
1775 3279 y
SDict begin 13 H.L end
 1775 3279 a 1775 3279 a
SDict begin [/Subtype /Link/Dest (0:figure-29) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1775 3279 a Black
Black 8 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black 0 TeXcolorgray 3800 3279 a
SDict begin H.S end
 3800 3279 a
Fj(85)3884 3279 y
SDict begin 13 H.L end
 3884 3279 a 3884 3279 a
SDict begin [/Subtype /Link/Dest (0:figure-29) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3279 a
Black 0 TeXcolorgray 396 3387 a
SDict begin H.S end
 396 3387 a Fj(3-5.)f(R)m
(OUTER-to-DEALER)g(Custom)h(Routing)1893 3387 y
SDict begin 13 H.L end
 1893
3387 a 1893 3387 a
SDict begin [/Subtype /Link/Dest (0:figure-30) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1893 3387 a Black Black 14 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 3387 a
SDict begin H.S end
 3800 3387 a Fj(88)3884 3387
y
SDict begin 13 H.L end
 3884 3387 a 3884 3387 a
SDict begin [/Subtype /Link/Dest (0:figure-30) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3387 a Black 0 TeXcolorgray
396 3495 a
SDict begin H.S end
 396 3495 a Fj(3-6.)f(Routing)h(En)m(v)o(elope)e(for)h
(DEALER)1612 3495 y
SDict begin 13 H.L end
 1612 3495 a 1612 3495 a
SDict begin [/Subtype /Link/Dest (0:figure-31) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1612 3495
a Black Black 5 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 3495 a
SDict begin H.S end
 3800 3495 a Fj(90)3884 3495 y
SDict begin 13 H.L end
 3884 3495 a
3884 3495 a
SDict begin [/Subtype /Link/Dest (0:figure-31) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3495 a Black 0 TeXcolorgray 396 3603
a
SDict begin H.S end
 396 3603 a Fj(3-7.)g(R)m(OUTER)i(to)f(REQ)h(Custom)f(Routing)1718
3603 y
SDict begin 13 H.L end
 1718 3603 a 1718 3603 a
SDict begin [/Subtype /Link/Dest (0:figure-32) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1718 3603 a Black Black
2 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
0 TeXcolorgray 3800 3603 a
SDict begin H.S end
 3800 3603 a Fj(91)3884 3603
y
SDict begin 13 H.L end
 3884 3603 a 3884 3603 a
SDict begin [/Subtype /Link/Dest (0:figure-32) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3603 a Black 0 TeXcolorgray
396 3711 a
SDict begin H.S end
 396 3711 a Fj(3-8.)f(Routing)h(En)m(v)o(elope)e(for)h(REQ)
1450 3711 y
SDict begin 13 H.L end
 1450 3711 a 1450 3711 a
SDict begin [/Subtype /Link/Dest (0:figure-33) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1450 3711 a Black
Black 1 w Fj(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black 0 TeXcolorgray 3800 3711 a
SDict begin H.S end
 3800
3711 a Fj(94)3884 3711 y
SDict begin 13 H.L end
 3884 3711 a 3884 3711 a
SDict begin [/Subtype /Link/Dest (0:figure-33) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884
3711 a Black 0 TeXcolorgray 396 3819 a
SDict begin H.S end
 396 3819 a Fj(3-9.)g(R)m
(OUTER-to-REP)h(Custom)g(Routing)1718 3819 y
SDict begin 13 H.L end
 1718 3819
a 1718 3819 a
SDict begin [/Subtype /Link/Dest (0:figure-34) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1718 3819 a Black Black 2 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray 3800
3819 a
SDict begin H.S end
 3800 3819 a Fj(95)3884 3819 y
SDict begin 13 H.L end
 3884 3819 a 3884
3819 a
SDict begin [/Subtype /Link/Dest (0:figure-34) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 3819 a Black 0 TeXcolorgray 396 3927 a
SDict begin H.S end
 396
3927 a Fj(3-10.)f(Routing)g(En)m(v)o(elope)f(for)i(REP)1478
3927 y
SDict begin 13 H.L end
 1478 3927 a 1478 3927 a
SDict begin [/Subtype /Link/Dest (0:figure-35) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1478 3927 a Black Black
14 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black 0 TeXcolorgray 3800 3927 a
SDict begin H.S end

3800 3927 a Fj(98)3884 3927 y
SDict begin 13 H.L end
 3884 3927 a 3884 3927 a
SDict begin [/Subtype /Link/Dest (0:figure-35) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

3884 3927 a Black 0 TeXcolorgray 396 4035 a
SDict begin H.S end
 396 4035
a Fj(3-11.)f(Basic)i(Request-reply)1263 4035 y
SDict begin 13 H.L end
 1263 4035
a 1263 4035 a
SDict begin [/Subtype /Link/Dest (0:figure-36) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1263 4035 a Black Black 1 w Fj(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 4035 a
SDict begin H.S end
 3800 4035 a Fj(98)3884 4035 y
SDict begin 13 H.L end
 3884 4035 a
3884 4035 a
SDict begin [/Subtype /Link/Dest (0:figure-36) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 4035 a Black 0 TeXcolorgray 396 4143
a
SDict begin H.S end
 396 4143 a Fj(3-12.)e(Stretched)g(Request-reply)1392
4143 y
SDict begin 13 H.L end
 1392 4143 a 1392 4143 a
SDict begin [/Subtype /Link/Dest (0:figure-37) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1392 4143 a Black Black
17 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black 0 TeXcolorgray
3800 4143 a
SDict begin H.S end
 3800 4143 a Fj(99)3884 4143 y
SDict begin 13 H.L end
 3884 4143 a
3884 4143 a
SDict begin [/Subtype /Link/Dest (0:figure-37) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3884 4143 a Black 0 TeXcolorgray 396 4251
a
SDict begin H.S end
 396 4251 a Fj(3-13.)g(Stretched)g(Request-reply)g(with)h(LR)m(U)1742
4251 y
SDict begin 13 H.L end
 1742 4251 a 1742 4251 a
SDict begin [/Subtype /Link/Dest (0:figure-38) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1742 4251 a Black Black
20 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 4251 a
SDict begin H.S end
 3759 4251 a Fj(100)3885 4251 y
SDict begin 13 H.L end
 3885 4251
a 3885 4251 a
SDict begin [/Subtype /Link/Dest (0:figure-38) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4251 a Black 0 TeXcolorgray 396 4359
a
SDict begin H.S end
 396 4359 a Fj(3-14.)f(Message)h(that)g(Client)h(Sends)1469
4359 y
SDict begin 13 H.L end
 1469 4359 a 1469 4359 a
SDict begin [/Subtype /Link/Dest (0:figure-39) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1469 4359 a Black Black
2 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 4359 a
SDict begin H.S end
 3759 4359 a Fj(105)3885
4359 y
SDict begin 13 H.L end
 3885 4359 a 3885 4359 a
SDict begin [/Subtype /Link/Dest (0:figure-39) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4359 a Black 0 TeXcolorgray
396 4467 a
SDict begin H.S end
 396 4467 a Fj(3-15.)e(Message)h(Coming)g(in)g(on)g(Frontend)
1681 4467 y
SDict begin 13 H.L end
 1681 4467 a 1681 4467 a
SDict begin [/Subtype /Link/Dest (0:figure-40) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1681 4467 a Black
Black -2 w Fj(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 4467 a
SDict begin H.S end
 3759 4467 a Fj(105)3885
4467 y
SDict begin 13 H.L end
 3885 4467 a 3885 4467 a
SDict begin [/Subtype /Link/Dest (0:figure-40) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4467 a Black 0 TeXcolorgray
396 4575 a
SDict begin H.S end
 396 4575 a Fj(3-16.)f(Message)h(Sent)h(to)f(Back)o(end)1446
4575 y
SDict begin 13 H.L end
 1446 4575 a 1446 4575 a
SDict begin [/Subtype /Link/Dest (0:figure-41) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1446 4575 a Black Black
5 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 4575
a
SDict begin H.S end
 3759 4575 a Fj(105)3885 4575 y
SDict begin 13 H.L end
 3885 4575 a 3885 4575
a
SDict begin [/Subtype /Link/Dest (0:figure-41) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4575 a Black 0 TeXcolorgray 396 4682 a
SDict begin H.S end
 396 4682
a Fj(3-17.)f(Message)h(Deli)n(v)o(ered)f(to)h(W)-7 b(ork)o(er)1578
4682 y
SDict begin 13 H.L end
 1578 4682 a 1578 4682 a
SDict begin [/Subtype /Link/Dest (0:figure-42) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1578 4682 a Black Black
18 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 4682 a
SDict begin H.S end
 3759 4682
a Fj(106)3885 4682 y
SDict begin 13 H.L end
 3885 4682 a 3885 4682 a
SDict begin [/Subtype /Link/Dest (0:figure-42) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4682
a Black 0 TeXcolorgray 396 4790 a
SDict begin H.S end
 396 4790 a Fj(3-18.)19
b(Asynchronous)e(Client-Serv)o(er)1538 4790 y
SDict begin 13 H.L end
 1538 4790
a 1538 4790 a
SDict begin [/Subtype /Link/Dest (0:figure-43) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1538 4790 a Black Black 16 w Fj(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 4790
a
SDict begin H.S end
 3759 4790 a Fj(113)3885 4790 y
SDict begin 13 H.L end
 3885 4790 a 3885 4790
a
SDict begin [/Subtype /Link/Dest (0:figure-43) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4790 a Black 0 TeXcolorgray 396 4898 a
SDict begin H.S end
 396 4898
a Fj(3-19.)i(Detail)i(of)f(Asynchronous)d(Serv)o(er)1621
4898 y
SDict begin 13 H.L end
 1621 4898 a 1621 4898 a
SDict begin [/Subtype /Link/Dest (0:figure-44) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1621 4898 a Black Black
16 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 4898
a
SDict begin H.S end
 3759 4898 a Fj(117)3885 4898 y
SDict begin 13 H.L end
 3885 4898 a 3885 4898
a
SDict begin [/Subtype /Link/Dest (0:figure-44) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 4898 a Black 0 TeXcolorgray 396 5006 a
SDict begin H.S end
 396 5006
a Fj(3-20.)i(Cluster)i(Architecture)1268 5006 y
SDict begin 13 H.L end
 1268
5006 a 1268 5006 a
SDict begin [/Subtype /Link/Dest (0:figure-45) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1268 5006 a Black Black 17 w Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 5006 a
SDict begin H.S end
 3759 5006 a Fj(121)3885 5006
y
SDict begin 13 H.L end
 3885 5006 a 3885 5006 a
SDict begin [/Subtype /Link/Dest (0:figure-45) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 5006 a Black 0 TeXcolorgray
396 5114 a
SDict begin H.S end
 396 5114 a Fj(3-21.)e(Multiple)h(Clusters)1169
5114 y
SDict begin 13 H.L end
 1169 5114 a 1169 5114 a
SDict begin [/Subtype /Link/Dest (0:figure-46) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1169 5114 a Black Black
12 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 5114 a
SDict begin H.S end
 3759 5114 a Fj(121)3885 5114 y
SDict begin 13 H.L end
 3885 5114
a 3885 5114 a
SDict begin [/Subtype /Link/Dest (0:figure-46) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 5114 a Black Black 3846 5569 a Fi(x)p
Black eop end
%%Page: 11 11
TeXDict begin 11 10 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.xi) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black 0 TeXcolorgray 396 72 a
SDict begin H.S end
 396 72 a Fj(3-22.)19
b(Idea)h(1)g(-)g(Cross-connected)e(W)-7 b(ork)o(ers)1717
72 y
SDict begin 13 H.L end
 1717 72 a 1717 72 a
SDict begin [/Subtype /Link/Dest (0:figure-47) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1717 72 a Black Black 3 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 72 a
SDict begin H.S end
 3759 72 a Fj(122)3885
72 y
SDict begin 13 H.L end
 3885 72 a 3885 72 a
SDict begin [/Subtype /Link/Dest (0:figure-47) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 72 a Black 0 TeXcolorgray
396 180 a
SDict begin H.S end
 396 180 a Fj(3-23.)19 b(Idea)h(2)g(-)g(Brok)o(ers)g(T)-7
b(alking)19 b(to)i(Each)e(Other)1881 180 y
SDict begin 13 H.L end
 1881 180 a
1881 180 a
SDict begin [/Subtype /Link/Dest (0:figure-48) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1881 180 a Black Black 6 w Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 180 a
SDict begin H.S end
 3759
180 a Fj(123)3885 180 y
SDict begin 13 H.L end
 3885 180 a 3885 180 a
SDict begin [/Subtype /Link/Dest (0:figure-48) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 180
a Black 0 TeXcolorgray 396 288 a
SDict begin H.S end
 396 288 a Fj(3-24.)g(Cross-connected)f
(Brok)o(ers)i(in)g(Federation)f(Model)2126 288 y
SDict begin 13 H.L end
 2126
288 a 2126 288 a
SDict begin [/Subtype /Link/Dest (0:figure-49) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2126 288 a Black Black 10 w Fj(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 288 a
SDict begin H.S end
 3759 288 a Fj(125)3885 288 y
SDict begin 13 H.L end
 3885 288 a 3885
288 a
SDict begin [/Subtype /Link/Dest (0:figure-49) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 288 a Black 0 TeXcolorgray 396 396 a
SDict begin H.S end
 396 396
a Fj(3-25.)g(Brok)o(er)g(Sock)o(et)h(Arrangement)1527
396 y
SDict begin 13 H.L end
 1527 396 a 1527 396 a
SDict begin [/Subtype /Link/Dest (0:figure-50) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1527 396 a Black Black 7
w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 396 a
SDict begin H.S end
 3759 396 a Fj(127)3885
396 y
SDict begin 13 H.L end
 3885 396 a 3885 396 a
SDict begin [/Subtype /Link/Dest (0:figure-50) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 396 a Black 0 TeXcolorgray
396 504 a
SDict begin H.S end
 396 504 a Fj(3-26.)f(The)h(State)h(Flo)n(w)1096
504 y
SDict begin 13 H.L end
 1096 504 a 1096 504 a
SDict begin [/Subtype /Link/Dest (0:figure-51) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1096 504 a Black Black 2
w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 504 a
SDict begin H.S end
 3759 504 a Fj(129)3885 504 y
SDict begin 13 H.L end
 3885 504 a 3885
504 a
SDict begin [/Subtype /Link/Dest (0:figure-51) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 504 a Black 0 TeXcolorgray 396 612 a
SDict begin H.S end
 396 612
a Fj(3-27.)e(The)h(Flo)n(w)g(of)g(T)-7 b(asks)1206 612
y
SDict begin 13 H.L end
 1206 612 a 1206 612 a
SDict begin [/Subtype /Link/Dest (0:figure-52) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1206 612 a Black Black 16 w Fj(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 612 a
SDict begin H.S end
 3759 612 a Fj(133)3885 612 y
SDict begin 13 H.L end
 3885 612 a 3885
612 a
SDict begin [/Subtype /Link/Dest (0:figure-52) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 612 a Black 0 TeXcolorgray 396 720 a
SDict begin H.S end
 396 720
a Fj(4-1.)19 b(The)h(Lazy)g(Pirate)g(P)o(attern)1334
720 y
SDict begin 13 H.L end
 1334 720 a 1334 720 a
SDict begin [/Subtype /Link/Dest (0:figure-53) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1334 720 a Black Black 13
w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 720 a
SDict begin H.S end
 3759 720 a Fj(149)3885 720
y
SDict begin 13 H.L end
 3885 720 a 3885 720 a
SDict begin [/Subtype /Link/Dest (0:figure-53) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 720 a Black 0 TeXcolorgray
396 828 a
SDict begin H.S end
 396 828 a Fj(4-2.)f(The)h(Simple)g(Pirate)h(P)o(attern)1404
828 y
SDict begin 13 H.L end
 1404 828 a 1404 828 a
SDict begin [/Subtype /Link/Dest (0:figure-54) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1404 828 a Black Black 5
w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 828 a
SDict begin H.S end
 3759 828 a Fj(154)3885
828 y
SDict begin 13 H.L end
 3885 828 a 3885 828 a
SDict begin [/Subtype /Link/Dest (0:figure-54) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 828 a Black 0 TeXcolorgray
396 936 a
SDict begin H.S end
 396 936 a Fj(4-3.)e(The)h(P)o(aranoid)f(Pirate)h(P)o(attern)
1462 936 y
SDict begin 13 H.L end
 1462 936 a 1462 936 a
SDict begin [/Subtype /Link/Dest (0:figure-55) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1462 936 a Black Black
9 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 936 a
SDict begin H.S end
 3759 936 a Fj(157)3885
936 y
SDict begin 13 H.L end
 3885 936 a 3885 936 a
SDict begin [/Subtype /Link/Dest (0:figure-55) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 936 a Black 0 TeXcolorgray
396 1044 a
SDict begin H.S end
 396 1044 a Fj(4-4.)f(The)h(Majordomo)e(P)o(attern)1346
1044 y
SDict begin 13 H.L end
 1346 1044 a 1346 1044 a
SDict begin [/Subtype /Link/Dest (0:figure-56) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1346 1044 a Black Black
1 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1044 a
SDict begin H.S end
 3759 1044 a Fj(166)3885
1044 y
SDict begin 13 H.L end
 3885 1044 a 3885 1044 a
SDict begin [/Subtype /Link/Dest (0:figure-56) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1044 a Black 0 TeXcolorgray
396 1152 a
SDict begin H.S end
 396 1152 a Fj(4-5.)h(The)h(T)m(itanic)g(P)o(attern)1186
1152 y
SDict begin 13 H.L end
 1186 1152 a 1186 1152 a
SDict begin [/Subtype /Link/Dest (0:figure-57) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1186 1152 a Black Black
16 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray 3759 1152 a
SDict begin H.S end
 3759
1152 a Fj(200)3885 1152 y
SDict begin 13 H.L end
 3885 1152 a 3885 1152 a
SDict begin [/Subtype /Link/Dest (0:figure-57) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885
1152 a Black 0 TeXcolorgray 396 1260 a
SDict begin H.S end
 396 1260 a Fj(4-6.)f(High-a)n(v)
n(ailability)g(P)o(air)m(,)g(Normal)h(Operation)1912
1260 y
SDict begin 13 H.L end
 1912 1260 a 1912 1260 a
SDict begin [/Subtype /Link/Dest (0:figure-58) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1912 1260 a Black Black
16 w Fj(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1260 a
SDict begin H.S end
 3759 1260 a Fj(210)3885
1260 y
SDict begin 13 H.L end
 3885 1260 a 3885 1260 a
SDict begin [/Subtype /Link/Dest (0:figure-58) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1260 a Black 0 TeXcolorgray
396 1368 a
SDict begin H.S end
 396 1368 a Fj(4-7.)f(High-a)n(v)n(ailability)g(P)o(air)h
(During)f(F)o(ailo)o(v)o(er)1817 1368 y
SDict begin 13 H.L end
 1817 1368 a 1817
1368 a
SDict begin [/Subtype /Link/Dest (0:figure-59) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1817 1368 a Black Black 7 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 1368 a
SDict begin H.S end
 3759 1368
a Fj(211)3885 1368 y
SDict begin 13 H.L end
 3885 1368 a 3885 1368 a
SDict begin [/Subtype /Link/Dest (0:figure-59) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1368
a Black 0 TeXcolorgray 396 1476 a
SDict begin H.S end
 396 1476 a Fj(4-8.)g(Binary)h(Star)h
(Finite)f(State)h(Machine)1643 1476 y
SDict begin 13 H.L end
 1643 1476 a 1643
1476 a
SDict begin [/Subtype /Link/Dest (0:figure-60) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1643 1476 a Black Black 15 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1476 a
SDict begin H.S end
 3759 1476 a Fj(216)3885 1476 y
SDict begin 13 H.L end
 3885 1476
a 3885 1476 a
SDict begin [/Subtype /Link/Dest (0:figure-60) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1476 a Black 0 TeXcolorgray 396 1583
a
SDict begin H.S end
 396 1583 a Fj(4-9.)e(The)h(Freelance)g(P)o(attern)1277
1583 y
SDict begin 13 H.L end
 1277 1583 a 1277 1583 a
SDict begin [/Subtype /Link/Dest (0:figure-61) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1277 1583 a Black Black
8 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1583 a
SDict begin H.S end
 3759 1583 a Fj(219)3885
1583 y
SDict begin 13 H.L end
 3885 1583 a 3885 1583 a
SDict begin [/Subtype /Link/Dest (0:figure-61) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1583 a Black 0 TeXcolorgray
396 1691 a
SDict begin H.S end
 396 1691 a Fj(5-1.)f(The)h(Simple)g(Black)h(Box)f(P)o
(attern)1563 1691 y
SDict begin 13 H.L end
 1563 1691 a 1563 1691 a
SDict begin [/Subtype /Link/Dest (0:figure-62) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1563 1691
a Black Black 12 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1691 a
SDict begin H.S end
 3759 1691 a Fj(234)3885 1691 y
SDict begin 13 H.L end
 3885 1691
a 3885 1691 a
SDict begin [/Subtype /Link/Dest (0:figure-62) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1691 a Black 0 TeXcolorgray 396 1799
a
SDict begin H.S end
 396 1799 a Fj(5-2.)f(Mad)h(Black)h(Box)f(P)o(attern)1330
1799 y
SDict begin 13 H.L end
 1330 1799 a 1330 1799 a
SDict begin [/Subtype /Link/Dest (0:figure-63) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1330 1799 a Black Black
17 w Fj(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black 0 TeXcolorgray 3759 1799 a
SDict begin H.S end
 3759 1799 a Fj(235)3885
1799 y
SDict begin 13 H.L end
 3885 1799 a 3885 1799 a
SDict begin [/Subtype /Link/Dest (0:figure-63) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1799 a Black 0 TeXcolorgray
396 1907 a
SDict begin H.S end
 396 1907 a Fj(5-3.)f(Simplest)i(Clone)f(Model)1297
1907 y
SDict begin 13 H.L end
 1297 1907 a 1297 1907 a
SDict begin [/Subtype /Link/Dest (0:figure-64) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1297 1907 a Black Black
8 w Fj(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 1907 a
SDict begin H.S end
 3759 1907 a Fj(237)3885 1907 y
SDict begin 13 H.L end
 3885 1907
a 3885 1907 a
SDict begin [/Subtype /Link/Dest (0:figure-64) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 1907 a Black 0 TeXcolorgray 396 2015
a
SDict begin H.S end
 396 2015 a Fj(5-4.)f(State)i(Replication)1119 2015
y
SDict begin 13 H.L end
 1119 2015 a 1119 2015 a
SDict begin [/Subtype /Link/Dest (0:figure-65) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1119 2015 a Black Black Fj(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray 3759 2015
a
SDict begin H.S end
 3759 2015 a Fj(239)3885 2015 y
SDict begin 13 H.L end
 3885 2015 a 3885 2015
a
SDict begin [/Subtype /Link/Dest (0:figure-65) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2015 a Black 0 TeXcolorgray 396 2123 a
SDict begin H.S end
 396 2123
a Fj(5-5.)e(Republishing)g(Updates)1285 2123 y
SDict begin 13 H.L end
 1285 2123
a 1285 2123 a
SDict begin [/Subtype /Link/Dest (0:figure-66) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1285 2123 a Black Black Fj(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2123 a
SDict begin H.S end
 3759 2123 a Fj(241)3885 2123 y
SDict begin 13 H.L end
 3885 2123
a 3885 2123 a
SDict begin [/Subtype /Link/Dest (0:figure-66) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2123 a Black 0 TeXcolorgray 396 2231
a
SDict begin H.S end
 396 2231 a Fj(5-6.)g(Clone)i(Client)f(Finite)h(State)g(Machine)1685
2231 y
SDict begin 13 H.L end
 1685 2231 a 1685 2231 a
SDict begin [/Subtype /Link/Dest (0:figure-67) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1685 2231 a Black Black
15 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2231 a
SDict begin H.S end
 3759 2231 a Fj(245)3885 2231 y
SDict begin 13 H.L end
 3885 2231
a 3885 2231 a
SDict begin [/Subtype /Link/Dest (0:figure-67) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2231 a Black 0 TeXcolorgray 396 2339
a
SDict begin H.S end
 396 2339 a Fj(5-7.)e(High-a)n(v)n(ailability)g(Clone)h(Serv)o(er)f(P)
o(air)1721 2339 y
SDict begin 13 H.L end
 1721 2339 a 1721 2339 a
SDict begin [/Subtype /Link/Dest (0:figure-68) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1721 2339 a
Black Black 20 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2339 a
SDict begin H.S end
 3759 2339
a Fj(247)3885 2339 y
SDict begin 13 H.L end
 3885 2339 a 3885 2339 a
SDict begin [/Subtype /Link/Dest (0:figure-68) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2339
a Black 0 TeXcolorgray 396 2447 a
SDict begin H.S end
 396 2447 a Fj(6-1.)g(The)h('Start')g
(State)1097 2447 y
SDict begin 13 H.L end
 1097 2447 a 1097 2447 a
SDict begin [/Subtype /Link/Dest (0:figure-69) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1097 2447
a Black Black 1 w Fj(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2447 a
SDict begin H.S end
 3759 2447
a Fj(288)3885 2447 y
SDict begin 13 H.L end
 3885 2447 a 3885 2447 a
SDict begin [/Subtype /Link/Dest (0:figure-69) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2447
a Black 0 TeXcolorgray 396 2555 a
SDict begin H.S end
 396 2555 a Fj(6-2.)f(The)h
('Authenticated')e(State)1406 2555 y
SDict begin 13 H.L end
 1406 2555 a 1406
2555 a
SDict begin [/Subtype /Link/Dest (0:figure-70) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1406 2555 a Black Black 3 w Fj(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2555 a
SDict begin H.S end
 3759 2555 a Fj(288)3885 2555 y
SDict begin 13 H.L end
 3885 2555
a 3885 2555 a
SDict begin [/Subtype /Link/Dest (0:figure-70) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2555 a Black 0 TeXcolorgray 396 2663
a
SDict begin H.S end
 396 2663 a Fj(6-3.)h(The)h('Ready')f(State)1152 2663
y
SDict begin 13 H.L end
 1152 2663 a 1152 2663 a
SDict begin [/Subtype /Link/Dest (0:figure-71) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1152 2663 a Black Black 8 w
Fj(.)p Black Black(.)p Black Black(.)p Black Black -1
w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray 3759 2663 a
SDict begin H.S end
 3759 2663 a Fj(289)3885 2663
y
SDict begin 13 H.L end
 3885 2663 a 3885 2663 a
SDict begin [/Subtype /Link/Dest (0:figure-71) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2663 a Black 0 TeXcolorgray
396 2771 a
SDict begin H.S end
 396 2771 a Fj(8-1.)g(ZRE)i(disco)o(v)o(ery)d(message)1349
2771 y
SDict begin 13 H.L end
 1349 2771 a 1349 2771 a
SDict begin [/Subtype /Link/Dest (0:figure-72) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1349 2771 a Black Black
19 w Fj(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
3759 2771 a
SDict begin H.S end
 3759 2771 a Fj(355)3885 2771 y
SDict begin 13 H.L end
 3885 2771
a 3885 2771 a
SDict begin [/Subtype /Link/Dest (0:figure-72) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2771 a Black 0 TeXcolorgray 396 2879
a
SDict begin H.S end
 396 2879 a Fj(8-2.)h(ZyRE)i(T)-6 b(ester)20 b(T)-7
b(ool)1141 2879 y
SDict begin 13 H.L end
 1141 2879 a 1141 2879 a
SDict begin [/Subtype /Link/Dest (0:figure-73) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1141 2879 a
Black Black 19 w Fj(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray 3759 2879 a
SDict begin H.S end
 3759 2879
a Fj(363)3885 2879 y
SDict begin 13 H.L end
 3885 2879 a 3885 2879 a
SDict begin [/Subtype /Link/Dest (0:figure-73) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3885 2879
a Black Black 3823 5569 a Fi(xi)p Black eop end
%%Page: 12 12
TeXDict begin 12 11 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.xii) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:15) cvn /DEST pdfmark end
 -2 -11 a 126 x Fl(Preface)621 115 y
SDict begin H.S end
 621 115 a 621 115
a
SDict begin 26.957 H.A end
 621 115 a 621 115 a
SDict begin [/View [/XYZ H.V]/Dest (5.0) cvn /DEST pdfmark end
 621 115 a -2 171 a
SDict begin H.S end
 -2 171 a -2
171 a
SDict begin 13 H.A end
 -2 171 a -2 171 a
SDict begin [/View [/XYZ H.V]/Dest (0:17) cvn /DEST pdfmark end
 -2 171 a 375 x Fh(1.)39 b(\330MQ)g(in)g(a)h
(Hundred)e(W)-9 b(or)m(ds)1892 546 y
SDict begin H.S end
 1892 546 a 1892
546 a
SDict begin 22.464 H.A end
 1892 546 a 1892 546 a
SDict begin [/View [/XYZ H.V]/Dest (5.1.1) cvn /DEST pdfmark end
 1892 546 a -2 719 a
SDict begin H.S end
 -2 719
a -2 719 a
SDict begin 13 H.A end
 -2 719 a -2 719 a
SDict begin [/View [/XYZ H.V]/Dest (0:19) cvn /DEST pdfmark end
 -2 719 a 396 820 a Fj(\330MQ)21
b(\(also)f(seen)g(as)h(ZeroMQ,)e(\330MQ,)h(zmq\))g(looks)f(lik)o(e)i
(an)f(embeddable)e(netw)o(orking)g(library)h(b)n(ut)h(acts)h(lik)o(e)f
(a)396 928 y(concurrenc)o(y)d(frame)n(w)o(ork.)h(It)i(gi)n(v)o(es)g
(you)f(sock)o(ets)i(that)f(carry)f(atomic)h(messages)g(across)h(v)n
(arious)e(transports)g(lik)o(e)396 1036 y(in-process,)g(inter)n
(-process,)g(TCP)-9 b(,)20 b(and)g(multicast.)g(Y)-9
b(ou)19 b(can)h(connect)f(sock)o(ets)i(N-to-N)e(with)i(patterns)e(lik)o
(e)i(f)o(anout,)396 1144 y(pub-sub,)d(task)j(distrib)n(ution,)e(and)g
(request-reply)-5 b(.)17 b(It')-5 b(s)21 b(f)o(ast)g(enough)d(to)i(be)h
(the)f(f)o(abric)f(for)h(clustered)f(products.)g(Its)396
1252 y(asynchronous)f(I/O)i(model)f(gi)n(v)o(es)h(you)f(scalable)h
(multicore)f(applications,)g(b)n(uilt)i(as)f(asynchronous)396
1360 y(message-processing)e(tasks.)j(It)f(has)g(a)h(score)f(of)g
(language)e(APIs)j(and)f(runs)g(on)f(most)i(operating)d(systems.)i
(\330MQ)h(is)396 1468 y(from)578 1468 y
SDict begin H.S end
 578 1468 a 578
1468 a
SDict begin 13 H.A end
 578 1468 a 578 1468 a
SDict begin [/View [/XYZ H.V]/Dest (0:20) cvn /DEST pdfmark end
 578 1468 a Fj(iMatix)g(\(http://www)-5
b(.imatix.com\))16 b(and)k(is)h(LGPLv3)e(open)g(source.)-2
1496 y
SDict begin H.S end
 -2 1496 a -2 1496 a
SDict begin 13 H.A end
 -2 1496 a -2 1496 a
SDict begin [/View [/XYZ H.V]/Dest (0:21) cvn /DEST pdfmark end
 -2 1496
a 359 x Fh(2.)39 b(The)g(Zen)g(of)h(Zer)m(o)1232 1855
y
SDict begin H.S end
 1232 1855 a 1232 1855 a
SDict begin 22.464 H.A end
 1232 1855 a 1232 1855 a
SDict begin [/View [/XYZ H.V]/Dest (5.2.1) cvn /DEST pdfmark end
 1232
1855 a -2 2023 a
SDict begin H.S end
 -2 2023 a -2 2023 a
SDict begin 13 H.A end
 -2 2023 a -2 2023
a
SDict begin [/View [/XYZ H.V]/Dest (0:23) cvn /DEST pdfmark end
 -2 2023 a 396 2129 a Fj(The)20 b(\330)h(in)f(\330MQ)h(is)g(all)g
(about)e(tradeof)n(fs.)f(On)i(the)h(one)e(hand)g(this)i(strange)f(name)
f(lo)n(wers)h(\330MQ')-5 b(s)21 b(visibility)f(on)396
2237 y(Google)f(and)h(T)-7 b(witter)i(.)21 b(On)f(the)g(other)g(hand)f
(it)i(anno)o(ys)e(the)h(heck)f(out)h(of)g(some)g(Danish)g(folk)g(who)f
(write)i(us)f(things)396 2345 y(lik)o(e)h("\330MG)f(r\370t\003",)g(and)
f("\330)i(is)g(not)f(a)h(funn)o(y)d(looking)g(zero!")h(and)h(")2406
2345 y
SDict begin H.S end
 2406 2345 a 2406 2345 a
SDict begin 13 H.A end
 2406 2345 a 2406 2345
a
SDict begin [/View [/XYZ H.V]/Dest (0:24) cvn /DEST pdfmark end
 2406 2345 a Fi(R\370dgr)l(\370d)f(med)h(Fl\370de!)p
Fj(",)e(which)i(is)h(apparently)396 2453 y(an)f(insult)g(that)f(means)h
("may)f(your)f(neighbours)f(be)j(the)f(direct)g(descendants)g(of)g
(Grendel!")f(Seems)i(lik)o(e)g(a)g(f)o(air)f(trade.)-2
2637 y
SDict begin H.S end
 -2 2637 a -2 2637 a
SDict begin 13 H.A end
 -2 2637 a -2 2637 a
SDict begin [/View [/XYZ H.V]/Dest (0:25) cvn /DEST pdfmark end
 -2 2637
a 396 2727 a Fj(Originally)g(the)i(zero)e(in)i(\330MQ)f(w)o(as)h(meant)
f(as)h("zero)e(brok)o(er")g(and)g(\(as)i(close)f(to\))g("zero)g(latenc)
o(y")f(\(as)h(possible\).)g(In)396 2835 y(the)g(meantime)g(it)h(has)f
(come)g(to)g(co)o(v)o(er)f(dif)n(ferent)f(goals:)i(zero)g
(administration,)e(zero)i(cost,)g(zero)g(w)o(aste.)g(More)396
2943 y(generally)-5 b(,)18 b("zero")i(refers)f(to)i(the)f(culture)f(of)
h(minimalism)g(that)g(permeates)f(the)h(project.)g(W)-7
b(e)21 b(add)f(po)n(wer)f(by)396 3051 y(remo)o(ving)f(comple)o(xity)g
(rather)h(than)h(e)o(xposing)e(ne)n(w)i(functionality)-5
b(.)-2 3079 y
SDict begin H.S end
 -2 3079 a -2 3079 a
SDict begin 13 H.A end
 -2 3079 a -2 3079 a
SDict begin [/View [/XYZ H.V]/Dest (0:26) cvn /DEST pdfmark end

-2 3079 a 359 x Fh(3.)39 b(Ho)n(w)g(the)g(Guide)f(Happened)1895
3438 y
SDict begin H.S end
 1895 3438 a 1895 3438 a
SDict begin 22.464 H.A end
 1895 3438 a 1895 3438
a
SDict begin [/View [/XYZ H.V]/Dest (5.3.1) cvn /DEST pdfmark end
 1895 3438 a -2 3634 a
SDict begin H.S end
 -2 3634 a -2 3634 a
SDict begin 13 H.A end
 -2 3634 a
-2 3634 a
SDict begin [/View [/XYZ H.V]/Dest (0:28) cvn /DEST pdfmark end
 -2 3634 a 396 3712 a Fj(In)20 b(the)g(summer)g(of)g(2010,)e
(\330MQ)j(w)o(as)g(still)g(a)g(little-kno)n(wn)d(niche)i(library)f
(described)g(by)g(its)j(rather)d(terse)i(man)396 3820
y(pages)f(and)g(a)g(li)n(ving)g(b)n(ut)g(sparse)g(wiki.)g(Martin)g
(Sustrik)g(and)g(myself)f(\(Pieter)i(Hintjens\))e(were)h(sitting)h(in)f
(the)g(bar)g(of)396 3928 y(the)g(Hotel)h(K)n(yje)n(v)e(in)i(Bratisla)n
(v)n(a)f(plotting)f(ho)n(w)h(to)g(mak)o(e)g(\330MQ)h(more)e(widely)h
(popular)-5 b(.)18 b(Martin)i(had)g(written)g(most)396
4036 y(of)g(the)g(\330MQ)h(code,)e(and)h(I')l(d)f(put)h(up)g(the)g
(funding)e(and)i(or)o(ganized)d(the)j(community)-5 b(.)17
b(Ov)o(er)j(some)g(Zlaty)g(Bazants,)396 4144 y(we)h(agreed)e(that)h
(\330MQ)h(needed)d(a)j(ne)n(w)-5 b(,)19 b(simpler)h(web)g(site,)h(and)f
(a)g(basic)h(guide)e(to)h(ne)n(w)g(users.)-2 4328 y
SDict begin H.S end
 -2
4328 a -2 4328 a
SDict begin 13 H.A end
 -2 4328 a -2 4328 a
SDict begin [/View [/XYZ H.V]/Dest (0:29) cvn /DEST pdfmark end
 -2 4328 a 396 4418
a Fj(Martin)g(collected)f(some)h(ideas)h(for)e(topics)h(to)h(e)o
(xplain.)e(I')l(d)g(ne)n(v)o(er)g(written)h(a)g(line)h(of)f(\330MQ)g
(code)f(before)g(this,)i(so)f(it)396 4526 y(became)g(a)g(li)n(v)o(e)g
(learning)f(documentary)-5 b(.)17 b(As)k(I)f(w)o(ork)o(ed)f(through)f
(simple)i(e)o(xamples)f(to)i(more)e(comple)o(x)f(ones)i(I)h(tried)396
4634 y(to)g(answer)e(man)o(y)g(of)h(the)h(questions)e(I')l(d)g(seen)i
(on)e(the)i(mailing)e(list.)i(Since)f(I')l(v)o(e)f(been)h(b)n(uilding)f
(lar)o(ge-scale)396 4741 y(architectures)g(for)h(30)g(years,)f(there)h
(were)g(a)h(lot)f(of)g(problems)f(I)h(w)o(as)h(k)o(een)f(to)g(thro)n(w)
f(\330MQ)i(at.)f(Amazingly)f(the)396 4849 y(results)h(were)g(mostly)g
(simple)f(and)h(ele)o(gant,)e(e)n(v)o(en)h(w)o(orking)f(in)i(C.)h(I)f
(felt)g(a)g(pure)f(jo)o(y)h(learning)e(\330MQ)i(and)g(using)f(it)i(to)
396 4957 y(solv)o(e)f(real)g(problems,)f(which)g(brought)f(me)j(back)e
(to)h(programming)d(after)j(a)h(fe)n(w)f(years')f(pause.)h(And)g
(often,)f(not)396 5065 y(kno)n(wing)g(ho)n(w)g(it)i(w)o(as)g
("supposed")e(to)h(be)g(done,)f(we)i(impro)o(v)o(ed)c(\330MQ)j(as)h(we)
g(went)f(along.)p Black 3800 5569 a Fi(xii)p Black eop
end
%%Page: 13 13
TeXDict begin 13 12 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.xiii) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3628 -132 a Fi(Pr)m(eface)p Black -2 -11 a
SDict begin H.S end
 -2 -11
a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:30) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(From)20
b(the)g(start)h(I)f(w)o(anted)g(the)g(Guide)g(to)g(be)g(a)h(community)d
(project,)h(so)i(I)f(put)g(it)h(onto)e(github)g(and)h(let)g(others)396
180 y(contrib)n(ute)f(with)h(pull)g(requests.)g(This)g(w)o(as)h
(considered)e(a)h(radical,)g(e)n(v)o(en)f(vulgar)f(approach)g(by)i
(some.)g(W)-7 b(e)21 b(came)f(to)396 288 y(a)h(di)n(vision)e(of)h
(labor:)f(I')l(d)h(do)g(the)g(writing)f(and)h(mak)o(e)g(the)g(original)
f(C)i(e)o(xamples,)e(and)h(others)f(w)o(ould)h(help)g(\002x)g(the)396
396 y(te)o(xt)g(and)g(translate)g(the)g(e)o(xamples)f(into)h(other)g
(languages.)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580
a
SDict begin [/View [/XYZ H.V]/Dest (0:31) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(This)h(w)o(ork)o(ed)e(better)h(than)f(I)i
(dared)e(hope:)g(you)g(can)h(no)n(w)g(\002nd)g(all)h(the)f(e)o(xamples)
f(in)h(se)n(v)o(eral)g(languages)f(and)g(man)o(y)396
778 y(in)i(a)f(dozen)f(languages.)g(It')-5 b(s)21 b(a)f(kind)g(of)g
(programming)c(language)j(Rosetta)i(stone)f(and)f(a)i(v)n(aluable)e
(outcome)f(in)396 886 y(itself.)j(W)-7 b(e)21 b(set-up)f(a)g
(high-score:)f(reach)g(80\045)h(translation)f(and)h(your)f(language)f
(got)i(its)i(o)n(wn)d(Guide.)h(PHP)-9 b(,)20 b(Python,)396
994 y(Lua,)g(and)g(Hax)o(e)f(reached)g(this)i(goal.)e(People)h(ask)o
(ed)g(for)g(PDFs,)h(and)e(we)i(made)e(that.)h(People)g(ask)o(ed)g(for)g
(ebooks,)396 1102 y(and)g(got)g(those.)g(About)f(a)h(hundred)e(people)h
(contrib)n(uted)g(to)h(the)g(Guide)g(to)g(date.)-2 1286
y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286 a -2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:32) cvn /DEST pdfmark end
 -2 1286 a 396
1376 a Fj(The)g(Guide)g(achie)n(v)o(ed)e(its)j(goal)f(of)g
(popularizing)e(\330MQ.)i(The)g(style)g(pleases)h(most)f(and)g(anno)o
(ys)f(some,)g(which)h(is)396 1484 y(ho)n(w)g(it)h(should)e(be.)h(In)g
(December)f(2010)f(my)i(w)o(ork)g(on)g(\330MQ)g(and)g(the)g(Guide)g
(stopped,)e(as)j(I)g(found)d(myself)i(going)396 1592
y(through)e(late-stage)i(cancer)m(,)f(hea)n(vy)g(sur)o(gery)-5
b(,)18 b(and)i(six)g(months)f(of)h(chemotherap)o(y)-5
b(.)17 b(When)j(I)g(pick)o(ed)g(up)f(w)o(ork)h(again)396
1700 y(in)h(mid-2011,)c(it)k(w)o(as)g(to)f(start)h(using)f(\330MQ)g(in)
g(anger)g(for)f(one)h(of)g(the)g(lar)o(gest)f(use-cases)i(imagineable:)
d(on)i(the)396 1808 y(mobile)g(phones)f(and)g(tablets)i(of)f(the)g(w)o
(orld')-5 b(s)20 b(biggest)f(electronics)h(compan)o(y)-5
b(.)-2 1992 y
SDict begin H.S end
 -2 1992 a -2 1992 a
SDict begin 13 H.A end
 -2 1992 a -2 1992 a
SDict begin [/View [/XYZ H.V]/Dest (0:33) cvn /DEST pdfmark end

-2 1992 a 396 2082 a Fj(But)21 b(the)f(goal)g(of)g(the)g(Guide)g(w)o
(as,)g(from)g(the)g(start,)g(a)h(printed)e(book.)f(So)j(it)g(w)o(as)g
(e)o(xciting)e(to)h(get)g(an)g(email)h(from)e(Bill)396
2190 y(Lubano)o(vic)f(in)i(January)f(2012)g(introducing)f(me)i(to)g
(his)h(editor)e(Andy)g(Oram)h(at)h(O'Reilly)-5 b(,)20
b(suggesting)e(a)j(\330MQ)396 2297 y(book.)d(Of)h(course!)g(Where)g(do)
g(I)g(sign?)h(Ho)n(w)f(much)f(do)h(I)h(ha)n(v)o(e)e(to)i(pay?)f(Oh,)g
(I)2720 2297 y
SDict begin H.S end
 2720 2297 a 2720 2297 a
SDict begin 13 H.A end
 2720 2297 a 2720
2297 a
SDict begin [/View [/XYZ H.V]/Dest (0:34) cvn /DEST pdfmark end
 2720 2297 a Fi(g)o(et)h(mone)n(y)e Fj(for)h(this?)g(All)h(I)g
(ha)n(v)o(e)f(to)g(do)396 2405 y(is)i(\002nish)g(it?)-2
2572 y
SDict begin H.S end
 -2 2572 a -2 2572 a
SDict begin 13 H.A end
 -2 2572 a -2 2572 a
SDict begin [/View [/XYZ H.V]/Dest (0:35) cvn /DEST pdfmark end
 -2 2572
a 396 2679 a Fj(Of)g(course)e(as)i(soon)f(as)g(O'Reilly)h(announced)c
(a)k(\330MQ)f(book,)f(other)g(publishers)g(started)h(sending)f(out)h
(emails)h(to)396 2787 y(potential)e(authors.)f(Y)-9 b(ou')o(ll)19
b(probably)f(see)i(a)g(rash)g(of)f(\330MQ)h(books)f(coming)f(out)h(ne)o
(xt)g(year)-5 b(.)19 b(That')-5 b(s)20 b(good:)e(our)h(niche)396
2895 y(library)g(has)i(hit)f(the)g(mainstream)g(and)f(deserv)o(es)h
(its)h(six)f(inches)g(of)g(shelf)g(space.)g(My)g(apologies)f(to)i(the)f
(other)f(\330MQ)396 3003 y(authors:)h(we')l(v)o(e)f(set)i(the)f(bar)g
(horribly)e(high,)h(and)h(my)g(advice)f(is)i(to)f(mak)o(e)g(your)f
(books)g(complimentary)-5 b(.)17 b(Perhaps)396 3111 y(focus)j(on)g(a)g
(speci\002c)h(language,)d(platform,)g(or)i(pattern.)-2
3295 y
SDict begin H.S end
 -2 3295 a -2 3295 a
SDict begin 13 H.A end
 -2 3295 a -2 3295 a
SDict begin [/View [/XYZ H.V]/Dest (0:36) cvn /DEST pdfmark end
 -2 3295
a 396 3385 a Fj(This)h(is)g(the)f(magic)g(and)f(po)n(wer)g(of)h
(communities:)f(be)h(the)g(\002rst)h(community)d(in)j(a)f(space,)g
(stay)h(healthy)-5 b(,)18 b(and)i(you)396 3493 y(o)n(wn)g(that)g(space)
g(for)g(e)n(v)o(er)-5 b(.)-2 3521 y
SDict begin H.S end
 -2 3521 a -2 3521
a
SDict begin 13 H.A end
 -2 3521 a -2 3521 a
SDict begin [/View [/XYZ H.V]/Dest (0:37) cvn /DEST pdfmark end
 -2 3521 a 359 x Fh(4.)39 b(A)l(udience)801
3880 y
SDict begin H.S end
 801 3880 a 801 3880 a
SDict begin 22.464 H.A end
 801 3880 a 801 3880 a
SDict begin [/View [/XYZ H.V]/Dest (5.4.1) cvn /DEST pdfmark end
 801
3880 a -2 4048 a
SDict begin H.S end
 -2 4048 a -2 4048 a
SDict begin 13 H.A end
 -2 4048 a -2 4048
a
SDict begin [/View [/XYZ H.V]/Dest (0:39) cvn /DEST pdfmark end
 -2 4048 a 396 4154 a Fj(This)21 b(book)d(is)k(written)e(for)f
(professional)g(programmers)e(who)j(w)o(ant)g(to)g(learn)g(ho)n(w)g(to)
g(mak)o(e)g(the)g(massi)n(v)o(ely)396 4262 y(distrib)n(uted)g(softw)o
(are)f(that)i(will)g(dominate)d(the)i(future)f(of)h(computing.)e(W)-7
b(e)21 b(assume)g(you)e(can)h(read)g(C)h(code,)396 4370
y(because)f(most)g(of)g(the)g(e)o(xamples)f(here)h(are)g(in)g(C)h(e)n
(v)o(en)f(though)e(\330MQ)i(is)i(used)e(in)g(man)o(y)f(languages.)f(W)
-7 b(e)22 b(assume)396 4478 y(you)e(care)g(about)f(scale,)h(because)g
(\330MQ)g(solv)o(es)g(that)h(problem)d(abo)o(v)o(e)h(all)h(others.)g(W)
-7 b(e)21 b(assume)f(you)g(need)f(the)h(best)396 4586
y(possible)g(results)h(with)f(the)g(least)h(possible)f(cost,)g(because)
g(otherwise)f(you)h(w)o(on')o(t)f(appreciate)g(the)h(trade-of)n(fs)e
(that)396 4694 y(\330MQ)j(mak)o(es.)f(Other)f(than)h(that)g(basic)h
(background,)16 b(we)21 b(try)f(to)g(present)g(all)g(the)h(concepts)e
(in)h(netw)o(orking)e(and)396 4802 y(distrib)n(uted)i(computing)d(you)j
(will)h(need)e(to)i(use)f(\330MQ.)-2 4830 y
SDict begin H.S end
 -2 4830 a
-2 4830 a
SDict begin 13 H.A end
 -2 4830 a -2 4830 a
SDict begin [/View [/XYZ H.V]/Dest (0:40) cvn /DEST pdfmark end
 -2 4830 a Black 3777 5569
a Fi(xiii)p Black eop end
%%Page: 14 14
TeXDict begin 14 13 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.xiv) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3628 -132 a Fi(Pr)m(eface)p Black -2 91 a Fh(5.)39
b(Ac)m(kno)n(wledg)q(ements)1505 91 y
SDict begin H.S end
 1505 91 a 1505
91 a
SDict begin 22.464 H.A end
 1505 91 a 1505 91 a
SDict begin [/View [/XYZ H.V]/Dest (5.5.1) cvn /DEST pdfmark end
 1505 91 a -2 289 a
SDict begin H.S end
 -2 289 a
-2 289 a
SDict begin 13 H.A end
 -2 289 a -2 289 a
SDict begin [/View [/XYZ H.V]/Dest (0:42) cvn /DEST pdfmark end
 -2 289 a 396 365 a Fj(Thanks)19
b(to)i(Andy)e(Oram)h(for)f(making)1549 365 y
SDict begin H.S end
 1549 365
a 1549 365 a
SDict begin 13 H.A end
 1549 365 a 1549 365 a
SDict begin [/View [/XYZ H.V]/Dest (0:43) cvn /DEST pdfmark end
 1549 365 a Fj(this)i(happen)d(at)j
(O'Reilly)396 473 y(\(http://shop.oreilly)-5 b(.com/prod)o(uct/0)o(63)o
(69)o(20)o(02)o(61)o(36)o(.do)o(\))15 b(and)k(editing)h(the)g(book.)-2
657 y
SDict begin H.S end
 -2 657 a -2 657 a
SDict begin 13 H.A end
 -2 657 a -2 657 a
SDict begin [/View [/XYZ H.V]/Dest (0:44) cvn /DEST pdfmark end
 -2 657 a 396
747 a Fj(Thanks)f(to)i(Bill)g(Desmarais,)f(Brian)g(Dorse)o(y)-5
b(,)19 b(Daniel)h(Lin,)g(Eric)g(Desgranges,)f(Gonzalo)g(Diethelm,)g
(Guido)396 855 y(Goldstein,)h(Hunter)f(F)o(ord,)g(Kamil)h(Shakiro)o(v)
-5 b(,)18 b(Martin)i(Sustrik,)g(Mik)o(e)g(Castleman,)g(Na)n(v)o(een)f
(Cha)o(wla,)h(Nicola)396 963 y(Peduzzi,)g(Oli)n(v)o(er)f(Smith,)h(Oli)n
(vier)g(Chamoux,)e(Peter)j(Ale)o(xander)m(,)c(Pierre)j(Rouleau,)g
(Randy)f(Dryb)n(ur)o(gh,)e(John)396 1071 y(Unwin,)j(Ale)o(x)g(Thomas,)f
(Mihail)h(Mink)o(o)o(v)-5 b(,)18 b(Jeremy)h(A)-6 b(vnet,)20
b(Michael)f(Compton,)g(Kamil)h(Kisiel,)h(Mark)396 1179
y(Kharitono)o(v)-5 b(,)17 b(Guillaume)j(Aubert,)f(Ian)g(Barber)m(,)g
(Mik)o(e)i(Sheridan,)d(F)o(aruk)i(Akgul,)f(Ole)o(g)g(Sidoro)o(v)-5
b(,)18 b(Le)n(v)i(Gi)n(v)n(on,)396 1287 y(Allister)h(MacLeod,)e(Ale)o
(xander)f(D'Archangel,)g(Andreas)h(Hoelzl)o(wimmer)m(,)g(Han)h(Holl,)g
(Robert)g(G.)g(Jakabosk)o(y)-5 b(,)396 1394 y(Felipe)21
b(Cruz,)e(Marcus)h(McCurdy)-5 b(,)19 b(Mikhail)g(K)o(ulemin,)g(Dr)-5
b(.)21 b(Ger)o(g\366)d(\311rdi,)i(P)o(a)n(v)o(el)g(Zhuk)o(o)o(v)-5
b(,)17 b(Ale)o(xander)i(Else,)396 1502 y(Gio)o(v)n(anni)g(Ruggiero,)f
(Rick)j("T)-6 b(echno)n(weenie",)17 b(Daniel)j(Lundin,)f(Da)n(v)o(e)h
(Hoo)o(v)o(er)m(,)d(Simon)j(Jef)n(ford,)f(Benjamin)396
1610 y(Peterson,)h(Justin)g(Case,)h(De)n(v)n(on)e(W)-7
b(eller)m(,)21 b(Richard)f(Smith,)f(Ale)o(xander)g(Morland,)f(W)-7
b(adim)21 b(Grasza,)f(Michael)g(Jakl,)396 1718 y(Uwe)h(Dauernheim,)d
(Sebastian)i(No)n(wicki,)f(Simone)g(Deponti,)g(Aaron)h(Raddon,)e(Dan)j
(Colish,)f(Markus)f(Schirp,)396 1826 y(Benoit)h(Larroque,)e(Jonathan)h
(P)o(alardy)-5 b(,)19 b(Isaiah)h(Peng,)f(Arkadiusz)g(Orzecho)n(wski,)g
(Umut)g(A)-8 b(ydin,)20 b(Matthe)n(w)396 1934 y(Horsf)o(all,)g(Jeremy)g
(W)-8 b(.)21 b(Sherman,)d(Eric)i(Pugh,)g(T)-7 b(yler)20
b(Sellon,)f(John)h(E.)g(V)-5 b(incent,)20 b(P)o(a)n(v)o(el)g(Mitin,)g
(Min)g(RK,)h(Igor)396 2042 y(W)m(iedler)m(,)f(Olof)f(\305k)o(esson,)h
(P)o(atrick)g(Lucas,)g(Heo)n(w)f(Goodman,)f(Senthil)i(P)o(alanisami,)g
(John)g(Gallagher)m(,)e(T)-7 b(omas)396 2150 y(Roos,)20
b(Stephen)g(McQuay)-5 b(,)18 b(Erik)i(Allik,)g(Arnaud)f
(Cogolu\350gnes,)f(Rob)i(Gagnon,)f(Dan)h(W)m(illiams,)g(Edw)o(ard)f
(Smith,)396 2258 y(James)i(T)l(uck)o(er)m(,)e(Kristian)h(Kristensen,)g
(V)-9 b(adim)19 b(Shalts,)i(Martin)e(T)m(rojer)m(,)g(T)-7
b(om)20 b(v)n(an)g(Leeuwen,)e(P)o(andya)h(Hiten,)h(Harm)396
2366 y(Aarts,)h(Marc)f(Harter)m(,)f(Iskren)g(Iv)n(o)o(v)g(Cherne)n(v)-5
b(,)18 b(Jay)j(Han,)f(Sonia)f(Hamilton,)h(Nathan)f(Stocks,)h(Na)n(v)o
(een)f(P)o(alli,)i(and)396 2474 y(Zed)f(Sha)o(w)g(for)g(their)g
(contrib)n(utions.)-2 2641 y
SDict begin H.S end
 -2 2641 a -2 2641 a
SDict begin 13 H.A end
 -2 2641
a -2 2641 a
SDict begin [/View [/XYZ H.V]/Dest (0:45) cvn /DEST pdfmark end
 -2 2641 a 396 2748 a Fj(Thanks)f(to)i(Stathis)g(Sideris)f
(for)1363 2748 y
SDict begin H.S end
 1363 2748 a 1363 2748 a
SDict begin 13 H.A end
 1363 2748 a
1363 2748 a
SDict begin [/View [/XYZ H.V]/Dest (0:46) cvn /DEST pdfmark end
 1363 2748 a Fj(Ditaa)g(\(http://www)-5 b(.ditaa.or)o(g\).)p
Black 3786 5569 a Fi(xiv)p Black eop end
%%Page: 1 15
TeXDict begin 1 14 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.1) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:basics) cvn /DEST pdfmark end
 -2 -11 a 126 x Fl(Chapter)48 b(1.)f(Basics)1443 115
y
SDict begin H.S end
 1443 115 a 1443 115 a
SDict begin 26.957 H.A end
 1443 115 a 1443 115 a
SDict begin [/View [/XYZ H.V]/Dest (6.0) cvn /DEST pdfmark end
 1443 115
a -2 204 a
SDict begin H.S end
 -2 204 a -2 204 a
SDict begin 13 H.A end
 -2 204 a -2 204 a
SDict begin [/View [/XYZ H.V]/Dest (0:49) cvn /DEST pdfmark end
 -2 204
a 342 x Fh(1.1.)39 b(Fixing)f(the)h(W)-9 b(orld)1392
546 y
SDict begin H.S end
 1392 546 a 1392 546 a
SDict begin 22.464 H.A end
 1392 546 a 1392 546 a
SDict begin [/View [/XYZ H.V]/Dest (6.6.1) cvn /DEST pdfmark end
 1392
546 a -2 744 a
SDict begin H.S end
 -2 744 a -2 744 a
SDict begin 13 H.A end
 -2 744 a -2 744 a
SDict begin [/View [/XYZ H.V]/Dest (0:51) cvn /DEST pdfmark end
 -2
744 a 396 820 a Fj(Ho)n(w)20 b(to)h(e)o(xplain)e(\330MQ?)h(Some)g(of)g
(us)g(start)h(by)f(saying)f(all)i(the)f(w)o(onderful)e(things)i(it)h
(does.)3148 820 y
SDict begin H.S end
 3148 820 a 3148 820 a
SDict begin 13 H.A end
 3148 820 a 3148
820 a
SDict begin [/View [/XYZ H.V]/Dest (0:52) cvn /DEST pdfmark end
 3148 820 a Fi(It')m(s)f(soc)n(k)o(ets)h(on)396
928 y(ster)l(oids.)f(It')m(s)f(lik)o(e)h(mailboxes)f(with)h(r)l(outing)
o(.)e(It')m(s)h(fast!)h Fj(Others)f(try)g(to)h(share)f(their)g(moment)f
(of)h(enlightenment,)e(that)396 1036 y(zap-po)n(w-kaboom)f(satori)k
(paradigm-shift)e(moment)h(when)g(it)i(all)g(became)e(ob)o(vious.)2952
1036 y
SDict begin H.S end
 2952 1036 a 2952 1036 a
SDict begin 13 H.A end
 2952 1036 a 2952 1036
a
SDict begin [/View [/XYZ H.V]/Dest (0:53) cvn /DEST pdfmark end
 2952 1036 a Fi(Things)h(just)h(become)e(simpler)-9
b(.)396 1144 y(Comple)n(xity)21 b(goes)e(away)-5 b(.)21
b(It)f(opens)g(the)g(mind.)f Fj(Others)h(try)g(to)h(e)o(xplain)e(by)g
(comparison.)3031 1144 y
SDict begin H.S end
 3031 1144 a 3031 1144 a
SDict begin 13 H.A end
 3031
1144 a 3031 1144 a
SDict begin [/View [/XYZ H.V]/Dest (0:54) cvn /DEST pdfmark end
 3031 1144 a Fi(It')m(s)h(smaller)-9
b(,)21 b(simpler)-9 b(,)20 b(b)n(ut)396 1252 y(still)i(looks)e
(familiar)-9 b(.)20 b Fj(Personally)-5 b(,)18 b(I)j(lik)o(e)f(to)g
(remember)f(why)g(we)i(made)e(\330MQ)i(at)f(all,)h(because)e(that')-5
b(s)21 b(most)f(lik)o(ely)396 1360 y(where)g(you,)f(the)h(reader)m(,)f
(still)i(are)f(today)-5 b(.)-2 1544 y
SDict begin H.S end
 -2 1544 a -2 1544
a
SDict begin 13 H.A end
 -2 1544 a -2 1544 a
SDict begin [/View [/XYZ H.V]/Dest (0:55) cvn /DEST pdfmark end
 -2 1544 a 396 1634 a Fj(Programming)18
b(is)j(a)f(science)g(dressed)g(up)g(as)h(art,)f(because)g(most)g(of)g
(us)g(don')o(t)f(understand)f(the)i(physics)f(of)h(softw)o(are,)396
1741 y(and)g(it')-5 b(s)21 b(rarely)f(if)g(e)n(v)o(er)f(taught.)g(The)h
(physics)g(of)g(softw)o(are)f(is)i(not)f(algorithms,)f(data)h
(structures,)f(languages)g(and)396 1849 y(abstractions.)g(These)h(are)g
(just)h(tools)f(we)h(mak)o(e,)f(use,)g(thro)n(w)f(a)o(w)o(ay)-5
b(.)19 b(The)h(real)g(physics)g(of)g(softw)o(are)f(is)j(the)e(physics)
396 1957 y(of)g(people.)-2 2141 y
SDict begin H.S end
 -2 2141 a -2 2141 a
SDict begin 13 H.A end

-2 2141 a -2 2141 a
SDict begin [/View [/XYZ H.V]/Dest (0:56) cvn /DEST pdfmark end
 -2 2141 a 396 2231 a Fj(Speci\002cally)-5
b(,)19 b(our)h(limitations)g(when)f(it)i(comes)f(to)h(comple)o(xity)-5
b(,)17 b(and)j(our)f(desire)h(to)g(w)o(ork)g(together)f(to)h(solv)o(e)g
(lar)o(ge)396 2339 y(problems)f(in)h(pieces.)g(This)h(is)g(the)f
(science)g(of)g(programming:)d(mak)o(e)j(b)n(uilding)e(blocks)i(that)g
(people)f(can)396 2447 y(understand)f(and)i(use)1053
2447 y
SDict begin H.S end
 1053 2447 a 1053 2447 a
SDict begin 13 H.A end
 1053 2447 a 1053 2447
a
SDict begin [/View [/XYZ H.V]/Dest (0:57) cvn /DEST pdfmark end
 1053 2447 a Fi(easily)p Fj(,)h(and)e(people)g(will)i(w)o(ork)f
(together)f(to)h(solv)o(e)g(the)g(v)o(ery)f(lar)o(gest)h(problems.)-2
2631 y
SDict begin H.S end
 -2 2631 a -2 2631 a
SDict begin 13 H.A end
 -2 2631 a -2 2631 a
SDict begin [/View [/XYZ H.V]/Dest (0:58) cvn /DEST pdfmark end
 -2 2631
a 396 2721 a Fj(W)-7 b(e)22 b(li)n(v)o(e)e(in)g(a)h(connected)d(w)o
(orld,)h(and)h(modern)e(softw)o(are)i(has)g(to)h(na)n(vigate)e(this)h
(w)o(orld.)g(So)g(the)g(b)n(uilding)f(blocks)h(for)396
2829 y(tomorro)n(w')-5 b(s)19 b(v)o(ery)g(lar)o(gest)g(solutions)h(are)
g(connected)e(and)i(massi)n(v)o(ely)g(parallel.)f(It')-5
b(s)21 b(not)f(enough)e(for)i(code)f(to)h(be)396 2937
y("strong)f(and)h(silent")h(an)o(y)e(more.)g(Code)h(has)h(to)f(talk)g
(to)h(code.)e(Code)h(has)g(to)h(be)f(chatty)-5 b(,)19
b(sociable,)g(well-connected.)396 3045 y(Code)h(has)h(to)f(run)f(lik)o
(e)i(the)f(human)f(brain,)g(trillions)h(of)g(indi)n(vidual)e(neurons)h
(\002ring)h(of)n(f)f(messages)i(to)f(each)g(other)m(,)e(a)396
3153 y(massi)n(v)o(ely)h(parallel)h(netw)o(ork)e(with)i(no)f(central)h
(control,)e(no)h(single)h(point)f(of)g(f)o(ailure,)g(yet)h(able)g(to)f
(solv)o(e)h(immensely)396 3261 y(dif)n(\002cult)g(problems.)e(And)i
(it')-5 b(s)21 b(no)f(accident)g(that)g(the)g(future)f(of)h(code)f
(looks)h(lik)o(e)h(the)f(human)f(brain,)g(because)g(the)396
3369 y(endpoints)g(of)h(e)n(v)o(ery)f(netw)o(ork)g(are,)g(at)i(some)f
(le)n(v)o(el,)g(human)f(brains.)-2 3553 y
SDict begin H.S end
 -2 3553 a -2
3553 a
SDict begin 13 H.A end
 -2 3553 a -2 3553 a
SDict begin [/View [/XYZ H.V]/Dest (0:59) cvn /DEST pdfmark end
 -2 3553 a 396 3643 a Fj(If)h(you')l(v)o(e)e
(done)h(an)o(y)h(w)o(ork)f(with)i(threads,)e(protocols,)f(or)i(netw)o
(orks,)f(you')o(ll)h(realize)g(this)g(is)i(pretty)d(much)396
3751 y(impossible.)h(It')-5 b(s)20 b(a)h(dream.)e(Ev)o(en)g(connecting)
f(a)j(fe)n(w)f(programs)e(across)j(a)f(fe)n(w)g(sock)o(ets)h(is)g
(plain)f(nasty)-5 b(,)19 b(when)g(you)396 3859 y(start)i(to)f(handle)f
(real)i(life)f(situations.)g(T)m(rillions?)g(The)f(cost)i(w)o(ould)e
(be)i(unimaginable.)c(Connecting)i(computers)f(is)396
3966 y(so)j(dif)n(\002cult)e(that)i(softw)o(are)e(and)h(services)g(to)h
(do)e(this)i(is)g(a)g(multi-billion)d(dollar)i(b)n(usiness.)-2
4133 y
SDict begin H.S end
 -2 4133 a -2 4133 a
SDict begin 13 H.A end
 -2 4133 a -2 4133 a
SDict begin [/View [/XYZ H.V]/Dest (0:60) cvn /DEST pdfmark end
 -2 4133
a 396 4240 a Fj(So)h(we)f(li)n(v)o(e)g(in)h(a)f(w)o(orld)g(where)f(the)
i(wiring)e(is)i(years)f(ahead)g(of)f(our)h(ability)g(to)g(use)h(it.)f
(W)-7 b(e)22 b(had)d(a)i(softw)o(are)f(crisis)h(in)396
4348 y(the)f(1980s,)f(when)h(leading)f(softw)o(are)h(engineers)f(lik)o
(e)h(Fred)g(Brooks)g(belie)n(v)o(ed)2745 4348 y
SDict begin H.S end
 2745
4348 a 2745 4348 a
SDict begin 13 H.A end
 2745 4348 a 2745 4348 a
SDict begin [/View [/XYZ H.V]/Dest (0:61) cvn /DEST pdfmark end
 2745 4348
a Fj(there)g(w)o(as)h(no)f("Silv)o(er)g(Bullet")396 4456
y(\(http://en.wikipedia.or)o(g/wiki/No-Silv)n(er)n(-Bullet\))14
b(to)20 b("promise)f(e)n(v)o(en)g(one)g(order)g(of)g(magnitude)f(of)i
(impro)o(v)o(ement)396 4564 y(in)h(producti)n(vity)-5
b(,)17 b(reliability)-5 b(,)19 b(or)g(simplicity".)-2
4748 y
SDict begin H.S end
 -2 4748 a -2 4748 a
SDict begin 13 H.A end
 -2 4748 a -2 4748 a
SDict begin [/View [/XYZ H.V]/Dest (0:62) cvn /DEST pdfmark end
 -2 4748
a 396 4838 a Fj(Brooks)h(missed)g(free)g(and)g(open)f(source)g(softw)o
(are,)h(which)f(solv)o(ed)h(that)g(crisis,)h(enabling)d(us)j(to)f
(share)g(kno)n(wledge)396 4946 y(ef)n(\002ciently)-5
b(.)19 b(T)-7 b(oday)19 b(we)h(f)o(ace)g(another)e(softw)o(are)i
(crisis,)g(b)n(ut)g(it')-5 b(s)21 b(one)f(we)g(don')o(t)e(talk)i(about)
f(much.)g(Only)h(the)g(lar)o(gest,)396 5054 y(richest)g(\002rms)h(can)f
(af)n(ford)e(to)j(create)f(connected)e(applications.)h(There)g(is)i(a)g
(cloud,)e(b)n(ut)h(it')-5 b(s)21 b(proprietary)-5 b(.)17
b(Our)j(data,)p Black -2 5569 a
SDict begin H.S end
 -2 5569 a -2 5569 a
SDict begin 13 H.A end
 -2
5569 a -2 5569 a
SDict begin [/View [/XYZ H.V]/Dest (0:63) cvn /DEST pdfmark end
 -2 5569 a 3842 5638 a Fi(1)p Black eop
end
%%Page: 2 16
TeXDict begin 2 15 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.2) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fj(our)g(kno)n(wledge)e(is)j(disappearing)d(from)h(our)g
(personal)g(computers)g(into)h(clouds)f(that)i(we)f(cannot)f(access,)i
(cannot)396 180 y(compete)e(with.)h(Who)h(o)n(wns)f(our)f(social)h
(netw)o(orks?)g(It)g(is)h(lik)o(e)g(the)f(mainframe-PC)e(re)n(v)n
(olution)h(in)h(re)n(v)o(erse.)396 454 y(W)-7 b(e)22
b(can)e(lea)n(v)o(e)g(the)g(political)g(philosophy)d(for)j(another)e
(book)h(\(http://swsi.info\).)g(The)g(point)h(is)h(that)f(while)g(the)
396 562 y(Internet)f(of)n(fers)f(the)i(potential)e(of)i(massi)n(v)o
(ely)f(connected)e(code,)i(the)g(reality)h(is)g(that)g(this)g(is)g(out)
f(of)h(reach)f(for)f(most)i(of)396 670 y(us,)h(and)e(so,)i(lar)o(ge)e
(interesting)g(problems)g(\(in)h(health,)f(education,)f(economics,)h
(transport,)g(and)g(so)i(on\))e(remain)396 778 y(unsolv)o(ed)g(because)
g(there)h(is)h(no)f(w)o(ay)g(to)g(connect)f(the)h(code,)g(and)f(thus)h
(no)g(w)o(ay)h(to)f(connect)f(the)h(brains)g(that)g(could)396
886 y(w)o(ork)g(together)f(to)h(solv)o(e)g(these)g(problems.)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:65) cvn /DEST pdfmark end
 -2 1070
a 396 1160 a Fj(There)g(ha)n(v)o(e)f(been)h(man)o(y)f(attempts)h(to)g
(solv)o(e)g(the)g(challenge)f(of)h(connected)e(softw)o(are.)i(There)f
(are)h(thousands)f(of)396 1268 y(IETF)h(speci\002cations,)f(each)g
(solving)g(part)g(of)g(the)h(puzzle.)e(F)o(or)i(application)e(de)n(v)o
(elopers,)f(HTTP)j(is)g(perhaps)f(the)g(one)396 1376
y(solution)h(to)g(ha)n(v)o(e)g(been)f(simple)h(enough)e(to)j(w)o(ork,)e
(b)n(ut)h(it)h(ar)o(guably)d(mak)o(es)i(the)g(problem)f(w)o(orse,)h(by)
f(encouraging)396 1484 y(de)n(v)o(elopers)f(and)i(architects)g(to)g
(think)g(in)g(terms)g(of)g(big)g(serv)o(ers)g(and)f(thin,)h(stupid)g
(clients.)-2 1668 y
SDict begin H.S end
 -2 1668 a -2 1668 a
SDict begin 13 H.A end
 -2 1668 a -2
1668 a
SDict begin [/View [/XYZ H.V]/Dest (0:66) cvn /DEST pdfmark end
 -2 1668 a 396 1758 a Fj(So)h(today)e(people)g(are)h(still)i
(connecting)c(applications)h(using)g(ra)o(w)h(UDP)h(and)f(TCP)-9
b(,)20 b(proprietary)e(protocols,)g(HTTP)-9 b(,)396 1866
y(W)i(ebsock)o(ets.)20 b(It)h(remains)f(painful,)e(slo)n(w)-5
b(,)20 b(hard)f(to)i(scale,)f(and)g(essentially)g(centralized.)f
(Distrib)n(uted)h(P2P)396 1974 y(architectures)f(are)h(mostly)g(for)g
(play)-5 b(,)19 b(not)h(w)o(ork.)f(Ho)n(w)h(man)o(y)f(applications)g
(use)h(Sk)o(ype)f(or)h(Bittorrent)g(to)g(e)o(xchange)396
2082 y(data?)-2 2248 y
SDict begin H.S end
 -2 2248 a -2 2248 a
SDict begin 13 H.A end
 -2 2248 a
-2 2248 a
SDict begin [/View [/XYZ H.V]/Dest (0:67) cvn /DEST pdfmark end
 -2 2248 a 396 2356 a Fj(Which)g(brings)g(us)g(back)g(to)g
(the)g(science)g(of)g(programming.)d(T)-7 b(o)20 b(\002x)h(the)f(w)o
(orld,)f(we)i(needed)e(to)h(do)g(tw)o(o)g(things.)g(One,)396
2464 y(to)h(solv)o(e)e(the)i(general)e(problem)f(of)i("ho)n(w)g(to)g
(connect)f(an)o(y)g(code)h(to)g(an)o(y)f(code,)h(an)o(ywhere".)e(T)-7
b(w)o(o,)20 b(to)g(wrap)g(that)g(up)396 2571 y(in)h(the)f(simplest)g
(possible)g(b)n(uilding)f(blocks)h(that)g(people)f(could)g(understand)f
(and)i(use)2977 2571 y
SDict begin H.S end
 2977 2571 a 2977 2571 a
SDict begin 13 H.A end
 2977 2571
a 2977 2571 a
SDict begin [/View [/XYZ H.V]/Dest (0:68) cvn /DEST pdfmark end
 2977 2571 a Fi(easily)p Fj(.)-2 2755 y
SDict begin H.S end

-2 2755 a -2 2755 a
SDict begin 13 H.A end
 -2 2755 a -2 2755 a
SDict begin [/View [/XYZ H.V]/Dest (0:69) cvn /DEST pdfmark end
 -2 2755 a 396
2845 a Fj(It)h(sounds)e(ridiculously)g(simple.)g(And)h(maybe)f(it)i
(is.)g(That')-5 b(s)20 b(kind)g(of)g(the)g(whole)g(point.)-2
2874 y
SDict begin H.S end
 -2 2874 a -2 2874 a
SDict begin 13 H.A end
 -2 2874 a -2 2874 a
SDict begin [/View [/XYZ H.V]/Dest (0:70) cvn /DEST pdfmark end
 -2 2874
a 359 x Fh(1.2.)39 b(A)l(udience)e(f)m(or)i(This)g(Book)1881
3233 y
SDict begin H.S end
 1881 3233 a 1881 3233 a
SDict begin 22.464 H.A end
 1881 3233 a 1881 3233
a
SDict begin [/View [/XYZ H.V]/Dest (6.7.1) cvn /DEST pdfmark end
 1881 3233 a -2 3401 a
SDict begin H.S end
 -2 3401 a -2 3401 a
SDict begin 13 H.A end
 -2 3401 a
-2 3401 a
SDict begin [/View [/XYZ H.V]/Dest (0:72) cvn /DEST pdfmark end
 -2 3401 a 396 3507 a Fj(W)-7 b(e)22 b(assume)e(you)f(are)h
(using)g(the)g(latest)h(3.2)f(release)g(of)g(\330MQ.)g(W)-7
b(e)21 b(assume)f(you)g(are)g(using)g(a)g(Linux)f(box)h(or)396
3615 y(something)f(similar)-5 b(.)21 b(W)-7 b(e)21 b(assume)f(you)f
(can)h(read)g(C)h(code,)e(more)h(or)g(less,)h(that')-5
b(s)20 b(the)h(def)o(ault)e(language)f(for)i(the)396
3723 y(e)o(xamples.)f(W)-7 b(e)21 b(assume)g(that)f(when)f(we)i(write)f
(constants)g(lik)o(e)h(PUSH)g(or)e(SUBSCRIBE)j(you)e(can)g(imagine)f
(the)o(y)396 3831 y(are)h(really)g(called)947 3831 y
SDict begin H.S end

947 3831 a 947 3831 a
SDict begin 13 H.A end
 947 3831 a 947 3831 a
SDict begin [/View [/XYZ H.V]/Dest (0:73) cvn /DEST pdfmark end
 947 3831
a Fg(ZMQ-PUSH)g Fj(or)1417 3831 y
SDict begin H.S end
 1417 3831 a 1417 3831
a
SDict begin 13 H.A end
 1417 3831 a 1417 3831 a
SDict begin [/View [/XYZ H.V]/Dest (0:74) cvn /DEST pdfmark end
 1417 3831 a Fg(ZMQ-SUBSCRIBE)e
Fj(if)j(the)f(programming)c(language)j(needs)h(it.)-2
3859 y
SDict begin H.S end
 -2 3859 a -2 3859 a
SDict begin 13 H.A end
 -2 3859 a -2 3859 a
SDict begin [/View [/XYZ H.V]/Dest (0:75) cvn /DEST pdfmark end
 -2 3859
a 359 x Fh(1.3.)39 b(Getting)f(the)h(Examples)1746 4218
y
SDict begin H.S end
 1746 4218 a 1746 4218 a
SDict begin 22.464 H.A end
 1746 4218 a 1746 4218 a
SDict begin [/View [/XYZ H.V]/Dest (6.8.1) cvn /DEST pdfmark end
 1746
4218 a -2 4416 a
SDict begin H.S end
 -2 4416 a -2 4416 a
SDict begin 13 H.A end
 -2 4416 a -2 4416
a
SDict begin [/View [/XYZ H.V]/Dest (0:77) cvn /DEST pdfmark end
 -2 4416 a 396 4492 a Fj(The)20 b(Guide)g(e)o(xamples)f(li)n(v)o(e)h
(in)g(the)g(Guide')-5 b(s)1731 4492 y
SDict begin H.S end
 1731 4492 a 1731
4492 a
SDict begin 13 H.A end
 1731 4492 a 1731 4492 a
SDict begin [/View [/XYZ H.V]/Dest (0:78) cvn /DEST pdfmark end
 1731 4492 a Fj(git)21
b(repository)d(\(https://github)m(.com/imatix/zguide\).)c(The)20
b(simplest)396 4600 y(w)o(ay)h(to)f(get)g(all)h(the)f(e)o(xamples)f(is)
i(to)g(clone)e(this)i(repository:)-2 4701 y
SDict begin H.S end
 -2 4701 a
-2 4701 a
SDict begin 11.7 H.A end
 -2 4701 a -2 4701 a
SDict begin [/View [/XYZ H.V]/Dest (0:79) cvn /DEST pdfmark end
 -2 4701 a 396 4780 a Fg(git)45
b(clone)f(--depth=1)f(git://github.com/imatix/zguide.git)-2
4958 y
SDict begin H.S end
 -2 4958 a -2 4958 a
SDict begin 13 H.A end
 -2 4958 a -2 4958 a
SDict begin [/View [/XYZ H.V]/Dest (0:80) cvn /DEST pdfmark end
 -2 4958
a 396 5054 a Fj(And)20 b(then)g(bro)n(wse)f(the)h(e)o(xamples)f
(subdirectory)-5 b(.)18 b(Y)-9 b(ou')o(ll)19 b(\002nd)h(e)o(xamples)f
(by)h(language.)e(If)i(there)g(are)g(e)o(xamples)396
5162 y(missing)g(in)h(a)f(language)f(you)g(use,)h(you')l(re)f
(encouraged)e(to)2158 5162 y
SDict begin H.S end
 2158 5162 a 2158 5162 a
SDict begin 13 H.A end

2158 5162 a 2158 5162 a
SDict begin [/View [/XYZ H.V]/Dest (0:81) cvn /DEST pdfmark end
 2158 5162 a Fj(submit)j(a)h(translation)p
Black 3842 5569 a Fi(2)p Black eop end
%%Page: 3 17
TeXDict begin 3 16 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.3) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fj(\(http://zguide.zeromq.or)o(g)o(/main)o(:translate\))o(.)15
b(This)20 b(is)h(ho)n(w)f(the)g(Guide)g(became)f(so)i(useful,)e(thanks)
h(to)g(the)g(w)o(ork)g(of)396 180 y(man)o(y)f(people.)g(All)i(e)o
(xamples)e(are)h(licensed)g(under)f(MIT/X11.)-2 209 y
SDict begin H.S end

-2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:82) cvn /DEST pdfmark end
 -2 209 a 359 x Fh(1.4.)39
b(Ask)g(and)g(Y)-11 b(e)39 b(Shall)f(Receive)2005 568
y
SDict begin H.S end
 2005 568 a 2005 568 a
SDict begin 22.464 H.A end
 2005 568 a 2005 568 a
SDict begin [/View [/XYZ H.V]/Dest (6.9.1) cvn /DEST pdfmark end
 2005 568
a -2 736 a
SDict begin H.S end
 -2 736 a -2 736 a
SDict begin 13 H.A end
 -2 736 a -2 736 a
SDict begin [/View [/XYZ H.V]/Dest (0:84) cvn /DEST pdfmark end
 -2 736
a 396 842 a Fj(So)21 b(let')-5 b(s)21 b(start)g(with)f(some)g(code.)f
(W)-7 b(e)22 b(start)e(of)g(course)g(with)g(a)h(Hello)f(W)-7
b(orld)20 b(e)o(xample.)f(W)-7 b(e')o(ll)21 b(mak)o(e)f(a)g(client)h
(and)e(a)396 950 y(serv)o(er)-5 b(.)20 b(The)g(client)g(sends)g
("Hello")g(to)g(the)h(serv)o(er)m(,)d(which)i(replies)g(with)h("W)-7
b(orld"\()p 0 TeXcolorgray 2852 950 a
SDict begin H.S end
 2852 950 a Fj(Figure)18
b(1-1)3200 950 y
SDict begin 13 H.L end
 3200 950 a 3200 950 a
SDict begin [/Subtype /Link/Dest (0:figure-1) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3200 950 a Black
-1 w Fj(\).)i(Here')-5 b(s)20 b(the)g(serv)o(er)396 1058
y(in)h(C,)f(which)g(opens)g(a)g(\330MQ)h(sock)o(et)f(on)f(port)h(5555,)
f(reads)g(requests)h(on)g(it,)h(and)e(replies)h(with)h("W)-7
b(orld")20 b(to)g(each)396 1166 y(request:)-2 1184 y
SDict begin H.S end

-2 1184 a -2 1184 a
SDict begin 13 H.A end
 -2 1184 a -2 1184 a
SDict begin [/View [/XYZ H.V]/Dest (0:hwserver-c) cvn /DEST pdfmark
end
 -2 1184 a 396
1367 a Fk(Example)h(1-1.)e(Hello)h(W)-6 b(orld)20 b(ser)o(v)o(er)g
(\(hwser)o(v)o(er)-8 b(.c\))-2 1467 y
SDict begin H.S end
 -2 1467 a -2 1467
a
SDict begin 11.7 H.A end
 -2 1467 a -2 1467 a
SDict begin [/View [/XYZ H.V]/Dest (0:88) cvn /DEST pdfmark end
 -2 1467 a 396 1547 a Fg(//)396
1644 y(//)90 b(Hello)44 b(World)g(server)396 1741 y(//)90
b(Binds)44 b(REP)g(socket)g(to)g(tcp://)1742 1754 y(*)1787
1741 y(:5555)396 1839 y(//)90 b(Expects)43 b("Hello")h(from)g(client,)g
(replies)f(with)i("World")396 1936 y(//)396 2033 y(#include)f(<zmq.h>)
396 2130 y(#include)g(<stdio.h>)396 2227 y(#include)g(<unistd.h>)396
2324 y(#include)g(<string.h>)396 2519 y(int)h(main)f(\(void\))396
2616 y({)576 2713 y(void)800 2726 y(*)845 2713 y(context)f(=)i
(zmq_ctx_new)e(\(\);)576 2907 y(//)89 b(Socket)44 b(to)g(talk)g(to)h
(clients)576 3004 y(void)800 3017 y(*)845 3004 y(responder)e(=)i
(zmq_socket)e(\(context,)g(ZMQ_REP\);)576 3101 y(zmq_bind)g
(\(responder,)g("tcp://)1832 3114 y(*)1877 3101 y(:5555"\);)576
3296 y(while)h(\(true\))f({)755 3393 y(//)89 b(Wait)44
b(for)h(next)f(request)g(from)g(client)755 3490 y(zmq_msg_t)f(request;)
755 3587 y(zmq_msg_init)g(\(&request\);)755 3684 y(zmq_msg_recv)g
(\(&request,)g(responder,)g(0\);)755 3781 y(printf)h(\("Received)f
(Hello\\n"\);)755 3878 y(zmq_msg_close)g(\(&request\);)755
4073 y(//)89 b(Do)45 b(some)f('work')755 4170 y(sleep)g(\(1\);)755
4364 y(//)89 b(Send)44 b(reply)g(back)h(to)f(client)755
4461 y(zmq_msg_t)f(reply;)755 4558 y(zmq_msg_init_size)f(\(&reply,)h
(5\);)755 4655 y(memcpy)h(\(zmq_msg_data)e(\(&reply\),)i("World",)f
(5\);)755 4753 y(zmq_msg_send)g(\(&reply,)g(responder,)g(0\);)755
4850 y(zmq_msg_close)g(\(&reply\);)576 4947 y(})576 5044
y(//)89 b(We)44 b(never)g(get)h(here)f(but)g(if)h(we)f(did,)g(this)h
(would)f(be)g(how)g(we)h(end)576 5141 y(zmq_close)e(\(responder\);)p
Black 3842 5569 a Fi(3)p Black eop end
%%Page: 4 18
TeXDict begin 4 17 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.4) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
576 72 a Fg(zmq_ctx_destroy)42 b(\(context\);)576 170
y(return)h(0;)396 267 y(})-2 275 y
SDict begin H.S end
 -2 275 a -2 275 a
SDict begin 13 H.A end

-2 275 a -2 275 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-1) cvn /DEST pdfmark end
 -2 275 a 396 541 a Fk(Figur)o(e)20
b(1-1.)f(Request-Reply)-2 641 y
SDict begin H.S end
 -2 641 a -2 641 a
SDict begin 13 H.A end
 -2
641 a -2 641 a
SDict begin [/View [/XYZ H.V]/Dest (0:91) cvn /DEST pdfmark end
 -2 641 a 396 3365 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3365 a @beginspecial
0 @llx -322 @lly 200 @urx 0 @ury 2000 @rwi @setspecial
%%BeginDocument: images/fig1.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -322 200 0
%%HiResBoundingBox: 0.0 -322.0 200.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.000301361083984 -38.000301361083984 moveto
38.000301361083984 -92.00029754638672 lineto
168.00030517578125 -92.00029754638672 lineto
168.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.000301361083984 -96.00029754638672 moveto
38.000301361083984 -115.00029754638672 lineto
38.000301361083984 -119.66696421305339 39.66696802775065 -122.00029754638672 43.000301361083984 -122.00029754638672 curveto
163.00030517578125 -122.00029754638672 lineto
163.00030517578125 -122.00029754638672 lineto
166.3336385091146 -122.00029754638672 168.00030517578125 -119.66696421305339 168.00030517578125 -115.00029754638672 curveto
168.00030517578125 -96.00029754638672 lineto
168.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
43.000301361083984 -206.00030517578125 moveto
39.66696802775065 -206.00030517578125 38.000301361083984 -208.3336385091146 38.000301361083984 -213.00030517578125 curveto
38.000301361083984 -232.00030517578125 lineto
168.00030517578125 -232.00030517578125 lineto
168.00030517578125 -213.00030517578125 lineto
168.00030517578125 -208.3336385091146 166.3336385091146 -206.00030517578125 163.00030517578125 -206.00030517578125 curveto
43.000301361083984 -206.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.000301361083984 -236.00030517578125 moveto
38.000301361083984 -290.00030517578125 lineto
168.00030517578125 -290.00030517578125 lineto
168.00030517578125 -236.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
35.0 -35.0 moveto
35.0 -89.0 lineto
165.0 -89.0 lineto
165.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
35.0 -35.0 moveto
35.0 -89.0 lineto
165.0 -89.0 lineto
165.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
35.0 -93.0 moveto
35.0 -112.0 lineto
35.0 -116.66666666666667 36.666666666666664 -119.0 40.0 -119.0 curveto
160.0 -119.0 lineto
160.0 -119.0 lineto
163.33333333333334 -119.0 165.0 -116.66666666666667 165.0 -112.0 curveto
165.0 -93.0 lineto
165.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
35.0 -93.0 moveto
35.0 -112.0 lineto
35.0 -116.66666666666667 36.666666666666664 -119.0 40.0 -119.0 curveto
160.0 -119.0 lineto
160.0 -119.0 lineto
163.33333333333334 -119.0 165.0 -116.66666666666667 165.0 -112.0 curveto
165.0 -93.0 lineto
165.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
40.0 -203.0 moveto
36.666666666666664 -203.0 35.0 -205.33333333333334 35.0 -210.0 curveto
35.0 -229.0 lineto
165.0 -229.0 lineto
165.0 -210.0 lineto
165.0 -205.33333333333334 163.33333333333334 -203.0 160.0 -203.0 curveto
40.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
40.0 -203.0 moveto
36.666666666666664 -203.0 35.0 -205.33333333333334 35.0 -210.0 curveto
35.0 -229.0 lineto
165.0 -229.0 lineto
165.0 -210.0 lineto
165.0 -205.33333333333334 163.33333333333334 -203.0 160.0 -203.0 curveto
40.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
35.0 -233.0 moveto
35.0 -287.0 lineto
165.0 -287.0 lineto
165.0 -233.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
35.0 -233.0 moveto
35.0 -287.0 lineto
165.0 -287.0 lineto
165.0 -233.0 lineto
closepath
stroke
newpath
75.0 -119.0 moveto
75.0 -189.0 lineto
stroke
newpath
125.0 -133.0 moveto
125.0 -203.0 lineto
stroke
newpath
125.0 -126.0 moveto
120.0 -140.0 lineto
130.0 -140.0 lineto
closepath
fill
newpath
70.0 -182.0 moveto
75.0 -196.0 lineto
80.0 -182.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
77.0 -68.0 moveto
(Client) show
80.0 -110.0 moveto
(REQ) show
27.0 -166.0 moveto
("Hello") show
113.0 -166.0 moveto
("World") show
81.0 -222.0 moveto
(REP) show
73.0 -264.0 moveto
(Server) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3365 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3365 a -2 3531 a
SDict begin H.S end
 -2 3531
a -2 3531 a
SDict begin 13 H.A end
 -2 3531 a -2 3531 a
SDict begin [/View [/XYZ H.V]/Dest (0:94) cvn /DEST pdfmark end
 -2 3531 a 396 3639 a
Fj(The)h(REQ-REP)h(sock)o(et)f(pair)g(is)h(in)f(lockstep.)f(The)h
(client)g(issues)2349 3639 y
SDict begin H.S end
 2349 3639 a 2349 3639 a
SDict begin 13 H.A end

2349 3639 a 2349 3639 a
SDict begin [/View [/XYZ H.V]/Dest (0:95) cvn /DEST pdfmark end
 2349 3639 a Fg(zmq-msg-send[3])e
Fj(and)h(then)396 3747 y
SDict begin H.S end
 396 3747 a 396 3747 a
SDict begin 13 H.A end
 396 3747
a 396 3747 a
SDict begin [/View [/XYZ H.V]/Dest (0:96) cvn /DEST pdfmark end
 396 3747 a Fg(zmq-msg-recv[3])p Fj(,)f(in)j(a)f(loop)g
(\(or)f(once)h(if)g(that')-5 b(s)21 b(all)g(it)f(needs\).)g(Doing)f(an)
o(y)g(other)h(sequence)f(\(e.g.)g(sending)g(tw)o(o)396
3855 y(messages)i(in)f(a)h(ro)n(w\))e(will)i(result)f(in)g(a)h(return)e
(code)h(of)g(-1)f(from)h(the)2428 3855 y
SDict begin H.S end
 2428 3855 a
2428 3855 a
SDict begin 13 H.A end
 2428 3855 a 2428 3855 a
SDict begin [/View [/XYZ H.V]/Dest (0:97) cvn /DEST pdfmark end
 2428 3855 a Fg(send)g
Fj(or)2718 3855 y
SDict begin H.S end
 2718 3855 a 2718 3855 a
SDict begin 13 H.A end
 2718 3855 a
2718 3855 a
SDict begin [/View [/XYZ H.V]/Dest (0:98) cvn /DEST pdfmark end
 2718 3855 a Fg(recv)g Fj(call.)g(Similarly)-5
b(,)19 b(the)i(service)396 3963 y(issues)615 3963 y
SDict begin H.S end
 615
3963 a 615 3963 a
SDict begin 13 H.A end
 615 3963 a 615 3963 a
SDict begin [/View [/XYZ H.V]/Dest (0:99) cvn /DEST pdfmark end
 615 3963 a Fg(zmq-msg-recv[3])e
Fj(and)g(then)1613 3963 y
SDict begin H.S end
 1613 3963 a 1613 3963 a
SDict begin 13 H.A end
 1613
3963 a 1613 3963 a
SDict begin [/View [/XYZ H.V]/Dest (0:100) cvn /DEST pdfmark end
 1613 3963 a Fg(zmq-msg-send[3])f Fj(in)j(that)f
(order)m(,)e(as)j(often)e(as)i(it)g(needs)f(to.)-2 4141
y
SDict begin H.S end
 -2 4141 a -2 4141 a
SDict begin 13 H.A end
 -2 4141 a -2 4141 a
SDict begin [/View [/XYZ H.V]/Dest (0:101) cvn /DEST pdfmark end
 -2 4141 a 396
4237 a Fj(\330MQ)h(uses)f(C)i(as)e(its)i(reference)c(language)h(and)g
(this)i(is)g(the)f(main)g(language)f(we')o(ll)h(use)h(for)e(e)o
(xamples.)g(If)h(you')l(re)396 4345 y(reading)f(this)i(on-line,)d(the)j
(link)f(belo)n(w)f(the)h(e)o(xample)f(tak)o(es)i(you)e(to)h
(translations)g(into)g(other)f(programming)396 4453 y(languages.)g
(Let')-5 b(s)21 b(compare)d(the)i(same)h(serv)o(er)e(in)h(C++:)-2
4471 y
SDict begin H.S end
 -2 4471 a -2 4471 a
SDict begin 13 H.A end
 -2 4471 a -2 4471 a
SDict begin [/View [/XYZ H.V]/Dest (0:hwserver-cpp) cvn /DEST pdfmark
end
 -2 4471
a 396 4654 a Fk(Example)h(1-2.)e(Hello)h(W)-6 b(orld)20
b(ser)o(v)o(er)g(\(hwser)o(v)o(er)-8 b(.cpp\))-2 4754
y
SDict begin H.S end
 -2 4754 a -2 4754 a
SDict begin 11.7 H.A end
 -2 4754 a -2 4754 a
SDict begin [/View [/XYZ H.V]/Dest (0:104) cvn /DEST pdfmark end
 -2 4754 a 396
4835 a Fg(//)396 4932 y(//)90 b(Hello)44 b(World)g(server)f(in)i(C++)
396 5029 y(//)90 b(Binds)44 b(REP)g(socket)g(to)g(tcp://)1742
5042 y(*)1787 5029 y(:5555)396 5126 y(//)90 b(Expects)43
b("Hello")h(from)g(client,)g(replies)f(with)i("World")p
Black 3842 5569 a Fi(4)p Black eop end
%%Page: 5 19
TeXDict begin 5 18 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.5) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fg(//)396 170 y(#include)44 b(<zmq.hpp>)396
267 y(#include)g(<string>)396 364 y(#include)g(<iostream>)396
461 y(#include)g(<unistd.h>)396 655 y(int)h(main)f(\(\))g({)576
752 y(//)89 b(Prepare)44 b(our)g(context)g(and)g(socket)576
850 y(zmq::context_t)e(context)i(\(1\);)576 947 y(zmq::socket_t)e
(socket)i(\(context,)f(ZMQ_REP\);)576 1044 y(socket.bind)g(\("tcp://)
1474 1057 y(*)1519 1044 y(:5555"\);)576 1238 y(while)h(\(true\))f({)755
1335 y(zmq::message_t)f(request;)755 1530 y(//)89 b(Wait)44
b(for)h(next)f(request)g(from)g(client)755 1627 y(socket.recv)f
(\(&request\);)755 1724 y(std::cout)g(<<)i("Received)e(Hello")h(<<)g
(std::endl;)755 1918 y(//)89 b(Do)45 b(some)f('work')755
2015 y(sleep)g(\(1\);)755 2209 y(//)89 b(Send)44 b(reply)g(back)h(to)f
(client)755 2307 y(zmq::message_t)e(reply)i(\(5\);)755
2404 y(memcpy)g(\(\(void)1383 2417 y(*)1428 2404 y(\))g(reply.data)f
(\(\),)i("World",)e(5\);)755 2501 y(socket.send)g(\(reply\);)576
2598 y(})576 2695 y(return)g(0;)396 2792 y(})-2 2967
y
SDict begin H.S end
 -2 2967 a -2 2967 a
SDict begin 13 H.A end
 -2 2967 a -2 2967 a
SDict begin [/View [/XYZ H.V]/Dest (0:105) cvn /DEST pdfmark end
 -2 2967 a 396
3066 a Fj(Y)-9 b(ou)20 b(can)g(see)h(that)f(the)g(\330MQ)h(API)f(is)h
(similar)g(in)f(C)h(and)f(C++.)g(In)g(a)h(language)d(lik)o(e)j(PHP)-9
b(,)20 b(we)h(can)f(hide)f(e)n(v)o(en)h(more)396 3174
y(and)g(the)g(code)g(becomes)f(e)n(v)o(en)g(easier)h(to)h(read:)-2
3175 y
SDict begin H.S end
 -2 3175 a -2 3175 a
SDict begin 13 H.A end
 -2 3175 a -2 3175 a
SDict begin [/View [/XYZ H.V]/Dest (0:hwserver-php) cvn /DEST pdfmark
end
 -2 3175
a 396 3376 a Fk(Example)g(1-3.)e(Hello)h(W)-6 b(orld)20
b(ser)o(v)o(er)g(\(hwser)o(v)o(er)-8 b(.php\))-2 3475
y
SDict begin H.S end
 -2 3475 a -2 3475 a
SDict begin 11.7 H.A end
 -2 3475 a -2 3475 a
SDict begin [/View [/XYZ H.V]/Dest (0:108) cvn /DEST pdfmark end
 -2 3475 a 396
3556 a Fg(<?php)396 3653 y(/)441 3666 y(*)441 3763 y(*)576
3750 y(Hello)44 b(World)g(server)441 3860 y(*)576 3847
y(Binds)g(REP)g(socket)g(to)g(tcp://)1742 3860 y(*)1787
3847 y(:5555)441 3957 y(*)576 3944 y(Expects)f("Hello")h(from)g
(client,)g(replies)f(with)i("World")441 4054 y(*)531
4041 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4151 y(*)486
4138 y(/)396 4333 y($context)g(=)g(new)h(ZMQContext\(1\);)396
4527 y(//)90 b(Socket)43 b(to)i(talk)f(to)h(clients)396
4624 y($responder)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REP\);)396 4721 y($responder->bind\("tcp://)1476
4734 y(*)1521 4721 y(:5555"\);)396 4916 y(while\(true\))h({)441
5013 y(//)89 b(Wait)45 b(for)f(next)g(request)g(from)g(client)441
5110 y($request)g(=)g($responder->recv\(\);)p Black 3842
5569 a Fi(5)p Black eop end
%%Page: 6 20
TeXDict begin 6 19 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.6) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:120) cvn /DEST pdfmark end
 -2 -201 a 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p
Black 441 72 a Fg(printf)44 b(\("Received)f(request:)h([\045s]\\n",)f
($request\);)441 267 y(//)89 b(Do)45 b(some)f('work')441
364 y(sleep)g(\(1\);)441 558 y(//)89 b(Send)45 b(reply)f(back)g(to)g
(client)441 655 y($responder->send\("World"\);)-2 833
y
SDict begin H.S end
 -2 833 a -2 833 a
SDict begin 13 H.A end
 -2 833 a -2 833 a
SDict begin [/View [/XYZ H.V]/Dest (0:109) cvn /DEST pdfmark end
 -2 833 a 396 929
a Fj(Here')-5 b(s)21 b(the)f(client)g(code:)-2 930 y
SDict begin H.S end

-2 930 a -2 930 a
SDict begin 13 H.A end
 -2 930 a -2 930 a
SDict begin [/View [/XYZ H.V]/Dest (0:hwclient-php) cvn /DEST pdfmark
end
 -2 930 a 396 1131
a Fk(Example)h(1-4.)e(Hello)h(W)-6 b(orld)20 b(client)g
(\(hwclient.php\))-2 1230 y
SDict begin H.S end
 -2 1230 a -2 1230 a
SDict begin 11.7 H.A end
 -2 1230
a -2 1230 a
SDict begin [/View [/XYZ H.V]/Dest (0:112) cvn /DEST pdfmark end
 -2 1230 a 396 1311 a Fg(<?php)396 1408 y(/)441
1421 y(*)441 1518 y(*)576 1505 y(Hello)44 b(World)g(client)441
1615 y(*)576 1602 y(Connects)f(REQ)h(socket)g(to)h
(tcp://localhost:5555)441 1712 y(*)576 1699 y(Sends)f("Hello")f(to)i
(server,)e(expects)h("World")g(back)441 1809 y(*)531
1796 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1907 y(*)486
1894 y(/)396 2088 y($context)g(=)g(new)h(ZMQContext\(\);)396
2282 y(//)90 b(Socket)43 b(to)i(talk)f(to)h(server)396
2379 y(echo)f("Connecting)f(to)i(hello)f(world)g(server...\\n";)396
2476 y($requester)f(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REQ\);)396 2574 y
($requester->connect\("tcp://localhost:5555)o("\);)396
2768 y(for\($request_nbr)g(=)j(0;)g($request_nbr)d(!=)j(10;)f
($request_nbr++\))f({)441 2865 y(printf)h(\("Sending)f(request)h
(\045d...\\n",)f($request_nbr\);)441 2962 y
($requester->send\("Hello"\);)441 3156 y($reply)h(=)h
($requester->recv\(\);)441 3253 y(printf)f(\("Received)f(reply)h
(\045d:)g([\045s]\\n",)g($request_nbr,)f($reply\);)396
3351 y(})-2 3525 y
SDict begin H.S end
 -2 3525 a -2 3525 a
SDict begin 13 H.A end
 -2 3525 a -2 3525
a
SDict begin [/View [/XYZ H.V]/Dest (0:113) cvn /DEST pdfmark end
 -2 3525 a 396 3625 a Fj(No)n(w)20 b(this)f(looks)g(too)g(simple)h(to)
f(be)g(realistic,)h(b)n(ut)f(a)h(\330MQ)g(sock)o(et)f(is)h(what)g(you)e
(get)h(when)g(you)g(tak)o(e)g(a)h(normal)e(TCP)396 3733
y(sock)o(et,)i(inject)g(it)h(with)g(a)f(mix)g(of)g(radioacti)n(v)o(e)e
(isotopes)i(stolen)g(from)f(a)i(secret)f(So)o(viet)g(atomic)g(research)
f(project,)396 3840 y(bombard)f(it)j(with)f(1950-era)e(cosmic)i(rays,)g
(and)g(put)g(it)g(into)g(the)h(hands)e(of)h(a)h(drug-addled)16
b(comic)k(book)f(author)g(with)396 3948 y(a)i(badly-disguised)c(fetish)
k(for)e(b)n(ulging)g(muscles)h(clad)g(in)h(spande)o(x\()p
0 TeXcolorgray 2430 3948 a
SDict begin H.S end
 2430 3948 a Fj(Figure)c(1-2)2777
3948 y
SDict begin 13 H.L end
 2777 3948 a 2777 3948 a
SDict begin [/Subtype /Link/Dest (0:figure-2) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2777 3948 a Black -2 w
Fj(\).)j(Y)-8 b(es,)21 b(\330MQ)f(sock)o(ets)h(are)f(the)396
4056 y(w)o(orld-sa)n(ving)f(superheroes)f(of)i(the)g(netw)o(orking)e(w)
o(orld.)-2 4074 y
SDict begin H.S end
 -2 4074 a -2 4074 a
SDict begin 13 H.A end
 -2 4074 a -2 4074
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-2) cvn /DEST pdfmark end
 -2 4074 a Black 3840 5569 a Fi(6)p Black eop end
%%Page: 7 21
TeXDict begin 7 20 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.7) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fk(Figur)o(e)g(1-2.)f(A)i(terrible)f(accident...)-2
172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:117) cvn /DEST pdfmark end
 -2 172 a 396
2381 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2381 a @beginspecial 0 @llx -260 @lly 423
@urx 0 @ury 4230 @rwi @setspecial
%%BeginDocument: images/fig2.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -260 423 0
%%HiResBoundingBox: 0.0 -260.0 423.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -34.70027160644531 moveto
24.70026969909668 -86.70027160644531 lineto
141.7002716064453 -86.70027160644531 lineto
141.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
222.7002716064453 -34.70027160644531 moveto
222.7002716064453 -86.70027160644531 lineto
339.70025634765625 -86.70027160644531 lineto
339.70025634765625 -34.70027160644531 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -32.0 moveto
22.0 -84.0 lineto
139.0 -84.0 lineto
139.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
22.0 -32.0 moveto
22.0 -84.0 lineto
139.0 -84.0 lineto
139.0 -32.0 lineto
closepath
stroke
0.7529411764705882 0.0 0.0 setrgbcolor
newpath
220.0 -32.0 moveto
220.0 -84.0 lineto
337.0 -84.0 lineto
337.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
220.0 -32.0 moveto
220.0 -84.0 lineto
337.0 -84.0 lineto
337.0 -32.0 lineto
closepath
stroke
newpath
40.0 -97.0 moveto
40.0 -156.0 lineto
stroke
newpath
85.0 -97.0 moveto
85.0 -149.0 lineto
184.0 -149.0 lineto
184.0 -221.0 lineto
stroke
newpath
130.0 -97.0 moveto
130.0 -123.0 lineto
220.0 -123.0 lineto
220.0 -195.0 lineto
stroke
newpath
139.0 -58.0 moveto
211.0 -58.0 lineto
stroke
newpath
207.0 -52.0 moveto
216.0 -58.0 lineto
207.0 -65.0 lineto
closepath
fill
newpath
40.0 -91.0 moveto
36.0 -104.0 lineto
45.0 -104.0 lineto
closepath
fill
newpath
85.0 -91.0 moveto
81.0 -104.0 lineto
90.0 -104.0 lineto
closepath
fill
newpath
130.0 -91.0 moveto
126.0 -104.0 lineto
135.0 -104.0 lineto
closepath
fill
/Helvetica findfont
14 scalefont setfont
351.0 -51.0 moveto
(Zap!) show
37.0 -64.0 moveto
(TCP socket) show
236.0 -64.0 moveto
(0MQ socket) show
157.0 -76.0 moveto
(BOOM!) show
360.0 -76.0 moveto
(POW!!) show
27.0 -168.0 moveto
(Illegal) show
27.0 -181.0 moveto
(radioisotopes) show
27.0 -194.0 moveto
(from secret) show
27.0 -207.0 moveto
(Soviet atomic) show
27.0 -220.0 moveto
(city) show
199.0 -206.0 moveto
(Spandex) show
145.0 -233.0 moveto
(Cosmic rays) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2381 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2381 a 274 x Fj(Y)-9 b(ou)20
b(could)f(thro)n(w)g(thousands)g(of)h(clients)h(at)f(this)h(serv)o(er)m
(,)e(all)i(at)f(once,)g(and)f(it)i(w)o(ould)f(continue)e(to)j(w)o(ork)e
(happily)396 2762 y(and)h(quickly)-5 b(.)18 b(F)o(or)i(fun,)f(try)h
(starting)g(the)g(client)g(and)g Fi(then)g Fj(starting)g(the)g(serv)o
(er)m(,)e(see)j(ho)n(w)f(it)h(all)g(still)g(w)o(orks,)f(then)396
2870 y(think)g(for)f(a)i(second)e(what)h(this)h(means.)-2
3037 y
SDict begin H.S end
 -2 3037 a -2 3037 a
SDict begin 13 H.A end
 -2 3037 a -2 3037 a
SDict begin [/View [/XYZ H.V]/Dest (0:122) cvn /DEST pdfmark end
 -2 3037
a 396 3144 a Fj(Let)g(us)f(e)o(xplain)f(brie\003y)h(what)g(these)g(tw)o
(o)h(programs)d(are)i(actually)g(doing.)e(The)o(y)h(create)h(a)h
(\330MQ)f(conte)o(xt)f(to)i(w)o(ork)396 3252 y(with,)f(and)g(a)h(sock)o
(et.)e(Don')o(t)g(w)o(orry)h(what)g(the)g(w)o(ords)g(mean.)f(Y)-9
b(ou')o(ll)20 b(pick)f(it)i(up.)f(The)g(serv)o(er)f(binds)h(its)h(REP)g
(\(reply\))396 3360 y(sock)o(et)f(to)h(port)e(5555.)g(The)h(serv)o(er)f
(w)o(aits)i(for)f(a)g(request,)g(in)g(a)g(loop,)g(and)f(responds)g
(each)h(time)g(with)h(a)f(reply)-5 b(.)19 b(The)396 3468
y(client)h(sends)h(a)f(request)g(and)f(reads)h(the)h(reply)e(back)g
(from)h(the)g(serv)o(er)-5 b(.)-2 3652 y
SDict begin H.S end
 -2 3652 a -2
3652 a
SDict begin 13 H.A end
 -2 3652 a -2 3652 a
SDict begin [/View [/XYZ H.V]/Dest (0:123) cvn /DEST pdfmark end
 -2 3652 a 396 3742 a Fj(If)20
b(you)g(kill)g(the)g(serv)o(er)g(\(Ctrl-C\))g(and)g(restart)g(it,)g
(the)h(client)f(w)o(on')o(t)f(reco)o(v)o(er)f(properly)-5
b(.)18 b(Reco)o(v)o(ering)g(from)h(crashing)396 3850
y(processes)h(isn')o(t)g(quite)g(that)g(easy)-5 b(.)20
b(Making)f(a)h(reliable)g(request-reply)e(\003o)n(w)i(is)h(comple)o(x)e
(enough)f(that)i(we)h(w)o(on')o(t)396 3958 y(co)o(v)o(er)e(it)i(until)f
(Reliable)g(Request-Reply)g(P)o(atterns)p 0 TeXcolorgray
1918 3958 a
SDict begin H.S end
 1918 3958 a Fj(Chapter)e(4)2242 3958 y
SDict begin 13 H.L end
 2242
3958 a 2242 3958 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2242 3958 a Black Fj(.)-2 4142 y
SDict begin H.S end
 -2
4142 a -2 4142 a
SDict begin 13 H.A end
 -2 4142 a -2 4142 a
SDict begin [/View [/XYZ H.V]/Dest (0:125) cvn /DEST pdfmark end
 -2 4142 a 396 4232
a Fj(There)i(is)h(a)f(lot)h(happening)c(behind)i(the)h(scenes)h(b)n(ut)
f(what)g(matters)g(to)h(us)f(programmers)e(is)j(ho)n(w)e(short)h(and)g
(sweet)396 4340 y(the)g(code)g(is,)h(and)e(ho)n(w)h(often)g(it)g
(doesn')o(t)f(crash,)h(e)n(v)o(en)f(under)g(hea)n(vy)g(load.)h(This)g
(is)h(the)f(request-reply)e(pattern,)396 4448 y(probably)g(the)i
(simplest)h(w)o(ay)f(to)g(use)h(\330MQ.)f(It)h(maps)f(to)g(RPC)i(and)d
(the)h(classic)i(client-serv)o(er)c(model.)-2 4476 y
SDict begin H.S end

-2 4476 a -2 4476 a
SDict begin 13 H.A end
 -2 4476 a -2 4476 a
SDict begin [/View [/XYZ H.V]/Dest (0:126) cvn /DEST pdfmark end
 -2 4476 a 359
x Fh(1.5.)39 b(A)g(Minor)g(Note)f(on)i(Strings)1921 4835
y
SDict begin H.S end
 1921 4835 a 1921 4835 a
SDict begin 22.464 H.A end
 1921 4835 a 1921 4835 a
SDict begin [/View [/XYZ H.V]/Dest (6.10.1) cvn /DEST pdfmark end
 1921
4835 a -2 5033 a
SDict begin H.S end
 -2 5033 a -2 5033 a
SDict begin 13 H.A end
 -2 5033 a -2 5033
a
SDict begin [/View [/XYZ H.V]/Dest (0:128) cvn /DEST pdfmark end
 -2 5033 a 396 5109 a Fj(\330MQ)21 b(doesn')o(t)d(kno)n(w)i(an)o
(ything)e(about)h(the)h(data)g(you)f(send)h(e)o(xcept)g(its)h(size)g
(in)f(bytes.)g(That)g(means)g(you)f(are)p Black 3839
5569 a Fi(7)p Black eop end
%%Page: 8 22
TeXDict begin 8 21 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.8) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fj(responsible)f(for)h(formatting)e(it)j(safely)f(so)g(that)h
(applications)e(can)h(read)f(it)i(back.)f(Doing)f(this)i(for)e(objects)
h(and)396 180 y(comple)o(x)f(data)h(types)g(is)h(a)g(job)e(for)h
(specialized)g(libraries)f(lik)o(e)i(Protocol)e(Buf)n(fers.)g(But)i(e)n
(v)o(en)e(for)h(strings)g(you)f(need)396 288 y(to)i(tak)o(e)f(care.)-2
455 y
SDict begin H.S end
 -2 455 a -2 455 a
SDict begin 13 H.A end
 -2 455 a -2 455 a
SDict begin [/View [/XYZ H.V]/Dest (0:129) cvn /DEST pdfmark end
 -2 455 a 396
562 a Fj(In)g(C)h(and)f(some)g(other)f(languages,)g(strings)h(are)g
(terminated)f(with)h(a)h(null)f(byte.)f(W)-7 b(e)22 b(could)d(send)h(a)
g(string)g(lik)o(e)396 670 y("HELLO")g(with)g(that)g(e)o(xtra)g(null)g
(byte:)-2 771 y
SDict begin H.S end
 -2 771 a -2 771 a
SDict begin 11.7 H.A end
 -2 771 a -2 771 a
SDict begin [/View [/XYZ H.V]/Dest (0:130) cvn /DEST pdfmark end
 -2
771 a 396 850 a Fg(zmq-msg-init-data)42 b(\(&request,)h("Hello",)h(6,)g
(NULL,)g(NULL\);)-2 1028 y
SDict begin H.S end
 -2 1028 a -2 1028 a
SDict begin 13 H.A end
 -2 1028
a -2 1028 a
SDict begin [/View [/XYZ H.V]/Dest (0:131) cvn /DEST pdfmark end
 -2 1028 a 396 1124 a Fj(Ho)n(we)n(v)o(er)19
b(if)h(you)g(send)g(a)g(string)g(from)f(another)g(language)f(it)j
(probably)d(will)j(not)f(include)f(that)h(null)g(byte.)g(F)o(or)396
1232 y(e)o(xample,)f(when)g(we)i(send)f(that)g(same)h(string)e(in)i
(Python,)e(we)h(do)g(this:)-2 1333 y
SDict begin H.S end
 -2 1333 a -2 1333
a
SDict begin 11.7 H.A end
 -2 1333 a -2 1333 a
SDict begin [/View [/XYZ H.V]/Dest (0:132) cvn /DEST pdfmark end
 -2 1333 a 396 1412 a Fg(socket.send)43
b(\("Hello"\))-2 1587 y
SDict begin H.S end
 -2 1587 a -2 1587 a
SDict begin 13 H.A end
 -2 1587 a
-2 1587 a
SDict begin [/View [/XYZ H.V]/Dest (0:133) cvn /DEST pdfmark end
 -2 1587 a 396 1686 a Fj(Then)20 b(what)g(goes)g(onto)f(the)h
(wire)h(is)g(a)f(length)g(\(one)f(byte)h(for)f(shorter)g(strings\))h
(and)g(the)g(string)g(contents,)f(as)396 1794 y(indi)n(vidual)g
(characters\()p 0 TeXcolorgray 1118 1794 a
SDict begin H.S end
 1118 1794
a Fj(Figure)e(1-3)1465 1794 y
SDict begin 13 H.L end
 1465 1794 a 1465 1794 a
SDict begin [/Subtype /Link/Dest (0:figure-3) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

1465 1794 a Black -1 w Fj(\).)-2 1812 y
SDict begin H.S end
 -2 1812 a -2
1812 a
SDict begin 13 H.A end
 -2 1812 a -2 1812 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-3) cvn /DEST pdfmark end
 -2 1812 a 396 1996 a Fk(Figur)o(e)j(1-3.)f
(A)i(\330MQ)f(string)-2 2096 y
SDict begin H.S end
 -2 2096 a -2 2096 a
SDict begin 13 H.A end
 -2
2096 a -2 2096 a
SDict begin [/View [/XYZ H.V]/Dest (0:137) cvn /DEST pdfmark end
 -2 2096 a 396 2895 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2895 a @beginspecial
0 @llx -91 @lly 414 @urx 0 @ury 4140 @rwi @setspecial
%%BeginDocument: images/fig3.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -91 414 0
%%HiResBoundingBox: 0.0 -91.0 414.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -34.70027160644531 moveto
24.70026969909668 -60.70027160644531 lineto
78.70027160644531 -60.70027160644531 lineto
78.70027160644531 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
123.70027160644531 -34.70027160644531 moveto
123.70027160644531 -60.70027160644531 lineto
175.7002716064453 -60.70027160644531 lineto
175.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
178.7002716064453 -34.70027160644531 moveto
178.7002716064453 -60.70027160644531 lineto
229.7002716064453 -60.70027160644531 lineto
229.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
232.7002716064453 -34.70027160644531 moveto
232.7002716064453 -60.70027160644531 lineto
283.70025634765625 -60.70027160644531 lineto
283.70025634765625 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
286.70025634765625 -34.70027160644531 moveto
286.70025634765625 -60.70027160644531 lineto
337.70025634765625 -60.70027160644531 lineto
337.70025634765625 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
340.70025634765625 -34.70027160644531 moveto
340.70025634765625 -60.70027160644531 lineto
393.70025634765625 -60.70027160644531 lineto
393.70025634765625 -34.70027160644531 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -32.0 moveto
22.0 -58.0 lineto
76.0 -58.0 lineto
76.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
22.0 -32.0 moveto
22.0 -58.0 lineto
76.0 -58.0 lineto
76.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
121.0 -32.0 moveto
121.0 -58.0 lineto
173.0 -58.0 lineto
173.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
121.0 -32.0 moveto
121.0 -58.0 lineto
173.0 -58.0 lineto
173.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
176.0 -32.0 moveto
176.0 -58.0 lineto
227.0 -58.0 lineto
227.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
176.0 -32.0 moveto
176.0 -58.0 lineto
227.0 -58.0 lineto
227.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
230.0 -32.0 moveto
230.0 -58.0 lineto
281.0 -58.0 lineto
281.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
230.0 -32.0 moveto
230.0 -58.0 lineto
281.0 -58.0 lineto
281.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
284.0 -32.0 moveto
284.0 -58.0 lineto
335.0 -58.0 lineto
335.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
284.0 -32.0 moveto
284.0 -58.0 lineto
335.0 -58.0 lineto
335.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
338.0 -32.0 moveto
338.0 -58.0 lineto
391.0 -58.0 lineto
391.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
338.0 -32.0 moveto
338.0 -58.0 lineto
391.0 -58.0 lineto
391.0 -32.0 lineto
closepath
stroke
/Helvetica findfont
14 scalefont setfont
47.0 -51.0 moveto
(5 ) show
145.0 -51.0 moveto
(H ) show
200.0 -51.0 moveto
(e ) show
257.0 -51.0 moveto
(l ) show
311.0 -51.0 moveto
(l ) show
362.0 -51.0 moveto
(o ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2895 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2895 a -2 3061 a
SDict begin H.S end
 -2 3061
a -2 3061 a
SDict begin 13 H.A end
 -2 3061 a -2 3061 a
SDict begin [/View [/XYZ H.V]/Dest (0:140) cvn /DEST pdfmark end
 -2 3061 a 396 3169 a
Fj(And)g(if)g(you)g(read)f(this)i(from)e(a)i(C)g(program,)d(you)h(will)
i(get)f(something)f(that)h(looks)g(lik)o(e)g(a)h(string,)f(and)f(might)
h(by)396 3277 y(accident)g(act)g(lik)o(e)h(a)f(string)g(\(if)g(by)g
(luck)g(the)g(\002)n(v)o(e)g(bytes)g(\002nd)g(themselv)o(es)f(follo)n
(wed)g(by)h(an)g(innocently)e(lurking)396 3385 y(null\),)i(b)n(ut)g
(isn')o(t)g(a)g(proper)f(string.)g(When)h(your)f(client)i(and)e(serv)o
(er)h(don')o(t)e(agree)i(on)f(the)i(string)e(format,)g(you)h(will)g
(get)396 3493 y(weird)g(results.)-2 3660 y
SDict begin H.S end
 -2 3660 a
-2 3660 a
SDict begin 13 H.A end
 -2 3660 a -2 3660 a
SDict begin [/View [/XYZ H.V]/Dest (0:141) cvn /DEST pdfmark end
 -2 3660 a 396 3767 a Fj(When)g(you)g
(recei)n(v)o(e)f(string)h(data)g(from)f(\330MQ,)h(in)g(C,)h(you)e
(simply)h(cannot)f(trust)i(that)f(it')-5 b(s)21 b(safely)f(terminated.)
f(Ev)o(ery)396 3875 y(single)h(time)h(you)e(read)h(a)g(string)g(you)f
(should)h(allocate)g(a)g(ne)n(w)g(b)n(uf)n(fer)f(with)h(space)h(for)e
(an)h(e)o(xtra)g(byte,)f(cop)o(y)g(the)396 3983 y(string,)h(and)g
(terminate)f(it)i(properly)d(with)i(a)h(null.)-2 4167
y
SDict begin H.S end
 -2 4167 a -2 4167 a
SDict begin 13 H.A end
 -2 4167 a -2 4167 a
SDict begin [/View [/XYZ H.V]/Dest (0:142) cvn /DEST pdfmark end
 -2 4167 a 396
4257 a Fj(So)g(let')-5 b(s)21 b(establish)f(the)g(rule)g(that)1393
4257 y
SDict begin H.S end
 1393 4257 a 1393 4257 a
SDict begin 13 H.A end
 1393 4257 a 1393 4257
a
SDict begin [/View [/XYZ H.V]/Dest (0:143) cvn /DEST pdfmark end
 1393 4257 a Fk(\330MQ)g(strings)g(ar)o(e)g(length-speci\002ed,)g(and)
h(ar)o(e)e(sent)i(on)f(the)h(wir)o(e)3480 4257 y
SDict begin H.S end
 3480
4257 a 3480 4257 a
SDict begin 13 H.A end
 3480 4257 a 3480 4257 a
SDict begin [/View [/XYZ H.V]/Dest (0:144) cvn /DEST pdfmark end
 3480 4257
a Ff(without)g Fk(a)396 4365 y(trailing)f(null)p Fj(.)h(In)f(the)g
(simplest)h(case)f(\(and)g(we')o(ll)g(do)g(this)h(in)f(our)f(e)o
(xamples\))g(a)i(\330MQ)f(string)g(maps)g(neatly)g(to)g(a)396
4473 y(\330MQ)h(message)f(frame,)f(which)h(looks)f(lik)o(e)i(the)f(abo)
o(v)o(e)e(\002gure,)i(a)g(length)f(and)h(some)g(bytes.)-2
4657 y
SDict begin H.S end
 -2 4657 a -2 4657 a
SDict begin 13 H.A end
 -2 4657 a -2 4657 a
SDict begin [/View [/XYZ H.V]/Dest (0:145) cvn /DEST pdfmark end
 -2 4657
a 396 4747 a Fj(Here)g(is)h(what)g(we)f(need)g(to)g(do,)g(in)g(C,)h(to)
f(recei)n(v)o(e)f(a)i(\330MQ)f(string)g(and)g(deli)n(v)o(er)f(it)i(to)f
(the)g(application)f(as)i(a)f(v)n(alid)g(C)396 4855 y(string:)-2
4956 y
SDict begin H.S end
 -2 4956 a -2 4956 a
SDict begin 11.7 H.A end
 -2 4956 a -2 4956 a
SDict begin [/View [/XYZ H.V]/Dest (0:146) cvn /DEST pdfmark end
 -2 4956
a 396 5035 a Fg(//)90 b(Receive)43 b(0MQ)i(string)e(from)i(socket)e
(and)i(convert)e(into)i(C)f(string)396 5132 y(static)g(char)934
5145 y(*)p Black 3842 5569 a Fi(8)p Black eop end
%%Page: 9 23
TeXDict begin 9 22 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.9) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fg(s-recv)44 b(\(void)979 85 y(*)1024 72 y(socket\))g({)576
170 y(zmq-msg-t)f(message;)576 267 y(zmq-msg-init)f(\(&message\);)576
364 y(int)i(size)g(=)h(zmq-msg-recv)e(\(&message,)g(socket,)g(0\);)576
461 y(if)h(\(size)g(==)h(-1\))755 558 y(return)f(NULL;)576
655 y(char)800 668 y(*)845 655 y(string)f(=)i(malloc)f(\(size)g(+)h
(1\);)576 752 y(memcpy)e(\(string,)h(zmq-msg-data)f(\(&message\),)g
(size\);)576 850 y(zmq-msg-close)f(\(&message\);)576
947 y(string)h([size])h(=)h(0;)576 1044 y(return)e(\(string\);)396
1141 y(})-2 1315 y
SDict begin H.S end
 -2 1315 a -2 1315 a
SDict begin 13 H.A end
 -2 1315 a -2 1315
a
SDict begin [/View [/XYZ H.V]/Dest (0:147) cvn /DEST pdfmark end
 -2 1315 a 396 1415 a Fj(This)21 b(mak)o(es)f(a)g(v)o(ery)f(handy)g
(helper)g(function)g(and)g(in)i(the)f(spirit)g(of)g(making)f(things)h
(we)g(can)g(reuse)g(pro\002tably)-5 b(,)18 b(let')-5
b(s)396 1523 y(write)21 b(a)f(similar)h(')-5 b(s-send')19
b(function)g(that)h(sends)g(strings)g(in)h(the)f(correct)f(\330MQ)i
(format,)d(and)i(package)f(this)i(into)e(a)396 1631 y(header)g(\002le)i
(we)g(can)f(reuse.)-2 1798 y
SDict begin H.S end
 -2 1798 a -2 1798 a
SDict begin 13 H.A end
 -2 1798
a -2 1798 a
SDict begin [/View [/XYZ H.V]/Dest (0:148) cvn /DEST pdfmark end
 -2 1798 a 396 1905 a Fj(The)g(result)g(is)827
1905 y
SDict begin H.S end
 827 1905 a 827 1905 a
SDict begin 13 H.A end
 827 1905 a 827 1905 a
SDict begin [/View [/XYZ H.V]/Dest (0:149) cvn /DEST pdfmark end
 827
1905 a Fg(zhelpers.h)p Fj(,)f(which)h(lets)h(us)g(write)f(sweeter)g
(and)g(shorter)f(\330MQ)i(applications)e(in)h(C.)h(It)f(is)h(a)g(f)o
(airly)396 2013 y(long)f(source,)f(and)g(only)h(fun)f(for)h(C)h(de)n(v)
o(elopers,)d(so)1949 2013 y
SDict begin H.S end
 1949 2013 a 1949 2013 a
SDict begin 13 H.A end
 1949
2013 a 1949 2013 a
SDict begin [/View [/XYZ H.V]/Dest (0:150) cvn /DEST pdfmark end
 1949 2013 a Fj(read)i(it)h(at)g(leisure)396
2121 y(\(https://github)m(.com/imatix/zguide/blo)o(b/m)o(aster/e)o(x)o
(amp)o(les/C/zhelper)o(s.h\))o(.)-2 2149 y
SDict begin H.S end
 -2 2149 a
-2 2149 a
SDict begin 13 H.A end
 -2 2149 a -2 2149 a
SDict begin [/View [/XYZ H.V]/Dest (0:151) cvn /DEST pdfmark end
 -2 2149 a 359 x Fh(1.6.)39
b(V)-7 b(er)n(sion)38 b(Repor)s(ting)1517 2508 y
SDict begin H.S end
 1517
2508 a 1517 2508 a
SDict begin 22.464 H.A end
 1517 2508 a 1517 2508 a
SDict begin [/View [/XYZ H.V]/Dest (6.11.1) cvn /DEST pdfmark end
 1517 2508
a -2 2706 a
SDict begin H.S end
 -2 2706 a -2 2706 a
SDict begin 13 H.A end
 -2 2706 a -2 2706 a
SDict begin [/View [/XYZ H.V]/Dest (0:153) cvn /DEST pdfmark end
 -2
2706 a 396 2782 a Fj(\330MQ)21 b(does)f(come)f(in)i(se)n(v)o(eral)e(v)o
(ersions)g(and)h(quite)g(often,)f(if)h(you)g(hit)g(a)h(problem,)d(it')o
(ll)j(be)f(something)f(that')-5 b(s)20 b(been)396 2890
y(\002x)o(ed)g(in)g(a)h(later)f(v)o(ersion.)f(So)h(it')-5
b(s)21 b(a)g(useful)f(trick)g(to)g(kno)n(w)2151 2890
y
SDict begin H.S end
 2151 2890 a 2151 2890 a
SDict begin 13 H.A end
 2151 2890 a 2151 2890 a
SDict begin [/View [/XYZ H.V]/Dest (0:154) cvn /DEST pdfmark end
 2151
2890 a Fi(e)n(xactly)g Fj(what)h(v)o(ersion)d(of)i(\330MQ)h(you')l(re)d
(actually)396 2998 y(linking)h(with.)h(Here)g(is)i(a)e(tin)o(y)g
(program)e(that)i(does)g(that:)-2 3016 y
SDict begin H.S end
 -2 3016 a -2
3016 a
SDict begin 13 H.A end
 -2 3016 a -2 3016 a
SDict begin [/View [/XYZ H.V]/Dest (0:version-php) cvn /DEST pdfmark
end
 -2 3016 a 396 3199 a Fk(Example)h(1-5.)e
(\330MQ)h(v)o(ersion)g(r)o(eporting)f(\(v)o(ersion.php\))-2
3299 y
SDict begin H.S end
 -2 3299 a -2 3299 a
SDict begin 11.7 H.A end
 -2 3299 a -2 3299 a
SDict begin [/View [/XYZ H.V]/Dest (0:157) cvn /DEST pdfmark end
 -2 3299
a 396 3379 a Fg(<?php)396 3477 y(/)441 3490 y(*)531 3477
y(Report)44 b(0MQ)g(version)441 3587 y(*)441 3684 y(*)531
3671 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 3781 y(*)486
3768 y(/)396 3962 y(if\(class_exists\("ZMQ"\))d(&&)k
(defined\("ZMQ::LIBZMQ_VER"\)\))40 b({)441 4059 y(echo)k
(ZMQ::LIBZMQ_VER,)e(PHP_EOL;)-2 4152 y
SDict begin H.S end
 -2 4152 a -2 4152
a
SDict begin 13 H.A end
 -2 4152 a -2 4152 a
SDict begin [/View [/XYZ H.V]/Dest (0:158) cvn /DEST pdfmark end
 -2 4152 a 368 x Fh(1.7.)d(Getting)f(the)h(Messa)o
(g)q(e)f(Out)1968 4520 y
SDict begin H.S end
 1968 4520 a 1968 4520 a
SDict begin 22.464 H.A end
 1968
4520 a 1968 4520 a
SDict begin [/View [/XYZ H.V]/Dest (6.12.1) cvn /DEST pdfmark end
 1968 4520 a -2 4717 a
SDict begin H.S end
 -2 4717 a -2
4717 a
SDict begin 13 H.A end
 -2 4717 a -2 4717 a
SDict begin [/View [/XYZ H.V]/Dest (0:160) cvn /DEST pdfmark end
 -2 4717 a 396 4794 a Fj(The)20
b(second)f(classic)j(pattern)d(is)i(one-w)o(ay)e(data)h(distrib)n
(ution,)f(in)h(which)g(a)g(serv)o(er)f(pushes)h(updates)g(to)g(a)h(set)
g(of)396 4901 y(clients.)g(Let')-5 b(s)20 b(see)h(an)f(e)o(xample)f
(that)h(pushes)g(out)g(weather)f(updates)h(consisting)f(of)h(a)h(zip)f
(code,)f(temperature,)f(and)396 5009 y(relati)n(v)o(e)i(humidity)-5
b(.)18 b(W)-7 b(e')o(ll)21 b(generate)e(random)f(v)n(alues,)i(just)h
(lik)o(e)f(the)g(real)g(weather)g(stations)g(do.)p Black
3842 5569 a Fi(9)p Black eop end
%%Page: 10 24
TeXDict begin 10 23 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.10) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:172) cvn /DEST pdfmark end
 -2 -201 a 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:161) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Here')-5 b(s)21 b(the)f(serv)o(er)-5
b(.)19 b(W)-7 b(e')o(ll)22 b(use)e(port)g(5556)e(for)i(this)h
(application:)-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:wuserver-php) cvn /DEST pdfmark
end

-2 90 a 396 274 a Fk(Example)g(1-6.)e(W)-5 b(eather)19
b(update)h(ser)o(v)o(er)h(\(wuser)o(v)o(er)-8 b(.php\))-2
374 y
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 11.7 H.A end
 -2 374 a -2 374 a
SDict begin [/View [/XYZ H.V]/Dest (0:164) cvn /DEST pdfmark end
 -2 374 a 396
454 a Fg(<?php)396 551 y(/)441 564 y(*)441 661 y(*)576
648 y(Weather)43 b(update)h(server)441 758 y(*)576 745
y(Binds)g(PUB)g(socket)g(to)g(tcp://)1742 758 y(*)1787
745 y(:5556)441 856 y(*)576 843 y(Publishes)f(random)h(weather)f
(updates)441 953 y(*)531 940 y(@author)g(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1050 y(*)486
1037 y(/)396 1231 y(//)90 b(Prepare)43 b(our)i(context)e(and)i
(publisher)396 1328 y($context)f(=)g(new)h(ZMQContext\(\);)396
1425 y($publisher)e(=)i($context->getSocket\(ZMQ::SOCKET_PUB\);)396
1522 y($publisher->bind\("tcp://)1476 1535 y(*)1521 1522
y(:5556"\);)396 1620 y($publisher->bind\("ipc://weather.ipc"\);)396
1814 y(while)f(\(true\))g({)441 1911 y(//)89 b(Get)45
b(values)f(that)g(will)g(fool)g(the)g(boss)441 2008 y($zipcode)223
b(=)45 b(mt_rand\(0,)e(100000\);)441 2105 y($temperature)g(=)i
(mt_rand\(-80,)d(135\);)441 2202 y($relhumidity)h(=)i(mt_rand\(10,)e
(60\);)441 2397 y(//)89 b(Send)45 b(message)e(to)i(all)f(subscribers)
441 2494 y($update)g(=)g(sprintf)g(\("\04505d)g(\045d)g(\045d",)h
($zipcode,)e($temperature,)g($relhumidity\);)441 2591
y($publisher->send\($update\);)396 2688 y(})-2 2862 y
SDict begin H.S end

-2 2862 a -2 2862 a
SDict begin 13 H.A end
 -2 2862 a -2 2862 a
SDict begin [/View [/XYZ H.V]/Dest (0:165) cvn /DEST pdfmark end
 -2 2862 a 396
2962 a Fj(There')-5 b(s)20 b(no)g(start,)g(and)g(no)g(end)f(to)i(this)f
(stream)g(of)g(updates,)g(it')-5 b(s)21 b(lik)o(e)f(a)h(ne)n(v)o(er)e
(ending)f(broadcast\()p 0 TeXcolorgray 3313 2962 a
SDict begin H.S end
 3313
2962 a Fj(Figure)g(1-4)3661 2962 y
SDict begin 13 H.L end
 3661 2962 a 3661 2962
a
SDict begin [/Subtype /Link/Dest (0:figure-4) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3661 2962 a Black -2 w Fj(\).)-2 2980 y
SDict begin H.S end
 -2 2980 a -2
2980 a
SDict begin 13 H.A end
 -2 2980 a -2 2980 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-4) cvn /DEST pdfmark end
 -2 2980 a Black 3800 5569
a Fi(10)p Black eop end
%%Page: 11 25
TeXDict begin 11 24 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.11) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fk(Figur)o(e)g(1-4.)f(Publish-Subscribe)-2 172
y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:169) cvn /DEST pdfmark end
 -2 172 a 396 3214
a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3214 a @beginspecial 0 @llx -360 @lly 400 @urx
0 @ury 4000 @rwi @setspecial
%%BeginDocument: images/fig4.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -360 400 0
%%HiResBoundingBox: 0.0 -360.0 400.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -32.40024185180664 moveto
142.40023803710938 -78.40023803710938 lineto
254.40023803710938 -78.40023803710938 lineto
254.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -81.40023803710938 moveto
142.40023803710938 -98.40023803710938 lineto
142.40023803710938 -102.40023803710938 143.73357137044272 -104.40023803710938 146.40023803710938 -104.40023803710938 curveto
250.40023803710938 -104.40023803710938 lineto
250.40023803710938 -104.40023803710938 lineto
253.06690470377603 -104.40023803710938 254.40023803710938 -102.40023803710938 254.40023803710938 -98.40023803710938 curveto
254.40023803710938 -82.00023651123047 lineto
254.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -260.4002380371094 moveto
23.73357327779134 -260.4002380371094 22.400239944458008 -262.4002380371094 22.400239944458008 -266.4002380371094 curveto
22.400239944458008 -282.4002380371094 lineto
126.40023803710938 -282.4002380371094 lineto
126.40023803710938 -266.4002380371094 lineto
126.40023803710938 -262.4002380371094 125.06690470377605 -260.4002380371094 122.40023803710938 -260.4002380371094 curveto
26.400239944458008 -260.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -285.4002380371094 moveto
22.400239944458008 -332.4002380371094 lineto
126.40023803710938 -332.4002380371094 lineto
126.40023803710938 -285.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -260.4002380371094 moveto
151.73357137044272 -260.4002380371094 150.40023803710938 -262.4002380371094 150.40023803710938 -266.4002380371094 curveto
150.40023803710938 -282.4002380371094 lineto
254.40023803710938 -282.4002380371094 lineto
254.40023803710938 -266.4002380371094 lineto
254.40023803710938 -262.4002380371094 253.06690470377603 -260.4002380371094 250.40023803710938 -260.4002380371094 curveto
154.40023803710938 -260.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -285.4002380371094 moveto
150.40023803710938 -332.4002380371094 lineto
254.40023803710938 -332.4002380371094 lineto
254.40023803710938 -285.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -260.4002380371094 moveto
279.7335713704427 -260.4002380371094 278.4002380371094 -262.4002380371094 278.4002380371094 -266.4002380371094 curveto
278.4002380371094 -282.4002380371094 lineto
382.4002380371094 -282.4002380371094 lineto
382.4002380371094 -266.4002380371094 lineto
382.4002380371094 -262.4002380371094 381.06690470377606 -260.4002380371094 378.4002380371094 -260.4002380371094 curveto
282.4002380371094 -260.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -285.4002380371094 moveto
278.4002380371094 -332.4002380371094 lineto
382.4002380371094 -332.4002380371094 lineto
382.4002380371094 -285.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -30.0 moveto
140.0 -76.0 lineto
252.0 -76.0 lineto
252.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
140.0 -30.0 moveto
140.0 -76.0 lineto
252.0 -76.0 lineto
252.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -79.0 moveto
140.0 -96.0 lineto
140.0 -100.0 141.33333333333334 -102.0 144.0 -102.0 curveto
248.0 -102.0 lineto
248.0 -102.0 lineto
250.66666666666666 -102.0 252.0 -100.0 252.0 -96.0 curveto
252.0 -79.5999984741211 lineto
252.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -79.0 moveto
140.0 -96.0 lineto
140.0 -100.0 141.33333333333334 -102.0 144.0 -102.0 curveto
248.0 -102.0 lineto
248.0 -102.0 lineto
250.66666666666666 -102.0 252.0 -100.0 252.0 -96.0 curveto
252.0 -79.5999984741211 lineto
252.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -258.0 moveto
21.333333333333332 -258.0 20.0 -260.0 20.0 -264.0 curveto
20.0 -280.0 lineto
124.0 -280.0 lineto
124.0 -264.0 lineto
124.0 -260.0 122.66666666666667 -258.0 120.0 -258.0 curveto
24.0 -258.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -258.0 moveto
21.333333333333332 -258.0 20.0 -260.0 20.0 -264.0 curveto
20.0 -280.0 lineto
124.0 -280.0 lineto
124.0 -264.0 lineto
124.0 -260.0 122.66666666666667 -258.0 120.0 -258.0 curveto
24.0 -258.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -283.0 moveto
20.0 -330.0 lineto
124.0 -330.0 lineto
124.0 -283.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -283.0 moveto
20.0 -330.0 lineto
124.0 -330.0 lineto
124.0 -283.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -258.0 moveto
149.33333333333334 -258.0 148.0 -260.0 148.0 -264.0 curveto
148.0 -280.0 lineto
252.0 -280.0 lineto
252.0 -264.0 lineto
252.0 -260.0 250.66666666666666 -258.0 248.0 -258.0 curveto
152.0 -258.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -258.0 moveto
149.33333333333334 -258.0 148.0 -260.0 148.0 -264.0 curveto
148.0 -280.0 lineto
252.0 -280.0 lineto
252.0 -264.0 lineto
252.0 -260.0 250.66666666666666 -258.0 248.0 -258.0 curveto
152.0 -258.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -283.0 moveto
148.0 -330.0 lineto
252.0 -330.0 lineto
252.0 -283.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -283.0 moveto
148.0 -330.0 lineto
252.0 -330.0 lineto
252.0 -283.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -258.0 moveto
277.3333333333333 -258.0 276.0 -260.0 276.0 -264.0 curveto
276.0 -280.0 lineto
380.0 -280.0 lineto
380.0 -264.0 lineto
380.0 -260.0 378.6666666666667 -258.0 376.0 -258.0 curveto
280.0 -258.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -258.0 moveto
277.3333333333333 -258.0 276.0 -260.0 276.0 -264.0 curveto
276.0 -280.0 lineto
380.0 -280.0 lineto
380.0 -264.0 lineto
380.0 -260.0 378.6666666666667 -258.0 376.0 -258.0 curveto
280.0 -258.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -283.0 moveto
276.0 -330.0 lineto
380.0 -330.0 lineto
380.0 -283.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -283.0 moveto
276.0 -330.0 lineto
380.0 -330.0 lineto
380.0 -283.0 lineto
closepath
stroke
newpath
64.0 -228.0 moveto
68.0 -240.0 lineto
72.0 -228.0 lineto
closepath
fill
newpath
192.0 -228.0 moveto
196.0 -240.0 lineto
200.0 -228.0 lineto
closepath
fill
newpath
320.0 -228.0 moveto
324.0 -240.0 lineto
328.0 -228.0 lineto
closepath
fill
newpath
196.0 -126.0 moveto
196.0 -174.0 lineto
stroke
newpath
68.0 -234.0 moveto
68.0 -174.0 lineto
196.0 -174.0 lineto
stroke
newpath
196.0 -234.0 moveto
196.0 -174.0 lineto
stroke
newpath
324.0 -234.0 moveto
324.0 -174.0 lineto
196.0 -174.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
162.0 -59.0 moveto
(Publisher) show
185.0 -94.0 moveto
(PUB) show
177.0 -118.0 moveto
(bind) show
170.0 -154.0 moveto
(updates) show
42.0 -202.0 moveto
(updates) show
170.0 -202.0 moveto
(updates) show
298.0 -202.0 moveto
(updates) show
40.0 -250.0 moveto
(connect) show
168.0 -250.0 moveto
(connect) show
296.0 -250.0 moveto
(connect) show
57.0 -274.0 moveto
(SUB) show
185.0 -274.0 moveto
(SUB) show
313.0 -274.0 moveto
(SUB) show
33.0 -311.0 moveto
(Subscriber) show
161.0 -311.0 moveto
(Subscriber) show
289.0 -311.0 moveto
(Subscriber) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3214 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3214 a 274 x Fj(Here)h(is)h(client)g
(application,)d(which)i(listens)h(to)f(the)g(stream)g(of)g(updates)g
(and)f(grabs)h(an)o(ything)e(to)i(do)g(with)g(a)396 3596
y(speci\002ed)g(zip)g(code,)g(by)f(def)o(ault)h(Ne)n(w)g(Y)-9
b(ork)20 b(City)g(because)g(that')-5 b(s)21 b(a)f(great)g(place)g(to)g
(start)h(an)o(y)e(adv)o(enture:)-2 3614 y
SDict begin H.S end
 -2 3614 a -2
3614 a
SDict begin 13 H.A end
 -2 3614 a -2 3614 a
SDict begin [/View [/XYZ H.V]/Dest (0:wuclient-php) cvn /DEST pdfmark
end
 -2 3614 a 396 3797 a Fk(Example)i(1-7.)e(W)
-5 b(eather)19 b(update)h(client)h(\(wuclient.php\))-2
3897 y
SDict begin H.S end
 -2 3897 a -2 3897 a
SDict begin 11.7 H.A end
 -2 3897 a -2 3897 a
SDict begin [/View [/XYZ H.V]/Dest (0:175) cvn /DEST pdfmark end
 -2 3897
a 396 3977 a Fg(<?php)396 4074 y(/)441 4087 y(*)441 4185
y(*)576 4172 y(Weather)43 b(update)h(client)441 4282
y(*)576 4269 y(Connects)f(SUB)h(socket)g(to)h(tcp://localhost:5556)441
4379 y(*)576 4366 y(Collects)e(weather)h(updates)f(and)i(finds)f(avg)g
(temp)g(in)h(zipcode)441 4476 y(*)531 4463 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4573 y(*)486
4560 y(/)396 4754 y($context)g(=)g(new)h(ZMQContext\(\);)396
4949 y(//)90 b(Socket)43 b(to)i(talk)f(to)h(server)396
5046 y(echo)f("Collecting)f(updates)h(from)g(weather)g(server...",)f
(PHP_EOL;)396 5143 y($subscriber)g(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_SUB\);)p Black 3800 5569 a Fi(11)p Black
eop end
%%Page: 12 26
TeXDict begin 12 25 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.12) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fg($subscriber->connect\("tcp://localhost:555)o(6"\);)396
267 y(//)90 b(Subscribe)43 b(to)h(zipcode,)g(default)g(is)g(NYC,)g
(10001)396 364 y($filter)g(=)h($_SERVER['argc'])d(>)i(1)h(?)g
($_SERVER['argv'][1])c(:)k("10001";)396 461 y
($subscriber->setSockOpt\(ZMQ::SOCKOPT_SUBS)o(CRIBE,)38
b($filter\);)396 655 y(//)90 b(Process)43 b(100)i(updates)396
752 y($total_temp)e(=)i(0;)396 850 y(for)g(\($update_nbr)d(=)j(0;)g
($update_nbr)e(<)h(100;)g($update_nbr++\))f({)441 947
y($string)h(=)g($subscriber->recv\(\);)441 1044 y(sscanf)g(\($string,)f
("\045d)i(\045d)f(\045d",)g($zipcode,)g($temperature,)e
($relhumidity\);)441 1141 y($total_temp)h(+=)i($temperature;)396
1238 y(})396 1335 y(printf)f(\("Average)f(temperature)g(for)i(zipcode)e
('\045s')i(was)f(\045dF\\n",)576 1432 y($filter,)f(\(int\))h
(\($total_temp)f(/)i($update_nbr\)\))-2 1610 y
SDict begin H.S end
 -2 1610
a -2 1610 a
SDict begin 13 H.A end
 -2 1610 a -2 1610 a
SDict begin [/View [/XYZ H.V]/Dest (0:176) cvn /DEST pdfmark end
 -2 1610 a 396 1706 a
Fj(Note)20 b(that)h(when)e(you)h(use)g(a)h(SUB)g(sock)o(et)f(you)1818
1706 y
SDict begin H.S end
 1818 1706 a 1818 1706 a
SDict begin 13 H.A end
 1818 1706 a 1818 1706
a
SDict begin [/View [/XYZ H.V]/Dest (0:177) cvn /DEST pdfmark end
 1818 1706 a Fk(must)h Fj(set)g(a)g(subscription)d(using)2812
1706 y
SDict begin H.S end
 2812 1706 a 2812 1706 a
SDict begin 13 H.A end
 2812 1706 a 2812 1706
a
SDict begin [/View [/XYZ H.V]/Dest (0:178) cvn /DEST pdfmark end
 2812 1706 a Fg(zmq-setsockopt[3])g Fj(and)396 1814
y(SUBSCRIBE,)k(as)f(in)f(this)h(code.)e(If)h(you)f(don')o(t)g(set)i(an)
o(y)e(subscription,)g(you)g(w)o(on')o(t)g(get)h(an)o(y)g(messages.)g
(It')-5 b(s)21 b(a)396 1922 y(common)e(mistak)o(e)h(for)f(be)o
(ginners.)f(The)i(subscriber)f(can)h(set)h(man)o(y)e(subscriptions,)g
(which)h(are)g(added)f(together)-5 b(.)396 2030 y(That)20
b(is,)h(if)g(a)f(update)f(matches)h(ANY)h(subscription,)d(the)i
(subscriber)f(recei)n(v)o(es)h(it.)g(The)g(subscriber)f(can)h(also)h
(cancel)396 2138 y(speci\002c)g(subscriptions.)d(A)j(subscription)e(is)
i(often)e(b)n(ut)h(not)g(necessarily)g(a)g(printable)f(string.)h(See)
396 2246 y
SDict begin H.S end
 396 2246 a 396 2246 a
SDict begin 13 H.A end
 396 2246 a 396 2246
a
SDict begin [/View [/XYZ H.V]/Dest (0:179) cvn /DEST pdfmark end
 396 2246 a Fg(zmq-setsockopt[3])e Fj(for)i(ho)n(w)f(this)i(w)o(orks.)
-2 2424 y
SDict begin H.S end
 -2 2424 a -2 2424 a
SDict begin 13 H.A end
 -2 2424 a -2 2424 a
SDict begin [/View [/XYZ H.V]/Dest (0:180) cvn /DEST pdfmark end
 -2
2424 a 396 2520 a Fj(The)f(PUB-SUB)h(sock)o(et)g(pair)e(is)i
(asynchronous.)d(The)h(client)i(does)2402 2520 y
SDict begin H.S end
 2402
2520 a 2402 2520 a
SDict begin 13 H.A end
 2402 2520 a 2402 2520 a
SDict begin [/View [/XYZ H.V]/Dest (0:181) cvn /DEST pdfmark end
 2402 2520
a Fg(zmq-msg-recv[3])p Fj(,)d(in)i(a)h(loop)e(\(or)g(once)h(if)396
2628 y(that')-5 b(s)21 b(all)g(it)g(needs\).)e(T)m(rying)g(to)h(send)g
(a)h(message)f(to)g(a)h(SUB)g(sock)o(et)f(will)h(cause)f(an)g(error)-5
b(.)19 b(Similarly)h(the)g(service)396 2736 y(does)569
2736 y
SDict begin H.S end
 569 2736 a 569 2736 a
SDict begin 13 H.A end
 569 2736 a 569 2736 a
SDict begin [/View [/XYZ H.V]/Dest (0:182) cvn /DEST pdfmark end
 569
2736 a Fg(zmq-msg-send[3])e Fj(as)j(often)f(as)h(it)g(needs)e(to,)h(b)n
(ut)h(must)f(not)g(do)2554 2736 y
SDict begin H.S end
 2554 2736 a 2554 2736
a
SDict begin 13 H.A end
 2554 2736 a 2554 2736 a
SDict begin [/View [/XYZ H.V]/Dest (0:183) cvn /DEST pdfmark end
 2554 2736 a Fg(zmq-msg-recv[3])f
Fj(on)g(a)i(PUB)g(sock)o(et.)-2 2914 y
SDict begin H.S end
 -2 2914 a -2 2914
a
SDict begin 13 H.A end
 -2 2914 a -2 2914 a
SDict begin [/View [/XYZ H.V]/Dest (0:184) cvn /DEST pdfmark end
 -2 2914 a 396 3010 a Fj(In)f(theory)f(with)h
(\330MQ)h(sock)o(ets,)f(it)h(does)f(not)g(matter)g(which)f(end)h
(connects,)f(and)g(which)h(end)g(binds.)f(Ho)n(we)n(v)o(er)g(in)396
3118 y(practice)h(there)f(are)i(undocumented)16 b(dif)n(ferences)j
(that)h(I')o(ll)g(come)g(to)g(later)-5 b(.)21 b(F)o(or)f(no)n(w)-5
b(,)19 b(bind)g(the)h(PUB)h(and)f(connect)396 3226 y(the)g(SUB,)h
(unless)g(your)e(netw)o(ork)g(design)g(mak)o(es)h(that)h(impossible.)-2
3410 y
SDict begin H.S end
 -2 3410 a -2 3410 a
SDict begin 13 H.A end
 -2 3410 a -2 3410 a
SDict begin [/View [/XYZ H.V]/Dest (0:185) cvn /DEST pdfmark end
 -2 3410
a 396 3500 a Fj(There)f(is)h(one)e(more)h(important)e(thing)i(to)g(kno)
n(w)f(about)h(PUB-SUB)h(sock)o(ets:)f(you)g(do)f(not)h(kno)n(w)f
(precisely)h(when)f(a)396 3608 y(subscriber)g(starts)i(to)f(get)g
(messages.)g(Ev)o(en)e(if)j(you)e(start)h(a)h(subscriber)m(,)d(w)o(ait)
i(a)h(while,)e(and)h(then)f(start)i(the)f(publisher)m(,)396
3715 y
SDict begin H.S end
 396 3715 a 396 3715 a
SDict begin 13 H.A end
 396 3715 a 396 3715 a
SDict begin [/View [/XYZ H.V]/Dest (0:186) cvn /DEST pdfmark end
 396
3715 a Fk(the)h(subscriber)g(will)g(always)f(miss)h(the)g(\002rst)f
(messages)h(that)f(the)g(publisher)i(sends)p Fj(.)f(This)f(is)h
(because)f(as)h(the)396 3823 y(subscriber)e(connects)g(to)i(the)f
(publisher)f(\(something)f(that)i(tak)o(es)h(a)g(small)f(b)n(ut)g
(non-zero)e(time\),)i(the)g(publisher)f(may)396 3931
y(already)g(be)h(sending)g(messages)g(out.)-2 4115 y
SDict begin H.S end

-2 4115 a -2 4115 a
SDict begin 13 H.A end
 -2 4115 a -2 4115 a
SDict begin [/View [/XYZ H.V]/Dest (0:187) cvn /DEST pdfmark end
 -2 4115 a 396
4205 a Fj(This)h("slo)n(w)f(joiner")f(symptom)g(hits)i(enough)d
(people,)h(often)g(enough,)f(that)i(we')l(re)g(going)f(to)h(e)o(xplain)
f(it)i(in)f(detail.)396 4313 y(Remember)f(that)i(\330MQ)f(does)g
(asynchronous)d(I/O,)j(i.e.)h(in)f(the)g(background.)d(Say)j(you)f(ha)n
(v)o(e)h(tw)o(o)g(nodes)g(doing)f(this,)396 4421 y(in)i(this)f(order:)
-2 4422 y
SDict begin H.S end
 -2 4422 a -2 4422 a
SDict begin 13 H.A end
 -2 4422 a -2 4422 a
SDict begin [/View [/XYZ H.V]/Dest (0:188) cvn /DEST pdfmark end
 -2
4422 a -2 4432 a
SDict begin H.S end
 -2 4432 a -2 4432 a
SDict begin 13 H.A end
 -2 4432 a -2 4432
a
SDict begin [/View [/XYZ H.V]/Dest (0:189) cvn /DEST pdfmark end
 -2 4432 a Black 396 4591 a Fe(\225)p Black 479 4591
a
SDict begin H.S end
 479 4591 a 479 4591 a
SDict begin 13 H.A end
 479 4591 a 479 4591 a
SDict begin [/View [/XYZ H.V]/Dest (0:190) cvn /DEST pdfmark end
 479 4591
a Fj(Subscriber)f(connects)g(to)i(an)f(endpoint)e(and)i(recei)n(v)o(es)
f(and)h(counts)f(messages.)-2 4609 y
SDict begin H.S end
 -2 4609 a -2 4609
a
SDict begin 13 H.A end
 -2 4609 a -2 4609 a
SDict begin [/View [/XYZ H.V]/Dest (0:191) cvn /DEST pdfmark end
 -2 4609 a Black 396 4741 a Fe(\225)p
Black 479 4741 a
SDict begin H.S end
 479 4741 a 479 4741 a
SDict begin 13 H.A end
 479 4741 a 479
4741 a
SDict begin [/View [/XYZ H.V]/Dest (0:192) cvn /DEST pdfmark end
 479 4741 a Fj(Publisher)h(binds)f(to)i(an)f(endpoint)e(and)i
(immediately)f(sends)h(1,000)e(messages.)-2 4925 y
SDict begin H.S end
 -2
4925 a -2 4925 a
SDict begin 13 H.A end
 -2 4925 a -2 4925 a
SDict begin [/View [/XYZ H.V]/Dest (0:193) cvn /DEST pdfmark end
 -2 4925 a 396 5015
a Fj(Then)i(the)g(subscriber)f(will)i(most)f(lik)o(ely)g(not)g(recei)n
(v)o(e)f(an)o(ything.)f(Y)-9 b(ou')o(ll)19 b(blink,)h(check)f(that)h
(you)g(set)h(a)f(correct)f(\002lter)m(,)396 5123 y(and)h(try)g(again,)f
(and)g(the)i(subscriber)e(will)i(still)g(not)f(recei)n(v)o(e)f(an)o
(ything.)p Black 3800 5569 a Fi(12)p Black eop end
%%Page: 13 27
TeXDict begin 13 26 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.13) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:194) cvn /DEST pdfmark end
 -2 -11 a
396 72 a Fj(Making)f(a)i(TCP)g(connection)d(in)m(v)n(olv)o(es)h(to)h
(and)g(fro)f(handshaking)f(that)i(tak)o(es)h(se)n(v)o(eral)e
(milliseconds)h(depending)d(on)396 180 y(your)i(netw)o(ork)g(and)h(the)
g(number)e(of)i(hops)g(between)f(peers.)h(In)g(that)g(time,)g(\330MQ)h
(can)f(send)g(v)o(ery)f(man)o(y)g(messages.)396 288 y(F)o(or)h(sak)o(e)
h(of)e(ar)o(gument)f(assume)i(it)h(tak)o(es)g(5)f(msecs)h(to)f
(establish)h(a)f(connection,)e(and)i(that)g(same)g(link)g(can)g(handle)
396 396 y(1M)g(messages)h(per)e(second.)g(During)g(the)i(5)f(msecs)h
(that)f(the)g(subscriber)f(is)i(connecting)d(to)j(the)f(publisher)m(,)e
(it)j(tak)o(es)396 504 y(the)f(publisher)f(only)h(1)g(msec)g(to)h(send)
f(out)f(those)h(1K)h(messages.)-2 688 y
SDict begin H.S end
 -2 688 a -2 688
a
SDict begin 13 H.A end
 -2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:195) cvn /DEST pdfmark end
 -2 688 a 396 778 a Fj(In)f(Sock)o(ets)g(and)g(P)o
(atterns)p 0 TeXcolorgray 1172 778 a
SDict begin H.S end
 1172 778 a Fj(Chapter)f(2)1497
778 y
SDict begin 13 H.L end
 1497 778 a 1497 778 a
SDict begin [/Subtype /Link/Dest (0:sockets-and-patterns) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1497 778 a Black 20 w Fj(we')o(ll)i(e)o
(xplain)e(ho)n(w)g(to)i(synchronize)c(a)k(publisher)e(and)h
(subscribers)f(so)h(that)396 886 y(you)g(don')o(t)e(start)j(to)f
(publish)f(data)h(until)g(the)h(subscriber\(s\))d(really)i(are)g
(connected)e(and)i(ready)-5 b(.)19 b(There)g(is)i(a)g(simple)396
994 y(and)f(stupid)g(w)o(ay)g(to)g(delay)g(the)g(publisher)m(,)e(which)
i(is)h(to)f(sleep.)g(Don')o(t)f(do)h(this)h(in)f(a)h(real)f
(application,)f(though,)396 1102 y(because)h(it)h(is)g(e)o(xtremely)d
(fragile)i(as)h(well)f(as)h(inele)o(gant)e(and)g(slo)n(w)-5
b(.)20 b(Use)h(sleeps)g(to)f(pro)o(v)o(e)e(to)j(yourself)e(what')-5
b(s)396 1210 y(happening,)18 b(and)h(then)h(w)o(ait)h(for)e(Sock)o(ets)
i(and)e(P)o(atterns)p 0 TeXcolorgray 2054 1210 a
SDict begin H.S end
 2054
1210 a Fj(Chapter)g(2)2379 1210 y
SDict begin 13 H.L end
 2379 1210 a 2379 1210
a
SDict begin [/Subtype /Link/Dest (0:sockets-and-patterns) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2379 1210 a Black 20 w Fj(to)i(see)g(ho)n(w)e(to)i(do)e(this)i
(right.)-2 1394 y
SDict begin H.S end
 -2 1394 a -2 1394 a
SDict begin 13 H.A end
 -2 1394 a -2 1394
a
SDict begin [/View [/XYZ H.V]/Dest (0:198) cvn /DEST pdfmark end
 -2 1394 a 396 1484 a Fj(The)f(alternati)n(v)o(e)f(to)h
(synchronization)d(is)22 b(to)e(simply)g(assume)g(that)g(the)g
(published)f(data)h(stream)g(is)h(in\002nite)f(and)g(has)396
1592 y(no)g(start,)h(and)e(no)h(end.)f(One)h(also)h(assumes)f(that)h
(the)f(subscriber)f(doesn')o(t)f(care)i(what)h(transpired)d(before)h
(it)i(started)396 1700 y(up.)f(This)g(is)h(ho)n(w)f(we)g(b)n(uilt)h
(our)e(weather)h(client)g(e)o(xample.)-2 1884 y
SDict begin H.S end
 -2 1884
a -2 1884 a
SDict begin 13 H.A end
 -2 1884 a -2 1884 a
SDict begin [/View [/XYZ H.V]/Dest (0:199) cvn /DEST pdfmark end
 -2 1884 a 396 1974 a
Fj(So)h(the)f(client)g(subscribes)g(to)g(its)h(chosen)f(zip)g(code)f
(and)h(collects)g(a)h(thousand)d(updates)i(for)f(that)i(zip)f(code.)f
(That)396 2082 y(means)h(about)f(ten)i(million)e(updates)h(from)f(the)h
(serv)o(er)m(,)f(if)h(zip)g(codes)g(are)g(randomly)e(distrib)n(uted.)h
(Y)-9 b(ou)20 b(can)g(start)h(the)396 2190 y(client,)f(and)g(then)g
(the)g(serv)o(er)m(,)f(and)g(the)h(client)h(will)g(k)o(eep)e(w)o
(orking.)g(Y)-9 b(ou)19 b(can)h(stop)g(and)g(restart)g(the)g(serv)o(er)
g(as)h(often)396 2297 y(as)g(you)e(lik)o(e,)i(and)e(the)i(client)f
(will)h(k)o(eep)e(w)o(orking.)g(When)h(the)g(client)g(has)h(collected)e
(its)i(thousand)e(updates,)g(it)396 2405 y(calculates)h(the)h(a)n(v)o
(erage,)d(prints)i(it,)h(and)e(e)o(xits.)-2 2589 y
SDict begin H.S end
 -2
2589 a -2 2589 a
SDict begin 13 H.A end
 -2 2589 a -2 2589 a
SDict begin [/View [/XYZ H.V]/Dest (0:200) cvn /DEST pdfmark end
 -2 2589 a 396 2679
a Fj(Some)h(points)g(about)f(the)h(publish-subscribe)e(pattern:)-2
2697 y
SDict begin H.S end
 -2 2697 a -2 2697 a
SDict begin 13 H.A end
 -2 2697 a -2 2697 a
SDict begin [/View [/XYZ H.V]/Dest (0:201) cvn /DEST pdfmark end
 -2 2697
a -2 2707 a
SDict begin H.S end
 -2 2707 a -2 2707 a
SDict begin 13 H.A end
 -2 2707 a -2 2707 a
SDict begin [/View [/XYZ H.V]/Dest (0:202) cvn /DEST pdfmark end
 -2
2707 a Black 396 2850 a Fe(\225)p Black 479 2850 a
SDict begin H.S end
 479
2850 a 479 2850 a
SDict begin 13 H.A end
 479 2850 a 479 2850 a
SDict begin [/View [/XYZ H.V]/Dest (0:203) cvn /DEST pdfmark end
 479 2850 a Fj(A)j(subscriber)e
(can)h(connect)f(to)h(more)g(than)f(one)h(publisher)m(,)e(using)i(one)f
('connect')g(call)h(each)g(time.)g(Data)h(will)479 2957
y(then)f(arri)n(v)o(e)f(and)h(be)g(interlea)n(v)o(ed)f(\("f)o(air)n
(-queued"\))d(so)21 b(that)f(no)g(single)g(publisher)f(dro)n(wns)g(out)
h(the)g(others.)-2 2975 y
SDict begin H.S end
 -2 2975 a -2 2975 a
SDict begin 13 H.A end
 -2 2975
a -2 2975 a
SDict begin [/View [/XYZ H.V]/Dest (0:204) cvn /DEST pdfmark end
 -2 2975 a Black 396 3107 a Fe(\225)p Black
479 3107 a
SDict begin H.S end
 479 3107 a 479 3107 a
SDict begin 13 H.A end
 479 3107 a 479 3107
a
SDict begin [/View [/XYZ H.V]/Dest (0:205) cvn /DEST pdfmark end
 479 3107 a Fj(If)g(a)h(publisher)e(has)h(no)g(connected)e
(subscribers,)h(then)h(it)h(will)g(simply)f(drop)f(all)h(messages.)-2
3125 y
SDict begin H.S end
 -2 3125 a -2 3125 a
SDict begin 13 H.A end
 -2 3125 a -2 3125 a
SDict begin [/View [/XYZ H.V]/Dest (0:206) cvn /DEST pdfmark end
 -2 3125
a Black 396 3256 a Fe(\225)p Black 479 3256 a
SDict begin H.S end
 479 3256
a 479 3256 a
SDict begin 13 H.A end
 479 3256 a 479 3256 a
SDict begin [/View [/XYZ H.V]/Dest (0:207) cvn /DEST pdfmark end
 479 3256 a Fj(If)g(you')l(re)f
(using)g(TCP)-9 b(,)21 b(and)e(a)i(subscriber)e(is)i(slo)n(w)-5
b(,)20 b(messages)g(will)h(queue)e(up)h(on)g(the)g(publisher)-5
b(.)19 b(W)-7 b(e')o(ll)21 b(look)f(at)479 3364 y(ho)n(w)g(to)g
(protect)g(publishers)f(against)g(this,)i(using)e(the)i("high-w)o(ater)
d(mark")h(later)-5 b(.)-2 3382 y
SDict begin H.S end
 -2 3382 a -2 3382 a
SDict begin 13 H.A end

-2 3382 a -2 3382 a
SDict begin [/View [/XYZ H.V]/Dest (0:208) cvn /DEST pdfmark end
 -2 3382 a Black 396 3514 a Fe(\225)p
Black 479 3514 a
SDict begin H.S end
 479 3514 a 479 3514 a
SDict begin 13 H.A end
 479 3514 a 479
3514 a
SDict begin [/View [/XYZ H.V]/Dest (0:209) cvn /DEST pdfmark end
 479 3514 a Fj(From)20 b(\330MQ)g(3.x,)g(\002ltering)f(happens)g
(at)i(the)f(publisher)f(side,)h(when)g(using)f(a)i(connected)d
(protocol)h(\()3466 3514 y
SDict begin H.S end
 3466 3514 a 3466 3514 a
SDict begin 13 H.A end
 3466
3514 a 3466 3514 a
SDict begin [/View [/XYZ H.V]/Dest (0:210) cvn /DEST pdfmark end
 3466 3514 a Fg(tcp://)g Fj(or)479
3622 y
SDict begin H.S end
 479 3622 a 479 3622 a
SDict begin 13 H.A end
 479 3622 a 479 3622 a
SDict begin [/View [/XYZ H.V]/Dest (0:211) cvn /DEST pdfmark end
 479
3622 a Fg(ipc://)p Fj(\).)g(Using)i(the)1159 3622 y
SDict begin H.S end
 1159
3622 a 1159 3622 a
SDict begin 13 H.A end
 1159 3622 a 1159 3622 a
SDict begin [/View [/XYZ H.V]/Dest (0:212) cvn /DEST pdfmark end
 1159 3622
a Fg(epgm://)e Fj(protocol,)g(\002ltering)g(happens)g(at)i(the)f
(subscriber)f(side.)h(In)g(\330MQ/2.x,)f(all)479 3730
y(\002ltering)h(happened)e(at)j(the)f(subscriber)f(side.)-2
3914 y
SDict begin H.S end
 -2 3914 a -2 3914 a
SDict begin 13 H.A end
 -2 3914 a -2 3914 a
SDict begin [/View [/XYZ H.V]/Dest (0:213) cvn /DEST pdfmark end
 -2 3914
a 396 4004 a Fj(This)i(is)g(ho)n(w)e(long)h(it)h(tak)o(es)f(to)h(recei)
n(v)o(e)e(and)g(\002lter)i(10M)e(messages)i(on)f(my)f(laptop,)h(which)f
(is)i(an)f(2011-era)e(Intel)i(I7,)396 4111 y(f)o(ast)h(b)n(ut)f
(nothing)f(special:)-2 4212 y
SDict begin H.S end
 -2 4212 a -2 4212 a
SDict begin 11.7 H.A end
 -2
4212 a -2 4212 a
SDict begin [/View [/XYZ H.V]/Dest (0:214) cvn /DEST pdfmark end
 -2 4212 a 396 4292 a Fg
(ph@nb201103:~/work/git/zguide/examples/c$)38 b(time)44
b(wuclient)396 4389 y(Collecting)f(updates)h(from)g(weather)g
(server...)396 4486 y(Average)g(temperature)f(for)h(zipcode)g('10001)g
(')g(was)h(28F)396 4680 y(real)179 b(0m4.470s)396 4777
y(user)g(0m0.000s)396 4874 y(sys)224 b(0m0.008s)-2 4969
y
SDict begin H.S end
 -2 4969 a -2 4969 a
SDict begin 13 H.A end
 -2 4969 a -2 4969 a
SDict begin [/View [/XYZ H.V]/Dest (0:215) cvn /DEST pdfmark end
 -2 4969 a Black
3800 5569 a Fi(13)p Black eop end
%%Page: 14 28
TeXDict begin 14 27 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.14) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 94 a Fh(1.8.)39 b(Divide)f(and)h(Conquer)1634 94 y
SDict begin H.S end

1634 94 a 1634 94 a
SDict begin 22.464 H.A end
 1634 94 a 1634 94 a
SDict begin [/View [/XYZ H.V]/Dest (6.13.1) cvn /DEST pdfmark end
 1634 94 a -2
290 a
SDict begin H.S end
 -2 290 a -2 290 a
SDict begin 13 H.A end
 -2 290 a -2 290 a
SDict begin [/View [/XYZ H.V]/Dest (0:217) cvn /DEST pdfmark end
 -2 290 a 396
368 a Fj(As)21 b(a)g(\002nal)f(e)o(xample)f(\(you)g(are)h(surely)g
(getting)f(tired)h(of)g(juic)o(y)g(code)f(and)h(w)o(ant)g(to)g(delv)o
(e)g(back)f(into)h(philological)396 476 y(discussions)g(about)f
(comparati)n(v)o(e)f(abstracti)n(v)o(e)h(norms\),)g(let')-5
b(s)21 b(do)f(a)h(little)g(supercomputing.)16 b(Then)k(cof)n(fee.)e
(Our)396 584 y(supercomputing)f(application)i(is)i(a)f(f)o(airly)g
(typical)g(parallel)g(processing)f(model\()p 0 TeXcolorgray
2805 584 a
SDict begin H.S end
 2805 584 a Fj(Figure)e(1-5)3152 584 y
SDict begin 13 H.L end
 3152
584 a 3152 584 a
SDict begin [/Subtype /Link/Dest (0:figure-5) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3152 584 a Black -1 w Fj(\).)j(W)-7
b(e)21 b(ha)n(v)o(e:)-2 602 y
SDict begin H.S end
 -2 602 a -2 602 a
SDict begin 13 H.A end
 -2 602
a -2 602 a
SDict begin [/View [/XYZ H.V]/Dest (0:219) cvn /DEST pdfmark end
 -2 602 a -2 612 a
SDict begin H.S end
 -2 612 a -2 612 a
SDict begin 13 H.A end
 -2 612
a -2 612 a
SDict begin [/View [/XYZ H.V]/Dest (0:220) cvn /DEST pdfmark end
 -2 612 a Black 396 754 a Fe(\225)p Black 479
754 a
SDict begin H.S end
 479 754 a 479 754 a
SDict begin 13 H.A end
 479 754 a 479 754 a
SDict begin [/View [/XYZ H.V]/Dest (0:221) cvn /DEST pdfmark end
 479 754
a Fj(A)g(v)o(entilator)e(that)h(produces)e(tasks)j(that)g(can)f(be)g
(done)f(in)h(parallel)-2 772 y
SDict begin H.S end
 -2 772 a -2 772 a
SDict begin 13 H.A end
 -2 772
a -2 772 a
SDict begin [/View [/XYZ H.V]/Dest (0:222) cvn /DEST pdfmark end
 -2 772 a Black 396 904 a Fe(\225)p Black 479
904 a
SDict begin H.S end
 479 904 a 479 904 a
SDict begin 13 H.A end
 479 904 a 479 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:223) cvn /DEST pdfmark end
 479 904
a Fj(A)h(set)g(of)f(w)o(ork)o(ers)f(that)i(process)e(tasks)-2
922 y
SDict begin H.S end
 -2 922 a -2 922 a
SDict begin 13 H.A end
 -2 922 a -2 922 a
SDict begin [/View [/XYZ H.V]/Dest (0:224) cvn /DEST pdfmark end
 -2 922 a Black
396 1053 a Fe(\225)p Black 479 1053 a
SDict begin H.S end
 479 1053 a 479
1053 a
SDict begin 13 H.A end
 479 1053 a 479 1053 a
SDict begin [/View [/XYZ H.V]/Dest (0:225) cvn /DEST pdfmark end
 479 1053 a Fj(A)i(sink)f(that)g(collects)h
(results)f(back)g(from)f(the)h(w)o(ork)o(er)f(processes)-2
1237 y
SDict begin H.S end
 -2 1237 a -2 1237 a
SDict begin 13 H.A end
 -2 1237 a -2 1237 a
SDict begin [/View [/XYZ H.V]/Dest (0:226) cvn /DEST pdfmark end
 -2 1237
a 396 1327 a Fj(In)h(reality)-5 b(,)19 b(w)o(ork)o(ers)h(run)f(on)h
(superf)o(ast)g(box)o(es,)f(perhaps)g(using)g(GPUs)i(\(graphic)e
(processing)g(units\))h(to)g(do)g(the)g(hard)396 1435
y(math.)g(Here)g(is)h(the)f(v)o(entilator)-5 b(.)19 b(It)h(generates)f
(100)h(tasks,)g(each)g(is)h(a)g(message)f(telling)g(the)g(w)o(ork)o(er)
f(to)h(sleep)g(for)g(some)396 1543 y(number)f(of)h(milliseconds:)-2
1544 y
SDict begin H.S end
 -2 1544 a -2 1544 a
SDict begin 13 H.A end
 -2 1544 a -2 1544 a
SDict begin [/View [/XYZ H.V]/Dest (0:taskvent-php) cvn /DEST pdfmark
end
 -2 1544
a 396 1744 a Fk(Example)h(1-8.)e(P)o(arallel)g(task)i(v)o(entilator)e
(\(taskv)o(ent.php\))-2 1844 y
SDict begin H.S end
 -2 1844 a -2 1844 a
SDict begin 11.7 H.A end
 -2
1844 a -2 1844 a
SDict begin [/View [/XYZ H.V]/Dest (0:229) cvn /DEST pdfmark end
 -2 1844 a 396 1924 a Fg(<?php)396 2021
y(/)441 2034 y(*)441 2132 y(*)576 2119 y(Task)44 b(ventilator)441
2229 y(*)576 2216 y(Binds)g(PUSH)g(socket)g(to)g(tcp://localhost:5557)
441 2326 y(*)576 2313 y(Sends)g(batch)g(of)g(tasks)g(to)h(workers)e
(via)i(that)f(socket)441 2423 y(*)531 2410 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 2520 y(*)486
2507 y(/)396 2701 y($context)g(=)g(new)h(ZMQContext\(\);)396
2896 y(//)90 b(Socket)43 b(to)i(send)f(messages)g(on)396
2993 y($sender)g(=)h(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_PUSH\);)
396 3090 y($sender->bind\("tcp://)1341 3103 y(*)1386
3090 y(:5557"\);)396 3284 y(echo)i("Press)g(Enter)g(when)g(the)h
(workers)e(are)i(ready:)f(";)396 3381 y($fp)h(=)f
(fopen\('php://stdin',)e('r'\);)396 3479 y($line)i(=)h(fgets\($fp,)e
(512\);)396 3576 y(fclose\($fp\);)396 3673 y(echo)h("Sending)g(tasks)g
(to)g(workers...",)f(PHP_EOL;)396 3867 y(//)90 b(The)44
b(first)g(message)g(is)g("0")g(and)h(signals)e(start)h(of)h(batch)396
3964 y($sender->send\(0\);)396 4158 y(//)90 b(Send)44
b(100)g(tasks)396 4256 y($total_msec)f(=)i(0;)224 b(//)89
b(Total)44 b(expected)g(cost)g(in)g(msecs)396 4353 y(for)h(\($task_nbr)
e(=)h(0;)h($task_nbr)e(<)i(100;)f($task_nbr++\))f({)441
4450 y(//)89 b(Random)44 b(workload)g(from)g(1)h(to)f(100msecs)441
4547 y($workload)f(=)i(mt_rand\(1,)e(100\);)441 4644
y($total_msec)g(+=)i($workload;)441 4741 y($sender->send\($workload\);)
396 4936 y(})396 5130 y(printf)f(\("Total)g(expected)f(cost:)h(\045d)h
(msec\\n",)e($total_msec\);)p Black 3800 5569 a Fi(14)p
Black eop end
%%Page: 15 29
TeXDict begin 15 28 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.15) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fg(sleep)44 b(\(1\);)627 b(//)90 b(Give)44 b(0MQ)g(time)g(to)h
(delive)-2 84 y
SDict begin H.S end
 -2 84 a -2 84 a
SDict begin 13 H.A end
 -2 84 a -2 84 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-5) cvn /DEST pdfmark end
 -2 84
a 396 346 a Fk(Figur)o(e)20 b(1-5.)f(P)o(arallel)h(Pipeline)-2
446 y
SDict begin H.S end
 -2 446 a -2 446 a
SDict begin 13 H.A end
 -2 446 a -2 446 a
SDict begin [/View [/XYZ H.V]/Dest (0:232) cvn /DEST pdfmark end
 -2 446 a 396
4788 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4788 a @beginspecial 0 @llx -516 @lly 400
@urx 0 @ury 4000 @rwi @setspecial
%%BeginDocument: images/fig5.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -516 400 0
%%HiResBoundingBox: 0.0 -516.0 400.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -32.40024185180664 moveto
142.40023803710938 -78.40023803710938 lineto
254.40023803710938 -78.40023803710938 lineto
254.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -81.40023803710938 moveto
142.40023803710938 -98.40023803710938 lineto
142.40023803710938 -102.40023803710938 143.73357137044272 -104.40023803710938 146.40023803710938 -104.40023803710938 curveto
250.40023803710938 -104.40023803710938 lineto
250.40023803710938 -104.40023803710938 lineto
253.06690470377603 -104.40023803710938 254.40023803710938 -102.40023803710938 254.40023803710938 -98.40023803710938 curveto
254.40023803710938 -82.00023651123047 lineto
254.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -212.40023803710938 moveto
23.73357327779134 -212.40023803710938 22.400239944458008 -214.40023803710938 22.400239944458008 -218.40023803710938 curveto
22.400239944458008 -234.40023803710938 lineto
126.40023803710938 -234.40023803710938 lineto
126.40023803710938 -218.40023803710938 lineto
126.40023803710938 -214.40023803710938 125.06690470377605 -212.40023803710938 122.40023803710938 -212.40023803710938 curveto
26.400239944458008 -212.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -212.40023803710938 moveto
151.73357137044272 -212.40023803710938 150.40023803710938 -214.40023803710938 150.40023803710938 -218.40023803710938 curveto
150.40023803710938 -234.40023803710938 lineto
254.40023803710938 -234.40023803710938 lineto
254.40023803710938 -218.40023803710938 lineto
254.40023803710938 -214.40023803710938 253.06690470377603 -212.40023803710938 250.40023803710938 -212.40023803710938 curveto
154.40023803710938 -212.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -212.40023803710938 moveto
279.7335713704427 -212.40023803710938 278.4002380371094 -214.40023803710938 278.4002380371094 -218.40023803710938 curveto
278.4002380371094 -234.40023803710938 lineto
382.4002380371094 -234.40023803710938 lineto
382.4002380371094 -218.40023803710938 lineto
382.4002380371094 -214.40023803710938 381.06690470377606 -212.40023803710938 378.4002380371094 -212.40023803710938 curveto
282.4002380371094 -212.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -237.40023803710938 moveto
22.400239944458008 -282.4002380371094 lineto
126.40023803710938 -282.4002380371094 lineto
126.40023803710938 -237.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -237.40023803710938 moveto
150.40023803710938 -282.4002380371094 lineto
254.40023803710938 -282.4002380371094 lineto
254.40023803710938 -237.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -237.40023803710938 moveto
278.4002380371094 -282.4002380371094 lineto
382.4002380371094 -282.4002380371094 lineto
382.4002380371094 -237.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -285.4002380371094 moveto
22.400239944458008 -302.4002380371094 lineto
22.400239944458008 -306.4002380371094 23.73357327779134 -308.4002380371094 26.400239944458008 -308.4002380371094 curveto
122.40023803710938 -308.4002380371094 lineto
122.40023803710938 -308.4002380371094 lineto
125.06690470377605 -308.4002380371094 126.40023803710938 -306.4002380371094 126.40023803710938 -302.4002380371094 curveto
126.40023803710938 -286.000244140625 lineto
126.40023803710938 -285.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -285.4002380371094 moveto
150.40023803710938 -302.4002380371094 lineto
150.40023803710938 -306.4002380371094 151.73357137044272 -308.4002380371094 154.40023803710938 -308.4002380371094 curveto
250.40023803710938 -308.4002380371094 lineto
250.40023803710938 -308.4002380371094 lineto
253.06690470377603 -308.4002380371094 254.40023803710938 -306.4002380371094 254.40023803710938 -302.4002380371094 curveto
254.40023803710938 -286.000244140625 lineto
254.40023803710938 -285.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -285.4002380371094 moveto
278.4002380371094 -302.4002380371094 lineto
278.4002380371094 -306.4002380371094 279.7335713704427 -308.4002380371094 282.4002380371094 -308.4002380371094 curveto
378.4002380371094 -308.4002380371094 lineto
378.4002380371094 -308.4002380371094 lineto
381.06690470377606 -308.4002380371094 382.4002380371094 -306.4002380371094 382.4002380371094 -302.4002380371094 curveto
382.4002380371094 -286.000244140625 lineto
382.4002380371094 -285.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
146.40023803710938 -416.4002380371094 moveto
143.73357137044272 -416.4002380371094 142.40023803710938 -418.4002380371094 142.40023803710938 -422.4002380371094 curveto
142.40023803710938 -438.4002380371094 lineto
254.40023803710938 -438.4002380371094 lineto
254.40023803710938 -422.4002380371094 lineto
254.40023803710938 -418.4002380371094 253.06690470377603 -416.4002380371094 250.40023803710938 -416.4002380371094 curveto
146.40023803710938 -416.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -441.4002380371094 moveto
142.40023803710938 -488.4002380371094 lineto
254.40023803710938 -488.4002380371094 lineto
254.40023803710938 -441.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -30.0 moveto
140.0 -76.0 lineto
252.0 -76.0 lineto
252.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
140.0 -30.0 moveto
140.0 -76.0 lineto
252.0 -76.0 lineto
252.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -79.0 moveto
140.0 -96.0 lineto
140.0 -100.0 141.33333333333334 -102.0 144.0 -102.0 curveto
248.0 -102.0 lineto
248.0 -102.0 lineto
250.66666666666666 -102.0 252.0 -100.0 252.0 -96.0 curveto
252.0 -79.5999984741211 lineto
252.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -79.0 moveto
140.0 -96.0 lineto
140.0 -100.0 141.33333333333334 -102.0 144.0 -102.0 curveto
248.0 -102.0 lineto
248.0 -102.0 lineto
250.66666666666666 -102.0 252.0 -100.0 252.0 -96.0 curveto
252.0 -79.5999984741211 lineto
252.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -210.0 moveto
21.333333333333332 -210.0 20.0 -212.0 20.0 -216.0 curveto
20.0 -232.0 lineto
124.0 -232.0 lineto
124.0 -216.0 lineto
124.0 -212.0 122.66666666666667 -210.0 120.0 -210.0 curveto
24.0 -210.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -210.0 moveto
21.333333333333332 -210.0 20.0 -212.0 20.0 -216.0 curveto
20.0 -232.0 lineto
124.0 -232.0 lineto
124.0 -216.0 lineto
124.0 -212.0 122.66666666666667 -210.0 120.0 -210.0 curveto
24.0 -210.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -210.0 moveto
149.33333333333334 -210.0 148.0 -212.0 148.0 -216.0 curveto
148.0 -232.0 lineto
252.0 -232.0 lineto
252.0 -216.0 lineto
252.0 -212.0 250.66666666666666 -210.0 248.0 -210.0 curveto
152.0 -210.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -210.0 moveto
149.33333333333334 -210.0 148.0 -212.0 148.0 -216.0 curveto
148.0 -232.0 lineto
252.0 -232.0 lineto
252.0 -216.0 lineto
252.0 -212.0 250.66666666666666 -210.0 248.0 -210.0 curveto
152.0 -210.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -210.0 moveto
277.3333333333333 -210.0 276.0 -212.0 276.0 -216.0 curveto
276.0 -232.0 lineto
380.0 -232.0 lineto
380.0 -216.0 lineto
380.0 -212.0 378.6666666666667 -210.0 376.0 -210.0 curveto
280.0 -210.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -210.0 moveto
277.3333333333333 -210.0 276.0 -212.0 276.0 -216.0 curveto
276.0 -232.0 lineto
380.0 -232.0 lineto
380.0 -216.0 lineto
380.0 -212.0 378.6666666666667 -210.0 376.0 -210.0 curveto
280.0 -210.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -235.0 moveto
20.0 -280.0 lineto
124.0 -280.0 lineto
124.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -235.0 moveto
20.0 -280.0 lineto
124.0 -280.0 lineto
124.0 -235.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -235.0 moveto
148.0 -280.0 lineto
252.0 -280.0 lineto
252.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -235.0 moveto
148.0 -280.0 lineto
252.0 -280.0 lineto
252.0 -235.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -235.0 moveto
276.0 -280.0 lineto
380.0 -280.0 lineto
380.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -235.0 moveto
276.0 -280.0 lineto
380.0 -280.0 lineto
380.0 -235.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -283.0 moveto
20.0 -300.0 lineto
20.0 -304.0 21.333333333333332 -306.0 24.0 -306.0 curveto
120.0 -306.0 lineto
120.0 -306.0 lineto
122.66666666666667 -306.0 124.0 -304.0 124.0 -300.0 curveto
124.0 -283.6000061035156 lineto
124.0 -283.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -283.0 moveto
20.0 -300.0 lineto
20.0 -304.0 21.333333333333332 -306.0 24.0 -306.0 curveto
120.0 -306.0 lineto
120.0 -306.0 lineto
122.66666666666667 -306.0 124.0 -304.0 124.0 -300.0 curveto
124.0 -283.6000061035156 lineto
124.0 -283.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -283.0 moveto
148.0 -300.0 lineto
148.0 -304.0 149.33333333333334 -306.0 152.0 -306.0 curveto
248.0 -306.0 lineto
248.0 -306.0 lineto
250.66666666666666 -306.0 252.0 -304.0 252.0 -300.0 curveto
252.0 -283.6000061035156 lineto
252.0 -283.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -283.0 moveto
148.0 -300.0 lineto
148.0 -304.0 149.33333333333334 -306.0 152.0 -306.0 curveto
248.0 -306.0 lineto
248.0 -306.0 lineto
250.66666666666666 -306.0 252.0 -304.0 252.0 -300.0 curveto
252.0 -283.6000061035156 lineto
252.0 -283.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -283.0 moveto
276.0 -300.0 lineto
276.0 -304.0 277.3333333333333 -306.0 280.0 -306.0 curveto
376.0 -306.0 lineto
376.0 -306.0 lineto
378.6666666666667 -306.0 380.0 -304.0 380.0 -300.0 curveto
380.0 -283.6000061035156 lineto
380.0 -283.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -283.0 moveto
276.0 -300.0 lineto
276.0 -304.0 277.3333333333333 -306.0 280.0 -306.0 curveto
376.0 -306.0 lineto
376.0 -306.0 lineto
378.6666666666667 -306.0 380.0 -304.0 380.0 -300.0 curveto
380.0 -283.6000061035156 lineto
380.0 -283.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
144.0 -414.0 moveto
141.33333333333334 -414.0 140.0 -416.0 140.0 -420.0 curveto
140.0 -436.0 lineto
252.0 -436.0 lineto
252.0 -420.0 lineto
252.0 -416.0 250.66666666666666 -414.0 248.0 -414.0 curveto
144.0 -414.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
144.0 -414.0 moveto
141.33333333333334 -414.0 140.0 -416.0 140.0 -420.0 curveto
140.0 -436.0 lineto
252.0 -436.0 lineto
252.0 -420.0 lineto
252.0 -416.0 250.66666666666666 -414.0 248.0 -414.0 curveto
144.0 -414.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -439.0 moveto
140.0 -486.0 lineto
252.0 -486.0 lineto
252.0 -439.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -439.0 moveto
140.0 -486.0 lineto
252.0 -486.0 lineto
252.0 -439.0 lineto
closepath
stroke
newpath
64.0 -192.0 moveto
68.0 -204.0 lineto
72.0 -192.0 lineto
closepath
fill
newpath
192.0 -192.0 moveto
196.0 -204.0 lineto
200.0 -192.0 lineto
closepath
fill
newpath
320.0 -192.0 moveto
324.0 -204.0 lineto
328.0 -192.0 lineto
closepath
fill
newpath
192.0 -396.0 moveto
196.0 -408.0 lineto
200.0 -396.0 lineto
closepath
fill
newpath
196.0 -102.0 moveto
196.0 -150.0 lineto
stroke
newpath
68.0 -198.0 moveto
68.0 -150.0 lineto
196.0 -150.0 lineto
stroke
newpath
196.0 -198.0 moveto
196.0 -150.0 lineto
stroke
newpath
324.0 -198.0 moveto
324.0 -150.0 lineto
196.0 -150.0 lineto
stroke
newpath
68.0 -306.0 moveto
68.0 -354.0 lineto
196.0 -354.0 lineto
stroke
newpath
196.0 -306.0 moveto
196.0 -354.0 lineto
stroke
newpath
324.0 -306.0 moveto
324.0 -354.0 lineto
196.0 -354.0 lineto
stroke
newpath
196.0 -402.0 moveto
196.0 -354.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
164.0 -59.0 moveto
(Ventilator) show
177.0 -94.0 moveto
(PUSH) show
176.0 -131.0 moveto
(tasks) show
48.0 -179.0 moveto
(task) show
176.0 -179.0 moveto
(task) show
312.0 -179.0 moveto
(task) show
57.0 -226.0 moveto
(PULL) show
185.0 -226.0 moveto
(PULL) show
313.0 -226.0 moveto
(PULL) show
49.0 -262.0 moveto
(Worker) show
177.0 -262.0 moveto
(Worker) show
305.0 -262.0 moveto
(Worker) show
57.0 -298.0 moveto
(PUSH) show
185.0 -298.0 moveto
(PUSH) show
313.0 -298.0 moveto
(PUSH) show
51.0 -335.0 moveto
(result) show
179.0 -335.0 moveto
(result) show
307.0 -335.0 moveto
(result) show
171.0 -383.0 moveto
(results) show
177.0 -430.0 moveto
(PULL) show
177.0 -467.0 moveto
(Sink) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4788 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4788 a -2 4954 a
SDict begin H.S end
 -2 4954
a -2 4954 a
SDict begin 13 H.A end
 -2 4954 a -2 4954 a
SDict begin [/View [/XYZ H.V]/Dest (0:235) cvn /DEST pdfmark end
 -2 4954 a 396 5062 a
Fj(Here)g(is)h(the)g(w)o(ork)o(er)e(application.)f(It)j(recei)n(v)o(es)
e(a)i(message,)f(sleeps)g(for)g(that)g(number)f(of)g(seconds,)h(then)g
(signals)g(that)396 5170 y(it')-5 b(s)22 b(\002nished:)-2
5171 y
SDict begin H.S end
 -2 5171 a -2 5171 a
SDict begin 13 H.A end
 -2 5171 a -2 5171 a
SDict begin [/View [/XYZ H.V]/Dest (0:taskwork-php) cvn /DEST pdfmark
end
 -2 5171
a Black 3800 5569 a Fi(15)p Black eop end
%%Page: 16 30
TeXDict begin 16 29 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.16) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fk(Example)h(1-9.)e(P)o(arallel)g(task)i(w)o(ork)o(er)f
(\(taskw)o(ork.php\))-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 11.7 H.A end
 -2 172
a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:238) cvn /DEST pdfmark end
 -2 172 a 396 253 a Fg(<?php)396 350 y(/)441
363 y(*)441 460 y(*)576 447 y(Task)44 b(worker)441 557
y(*)576 544 y(Connects)f(PULL)h(socket)g(to)h(tcp://localhost:5557)441
654 y(*)576 641 y(Collects)e(workloads)g(from)i(ventilator)e(via)h
(that)g(socket)441 751 y(*)576 738 y(Connects)f(PUSH)h(socket)g(to)h
(tcp://localhost:5558)441 848 y(*)576 835 y(Sends)f(results)f(to)i
(sink)f(via)g(that)g(socket)441 946 y(*)531 933 y(@author)f(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
1043 y(*)486 1030 y(/)396 1224 y($context)g(=)g(new)h(ZMQContext\(\);)
396 1418 y(//)90 b(Socket)43 b(to)i(receive)f(messages)f(on)396
1515 y($receiver)h(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PULL\);)396 1613 y
($receiver->connect\("tcp://localhost:5557")o(\);)396
1807 y(//)90 b(Socket)43 b(to)i(send)f(messages)g(to)396
1904 y($sender)g(=)h(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_PUSH\);)
396 2001 y($sender->connect\("tcp://localhost:5558"\);)396
2195 y(//)90 b(Process)43 b(tasks)h(forever)396 2292
y(while)g(\(true\))g({)441 2390 y($string)g(=)g($receiver->recv\(\);)
441 2584 y(//)89 b(Simple)44 b(progress)g(indicator)f(for)h(the)h
(viewer)441 2681 y(echo)f($string,)g(PHP_EOL;)441 2875
y(//)89 b(Do)45 b(the)f(work)441 2972 y(usleep\($string)1114
2985 y(*)1203 2972 y(1000\);)531 3167 y(//)89 b(Send)44
b(results)g(to)g(sink)441 3264 y($sender->send\(""\);)-2
3440 y
SDict begin H.S end
 -2 3440 a -2 3440 a
SDict begin 13 H.A end
 -2 3440 a -2 3440 a
SDict begin [/View [/XYZ H.V]/Dest (0:239) cvn /DEST pdfmark end
 -2 3440
a 396 3538 a Fj(Here)20 b(is)h(the)g(sink)f(application.)e(It)j
(collects)f(the)g(100)g(tasks,)g(then)g(calculates)g(ho)n(w)g(long)f
(the)h(o)o(v)o(erall)f(processing)396 3646 y(took,)g(so)i(we)g(can)e
(con\002rm)h(that)g(the)g(w)o(ork)o(ers)g(really)f(were)h(running)e(in)
j(parallel,)e(if)i(there)e(are)i(more)e(than)h(one)f(of)396
3754 y(them:)-2 3755 y
SDict begin H.S end
 -2 3755 a -2 3755 a
SDict begin 13 H.A end
 -2 3755 a
-2 3755 a
SDict begin [/View [/XYZ H.V]/Dest (0:tasksink-php) cvn /DEST pdfmark
end
 -2 3755 a 396 3955 a Fk(Example)i(1-10.)d(P)o(arallel)i(task)
g(sink)i(\(tasksink.php\))-2 4055 y
SDict begin H.S end
 -2 4055 a -2 4055
a
SDict begin 11.7 H.A end
 -2 4055 a -2 4055 a
SDict begin [/View [/XYZ H.V]/Dest (0:242) cvn /DEST pdfmark end
 -2 4055 a 396 4135 a Fg(<?php)396
4232 y(/)441 4245 y(*)441 4342 y(*)576 4329 y(Task)44
b(sink)441 4440 y(*)576 4427 y(Binds)g(PULL)g(socket)g(to)g
(tcp://localhost:5558)441 4537 y(*)576 4524 y(Collects)f(results)h
(from)g(workers)g(via)g(that)g(socket)441 4634 y(*)531
4621 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4731 y(*)486
4718 y(/)396 4912 y(//)90 b(Prepare)43 b(our)i(context)e(and)i(socket)
396 5009 y($context)f(=)g(new)h(ZMQContext\(\);)396 5107
y($receiver)f(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_PULL\);)p
Black 3798 5569 a Fi(16)p Black eop end
%%Page: 17 31
TeXDict begin 17 30 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.17) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fg($receiver->bind\("tcp://)1431 85 y(*)1476
72 y(:5558"\);)396 267 y(//)90 b(Wait)44 b(for)g(start)g(of)h(batch)396
364 y($string)f(=)h($receiver->recv\(\);)396 558 y(//)90
b(Start)44 b(our)g(clock)g(now)396 655 y($tstart)g(=)h
(microtime\(true\);)396 850 y(//)90 b(Process)43 b(100)i(confirmations)
396 947 y($total_msec)e(=)i(0;)224 b(//)89 b(Total)44
b(calculated)f(cost)h(in)h(msecs)396 1044 y(for)g(\($task_nbr)e(=)h(0;)
h($task_nbr)e(<)i(100;)f($task_nbr++\))f({)441 1141 y($string)h(=)g
($receiver->recv\(\);)441 1238 y(if\($task_nbr)f(\045)i(10)f(==)h(0\))f
({)486 1335 y(echo)g(":";)441 1432 y(})h(else)f({)486
1530 y(echo)g(".";)441 1627 y(})396 1724 y(})396 1918
y($tend)g(=)h(microtime\(true\);)396 2112 y($total_msec)e(=)i(\($tend)f
(-)g($tstart\))1831 2125 y(*)1921 2112 y(1000;)396 2209
y(echo)g(PHP_EOL;)396 2307 y(printf)g(\("Total)g(elapsed)f(time:)h
(\045d)h(msec",)f($total_msec\);)396 2404 y(echo)g(PHP_EOL)-2
2580 y
SDict begin H.S end
 -2 2580 a -2 2580 a
SDict begin 13 H.A end
 -2 2580 a -2 2580 a
SDict begin [/View [/XYZ H.V]/Dest (0:243) cvn /DEST pdfmark end
 -2 2580
a 396 2678 a Fj(The)20 b(a)n(v)o(erage)f(cost)i(of)e(a)i(batch)f(is)h
(5)f(seconds.)f(When)h(we)h(start)g(1,)f(2,)g(4)g(w)o(ork)o(ers)g(we)g
(get)g(results)h(lik)o(e)f(this)h(from)e(the)396 2786
y(sink:)-2 2869 y
SDict begin H.S end
 -2 2869 a -2 2869 a
SDict begin 11.7 H.A end
 -2 2869 a -2 2869
a
SDict begin [/View [/XYZ H.V]/Dest (0:244) cvn /DEST pdfmark end
 -2 2869 a 396 2966 a Fg(#)135 b(1)44 b(worker)396 3063
y(Total)g(elapsed)g(time:)g(5034)g(msec)396 3160 y(#)135
b(2)44 b(workers)396 3257 y(Total)g(elapsed)g(time:)g(2421)g(msec)396
3354 y(#)135 b(4)44 b(workers)396 3451 y(Total)g(elapsed)g(time:)g
(1018)g(msec)-2 3629 y
SDict begin H.S end
 -2 3629 a -2 3629 a
SDict begin 13 H.A end
 -2 3629 a
-2 3629 a
SDict begin [/View [/XYZ H.V]/Dest (0:245) cvn /DEST pdfmark end
 -2 3629 a 396 3725 a Fj(Let')-5 b(s)21 b(look)e(at)i(some)f
(aspects)h(of)f(this)g(code)g(in)g(more)f(detail:)-2
3743 y
SDict begin H.S end
 -2 3743 a -2 3743 a
SDict begin 13 H.A end
 -2 3743 a -2 3743 a
SDict begin [/View [/XYZ H.V]/Dest (0:246) cvn /DEST pdfmark end
 -2 3743
a -2 3753 a
SDict begin H.S end
 -2 3753 a -2 3753 a
SDict begin 13 H.A end
 -2 3753 a -2 3753 a
SDict begin [/View [/XYZ H.V]/Dest (0:247) cvn /DEST pdfmark end
 -2
3753 a Black 396 3896 a Fe(\225)p Black 479 3896 a
SDict begin H.S end
 479
3896 a 479 3896 a
SDict begin 13 H.A end
 479 3896 a 479 3896 a
SDict begin [/View [/XYZ H.V]/Dest (0:248) cvn /DEST pdfmark end
 479 3896 a Fj(The)h(w)o(ork)o
(ers)g(connect)f(upstream)g(to)h(the)g(v)o(entilator)m(,)e(and)i(do)n
(wnstream)f(to)h(the)g(sink.)g(This)g(means)g(you)g(can)g(add)479
4004 y(w)o(ork)o(ers)g(arbitrarily)-5 b(.)18 b(If)i(the)g(w)o(ork)o
(ers)g(bound)e(to)i(their)g(endpoints,)f(you)g(w)o(ould)g(need)h(\(a\))
g(more)f(endpoints)g(and)479 4111 y(\(b\))h(to)g(modify)f(the)h(v)o
(entilator)f(and/or)g(the)h(sink)g(each)g(time)g(you)f(added)g(a)i(w)o
(ork)o(er)-5 b(.)19 b(W)-7 b(e)22 b(say)e(that)h(the)f(v)o(entilator)
479 4219 y(and)g(sink)g(are)g(')-5 b(stable')20 b(parts)h(of)e(our)h
(architecture)e(and)i(the)g(w)o(ork)o(ers)g(are)g(')l(dynamic')e(parts)
i(of)g(it.)-2 4237 y
SDict begin H.S end
 -2 4237 a -2 4237 a
SDict begin 13 H.A end
 -2 4237 a -2
4237 a
SDict begin [/View [/XYZ H.V]/Dest (0:249) cvn /DEST pdfmark end
 -2 4237 a Black 396 4369 a Fe(\225)p Black 479
4369 a
SDict begin H.S end
 479 4369 a 479 4369 a
SDict begin 13 H.A end
 479 4369 a 479 4369 a
SDict begin [/View [/XYZ H.V]/Dest (0:250) cvn /DEST pdfmark end
 479
4369 a Fj(W)-7 b(e)22 b(ha)n(v)o(e)d(to)i(synchronize)c(the)k(start)f
(of)g(the)h(batch)e(with)h(all)h(w)o(ork)o(ers)f(being)f(up)h(and)f
(running.)f(This)j(is)g(a)f(f)o(airly)479 4477 y(common)f(gotcha)g(in)h
(\330MQ)g(and)g(there)g(is)h(no)f(easy)g(solution.)f(The)h('connect')e
(method)h(tak)o(es)i(a)f(certain)g(time.)g(So)479 4585
y(when)g(a)g(set)h(of)f(w)o(ork)o(ers)g(connect)f(to)h(the)g(v)o
(entilator)m(,)f(the)h(\002rst)h(one)e(to)i(successfully)e(connect)g
(will)i(get)f(a)h(whole)479 4693 y(load)f(of)g(messages)g(in)h(that)f
(short)g(time)g(while)g(the)g(others)g(are)g(also)h(connecting.)d(If)i
(you)f(don')o(t)f(synchronize)g(the)479 4801 y(start)j(of)f(the)g
(batch)g(someho)n(w)-5 b(,)18 b(the)i(system)h(w)o(on')o(t)e(run)g(in)h
(parallel)g(at)h(all.)f(T)m(ry)g(remo)o(ving)e(the)i(w)o(ait,)h(and)e
(see.)-2 4819 y
SDict begin H.S end
 -2 4819 a -2 4819 a
SDict begin 13 H.A end
 -2 4819 a -2 4819
a
SDict begin [/View [/XYZ H.V]/Dest (0:251) cvn /DEST pdfmark end
 -2 4819 a Black 396 4950 a Fe(\225)p Black 479 4950
a
SDict begin H.S end
 479 4950 a 479 4950 a
SDict begin 13 H.A end
 479 4950 a 479 4950 a
SDict begin [/View [/XYZ H.V]/Dest (0:252) cvn /DEST pdfmark end
 479 4950
a Fj(The)h(v)o(entilator')-5 b(s)19 b(PUSH)i(sock)o(et)f(distrib)n
(utes)g(tasks)h(to)f(w)o(ork)o(ers)g(\(assuming)f(the)o(y)g(are)i(all)f
(connected)3519 4950 y
SDict begin H.S end
 3519 4950 a 3519 4950 a
SDict begin 13 H.A end
 3519 4950
a 3519 4950 a
SDict begin [/View [/XYZ H.V]/Dest (0:253) cvn /DEST pdfmark end
 3519 4950 a Fi(befor)m(e)f Fj(the)479 5058
y(batch)h(starts)h(going)e(out\))g(e)n(v)o(enly)-5 b(.)18
b(This)j(is)g(called)1958 5058 y
SDict begin H.S end
 1958 5058 a 1958 5058
a
SDict begin 13 H.A end
 1958 5058 a 1958 5058 a
SDict begin [/View [/XYZ H.V]/Dest (0:254) cvn /DEST pdfmark end
 1958 5058 a Fi(load-balancing)16
b Fj(and)k(it')-5 b(s)21 b(something)e(we')o(ll)h(look)g(at)g(again)f
(in)479 5166 y(more)h(detail.)-2 5167 y
SDict begin H.S end
 -2 5167 a -2
5167 a
SDict begin 13 H.A end
 -2 5167 a -2 5167 a
SDict begin [/View [/XYZ H.V]/Dest (0:255) cvn /DEST pdfmark end
 -2 5167 a Black 3797 5569
a Fi(17)p Black eop end
%%Page: 18 32
TeXDict begin 18 31 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.18) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72 a 479
72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:256) cvn /DEST pdfmark end
 479 72 a Fj(The)g(sink')-5 b(s)21
b(PULL)f(sock)o(et)g(collects)g(results)h(from)e(w)o(ork)o(ers)h(e)n(v)
o(enly)-5 b(.)18 b(This)i(is)h(called)3002 72 y
SDict begin H.S end
 3002
72 a 3002 72 a
SDict begin 13 H.A end
 3002 72 a 3002 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:257) cvn /DEST pdfmark end
 3002 72 a Fi(fair)n(-queuing)p
Fj(\()p 0 TeXcolorgray 3446 72 a
SDict begin H.S end
 3446 72 a Fj(Figure)c(1-6)3793
72 y
SDict begin 13 H.L end
 3793 72 a 3793 72 a
SDict begin [/Subtype /Link/Dest (0:figure-6) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3793 72 a Black -2 w Fj(\).)-2
90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-6) cvn /DEST pdfmark end
 -2 90 a 396 305
a Fk(Figur)o(e)j(1-6.)f(F)n(air)h(Queuing)-2 405 y
SDict begin H.S end
 -2
405 a -2 405 a
SDict begin 13 H.A end
 -2 405 a -2 405 a
SDict begin [/View [/XYZ H.V]/Dest (0:261) cvn /DEST pdfmark end
 -2 405 a 396 2663 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate

396 2663 a @beginspecial 0 @llx -266 @lly 430 @urx 0
@ury 4300 @rwi @setspecial
%%BeginDocument: images/fig6.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -266 430 0
%%HiResBoundingBox: 0.0 -266.0 430.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -59.000301361083984 lineto
28.00029945373535 -63.66696548461914 29.666966756184895 -66.00029754638672 33.000301361083984 -66.00029754638672 curveto
123.00029754638672 -66.00029754638672 lineto
123.00029754638672 -66.00029754638672 lineto
126.33363596598308 -66.00029754638672 128.00030517578125 -63.66696548461914 128.00030517578125 -59.000301361083984 curveto
128.00030517578125 -38.000301361083984 lineto
128.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -38.000301361083984 moveto
168.00030517578125 -59.000301361083984 lineto
168.00030517578125 -63.66696548461914 169.6669718424479 -66.00029754638672 173.00030517578125 -66.00029754638672 curveto
263.00030517578125 -66.00029754638672 lineto
263.00030517578125 -66.00029754638672 lineto
266.33363850911456 -66.00029754638672 268.00030517578125 -63.66696548461914 268.00030517578125 -59.000301361083984 curveto
268.00030517578125 -38.000301361083984 lineto
268.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -38.000301361083984 moveto
308.00030517578125 -59.000301361083984 lineto
308.00030517578125 -63.66696548461914 309.66697184244794 -66.00029754638672 313.00030517578125 -66.00029754638672 curveto
403.00030517578125 -66.00029754638672 lineto
403.00030517578125 -66.00029754638672 lineto
406.33363850911456 -66.00029754638672 408.00030517578125 -63.66696548461914 408.00030517578125 -59.000301361083984 curveto
408.00030517578125 -38.000301361083984 lineto
408.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
153.00030517578125 -206.00030517578125 moveto
149.6669718424479 -206.00030517578125 148.00030517578125 -208.3336385091146 148.00030517578125 -213.00030517578125 curveto
148.00030517578125 -234.00030517578125 lineto
288.00030517578125 -234.00030517578125 lineto
288.00030517578125 -213.00030517578125 lineto
288.00030517578125 -208.3336385091146 286.33363850911456 -206.00030517578125 283.00030517578125 -206.00030517578125 curveto
153.00030517578125 -206.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -56.0 lineto
25.0 -60.666666666666664 26.666666666666668 -63.0 30.0 -63.0 curveto
120.0 -63.0 lineto
120.0 -63.0 lineto
123.33333333333333 -63.0 125.0 -60.666666666666664 125.0 -56.0 curveto
125.0 -35.0 lineto
125.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -56.0 lineto
25.0 -60.666666666666664 26.666666666666668 -63.0 30.0 -63.0 curveto
120.0 -63.0 lineto
120.0 -63.0 lineto
123.33333333333333 -63.0 125.0 -60.666666666666664 125.0 -56.0 curveto
125.0 -35.0 lineto
125.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -56.0 lineto
165.0 -60.666666666666664 166.66666666666666 -63.0 170.0 -63.0 curveto
260.0 -63.0 lineto
260.0 -63.0 lineto
263.3333333333333 -63.0 265.0 -60.666666666666664 265.0 -56.0 curveto
265.0 -35.0 lineto
265.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -56.0 lineto
165.0 -60.666666666666664 166.66666666666666 -63.0 170.0 -63.0 curveto
260.0 -63.0 lineto
260.0 -63.0 lineto
263.3333333333333 -63.0 265.0 -60.666666666666664 265.0 -56.0 curveto
265.0 -35.0 lineto
265.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -56.0 lineto
305.0 -60.666666666666664 306.6666666666667 -63.0 310.0 -63.0 curveto
400.0 -63.0 lineto
400.0 -63.0 lineto
403.3333333333333 -63.0 405.0 -60.666666666666664 405.0 -56.0 curveto
405.0 -35.0 lineto
405.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -56.0 lineto
305.0 -60.666666666666664 306.6666666666667 -63.0 310.0 -63.0 curveto
400.0 -63.0 lineto
400.0 -63.0 lineto
403.3333333333333 -63.0 405.0 -60.666666666666664 405.0 -56.0 curveto
405.0 -35.0 lineto
405.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
150.0 -203.0 moveto
146.66666666666666 -203.0 145.0 -205.33333333333334 145.0 -210.0 curveto
145.0 -231.0 lineto
285.0 -231.0 lineto
285.0 -210.0 lineto
285.0 -205.33333333333334 283.3333333333333 -203.0 280.0 -203.0 curveto
150.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
150.0 -203.0 moveto
146.66666666666666 -203.0 145.0 -205.33333333333334 145.0 -210.0 curveto
145.0 -231.0 lineto
285.0 -231.0 lineto
285.0 -210.0 lineto
285.0 -205.33333333333334 283.3333333333333 -203.0 280.0 -203.0 curveto
150.0 -203.0 lineto
closepath
stroke
newpath
190.0 -147.0 moveto
199.0 -147.0 lineto
stroke
newpath
215.0 -168.0 moveto
215.0 -189.0 lineto
stroke
newpath
355.0 -63.0 moveto
355.0 -83.0 lineto
stroke
newpath
210.0 -182.0 moveto
215.0 -196.0 lineto
220.0 -182.0 lineto
closepath
fill
newpath
75.0 -63.0 moveto
75.0 -119.0 lineto
215.0 -119.0 lineto
stroke
newpath
215.0 -63.0 moveto
215.0 -119.0 lineto
stroke
newpath
355.0 -105.0 moveto
355.0 -119.0 lineto
215.0 -119.0 lineto
stroke
newpath
215.0 -133.0 moveto
215.0 -119.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
50.0 -54.0 moveto
(PUSH) show
190.0 -54.0 moveto
(PUSH) show
330.0 -54.0 moveto
(PUSH) show
38.0 -96.0 moveto
(R1, R2, R3) show
200.0 -96.0 moveto
(R4) show
334.0 -96.0 moveto
(R5, R6) show
150.0 -152.0 moveto
(fair queuing) show
130.0 -166.0 moveto
(R1, R4, R5, R2, R6, R3) show
201.0 -222.0 moveto
(PULL) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2663 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2663 a -2 2829 a
SDict begin H.S end
 -2 2829
a -2 2829 a
SDict begin 13 H.A end
 -2 2829 a -2 2829 a
SDict begin [/View [/XYZ H.V]/Dest (0:264) cvn /DEST pdfmark end
 -2 2829 a 396 2937 a
Fj(The)g(pipeline)f(pattern)h(also)g(e)o(xhibits)g(the)g("slo)n(w)g
(joiner")g(syndrome,)d(leading)j(to)g(accusations)f(that)i(PUSH)g(sock)
o(ets)396 3045 y(don')o(t)e(load)h(balance)f(properly)-5
b(.)17 b(If)j(you)g(are)g(using)f(PUSH)i(and)f(PULL,)g(and)g(one)f(of)h
(your)f(w)o(ork)o(ers)h(gets)g(w)o(ay)g(more)396 3153
y(messages)h(than)e(the)i(others,)e(it')-5 b(s)21 b(because)f(that)g
(PULL)g(sock)o(et)g(has)h(joined)e(f)o(aster)h(than)g(the)g(others,)g
(and)f(grabs)h(a)h(lot)396 3261 y(of)f(messages)h(before)d(the)j
(others)e(manage)g(to)h(connect.)-2 3289 y
SDict begin H.S end
 -2 3289 a
-2 3289 a
SDict begin 13 H.A end
 -2 3289 a -2 3289 a
SDict begin [/View [/XYZ H.V]/Dest (0:265) cvn /DEST pdfmark end
 -2 3289 a 359 x Fh(1.9.)39
b(Pr)m(ogramming)e(with)h(\330MQ)1917 3648 y
SDict begin H.S end
 1917 3648
a 1917 3648 a
SDict begin 22.464 H.A end
 1917 3648 a 1917 3648 a
SDict begin [/View [/XYZ H.V]/Dest (6.14.1) cvn /DEST pdfmark end
 1917 3648 a -2
3846 a
SDict begin H.S end
 -2 3846 a -2 3846 a
SDict begin 13 H.A end
 -2 3846 a -2 3846 a
SDict begin [/View [/XYZ H.V]/Dest (0:267) cvn /DEST pdfmark end
 -2 3846
a 396 3922 a Fj(Ha)n(ving)20 b(seen)g(some)g(e)o(xamples,)f(you')l(re)f
(eager)i(to)g(start)h(using)e(\330MQ)i(in)f(some)g(apps.)g(Before)g
(you)f(start)i(that,)f(tak)o(e)g(a)396 4030 y(deep)g(breath,)f
(chillax,)g(and)h(re\003ect)g(on)g(some)g(basic)g(advice)g(that)g(will)
h(sa)n(v)o(e)f(you)g(stress)h(and)e(confusion.)-2 4048
y
SDict begin H.S end
 -2 4048 a -2 4048 a
SDict begin 13 H.A end
 -2 4048 a -2 4048 a
SDict begin [/View [/XYZ H.V]/Dest (0:268) cvn /DEST pdfmark end
 -2 4048 a -2
4058 a
SDict begin H.S end
 -2 4058 a -2 4058 a
SDict begin 13 H.A end
 -2 4058 a -2 4058 a
SDict begin [/View [/XYZ H.V]/Dest (0:269) cvn /DEST pdfmark end
 -2 4058
a Black 396 4200 a Fe(\225)p Black 479 4200 a
SDict begin H.S end
 479 4200
a 479 4200 a
SDict begin 13 H.A end
 479 4200 a 479 4200 a
SDict begin [/View [/XYZ H.V]/Dest (0:270) cvn /DEST pdfmark end
 479 4200 a Fj(Learn)h(\330MQ)g(step)
h(by)e(step.)i(It')-5 b(s)20 b(just)h(one)f(simple)g(API)h(b)n(ut)f(it)
h(hides)f(a)g(w)o(orld)g(of)g(possibilities.)g(T)-7 b(ak)o(e)20
b(the)479 4308 y(possibilities)h(slo)n(wly)-5 b(,)19
b(master)h(each)g(one.)-2 4326 y
SDict begin H.S end
 -2 4326 a -2 4326 a
SDict begin 13 H.A end

-2 4326 a -2 4326 a
SDict begin [/View [/XYZ H.V]/Dest (0:271) cvn /DEST pdfmark end
 -2 4326 a Black 396 4458 a Fe(\225)p
Black 479 4458 a
SDict begin H.S end
 479 4458 a 479 4458 a
SDict begin 13 H.A end
 479 4458 a 479
4458 a
SDict begin [/View [/XYZ H.V]/Dest (0:272) cvn /DEST pdfmark end
 479 4458 a Fj(Write)h(nice)f(code.)f(Ugly)h(code)g(hides)g
(problems)e(and)i(mak)o(es)g(it)h(hard)e(for)h(others)g(to)g(help)g
(you.)f(Y)-9 b(ou)19 b(might)h(get)479 4566 y(used)g(to)h(meaningless)e
(v)n(ariable)g(names,)g(b)n(ut)i(people)e(reading)g(your)f(code)i(w)o
(on')o(t.)f(Use)i(names)f(that)g(are)g(real)479 4674
y(w)o(ords,)g(that)g(say)h(something)d(other)i(than)f("I'm)h(too)g
(careless)g(to)h(tell)f(you)g(what)g(this)h(v)n(ariable)e(is)i(really)f
(for".)f(Use)479 4781 y(consistent)h(indentation,)e(clean)i(layout.)f
(Write)i(nice)f(code)g(and)f(your)g(w)o(orld)h(will)h(be)f(more)f
(comfortable.)-2 4799 y
SDict begin H.S end
 -2 4799 a -2 4799 a
SDict begin 13 H.A end
 -2 4799 a
-2 4799 a
SDict begin [/View [/XYZ H.V]/Dest (0:273) cvn /DEST pdfmark end
 -2 4799 a Black 396 4931 a Fe(\225)p Black
479 4931 a
SDict begin H.S end
 479 4931 a 479 4931 a
SDict begin 13 H.A end
 479 4931 a 479 4931
a
SDict begin [/View [/XYZ H.V]/Dest (0:274) cvn /DEST pdfmark end
 479 4931 a Fj(T)-6 b(est)21 b(what)f(you)g(mak)o(e)f(as)i(you)f(mak)o
(e)f(it.)i(When)f(your)f(program)f(doesn')o(t)h(w)o(ork,)g(you)g
(should)g(kno)n(w)h(what)g(\002)n(v)o(e)479 5039 y(lines)h(are)f(to)g
(blame.)g(This)g(is)h(especially)f(true)g(when)f(you)h(do)g(\330MQ)g
(magic,)f(which)h(just)3129 5039 y
SDict begin H.S end
 3129 5039 a 3129 5039
a
SDict begin 13 H.A end
 3129 5039 a 3129 5039 a
SDict begin [/View [/XYZ H.V]/Dest (0:275) cvn /DEST pdfmark end
 3129 5039 a Fi(won')n(t)h Fj(w)o(ork)e(the)h
(\002rst)479 5147 y(fe)n(w)g(times)h(you)e(try)h(it.)-2
5165 y
SDict begin H.S end
 -2 5165 a -2 5165 a
SDict begin 13 H.A end
 -2 5165 a -2 5165 a
SDict begin [/View [/XYZ H.V]/Dest (0:276) cvn /DEST pdfmark end
 -2 5165
a Black 3800 5569 a Fi(18)p Black eop end
%%Page: 19 33
TeXDict begin 19 32 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.19) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72 a 479
72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:277) cvn /DEST pdfmark end
 479 72 a Fj(When)g(you)g(\002nd)g(that)g(things)
g(don')o(t)e(w)o(ork)i(as)h(e)o(xpected,)d(break)h(your)g(code)g(into)h
(pieces,)g(test)h(each)f(one,)g(see)479 180 y(which)g(one)g(is)h(not)f
(w)o(orking.)e(\330MQ)i(lets)h(you)f(mak)o(e)g(essentially)g(modular)e
(code,)i(use)g(that)g(to)h(your)d(adv)n(antage.)-2 198
y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:278) cvn /DEST pdfmark end
 -2 198 a Black
396 330 a Fe(\225)p Black 479 330 a
SDict begin H.S end
 479 330 a 479 330
a
SDict begin 13 H.A end
 479 330 a 479 330 a
SDict begin [/View [/XYZ H.V]/Dest (0:279) cvn /DEST pdfmark end
 479 330 a Fj(Mak)o(e)i(abstractions)g(\(classes,)
g(methods,)f(whate)n(v)o(er\))g(as)h(you)g(need)f(them.)h(If)g(you)f
(cop)o(y/paste)g(a)i(lot)f(of)g(code)479 438 y(you')l(re)f(going)f(to)j
(cop)o(y/paste)e(errors)g(too.)-2 622 y
SDict begin H.S end
 -2 622 a -2 622
a
SDict begin 13 H.A end
 -2 622 a -2 622 a
SDict begin [/View [/XYZ H.V]/Dest (0:280) cvn /DEST pdfmark end
 -2 622 a 396 712 a Fj(T)-7 b(o)21
b(illustrate,)f(here)f(is)i(a)g(fragment)e(of)g(code)h(someone)f(ask)o
(ed)h(me)g(to)g(help)g(\002x:)-2 813 y
SDict begin H.S end
 -2 813 a -2 813
a
SDict begin 11.7 H.A end
 -2 813 a -2 813 a
SDict begin [/View [/XYZ H.V]/Dest (0:281) cvn /DEST pdfmark end
 -2 813 a 396 892 a Fg(//)90 b(NOTE:)44
b(do)g(NOT)g(reuse)g(this)h(example)e(code!)396 989 y(static)h(char)934
1002 y(*)979 989 y(topic-str)f(=)i("msg.x|";)396 1183
y(void)576 1196 y(*)665 1183 y(pub-worker\(void)1340
1196 y(*)1427 1183 y(arg\){)576 1280 y(void)800 1293
y(*)845 1280 y(ctx)f(=)h(arg;)576 1378 y(assert\(ctx\);)576
1572 y(void)800 1585 y(*)845 1572 y(qskt)f(=)g(zmq-socket\(ctx,)f
(ZMQ-REP\);)576 1669 y(assert\(qskt\);)576 1863 y(int)h(rc)g(=)h
(zmq-connect\(qskt,)d("inproc://querys"\);)576 1960 y(assert\(rc)h(==)h
(0\);)576 2155 y(void)800 2168 y(*)845 2155 y(pubskt)f(=)i
(zmq-socket\(ctx,)d(ZMQ-PUB\);)576 2252 y(assert\(pubskt\);)576
2446 y(rc)i(=)h(zmq-bind\(pubskt,)d("inproc://publish"\);)576
2543 y(assert\(rc)h(==)h(0\);)576 2737 y(uint8-t)f(cmd;)576
2835 y(uint32-t)g(nb;)576 2932 y(zmq-msg-t)g(topic-msg,)g(cmd-msg,)h
(nb-msg,)f(resp-msg;)576 3126 y(zmq-msg-init-data\(&topic-msg,)d
(topic-str,)j(strlen\(topic-str\))f(,)i(NULL,)g(NULL\);)576
3320 y(fprintf\(stdout,"WORKER:)d(ready)j(to)g(receive)g
(messages\\n"\);)576 3417 y(//)89 b(NOTE:)44 b(do)g(NOT)h(reuse)f(this)
g(example)g(code,)g(It's)g(broken.)576 3515 y(//)89 b(e.g.)44
b(topic-msg)f(will)i(be)f(invalid)g(the)g(second)g(time)g(through)576
3612 y(while)g(\(1\){)576 3709 y(zmq-msg-send\(pubskt,)d(&topic-msg,)i
(ZMQ-SNDMORE\);)576 3903 y(zmq-msg-init\(&cmd-msg\);)576
4000 y(zmq-msg-recv\(qskt,)e(&cmd-msg,)j(0\);)576 4097
y(memcpy\(&cmd,)e(zmq-msg-data\(&cmd-msg\),)f(sizeof\(uint8-t\)\);)576
4195 y(zmq-msg-send\(pubskt,)g(&cmd-msg,)i(ZMQ-SNDMORE\);)576
4292 y(zmq-msg-close\(&cmd-msg\);)576 4486 y(fprintf\(stdout,)f
("received)h(cmd)i(\045u\\n",)e(cmd\);)576 4680 y
(zmq-msg-init\(&nb-msg\);)576 4777 y(zmq-msg-recv\(qskt,)e(&nb-msg,)j
(0\);)576 4874 y(memcpy\(&nb,)f(zmq-msg-data\(&nb-msg\),)e
(sizeof\(uint32-t\)\);)576 4972 y(zmq-msg-send\(pubskt,)g(&nb-msg,)j
(0\);)576 5069 y(zmq-msg-close\(&nb-msg\);)p Black 3800
5569 a Fi(19)p Black eop end
%%Page: 20 34
TeXDict begin 20 33 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.20) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
576 72 a Fg(fprintf\(stdout,)42 b("received)h(nb)i(\045u\\n",)f(nb\);)
576 267 y(zmq-msg-init-size\(&resp-msg,)c(sizeof\(uint8-t\)\);)576
364 y(memset\(zmq-msg-data\(&resp-msg\),)f(0,)45 b
(sizeof\(uint8-t\)\);)576 461 y(zmq-msg-send\(qskt,)c(&resp-msg,)j
(0\);)576 558 y(zmq-msg-close\(&resp-msg\);)576 752 y(})576
850 y(return)f(NULL;)396 947 y(})-2 1121 y
SDict begin H.S end
 -2 1121 a
-2 1121 a
SDict begin 13 H.A end
 -2 1121 a -2 1121 a
SDict begin [/View [/XYZ H.V]/Dest (0:282) cvn /DEST pdfmark end
 -2 1121 a 396 1221 a Fj(This)21
b(is)g(what)f(I)g(re)n(wrote)g(it)g(to,)h(as)f(part)g(of)g(\002nding)f
(the)h(b)n(ug:)-2 1322 y
SDict begin H.S end
 -2 1322 a -2 1322 a
SDict begin 11.7 H.A end
 -2 1322
a -2 1322 a
SDict begin [/View [/XYZ H.V]/Dest (0:283) cvn /DEST pdfmark end
 -2 1322 a 396 1401 a Fg(static)44 b(void)934
1414 y(*)396 1498 y(worker-thread)f(\(void)1293 1511
y(*)1338 1498 y(arg\))h({)576 1595 y(void)800 1608 y(*)845
1595 y(context)f(=)i(arg;)576 1692 y(void)800 1705 y(*)845
1692 y(worker)e(=)i(zmq-socket)e(\(context,)h(ZMQ-REP\);)576
1789 y(assert)f(\(worker\);)576 1887 y(int)h(rc;)576
1984 y(rc)g(=)h(zmq-connect)e(\(worker,)g("ipc://worker"\);)576
2081 y(assert)g(\(rc)i(==)f(0\);)576 2275 y(void)800
2288 y(*)845 2275 y(broadcast)f(=)i(zmq-socket)e(\(context,)g
(ZMQ-PUB\);)576 2372 y(assert)g(\(broadcast\);)576 2469
y(rc)h(=)h(zmq-bind)e(\(broadcast,)g("ipc://publish"\);)576
2566 y(assert)g(\(rc)i(==)f(0\);)576 2761 y(while)g(\(1\))g({)755
2858 y(char)979 2871 y(*)1024 2858 y(part1)g(=)h(s-recv)e(\(worker\);)
755 2955 y(char)979 2968 y(*)1024 2955 y(part2)h(=)h(s-recv)e
(\(worker\);)755 3052 y(printf)h(\("Worker)f(got)i([\045s][\045s]\\n",)
d(part1,)i(part2\);)755 3149 y(s-sendmore)f(\(broadcast,)g("msg"\);)755
3246 y(s-sendmore)g(\(broadcast,)g(part1\);)755 3344
y(s-send)223 b(\(broadcast,)43 b(part2\);)755 3441 y(free)h(\(part1\);)
755 3538 y(free)g(\(part2\);)755 3732 y(s-send)g(\(worker,)f("OK"\);)
576 3829 y(})576 3926 y(return)g(NULL;)396 4023 y(})-2
4198 y
SDict begin H.S end
 -2 4198 a -2 4198 a
SDict begin 13 H.A end
 -2 4198 a -2 4198 a
SDict begin [/View [/XYZ H.V]/Dest (0:284) cvn /DEST pdfmark end
 -2 4198
a 396 4297 a Fj(In)20 b(the)g(end,)g(the)g(problem)e(w)o(as)j(that)g
(the)f(application)f(w)o(as)i(passing)f(sock)o(ets)g(between)f
(threads,)h(which)f(crashes)396 4405 y(weirdly)-5 b(.)19
b(Sock)o(ets)h(are)g(not)g(threadsafe.)f(It)h(became)g(le)o(gal)f(beha)
n(vior)g(to)h(migrate)f(sock)o(ets)i(from)e(one)h(thread)f(to)396
4513 y(another)g(in)h(\330MQ/2.1,)f(b)n(ut)i(this)f(remains)g
(dangerous)e(unless)i(you)f(use)i(a)g("full)e(memory)g(barrier".)g(If)h
(you)f(don')o(t)396 4621 y(kno)n(w)g(what)i(that)f(means,)f(don')o(t)g
(attempt)h(sock)o(et)g(migration.)-2 4639 y
SDict begin H.S end
 -2 4639 a
-2 4639 a
SDict begin 13 H.A end
 -2 4639 a -2 4639 a
SDict begin [/View [/XYZ H.V]/Dest (0:285) cvn /DEST pdfmark end
 -2 4639 a Black 3800 5569
a Fi(20)p Black eop end
%%Page: 21 35
TeXDict begin 21 34 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.21) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 77 a Fd(1.9.1.)36 b(Getting)d(the)h(Conte)n(xt)g(Right)2174
77 y
SDict begin H.S end
 2174 77 a 2174 77 a
SDict begin 18.72 H.A end
 2174 77 a 2174 77 a
SDict begin [/View [/XYZ H.V]/Dest (6.14.1.2) cvn /DEST pdfmark end
 2174 77
a -2 269 a
SDict begin H.S end
 -2 269 a -2 269 a
SDict begin 13 H.A end
 -2 269 a -2 269 a
SDict begin [/View [/XYZ H.V]/Dest (0:287) cvn /DEST pdfmark end
 -2 269
a 396 351 a Fj(\330MQ)21 b(applications)e(al)o(w)o(ays)h(start)h(by)f
(creating)f(a)1896 351 y
SDict begin H.S end
 1896 351 a 1896 351 a
SDict begin 13 H.A end
 1896 351
a 1896 351 a
SDict begin [/View [/XYZ H.V]/Dest (0:288) cvn /DEST pdfmark end
 1896 351 a Fi(conte)n(xt)q Fj(,)h(and)f(then)h(using)g
(that)g(for)g(creating)f(sock)o(ets.)h(In)g(C,)h(it')-5
b(s)396 459 y(the)518 459 y
SDict begin H.S end
 518 459 a 518 459 a
SDict begin 13 H.A end
 518 459
a 518 459 a
SDict begin [/View [/XYZ H.V]/Dest (0:289) cvn /DEST pdfmark end
 518 459 a Fg(zmq-ctx-new[3])19 b Fj(call.)h(Y)-9
b(ou)20 b(should)f(create)h(and)g(use)g(e)o(xactly)f(one)h(conte)o(xt)f
(in)h(your)f(process.)h(T)-6 b(echnically)h(,)396 566
y(the)20 b(conte)o(xt)f(is)j(the)e(container)e(for)i(all)h(sock)o(ets)f
(in)g(a)h(single)f(process,)g(and)f(acts)i(as)g(the)f(transport)f(for)
3385 566 y
SDict begin H.S end
 3385 566 a 3385 566 a
SDict begin 13 H.A end
 3385 566 a 3385 566
a
SDict begin [/View [/XYZ H.V]/Dest (0:290) cvn /DEST pdfmark end
 3385 566 a Fg(inproc)396 674 y Fj(sock)o(ets,)h(which)g(are)g(the)g
(f)o(astest)h(w)o(ay)g(to)f(connect)f(threads)g(in)i(one)e(process.)h
(If)g(at)h(runtime)e(a)h(process)g(has)g(tw)o(o)396 782
y(conte)o(xts,)f(these)i(are)f(lik)o(e)g(separate)g(\330MQ)g
(instances.)g(If)g(that')-5 b(s)21 b(e)o(xplicitly)e(what)h(you)g(w)o
(ant,)g(OK,)g(b)n(ut)g(otherwise)396 890 y(remember:)-2
1057 y
SDict begin H.S end
 -2 1057 a -2 1057 a
SDict begin 13 H.A end
 -2 1057 a -2 1057 a
SDict begin [/View [/XYZ H.V]/Dest (0:291) cvn /DEST pdfmark end
 -2 1057
a -2 1057 a
SDict begin H.S end
 -2 1057 a -2 1057 a
SDict begin 13 H.A end
 -2 1057 a -2 1057 a
SDict begin [/View [/XYZ H.V]/Dest (0:292) cvn /DEST pdfmark end
 -2
1057 a 396 1164 a Fk(Do)g(one)664 1164 y
SDict begin H.S end
 664 1164 a 664
1164 a
SDict begin 13 H.A end
 664 1164 a 664 1164 a
SDict begin [/View [/XYZ H.V]/Dest (0:293) cvn /DEST pdfmark end
 664 1164 a Fc(zmq-ctx-new[3])e
Fk(at)i(the)g(start)g(of)g(y)n(our)g(main)h(line)f(code,)g(and)h(one)
2848 1164 y
SDict begin H.S end
 2848 1164 a 2848 1164 a
SDict begin 13 H.A end
 2848 1164 a 2848
1164 a
SDict begin [/View [/XYZ H.V]/Dest (0:294) cvn /DEST pdfmark end
 2848 1164 a Fc(zmq-ctx-destroy[3])d Fk(at)i(the)396
1272 y(end.)-2 1439 y
SDict begin H.S end
 -2 1439 a -2 1439 a
SDict begin 13 H.A end
 -2 1439 a -2
1439 a
SDict begin [/View [/XYZ H.V]/Dest (0:295) cvn /DEST pdfmark end
 -2 1439 a 396 1546 a Fj(If)g(you')l(re)f(using)g(the)1028
1546 y
SDict begin H.S end
 1028 1546 a 1028 1546 a
SDict begin 13 H.A end
 1028 1546 a 1028 1546
a
SDict begin [/View [/XYZ H.V]/Dest (0:296) cvn /DEST pdfmark end
 1028 1546 a Fg(fork\(\))h Fj(system)h(call,)f(each)g(process)g(needs)
f(its)j(o)n(wn)d(conte)o(xt.)g(If)h(you)f(do)3254 1546
y
SDict begin H.S end
 3254 1546 a 3254 1546 a
SDict begin 13 H.A end
 3254 1546 a 3254 1546 a
SDict begin [/View [/XYZ H.V]/Dest (0:297) cvn /DEST pdfmark end
 3254
1546 a Fg(zmq-ctx-new[3])396 1654 y Fj(in)i(the)f(main)g(process)f
(before)g(calling)1540 1654 y
SDict begin H.S end
 1540 1654 a 1540 1654 a
SDict begin 13 H.A end

1540 1654 a 1540 1654 a
SDict begin [/View [/XYZ H.V]/Dest (0:298) cvn /DEST pdfmark end
 1540 1654 a Fg(fork\(\))p Fj(,)g(the)i(child)e
(processes)h(get)g(their)g(o)n(wn)g(conte)o(xts.)f(In)h(general)f(you)
396 1762 y(w)o(ant)i(to)f(do)g(the)g(interesting)f(stuf)n(f)h(in)g(the)
h(child)e(processes,)h(and)g(just)g(manage)f(these)i(from)e(the)h
(parent)f(process.)-2 1790 y
SDict begin H.S end
 -2 1790 a -2 1790 a
SDict begin 13 H.A end
 -2 1790
a -2 1790 a
SDict begin [/View [/XYZ H.V]/Dest (0:299) cvn /DEST pdfmark end
 -2 1790 a 396 2100 a Fd(1.9.2.)36 b(Making)e(a)f(Clean)i
(Exit)1851 2100 y
SDict begin H.S end
 1851 2100 a 1851 2100 a
SDict begin 18.72 H.A end
 1851 2100 a
1851 2100 a
SDict begin [/View [/XYZ H.V]/Dest (6.14.2.2) cvn /DEST pdfmark end
 1851 2100 a -2 2293 a
SDict begin H.S end
 -2 2293 a -2 2293 a
SDict begin 13 H.A end

-2 2293 a -2 2293 a
SDict begin [/View [/XYZ H.V]/Dest (0:301) cvn /DEST pdfmark end
 -2 2293 a 396 2374 a Fj(Classy)21
b(programmers)d(share)i(the)g(same)g(motto)g(as)h(classy)f(hit)h(men:)f
(al)o(w)o(ays)g(clean-up)f(when)g(you)h(\002nish)g(the)g(job)m(.)396
2482 y(When)g(you)g(use)g(\330MQ)g(in)h(a)f(language)f(lik)o(e)h
(Python,)f(stuf)n(f)h(gets)g(automatically)f(freed)g(for)h(you.)f(But)i
(when)e(using)h(C)396 2590 y(you)g(ha)n(v)o(e)f(to)h(carefully)f(free)h
(objects)g(when)g(you')l(re)e(\002nished)i(with)g(them,)g(or)f(you)h
(get)g(memory)e(leaks,)i(unstable)396 2698 y(applications,)f(and)h
(generally)e(bad)i(karma.)-2 2882 y
SDict begin H.S end
 -2 2882 a -2 2882
a
SDict begin 13 H.A end
 -2 2882 a -2 2882 a
SDict begin [/View [/XYZ H.V]/Dest (0:302) cvn /DEST pdfmark end
 -2 2882 a 396 2972 a Fj(Memory)f(leaks)h(are)g
(one)g(thing,)f(b)n(ut)h(\330MQ)h(is)g(quite)f(\002nick)o(y)f(about)g
(ho)n(w)h(you)f(e)o(xit)h(an)g(application.)f(The)h(reasons)396
3080 y(are)g(technical)f(and)g(painful)f(b)n(ut)i(the)g(upshot)e(is)j
(that)e(if)h(you)f(lea)n(v)o(e)h(an)o(y)e(sock)o(ets)i(open,)f(the)3076
3080 y
SDict begin H.S end
 3076 3080 a 3076 3080 a
SDict begin 13 H.A end
 3076 3080 a 3076 3080
a
SDict begin [/View [/XYZ H.V]/Dest (0:303) cvn /DEST pdfmark end
 3076 3080 a Fg(zmq-ctx-destroy[3])396 3188 y Fj(function)g(will)i
(hang)e(fore)n(v)o(er)-5 b(.)18 b(And)i(e)n(v)o(en)f(if)i(you)e(close)h
(all)h(sock)o(ets,)2434 3188 y
SDict begin H.S end
 2434 3188 a 2434 3188
a
SDict begin 13 H.A end
 2434 3188 a 2434 3188 a
SDict begin [/View [/XYZ H.V]/Dest (0:304) cvn /DEST pdfmark end
 2434 3188 a Fg(zmq-ctx-destroy[3])d
Fj(will)j(by)e(def)o(ault)396 3296 y(w)o(ait)i(fore)n(v)o(er)d(if)j
(there)e(are)i(pending)d(connects)h(or)h(sends.)g(Unless)h(you)e(set)i
(the)f(LINGER)g(to)h(zero)e(on)h(those)g(sock)o(ets)396
3404 y(before)f(closing)h(them.)-2 3588 y
SDict begin H.S end
 -2 3588 a -2
3588 a
SDict begin 13 H.A end
 -2 3588 a -2 3588 a
SDict begin [/View [/XYZ H.V]/Dest (0:305) cvn /DEST pdfmark end
 -2 3588 a 396 3678 a Fj(The)g(\330MQ)h
(objects)f(we)g(need)g(to)g(w)o(orry)f(about)g(are)h(messages,)h(sock)o
(ets,)f(and)f(conte)o(xts.)g(Luckily)g(it')-5 b(s)22
b(quite)d(simple,)396 3786 y(at)i(least)g(in)f(simple)g(programs:)-2
3804 y
SDict begin H.S end
 -2 3804 a -2 3804 a
SDict begin 13 H.A end
 -2 3804 a -2 3804 a
SDict begin [/View [/XYZ H.V]/Dest (0:306) cvn /DEST pdfmark end
 -2 3804
a -2 3814 a
SDict begin H.S end
 -2 3814 a -2 3814 a
SDict begin 13 H.A end
 -2 3814 a -2 3814 a
SDict begin [/View [/XYZ H.V]/Dest (0:307) cvn /DEST pdfmark end
 -2
3814 a Black 396 3956 a Fe(\225)p Black 479 3956 a
SDict begin H.S end
 479
3956 a 479 3956 a
SDict begin 13 H.A end
 479 3956 a 479 3956 a
SDict begin [/View [/XYZ H.V]/Dest (0:308) cvn /DEST pdfmark end
 479 3956 a Fj(Al)o(w)o(ays)h
(close)f(a)h(message)f(the)g(moment)f(you)g(are)i(done)e(with)h(it,)h
(using)2624 3956 y
SDict begin H.S end
 2624 3956 a 2624 3956 a
SDict begin 13 H.A end
 2624 3956
a 2624 3956 a
SDict begin [/View [/XYZ H.V]/Dest (0:309) cvn /DEST pdfmark end
 2624 3956 a Fg(zmq-msg-close[3])p Fj(.)-2
3974 y
SDict begin H.S end
 -2 3974 a -2 3974 a
SDict begin 13 H.A end
 -2 3974 a -2 3974 a
SDict begin [/View [/XYZ H.V]/Dest (0:310) cvn /DEST pdfmark end
 -2 3974
a Black 396 4105 a Fe(\225)p Black 479 4105 a
SDict begin H.S end
 479 4105
a 479 4105 a
SDict begin 13 H.A end
 479 4105 a 479 4105 a
SDict begin [/View [/XYZ H.V]/Dest (0:311) cvn /DEST pdfmark end
 479 4105 a Fj(If)f(you)g(are)g
(opening)e(and)i(closing)f(a)i(lot)f(of)g(sock)o(ets,)g(that')-5
b(s)21 b(probably)d(a)i(sign)h(you)e(need)g(to)i(redesign)e(your)479
4213 y(application.)-2 4231 y
SDict begin H.S end
 -2 4231 a -2 4231 a
SDict begin 13 H.A end
 -2
4231 a -2 4231 a
SDict begin [/View [/XYZ H.V]/Dest (0:312) cvn /DEST pdfmark end
 -2 4231 a Black 396 4363 a Fe(\225)p
Black 479 4363 a
SDict begin H.S end
 479 4363 a 479 4363 a
SDict begin 13 H.A end
 479 4363 a 479
4363 a
SDict begin [/View [/XYZ H.V]/Dest (0:313) cvn /DEST pdfmark end
 479 4363 a Fj(When)h(you)g(e)o(xit)g(the)g(program,)e(close)i
(your)f(sock)o(ets)h(and)g(then)g(call)2506 4363 y
SDict begin H.S end
 2506
4363 a 2506 4363 a
SDict begin 13 H.A end
 2506 4363 a 2506 4363 a
SDict begin [/View [/XYZ H.V]/Dest (0:314) cvn /DEST pdfmark end
 2506 4363
a Fg(zmq-ctx-destroy[3])p Fj(.)e(This)i(destro)o(ys)479
4471 y(the)g(conte)o(xt.)-2 4638 y
SDict begin H.S end
 -2 4638 a -2 4638
a
SDict begin 13 H.A end
 -2 4638 a -2 4638 a
SDict begin [/View [/XYZ H.V]/Dest (0:315) cvn /DEST pdfmark end
 -2 4638 a 396 4745 a Fj(This)h(is)g(at)f(least)h
(for)f(C)h(de)n(v)o(elopment.)c(In)j(a)h(language)d(with)j(automatic)e
(object)g(destruction,)g(sock)o(ets)h(and)g(conte)o(xts)396
4853 y(will)h(be)f(destro)o(yed)f(as)i(you)e(lea)n(v)o(e)h(the)g
(scope.)g(If)g(you)f(use)i(e)o(xceptions)d(you')o(ll)i(ha)n(v)o(e)f(to)
i(do)e(the)i(clean-up)d(in)396 4961 y(something)h(lik)o(e)h(a)h
("\002nal")f(block,)f(the)h(same)h(as)g(for)e(an)o(y)h(resource.)p
Black 3800 5569 a Fi(21)p Black eop end
%%Page: 22 36
TeXDict begin 22 35 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.22) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:316) cvn /DEST pdfmark end
 -2 -11 a
396 72 a Fj(If)g(you')l(re)f(doing)f(multithreaded)g(w)o(ork,)i(it)h
(gets)f(rather)f(more)h(comple)o(x)e(than)i(this.)g(W)-7
b(e')o(ll)22 b(get)e(to)g(multithreading)e(in)396 180
y(the)i(ne)o(xt)g(chapter)m(,)e(b)n(ut)j(because)e(some)h(of)g(you)f
(will,)i(despite)f(w)o(arnings,)f(will)i(try)f(to)g(run)g(before)f(you)
g(can)h(safely)396 288 y(w)o(alk,)g(belo)n(w)g(is)h(the)f(quick)f(and)h
(dirty)g(guide)f(to)h(making)f(a)i(clean)f(e)o(xit)g(in)g(a)2643
288 y
SDict begin H.S end
 2643 288 a 2643 288 a
SDict begin 13 H.A end
 2643 288 a 2643 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:317) cvn /DEST pdfmark end
 2643
288 a Fi(multithr)m(eaded)g Fj(\330MQ)h(application.)-2
472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end
 -2 472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:318) cvn /DEST pdfmark end
 -2 472 a 396
562 a Fj(First,)g(do)f(not)g(try)g(to)g(use)g(the)h(same)f(sock)o(et)g
(from)f(multiple)h(threads.)f(No,)h(don')o(t)e(e)o(xplain)h(why)h(you)f
(think)g(this)396 670 y(w)o(ould)h(be)g(e)o(xcellent)f(fun,)g(just)i
(please)f(don')o(t)f(do)h(it.)g(Ne)o(xt,)g(you)f(need)h(to)g(shut)g(do)
n(wn)f(each)h(sock)o(et)g(that)g(has)h(ongoing)396 778
y(requests.)f(The)g(proper)e(w)o(ay)i(is)h(to)g(set)g(a)f(lo)n(w)h
(LINGER)f(v)n(alue)f(\(1)h(second\),)f(then)h(close)g(the)g(sock)o(et.)
g(If)g(your)396 886 y(language)f(binding)f(doesn')o(t)g(do)i(this)g
(for)g(you)f(automatically)f(when)i(you)f(destro)o(y)g(a)h(conte)o(xt,)
f(I')l(d)g(suggest)h(sending)e(a)396 994 y(patch.)-2
1178 y
SDict begin H.S end
 -2 1178 a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:319) cvn /DEST pdfmark end
 -2 1178
a 396 1268 a Fj(Finally)-5 b(,)20 b(destro)o(y)f(the)h(conte)o(xt.)f
(This)h(will)h(cause)f(an)o(y)g(blocking)e(recei)n(v)o(es)h(or)h(polls)
h(or)f(sends)g(in)g(attached)f(threads)396 1376 y(\(i.e.)h(which)g
(share)g(the)g(same)g(conte)o(xt\))f(to)h(return)f(with)i(an)f(error)-5
b(.)19 b(Catch)h(that)h(error)m(,)d(and)i(then)g(set)h(linger)e(on,)h
(and)396 1484 y(close)h(sock)o(ets)f(in)937 1484 y
SDict begin H.S end
 937
1484 a 937 1484 a
SDict begin 13 H.A end
 937 1484 a 937 1484 a
SDict begin [/View [/XYZ H.V]/Dest (0:320) cvn /DEST pdfmark end
 937 1484 a Fi(that)i
Fj(thread,)d(and)g(e)o(xit.)h(Do)g(not)g(destro)o(y)g(the)g(same)g
(conte)o(xt)f(twice.)h(The)g(zmq-ctx-destro)o(y)d(in)k(the)396
1592 y(main)f(thread)f(will)i(block)e(until)h(all)h(sock)o(ets)g(it)f
(kno)n(ws)g(about)f(are)h(safely)g(closed.)-2 1776 y
SDict begin H.S end

-2 1776 a -2 1776 a
SDict begin 13 H.A end
 -2 1776 a -2 1776 a
SDict begin [/View [/XYZ H.V]/Dest (0:321) cvn /DEST pdfmark end
 -2 1776 a 396
1866 a Fj(V)-11 b(oila!)20 b(It')-5 b(s)21 b(comple)o(x)e(and)g
(painful)g(enough)f(that)j(an)o(y)e(language)g(binding)f(author)h(w)o
(orth)h(his)g(or)g(her)g(salt)h(will)g(do)f(this)396
1974 y(automatically)f(and)h(mak)o(e)f(the)i(sock)o(et)f(closing)f
(dance)h(unnecessary)-5 b(.)-2 2085 y
SDict begin H.S end
 -2 2085 a -2 2085
a
SDict begin 13 H.A end
 -2 2085 a -2 2085 a
SDict begin [/View [/XYZ H.V]/Dest (0:322) cvn /DEST pdfmark end
 -2 2085 a 359 x Fh(1.10.)39 b(Wh)m(y)h(W)-5
b(e)40 b(Needed)e(\330MQ)1849 2444 y
SDict begin H.S end
 1849 2444 a 1849
2444 a
SDict begin 22.464 H.A end
 1849 2444 a 1849 2444 a
SDict begin [/View [/XYZ H.V]/Dest (6.15.1) cvn /DEST pdfmark end
 1849 2444 a -2 2640 a
SDict begin H.S end

-2 2640 a -2 2640 a
SDict begin 13 H.A end
 -2 2640 a -2 2640 a
SDict begin [/View [/XYZ H.V]/Dest (0:324) cvn /DEST pdfmark end
 -2 2640 a 396
2718 a Fj(No)n(w)20 b(that)h(you')l(v)o(e)d(seen)i(\330MQ)g(in)h
(action,)e(let')-5 b(s)21 b(go)f(back)f(to)i(the)f("why".)-2
2902 y
SDict begin H.S end
 -2 2902 a -2 2902 a
SDict begin 13 H.A end
 -2 2902 a -2 2902 a
SDict begin [/View [/XYZ H.V]/Dest (0:325) cvn /DEST pdfmark end
 -2 2902
a 396 2992 a Fj(Man)o(y)f(applications)g(these)i(days)f(consist)g(of)g
(components)e(that)i(stretch)g(across)h(some)f(kind)f(of)h(netw)o(ork,)
f(either)g(a)396 3100 y(LAN)i(or)f(the)g(Internet.)e(So)j(man)o(y)e
(application)g(de)n(v)o(elopers)f(end)h(up)h(doing)f(some)h(kind)f(of)h
(messaging.)f(Some)396 3208 y(de)n(v)o(elopers)f(use)i(message)f
(queuing)f(products,)f(b)n(ut)j(most)f(of)h(the)f(time)h(the)o(y)f(do)g
(it)h(themselv)o(es,)f(using)g(TCP)h(or)g(UDP)-9 b(.)396
3316 y(These)20 b(protocols)f(are)g(not)h(hard)f(to)h(use,)g(b)n(ut)g
(there)g(is)g(a)h(great)e(dif)n(ference)f(between)h(sending)g(a)i(fe)n
(w)e(bytes)h(from)f(A)i(to)396 3424 y(B,)g(and)f(doing)f(messaging)g
(in)h(an)o(y)g(kind)f(of)h(reliable)g(w)o(ay)-5 b(.)-2
3608 y
SDict begin H.S end
 -2 3608 a -2 3608 a
SDict begin 13 H.A end
 -2 3608 a -2 3608 a
SDict begin [/View [/XYZ H.V]/Dest (0:326) cvn /DEST pdfmark end
 -2 3608
a 396 3698 a Fj(Let')g(s)21 b(look)e(at)i(the)f(typical)g(problems)f
(we)h(f)o(ace)h(when)e(we)i(start)f(to)h(connect)e(pieces)h(using)g(ra)
o(w)g(TCP)-9 b(.)20 b(An)o(y)g(reusable)396 3806 y(messaging)g(layer)f
(w)o(ould)h(need)f(to)i(solv)o(e)e(all)i(or)f(most)g(these:)-2
3824 y
SDict begin H.S end
 -2 3824 a -2 3824 a
SDict begin 13 H.A end
 -2 3824 a -2 3824 a
SDict begin [/View [/XYZ H.V]/Dest (0:327) cvn /DEST pdfmark end
 -2 3824
a -2 3834 a
SDict begin H.S end
 -2 3834 a -2 3834 a
SDict begin 13 H.A end
 -2 3834 a -2 3834 a
SDict begin [/View [/XYZ H.V]/Dest (0:328) cvn /DEST pdfmark end
 -2
3834 a Black 396 3976 a Fe(\225)p Black 479 3976 a
SDict begin H.S end
 479
3976 a 479 3976 a
SDict begin 13 H.A end
 479 3976 a 479 3976 a
SDict begin [/View [/XYZ H.V]/Dest (0:329) cvn /DEST pdfmark end
 479 3976 a Fj(Ho)n(w)g(do)g(we)
h(handle)e(I/O?)h(Does)g(our)g(application)f(block,)g(or)g(do)h(we)h
(handle)e(I/O)h(in)h(the)f(background?)c(This)21 b(is)g(a)479
4084 y(k)o(e)o(y)f(design)f(decision.)h(Blocking)f(I/O)h(creates)g
(architectures)f(that)i(do)e(not)h(scale)h(well.)f(But)h(background)c
(I/O)j(can)479 4192 y(be)g(v)o(ery)f(hard)h(to)g(do)g(right.)-2
4210 y
SDict begin H.S end
 -2 4210 a -2 4210 a
SDict begin 13 H.A end
 -2 4210 a -2 4210 a
SDict begin [/View [/XYZ H.V]/Dest (0:330) cvn /DEST pdfmark end
 -2 4210
a Black 396 4341 a Fe(\225)p Black 479 4341 a
SDict begin H.S end
 479 4341
a 479 4341 a
SDict begin 13 H.A end
 479 4341 a 479 4341 a
SDict begin [/View [/XYZ H.V]/Dest (0:331) cvn /DEST pdfmark end
 479 4341 a Fj(Ho)n(w)g(do)g(we)h
(handle)e(dynamic)f(components,)g(i.e.)i(pieces)h(that)f(go)g(a)o(w)o
(ay)g(temporarily?)e(Do)i(we)g(formally)f(split)479 4449
y(components)f(into)i("clients")g(and)g("serv)o(ers")f(and)h(mandate)f
(that)h(serv)o(ers)g(cannot)f(disappear?)g(What)i(then)e(if)i(we)479
4557 y(w)o(ant)g(to)f(connect)f(serv)o(ers)h(to)g(serv)o(ers?)f(Do)i
(we)f(try)g(to)g(reconnect)f(e)n(v)o(ery)g(fe)n(w)h(seconds?)-2
4575 y
SDict begin H.S end
 -2 4575 a -2 4575 a
SDict begin 13 H.A end
 -2 4575 a -2 4575 a
SDict begin [/View [/XYZ H.V]/Dest (0:332) cvn /DEST pdfmark end
 -2 4575
a Black 396 4707 a Fe(\225)p Black 479 4707 a
SDict begin H.S end
 479 4707
a 479 4707 a
SDict begin 13 H.A end
 479 4707 a 479 4707 a
SDict begin [/View [/XYZ H.V]/Dest (0:333) cvn /DEST pdfmark end
 479 4707 a Fj(Ho)n(w)g(do)f(we)h
(represent)f(a)h(message)g(on)f(the)h(wire?)g(Ho)n(w)f(do)h(we)g(frame)
f(data)h(so)g(it')-5 b(s)21 b(easy)e(to)h(write)g(and)g(read,)f(safe)
479 4814 y(from)g(b)n(uf)n(fer)g(o)o(v)o(er\003o)n(ws,)f(ef)n
(\002cient)i(for)f(small)i(messages,)f(yet)g(adequate)e(for)i(the)g(v)o
(ery)f(lar)o(gest)g(videos)h(of)f(dancing)479 4922 y(cats)i(wearing)e
(party)h(hats?)-2 4940 y
SDict begin H.S end
 -2 4940 a -2 4940 a
SDict begin 13 H.A end
 -2 4940
a -2 4940 a
SDict begin [/View [/XYZ H.V]/Dest (0:334) cvn /DEST pdfmark end
 -2 4940 a Black 3800 5569 a Fi(22)p Black
eop end
%%Page: 23 37
TeXDict begin 23 36 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.23) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:360) cvn /DEST pdfmark end
 -2 -201 a 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:335) cvn /DEST pdfmark end
 479 72 a Fj(Ho)n(w)g(do)g(we)h(handle)e
(messages)h(that)g(we)h(can')o(t)e(deli)n(v)o(er)g(immediately?)g(P)o
(articularly)-5 b(,)18 b(if)j(we')l(re)e(w)o(aiting)h(for)g(a)479
180 y(component)e(to)i(come)g(back)f(on-line?)g(Do)h(we)h(discard)f
(messages,)g(put)f(them)h(into)g(a)h(database,)e(or)h(into)g(a)479
288 y(memory)f(queue?)-2 306 y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2 306
a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:336) cvn /DEST pdfmark end
 -2 306 a Black 396 438 a Fe(\225)p Black 479
438 a
SDict begin H.S end
 479 438 a 479 438 a
SDict begin 13 H.A end
 479 438 a 479 438 a
SDict begin [/View [/XYZ H.V]/Dest (0:337) cvn /DEST pdfmark end
 479 438
a Fj(Where)h(do)g(we)h(store)f(message)g(queues?)f(What)i(happens)d(if)
j(the)f(component)e(reading)g(from)i(a)g(queue)f(is)i(v)o(ery)479
546 y(slo)n(w)-5 b(,)20 b(and)g(causes)g(our)g(queues)f(to)h(b)n(uild)g
(up?)g(What')-5 b(s)21 b(our)e(strate)o(gy)g(then?)-2
564 y
SDict begin H.S end
 -2 564 a -2 564 a
SDict begin 13 H.A end
 -2 564 a -2 564 a
SDict begin [/View [/XYZ H.V]/Dest (0:338) cvn /DEST pdfmark end
 -2 564 a Black
396 695 a Fe(\225)p Black 479 695 a
SDict begin H.S end
 479 695 a 479 695
a
SDict begin 13 H.A end
 479 695 a 479 695 a
SDict begin [/View [/XYZ H.V]/Dest (0:339) cvn /DEST pdfmark end
 479 695 a Fj(Ho)n(w)h(do)g(we)h(handle)e(lost)i
(messages?)f(Do)g(we)g(w)o(ait)h(for)f(fresh)g(data,)f(request)h(a)h
(resend,)e(or)h(do)f(we)i(b)n(uild)f(some)479 803 y(kind)g(of)g
(reliability)f(layer)h(that)g(ensures)g(messages)g(cannot)f(be)h(lost?)
h(What)g(if)f(that)g(layer)g(itself)h(crashes?)-2 821
y
SDict begin H.S end
 -2 821 a -2 821 a
SDict begin 13 H.A end
 -2 821 a -2 821 a
SDict begin [/View [/XYZ H.V]/Dest (0:340) cvn /DEST pdfmark end
 -2 821 a Black
396 953 a Fe(\225)p Black 479 953 a
SDict begin H.S end
 479 953 a 479 953
a
SDict begin 13 H.A end
 479 953 a 479 953 a
SDict begin [/View [/XYZ H.V]/Dest (0:341) cvn /DEST pdfmark end
 479 953 a Fj(What)g(if)f(we)h(need)e(to)i(use)f
(a)h(dif)n(ferent)d(netw)o(ork)h(transport.)g(Say)-5
b(,)20 b(multicast)g(instead)g(of)g(TCP)h(unicast?)e(Or)i(IPv6?)479
1060 y(Do)f(we)h(need)f(to)g(re)n(write)g(the)g(applications,)f(or)h
(is)h(the)f(transport)f(abstracted)g(in)h(some)g(layer?)-2
1078 y
SDict begin H.S end
 -2 1078 a -2 1078 a
SDict begin 13 H.A end
 -2 1078 a -2 1078 a
SDict begin [/View [/XYZ H.V]/Dest (0:342) cvn /DEST pdfmark end
 -2 1078
a Black 396 1210 a Fe(\225)p Black 479 1210 a
SDict begin H.S end
 479 1210
a 479 1210 a
SDict begin 13 H.A end
 479 1210 a 479 1210 a
SDict begin [/View [/XYZ H.V]/Dest (0:343) cvn /DEST pdfmark end
 479 1210 a Fj(Ho)n(w)g(do)g(we)h
(route)e(messages?)h(Can)h(we)f(send)g(the)g(same)h(message)f(to)g
(multiple)g(peers?)g(Can)g(we)h(send)f(replies)479 1318
y(back)g(to)g(an)g(original)f(requester?)-2 1336 y
SDict begin H.S end
 -2
1336 a -2 1336 a
SDict begin 13 H.A end
 -2 1336 a -2 1336 a
SDict begin [/View [/XYZ H.V]/Dest (0:344) cvn /DEST pdfmark end
 -2 1336 a Black
396 1467 a Fe(\225)p Black 479 1467 a
SDict begin H.S end
 479 1467 a 479
1467 a
SDict begin 13 H.A end
 479 1467 a 479 1467 a
SDict begin [/View [/XYZ H.V]/Dest (0:345) cvn /DEST pdfmark end
 479 1467 a Fj(Ho)n(w)h(do)g(we)h(write)f
(an)g(API)h(for)e(another)g(language?)f(Do)j(we)f(re-implement)e(a)j
(wire-le)n(v)o(el)e(protocol)f(or)i(do)g(we)479 1575
y(repackage)f(a)h(library?)f(If)h(the)g(former)m(,)e(ho)n(w)i(can)g(we)
h(guarantee)d(ef)n(\002cient)i(and)f(stable)i(stacks?)f(If)g(the)h
(latter)m(,)e(ho)n(w)479 1683 y(can)h(we)h(guarantee)d
(interoperability?)-2 1701 y
SDict begin H.S end
 -2 1701 a -2 1701 a
SDict begin 13 H.A end
 -2 1701
a -2 1701 a
SDict begin [/View [/XYZ H.V]/Dest (0:346) cvn /DEST pdfmark end
 -2 1701 a Black 396 1833 a Fe(\225)p Black
479 1833 a
SDict begin H.S end
 479 1833 a 479 1833 a
SDict begin 13 H.A end
 479 1833 a 479 1833
a
SDict begin [/View [/XYZ H.V]/Dest (0:347) cvn /DEST pdfmark end
 479 1833 a Fj(Ho)n(w)i(do)g(we)h(represent)e(data)h(so)g(that)h(it)g
(can)f(be)g(read)f(between)h(dif)n(ferent)e(architectures?)h(Do)h(we)h
(enforce)d(a)479 1940 y(particular)h(encoding)e(for)i(data)h(types?)f
(Ho)n(w)g(f)o(ar)h(is)h(this)f(the)f(job)h(of)f(the)h(messaging)e
(system)i(rather)f(than)g(a)h(higher)479 2048 y(layer?)-2
2066 y
SDict begin H.S end
 -2 2066 a -2 2066 a
SDict begin 13 H.A end
 -2 2066 a -2 2066 a
SDict begin [/View [/XYZ H.V]/Dest (0:348) cvn /DEST pdfmark end
 -2 2066
a Black 396 2198 a Fe(\225)p Black 479 2198 a
SDict begin H.S end
 479 2198
a 479 2198 a
SDict begin 13 H.A end
 479 2198 a 479 2198 a
SDict begin [/View [/XYZ H.V]/Dest (0:349) cvn /DEST pdfmark end
 479 2198 a Fj(Ho)n(w)g(do)g(we)h
(handle)e(netw)o(ork)g(errors?)g(Do)h(we)h(w)o(ait)g(and)e(retry)-5
b(,)19 b(ignore)g(them)h(silently)-5 b(,)19 b(or)h(abort?)-2
2382 y
SDict begin H.S end
 -2 2382 a -2 2382 a
SDict begin 13 H.A end
 -2 2382 a -2 2382 a
SDict begin [/View [/XYZ H.V]/Dest (0:350) cvn /DEST pdfmark end
 -2 2382
a 396 2472 a Fj(T)-7 b(ak)o(e)21 b(a)f(typical)g(open)f(source)g
(project)h(lik)o(e)1695 2472 y
SDict begin H.S end
 1695 2472 a 1695 2472
a
SDict begin 13 H.A end
 1695 2472 a 1695 2472 a
SDict begin [/View [/XYZ H.V]/Dest (0:351) cvn /DEST pdfmark end
 1695 2472 a Fj(Hadoop)f(Zook)o(eeper)f
(\(http://hadoop.apache.or)n(g)o(/zoo)o(k)o(eep)o(er/\))c(and)396
2580 y(read)20 b(the)g(C)h(API)g(code)e(in)1176 2580
y
SDict begin H.S end
 1176 2580 a 1176 2580 a
SDict begin 13 H.A end
 1176 2580 a 1176 2580 a
SDict begin [/View [/XYZ H.V]/Dest (0:352) cvn /DEST pdfmark end
 1176
2580 a Fj(src/c/src/zook)o(eeper)-5 b(.c)396 2688 y(\(http://github)m
(.com/apache/zoo)o(k)o(eep)o(er/b)o(lob/tr)o(un)o(k/src/c/src/zo)o(ok)n
(eep)o(er)g(.c\).)14 b(As)21 b(I)g(write)f(this,)g(in)h(2010,)d(the)j
(code)396 2796 y(is)g(3,200)e(lines)i(of)e(mystery)h(and)f(in)i(there)e
(is)j(an)e(undocumented,)c(client-serv)o(er)i(netw)o(ork)h
(communication)396 2904 y(protocol.)f(I)j(see)g(it')-5
b(s)21 b(ef)n(\002cient)f(because)f(it)i(uses)g(poll\(\))e(instead)h
(of)g(select\(\).)g(But)g(really)-5 b(,)20 b(Zook)o(eeper)e(should)h
(be)396 3011 y(using)h(a)h(generic)e(messaging)g(layer)h(and)f(an)h(e)o
(xplicitly)g(documented)d(wire)j(le)n(v)o(el)g(protocol.)e(It)j(is)g
(incredibly)396 3119 y(w)o(asteful)f(for)g(teams)g(to)h(be)f(b)n
(uilding)f(this)i(particular)d(wheel)i(o)o(v)o(er)f(and)h(o)o(v)o(er)-5
b(.)-2 3303 y
SDict begin H.S end
 -2 3303 a -2 3303 a
SDict begin 13 H.A end
 -2 3303 a -2 3303 a
SDict begin [/View [/XYZ H.V]/Dest (0:353) cvn /DEST pdfmark end

-2 3303 a 396 3393 a Fj(But)21 b(ho)n(w)f(to)g(mak)o(e)g(a)g(reusable)g
(messaging)f(layer?)h(Why)-5 b(,)19 b(when)g(so)i(man)o(y)e(projects)g
(need)h(this)h(technology)-5 b(,)17 b(are)396 3501 y(people)i(still)j
(doing)d(it)i(the)f(hard)f(w)o(ay)-5 b(,)20 b(by)f(dri)n(ving)g(TCP)i
(sock)o(ets)f(in)h(their)f(code,)f(and)g(solving)h(the)g(problems)f(in)
h(that)396 3609 y(long)g(list,)h(o)o(v)o(er)d(and)i(o)o(v)o(er\()p
0 TeXcolorgray 1189 3609 a
SDict begin H.S end
 1189 3609 a Fj(Figure)d(1-7)1536
3609 y
SDict begin 13 H.L end
 1536 3609 a 1536 3609 a
SDict begin [/Subtype /Link/Dest (0:figure-7) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1536 3609 a Black -1 w
Fj(\)?)-2 3627 y
SDict begin H.S end
 -2 3627 a -2 3627 a
SDict begin 13 H.A end
 -2 3627 a -2 3627
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-7) cvn /DEST pdfmark end
 -2 3627 a Black 3800 5569 a Fi(23)p Black eop end
%%Page: 24 38
TeXDict begin 24 37 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.24) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
396 72 a Fk(Figur)o(e)g(1-7.)f(Messaging)h(as)h(it)f(Starts)-2
172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:357) cvn /DEST pdfmark end
 -2 172 a 396
2431 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2431 a @beginspecial 0 @llx -266 @lly 180
@urx 0 @ury 1800 @rwi @setspecial
%%BeginDocument: images/fig7.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -266 180 0
%%HiResBoundingBox: 0.0 -266.0 180.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -94.00029754638672 lineto
158.00030517578125 -94.00029754638672 lineto
158.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -178.00030517578125 moveto
28.00029945373535 -234.00030517578125 lineto
158.00030517578125 -234.00030517578125 lineto
158.00030517578125 -178.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -91.0 lineto
155.0 -91.0 lineto
155.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -91.0 lineto
155.0 -91.0 lineto
155.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -175.0 moveto
25.0 -231.0 lineto
155.0 -231.0 lineto
155.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -175.0 moveto
25.0 -231.0 lineto
155.0 -231.0 lineto
155.0 -175.0 lineto
closepath
stroke
newpath
85.0 -105.0 moveto
85.0 -161.0 lineto
stroke
newpath
85.0 -98.0 moveto
80.0 -112.0 lineto
90.0 -112.0 lineto
closepath
fill
newpath
80.0 -154.0 moveto
85.0 -168.0 lineto
90.0 -154.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
55.0 -68.0 moveto
(Piece A) show
71.0 -138.0 moveto
(TCP) show
55.0 -208.0 moveto
(Piece B) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2431 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2431 a 274 x Fj(It)h(turns)f(out)f(that)i
(b)n(uilding)e(reusable)g(messaging)g(systems)i(is)g(really)f(dif)n
(\002cult,)f(which)h(is)h(why)e(fe)n(w)h(FOSS)i(projects)396
2812 y(e)n(v)o(er)e(tried,)f(and)h(why)f(commercial)g(messaging)g
(products)g(are)h(comple)o(x,)e(e)o(xpensi)n(v)o(e,)g(in\003e)o(xible,)
h(and)h(brittle.)g(In)396 2920 y(2006)f(iMatix)h(designed)f(AMQP)i
(\(http://www)-5 b(.amqp.or)o(g\))15 b(which)k(started)i(to)f(gi)n(v)o
(e)f(FOSS)i(de)n(v)o(elopers)e(perhaps)f(the)396 3028
y(\002rst)j(reusable)f(recipe)f(for)h(a)g(messaging)g(system.)g(AMQP)g
(w)o(orks)g(better)g(than)g(man)o(y)f(other)g(designs)3408
3028 y
SDict begin H.S end
 3408 3028 a 3408 3028 a
SDict begin 13 H.A end
 3408 3028 a 3408 3028
a
SDict begin [/View [/XYZ H.V]/Dest (0:362) cvn /DEST pdfmark end
 3408 3028 a Fj(b)n(ut)h(remains)396 3136 y(relati)n(v)o(ely)f(comple)
o(x,)f(e)o(xpensi)n(v)o(e,)g(and)i(brittle)g(\(http://www)-5
b(.imatix.com/articles:whats-wrong-)o(with-a)o(mqp)o(\).)14
b(It)396 3244 y(tak)o(es)21 b(weeks)f(to)g(learn)g(to)g(use,)h(and)e
(months)g(to)i(create)f(stable)g(architectures)f(that)h(don')o(t)f
(crash)h(when)f(things)h(get)396 3352 y(hairy)-5 b(.)-2
3536 y
SDict begin H.S end
 -2 3536 a -2 3536 a
SDict begin 13 H.A end
 -2 3536 a -2 3536 a
SDict begin [/View [/XYZ H.V]/Dest (0:363) cvn /DEST pdfmark end
 -2 3536
a 396 3626 a Fj(Most)21 b(messaging)e(projects,)g(lik)o(e)i(AMQP)-9
b(,)20 b(that)g(try)g(to)h(solv)o(e)e(this)i(long)e(list)j(of)e
(problems)e(in)j(a)f(reusable)g(w)o(ay)g(do)g(so)396
3734 y(by)g(in)m(v)o(enting)e(a)j(ne)n(w)e(concept,)g(the)h("brok)o
(er",)f(that)h(does)g(addressing,)e(routing,)h(and)g(queuing.)f(This)j
(results)f(in)h(a)396 3842 y(client-serv)o(er)e(protocol)f(or)i(a)h
(set)g(of)f(APIs)g(on)g(top)g(of)g(some)g(undocumented)d(protocol,)h
(that)i(let)h(applications)e(speak)396 3950 y(to)i(this)f(brok)o(er)-5
b(.)19 b(Brok)o(ers)h(are)g(an)g(e)o(xcellent)f(thing)h(in)g(reducing)e
(the)j(comple)o(xity)d(of)i(lar)o(ge)f(netw)o(orks.)g(But)i(adding)396
4058 y(brok)o(er)n(-based)d(messaging)h(to)i(a)f(product)f(lik)o(e)h
(Zook)o(eeper)e(w)o(ould)h(mak)o(e)h(it)h(w)o(orse,)f(not)g(better)-5
b(.)20 b(It)g(w)o(ould)g(mean)396 4166 y(adding)f(an)h(additional)f
(big)h(box,)f(and)h(a)g(ne)n(w)g(single)g(point)g(of)g(f)o(ailure.)f(A)
i(brok)o(er)d(rapidly)h(becomes)g(a)i(bottleneck)396
4274 y(and)f(a)h(ne)n(w)f(risk)g(to)g(manage.)f(If)h(the)g(softw)o(are)
g(supports)f(it,)i(we)f(can)g(add)g(a)g(second,)g(third,)f(fourth)g
(brok)o(er)f(and)i(mak)o(e)396 4382 y(some)g(f)o(ail-o)o(v)o(er)f
(scheme.)g(People)h(do)g(this.)g(It)h(creates)f(more)f(mo)o(ving)f
(pieces,)i(more)g(comple)o(xity)-5 b(,)17 b(more)i(things)h(to)396
4489 y(break.)-2 4656 y
SDict begin H.S end
 -2 4656 a -2 4656 a
SDict begin 13 H.A end
 -2 4656 a
-2 4656 a
SDict begin [/View [/XYZ H.V]/Dest (0:364) cvn /DEST pdfmark end
 -2 4656 a 396 4763 a Fj(And)g(a)h(brok)o(er)n(-centric)c
(set-up)j(needs)g(its)h(o)n(wn)e(operations)g(team.)h(Y)-9
b(ou)20 b(literally)g(need)f(to)h(w)o(atch)h(the)f(brok)o(ers)f(day)396
4871 y(and)h(night,)f(and)h(beat)g(them)g(with)g(a)h(stick)f(when)g
(the)o(y)f(start)i(misbeha)n(ving.)d(Y)-9 b(ou)20 b(need)f(box)o(es,)g
(and)h(you)f(need)396 4979 y(backup)g(box)o(es,)g(and)g(you)h(need)f
(people)g(to)i(manage)e(those)h(box)o(es.)f(It)h(is)h(only)f(w)o(orth)f
(doing)g(for)h(lar)o(ge)f(applications)396 5087 y(with)i(man)o(y)e(mo)o
(ving)f(pieces,)i(b)n(uilt)g(by)g(se)n(v)o(eral)g(teams)g(of)g(people,)
f(o)o(v)o(er)f(se)n(v)o(eral)i(years.)p Black 3800 5569
a Fi(24)p Black eop end
%%Page: 25 39
TeXDict begin 25 38 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.25) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:365) cvn /DEST pdfmark end
 -2 -11 a
396 72 a Fj(So)h(small)f(to)h(medium)e(application)f(de)n(v)o(elopers)g
(are)j(trapped.)d(Either)i(the)o(y)f(a)n(v)n(oid)h(netw)o(ork)f
(programming,)d(and)396 180 y(mak)o(e)k(monolithic)f(applications)g
(that)h(do)g(not)f(scale.)i(Or)f(the)o(y)g(jump)f(into)h(netw)o(ork)f
(programming)e(and)j(mak)o(e)396 288 y(brittle,)g(comple)o(x)f
(applications)g(that)h(are)g(hard)f(to)i(maintain.)e(Or)h(the)o(y)f
(bet)i(on)e(a)i(messaging)e(product,)f(and)i(end)g(up)396
396 y(with)h(scalable)f(applications)f(that)h(depend)f(on)g(e)o(xpensi)
n(v)o(e,)f(easily)j(brok)o(en)d(technology)-5 b(.)17
b(There)j(has)g(been)g(no)f(really)396 504 y(good)g(choice,)g(which)h
(is)h(maybe)e(why)g(messaging)h(is)h(lar)o(gely)e(stuck)h(in)g(the)g
(last)h(century)e(and)h(stirs)h(strong)396 612 y(emotions.)e(Ne)o(gati)
n(v)o(e)g(ones)h(for)f(users,)h(gleeful)g(jo)o(y)g(for)f(those)h
(selling)g(support)f(and)h(licenses\()p 0 TeXcolorgray
3195 612 a
SDict begin H.S end
 3195 612 a Fj(Figure)f(1-8)3544 612 y
SDict begin 13 H.L end
 3544
612 a 3544 612 a
SDict begin [/Subtype /Link/Dest (0:figure-8) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3544 612 a Black -1 w Fj(\).)-2 630
y
SDict begin H.S end
 -2 630 a -2 630 a
SDict begin 13 H.A end
 -2 630 a -2 630 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-8) cvn /DEST pdfmark end
 -2 630 a 396 813
a Fk(Figur)o(e)h(1-8.)f(Messaging)h(as)h(it)f(Becomes)-2
913 y
SDict begin H.S end
 -2 913 a -2 913 a
SDict begin 13 H.A end
 -2 913 a -2 913 a
SDict begin [/View [/XYZ H.V]/Dest (0:369) cvn /DEST pdfmark end
 -2 913 a 396
4338 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4338 a @beginspecial 0 @llx -406 @lly 380
@urx 0 @ury 3800 @rwi @setspecial
%%BeginDocument: images/fig8.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -406 380 0
%%HiResBoundingBox: 0.0 -406.0 380.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
108.00029754638672 -38.000301361083984 moveto
108.00029754638672 -80.00029754638672 lineto
148.00030517578125 -80.00029754638672 lineto
148.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
288.00030517578125 -38.000301361083984 moveto
288.00030517578125 -80.00029754638672 lineto
328.00030517578125 -80.00029754638672 lineto
328.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -52.000301361083984 moveto
28.00029945373535 -94.00029754638672 lineto
68.00029754638672 -94.00029754638672 lineto
68.00029754638672 -52.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
188.00030517578125 -52.000301361083984 moveto
188.00030517578125 -94.00029754638672 lineto
228.00030517578125 -94.00029754638672 lineto
228.00030517578125 -52.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
188.00030517578125 -220.00030517578125 moveto
188.00030517578125 -262.00030517578125 lineto
228.00030517578125 -262.00030517578125 lineto
228.00030517578125 -220.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -206.00030517578125 moveto
28.00029945373535 -248.00030517578125 lineto
68.00029754638672 -248.00030517578125 lineto
68.00029754638672 -206.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
108.00029754638672 -206.00030517578125 moveto
108.00029754638672 -248.00030517578125 lineto
148.00030517578125 -248.00030517578125 lineto
148.00030517578125 -206.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -206.00030517578125 moveto
268.00030517578125 -248.00030517578125 lineto
308.00030517578125 -248.00030517578125 lineto
308.00030517578125 -206.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
108.00029754638672 -318.00030517578125 moveto
108.00029754638672 -360.00030517578125 lineto
148.00030517578125 -360.00030517578125 lineto
148.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -318.00030517578125 moveto
268.00030517578125 -360.00030517578125 lineto
308.00030517578125 -360.00030517578125 lineto
308.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -332.00030517578125 moveto
28.00029945373535 -374.00030517578125 lineto
68.00029754638672 -374.00030517578125 lineto
68.00029754638672 -332.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
188.00030517578125 -332.00030517578125 moveto
188.00030517578125 -374.00030517578125 lineto
228.00030517578125 -374.00030517578125 lineto
228.00030517578125 -332.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
105.0 -35.0 moveto
105.0 -77.0 lineto
145.0 -77.0 lineto
145.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
105.0 -35.0 moveto
105.0 -77.0 lineto
145.0 -77.0 lineto
145.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
285.0 -35.0 moveto
285.0 -77.0 lineto
325.0 -77.0 lineto
325.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
285.0 -35.0 moveto
285.0 -77.0 lineto
325.0 -77.0 lineto
325.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -49.0 moveto
25.0 -91.0 lineto
65.0 -91.0 lineto
65.0 -49.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -49.0 moveto
25.0 -91.0 lineto
65.0 -91.0 lineto
65.0 -49.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -49.0 moveto
185.0 -91.0 lineto
225.0 -91.0 lineto
225.0 -49.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -49.0 moveto
185.0 -91.0 lineto
225.0 -91.0 lineto
225.0 -49.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -217.0 moveto
185.0 -259.0 lineto
225.0 -259.0 lineto
225.0 -217.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -217.0 moveto
185.0 -259.0 lineto
225.0 -259.0 lineto
225.0 -217.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -203.0 moveto
25.0 -245.0 lineto
65.0 -245.0 lineto
65.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -203.0 moveto
25.0 -245.0 lineto
65.0 -245.0 lineto
65.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
105.0 -203.0 moveto
105.0 -245.0 lineto
145.0 -245.0 lineto
145.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
105.0 -203.0 moveto
105.0 -245.0 lineto
145.0 -245.0 lineto
145.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -203.0 moveto
265.0 -245.0 lineto
305.0 -245.0 lineto
305.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -203.0 moveto
265.0 -245.0 lineto
305.0 -245.0 lineto
305.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
105.0 -315.0 moveto
105.0 -357.0 lineto
145.0 -357.0 lineto
145.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
105.0 -315.0 moveto
105.0 -357.0 lineto
145.0 -357.0 lineto
145.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -315.0 moveto
265.0 -357.0 lineto
305.0 -357.0 lineto
305.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -315.0 moveto
265.0 -357.0 lineto
305.0 -357.0 lineto
305.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -329.0 moveto
25.0 -371.0 lineto
65.0 -371.0 lineto
65.0 -329.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -329.0 moveto
25.0 -371.0 lineto
65.0 -371.0 lineto
65.0 -329.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -329.0 moveto
185.0 -371.0 lineto
225.0 -371.0 lineto
225.0 -329.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -329.0 moveto
185.0 -371.0 lineto
225.0 -371.0 lineto
225.0 -329.0 lineto
closepath
stroke
newpath
255.0 -28.0 moveto
255.0 -112.0 lineto
stroke
newpath
205.0 -126.0 moveto
205.0 -139.0 lineto
stroke
newpath
255.0 -126.0 moveto
255.0 -139.0 lineto
stroke
newpath
125.0 -154.0 moveto
125.0 -189.0 lineto
stroke
newpath
130.0 -175.0 moveto
200.0 -175.0 lineto
stroke
newpath
290.0 -175.0 moveto
355.0 -175.0 lineto
355.0 -273.0 lineto
335.0 -273.0 lineto
335.0 -343.0 lineto
315.0 -343.0 lineto
stroke
newpath
305.0 -77.0 moveto
305.0 -119.0 lineto
125.0 -119.0 lineto
125.0 -140.0 lineto
stroke
newpath
65.0 -63.0 moveto
95.0 -63.0 lineto
stroke
newpath
45.0 -91.0 moveto
45.0 -147.0 lineto
285.0 -147.0 lineto
285.0 -189.0 lineto
stroke
newpath
205.0 -91.0 moveto
205.0 -111.0 lineto
stroke
newpath
205.0 -154.0 moveto
205.0 -217.0 lineto
stroke
newpath
120.0 -175.0 moveto
45.0 -175.0 lineto
45.0 -203.0 lineto
stroke
newpath
155.0 -343.0 moveto
185.0 -343.0 lineto
stroke
newpath
90.0 -56.0 moveto
100.0 -63.0 lineto
90.0 -70.0 lineto
closepath
fill
newpath
120.0 -182.0 moveto
125.0 -196.0 lineto
130.0 -182.0 lineto
closepath
fill
newpath
280.0 -182.0 moveto
285.0 -196.0 lineto
290.0 -182.0 lineto
closepath
fill
newpath
125.0 -252.0 moveto
120.0 -266.0 lineto
130.0 -266.0 lineto
closepath
fill
newpath
285.0 -252.0 moveto
280.0 -266.0 lineto
290.0 -266.0 lineto
closepath
fill
newpath
205.0 -266.0 moveto
200.0 -280.0 lineto
210.0 -280.0 lineto
closepath
fill
newpath
40.0 -308.0 moveto
45.0 -322.0 lineto
50.0 -308.0 lineto
closepath
fill
newpath
200.0 -308.0 moveto
205.0 -322.0 lineto
210.0 -308.0 lineto
closepath
fill
newpath
160.0 -336.0 moveto
150.0 -343.0 lineto
160.0 -350.0 lineto
closepath
fill
newpath
320.0 -336.0 moveto
310.0 -343.0 lineto
320.0 -350.0 lineto
closepath
fill
newpath
255.0 -161.0 moveto
255.0 -175.0 lineto
stroke
newpath
215.0 -175.0 moveto
255.0 -175.0 lineto
stroke
newpath
275.0 -175.0 moveto
255.0 -175.0 lineto
stroke
newpath
125.0 -259.0 moveto
125.0 -287.0 lineto
stroke
newpath
285.0 -259.0 moveto
285.0 -287.0 lineto
205.0 -287.0 lineto
stroke
newpath
45.0 -315.0 moveto
45.0 -287.0 lineto
125.0 -287.0 lineto
stroke
newpath
125.0 -315.0 moveto
125.0 -287.0 lineto
stroke
newpath
205.0 -315.0 moveto
205.0 -273.0 lineto
stroke
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4338 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4338 a -2 4504 a
SDict begin H.S end
 -2 4504
a -2 4504 a
SDict begin 13 H.A end
 -2 4504 a -2 4504 a
SDict begin [/View [/XYZ H.V]/Dest (0:372) cvn /DEST pdfmark end
 -2 4504 a 396 4612 a
Fj(What)h(we)f(need)g(is)h(something)e(that)h(does)g(the)g(job)g(of)g
(messaging)f(b)n(ut)h(does)g(it)h(in)g(such)f(a)g(simple)g(and)g(cheap)
f(w)o(ay)396 4720 y(that)i(it)f(can)g(w)o(ork)g(in)g(an)o(y)g
(application,)e(with)j(close)f(to)g(zero)g(cost.)g(It)h(should)e(be)h
(a)h(library)e(that)h(you)f(just)i(link)f(with,)396 4828
y(without)g(an)o(y)f(other)g(dependencies.)f(No)i(additional)f(mo)o
(ving)g(pieces,)g(so)i(no)f(additional)f(risk.)h(It)g(should)f(run)h
(on)g(an)o(y)396 4936 y(OS)h(and)f(w)o(ork)f(with)i(an)o(y)e
(programming)e(language.)p Black 3800 5569 a Fi(25)p
Black eop end
%%Page: 26 40
TeXDict begin 26 39 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.26) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:373) cvn /DEST pdfmark end
 -2 -11 a
396 72 a Fj(And)g(this)h(is)g(\330MQ:)f(an)g(ef)n(\002cient,)g
(embeddable)e(library)h(that)h(solv)o(es)g(most)h(of)e(the)i(problems)d
(an)j(application)d(needs)396 180 y(to)j(become)e(nicely)g(elastic)i
(across)f(a)h(netw)o(ork,)e(without)g(much)g(cost.)-2
364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:374) cvn /DEST pdfmark end
 -2 364 a 396
454 a Fj(Speci\002cally:)-2 472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end
 -2
472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:375) cvn /DEST pdfmark end
 -2 472 a -2 482 a
SDict begin H.S end
 -2 482 a -2 482 a
SDict begin 13 H.A end
 -2
482 a -2 482 a
SDict begin [/View [/XYZ H.V]/Dest (0:376) cvn /DEST pdfmark end
 -2 482 a Black 396 625 a Fe(\225)p Black
479 625 a
SDict begin H.S end
 479 625 a 479 625 a
SDict begin 13 H.A end
 479 625 a 479 625 a
SDict begin [/View [/XYZ H.V]/Dest (0:377) cvn /DEST pdfmark end
 479
625 a Fj(It)i(handles)e(I/O)i(asynchronously)-5 b(,)16
b(in)k(background)d(threads.)i(These)h(communicate)e(with)j
(application)d(threads)479 733 y(using)i(lock-free)e(data)i
(structures,)g(so)g(concurrent)e(\330MQ)i(applications)f(need)h(no)g
(locks,)f(semaphores,)g(or)h(other)479 840 y(w)o(ait)h(states.)-2
841 y
SDict begin H.S end
 -2 841 a -2 841 a
SDict begin 13 H.A end
 -2 841 a -2 841 a
SDict begin [/View [/XYZ H.V]/Dest (0:378) cvn /DEST pdfmark end
 -2 841 a Black
396 990 a Fe(\225)p Black 479 990 a
SDict begin H.S end
 479 990 a 479 990
a
SDict begin 13 H.A end
 479 990 a 479 990 a
SDict begin [/View [/XYZ H.V]/Dest (0:379) cvn /DEST pdfmark end
 479 990 a Fj(Components)e(can)h(come)f(and)h(go)g
(dynamically)e(and)i(\330MQ)g(will)h(automatically)e(reconnect.)f(This)
i(means)g(you)479 1098 y(can)g(start)h(components)d(in)i(an)o(y)g
(order)-5 b(.)19 b(Y)-9 b(ou)19 b(can)h(create)g("service-oriented)e
(architectures")h(\(SO)m(As\))h(where)479 1206 y(services)g(can)g(join)
g(and)g(lea)n(v)o(e)g(the)g(netw)o(ork)f(at)i(an)o(y)e(time.)-2
1224 y
SDict begin H.S end
 -2 1224 a -2 1224 a
SDict begin 13 H.A end
 -2 1224 a -2 1224 a
SDict begin [/View [/XYZ H.V]/Dest (0:380) cvn /DEST pdfmark end
 -2 1224
a Black 396 1355 a Fe(\225)p Black 479 1355 a
SDict begin H.S end
 479 1355
a 479 1355 a
SDict begin 13 H.A end
 479 1355 a 479 1355 a
SDict begin [/View [/XYZ H.V]/Dest (0:381) cvn /DEST pdfmark end
 479 1355 a Fj(It)i(queues)e
(messages)h(automatically)f(when)h(needed.)e(It)j(does)f(this)g
(intelligently)-5 b(,)19 b(pushing)g(messages)h(as)h(close)f(as)479
1463 y(possible)g(to)h(the)f(recei)n(v)o(er)e(before)h(queuing)g(them.)
-2 1481 y
SDict begin H.S end
 -2 1481 a -2 1481 a
SDict begin 13 H.A end
 -2 1481 a -2 1481 a
SDict begin [/View [/XYZ H.V]/Dest (0:382) cvn /DEST pdfmark end
 -2
1481 a Black 396 1613 a Fe(\225)p Black 479 1613 a
SDict begin H.S end
 479
1613 a 479 1613 a
SDict begin 13 H.A end
 479 1613 a 479 1613 a
SDict begin [/View [/XYZ H.V]/Dest (0:383) cvn /DEST pdfmark end
 479 1613 a Fj(It)i(has)f(w)o
(ays)h(of)f(dealing)f(with)h(o)o(v)o(er)n(-full)e(queues)i(\(called)f
("high)g(w)o(ater)i(mark"\).)d(When)i(a)h(queue)e(is)i(full,)f(\330MQ)
479 1720 y(automatically)f(blocks)h(senders,)f(or)h(thro)n(ws)g(a)o(w)o
(ay)f(messages,)i(depending)c(on)j(the)g(kind)g(of)f(messaging)h(you)f
(are)479 1828 y(doing)g(\(the)h(so-called)f("pattern"\).)-2
1846 y
SDict begin H.S end
 -2 1846 a -2 1846 a
SDict begin 13 H.A end
 -2 1846 a -2 1846 a
SDict begin [/View [/XYZ H.V]/Dest (0:384) cvn /DEST pdfmark end
 -2 1846
a Black 396 1978 a Fe(\225)p Black 479 1978 a
SDict begin H.S end
 479 1978
a 479 1978 a
SDict begin 13 H.A end
 479 1978 a 479 1978 a
SDict begin [/View [/XYZ H.V]/Dest (0:385) cvn /DEST pdfmark end
 479 1978 a Fj(It)i(lets)g(your)e
(applications)g(talk)h(to)g(each)g(other)g(o)o(v)o(er)e(arbitrary)h
(transports:)g(TCP)-9 b(,)21 b(multicast,)f(in-process,)479
2086 y(inter)n(-process.)f(Y)-9 b(ou)20 b(don')o(t)e(need)i(to)g
(change)f(your)g(code)g(to)i(use)f(a)h(dif)n(ferent)d(transport.)-2
2104 y
SDict begin H.S end
 -2 2104 a -2 2104 a
SDict begin 13 H.A end
 -2 2104 a -2 2104 a
SDict begin [/View [/XYZ H.V]/Dest (0:386) cvn /DEST pdfmark end
 -2 2104
a Black 396 2235 a Fe(\225)p Black 479 2235 a
SDict begin H.S end
 479 2235
a 479 2235 a
SDict begin 13 H.A end
 479 2235 a 479 2235 a
SDict begin [/View [/XYZ H.V]/Dest (0:387) cvn /DEST pdfmark end
 479 2235 a Fj(It)j(handles)e(slo)n
(w/block)o(ed)g(readers)g(safely)-5 b(,)20 b(using)f(dif)n(ferent)g
(strate)o(gies)h(that)g(depend)f(on)g(the)i(messaging)e(pattern.)-2
2253 y
SDict begin H.S end
 -2 2253 a -2 2253 a
SDict begin 13 H.A end
 -2 2253 a -2 2253 a
SDict begin [/View [/XYZ H.V]/Dest (0:388) cvn /DEST pdfmark end
 -2 2253
a Black 396 2385 a Fe(\225)p Black 479 2385 a
SDict begin H.S end
 479 2385
a 479 2385 a
SDict begin 13 H.A end
 479 2385 a 479 2385 a
SDict begin [/View [/XYZ H.V]/Dest (0:389) cvn /DEST pdfmark end
 479 2385 a Fj(It)i(lets)g(you)e
(route)g(messages)i(using)e(a)i(v)n(ariety)e(of)h(patterns)g(such)g(as)
h(request-reply)c(and)j(publish-subscribe.)479 2493 y(These)g(patterns)
g(are)g(ho)n(w)g(you)f(create)h(the)g(topology)-5 b(,)17
b(the)k(structure)e(of)h(your)f(netw)o(ork.)-2 2511 y
SDict begin H.S end

-2 2511 a -2 2511 a
SDict begin 13 H.A end
 -2 2511 a -2 2511 a
SDict begin [/View [/XYZ H.V]/Dest (0:390) cvn /DEST pdfmark end
 -2 2511 a Black
396 2642 a Fe(\225)p Black 479 2642 a
SDict begin H.S end
 479 2642 a 479
2642 a
SDict begin 13 H.A end
 479 2642 a 479 2642 a
SDict begin [/View [/XYZ H.V]/Dest (0:391) cvn /DEST pdfmark end
 479 2642 a Fj(It)i(lets)g(you)e(create)h
(proxies)f(to)i(queue,)d(forw)o(ard,)h(or)h(capture)f(messages)h(with)g
(a)h(single)f(call.)h(Proxies)e(can)h(reduce)479 2750
y(the)g(interconnection)e(comple)o(xity)g(of)i(a)g(netw)o(ork.)-2
2768 y
SDict begin H.S end
 -2 2768 a -2 2768 a
SDict begin 13 H.A end
 -2 2768 a -2 2768 a
SDict begin [/View [/XYZ H.V]/Dest (0:392) cvn /DEST pdfmark end
 -2 2768
a Black 396 2899 a Fe(\225)p Black 479 2899 a
SDict begin H.S end
 479 2899
a 479 2899 a
SDict begin 13 H.A end
 479 2899 a 479 2899 a
SDict begin [/View [/XYZ H.V]/Dest (0:393) cvn /DEST pdfmark end
 479 2899 a Fj(It)h(deli)n(v)o(ers)e
(whole)h(messages)g(e)o(xactly)f(as)i(the)o(y)f(were)g(sent,)g(using)g
(a)g(simple)g(framing)f(on)h(the)g(wire.)g(If)g(you)f(write)479
3007 y(a)i(10k)e(message,)h(you)f(will)i(recei)n(v)o(e)e(a)i(10k)e
(message.)-2 3025 y
SDict begin H.S end
 -2 3025 a -2 3025 a
SDict begin 13 H.A end
 -2 3025 a -2
3025 a
SDict begin [/View [/XYZ H.V]/Dest (0:394) cvn /DEST pdfmark end
 -2 3025 a Black 396 3157 a Fe(\225)p Black 479
3157 a
SDict begin H.S end
 479 3157 a 479 3157 a
SDict begin 13 H.A end
 479 3157 a 479 3157 a
SDict begin [/View [/XYZ H.V]/Dest (0:395) cvn /DEST pdfmark end
 479
3157 a Fj(It)i(does)f(not)g(impose)f(an)o(y)h(format)f(on)g(messages.)i
(The)o(y)e(are)h(blobs)f(of)h(zero)g(to)g(gigabytes)f(lar)o(ge.)g(When)
h(you)f(w)o(ant)479 3265 y(to)i(represent)e(data)h(you)f(choose)g(some)
h(other)g(product)e(on)i(top,)f(such)h(as)h(Google')-5
b(s)20 b(protocol)e(b)n(uf)n(fers,)h(XDR,)i(and)479 3373
y(others.)-2 3374 y
SDict begin H.S end
 -2 3374 a -2 3374 a
SDict begin 13 H.A end
 -2 3374 a -2
3374 a
SDict begin [/View [/XYZ H.V]/Dest (0:396) cvn /DEST pdfmark end
 -2 3374 a Black 396 3522 a Fe(\225)p Black 479
3522 a
SDict begin H.S end
 479 3522 a 479 3522 a
SDict begin 13 H.A end
 479 3522 a 479 3522 a
SDict begin [/View [/XYZ H.V]/Dest (0:397) cvn /DEST pdfmark end
 479
3522 a Fj(It)g(handles)e(netw)o(ork)g(errors)g(intelligently)-5
b(.)19 b(Sometimes)h(it)h(retries,)f(sometimes)g(it)g(tells)i(you)d(an)
h(operation)e(f)o(ailed.)-2 3540 y
SDict begin H.S end
 -2 3540 a -2 3540
a
SDict begin 13 H.A end
 -2 3540 a -2 3540 a
SDict begin [/View [/XYZ H.V]/Dest (0:398) cvn /DEST pdfmark end
 -2 3540 a Black 396 3671 a Fe(\225)p
Black 479 3671 a
SDict begin H.S end
 479 3671 a 479 3671 a
SDict begin 13 H.A end
 479 3671 a 479
3671 a
SDict begin [/View [/XYZ H.V]/Dest (0:399) cvn /DEST pdfmark end
 479 3671 a Fj(It)i(reduces)e(your)h(carbon)e(footprint.)h(Doing)
g(more)h(with)g(less)i(CPU)f(means)f(your)g(box)o(es)f(use)i(less)g(po)
n(wer)m(,)e(and)h(you)479 3779 y(can)h(k)o(eep)g(your)f(old)h(box)o(es)
f(in)h(use)h(for)e(longer)-5 b(.)19 b(Al)i(Gore)f(w)o(ould)f(lo)o(v)o
(e)h(\330MQ.)-2 3963 y
SDict begin H.S end
 -2 3963 a -2 3963 a
SDict begin 13 H.A end
 -2 3963 a
-2 3963 a
SDict begin [/View [/XYZ H.V]/Dest (0:400) cvn /DEST pdfmark end
 -2 3963 a 396 4053 a Fj(Actually)g(\330MQ)g(does)g(rather)g
(more)f(than)h(this.)g(It)h(has)f(a)h(sub)o(v)o(ersi)n(v)o(e)d(ef)n
(fect)h(on)h(ho)n(w)g(you)f(de)n(v)o(elop)396 4161 y(netw)o
(ork-capable)e(applications.)i(Super\002cially)g(it')-5
b(s)22 b(a)e(sock)o(et-inspired)e(API)j(on)f(which)f(you)h(do)396
4269 y
SDict begin H.S end
 396 4269 a 396 4269 a
SDict begin 13 H.A end
 396 4269 a 396 4269 a
SDict begin [/View [/XYZ H.V]/Dest (0:401) cvn /DEST pdfmark end
 396
4269 a Fg(zmq-msg-recv[3])e Fj(and)1230 4269 y
SDict begin H.S end
 1230 4269
a 1230 4269 a
SDict begin 13 H.A end
 1230 4269 a 1230 4269 a
SDict begin [/View [/XYZ H.V]/Dest (0:402) cvn /DEST pdfmark end
 1230 4269 a Fg(zmq-msg-send[3])p
Fj(.)g(But)j(message)f(processing)f(rapidly)g(becomes)g(the)h(central)g
(loop,)396 4377 y(and)g(your)f(application)g(soon)g(breaks)h(do)n(wn)f
(into)h(a)g(set)h(of)f(message)g(processing)f(tasks.)i(It)f(is)h(ele)o
(gant)e(and)h(natural.)396 4485 y(And)g(it)h(scales:)g(each)f(of)g
(these)g(tasks)h(maps)f(to)g(a)h(node,)e(and)g(the)i(nodes)e(talk)h(to)
h(each)f(other)f(across)h(arbitrary)396 4593 y(transports.)f(T)-7
b(w)o(o)21 b(nodes)e(in)h(one)g(process)f(\(node)g(is)i(a)g(thread\),)d
(tw)o(o)j(nodes)e(on)h(one)f(box)g(\(node)g(is)i(a)g(process\),)e(or)g
(tw)o(o)396 4701 y(box)o(es)g(on)h(one)g(netw)o(ork)f(\(node)g(is)i(a)f
(box\))f(-)i(it')-5 b(s)21 b(all)g(the)f(same,)g(with)h(no)e
(application)g(code)g(changes.)-2 4729 y
SDict begin H.S end
 -2 4729 a -2
4729 a
SDict begin 13 H.A end
 -2 4729 a -2 4729 a
SDict begin [/View [/XYZ H.V]/Dest (0:403) cvn /DEST pdfmark end
 -2 4729 a Black 3798 5569
a Fi(26)p Black eop end
%%Page: 27 41
TeXDict begin 27 40 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.27) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 94 a Fh(1.11.)39 b(Soc)m(ket)f(Scalability)1576 94
y
SDict begin H.S end
 1576 94 a 1576 94 a
SDict begin 22.464 H.A end
 1576 94 a 1576 94 a
SDict begin [/View [/XYZ H.V]/Dest (6.16.1) cvn /DEST pdfmark end
 1576 94 a -2
290 a
SDict begin H.S end
 -2 290 a -2 290 a
SDict begin 13 H.A end
 -2 290 a -2 290 a
SDict begin [/View [/XYZ H.V]/Dest (0:405) cvn /DEST pdfmark end
 -2 290 a 396
368 a Fj(Let')-5 b(s)21 b(see)g(\330MQ')-5 b(s)21 b(scalability)f(in)g
(action.)f(Here)i(is)g(a)f(shell)h(script)f(that)g(starts)h(the)g
(weather)e(serv)o(er)g(and)h(then)g(a)396 476 y(b)n(unch)f(of)h
(clients)h(in)f(parallel:)-2 577 y
SDict begin H.S end
 -2 577 a -2 577 a
SDict begin 11.7 H.A end

-2 577 a -2 577 a
SDict begin [/View [/XYZ H.V]/Dest (0:406) cvn /DEST pdfmark end
 -2 577 a 396 656 a Fg(wuserver)44 b(&)396
753 y(wuclient)g(12345)g(&)396 850 y(wuclient)g(23456)g(&)396
948 y(wuclient)g(34567)g(&)396 1045 y(wuclient)g(45678)g(&)396
1142 y(wuclient)g(56789)g(&)-2 1309 y
SDict begin H.S end
 -2 1309 a -2 1309
a
SDict begin 13 H.A end
 -2 1309 a -2 1309 a
SDict begin [/View [/XYZ H.V]/Dest (0:407) cvn /DEST pdfmark end
 -2 1309 a 396 1416 a Fj(As)21 b(the)f(clients)h
(run,)e(we)i(tak)o(e)f(a)h(look)e(at)i(the)f(acti)n(v)o(e)g(processes)f
(using)h(')o(top',)f(and)g(we)i(see)f(something)f(lik)o(e)i(\(on)e(a)
396 1524 y(4-core)g(box\):)-2 1622 y
SDict begin H.S end
 -2 1622 a -2 1622
a
SDict begin 11.7 H.A end
 -2 1622 a -2 1622 a
SDict begin [/View [/XYZ H.V]/Dest (0:408) cvn /DEST pdfmark end
 -2 1622 a 486 1704 a Fg(PID)44
b(USER)269 b(PR)89 b(NI)g(VIRT)g(RES)g(SHR)45 b(S)f(\045CPU)h(\045MEM)
178 b(TIME+)89 b(COMMAND)441 1801 y(7136)44 b(ph)359
b(20)134 b(0)44 b(1040m)g(959m)h(1156)f(R)89 b(157)45
b(12.0)89 b(16:25.47)43 b(wuserver)441 1898 y(7966)h(ph)359
b(20)134 b(0)44 b(98608)g(1804)h(1372)f(S)134 b(33)89
b(0.0)134 b(0:03.94)44 b(wuclient)441 1995 y(7963)g(ph)359
b(20)134 b(0)44 b(33116)g(1748)h(1372)f(S)134 b(14)89
b(0.0)134 b(0:00.76)44 b(wuclient)441 2092 y(7965)g(ph)359
b(20)134 b(0)44 b(33116)g(1784)h(1372)f(S)179 b(6)89
b(0.0)134 b(0:00.47)44 b(wuclient)441 2190 y(7964)g(ph)359
b(20)134 b(0)44 b(33116)g(1788)h(1372)f(S)179 b(5)89
b(0.0)134 b(0:00.25)44 b(wuclient)441 2287 y(7967)g(ph)359
b(20)134 b(0)44 b(33072)g(1740)h(1372)f(S)179 b(5)89
b(0.0)134 b(0:00.35)44 b(wuclient)-2 2464 y
SDict begin H.S end
 -2 2464 a
-2 2464 a
SDict begin 13 H.A end
 -2 2464 a -2 2464 a
SDict begin [/View [/XYZ H.V]/Dest (0:409) cvn /DEST pdfmark end
 -2 2464 a 396 2561 a Fj(Let')-5
b(s)21 b(think)f(for)f(a)i(second)e(about)g(what)h(is)h(happening)d
(here.)i(The)f(weather)h(serv)o(er)f(has)i(a)f(single)g(sock)o(et,)g
(and)g(yet)396 2669 y(here)g(we)g(ha)n(v)o(e)g(it)h(sending)e(data)h
(to)g(\002)n(v)o(e)g(clients)h(in)f(parallel.)g(W)-7
b(e)21 b(could)e(ha)n(v)o(e)h(thousands)f(of)h(concurrent)d(clients.)
396 2777 y(The)j(serv)o(er)f(application)g(doesn')o(t)f(see)j(them,)e
(doesn')o(t)g(talk)h(to)g(them)g(directly)-5 b(.)19 b(So)h(the)g
(\330MQ)g(sock)o(et)g(is)h(acting)f(lik)o(e)g(a)396 2884
y(little)h(serv)o(er)m(,)e(silently)h(accepting)f(client)h(requests)g
(and)g(sho)o(ving)e(data)i(out)g(to)h(them)e(as)i(f)o(ast)g(as)g(the)f
(netw)o(ork)f(can)396 2992 y(handle)g(it.)i(And)f(it')-5
b(s)21 b(a)g(multithreaded)d(serv)o(er)m(,)g(squeezing)h(more)g(juice)i
(out)e(of)h(your)f(CPU.)-2 3021 y
SDict begin H.S end
 -2 3021 a -2 3021 a
SDict begin 13 H.A end

-2 3021 a -2 3021 a
SDict begin [/View [/XYZ H.V]/Dest (0:410) cvn /DEST pdfmark end
 -2 3021 a 359 x Fh(1.12.)39 b(Upgrading)e(fr)m(om)i
(\330MQ/2.2)f(to)h(\330MQ/3.2)2851 3380 y
SDict begin H.S end
 2851 3380 a
2851 3380 a
SDict begin 22.464 H.A end
 2851 3380 a 2851 3380 a
SDict begin [/View [/XYZ H.V]/Dest (6.17.1) cvn /DEST pdfmark end
 2851 3380 a -2 3578
a
SDict begin H.S end
 -2 3578 a -2 3578 a
SDict begin 13 H.A end
 -2 3578 a -2 3578 a
SDict begin [/View [/XYZ H.V]/Dest (0:412) cvn /DEST pdfmark end
 -2 3578 a 396
3654 a Fj(In)20 b(early)g(2012,)e(\330MQ/3.2)i(became)f(stable)h
(enough)f(for)g(li)n(v)o(e)h(use)h(and)e(by)h(the)g(time)h(you')l(re)d
(reading)h(this,)h(it')-5 b(s)21 b(what)396 3762 y(you)f(really)f
(should)h(be)g(using.)f(If)h(you)f(are)i(still)g(using)f(2.2,)f(here')
-5 b(s)20 b(a)g(quick)g(summary)e(of)i(the)h(changes,)e(and)g(ho)n(w)h
(to)396 3870 y(migrate)g(your)f(code.)-2 4054 y
SDict begin H.S end
 -2 4054
a -2 4054 a
SDict begin 13 H.A end
 -2 4054 a -2 4054 a
SDict begin [/View [/XYZ H.V]/Dest (0:413) cvn /DEST pdfmark end
 -2 4054 a 396 4144 a
Fj(The)g(main)g(change)f(in)i(3.x)e(is)j(that)e(PUB-SUB)i(w)o(orks)e
(properly)-5 b(,)16 b(as)k(in,)f(the)h(publisher)e(only)g(sends)i
(subscribers)e(stuf)n(f)396 4252 y(the)o(y)i(actually)f(w)o(ant.)h(In)g
(2.x,)g(publishers)f(send)h(e)n(v)o(erything)d(and)j(the)g(subscribers)
f(\002lter)-5 b(.)21 b(Simple,)f(b)n(ut)g(not)g(ideal)g(for)396
4360 y(performance)e(on)h(a)i(TCP)g(netw)o(ork.)-2 4544
y
SDict begin H.S end
 -2 4544 a -2 4544 a
SDict begin 13 H.A end
 -2 4544 a -2 4544 a
SDict begin [/View [/XYZ H.V]/Dest (0:414) cvn /DEST pdfmark end
 -2 4544 a 396
4634 a Fj(Most)g(of)f(the)g(API)g(is)h(backw)o(ards)e(compatible,)g(e)o
(xcept)g(a)i(fe)n(w)f(changes)f(that)h(went)g(into)g(3.0)g(with)g
(little)h(re)o(gard)d(to)396 4741 y(the)i(cost)h(of)f(breaking)e(e)o
(xisting)i(code.)f(The)h(syntax)f(of)2032 4741 y
SDict begin H.S end
 2032
4741 a 2032 4741 a
SDict begin 13 H.A end
 2032 4741 a 2032 4741 a
SDict begin [/View [/XYZ H.V]/Dest (0:415) cvn /DEST pdfmark end
 2032 4741
a Fg(zmq-send[3])g Fj(and)2687 4741 y
SDict begin H.S end
 2687 4741 a 2687
4741 a
SDict begin 13 H.A end
 2687 4741 a 2687 4741 a
SDict begin [/View [/XYZ H.V]/Dest (0:416) cvn /DEST pdfmark end
 2687 4741 a Fg(zmq-recv[3])g
Fj(changed,)f(and)396 4849 y
SDict begin H.S end
 396 4849 a 396 4849 a
SDict begin 13 H.A end
 396
4849 a 396 4849 a
SDict begin [/View [/XYZ H.V]/Dest (0:417) cvn /DEST pdfmark end
 396 4849 a Fg(ZMQ-NOBLOCK)h Fj(got)h(rebaptized)f(to)
1489 4849 y
SDict begin H.S end
 1489 4849 a 1489 4849 a
SDict begin 13 H.A end
 1489 4849 a 1489
4849 a
SDict begin [/View [/XYZ H.V]/Dest (0:418) cvn /DEST pdfmark end
 1489 4849 a Fg(ZMQ-DONTWAIT)p Fj(.)f(So)j(although)d(I')l(d)i
(lo)o(v)o(e)f(to)h(say)-5 b(,)20 b("you)f(just)i(recompile)e(your)396
4957 y(code)h(with)g(the)g(latest)h(libzmq)f(and)f(e)n(v)o(erything)f
(will)j(w)o(ork",)e(that')-5 b(s)21 b(not)f(ho)n(w)f(it)i(is.)g(F)o(or)
f(what)g(it')-5 b(s)21 b(w)o(orth,)f(we)396 5065 y(banned)f(such)h(API)
g(breakage)f(afterw)o(ards.)p Black 3797 5569 a Fi(27)p
Black eop end
%%Page: 28 42
TeXDict begin 28 41 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.28) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3291 -132 a Fi(Chapter)19 b(1.)h(Basics)p Black
-2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:419) cvn /DEST pdfmark end
 -2 -11 a
396 72 a Fj(So)h(the)f(minimal)f(change)g(for)h(C/C++)h(apps)f(that)g
(use)h(the)f(lo)n(w-le)n(v)o(el)f(libzmq)g(API)i(is)g(to)f(replace)g
(all)g(calls)h(to)396 180 y
SDict begin H.S end
 396 180 a 396 180 a
SDict begin 13 H.A end
 396 180
a 396 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:420) cvn /DEST pdfmark end
 396 180 a Fg(zmq-send[3])e Fj(with)1079 180
y
SDict begin H.S end
 1079 180 a 1079 180 a
SDict begin 13 H.A end
 1079 180 a 1079 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:421) cvn /DEST pdfmark end
 1079 180
a Fg(zmq-msg-send[3])p Fj(,)f(and)1933 180 y
SDict begin H.S end
 1933 180
a 1933 180 a
SDict begin 13 H.A end
 1933 180 a 1933 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:422) cvn /DEST pdfmark end
 1933 180 a Fg(zmq-recv[3])h
Fj(with)2615 180 y
SDict begin H.S end
 2615 180 a 2615 180 a
SDict begin 13 H.A end
 2615 180 a 2615
180 a
SDict begin [/View [/XYZ H.V]/Dest (0:423) cvn /DEST pdfmark end
 2615 180 a Fg(zmq-msg-recv[3])p Fj(.)f(In)i(other)396
288 y(languages,)f(your)g(binding)f(author)h(may)h(ha)n(v)o(e)f(done)h
(the)g(w)o(ork)f(already)-5 b(.)19 b(Note)h(that)g(these)h(tw)o(o)f
(functions)f(no)n(w)396 396 y(return)g(-1)h(in)h(case)f(of)g(error)m(,)
f(and)g(zero)h(or)g(more)f(according)f(to)j(ho)n(w)e(man)o(y)g(bytes)h
(were)g(sent)h(or)f(recei)n(v)o(ed.)-2 580 y
SDict begin H.S end
 -2 580 a
-2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:424) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(Other)g(parts)g(of)g
(the)g(libzmq)g(API)g(became)g(more)f(consistent.)g(W)-7
b(e)22 b(deprecated)2755 670 y
SDict begin H.S end
 2755 670 a 2755 670 a
SDict begin 13 H.A end

2755 670 a 2755 670 a
SDict begin [/View [/XYZ H.V]/Dest (0:425) cvn /DEST pdfmark end
 2755 670 a Fg(zmq-init[3])d Fj(and)396
778 y
SDict begin H.S end
 396 778 a 396 778 a
SDict begin 13 H.A end
 396 778 a 396 778 a
SDict begin [/View [/XYZ H.V]/Dest (0:426) cvn /DEST pdfmark end
 396 778
a Fg(zmq-term[3])p Fj(,)g(replacing)g(them)g(with)1616
778 y
SDict begin H.S end
 1616 778 a 1616 778 a
SDict begin 13 H.A end
 1616 778 a 1616 778 a
SDict begin [/View [/XYZ H.V]/Dest (0:427) cvn /DEST pdfmark end
 1616
778 a Fg(zmq-ctx-new[3])f Fj(and)2405 778 y
SDict begin H.S end
 2405 778
a 2405 778 a
SDict begin 13 H.A end
 2405 778 a 2405 778 a
SDict begin [/View [/XYZ H.V]/Dest (0:428) cvn /DEST pdfmark end
 2405 778 a Fg(zmq-ctx-destroy[3])p
Fj(.)f(W)-7 b(e)22 b(added)396 886 y
SDict begin H.S end
 396 886 a 396 886
a
SDict begin 13 H.A end
 396 886 a 396 886 a
SDict begin [/View [/XYZ H.V]/Dest (0:429) cvn /DEST pdfmark end
 396 886 a Fg(zmq-ctx-set[3])d Fj(to)h(let)h(you)e
(con\002gure)f(a)j(conte)o(xt)e(before)g(starting)h(to)g(w)o(ork)f
(with)i(it.)-2 1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2
1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:430) cvn /DEST pdfmark end
 -2 1070 a 396 1160 a Fj(Finally)-5 b(,)20 b(we)g(added)f(conte)o
(xt)g(monitoring)f(via)i(the)1902 1160 y
SDict begin H.S end
 1902 1160 a
1902 1160 a
SDict begin 13 H.A end
 1902 1160 a 1902 1160 a
SDict begin [/View [/XYZ H.V]/Dest (0:431) cvn /DEST pdfmark end
 1902 1160 a Fg
(zmq-ctx-set-monitor[3])d Fj(call,)k(which)e(lets)j(you)d(track)396
1268 y(connections)g(and)g(disconnections,)f(and)i(other)f(e)n(v)o
(ents)h(on)g(sock)o(ets.)-2 1290 y
SDict begin H.S end
 -2 1290 a -2 1290
a
SDict begin 13 H.A end
 -2 1290 a -2 1290 a
SDict begin [/View [/XYZ H.V]/Dest (0:432) cvn /DEST pdfmark end
 -2 1290 a 365 x Fh(1.13.)39 b(W)-6
b(arning)39 b(-)g(Unstab)o(le)f(P)l(aradigms!)2477 1655
y
SDict begin H.S end
 2477 1655 a 2477 1655 a
SDict begin 22.464 H.A end
 2477 1655 a 2477 1655 a
SDict begin [/View [/XYZ H.V]/Dest (6.18.1) cvn /DEST pdfmark end
 2477
1655 a -2 1853 a
SDict begin H.S end
 -2 1853 a -2 1853 a
SDict begin 13 H.A end
 -2 1853 a -2 1853
a
SDict begin [/View [/XYZ H.V]/Dest (0:434) cvn /DEST pdfmark end
 -2 1853 a 396 1929 a Fj(T)m(raditional)19 b(netw)o(ork)g(programming)
e(is)k(b)n(uilt)f(on)g(the)g(general)f(assumption)g(that)i(one)e(sock)o
(et)h(talks)h(to)f(one)396 2037 y(connection,)e(one)i(peer)-5
b(.)20 b(There)f(are)h(multicast)g(protocols)f(b)n(ut)h(these)h(are)f
(e)o(xotic.)f(When)h(we)g(assume)h("one)e(sock)o(et)h(=)396
2145 y(one)f(connection",)f(we)i(scale)g(our)f(architectures)g(in)h
(certain)f(w)o(ays.)h(W)-7 b(e)21 b(create)e(threads)g(of)h(logic)f
(where)g(each)h(thread)396 2253 y(w)o(ork)g(with)g(one)g(sock)o(et,)g
(one)f(peer)-5 b(.)20 b(W)-7 b(e)21 b(place)f(intelligence)f(and)h
(state)h(in)f(these)h(threads.)-2 2437 y
SDict begin H.S end
 -2 2437 a -2
2437 a
SDict begin 13 H.A end
 -2 2437 a -2 2437 a
SDict begin [/View [/XYZ H.V]/Dest (0:435) cvn /DEST pdfmark end
 -2 2437 a 396 2527 a Fj(In)f(the)g(\330MQ)h
(uni)n(v)o(erse,)d(sock)o(ets)j(are)f(doorw)o(ays)e(to)j(f)o(ast)g
(little)g(background)16 b(communications)i(engines)h(that)396
2635 y(manage)g(a)i(whole)e(set)i(of)f(connections)f(automagically)f
(for)h(you.)g(Y)-9 b(ou)20 b(can')o(t)f(see,)i(w)o(ork)e(with,)h(open,)
f(close,)i(or)396 2743 y(attach)f(state)h(to)g(these)f(connections.)e
(Whether)i(you)f(use)h(blocking)f(send)h(or)g(recei)n(v)o(e,)e(or)i
(poll,)g(all)h(you)e(can)h(talk)g(to)h(is)396 2851 y(the)f(sock)o(et,)g
(not)g(the)g(connections)f(it)i(manages)e(for)g(you.)g(The)h
(connections)f(are)h(pri)n(v)n(ate)f(and)h(in)m(visible,)f(and)g(this)i
(is)396 2959 y(the)f(k)o(e)o(y)g(to)g(\330MQ')-5 b(s)21
b(scalability)-5 b(.)-2 3143 y
SDict begin H.S end
 -2 3143 a -2 3143 a
SDict begin 13 H.A end
 -2
3143 a -2 3143 a
SDict begin [/View [/XYZ H.V]/Dest (0:436) cvn /DEST pdfmark end
 -2 3143 a 396 3233 a Fj(Because)21 b(your)e(code,)g
(talking)g(to)i(a)f(sock)o(et,)g(can)g(then)g(handle)f(an)o(y)g(number)
g(of)g(connections)g(across)h(whate)n(v)o(er)396 3341
y(netw)o(ork)f(protocols)g(are)h(around,)e(without)i(change.)e(A)j
(messaging)e(pattern)h(sitting)g(in)g(\330MQ)h(can)f(scale)g(more)396
3449 y(cheaply)f(than)h(a)h(messaging)e(pattern)g(sitting)i(in)f(your)f
(application)f(code.)-2 3633 y
SDict begin H.S end
 -2 3633 a -2 3633 a
SDict begin 13 H.A end
 -2
3633 a -2 3633 a
SDict begin [/View [/XYZ H.V]/Dest (0:437) cvn /DEST pdfmark end
 -2 3633 a 396 3723 a Fj(So)j(the)f(general)f
(assumption)g(no)h(longer)f(applies.)g(As)i(you)f(read)f(the)h(code)g
(e)o(xamples,)f(your)g(brain)g(will)i(try)f(to)g(map)396
3831 y(them)g(to)g(what)h(you)e(kno)n(w)-5 b(.)18 b(Y)-9
b(ou)20 b(will)h(read)f("sock)o(et")f(and)h(think)f("ah,)h(that)g
(represents)g(a)g(connection)e(to)j(another)396 3939
y(node".)e(That)h(is)h(wrong.)e(Y)-9 b(ou)19 b(will)i(read)f("thread")f
(and)h(your)e(brain)i(will)h(again)e(think,)g("ah,)h(a)g(thread)g
(represents)f(a)396 4047 y(connection)f(to)j(another)d(node",)h(and)h
(again)f(your)g(brain)g(will)i(be)f(wrong.)-2 4231 y
SDict begin H.S end

-2 4231 a -2 4231 a
SDict begin 13 H.A end
 -2 4231 a -2 4231 a
SDict begin [/View [/XYZ H.V]/Dest (0:438) cvn /DEST pdfmark end
 -2 4231 a 396
4320 a Fj(If)g(you')l(re)f(reading)f(this)j(Guide)f(for)f(the)h
(\002rst)h(time,)g(realize)f(that)g(until)g(you)f(actually)h(write)g
(\330MQ)h(code)e(for)h(a)g(day)g(or)396 4428 y(tw)o(o)h(\(and)e(maybe)g
(three)h(or)g(four)f(days\),)g(you)g(may)h(feel)g(confused,)f
(especially)g(by)h(ho)n(w)g(simple)g(\330MQ)g(mak)o(es)396
4536 y(things)f(for)g(you,)f(and)h(you)g(may)g(try)g(to)g(impose)g
(that)h(general)e(assumption)g(on)h(\330MQ,)g(and)g(it)h(w)o(on')o(t)f
(w)o(ork.)f(And)h(then)396 4644 y(you)h(will)g(e)o(xperience)e(your)h
(moment)g(of)h(enlightenment)e(and)h(trust,)h(that)2597
4644 y
SDict begin H.S end
 2597 4644 a 2597 4644 a
SDict begin 13 H.A end
 2597 4644 a 2597 4644
a
SDict begin [/View [/XYZ H.V]/Dest (0:439) cvn /DEST pdfmark end
 2597 4644 a Fi(zap-pow-kaboom)c Fj(satori)k(paradigm-shift)396
4752 y(moment)f(when)h(it)h(all)f(becomes)g(clear)-5
b(.)p Black 3800 5569 a Fi(28)p Black eop end
%%Page: 29 43
TeXDict begin 29 42 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.29) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:sockets-and-patterns) cvn /DEST
pdfmark end
 -2 -11 a 126 x Fl(Chapter)48 b(2.)f(Soc)m(kets)g(and)h(P)-5
b(atterns)2630 115 y
SDict begin H.S end
 2630 115 a 2630 115 a
SDict begin 26.957 H.A end
 2630 115 a
2630 115 a
SDict begin [/View [/XYZ H.V]/Dest (7.0) cvn /DEST pdfmark end
 2630 115 a -2 371 a
SDict begin H.S end
 -2 371 a -2 371 a
SDict begin 13 H.A end
 -2 371
a -2 371 a
SDict begin [/View [/XYZ H.V]/Dest (0:442) cvn /DEST pdfmark end
 -2 371 a 396 443 a Fj(In)20 b(Basics)p 0 TeXcolorgray
702 443 a
SDict begin H.S end
 702 443 a Fj(Chapter)h(1)1029 443 y
SDict begin 13 H.L end
 1029 443
a 1029 443 a
SDict begin [/Subtype /Link/Dest (0:basics) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 1029 443 a Black 20 w Fj(we)f(took)g(\330MQ)g(for)g(a)g
(dri)n(v)o(e,)f(with)i(some)f(basic)g(e)o(xamples)f(of)h(the)g(main)g
(\330MQ)g(patterns:)396 551 y(request-reply)-5 b(,)17
b(publish-subscribe,)h(and)h(pipeline.)g(In)h(this)h(chapter)e(we')l
(re)h(going)e(to)j(get)f(our)f(hands)h(dirty)f(and)h(start)396
659 y(to)h(learn)e(ho)n(w)h(to)g(use)h(these)f(tools)g(in)h(real)f
(programs.)-2 843 y
SDict begin H.S end
 -2 843 a -2 843 a
SDict begin 13 H.A end
 -2 843 a -2 843
a
SDict begin [/View [/XYZ H.V]/Dest (0:444) cvn /DEST pdfmark end
 -2 843 a 396 933 a Fj(W)-7 b(e')o(ll)22 b(co)o(v)o(er:)-2
934 y
SDict begin H.S end
 -2 934 a -2 934 a
SDict begin 13 H.A end
 -2 934 a -2 934 a
SDict begin [/View [/XYZ H.V]/Dest (0:445) cvn /DEST pdfmark end
 -2 934 a -2
944 a
SDict begin H.S end
 -2 944 a -2 944 a
SDict begin 13 H.A end
 -2 944 a -2 944 a
SDict begin [/View [/XYZ H.V]/Dest (0:446) cvn /DEST pdfmark end
 -2 944 a Black
396 1103 a Fe(\225)p Black 479 1103 a
SDict begin H.S end
 479 1103 a 479
1103 a
SDict begin 13 H.A end
 479 1103 a 479 1103 a
SDict begin [/View [/XYZ H.V]/Dest (0:447) cvn /DEST pdfmark end
 479 1103 a Fj(Ho)n(w)e(to)h(create)f(and)f
(w)o(ork)h(with)g(\330MQ)h(sock)o(ets.)-2 1118 y
SDict begin H.S end
 -2 1118
a -2 1118 a
SDict begin 13 H.A end
 -2 1118 a -2 1118 a
SDict begin [/View [/XYZ H.V]/Dest (0:448) cvn /DEST pdfmark end
 -2 1118 a Black 396 1252
a Fe(\225)p Black 479 1252 a
SDict begin H.S end
 479 1252 a 479 1252 a
SDict begin 13 H.A end
 479
1252 a 479 1252 a
SDict begin [/View [/XYZ H.V]/Dest (0:449) cvn /DEST pdfmark end
 479 1252 a Fj(Ho)n(w)f(to)h(send)f(and)f(recei)n(v)o
(e)g(messages)i(on)e(sock)o(ets.)-2 1270 y
SDict begin H.S end
 -2 1270 a
-2 1270 a
SDict begin 13 H.A end
 -2 1270 a -2 1270 a
SDict begin [/View [/XYZ H.V]/Dest (0:450) cvn /DEST pdfmark end
 -2 1270 a Black 396 1402
a Fe(\225)p Black 479 1402 a
SDict begin H.S end
 479 1402 a 479 1402 a
SDict begin 13 H.A end
 479
1402 a 479 1402 a
SDict begin [/View [/XYZ H.V]/Dest (0:451) cvn /DEST pdfmark end
 479 1402 a Fj(Ho)n(w)h(to)h(b)n(uild)e(your)g(apps)h
(around)f(\330MQ')-5 b(s)20 b(asynchronous)e(I/O)i(model.)-2
1420 y
SDict begin H.S end
 -2 1420 a -2 1420 a
SDict begin 13 H.A end
 -2 1420 a -2 1420 a
SDict begin [/View [/XYZ H.V]/Dest (0:452) cvn /DEST pdfmark end
 -2 1420
a Black 396 1551 a Fe(\225)p Black 479 1551 a
SDict begin H.S end
 479 1551
a 479 1551 a
SDict begin 13 H.A end
 479 1551 a 479 1551 a
SDict begin [/View [/XYZ H.V]/Dest (0:453) cvn /DEST pdfmark end
 479 1551 a Fj(Ho)n(w)g(to)h(handle)e
(multiple)g(sock)o(ets)i(in)f(one)g(thread.)-2 1569 y
SDict begin H.S end

-2 1569 a -2 1569 a
SDict begin 13 H.A end
 -2 1569 a -2 1569 a
SDict begin [/View [/XYZ H.V]/Dest (0:454) cvn /DEST pdfmark end
 -2 1569 a Black
396 1701 a Fe(\225)p Black 479 1701 a
SDict begin H.S end
 479 1701 a 479
1701 a
SDict begin 13 H.A end
 479 1701 a 479 1701 a
SDict begin [/View [/XYZ H.V]/Dest (0:455) cvn /DEST pdfmark end
 479 1701 a Fj(Ho)n(w)g(to)h(handle)e(f)o
(atal)h(and)g(non-f)o(atal)f(errors)g(properly)-5 b(.)-2
1719 y
SDict begin H.S end
 -2 1719 a -2 1719 a
SDict begin 13 H.A end
 -2 1719 a -2 1719 a
SDict begin [/View [/XYZ H.V]/Dest (0:456) cvn /DEST pdfmark end
 -2 1719
a Black 396 1850 a Fe(\225)p Black 479 1850 a
SDict begin H.S end
 479 1850
a 479 1850 a
SDict begin 13 H.A end
 479 1850 a 479 1850 a
SDict begin [/View [/XYZ H.V]/Dest (0:457) cvn /DEST pdfmark end
 479 1850 a Fj(Ho)n(w)20
b(to)h(handle)e(interrupt)f(signals)j(lik)o(e)f(Ctrl-C.)-2
1868 y
SDict begin H.S end
 -2 1868 a -2 1868 a
SDict begin 13 H.A end
 -2 1868 a -2 1868 a
SDict begin [/View [/XYZ H.V]/Dest (0:458) cvn /DEST pdfmark end
 -2 1868
a Black 396 1999 a Fe(\225)p Black 479 1999 a
SDict begin H.S end
 479 1999
a 479 1999 a
SDict begin 13 H.A end
 479 1999 a 479 1999 a
SDict begin [/View [/XYZ H.V]/Dest (0:459) cvn /DEST pdfmark end
 479 1999 a Fj(Ho)n(w)g(to)h(shutdo)n
(wn)d(a)j(\330MQ)f(application)f(cleanly)-5 b(.)-2 2017
y
SDict begin H.S end
 -2 2017 a -2 2017 a
SDict begin 13 H.A end
 -2 2017 a -2 2017 a
SDict begin [/View [/XYZ H.V]/Dest (0:460) cvn /DEST pdfmark end
 -2 2017 a Black
396 2149 a Fe(\225)p Black 479 2149 a
SDict begin H.S end
 479 2149 a 479
2149 a
SDict begin 13 H.A end
 479 2149 a 479 2149 a
SDict begin [/View [/XYZ H.V]/Dest (0:461) cvn /DEST pdfmark end
 479 2149 a Fj(Ho)n(w)20
b(to)h(check)e(a)i(\330MQ)f(application)f(for)g(memory)g(leaks.)-2
2167 y
SDict begin H.S end
 -2 2167 a -2 2167 a
SDict begin 13 H.A end
 -2 2167 a -2 2167 a
SDict begin [/View [/XYZ H.V]/Dest (0:462) cvn /DEST pdfmark end
 -2 2167
a Black 396 2298 a Fe(\225)p Black 479 2298 a
SDict begin H.S end
 479 2298
a 479 2298 a
SDict begin 13 H.A end
 479 2298 a 479 2298 a
SDict begin [/View [/XYZ H.V]/Dest (0:463) cvn /DEST pdfmark end
 479 2298 a Fj(Ho)n(w)h(to)h(send)f
(and)f(recei)n(v)o(e)g(multi-part)g(messages.)-2 2316
y
SDict begin H.S end
 -2 2316 a -2 2316 a
SDict begin 13 H.A end
 -2 2316 a -2 2316 a
SDict begin [/View [/XYZ H.V]/Dest (0:464) cvn /DEST pdfmark end
 -2 2316 a Black
396 2448 a Fe(\225)p Black 479 2448 a
SDict begin H.S end
 479 2448 a 479
2448 a
SDict begin 13 H.A end
 479 2448 a 479 2448 a
SDict begin [/View [/XYZ H.V]/Dest (0:465) cvn /DEST pdfmark end
 479 2448 a Fj(Ho)n(w)h(to)h(forw)o(ard)d
(messages)j(across)f(netw)o(orks.)-2 2466 y
SDict begin H.S end
 -2 2466 a
-2 2466 a
SDict begin 13 H.A end
 -2 2466 a -2 2466 a
SDict begin [/View [/XYZ H.V]/Dest (0:466) cvn /DEST pdfmark end
 -2 2466 a Black 396 2597
a Fe(\225)p Black 479 2597 a
SDict begin H.S end
 479 2597 a 479 2597 a
SDict begin 13 H.A end
 479
2597 a 479 2597 a
SDict begin [/View [/XYZ H.V]/Dest (0:467) cvn /DEST pdfmark end
 479 2597 a Fj(Ho)n(w)g(to)h(b)n(uild)e(a)i(simple)f
(message)g(queuing)f(brok)o(er)-5 b(.)-2 2615 y
SDict begin H.S end
 -2 2615
a -2 2615 a
SDict begin 13 H.A end
 -2 2615 a -2 2615 a
SDict begin [/View [/XYZ H.V]/Dest (0:468) cvn /DEST pdfmark end
 -2 2615 a Black 396 2747
a Fe(\225)p Black 479 2747 a
SDict begin H.S end
 479 2747 a 479 2747 a
SDict begin 13 H.A end
 479
2747 a 479 2747 a
SDict begin [/View [/XYZ H.V]/Dest (0:469) cvn /DEST pdfmark end
 479 2747 a Fj(Ho)n(w)20 b(to)h(write)f(multithreaded)
e(applications)h(with)h(\330MQ.)-2 2765 y
SDict begin H.S end
 -2 2765 a -2
2765 a
SDict begin 13 H.A end
 -2 2765 a -2 2765 a
SDict begin [/View [/XYZ H.V]/Dest (0:470) cvn /DEST pdfmark end
 -2 2765 a Black 396 2896 a
Fe(\225)p Black 479 2896 a
SDict begin H.S end
 479 2896 a 479 2896 a
SDict begin 13 H.A end
 479
2896 a 479 2896 a
SDict begin [/View [/XYZ H.V]/Dest (0:471) cvn /DEST pdfmark end
 479 2896 a Fj(Ho)n(w)g(to)h(use)f(\330MQ)h(to)f
(signal)g(between)f(threads.)-2 2914 y
SDict begin H.S end
 -2 2914 a -2 2914
a
SDict begin 13 H.A end
 -2 2914 a -2 2914 a
SDict begin [/View [/XYZ H.V]/Dest (0:472) cvn /DEST pdfmark end
 -2 2914 a Black 396 3046 a Fe(\225)p
Black 479 3046 a
SDict begin H.S end
 479 3046 a 479 3046 a
SDict begin 13 H.A end
 479 3046 a 479
3046 a
SDict begin [/View [/XYZ H.V]/Dest (0:473) cvn /DEST pdfmark end
 479 3046 a Fj(Ho)n(w)h(to)h(use)f(\330MQ)h(to)f(coordinate)e(a)j
(netw)o(ork)e(of)h(nodes.)-2 3061 y
SDict begin H.S end
 -2 3061 a -2 3061
a
SDict begin 13 H.A end
 -2 3061 a -2 3061 a
SDict begin [/View [/XYZ H.V]/Dest (0:474) cvn /DEST pdfmark end
 -2 3061 a Black 396 3195 a Fe(\225)p
Black 479 3195 a
SDict begin H.S end
 479 3195 a 479 3195 a
SDict begin 13 H.A end
 479 3195 a 479
3195 a
SDict begin [/View [/XYZ H.V]/Dest (0:475) cvn /DEST pdfmark end
 479 3195 a Fj(Ho)n(w)g(to)h(create)f(and)f(use)i(message)f(en)m
(v)o(elopes)e(for)h(publish-subscribe.)-2 3213 y
SDict begin H.S end
 -2 3213
a -2 3213 a
SDict begin 13 H.A end
 -2 3213 a -2 3213 a
SDict begin [/View [/XYZ H.V]/Dest (0:476) cvn /DEST pdfmark end
 -2 3213 a Black 396 3344
a Fe(\225)p Black 479 3344 a
SDict begin H.S end
 479 3344 a 479 3344 a
SDict begin 13 H.A end
 479
3344 a 479 3344 a
SDict begin [/View [/XYZ H.V]/Dest (0:477) cvn /DEST pdfmark end
 479 3344 a Fj(Using)h(the)h(high-w)o(ater)d(mark)i
(\(HWM\))g(to)g(protect)f(against)h(memory)e(o)o(v)o(er\003o)n(ws.)-2
3362 y
SDict begin H.S end
 -2 3362 a -2 3362 a
SDict begin 13 H.A end
 -2 3362 a -2 3362 a
SDict begin [/View [/XYZ H.V]/Dest (0:478) cvn /DEST pdfmark end
 -2 3362
a 360 x Fh(2.1.)39 b(The)g(Soc)m(ket)f(API)1319 3722
y
SDict begin H.S end
 1319 3722 a 1319 3722 a
SDict begin 22.464 H.A end
 1319 3722 a 1319 3722 a
SDict begin [/View [/XYZ H.V]/Dest (7.19.1) cvn /DEST pdfmark end
 1319
3722 a -2 3889 a
SDict begin H.S end
 -2 3889 a -2 3889 a
SDict begin 13 H.A end
 -2 3889 a -2 3889
a
SDict begin [/View [/XYZ H.V]/Dest (0:480) cvn /DEST pdfmark end
 -2 3889 a 396 3996 a Fj(T)-7 b(o)21 b(be)f(perfectly)f(honest,)g
(\330MQ)h(does)g(a)h(kind)e(of)h(switch-and-bait)e(on)i(you.)f(Which)h
(we)h(don')o(t)d(apologize)h(for)m(,)g(it')-5 b(s)396
4103 y(for)20 b(your)f(o)n(wn)g(good)g(and)h(hurts)g(us)g(more)g(than)f
(it)i(hurts)f(you.)f(It)i(presents)e(a)i(f)o(amiliar)f(sock)o(et-based)
e(API,)j(which)396 4211 y(requires)e(great)h(ef)n(fort)f(for)h(us)g(to)
h(hide)e(a)i(b)n(unch)e(of)h(message-processing)e(engines.)h(Ho)n(we)n
(v)o(er)m(,)f(the)i(result)g(will)396 4319 y(slo)n(wly)g(\002x)h(your)e
(w)o(orld-vie)n(w)f(about)i(ho)n(w)f(to)i(design)e(and)h(write)g
(distrib)n(uted)f(softw)o(are.)-2 4503 y
SDict begin H.S end
 -2 4503 a -2
4503 a
SDict begin 13 H.A end
 -2 4503 a -2 4503 a
SDict begin [/View [/XYZ H.V]/Dest (0:481) cvn /DEST pdfmark end
 -2 4503 a 396 4593 a Fj(Sock)o(ets)h(are)h
(the)f(de-f)o(acto)f(standard)g(API)h(for)g(netw)o(ork)f(programming,)d
(as)21 b(well)g(as)g(being)e(useful)h(for)f(stopping)396
4701 y(your)g(e)o(yes)h(from)f(f)o(alling)h(onto)f(your)g(cheeks.)h
(One)g(thing)f(that)i(mak)o(es)f(\330MQ)g(especially)g(tasty)g(to)h(de)
n(v)o(elopers)d(is)396 4809 y(that)i(it)h(uses)f(sock)o(ets)g(and)f
(messages)h(instead)g(of)f(some)h(other)f(arbitrary)f(set)j(of)e
(concepts.)g(K)o(udos)g(to)h(Martin)f(Sustrik)396 4917
y(for)g(pulling)f(this)i(of)n(f.)f(It)h(turns)f("Message)g(Oriented)g
(Middle)n(w)o(are",)f(a)i(phrase)e(guaranteed)g(to)h(send)g(the)h
(whole)f(room)396 5025 y(of)n(f)h(to)g(Catatonia,)g(into)g("Extra)f
(Spic)o(y)h(Sock)o(ets!")g(which)f(lea)n(v)o(es)i(us)f(with)g(a)h
(strange)f(cra)n(ving)f(for)g(pizza,)h(and)g(a)396 5133
y(desire)g(to)h(kno)n(w)e(more.)p Black 3800 5569 a Fi(29)p
Black eop end
%%Page: 30 44
TeXDict begin 30 43 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.30) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:482) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Lik)o(e)20 b(a)h(f)o(a)n(v)n(orite)f
(dish,)g(\330MQ)g(sock)o(ets)g(are)h(easy)f(to)g(digest.)g(Sock)o(ets)g
(ha)n(v)o(e)g(a)g(life)h(in)f(four)f(parts,)h(just)h(lik)o(e)f(BSD)396
180 y(sock)o(ets:)-2 181 y
SDict begin H.S end
 -2 181 a -2 181 a
SDict begin 13 H.A end
 -2 181 a
-2 181 a
SDict begin [/View [/XYZ H.V]/Dest (0:483) cvn /DEST pdfmark end
 -2 181 a -2 191 a
SDict begin H.S end
 -2 191 a -2 191 a
SDict begin 13 H.A end
 -2 191 a
-2 191 a
SDict begin [/View [/XYZ H.V]/Dest (0:484) cvn /DEST pdfmark end
 -2 191 a Black 396 351 a Fe(\225)p Black 479
351 a
SDict begin H.S end
 479 351 a 479 351 a
SDict begin 13 H.A end
 479 351 a 479 351 a
SDict begin [/View [/XYZ H.V]/Dest (0:485) cvn /DEST pdfmark end
 479 351
a Fj(Creating)g(and)g(destro)o(ying)e(sock)o(ets,)i(which)g(go)g
(together)e(to)j(form)e(a)i(karmic)e(circle)h(of)g(sock)o(et)g(life)g
(\(see)479 459 y
SDict begin H.S end
 479 459 a 479 459 a
SDict begin 13 H.A end
 479 459 a 479 459
a
SDict begin [/View [/XYZ H.V]/Dest (0:486) cvn /DEST pdfmark end
 479 459 a Fg(zmq-socket[3])p Fj(,)f({{zmq-close[3]\).)-2
477 y
SDict begin H.S end
 -2 477 a -2 477 a
SDict begin 13 H.A end
 -2 477 a -2 477 a
SDict begin [/View [/XYZ H.V]/Dest (0:487) cvn /DEST pdfmark end
 -2 477 a Black
396 608 a Fe(\225)p Black 479 608 a
SDict begin H.S end
 479 608 a 479 608
a
SDict begin 13 H.A end
 479 608 a 479 608 a
SDict begin [/View [/XYZ H.V]/Dest (0:488) cvn /DEST pdfmark end
 479 608 a Fj(Con\002guring)f(sock)o(ets)j(by)e
(setting)i(options)e(on)h(them)f(and)h(checking)f(them)g(if)i
(necessary)e(\(see)479 716 y
SDict begin H.S end
 479 716 a 479 716 a
SDict begin 13 H.A end
 479
716 a 479 716 a
SDict begin [/View [/XYZ H.V]/Dest (0:489) cvn /DEST pdfmark end
 479 716 a Fg(zmq-setsockopt[3])p Fj(,)f({{zmq-getsock)o
(opt[3]\).)-2 734 y
SDict begin H.S end
 -2 734 a -2 734 a
SDict begin 13 H.A end
 -2 734 a -2 734
a
SDict begin [/View [/XYZ H.V]/Dest (0:490) cvn /DEST pdfmark end
 -2 734 a Black 396 865 a Fe(\225)p Black 479 865 a
SDict begin H.S end

479 865 a 479 865 a
SDict begin 13 H.A end
 479 865 a 479 865 a
SDict begin [/View [/XYZ H.V]/Dest (0:491) cvn /DEST pdfmark end
 479 865 a Fj(Plugging)h(sock)o
(ets)h(onto)g(the)g(netw)o(ork)f(topology)f(by)i(creating)f(\330MQ)h
(connections)f(to)h(and)g(from)f(them)g(\(see)479 973
y
SDict begin H.S end
 479 973 a 479 973 a
SDict begin 13 H.A end
 479 973 a 479 973 a
SDict begin [/View [/XYZ H.V]/Dest (0:492) cvn /DEST pdfmark end
 479 973 a Fg(zmq-bind[3])p
Fj(,)g({{zmq-connect[3]\).)-2 991 y
SDict begin H.S end
 -2 991 a -2 991 a
SDict begin 13 H.A end

-2 991 a -2 991 a
SDict begin [/View [/XYZ H.V]/Dest (0:493) cvn /DEST pdfmark end
 -2 991 a Black 396 1123 a Fe(\225)p
Black 479 1123 a
SDict begin H.S end
 479 1123 a 479 1123 a
SDict begin 13 H.A end
 479 1123 a 479
1123 a
SDict begin [/View [/XYZ H.V]/Dest (0:494) cvn /DEST pdfmark end
 479 1123 a Fj(Using)h(the)h(sock)o(ets)f(to)g(carry)g(data)g(by)
f(writing)h(and)g(recei)n(ving)e(messages)j(on)e(them)h(\(see)3133
1123 y
SDict begin H.S end
 3133 1123 a 3133 1123 a
SDict begin 13 H.A end
 3133 1123 a 3133 1123
a
SDict begin [/View [/XYZ H.V]/Dest (0:495) cvn /DEST pdfmark end
 3133 1123 a Fg(zmq-msg-send[3])p Fj(,)479 1231 y
({{zmq-msg-recv[3]\).)-2 1415 y
SDict begin H.S end
 -2 1415 a -2 1415 a
SDict begin 13 H.A end
 -2
1415 a -2 1415 a
SDict begin [/View [/XYZ H.V]/Dest (0:496) cvn /DEST pdfmark end
 -2 1415 a 396 1505 a Fj(Note)g(that)h(sock)o(ets)f
(are)g(al)o(w)o(ays)h(v)n(oid)f(pointers,)f(and)g(messages)h(\(which)g
(we')o(ll)g(come)g(to)g(v)o(ery)f(soon\))h(are)g(structures.)396
1613 y(So)h(in)f(C)h(you)e(pass)i(sock)o(ets)g(as-such,)e(b)n(ut)h(you)
f(pass)i(addresses)f(of)g(messages)g(in)h(all)f(functions)f(that)h(w)o
(ork)g(with)396 1720 y(messages,)g(lik)o(e)896 1720 y
SDict begin H.S end

896 1720 a 896 1720 a
SDict begin 13 H.A end
 896 1720 a 896 1720 a
SDict begin [/View [/XYZ H.V]/Dest (0:497) cvn /DEST pdfmark end
 896 1720
a Fg(zmq-msg-send[3])e Fj(and)1730 1720 y
SDict begin H.S end
 1730 1720 a
1730 1720 a
SDict begin 13 H.A end
 1730 1720 a 1730 1720 a
SDict begin [/View [/XYZ H.V]/Dest (0:498) cvn /DEST pdfmark end
 1730 1720 a Fg(zmq-msg-recv[3])p
Fj(.)g(As)j(a)f(mnemonic,)e(realize)i(that)h("in)f(\330MQ)g(all)396
1828 y(your)f(sock)o(ets)i(are)f(belong)e(to)j(us",)f(b)n(ut)g
(messages)g(are)h(things)e(you)h(actually)f(o)n(wn)h(in)g(your)f(code.)
-2 2012 y
SDict begin H.S end
 -2 2012 a -2 2012 a
SDict begin 13 H.A end
 -2 2012 a -2 2012 a
SDict begin [/View [/XYZ H.V]/Dest (0:499) cvn /DEST pdfmark end
 -2
2012 a 396 2102 a Fj(Creating,)h(destro)o(ying,)e(and)i(con\002guring)d
(sock)o(ets)j(w)o(orks)g(as)h(you')l(d)d(e)o(xpect)i(for)f(an)o(y)h
(object.)f(But)i(remember)d(that)396 2210 y(\330MQ)j(is)g(an)f
(asynchronous,)d(elastic)k(f)o(abric.)e(This)i(has)f(some)g(impact)g
(on)f(ho)n(w)h(we)h(plug)e(sock)o(ets)h(into)g(the)h(netw)o(ork)396
2318 y(topology)-5 b(,)18 b(and)h(ho)n(w)h(we)g(use)h(the)f(sock)o(ets)
g(after)g(that.)-2 2336 y
SDict begin H.S end
 -2 2336 a -2 2336 a
SDict begin 13 H.A end
 -2 2336
a -2 2336 a
SDict begin [/View [/XYZ H.V]/Dest (0:500) cvn /DEST pdfmark end
 -2 2336 a 396 2646 a Fd(2.1.1.)36 b(Plug)o(ging)d(Soc)n
(kets)h(Into)g(the)f(T)-10 b(opology)2753 2646 y
SDict begin H.S end
 2753
2646 a 2753 2646 a
SDict begin 18.72 H.A end
 2753 2646 a 2753 2646 a
SDict begin [/View [/XYZ H.V]/Dest (7.19.3.2) cvn /DEST pdfmark end
 2753 2646
a -2 2839 a
SDict begin H.S end
 -2 2839 a -2 2839 a
SDict begin 13 H.A end
 -2 2839 a -2 2839 a
SDict begin [/View [/XYZ H.V]/Dest (0:502) cvn /DEST pdfmark end
 -2
2839 a 396 2920 a Fj(T)j(o)20 b(create)f(a)h(connection)d(between)i(tw)
o(o)h(nodes)f(you)f(use)2091 2920 y
SDict begin H.S end
 2091 2920 a 2091
2920 a
SDict begin 13 H.A end
 2091 2920 a 2091 2920 a
SDict begin [/View [/XYZ H.V]/Dest (0:503) cvn /DEST pdfmark end
 2091 2920 a Fg(zmq-bind[3])g
Fj(in)i(one)f(node,)f(and)3171 2920 y
SDict begin H.S end
 3171 2920 a 3171
2920 a
SDict begin 13 H.A end
 3171 2920 a 3171 2920 a
SDict begin [/View [/XYZ H.V]/Dest (0:504) cvn /DEST pdfmark end
 3171 2920 a Fg(zmq-connect[3])g
Fj(in)396 3028 y(the)i(other)-5 b(.)20 b(As)h(a)g(general)e(rule)h(of)f
(thumb,)g(the)h(node)g(which)f(does)2356 3028 y
SDict begin H.S end
 2356
3028 a 2356 3028 a
SDict begin 13 H.A end
 2356 3028 a 2356 3028 a
SDict begin [/View [/XYZ H.V]/Dest (0:505) cvn /DEST pdfmark end
 2356 3028
a Fg(zmq-bind[3])g Fj(is)i(a)g("serv)o(er",)e(sitting)h(on)g(a)396
3136 y(well-kno)n(wn)f(netw)o(ork)g(address,)g(and)h(the)g(node)f
(which)h(does)2236 3136 y
SDict begin H.S end
 2236 3136 a 2236 3136 a
SDict begin 13 H.A end
 2236
3136 a 2236 3136 a
SDict begin [/View [/XYZ H.V]/Dest (0:506) cvn /DEST pdfmark end
 2236 3136 a Fg(zmq-connect[3])e Fj(is)j(a)g
("client",)e(with)i(unkno)n(wn)d(or)396 3244 y(arbitrary)h(netw)o(ork)g
(addresses.)g(Thus)h(we)h(say)f(that)h(we)f("bind)f(a)i(sock)o(et)f(to)
g(an)g(endpoint")f(and)g("connect)g(a)i(sock)o(et)f(to)396
3352 y(an)g(endpoint",)e(the)j(endpoint)d(being)h(that)h(well-kno)n(wn)
f(netw)o(ork)g(address.)-2 3536 y
SDict begin H.S end
 -2 3536 a -2 3536 a
SDict begin 13 H.A end

-2 3536 a -2 3536 a
SDict begin [/View [/XYZ H.V]/Dest (0:507) cvn /DEST pdfmark end
 -2 3536 a 396 3626 a Fj(\330MQ)i(connections)d(are)
i(some)n(what)g(dif)n(ferent)e(from)h(old-f)o(ashioned)f(TCP)j
(connections.)d(The)i(main)f(notable)396 3734 y(dif)n(ferences)g(are:)
-2 3735 y
SDict begin H.S end
 -2 3735 a -2 3735 a
SDict begin 13 H.A end
 -2 3735 a -2 3735 a
SDict begin [/View [/XYZ H.V]/Dest (0:508) cvn /DEST pdfmark end
 -2
3735 a -2 3745 a
SDict begin H.S end
 -2 3745 a -2 3745 a
SDict begin 13 H.A end
 -2 3745 a -2 3745
a
SDict begin [/View [/XYZ H.V]/Dest (0:509) cvn /DEST pdfmark end
 -2 3745 a Black 396 3904 a Fe(\225)p Black 479 3904
a
SDict begin H.S end
 479 3904 a 479 3904 a
SDict begin 13 H.A end
 479 3904 a 479 3904 a
SDict begin [/View [/XYZ H.V]/Dest (0:510) cvn /DEST pdfmark end
 479 3904
a Fj(The)o(y)g(go)h(across)g(an)h(arbitrary)d(transport)h(\()1751
3904 y
SDict begin H.S end
 1751 3904 a 1751 3904 a
SDict begin 13 H.A end
 1751 3904 a 1751 3904
a
SDict begin [/View [/XYZ H.V]/Dest (0:511) cvn /DEST pdfmark end
 1751 3904 a Fg(inproc)p Fj(,)2061 3904 y
SDict begin H.S end
 2061 3904
a 2061 3904 a
SDict begin 13 H.A end
 2061 3904 a 2061 3904 a
SDict begin [/View [/XYZ H.V]/Dest (0:512) cvn /DEST pdfmark end
 2061 3904 a Fg(ipc)p
Fj(,)2237 3904 y
SDict begin H.S end
 2237 3904 a 2237 3904 a
SDict begin 13 H.A end
 2237 3904 a
2237 3904 a
SDict begin [/View [/XYZ H.V]/Dest (0:513) cvn /DEST pdfmark end
 2237 3904 a Fg(tcp)p Fj(,)2413 3904 y
SDict begin H.S end
 2413
3904 a 2413 3904 a
SDict begin 13 H.A end
 2413 3904 a 2413 3904 a
SDict begin [/View [/XYZ H.V]/Dest (0:514) cvn /DEST pdfmark end
 2413 3904
a Fg(pgm)h Fj(or)2658 3904 y
SDict begin H.S end
 2658 3904 a 2658 3904 a
SDict begin 13 H.A end

2658 3904 a 2658 3904 a
SDict begin [/View [/XYZ H.V]/Dest (0:515) cvn /DEST pdfmark end
 2658 3904 a Fg(epgm)p Fj(\).)g(See)3047
3904 y
SDict begin H.S end
 3047 3904 a 3047 3904 a
SDict begin 13 H.A end
 3047 3904 a 3047 3904
a
SDict begin [/View [/XYZ H.V]/Dest (0:516) cvn /DEST pdfmark end
 3047 3904 a Fg(zmq-inproc[7])p Fj(,)479 4012 y
SDict begin H.S end
 479
4012 a 479 4012 a
SDict begin 13 H.A end
 479 4012 a 479 4012 a
SDict begin [/View [/XYZ H.V]/Dest (0:517) cvn /DEST pdfmark end
 479 4012 a Fg(zmq-ipc[7])p
Fj(,)969 4012 y
SDict begin H.S end
 969 4012 a 969 4012 a
SDict begin 13 H.A end
 969 4012 a 969
4012 a
SDict begin [/View [/XYZ H.V]/Dest (0:518) cvn /DEST pdfmark end
 969 4012 a Fg(zmq-tcp[7])p Fj(,)1459 4012 y
SDict begin H.S end
 1459
4012 a 1459 4012 a
SDict begin 13 H.A end
 1459 4012 a 1459 4012 a
SDict begin [/View [/XYZ H.V]/Dest (0:519) cvn /DEST pdfmark end
 1459 4012
a Fg(zmq-pgm[7])p Fj(,)f(and)2089 4012 y
SDict begin H.S end
 2089 4012 a
2089 4012 a
SDict begin 13 H.A end
 2089 4012 a 2089 4012 a
SDict begin [/View [/XYZ H.V]/Dest (0:520) cvn /DEST pdfmark end
 2089 4012 a Fg(zmq-epgm[7])p
Fj(.)-2 4024 y
SDict begin H.S end
 -2 4024 a -2 4024 a
SDict begin 13 H.A end
 -2 4024 a -2 4024
a
SDict begin [/View [/XYZ H.V]/Dest (0:521) cvn /DEST pdfmark end
 -2 4024 a Black 396 4161 a Fe(\225)p Black 479 4161
a
SDict begin H.S end
 479 4161 a 479 4161 a
SDict begin 13 H.A end
 479 4161 a 479 4161 a
SDict begin [/View [/XYZ H.V]/Dest (0:522) cvn /DEST pdfmark end
 479 4161
a Fj(One)h(sock)o(et)g(may)g(ha)n(v)o(e)g(man)o(y)f(outgoing)f(and)h
(man)o(y)g(incoming)g(connections.)-2 4179 y
SDict begin H.S end
 -2 4179
a -2 4179 a
SDict begin 13 H.A end
 -2 4179 a -2 4179 a
SDict begin [/View [/XYZ H.V]/Dest (0:523) cvn /DEST pdfmark end
 -2 4179 a Black 396 4311
a Fe(\225)p Black 479 4311 a
SDict begin H.S end
 479 4311 a 479 4311 a
SDict begin 13 H.A end
 479
4311 a 479 4311 a
SDict begin [/View [/XYZ H.V]/Dest (0:524) cvn /DEST pdfmark end
 479 4311 a Fj(There)h(is)h(no)f({{zmq-accept\(\))d
(method.)i(When)h(a)g(sock)o(et)g(is)h(bound)e(to)h(an)g(endpoint)e(it)
j(automatically)e(starts)479 4419 y(accepting)g(connections.)-2
4437 y
SDict begin H.S end
 -2 4437 a -2 4437 a
SDict begin 13 H.A end
 -2 4437 a -2 4437 a
SDict begin [/View [/XYZ H.V]/Dest (0:525) cvn /DEST pdfmark end
 -2 4437
a Black 396 4568 a Fe(\225)p Black 479 4568 a
SDict begin H.S end
 479 4568
a 479 4568 a
SDict begin 13 H.A end
 479 4568 a 479 4568 a
SDict begin [/View [/XYZ H.V]/Dest (0:526) cvn /DEST pdfmark end
 479 4568 a Fj(The)h(netw)o(ork)f
(connection)f(itself)j(happens)e(in)h(the)g(background,)d(and)i(\330MQ)
i(will)g(automatically)e(re-connect)f(if)479 4676 y(the)i(netw)o(ork)f
(connection)g(is)i(brok)o(en)d(\(e.g.)h(if)i(the)f(peer)g(disappears)f
(and)h(then)f(comes)h(back\).)-2 4694 y
SDict begin H.S end
 -2 4694 a -2
4694 a
SDict begin 13 H.A end
 -2 4694 a -2 4694 a
SDict begin [/View [/XYZ H.V]/Dest (0:527) cvn /DEST pdfmark end
 -2 4694 a Black 396 4826 a
Fe(\225)p Black 479 4826 a
SDict begin H.S end
 479 4826 a 479 4826 a
SDict begin 13 H.A end
 479
4826 a 479 4826 a
SDict begin [/View [/XYZ H.V]/Dest (0:528) cvn /DEST pdfmark end
 479 4826 a Fj(Y)-9 b(our)20 b(application)e(code)i
(cannot)f(w)o(ork)g(with)i(these)f(connections)e(directly;)i(the)o(y)f
(are)h(encapsulated)f(under)g(the)479 4934 y(sock)o(et.)p
Black 3800 5569 a Fi(30)p Black eop end
%%Page: 31 45
TeXDict begin 31 44 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.31) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:529) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Man)o(y)19 b(architectures)g(follo)n(w)h
(some)g(kind)f(of)h(client-serv)o(er)f(model,)g(where)g(the)h(serv)o
(er)g(is)h(the)f(component)e(that)i(is)396 180 y(most)g(static,)h(and)f
(the)g(clients)h(are)f(the)g(components)e(that)i(are)g(most)h(dynamic,)
d(i.e.)i(the)o(y)g(come)f(and)h(go)g(the)g(most.)396
288 y(There)g(are)g(sometimes)g(issues)h(of)f(addressing:)f(serv)o(ers)
g(will)i(be)f(visible)g(to)h(clients,)f(b)n(ut)g(not)g(necessarily)396
396 y(vice-v)o(ersa.)f(So)h(mostly)g(it')-5 b(s)21 b(ob)o(vious)e
(which)g(node)g(should)h(be)g(doing)2495 396 y
SDict begin H.S end
 2495 396
a 2495 396 a
SDict begin 13 H.A end
 2495 396 a 2495 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:530) cvn /DEST pdfmark end
 2495 396 a Fg(zmq-bind[3])f
Fj(\(the)g(serv)o(er\))g(and)h(which)396 504 y(should)f(be)i(doing)947
504 y
SDict begin H.S end
 947 504 a 947 504 a
SDict begin 13 H.A end
 947 504 a 947 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:531) cvn /DEST pdfmark end
 947 504
a Fg(zmq-connect[3])e Fj(\(the)h(client\).)f(It)i(also)f(depends)f(on)h
(the)g(kind)f(of)h(sock)o(ets)h(you')l(re)d(using,)h(with)396
612 y(some)h(e)o(xceptions)f(for)g(unusual)g(netw)o(ork)g
(architectures.)g(W)-7 b(e')o(ll)21 b(look)f(at)g(sock)o(et)h(types)f
(later)-5 b(.)-2 796 y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2
796 a
SDict begin [/View [/XYZ H.V]/Dest (0:532) cvn /DEST pdfmark end
 -2 796 a 396 886 a Fj(No)n(w)g(,)19 b(imagine)g(we)i(start)f(the)
g(client)1487 886 y
SDict begin H.S end
 1487 886 a 1487 886 a
SDict begin 13 H.A end
 1487 886 a
1487 886 a
SDict begin [/View [/XYZ H.V]/Dest (0:533) cvn /DEST pdfmark end
 1487 886 a Fi(befor)m(e)f Fj(we)h(start)h(the)f(serv)o(er)-5
b(.)19 b(In)g(traditional)g(netw)o(orking)f(we)i(get)g(a)g(big)g(red)f
(F)o(ail)396 994 y(\003ag.)h(But)h(\330MQ)f(lets)i(us)e(start)h(and)e
(stop)i(pieces)f(arbitrarily)-5 b(.)18 b(As)j(soon)f(as)g(the)h(client)
f(node)f(does)396 1102 y
SDict begin H.S end
 396 1102 a 396 1102 a
SDict begin 13 H.A end
 396 1102
a 396 1102 a
SDict begin [/View [/XYZ H.V]/Dest (0:534) cvn /DEST pdfmark end
 396 1102 a Fg(zmq-connect[3])g Fj(the)h(connection)e(e)o
(xists)j(and)e(that)h(node)g(can)g(start)g(to)h(write)f(messages)g(to)h
(the)f(sock)o(et.)g(At)g(some)396 1210 y(stage)h(\(hopefully)c(before)i
(messages)h(queue)f(up)h(so)h(much)e(that)h(the)o(y)g(start)g(to)h(get)
f(discarded,)f(or)h(the)g(client)g(blocks\),)396 1318
y(the)g(serv)o(er)g(comes)g(ali)n(v)o(e,)f(does)h(a)1404
1318 y
SDict begin H.S end
 1404 1318 a 1404 1318 a
SDict begin 13 H.A end
 1404 1318 a 1404 1318
a
SDict begin [/View [/XYZ H.V]/Dest (0:535) cvn /DEST pdfmark end
 1404 1318 a Fg(zmq-bind[3])f Fj(and)g(\330MQ)i(starts)g(to)f(deli)n
(v)o(er)f(messages.)-2 1502 y
SDict begin H.S end
 -2 1502 a -2 1502 a
SDict begin 13 H.A end
 -2
1502 a -2 1502 a
SDict begin [/View [/XYZ H.V]/Dest (0:536) cvn /DEST pdfmark end
 -2 1502 a 396 1592 a Fj(A)i(serv)o(er)e(node)g(can)h
(bind)g(to)g(man)o(y)f(endpoints)g(\(that)h(is,)h(a)f(combination)e(of)
i(protocol)e(and)i(address\))f(and)h(it)h(can)f(do)396
1700 y(this)h(using)f(a)g(single)g(sock)o(et.)g(This)h(means)e(it)i
(will)g(accept)f(connections)e(across)j(dif)n(ferent)d(transports:)-2
1801 y
SDict begin H.S end
 -2 1801 a -2 1801 a
SDict begin 11.7 H.A end
 -2 1801 a -2 1801 a
SDict begin [/View [/XYZ H.V]/Dest (0:537) cvn /DEST pdfmark end
 -2 1801
a 396 1880 a Fg(zmq-bind)44 b(\(socket,)f("tcp://)1518
1893 y(*)1563 1880 y(:5555"\);)396 1977 y(zmq-bind)h(\(socket,)f
("tcp://)1518 1990 y(*)1563 1977 y(:9999"\);)396 2074
y(zmq-bind)h(\(socket,)f("inproc://somename"\);)-2 2252
y
SDict begin H.S end
 -2 2252 a -2 2252 a
SDict begin 13 H.A end
 -2 2252 a -2 2252 a
SDict begin [/View [/XYZ H.V]/Dest (0:538) cvn /DEST pdfmark end
 -2 2252 a 396
2348 a Fj(W)m(ith)21 b(most)f(transports)f(you)g(cannot)h(bind)f(to)h
(the)g(same)h(endpoint)d(twice,)i(unlik)o(e)g(for)g(e)o(xample)e(in)j
(UDP)-9 b(.)20 b(The)3677 2348 y
SDict begin H.S end
 3677 2348 a 3677 2348
a
SDict begin 13 H.A end
 3677 2348 a 3677 2348 a
SDict begin [/View [/XYZ H.V]/Dest (0:539) cvn /DEST pdfmark end
 3677 2348 a Fg(ipc)396 2456
y Fj(transport)f(does)h(ho)n(we)n(v)o(er)e(let)j(one)f(process)f(bind)h
(to)g(an)g(endpoint)f(already)g(used)h(by)f(a)i(\002rst)g(process.)e
(It')-5 b(s)21 b(meant)f(to)396 2564 y(allo)n(w)g(a)h(process)f(to)g
(reco)o(v)o(er)e(after)i(a)h(crash.)-2 2748 y
SDict begin H.S end
 -2 2748
a -2 2748 a
SDict begin 13 H.A end
 -2 2748 a -2 2748 a
SDict begin [/View [/XYZ H.V]/Dest (0:540) cvn /DEST pdfmark end
 -2 2748 a 396 2838 a
Fj(Although)d(\330MQ)h(tries)h(to)g(be)f(neutral)g(about)f(which)h
(side)h(binds,)e(and)h(which)g(side)g(connects,)g(there)f(are)i(dif)n
(ferences.)396 2946 y(W)-7 b(e')o(ll)22 b(see)e(these)h(in)f(more)f
(detail)i(later)-5 b(.)20 b(The)g(upshot)f(is)i(that)g(you)e(should)g
(usually)h(think)f(in)h(terms)h(of)f("serv)o(ers")f(as)396
3054 y(static)i(parts)f(of)g(your)f(topology)-5 b(,)18
b(that)i(bind)f(to)i(more-or)n(-less)d(\002x)o(ed)i(endpoints,)e(and)i
("clients")g(as)h(dynamic)e(parts)396 3162 y(that)i(come)e(and)h(go)g
(and)f(connect)g(to)h(these)h(endpoints.)d(Then,)h(design)h(your)f
(application)g(around)f(this)j(model.)e(The)396 3270
y(chances)h(that)g(it)h(will)g("just)g(w)o(ork")e(are)h(much)f(better)h
(lik)o(e)h(that.)-2 3454 y
SDict begin H.S end
 -2 3454 a -2 3454 a
SDict begin 13 H.A end
 -2 3454
a -2 3454 a
SDict begin [/View [/XYZ H.V]/Dest (0:541) cvn /DEST pdfmark end
 -2 3454 a 396 3544 a Fj(Sock)o(ets)f(ha)n(v)o(e)g(types.)g
(The)g(sock)o(et)g(type)f(de\002nes)h(the)h(semantics)f(of)g(the)g
(sock)o(et,)g(its)h(policies)f(for)g(routing)e(messages)396
3652 y(inw)o(ards)i(and)g(outw)o(ards,)f(queuing,)f(etc.)i(Y)-9
b(ou)20 b(can)g(connect)f(certain)g(types)h(of)g(sock)o(et)g(together)m
(,)e(e.g.)i(a)h(publisher)396 3759 y(sock)o(et)f(and)g(a)h(subscriber)e
(sock)o(et.)g(Sock)o(ets)i(w)o(ork)e(together)g(in)h("messaging)f
(patterns".)h(W)-7 b(e')o(ll)21 b(look)e(at)i(this)g(in)f(more)396
3867 y(detail)g(later)-5 b(.)-2 4034 y
SDict begin H.S end
 -2 4034 a -2 4034
a
SDict begin 13 H.A end
 -2 4034 a -2 4034 a
SDict begin [/View [/XYZ H.V]/Dest (0:542) cvn /DEST pdfmark end
 -2 4034 a 396 4141 a Fj(It')g(s)21
b(the)f(ability)g(to)h(connect)e(sock)o(ets)h(in)g(these)h(dif)n
(ferent)d(w)o(ays)j(that)f(gi)n(v)o(es)g(\330MQ)g(its)h(basic)g(po)n
(wer)e(as)i(a)f(message)396 4249 y(queuing)f(system.)h(There)f(are)h
(layers)g(on)g(top)g(of)g(this,)g(such)g(as)h(proxies,)e(which)h(we')o
(ll)g(get)g(to)h(later)-5 b(.)20 b(But)h(essentially)-5
b(,)396 4357 y(with)21 b(\330MQ)f(you)f(de\002ne)h(your)f(netw)o(ork)g
(architecture)g(by)g(plugging)f(pieces)j(together)d(lik)o(e)j(a)f
(child')-5 b(s)21 b(construction)396 4465 y(to)o(y)-5
b(.)-2 4494 y
SDict begin H.S end
 -2 4494 a -2 4494 a
SDict begin 13 H.A end
 -2 4494 a -2 4494 a
SDict begin [/View [/XYZ H.V]/Dest (0:543) cvn /DEST pdfmark end

-2 4494 a 396 4804 a Fd(2.1.2.)36 b(Using)e(Soc)n(kets)g(to)f(Carr)q(y)
h(Data)2334 4804 y
SDict begin H.S end
 2334 4804 a 2334 4804 a
SDict begin 18.72 H.A end
 2334 4804
a 2334 4804 a
SDict begin [/View [/XYZ H.V]/Dest (7.19.4.2) cvn /DEST pdfmark end
 2334 4804 a -2 4996 a
SDict begin H.S end
 -2 4996 a -2 4996
a
SDict begin 13 H.A end
 -2 4996 a -2 4996 a
SDict begin [/View [/XYZ H.V]/Dest (0:545) cvn /DEST pdfmark end
 -2 4996 a 396 5078 a Fj(T)-7 b(o)21
b(send)f(and)f(recei)n(v)o(e)g(messages)i(you)e(use)h(the)1807
5078 y
SDict begin H.S end
 1807 5078 a 1807 5078 a
SDict begin 13 H.A end
 1807 5078 a 1807 5078
a
SDict begin [/View [/XYZ H.V]/Dest (0:546) cvn /DEST pdfmark end
 1807 5078 a Fg(zmq-msg-send[3])e Fj(and)2640 5078 y
SDict begin H.S end

2640 5078 a 2640 5078 a
SDict begin 13 H.A end
 2640 5078 a 2640 5078 a
SDict begin [/View [/XYZ H.V]/Dest (0:547) cvn /DEST pdfmark end
 2640
5078 a Fg(zmq-msg-recv[3])h Fj(methods.)g(The)p Black
3800 5569 a Fi(31)p Black eop end
%%Page: 32 46
TeXDict begin 32 45 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.32) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:566) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(names)20 b(are)g(con)m(v)o(entional)d(b)n
(ut)k(\330MQ')-5 b(s)20 b(I/O)h(model)e(is)i(dif)n(ferent)e(enough)f
(from)h(the)h(TCP)h(model\()p 0 TeXcolorgray 3311 72
a
SDict begin H.S end
 3311 72 a Fj(Figure)d(2-1)3659 72 y
SDict begin 13 H.L end
 3659 72 a 3659
72 a
SDict begin [/Subtype /Link/Dest (0:figure-9) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3659 72 a Black -1 w Fj(\))i(that)396 180 y(you)g(will)g(need)g
(time)g(to)h(get)f(your)f(head)g(around)g(it.)-2 198
y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-9) cvn /DEST pdfmark end
 -2 198 a 396 382
a Fk(Figur)o(e)h(2-1.)f(TCP)i(sock)o(ets)f(ar)o(e)g(1)g(to)g(1)-2
482 y
SDict begin H.S end
 -2 482 a -2 482 a
SDict begin 13 H.A end
 -2 482 a -2 482 a
SDict begin [/View [/XYZ H.V]/Dest (0:551) cvn /DEST pdfmark end
 -2 482 a 396
3206 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3206 a @beginspecial 0 @llx -322 @lly 180
@urx 0 @ury 1800 @rwi @setspecial
%%BeginDocument: images/fig9.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -322 180 0
%%HiResBoundingBox: 0.0 -322.0 180.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -92.00029754638672 lineto
158.00030517578125 -92.00029754638672 lineto
158.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -96.00029754638672 moveto
28.00029945373535 -115.00029754638672 lineto
28.00029945373535 -119.66696421305339 29.666966756184895 -122.00029754638672 33.000301361083984 -122.00029754638672 curveto
153.00030517578125 -122.00029754638672 lineto
153.00030517578125 -122.00029754638672 lineto
156.3336385091146 -122.00029754638672 158.00030517578125 -119.66696421305339 158.00030517578125 -115.00029754638672 curveto
158.00030517578125 -96.00029754638672 lineto
158.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -206.00030517578125 moveto
29.666966756184895 -206.00030517578125 28.00029945373535 -208.3336385091146 28.00029945373535 -213.00030517578125 curveto
28.00029945373535 -232.00030517578125 lineto
158.00030517578125 -232.00030517578125 lineto
158.00030517578125 -213.00030517578125 lineto
158.00030517578125 -208.3336385091146 156.3336385091146 -206.00030517578125 153.00030517578125 -206.00030517578125 curveto
33.000301361083984 -206.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -236.00030517578125 moveto
28.00029945373535 -290.00030517578125 lineto
158.00030517578125 -290.00030517578125 lineto
158.00030517578125 -236.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
155.0 -89.0 lineto
155.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
155.0 -89.0 lineto
155.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
150.0 -119.0 lineto
150.0 -119.0 lineto
153.33333333333334 -119.0 155.0 -116.66666666666667 155.0 -112.0 curveto
155.0 -93.0 lineto
155.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
150.0 -119.0 lineto
150.0 -119.0 lineto
153.33333333333334 -119.0 155.0 -116.66666666666667 155.0 -112.0 curveto
155.0 -93.0 lineto
155.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -203.0 moveto
26.666666666666668 -203.0 25.0 -205.33333333333334 25.0 -210.0 curveto
25.0 -229.0 lineto
155.0 -229.0 lineto
155.0 -210.0 lineto
155.0 -205.33333333333334 153.33333333333334 -203.0 150.0 -203.0 curveto
30.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -203.0 moveto
26.666666666666668 -203.0 25.0 -205.33333333333334 25.0 -210.0 curveto
25.0 -229.0 lineto
155.0 -229.0 lineto
155.0 -210.0 lineto
155.0 -205.33333333333334 153.33333333333334 -203.0 150.0 -203.0 curveto
30.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -233.0 moveto
25.0 -287.0 lineto
155.0 -287.0 lineto
155.0 -233.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -233.0 moveto
25.0 -287.0 lineto
155.0 -287.0 lineto
155.0 -233.0 lineto
closepath
stroke
newpath
85.0 -133.0 moveto
85.0 -189.0 lineto
stroke
newpath
85.0 -126.0 moveto
80.0 -140.0 lineto
90.0 -140.0 lineto
closepath
fill
newpath
80.0 -182.0 moveto
85.0 -196.0 lineto
90.0 -182.0 lineto
closepath
fill
/Helvetica findfont
13 scalefont setfont
71.0 -68.0 moveto
(Node) show
62.0 -110.0 moveto
(Socket) show
57.0 -166.0 moveto
(1 to 1) show
62.0 -222.0 moveto
(Socket) show
71.0 -264.0 moveto
(Node) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3206 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3206 a -2 3372 a
SDict begin H.S end
 -2 3372
a -2 3372 a
SDict begin 13 H.A end
 -2 3372 a -2 3372 a
SDict begin [/View [/XYZ H.V]/Dest (0:554) cvn /DEST pdfmark end
 -2 3372 a 396 3480 a
Fj(Let')-5 b(s)21 b(look)e(at)i(the)f(main)g(dif)n(ferences)f(between)g
(TCP)i(sock)o(ets)f(and)g(\330MQ)g(sock)o(ets)h(when)e(it)i(comes)f(to)
g(w)o(orking)396 3588 y(with)h(data:)-2 3589 y
SDict begin H.S end
 -2 3589
a -2 3589 a
SDict begin 13 H.A end
 -2 3589 a -2 3589 a
SDict begin [/View [/XYZ H.V]/Dest (0:555) cvn /DEST pdfmark end
 -2 3589 a -2 3599 a
SDict begin H.S end
 -2
3599 a -2 3599 a
SDict begin 13 H.A end
 -2 3599 a -2 3599 a
SDict begin [/View [/XYZ H.V]/Dest (0:556) cvn /DEST pdfmark end
 -2 3599 a Black
396 3759 a Fe(\225)p Black 479 3759 a
SDict begin H.S end
 479 3759 a 479
3759 a
SDict begin 13 H.A end
 479 3759 a 479 3759 a
SDict begin [/View [/XYZ H.V]/Dest (0:557) cvn /DEST pdfmark end
 479 3759 a Fj(\330MQ)g(sock)o(ets)f(carry)
f(messages,)h(rather)g(than)g(bytes)g(\(as)g(in)g(TCP\))h(or)f(frames)g
(\(as)g(in)h(UDP\).)f(A)g(message)g(is)479 3866 y(length-speci\002ed)e
(binary)h(data.)h(W)-7 b(e')o(ll)21 b(come)f(to)g(messages)h(shortly)-5
b(,)18 b(their)i(design)g(is)h(optimized)e(for)479 3974
y(performance)f(and)h(so)i(a)f(little)h(trick)o(y)-5
b(.)-2 3992 y
SDict begin H.S end
 -2 3992 a -2 3992 a
SDict begin 13 H.A end
 -2 3992 a -2 3992 a
SDict begin [/View [/XYZ H.V]/Dest (0:558) cvn /DEST pdfmark end

-2 3992 a Black 396 4124 a Fe(\225)p Black 479 4124 a
SDict begin H.S end

479 4124 a 479 4124 a
SDict begin 13 H.A end
 479 4124 a 479 4124 a
SDict begin [/View [/XYZ H.V]/Dest (0:559) cvn /DEST pdfmark end
 479 4124
a Fj(\330MQ)21 b(sock)o(ets)f(do)g(their)g(I/O)g(in)h(a)f(background)d
(thread.)i(This)h(means)g(that)g(messages)h(arri)n(v)o(e)e(in)h(local)g
(input)479 4232 y(queues,)f(and)h(are)g(sent)h(from)e(local)h(output)f
(queues,)g(no)h(matter)g(what)g(your)f(application)f(is)j(b)n(usy)f
(doing.)-2 4250 y
SDict begin H.S end
 -2 4250 a -2 4250 a
SDict begin 13 H.A end
 -2 4250 a -2 4250
a
SDict begin [/View [/XYZ H.V]/Dest (0:560) cvn /DEST pdfmark end
 -2 4250 a Black 396 4381 a Fe(\225)p Black 479 4381
a
SDict begin H.S end
 479 4381 a 479 4381 a
SDict begin 13 H.A end
 479 4381 a 479 4381 a
SDict begin [/View [/XYZ H.V]/Dest (0:561) cvn /DEST pdfmark end
 479 4381
a Fj(\330MQ)h(sock)o(ets)f(ha)n(v)o(e)g(one-to-N)e(routing)h(beha)n
(vior)f(b)n(uilt-in,)i(according)e(to)i(the)g(sock)o(et)g(type.)-2
4565 y
SDict begin H.S end
 -2 4565 a -2 4565 a
SDict begin 13 H.A end
 -2 4565 a -2 4565 a
SDict begin [/View [/XYZ H.V]/Dest (0:562) cvn /DEST pdfmark end
 -2 4565
a 396 4655 a Fj(The)546 4655 y
SDict begin H.S end
 546 4655 a 546 4655 a
SDict begin 13 H.A end

546 4655 a 546 4655 a
SDict begin [/View [/XYZ H.V]/Dest (0:563) cvn /DEST pdfmark end
 546 4655 a Fg(zmq-msg-send[3])e
Fj(method)h(does)h(not)g(actually)g(send)f(the)i(message)f(to)g(the)g
(sock)o(et)g(connection\(s\).)e(It)396 4763 y(queues)i(the)g(message)g
(so)g(that)h(the)f(I/O)g(thread)g(can)f(send)h(it)h(asynchronously)-5
b(.)17 b(It)j(does)g(not)g(block)f(e)o(xcept)g(in)i(some)396
4871 y(e)o(xception)e(cases.)h(So)h(the)f(message)g(is)h(not)f
(necessarily)g(sent)g(when)2436 4871 y
SDict begin H.S end
 2436 4871 a 2436
4871 a
SDict begin 13 H.A end
 2436 4871 a 2436 4871 a
SDict begin [/View [/XYZ H.V]/Dest (0:564) cvn /DEST pdfmark end
 2436 4871 a Fg(zmq-msg-send[3])e
Fj(returns)h(to)h(your)396 4979 y(application.)f(If)h(you)f(created)g
(a)i(message)f(using)1849 4979 y
SDict begin H.S end
 1849 4979 a 1849 4979
a
SDict begin 13 H.A end
 1849 4979 a 1849 4979 a
SDict begin [/View [/XYZ H.V]/Dest (0:565) cvn /DEST pdfmark end
 1849 4979 a Fg(zmq-msg-init-data[3])d
Fj(you)i(cannot)h(reuse)g(the)g(data)g(or)g(free)p Black
3800 5569 a Fi(32)p Black eop end
%%Page: 33 47
TeXDict begin 33 46 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.33) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(it,)21 b(otherwise)e(the)i(I/O)f(thread)f
(will)i(rapidly)e(\002nd)h(itself)h(writing)f(o)o(v)o(erwritten)e(or)h
(unallocated)g(garbage.)f(This)i(is)h(a)396 180 y(common)e(mistak)o(e)h
(for)f(be)o(ginners.)f(W)-7 b(e')o(ll)22 b(see)f(a)f(little)h(later)f
(ho)n(w)g(to)g(properly)e(w)o(ork)i(with)g(messages.)-2
209 y
SDict begin H.S end
 -2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:566) cvn /DEST pdfmark end
 -2 209 a 396
519 a Fd(2.1.3.)36 b(Unicast)f(T)-10 b(ranspor)r(ts)1810
519 y
SDict begin H.S end
 1810 519 a 1810 519 a
SDict begin 18.72 H.A end
 1810 519 a 1810 519 a
SDict begin [/View [/XYZ H.V]/Dest (7.19.5.2) cvn /DEST pdfmark end
 1810
519 a -2 710 a
SDict begin H.S end
 -2 710 a -2 710 a
SDict begin 13 H.A end
 -2 710 a -2 710 a
SDict begin [/View [/XYZ H.V]/Dest (0:568) cvn /DEST pdfmark end
 -2
710 a 396 793 a Fj(\330MQ)21 b(pro)o(vides)d(a)j(set)g(of)f(unicast)g
(transports)f(\()1809 793 y
SDict begin H.S end
 1809 793 a 1809 793 a
SDict begin 13 H.A end
 1809
793 a 1809 793 a
SDict begin [/View [/XYZ H.V]/Dest (0:569) cvn /DEST pdfmark end
 1809 793 a Fg(inproc)p Fj(,)2119 793
y
SDict begin H.S end
 2119 793 a 2119 793 a
SDict begin 13 H.A end
 2119 793 a 2119 793 a
SDict begin [/View [/XYZ H.V]/Dest (0:570) cvn /DEST pdfmark end
 2119 793
a Fg(ipc)p Fj(,)h(and)2436 793 y
SDict begin H.S end
 2436 793 a 2436 793
a
SDict begin 13 H.A end
 2436 793 a 2436 793 a
SDict begin [/View [/XYZ H.V]/Dest (0:571) cvn /DEST pdfmark end
 2436 793 a Fg(tcp)p Fj(\))f(and)h(multicast)g
(transports)g(\(epgm,)e(pgm\).)396 901 y(Multicast)j(is)g(an)f(adv)n
(anced)e(technique)h(that)h(we')o(ll)g(come)g(to)g(later)-5
b(.)21 b(Don')o(t)e(e)n(v)o(en)g(start)i(using)e(it)i(unless)g(you)e
(kno)n(w)396 1009 y(that)i(your)d(f)o(anout)i(ratios)g(will)h(mak)o(e)e
(1-to-N)h(unicast)f(impossible.)-2 1193 y
SDict begin H.S end
 -2 1193 a -2
1193 a
SDict begin 13 H.A end
 -2 1193 a -2 1193 a
SDict begin [/View [/XYZ H.V]/Dest (0:572) cvn /DEST pdfmark end
 -2 1193 a 396 1283 a Fj(F)o(or)h(most)g
(common)f(cases,)h(use)1373 1283 y
SDict begin H.S end
 1373 1283 a 1373 1283
a
SDict begin 13 H.A end
 1373 1283 a 1373 1283 a
SDict begin [/View [/XYZ H.V]/Dest (0:573) cvn /DEST pdfmark end
 1373 1283 a 1373 1283 a
SDict begin H.S end
 1373
1283 a 1373 1283 a
SDict begin 13 H.A end
 1373 1283 a 1373 1283 a
SDict begin [/View [/XYZ H.V]/Dest (0:574) cvn /DEST pdfmark end
 1373 1283
a Fc(tcp)p Fj(,)g(which)f(is)j(a)1906 1283 y
SDict begin H.S end
 1906 1283
a 1906 1283 a
SDict begin 13 H.A end
 1906 1283 a 1906 1283 a
SDict begin [/View [/XYZ H.V]/Dest (0:575) cvn /DEST pdfmark end
 1906 1283 a Fi(disconnected)c
(TCP)j Fj(transport.)e(It)i(is)g(elastic,)f(portable,)f(and)g(f)o(ast)
396 1391 y(enough)f(for)i(most)g(cases.)g(W)-7 b(e)22
b(call)e(this)h(')l(disconnected')c(because)j(\330MQ')-5
b(s)2646 1391 y
SDict begin H.S end
 2646 1391 a 2646 1391 a
SDict begin 13 H.A end
 2646 1391 a 2646
1391 a
SDict begin [/View [/XYZ H.V]/Dest (0:576) cvn /DEST pdfmark end
 2646 1391 a Fg(tcp)20 b Fj(transport)f(doesn')o(t)g(require)g
(that)h(the)396 1499 y(endpoint)e(e)o(xists)i(before)f(you)g(connect)f
(to)i(it.)h(Clients)f(and)g(serv)o(ers)f(can)g(connect)g(and)g(bind)g
(at)i(an)o(y)e(time,)g(can)h(go)f(and)396 1606 y(come)h(back,)f(and)h
(it)h(remains)e(transparent)g(to)h(applications.)-2 1790
y
SDict begin H.S end
 -2 1790 a -2 1790 a
SDict begin 13 H.A end
 -2 1790 a -2 1790 a
SDict begin [/View [/XYZ H.V]/Dest (0:577) cvn /DEST pdfmark end
 -2 1790 a 396
1880 a Fj(The)g(inter)n(-process)994 1880 y
SDict begin H.S end
 994 1880
a 994 1880 a
SDict begin 13 H.A end
 994 1880 a 994 1880 a
SDict begin [/View [/XYZ H.V]/Dest (0:578) cvn /DEST pdfmark end
 994 1880 a Fg(ipc)g
Fj(transport)f(is)i(disconnected,)d(lik)o(e)2161 1880
y
SDict begin H.S end
 2161 1880 a 2161 1880 a
SDict begin 13 H.A end
 2161 1880 a 2161 1880 a
SDict begin [/View [/XYZ H.V]/Dest (0:579) cvn /DEST pdfmark end
 2161
1880 a Fg(tcp)p Fj(.)i(It)g(has)h(one)e(limitation:)h(it)h(does)f(not)g
(yet)g(w)o(ork)f(on)396 1988 y(W)m(indo)n(ws.)h(By)g(con)m(v)o(ention)d
(we)k(use)f(endpoint)f(names)h(with)g(an)g(".ipc")g(e)o(xtension)e(to)j
(a)n(v)n(oid)f(potential)f(con\003ict)h(with)396 2096
y(other)g(\002le)g(names.)g(On)g(UNIX)h(systems,)f(if)g(you)g(use)1971
2096 y
SDict begin H.S end
 1971 2096 a 1971 2096 a
SDict begin 13 H.A end
 1971 2096 a 1971 2096
a
SDict begin [/View [/XYZ H.V]/Dest (0:580) cvn /DEST pdfmark end
 1971 2096 a Fg(ipc)g Fj(endpoints)f(you)g(need)h(to)g(create)g(these)
g(with)h(appropriate)396 2204 y(permissions)f(otherwise)f(the)o(y)h
(may)f(not)h(be)g(shareable)g(between)f(processes)h(running)e(under)h
(dif)n(ferent)f(user)i(IDs.)396 2312 y(Y)-9 b(ou)19 b(must)h(also)g
(mak)o(e)f(sure)g(all)i(processes)e(can)g(access)h(the)g(\002les,)g
(e.g.)f(by)h(running)d(in)j(the)f(same)h(w)o(orking)e(directory)-5
b(.)-2 2496 y
SDict begin H.S end
 -2 2496 a -2 2496 a
SDict begin 13 H.A end
 -2 2496 a -2 2496 a
SDict begin [/View [/XYZ H.V]/Dest (0:581) cvn /DEST pdfmark end

-2 2496 a 396 2586 a Fj(The)20 b(inter)n(-thread)f(transport,)1289
2586 y
SDict begin H.S end
 1289 2586 a 1289 2586 a
SDict begin 13 H.A end
 1289 2586 a 1289 2586
a
SDict begin [/View [/XYZ H.V]/Dest (0:582) cvn /DEST pdfmark end
 1289 2586 a 1289 2586 a
SDict begin H.S end
 1289 2586 a 1289 2586 a
SDict begin 13 H.A end
 1289
2586 a 1289 2586 a
SDict begin [/View [/XYZ H.V]/Dest (0:583) cvn /DEST pdfmark end
 1289 2586 a Fc(inproc)p Fj(,)h(is)h(a)f(connected)f
(signaling)g(transport.)g(It)h(is)h(much)e(f)o(aster)i(than)3473
2586 y
SDict begin H.S end
 3473 2586 a 3473 2586 a
SDict begin 13 H.A end
 3473 2586 a 3473 2586
a
SDict begin [/View [/XYZ H.V]/Dest (0:584) cvn /DEST pdfmark end
 3473 2586 a Fg(tcp)g Fj(or)3719 2586 y
SDict begin H.S end
 3719 2586 a
3719 2586 a
SDict begin 13 H.A end
 3719 2586 a 3719 2586 a
SDict begin [/View [/XYZ H.V]/Dest (0:585) cvn /DEST pdfmark end
 3719 2586 a Fg(ipc)p
Fj(.)396 2694 y(This)g(transport)e(has)h(a)h(speci\002c)f(limitation)g
(compared)e(to)2121 2694 y
SDict begin H.S end
 2121 2694 a 2121 2694 a
SDict begin 13 H.A end
 2121
2694 a 2121 2694 a
SDict begin [/View [/XYZ H.V]/Dest (0:586) cvn /DEST pdfmark end
 2121 2694 a Fg(ipc)i Fj(and)2417 2694
y
SDict begin H.S end
 2417 2694 a 2417 2694 a
SDict begin 13 H.A end
 2417 2694 a 2417 2694 a
SDict begin [/View [/XYZ H.V]/Dest (0:587) cvn /DEST pdfmark end
 2417
2694 a Fg(tcp)p Fj(:)2595 2694 y
SDict begin H.S end
 2595 2694 a 2595 2694
a
SDict begin 13 H.A end
 2595 2694 a 2595 2694 a
SDict begin [/View [/XYZ H.V]/Dest (0:588) cvn /DEST pdfmark end
 2595 2694 a Fk(the)h(ser)o(v)o(er)f(must)h
(issue)h(a)e(bind)h(bef)n(or)o(e)396 2802 y(any)f(client)h(issues)g(a)g
(connect)p Fj(.)e(This)i(is)g(something)d(future)h(v)o(ersions)h(of)g
(\330MQ)g(may)g(\002x,)g(b)n(ut)g(at)h(present)e(this)396
2910 y(de\002nes)h(you)g(use)929 2910 y
SDict begin H.S end
 929 2910 a 929
2910 a
SDict begin 13 H.A end
 929 2910 a 929 2910 a
SDict begin [/View [/XYZ H.V]/Dest (0:589) cvn /DEST pdfmark end
 929 2910 a Fg(inproc)g Fj(sock)o(ets.)g(W)
-7 b(e)21 b(create)f(and)g(bind)f(one)h(sock)o(et,)f(start)i(the)f
(child)g(threads,)f(which)h(create)g(and)396 3018 y(connect)f(the)h
(other)g(sock)o(ets.)-2 3029 y
SDict begin H.S end
 -2 3029 a -2 3029 a
SDict begin 13 H.A end
 -2
3029 a -2 3029 a
SDict begin [/View [/XYZ H.V]/Dest (0:590) cvn /DEST pdfmark end
 -2 3029 a 396 3356 a Fd(2.1.4.)36 b(\330MQ)c(is)i(Not)
g(a)f(Neutral)i(Carrier)2350 3356 y
SDict begin H.S end
 2350 3356 a 2350
3356 a
SDict begin 18.72 H.A end
 2350 3356 a 2350 3356 a
SDict begin [/View [/XYZ H.V]/Dest (7.19.6.2) cvn /DEST pdfmark end
 2350 3356 a -2 3529 a
SDict begin H.S end

-2 3529 a -2 3529 a
SDict begin 13 H.A end
 -2 3529 a -2 3529 a
SDict begin [/View [/XYZ H.V]/Dest (0:592) cvn /DEST pdfmark end
 -2 3529 a 396
3630 a Fj(A)21 b(common)d(question)h(that)i(ne)n(wcomers)d(to)j(\330MQ)
f(ask)h(\(it')-5 b(s)21 b(one)e(I)i(ask)o(ed)f(myself\))f(is,)i("ho)n
(w)e(do)h(I)h(write)f(an)g(XYZ)396 3738 y(serv)o(er)g(in)g(\330MQ?")g
(F)o(or)g(e)o(xample,)e("ho)n(w)i(do)g(I)g(write)h(an)f(HTTP)g(serv)o
(er)f(in)i(\330MQ?")-2 3922 y
SDict begin H.S end
 -2 3922 a -2 3922 a
SDict begin 13 H.A end
 -2
3922 a -2 3922 a
SDict begin [/View [/XYZ H.V]/Dest (0:593) cvn /DEST pdfmark end
 -2 3922 a 396 4012 a Fj(The)f(implication)f(is)i(that)
g(if)f(we)h(use)f(normal)f(sock)o(ets)h(to)h(carry)e(HTTP)h(requests)g
(and)g(responses,)f(we)i(should)e(be)396 4120 y(able)h(to)h(use)f
(\330MQ)h(sock)o(ets)f(to)g(do)g(the)g(same,)g(only)g(much)f(f)o(aster)
h(and)g(better)-5 b(.)-2 4304 y
SDict begin H.S end
 -2 4304 a -2 4304 a
SDict begin 13 H.A end
 -2
4304 a -2 4304 a
SDict begin [/View [/XYZ H.V]/Dest (0:594) cvn /DEST pdfmark end
 -2 4304 a 396 4394 a Fj(Sadly)20 b(the)g(answer)g(is)h
("this)g(is)g(not)f(ho)n(w)g(it)g(w)o(orks".)g(\330MQ)g(is)i(not)d(a)i
(neutral)e(carrier)m(,)g(it)i(imposes)f(a)h(framing)d(on)i(the)396
4502 y(transport)e(protocols)g(it)j(uses.)e(This)h(framing)e(is)i(not)f
(compatible)f(with)i(e)o(xisting)e(protocols,)g(which)h(tend)g(to)g
(use)h(their)396 4610 y(o)n(wn)g(framing.)e(F)o(or)i(e)o(xample,)f
(compare)f(an)i(HTTP)h(request\()p 0 TeXcolorgray 2222
4610 a
SDict begin H.S end
 2222 4610 a Fj(Figure)d(2-2)2570 4610 y
SDict begin 13 H.L end
 2570 4610
a 2570 4610 a
SDict begin [/Subtype /Link/Dest (0:figure-10) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2570 4610 a Black -2 w Fj(\),)i(and)g(a)h(\330MQ)f
(request\()p 0 TeXcolorgray 3319 4610 a
SDict begin H.S end
 3319 4610 a Fj(Figure)e(2-2)
3667 4610 y
SDict begin 13 H.L end
 3667 4610 a 3667 4610 a
SDict begin [/Subtype /Link/Dest (0:figure-10) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3667 4610 a Black
-1 w Fj(\),)i(both)396 4718 y(o)o(v)o(er)f(TCP/IP)-9
b(.)-2 4885 y
SDict begin H.S end
 -2 4885 a -2 4885 a
SDict begin 13 H.A end
 -2 4885 a -2 4885 a
SDict begin [/View [/XYZ H.V]/Dest (0:597) cvn /DEST pdfmark end

-2 4885 a 396 4992 a Fj(The)20 b(HTTP)g(request)g(uses)h(CR-LF)g(as)g
(its)g(simplest)f(framing)f(delimiter)m(,)g(whereas)h(\330MQ)g(uses)h
(a)f(length-speci\002ed)396 5100 y(frame)-2 5101 y
SDict begin H.S end
 -2
5101 a -2 5101 a
SDict begin 13 H.A end
 -2 5101 a -2 5101 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-10) cvn /DEST pdfmark
end
 -2 5101 a Black
3800 5569 a Fi(33)p Black eop end
%%Page: 34 48
TeXDict begin 34 47 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.34) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-2.)f(HTTP)i(On)f(the)h
(W)o(ir)o(e)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172
a
SDict begin [/View [/XYZ H.V]/Dest (0:600) cvn /DEST pdfmark end
 -2 172 a 396 1031 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 1031 a @beginspecial 0 @llx
-98 @lly 420 @urx 0 @ury 4200 @rwi @setspecial
%%BeginDocument: images/fig10.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -98 420 0
%%HiResBoundingBox: 0.0 -98.0 420.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -66.00029754638672 lineto
196.00030517578125 -66.00029754638672 lineto
196.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
200.00030517578125 -38.000301361083984 moveto
200.00030517578125 -66.00029754638672 lineto
246.00030517578125 -66.00029754638672 lineto
246.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.00030517578125 -38.000301361083984 moveto
250.00030517578125 -66.00029754638672 lineto
296.00030517578125 -66.00029754638672 lineto
296.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
300.00030517578125 -38.000301361083984 moveto
300.00030517578125 -66.00029754638672 lineto
346.00030517578125 -66.00029754638672 lineto
346.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
350.00030517578125 -38.000301361083984 moveto
350.00030517578125 -66.00029754638672 lineto
398.00030517578125 -66.00029754638672 lineto
398.00030517578125 -38.000301361083984 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -63.0 lineto
193.0 -63.0 lineto
193.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -63.0 lineto
193.0 -63.0 lineto
193.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
197.0 -35.0 moveto
197.0 -63.0 lineto
243.0 -63.0 lineto
243.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
197.0 -35.0 moveto
197.0 -63.0 lineto
243.0 -63.0 lineto
243.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
247.0 -35.0 moveto
247.0 -63.0 lineto
293.0 -63.0 lineto
293.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
247.0 -35.0 moveto
247.0 -63.0 lineto
293.0 -63.0 lineto
293.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
297.0 -35.0 moveto
297.0 -63.0 lineto
343.0 -63.0 lineto
343.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
297.0 -35.0 moveto
297.0 -63.0 lineto
343.0 -63.0 lineto
343.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
347.0 -35.0 moveto
347.0 -63.0 lineto
395.0 -63.0 lineto
395.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
347.0 -35.0 moveto
347.0 -63.0 lineto
395.0 -63.0 lineto
395.0 -35.0 lineto
closepath
stroke
/Helvetica findfont
15 scalefont setfont
50.0 -54.0 moveto
(GET /index.html) show
210.0 -54.0 moveto
(13) show
260.0 -54.0 moveto
(10) show
310.0 -54.0 moveto
(13) show
360.0 -54.0 moveto
(10) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1031 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1031 a -2 1031 a
SDict begin H.S end
 -2 1031
a -2 1031 a
SDict begin 13 H.A end
 -2 1031 a -2 1031 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-11) cvn /DEST pdfmark
end
 -2 1031 a 396 1305 a
Fk(Figur)o(e)f(2-3.)f(\330MQ)h(On)h(the)f(W)o(ir)o(e)-2
1404 y
SDict begin H.S end
 -2 1404 a -2 1404 a
SDict begin 13 H.A end
 -2 1404 a -2 1404 a
SDict begin [/View [/XYZ H.V]/Dest (0:605) cvn /DEST pdfmark end
 -2 1404
a 396 2263 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2263 a @beginspecial 0 @llx -98 @lly
290 @urx 0 @ury 2900 @rwi @setspecial
%%BeginDocument: images/fig11.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -98 290 0
%%HiResBoundingBox: 0.0 -98.0 290.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -66.00029754638672 lineto
66.00029754638672 -66.00029754638672 lineto
66.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
70.00029754638672 -38.000301361083984 moveto
70.00029754638672 -66.00029754638672 lineto
106.00029754638672 -66.00029754638672 lineto
106.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
110.00029754638672 -38.000301361083984 moveto
110.00029754638672 -66.00029754638672 lineto
146.00030517578125 -66.00029754638672 lineto
146.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.00030517578125 -38.000301361083984 moveto
150.00030517578125 -66.00029754638672 lineto
186.00030517578125 -66.00029754638672 lineto
186.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
190.00030517578125 -38.000301361083984 moveto
190.00030517578125 -66.00029754638672 lineto
226.00030517578125 -66.00029754638672 lineto
226.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
230.00030517578125 -38.000301361083984 moveto
230.00030517578125 -66.00029754638672 lineto
268.00030517578125 -66.00029754638672 lineto
268.00030517578125 -38.000301361083984 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -63.0 lineto
63.0 -63.0 lineto
63.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -63.0 lineto
63.0 -63.0 lineto
63.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
67.0 -35.0 moveto
67.0 -63.0 lineto
103.0 -63.0 lineto
103.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
67.0 -35.0 moveto
67.0 -63.0 lineto
103.0 -63.0 lineto
103.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
107.0 -35.0 moveto
107.0 -63.0 lineto
143.0 -63.0 lineto
143.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
107.0 -35.0 moveto
107.0 -63.0 lineto
143.0 -63.0 lineto
143.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -35.0 moveto
147.0 -63.0 lineto
183.0 -63.0 lineto
183.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -35.0 moveto
147.0 -63.0 lineto
183.0 -63.0 lineto
183.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
187.0 -35.0 moveto
187.0 -63.0 lineto
223.0 -63.0 lineto
223.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
187.0 -35.0 moveto
187.0 -63.0 lineto
223.0 -63.0 lineto
223.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
227.0 -35.0 moveto
227.0 -63.0 lineto
265.0 -63.0 lineto
265.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
227.0 -35.0 moveto
227.0 -63.0 lineto
265.0 -63.0 lineto
265.0 -35.0 lineto
closepath
stroke
/Helvetica findfont
15 scalefont setfont
43.0 -54.0 moveto
(5 ) show
82.0 -54.0 moveto
(H ) show
123.0 -54.0 moveto
(E ) show
163.0 -54.0 moveto
(L ) show
203.0 -54.0 moveto
(L ) show
241.0 -54.0 moveto
(O ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2263 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2263 a -2 2429 a
SDict begin H.S end
 -2 2429
a -2 2429 a
SDict begin 13 H.A end
 -2 2429 a -2 2429 a
SDict begin [/View [/XYZ H.V]/Dest (0:608) cvn /DEST pdfmark end
 -2 2429 a 396 2537 a
Fj(So)h(you)e(could)g(write)i(a)f(HTTP-lik)o(e)g(protocol)e(using)i
(\330MQ,)g(using)g(for)f(e)o(xample)g(the)h(request-reply)e(sock)o(et)
396 2644 y(pattern.)h(But)i(it)g(w)o(ould)e(not)h(be)g(HTTP)-9
b(.)-2 2828 y
SDict begin H.S end
 -2 2828 a -2 2828 a
SDict begin 13 H.A end
 -2 2828 a -2 2828 a
SDict begin [/View [/XYZ H.V]/Dest (0:609) cvn /DEST pdfmark end

-2 2828 a 396 2918 a Fj(There)20 b(is)h(ho)n(we)n(v)o(er)d(a)j(good)d
(answer)i(to)h(the)f(question,)f("Ho)n(w)h(can)g(I)g(mak)o(e)g
(pro\002table)f(use)h(of)g(\330MQ)h(when)e(making)396
3026 y(my)h(ne)n(w)g(XYZ)g(serv)o(er?")g(Y)-9 b(ou)19
b(need)h(to)g(implement)f(whate)n(v)o(er)g(protocol)f(you)h(w)o(ant)i
(to)f(speak)g(in)g(an)o(y)g(case,)g(b)n(ut)g(you)396
3134 y(can)g(connect)f(that)h(protocol)f(serv)o(er)g(\(which)h(can)g
(be)g(e)o(xtremely)e(thin\))i(to)g(a)h(\330MQ)f(back)o(end)f(that)h
(does)g(the)g(real)396 3242 y(w)o(ork.)g(The)f(beautiful)g(part)h(here)
g(is)h(that)f(you)f(can)h(then)g(e)o(xtend)f(your)g(back)o(end)g(with)h
(code)f(in)i(an)o(y)e(language,)396 3350 y(running)f(locally)h(or)h
(remotely)-5 b(,)18 b(as)i(you)f(wish.)h(Zed)f(Sha)o(w')-5
b(s)2182 3350 y
SDict begin H.S end
 2182 3350 a 2182 3350 a
SDict begin 13 H.A end
 2182 3350 a 2182
3350 a
SDict begin [/View [/XYZ H.V]/Dest (0:610) cvn /DEST pdfmark end
 2182 3350 a Fj(Mongrel2)18 b(\(http://www)-5 b(.mongrel2.or)o(g)
o(\))14 b(web)20 b(serv)o(er)f(is)396 3458 y(a)i(great)f(e)o(xample)e
(of)i(such)g(an)g(architecture.)-2 3486 y
SDict begin H.S end
 -2 3486 a -2
3486 a
SDict begin 13 H.A end
 -2 3486 a -2 3486 a
SDict begin [/View [/XYZ H.V]/Dest (0:611) cvn /DEST pdfmark end
 -2 3486 a 396 3797 a Fd(2.1.5.)36
b(I/O)d(Threads)1385 3797 y
SDict begin H.S end
 1385 3797 a 1385 3797 a
SDict begin 18.72 H.A end
 1385
3797 a 1385 3797 a
SDict begin [/View [/XYZ H.V]/Dest (7.19.7.2) cvn /DEST pdfmark end
 1385 3797 a -2 3964 a
SDict begin H.S end
 -2 3964 a -2
3964 a
SDict begin 13 H.A end
 -2 3964 a -2 3964 a
SDict begin [/View [/XYZ H.V]/Dest (0:613) cvn /DEST pdfmark end
 -2 3964 a 396 4071 a Fj(W)-7
b(e)22 b(said)e(that)g(\330MQ)h(does)f(I/O)g(in)h(a)f(background)d
(thread.)i(One)h(I/O)g(thread)g(\(for)f(all)i(sock)o(ets\))f(is)h(suf)n
(\002cient)e(for)h(all)396 4178 y(b)n(ut)g(the)h(most)f(e)o(xtreme)f
(applications.)g(When)h(you)f(create)h(a)g(ne)n(w)g(conte)o(xt)f(it)i
(starts)g(with)g(one)e(I/O)i(thread.)e(The)396 4286 y(general)g(rule)h
(of)g(thumb)f(is)i(to)g(allo)n(w)f(one)f(I/O)i(thread)e(per)h(gigabyte)
e(of)i(data)g(in)g(or)g(out)g(per)g(second.)f(T)-7 b(o)20
b(raise)h(the)396 4394 y(number)e(of)h(I/O)g(threads,)f(use)i(the)1427
4394 y
SDict begin H.S end
 1427 4394 a 1427 4394 a
SDict begin 13 H.A end
 1427 4394 a 1427 4394
a
SDict begin [/View [/XYZ H.V]/Dest (0:614) cvn /DEST pdfmark end
 1427 4394 a Fg(zmq-ctx-set[3])d Fj(call)2216 4394 y
SDict begin H.S end

2216 4394 a 2216 4394 a
SDict begin 13 H.A end
 2216 4394 a 2216 4394 a
SDict begin [/View [/XYZ H.V]/Dest (0:615) cvn /DEST pdfmark end
 2216
4394 a Fi(befor)m(e)i Fj(creating)f(an)o(y)g(sock)o(ets:)-2
4495 y
SDict begin H.S end
 -2 4495 a -2 4495 a
SDict begin 11.7 H.A end
 -2 4495 a -2 4495 a
SDict begin [/View [/XYZ H.V]/Dest (0:616) cvn /DEST pdfmark end
 -2 4495
a 396 4574 a Fg(int)45 b(io-threads)e(=)h(4;)396 4672
y(void)620 4685 y(*)665 4672 y(context)g(=)h(zmq-ctx-new)e(\(\);)396
4769 y(zmq-ctx-set)g(\(context,)h(ZMQ-IO-THREADS,)e(io-threads\);)396
4866 y(assert)i(\(zmq-ctx-get)f(\(context,)g(ZMQ-IO-THREADS\))g(==)h
(io-threads\);)p Black 3800 5569 a Fi(34)p Black eop
end
%%Page: 35 49
TeXDict begin 35 48 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.35) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:617) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(W)g(e')l(v)o(e)20 b(seen)h(that)f(one)f
(sock)o(et)h(can)g(handle)g(man)o(y)f(\(dozens,)f(thousands)h(of\))h
(connections)e(at)j(once.)e(This)h(has)h(a)396 180 y(fundamental)d
(impact)i(on)g(ho)n(w)f(you)g(write)i(applications.)e(A)h(traditional)f
(netw)o(ork)o(ed)g(application)g(has)h(one)g(process)396
288 y(or)g(one)g(thread)f(per)h(remote)f(connection,)f(and)i(that)g
(process)g(or)f(thread)h(handles)f(one)h(sock)o(et.)g(\330MQ)g(lets)h
(you)396 396 y(collapse)f(this)h(entire)f(structure)f(into)h(a)g
(single)g(process,)g(and)g(then)f(break)g(it)i(up)f(as)h(necessary)f
(for)f(scaling.)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2
580 a
SDict begin [/View [/XYZ H.V]/Dest (0:618) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(If)h(you)f(are)h(using)g(\330MQ)g(for)g
(inter)n(-thread)e(communications)g(only)-5 b(,)18 b(i.e.)i(a)h
(multithreaded)d(application)g(that)i(does)g(no)396 778
y(e)o(xternal)e(sock)o(et)i(I/O,)f(you)g(can)g(set)h(the)g(I/O)f
(threads)g(to)h(zero.)e(It')-5 b(s)20 b(not)f(a)h(signi\002cant)f
(optimization)f(though,)f(more)i(of)396 886 y(a)i(curiosity)-5
b(.)-2 997 y
SDict begin H.S end
 -2 997 a -2 997 a
SDict begin 13 H.A end
 -2 997 a -2 997 a
SDict begin [/View [/XYZ H.V]/Dest (0:619) cvn /DEST pdfmark end
 -2 997
a 360 x Fh(2.2.)39 b(Messa)o(ging)e(P)l(atterns)1629
1357 y
SDict begin H.S end
 1629 1357 a 1629 1357 a
SDict begin 22.464 H.A end
 1629 1357 a 1629 1357
a
SDict begin [/View [/XYZ H.V]/Dest (7.20.1) cvn /DEST pdfmark end
 1629 1357 a -2 1555 a
SDict begin H.S end
 -2 1555 a -2 1555 a
SDict begin 13 H.A end
 -2 1555 a
-2 1555 a
SDict begin [/View [/XYZ H.V]/Dest (0:621) cvn /DEST pdfmark end
 -2 1555 a 396 1631 a Fj(Underneath)18 b(the)j(bro)n(wn)d
(paper)h(wrapping)g(of)h(\330MQ')-5 b(s)21 b(sock)o(et)f(API)g(lies)h
(the)f(w)o(orld)g(of)g(messaging)f(patterns.)h(If)g(you)396
1739 y(ha)n(v)o(e)g(a)g(background)d(in)k(enterprise)e(messaging,)g(or)
h(kno)n(w)f(UDP)i(well,)f(these)g(will)h(be)f(v)n(aguely)f(f)o(amiliar)
-5 b(.)20 b(But)h(to)396 1846 y(most)f(\330MQ)h(ne)n(wcomers)e(the)o(y)
g(are)h(a)h(surprise,)e(we')l(re)h(so)g(used)g(to)h(the)f(TCP)h
(paradigm)d(where)i(a)g(sock)o(et)g(maps)396 1954 y(one-to-one)e(to)i
(another)f(node.)-2 2121 y
SDict begin H.S end
 -2 2121 a -2 2121 a
SDict begin 13 H.A end
 -2 2121
a -2 2121 a
SDict begin [/View [/XYZ H.V]/Dest (0:622) cvn /DEST pdfmark end
 -2 2121 a 396 2228 a Fj(Let')-5 b(s)21 b(recap)f(brie\003y)
f(what)h(\330MQ)h(does)f(for)f(you.)g(It)i(deli)n(v)o(ers)e(blobs)h(of)
g(data)g(\(messages\))f(to)i(nodes,)e(quickly)g(and)396
2336 y(ef)n(\002ciently)-5 b(.)19 b(Y)-9 b(ou)20 b(can)g(map)f(nodes)h
(to)g(threads,)f(processes,)h(or)g(nodes.)f(\330MQ)i(gi)n(v)o(es)e
(your)g(applications)g(a)i(single)396 2444 y(sock)o(et)f(API)h(to)f(w)o
(ork)g(with,)g(no)g(matter)f(what)i(the)f(actual)g(transport)f(\(lik)o
(e)h(in-process,)f(inter)n(-process,)f(TCP)-9 b(,)21
b(or)396 2552 y(multicast\).)f(It)g(automatically)f(reconnects)g(to)h
(peers)g(as)h(the)o(y)e(come)h(and)g(go.)f(It)i(queues)e(messages)h(at)
h(both)e(sender)396 2660 y(and)h(recei)n(v)o(er)m(,)e(as)j(needed.)e
(It)h(manages)f(these)i(queues)e(carefully)g(to)h(ensure)g(processes)g
(don')o(t)e(run)h(out)h(of)g(memory)-5 b(,)396 2768 y(o)o(v)o(er\003o)n
(wing)18 b(to)i(disk)g(when)g(appropriate.)d(It)k(handles)e(sock)o(et)h
(errors.)f(It)i(does)f(all)h(I/O)f(in)g(background)d(threads.)i(It)396
2876 y(uses)i(lock-free)d(techniques)h(for)h(talking)f(between)h
(nodes,)f(so)h(there)g(are)g(ne)n(v)o(er)f(locks,)h(w)o(aits,)h
(semaphores,)d(or)396 2984 y(deadlocks.)-2 3151 y
SDict begin H.S end
 -2
3151 a -2 3151 a
SDict begin 13 H.A end
 -2 3151 a -2 3151 a
SDict begin [/View [/XYZ H.V]/Dest (0:623) cvn /DEST pdfmark end
 -2 3151 a 396 3258
a Fj(But)j(cutting)e(through)f(that,)i(it)h(routes)f(and)g(queues)f
(messages)h(according)e(to)j(precise)f(recipes)f(called)3414
3258 y
SDict begin H.S end
 3414 3258 a 3414 3258 a
SDict begin 13 H.A end
 3414 3258 a 3414 3258
a
SDict begin [/View [/XYZ H.V]/Dest (0:624) cvn /DEST pdfmark end
 3414 3258 a Fi(patterns)p Fj(.)h(It)h(is)396 3366 y(these)g(patterns)
e(that)i(pro)o(vide)d(\330MQ')-5 b(s)20 b(intelligence.)f(The)o(y)g
(encapsulate)h(our)f(hard-earned)e(e)o(xperience)h(of)i(the)g(best)396
3474 y(w)o(ays)h(to)f(distrib)n(ute)g(data)g(and)g(w)o(ork.)f(\330MQ')
-5 b(s)21 b(patterns)e(are)h(hard-coded)e(b)n(ut)i(future)f(v)o
(ersions)g(may)h(allo)n(w)396 3582 y(user)n(-de\002nable)f(patterns.)-2
3766 y
SDict begin H.S end
 -2 3766 a -2 3766 a
SDict begin 13 H.A end
 -2 3766 a -2 3766 a
SDict begin [/View [/XYZ H.V]/Dest (0:625) cvn /DEST pdfmark end
 -2 3766
a 396 3856 a Fj(\330MQ)i(patterns)e(are)h(implemented)f(by)g(pairs)i
(of)f(sock)o(ets)g(with)g(matching)f(types.)h(In)g(other)f(w)o(ords,)h
(to)g(understand)396 3964 y(\330MQ)h(patterns)e(you)h(need)f(to)h
(understand)e(sock)o(et)j(types)f(and)f(ho)n(w)h(the)o(y)f(w)o(ork)h
(together)-5 b(.)19 b(Mostly)h(this)h(just)f(tak)o(es)396
4071 y(study)-5 b(,)19 b(there)h(is)h(little)g(that)f(is)i(ob)o(vious)c
(at)j(this)f(le)n(v)o(el.)-2 4255 y
SDict begin H.S end
 -2 4255 a -2 4255
a
SDict begin 13 H.A end
 -2 4255 a -2 4255 a
SDict begin [/View [/XYZ H.V]/Dest (0:626) cvn /DEST pdfmark end
 -2 4255 a 396 4345 a Fj(The)g(b)n(uilt-in)g(core)
f(\330MQ)i(patterns)e(are:)-2 4363 y
SDict begin H.S end
 -2 4363 a -2 4363
a
SDict begin 13 H.A end
 -2 4363 a -2 4363 a
SDict begin [/View [/XYZ H.V]/Dest (0:627) cvn /DEST pdfmark end
 -2 4363 a -2 4373 a
SDict begin H.S end
 -2 4373 a -2
4373 a
SDict begin 13 H.A end
 -2 4373 a -2 4373 a
SDict begin [/View [/XYZ H.V]/Dest (0:628) cvn /DEST pdfmark end
 -2 4373 a Black 396 4516 a
Fe(\225)p Black 479 4516 a
SDict begin H.S end
 479 4516 a 479 4516 a
SDict begin 13 H.A end
 479
4516 a 479 4516 a
SDict begin [/View [/XYZ H.V]/Dest (0:629) cvn /DEST pdfmark end
 479 4516 a 479 4516 a
SDict begin H.S end
 479 4516 a 479
4516 a
SDict begin 13 H.A end
 479 4516 a 479 4516 a
SDict begin [/View [/XYZ H.V]/Dest (0:630) cvn /DEST pdfmark end
 479 4516 a Fk(Request-r)o(eply)p
Fj(,)g(which)h(connects)f(a)i(set)g(of)f(clients)g(to)h(a)f(set)h(of)f
(services.)g(This)g(is)i(a)e(remote)f(procedure)f(call)j(and)479
4624 y(task)g(distrib)n(ution)e(pattern.)-2 4642 y
SDict begin H.S end
 -2
4642 a -2 4642 a
SDict begin 13 H.A end
 -2 4642 a -2 4642 a
SDict begin [/View [/XYZ H.V]/Dest (0:631) cvn /DEST pdfmark end
 -2 4642 a Black
396 4773 a Fe(\225)p Black 479 4773 a
SDict begin H.S end
 479 4773 a 479
4773 a
SDict begin 13 H.A end
 479 4773 a 479 4773 a
SDict begin [/View [/XYZ H.V]/Dest (0:632) cvn /DEST pdfmark end
 479 4773 a 479 4773 a
SDict begin H.S end
 479
4773 a 479 4773 a
SDict begin 13 H.A end
 479 4773 a 479 4773 a
SDict begin [/View [/XYZ H.V]/Dest (0:633) cvn /DEST pdfmark end
 479 4773 a Fk
(Publish-subscribe)p Fj(,)j(which)d(connects)h(a)g(set)h(of)f
(publishers)f(to)i(a)f(set)h(of)f(subscribers.)f(This)i(is)g(a)f(data)
479 4881 y(distrib)n(ution)f(pattern.)-2 4899 y
SDict begin H.S end
 -2 4899
a -2 4899 a
SDict begin 13 H.A end
 -2 4899 a -2 4899 a
SDict begin [/View [/XYZ H.V]/Dest (0:634) cvn /DEST pdfmark end
 -2 4899 a Black 396 5030
a Fe(\225)p Black 479 5030 a
SDict begin H.S end
 479 5030 a 479 5030 a
SDict begin 13 H.A end
 479
5030 a 479 5030 a
SDict begin [/View [/XYZ H.V]/Dest (0:635) cvn /DEST pdfmark end
 479 5030 a 479 5030 a
SDict begin H.S end
 479 5030 a 479
5030 a
SDict begin 13 H.A end
 479 5030 a 479 5030 a
SDict begin [/View [/XYZ H.V]/Dest (0:636) cvn /DEST pdfmark end
 479 5030 a Fk(Pipeline)p
Fj(,)i(which)e(connects)h(nodes)f(in)h(a)h(f)o(an-out)e(/)i(f)o(an-in)e
(pattern)g(that)h(can)g(ha)n(v)o(e)g(multiple)g(steps,)g(and)g(loops.)
479 5138 y(This)h(is)g(a)f(parallel)g(task)h(distrib)n(ution)e(and)g
(collection)g(pattern.)p Black 3800 5569 a Fi(35)p Black
eop end
%%Page: 36 50
TeXDict begin 36 49 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.36) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:637) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(W)g(e)22 b(look)o(ed)d(at)h(each)g(of)g
(these)g(in)h(the)f(\002rst)h(chapter)-5 b(.)19 b(There')-5
b(s)20 b(one)f(more)h(pattern)f(that)h(people)g(tend)f(to)i(try)f(to)g
(use)396 180 y(when)g(the)o(y)f(still)j(think)d(of)h(\330MQ)g(in)h
(terms)f(of)g(traditional)f(TCP)i(sock)o(ets:)2603 180
y
SDict begin H.S end
 2603 180 a 2603 180 a
SDict begin 13 H.A end
 2603 180 a 2603 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:638) cvn /DEST pdfmark end
 2603 180
a Fk(Exclusi)o(v)o(e)g(pair)p Fj(,)f(which)g(connects)f(tw)o(o)396
288 y(sock)o(ets)i(e)o(xclusi)n(v)o(ely)-5 b(.)17 b(This)k(is)g(a)f
(pattern)g(you)f(should)g(use)i(only)e(to)h(connect)f(tw)o(o)i(threads)
e(in)i(a)f(process.)g(W)-7 b(e')o(ll)21 b(see)396 396
y(an)f(e)o(xample)f(at)i(the)f(end)g(of)g(this)g(chapter)-5
b(.)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:639) cvn /DEST pdfmark end
 -2 580
a 396 670 a Fj(The)546 670 y
SDict begin H.S end
 546 670 a 546 670 a
SDict begin 13 H.A end
 546
670 a 546 670 a
SDict begin [/View [/XYZ H.V]/Dest (0:640) cvn /DEST pdfmark end
 546 670 a Fg(zmq-socket[3])19 b Fj(man)g(page)h(is)h(f)
o(airly)f(clear)g(about)f(the)h(patterns,)g(it')-5 b(s)21
b(w)o(orth)f(reading)e(se)n(v)o(eral)i(times)g(until)h(it)396
778 y(starts)g(to)g(mak)o(e)e(sense.)i(These)f(are)g(the)g(sock)o(et)g
(combinations)e(that)j(are)f(v)n(alid)f(for)h(a)h(connect-bind)c(pair)j
(\(either)f(side)396 886 y(can)h(bind\):)-2 901 y
SDict begin H.S end
 -2
901 a -2 901 a
SDict begin 13 H.A end
 -2 901 a -2 901 a
SDict begin [/View [/XYZ H.V]/Dest (0:641) cvn /DEST pdfmark end
 -2 901 a -2 911 a
SDict begin H.S end
 -2
911 a -2 911 a
SDict begin 13 H.A end
 -2 911 a -2 911 a
SDict begin [/View [/XYZ H.V]/Dest (0:642) cvn /DEST pdfmark end
 -2 911 a Black 396 1056
a Fe(\225)p Black 479 1056 a
SDict begin H.S end
 479 1056 a 479 1056 a
SDict begin 13 H.A end
 479
1056 a 479 1056 a
SDict begin [/View [/XYZ H.V]/Dest (0:643) cvn /DEST pdfmark end
 479 1056 a Fj(PUB)i(and)d(SUB)-2 1057
y
SDict begin H.S end
 -2 1057 a -2 1057 a
SDict begin 13 H.A end
 -2 1057 a -2 1057 a
SDict begin [/View [/XYZ H.V]/Dest (0:644) cvn /DEST pdfmark end
 -2 1057 a Black
396 1206 a Fe(\225)p Black 479 1206 a
SDict begin H.S end
 479 1206 a 479
1206 a
SDict begin 13 H.A end
 479 1206 a 479 1206 a
SDict begin [/View [/XYZ H.V]/Dest (0:645) cvn /DEST pdfmark end
 479 1206 a Fj(REQ)i(and)f(REP)-2
1221 y
SDict begin H.S end
 -2 1221 a -2 1221 a
SDict begin 13 H.A end
 -2 1221 a -2 1221 a
SDict begin [/View [/XYZ H.V]/Dest (0:646) cvn /DEST pdfmark end
 -2 1221
a Black 396 1355 a Fe(\225)p Black 479 1355 a
SDict begin H.S end
 479 1355
a 479 1355 a
SDict begin 13 H.A end
 479 1355 a 479 1355 a
SDict begin [/View [/XYZ H.V]/Dest (0:647) cvn /DEST pdfmark end
 479 1355 a Fj(REQ)h(and)f(R)m(OUTER)
-2 1370 y
SDict begin H.S end
 -2 1370 a -2 1370 a
SDict begin 13 H.A end
 -2 1370 a -2 1370 a
SDict begin [/View [/XYZ H.V]/Dest (0:648) cvn /DEST pdfmark end
 -2
1370 a Black 396 1505 a Fe(\225)p Black 479 1505 a
SDict begin H.S end
 479
1505 a 479 1505 a
SDict begin 13 H.A end
 479 1505 a 479 1505 a
SDict begin [/View [/XYZ H.V]/Dest (0:649) cvn /DEST pdfmark end
 479 1505 a Fj(DEALER)g(and)g
(REP)-2 1506 y
SDict begin H.S end
 -2 1506 a -2 1506 a
SDict begin 13 H.A end
 -2 1506 a -2 1506
a
SDict begin [/View [/XYZ H.V]/Dest (0:650) cvn /DEST pdfmark end
 -2 1506 a Black 396 1654 a Fe(\225)p Black 479 1654
a
SDict begin H.S end
 479 1654 a 479 1654 a
SDict begin 13 H.A end
 479 1654 a 479 1654 a
SDict begin [/View [/XYZ H.V]/Dest (0:651) cvn /DEST pdfmark end
 479 1654
a Fj(DEALER)g(and)g(R)m(OUTER)-2 1655 y
SDict begin H.S end
 -2 1655 a -2
1655 a
SDict begin 13 H.A end
 -2 1655 a -2 1655 a
SDict begin [/View [/XYZ H.V]/Dest (0:652) cvn /DEST pdfmark end
 -2 1655 a Black 396 1803 a
Fe(\225)p Black 479 1803 a
SDict begin H.S end
 479 1803 a 479 1803 a
SDict begin 13 H.A end
 479
1803 a 479 1803 a
SDict begin [/View [/XYZ H.V]/Dest (0:653) cvn /DEST pdfmark end
 479 1803 a Fj(DEALER)g(and)g(DEALER)-2
1804 y
SDict begin H.S end
 -2 1804 a -2 1804 a
SDict begin 13 H.A end
 -2 1804 a -2 1804 a
SDict begin [/View [/XYZ H.V]/Dest (0:654) cvn /DEST pdfmark end
 -2 1804
a Black 396 1953 a Fe(\225)p Black 479 1953 a
SDict begin H.S end
 479 1953
a 479 1953 a
SDict begin 13 H.A end
 479 1953 a 479 1953 a
SDict begin [/View [/XYZ H.V]/Dest (0:655) cvn /DEST pdfmark end
 479 1953 a Fj(R)m(OUTER)h(and)e(R)m
(OUTER)-2 1954 y
SDict begin H.S end
 -2 1954 a -2 1954 a
SDict begin 13 H.A end
 -2 1954 a -2 1954
a
SDict begin [/View [/XYZ H.V]/Dest (0:656) cvn /DEST pdfmark end
 -2 1954 a Black 396 2102 a Fe(\225)p Black 479 2102
a
SDict begin H.S end
 479 2102 a 479 2102 a
SDict begin 13 H.A end
 479 2102 a 479 2102 a
SDict begin [/View [/XYZ H.V]/Dest (0:657) cvn /DEST pdfmark end
 479 2102
a Fj(PUSH)i(and)f(PULL)-2 2103 y
SDict begin H.S end
 -2 2103 a -2 2103 a
SDict begin 13 H.A end

-2 2103 a -2 2103 a
SDict begin [/View [/XYZ H.V]/Dest (0:658) cvn /DEST pdfmark end
 -2 2103 a Black 396 2252 a Fe(\225)p
Black 479 2252 a
SDict begin H.S end
 479 2252 a 479 2252 a
SDict begin 13 H.A end
 479 2252 a 479
2252 a
SDict begin [/View [/XYZ H.V]/Dest (0:659) cvn /DEST pdfmark end
 479 2252 a Fj(P)-8 b(AIR)22 b(and)d(P)-8 b(AIR)-2
2419 y
SDict begin H.S end
 -2 2419 a -2 2419 a
SDict begin 13 H.A end
 -2 2419 a -2 2419 a
SDict begin [/View [/XYZ H.V]/Dest (0:660) cvn /DEST pdfmark end
 -2 2419
a 396 2526 a Fj(Y)f(ou')o(ll)20 b(also)g(see)h(references)e(to)h(XPUB)h
(and)f(XSUB)h(sock)o(ets,)f(which)g(we')o(ll)h(come)e(to)h(later)h
(\(the)o(y')l(re)d(lik)o(e)i(ra)o(w)396 2634 y(v)o(ersions)f(of)h(PUB)i
(and)d(SUB\).)i(An)o(y)e(other)h(combination)e(will)j(produce)d
(undocumented)e(and)k(unreliable)f(results)396 2742 y(and)h(future)f(v)
o(ersions)g(of)h(\330MQ)g(will)h(probably)d(return)h(errors)h(if)g(you)
f(try)h(them.)g(Y)-9 b(ou)20 b(can)g(and)f(will)i(of)f(course)396
2850 y(bridge)f(other)h(sock)o(et)g(types)1249 2850 y
SDict begin H.S end

1249 2850 a 1249 2850 a
SDict begin 13 H.A end
 1249 2850 a 1249 2850 a
SDict begin [/View [/XYZ H.V]/Dest (0:661) cvn /DEST pdfmark end
 1249
2850 a Fi(via)g(code)p Fj(,)f(i.e.)h(read)g(from)f(one)h(sock)o(et)g
(type)f(and)h(write)g(to)h(another)-5 b(.)-2 2868 y
SDict begin H.S end
 -2
2868 a -2 2868 a
SDict begin 13 H.A end
 -2 2868 a -2 2868 a
SDict begin [/View [/XYZ H.V]/Dest (0:662) cvn /DEST pdfmark end
 -2 2868 a 396 3178
a Fd(2.2.1.)36 b(High-le)n(vel)f(Messa)o(ging)g(P)l(atterns)2455
3178 y
SDict begin H.S end
 2455 3178 a 2455 3178 a
SDict begin 18.72 H.A end
 2455 3178 a 2455 3178
a
SDict begin [/View [/XYZ H.V]/Dest (7.20.8.2) cvn /DEST pdfmark end
 2455 3178 a -2 3370 a
SDict begin H.S end
 -2 3370 a -2 3370 a
SDict begin 13 H.A end
 -2 3370 a
-2 3370 a
SDict begin [/View [/XYZ H.V]/Dest (0:664) cvn /DEST pdfmark end
 -2 3370 a 396 3452 a Fj(These)20 b(four)f(core)h(patterns)f
(are)h(cook)o(ed-in)e(to)i(\330MQ.)g(The)o(y)f(are)i(part)e(of)h(the)g
(\330MQ)h(API,)f(implemented)e(in)i(the)g(core)396 3560
y(C++)h(library)-5 b(,)18 b(and)i(guaranteed)e(to)i(be)h(a)n(v)n
(ailable)e(in)i(all)f(\002ne)h(retail)f(stores.)-2 3744
y
SDict begin H.S end
 -2 3744 a -2 3744 a
SDict begin 13 H.A end
 -2 3744 a -2 3744 a
SDict begin [/View [/XYZ H.V]/Dest (0:665) cvn /DEST pdfmark end
 -2 3744 a 396
3834 a Fj(On)g(top,)g(we)h(add)924 3834 y
SDict begin H.S end
 924 3834 a
924 3834 a
SDict begin 13 H.A end
 924 3834 a 924 3834 a
SDict begin [/View [/XYZ H.V]/Dest (0:666) cvn /DEST pdfmark end
 924 3834 a Fi(high-le)o(vel)e
(patterns)p Fj(.)g(W)-7 b(e)22 b(b)n(uild)e(these)g(high-le)n(v)o(el)e
(patterns)i(on)f(top)h(of)g(\330MQ)h(and)e(implement)396
3941 y(them)h(in)g(whate)n(v)o(er)f(language)g(we')l(re)g(using)h(for)f
(our)h(application.)e(The)o(y)h(are)h(not)g(part)g(of)g(the)g(core)g
(library)-5 b(,)18 b(do)i(not)396 4049 y(come)g(with)g(the)g(\330MQ)h
(package,)d(and)i(e)o(xist)g(in)h(their)f(o)n(wn)f(space,)h(as)h(part)f
(of)g(the)g(\330MQ)g(community)-5 b(.)18 b(F)o(or)i(e)o(xample)396
4157 y(the)g(Majordomo)e(pattern,)h(which)h(we)h(e)o(xplore)d(in)i
(Reliable)h(Request-Reply)e(P)o(atterns)p 0 TeXcolorgray
2977 4157 a
SDict begin H.S end
 2977 4157 a Fj(Chapter)g(4)3302 4157 y
SDict begin 13 H.L end
 3302
4157 a 3302 4157 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3302 4157 a Black -1 w Fj(,)i(sits)g(in)g(the)396
4265 y(GitHub)f(Majordomo)e(project)h(in)i(the)f(ZeroMQ)f(or)o
(ganization.)-2 4449 y
SDict begin H.S end
 -2 4449 a -2 4449 a
SDict begin 13 H.A end
 -2 4449 a
-2 4449 a
SDict begin [/View [/XYZ H.V]/Dest (0:668) cvn /DEST pdfmark end
 -2 4449 a 396 4539 a Fj(One)h(of)g(the)g(things)g(we)h(aim)f
(to)g(pro)o(vide)f(you)g(with)h(this)h(guide)e(are)h(a)h(set)g(of)f
(such)g(high-le)n(v)o(el)e(patterns,)h(both)h(small)396
4647 y(\(ho)n(w)g(to)g(handle)f(messages)h(sanely\))g(to)g(lar)o(ge)f
(\(ho)n(w)h(to)g(mak)o(e)g(a)g(reliable)g(publish-subscribe)e
(architecture\).)-2 4676 y
SDict begin H.S end
 -2 4676 a -2 4676 a
SDict begin 13 H.A end
 -2 4676
a -2 4676 a
SDict begin [/View [/XYZ H.V]/Dest (0:669) cvn /DEST pdfmark end
 -2 4676 a Black 3798 5569 a Fi(36)p Black
eop end
%%Page: 37 51
TeXDict begin 37 50 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.37) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 77 a Fd(2.2.2.)36 b(W)-7 b(orking)33
b(with)g(Messa)o(g)q(es)2074 77 y
SDict begin H.S end
 2074 77 a 2074 77 a
SDict begin 18.72 H.A end

2074 77 a 2074 77 a
SDict begin [/View [/XYZ H.V]/Dest (7.20.9.2) cvn /DEST pdfmark end
 2074 77 a -2 269 a
SDict begin H.S end
 -2 269 a -2 269
a
SDict begin 13 H.A end
 -2 269 a -2 269 a
SDict begin [/View [/XYZ H.V]/Dest (0:671) cvn /DEST pdfmark end
 -2 269 a 396 351 a Fj(On)20 b(the)h(wire,)f(\330MQ)
g(messages)g(are)h(blobs)e(of)h(an)o(y)g(size)g(from)g(zero)f(upw)o
(ards,)g(\002tting)h(in)h(memory)-5 b(.)18 b(Y)-9 b(ou)19
b(do)h(your)396 459 y(o)n(wn)g(serialization)f(using)h(protob)n(ufs,)e
(msgpack,)h(JSON,)i(or)f(whate)n(v)o(er)e(else)j(your)e(applications)g
(need)h(to)g(speak.)f(It')-5 b(s)396 566 y(wise)21 b(to)f(choose)g(a)g
(data)g(representation)e(that)j(is)g(portable)d(and)i(f)o(ast,)g(b)n
(ut)h(you)e(can)h(mak)o(e)g(your)e(o)n(wn)i(decisions)g(about)396
674 y(trade-of)n(fs.)-2 841 y
SDict begin H.S end
 -2 841 a -2 841 a
SDict begin 13 H.A end
 -2 841
a -2 841 a
SDict begin [/View [/XYZ H.V]/Dest (0:672) cvn /DEST pdfmark end
 -2 841 a 396 948 a Fj(In)g(memory)-5 b(,)18
b(\330MQ)i(messages)h(are)1470 948 y
SDict begin H.S end
 1470 948 a 1470
948 a
SDict begin 13 H.A end
 1470 948 a 1470 948 a
SDict begin [/View [/XYZ H.V]/Dest (0:673) cvn /DEST pdfmark end
 1470 948 a Fg(zmq-msg-t)e
Fj(structures)h(\(or)f(classes)j(depending)17 b(on)j(your)f
(language\).)f(Here)396 1056 y(are)i(the)h(basic)f(ground)e(rules)i
(for)g(using)f(\330MQ)i(messages)f(in)g(C:)-2 1074 y
SDict begin H.S end

-2 1074 a -2 1074 a
SDict begin 13 H.A end
 -2 1074 a -2 1074 a
SDict begin [/View [/XYZ H.V]/Dest (0:674) cvn /DEST pdfmark end
 -2 1074 a -2
1084 a
SDict begin H.S end
 -2 1084 a -2 1084 a
SDict begin 13 H.A end
 -2 1084 a -2 1084 a
SDict begin [/View [/XYZ H.V]/Dest (0:675) cvn /DEST pdfmark end
 -2 1084
a Black 396 1227 a Fe(\225)p Black 479 1227 a
SDict begin H.S end
 479 1227
a 479 1227 a
SDict begin 13 H.A end
 479 1227 a 479 1227 a
SDict begin [/View [/XYZ H.V]/Dest (0:676) cvn /DEST pdfmark end
 479 1227 a Fj(Y)-9
b(ou)20 b(create)g(and)f(pass)i(around)1408 1227 y
SDict begin H.S end
 1408
1227 a 1408 1227 a
SDict begin 13 H.A end
 1408 1227 a 1408 1227 a
SDict begin [/View [/XYZ H.V]/Dest (0:677) cvn /DEST pdfmark end
 1408 1227
a Fg(zmq-msg-t)f Fj(objects,)f(not)h(blocks)g(of)g(data.)-2
1244 y
SDict begin H.S end
 -2 1244 a -2 1244 a
SDict begin 13 H.A end
 -2 1244 a -2 1244 a
SDict begin [/View [/XYZ H.V]/Dest (0:678) cvn /DEST pdfmark end
 -2 1244
a Black 396 1376 a Fe(\225)p Black 479 1376 a
SDict begin H.S end
 479 1376
a 479 1376 a
SDict begin 13 H.A end
 479 1376 a 479 1376 a
SDict begin [/View [/XYZ H.V]/Dest (0:679) cvn /DEST pdfmark end
 479 1376 a Fj(T)-7
b(o)21 b(read)e(a)i(message)f(you)f(use)1386 1376 y
SDict begin H.S end
 1386
1376 a 1386 1376 a
SDict begin 13 H.A end
 1386 1376 a 1386 1376 a
SDict begin [/View [/XYZ H.V]/Dest (0:680) cvn /DEST pdfmark end
 1386 1376
a Fg(zmq-msg-init[3])f Fj(to)i(create)g(an)g(empty)g(message,)f(and)h
(then)g(you)f(pass)i(that)f(to)479 1484 y
SDict begin H.S end
 479 1484 a
479 1484 a
SDict begin 13 H.A end
 479 1484 a 479 1484 a
SDict begin [/View [/XYZ H.V]/Dest (0:681) cvn /DEST pdfmark end
 479 1484 a Fg(zmq-msg-recv[3])p
Fj(.)-2 1496 y
SDict begin H.S end
 -2 1496 a -2 1496 a
SDict begin 13 H.A end
 -2 1496 a -2 1496
a
SDict begin [/View [/XYZ H.V]/Dest (0:682) cvn /DEST pdfmark end
 -2 1496 a Black 396 1633 a Fe(\225)p Black 479 1633
a
SDict begin H.S end
 479 1633 a 479 1633 a
SDict begin 13 H.A end
 479 1633 a 479 1633 a
SDict begin [/View [/XYZ H.V]/Dest (0:683) cvn /DEST pdfmark end
 479 1633
a Fj(T)-7 b(o)21 b(write)f(a)h(message)f(from)f(ne)n(w)h(data,)g(you)f
(use)1932 1633 y
SDict begin H.S end
 1932 1633 a 1932 1633 a
SDict begin 13 H.A end
 1932 1633 a
1932 1633 a
SDict begin [/View [/XYZ H.V]/Dest (0:684) cvn /DEST pdfmark end
 1932 1633 a Fg(zmq-msg-init-size[3])f Fj(to)i(create)g(a)h
(message)f(and)f(at)i(the)479 1741 y(same)g(time)f(allocate)g(a)h
(block)e(of)h(data)g(of)g(some)g(size.)g(Y)-9 b(ou)20
b(then)g(\002ll)h(that)f(data)g(using)3023 1741 y
SDict begin H.S end
 3023
1741 a 3023 1741 a
SDict begin 13 H.A end
 3023 1741 a 3023 1741 a
SDict begin [/View [/XYZ H.V]/Dest (0:685) cvn /DEST pdfmark end
 3023 1741
a Fg(memcpy)p Fj(,)f(and)h(pass)h(the)479 1849 y(message)f(to)867
1849 y
SDict begin H.S end
 867 1849 a 867 1849 a
SDict begin 13 H.A end
 867 1849 a 867 1849 a
SDict begin [/View [/XYZ H.V]/Dest (0:686) cvn /DEST pdfmark end
 867
1849 a Fg(zmq-msg-send[3])p Fj(.)-2 1867 y
SDict begin H.S end
 -2 1867 a
-2 1867 a
SDict begin 13 H.A end
 -2 1867 a -2 1867 a
SDict begin [/View [/XYZ H.V]/Dest (0:687) cvn /DEST pdfmark end
 -2 1867 a Black 396 1999
a Fe(\225)p Black 479 1999 a
SDict begin H.S end
 479 1999 a 479 1999 a
SDict begin 13 H.A end
 479
1999 a 479 1999 a
SDict begin [/View [/XYZ H.V]/Dest (0:688) cvn /DEST pdfmark end
 479 1999 a Fj(T)-7 b(o)21 b(release)f(\(not)f(destro)
o(y\))g(a)i(message)f(you)f(call)1929 1999 y
SDict begin H.S end
 1929 1999
a 1929 1999 a
SDict begin 13 H.A end
 1929 1999 a 1929 1999 a
SDict begin [/View [/XYZ H.V]/Dest (0:689) cvn /DEST pdfmark end
 1929 1999 a Fg(zmq-msg-close[3])p
Fj(.)f(This)i(drops)f(a)i(reference,)d(and)479 2107 y(e)n(v)o(entually)
h(\330MQ)h(will)h(destro)o(y)e(the)i(message.)-2 2125
y
SDict begin H.S end
 -2 2125 a -2 2125 a
SDict begin 13 H.A end
 -2 2125 a -2 2125 a
SDict begin [/View [/XYZ H.V]/Dest (0:690) cvn /DEST pdfmark end
 -2 2125 a Black
396 2256 a Fe(\225)p Black 479 2256 a
SDict begin H.S end
 479 2256 a 479
2256 a
SDict begin 13 H.A end
 479 2256 a 479 2256 a
SDict begin [/View [/XYZ H.V]/Dest (0:691) cvn /DEST pdfmark end
 479 2256 a Fj(T)-7 b(o)21
b(access)f(the)h(message)f(content)f(you)g(use)1785 2256
y
SDict begin H.S end
 1785 2256 a 1785 2256 a
SDict begin 13 H.A end
 1785 2256 a 1785 2256 a
SDict begin [/View [/XYZ H.V]/Dest (0:692) cvn /DEST pdfmark end
 1785
2256 a Fg(zmq-msg-data[3])p Fj(.)f(T)-7 b(o)20 b(kno)n(w)f(ho)n(w)h
(much)f(data)h(the)g(message)479 2364 y(contains,)g(use)929
2364 y
SDict begin H.S end
 929 2364 a 929 2364 a
SDict begin 13 H.A end
 929 2364 a 929 2364 a
SDict begin [/View [/XYZ H.V]/Dest (0:693) cvn /DEST pdfmark end
 929
2364 a Fg(zmq-msg-size[3])p Fj(.)-2 2376 y
SDict begin H.S end
 -2 2376 a
-2 2376 a
SDict begin 13 H.A end
 -2 2376 a -2 2376 a
SDict begin [/View [/XYZ H.V]/Dest (0:694) cvn /DEST pdfmark end
 -2 2376 a Black 396 2513
a Fe(\225)p Black 479 2513 a
SDict begin H.S end
 479 2513 a 479 2513 a
SDict begin 13 H.A end
 479
2513 a 479 2513 a
SDict begin [/View [/XYZ H.V]/Dest (0:695) cvn /DEST pdfmark end
 479 2513 a Fj(Do)g(not)g(use)860 2513
y
SDict begin H.S end
 860 2513 a 860 2513 a
SDict begin 13 H.A end
 860 2513 a 860 2513 a
SDict begin [/View [/XYZ H.V]/Dest (0:696) cvn /DEST pdfmark end
 860 2513
a Fg(zmq-msg-move[3])p Fj(,)1574 2513 y
SDict begin H.S end
 1574 2513 a 1574
2513 a
SDict begin 13 H.A end
 1574 2513 a 1574 2513 a
SDict begin [/View [/XYZ H.V]/Dest (0:697) cvn /DEST pdfmark end
 1574 2513 a Fg(zmq-msg-copy[3])p
Fj(,)e(or)2378 2513 y
SDict begin H.S end
 2378 2513 a 2378 2513 a
SDict begin 13 H.A end
 2378 2513
a 2378 2513 a
SDict begin [/View [/XYZ H.V]/Dest (0:698) cvn /DEST pdfmark end
 2378 2513 a Fg(zmq-msg-init-data[3])f Fj(unless)j(you)g
(read)479 2621 y(the)g(man)g(pages)g(and)g(kno)n(w)f(precisely)g(why)h
(you)f(need)g(these.)-2 2805 y
SDict begin H.S end
 -2 2805 a -2 2805 a
SDict begin 13 H.A end
 -2
2805 a -2 2805 a
SDict begin [/View [/XYZ H.V]/Dest (0:699) cvn /DEST pdfmark end
 -2 2805 a 396 2895 a Fj(Here)h(is)h(a)g(typical)f
(chunk)e(of)i(code)g(w)o(orking)f(with)h(messages,)g(which)g(should)f
(be)h(f)o(amiliar)g(if)g(you)f(ha)n(v)o(e)h(been)396
3003 y(paying)f(attention.)g(This)h(is)i(from)d(the)1524
3003 y
SDict begin H.S end
 1524 3003 a 1524 3003 a
SDict begin 13 H.A end
 1524 3003 a 1524 3003
a
SDict begin [/View [/XYZ H.V]/Dest (0:700) cvn /DEST pdfmark end
 1524 3003 a Fg(zhelpers.h)g Fj(\002le)i(we)f(use)h(in)f(all)h(the)f
(e)o(xamples:)-2 3104 y
SDict begin H.S end
 -2 3104 a -2 3104 a
SDict begin 11.7 H.A end
 -2 3104 a
-2 3104 a
SDict begin [/View [/XYZ H.V]/Dest (0:701) cvn /DEST pdfmark end
 -2 3104 a 396 3183 a Fg(//)90 b(Receive)43
b(0MQ)i(string)e(from)i(socket)e(and)i(convert)e(into)i(C)f(string)396
3280 y(static)g(char)934 3293 y(*)396 3378 y(s-recv)g(\(void)979
3391 y(*)1024 3378 y(socket\))g({)576 3475 y(zmq-msg-t)f(message;)576
3572 y(zmq-msg-init)f(\(&message\);)576 3669 y(int)i(size)g(=)h
(zmq-msg-recv)e(\(&message,)g(socket,)g(0\);)576 3766
y(if)h(\(size)g(==)h(-1\))755 3863 y(return)f(NULL;)576
3960 y(char)800 3973 y(*)845 3960 y(string)f(=)i(malloc)f(\(size)g(+)h
(1\);)576 4058 y(memcpy)e(\(string,)h(zmq-msg-data)f(\(&message\),)g
(size\);)576 4155 y(zmq-msg-close)f(\(&message\);)576
4252 y(string)h([size])h(=)h(0;)576 4349 y(return)e(\(string\);)396
4446 y(})396 4640 y(//)90 b(Convert)43 b(C)i(string)f(to)g(0MQ)h
(string)e(and)i(send)f(to)g(socket)396 4738 y(static)g(int)396
4835 y(s-send)g(\(void)979 4848 y(*)1024 4835 y(socket,)g(char)1607
4848 y(*)1652 4835 y(string\))f({)576 4932 y(zmq-msg-t)g(message;)576
5029 y(zmq-msg-init-size)f(\(&message,)h(strlen)h(\(string\)\);)576
5126 y(memcpy)f(\(zmq-msg-data)g(\(&message\),)g(string,)h(strlen)g
(\(string\)\);)p Black 3797 5569 a Fi(37)p Black eop
end
%%Page: 38 52
TeXDict begin 38 51 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.38) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:737) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 576 72 a Fg(int)44 b(size)g(=)h(zmq-msg-send)e
(\(&message,)g(socket,)g(0\);)576 170 y(zmq-msg-close)f(\(&message\);)
576 267 y(return)h(\(size\);)396 364 y(})-2 538 y
SDict begin H.S end
 -2
538 a -2 538 a
SDict begin 13 H.A end
 -2 538 a -2 538 a
SDict begin [/View [/XYZ H.V]/Dest (0:702) cvn /DEST pdfmark end
 -2 538 a 396 638 a Fj(Y)-9
b(ou)20 b(can)g(easily)g(e)o(xtend)f(this)i(code)e(to)i(send)f(and)f
(recei)n(v)o(e)g(blobs)h(of)g(arbitrary)f(length.)-2
822 y
SDict begin H.S end
 -2 822 a -2 822 a
SDict begin 13 H.A end
 -2 822 a -2 822 a
SDict begin [/View [/XYZ H.V]/Dest (0:703) cvn /DEST pdfmark end
 -2 822 a 396
912 a Fj(NO)m(TE:)-2 1079 y
SDict begin H.S end
 -2 1079 a -2 1079 a
SDict begin 13 H.A end
 -2 1079
a -2 1079 a
SDict begin [/View [/XYZ H.V]/Dest (0:704) cvn /DEST pdfmark end
 -2 1079 a 396 1186 a Fj(After)h(you)f(pass)i(a)g(message)f
(to)1346 1186 y
SDict begin H.S end
 1346 1186 a 1346 1186 a
SDict begin 13 H.A end
 1346 1186 a 1346
1186 a
SDict begin [/View [/XYZ H.V]/Dest (0:705) cvn /DEST pdfmark end
 1346 1186 a Fg(zmq-msg-send[3])p Fj(,)e(\330MQ)j(will)g(clear)f
(the)g(message,)g(i.e.,)g(set)h(the)f(size)h(to)f(zero.)396
1294 y(Y)-9 b(ou)20 b(cannot)f(send)h(the)g(same)g(message)g(twice,)h
(and)e(you)h(cannot)f(access)i(the)f(message)g(data)g(after)g(sending)f
(it.)-2 1478 y
SDict begin H.S end
 -2 1478 a -2 1478 a
SDict begin 13 H.A end
 -2 1478 a -2 1478
a
SDict begin [/View [/XYZ H.V]/Dest (0:706) cvn /DEST pdfmark end
 -2 1478 a 396 1568 a Fj(If)h(you)g(w)o(ant)g(to)g(send)g(the)g(same)h
(message)f(more)f(than)h(once,)f(create)h(a)h(second)e(message,)h
(initialize)g(it)h(using)396 1676 y
SDict begin H.S end
 396 1676 a 396 1676
a
SDict begin 13 H.A end
 396 1676 a 396 1676 a
SDict begin [/View [/XYZ H.V]/Dest (0:707) cvn /DEST pdfmark end
 396 1676 a Fg(zmq-msg-init[3])d
Fj(and)h(then)g(use)1522 1676 y
SDict begin H.S end
 1522 1676 a 1522 1676
a
SDict begin 13 H.A end
 1522 1676 a 1522 1676 a
SDict begin [/View [/XYZ H.V]/Dest (0:708) cvn /DEST pdfmark end
 1522 1676 a Fg(zmq-msg-copy[3])f
Fj(to)i(create)f(a)h(cop)o(y)e(of)h(the)h(\002rst)g(message.)f(This)h
(does)f(not)396 1784 y(cop)o(y)h(the)g(data)g(b)n(ut)g(the)g
(reference.)f(Y)-9 b(ou)19 b(can)h(then)g(send)g(the)g(message)g(twice)
h(\(or)e(more,)g(if)i(you)e(create)h(more)396 1891 y(copies\))g(and)f
(the)i(message)f(will)h(only)e(be)h(\002nally)g(destro)o(yed)f(when)g
(the)i(last)g(cop)o(y)e(is)i(sent)g(or)e(closed.)-2 2076
y
SDict begin H.S end
 -2 2076 a -2 2076 a
SDict begin 13 H.A end
 -2 2076 a -2 2076 a
SDict begin [/View [/XYZ H.V]/Dest (0:709) cvn /DEST pdfmark end
 -2 2076 a 396
2165 a Fj(\330MQ)i(also)f(supports)1067 2165 y
SDict begin H.S end
 1067 2165
a 1067 2165 a
SDict begin 13 H.A end
 1067 2165 a 1067 2165 a
SDict begin [/View [/XYZ H.V]/Dest (0:710) cvn /DEST pdfmark end
 1067 2165 a Fi(multi-part)h
Fj(messages,)f(which)g(let)h(you)e(send)h(or)g(recei)n(v)o(e)f(a)i
(list)g(of)f(frames)g(as)g(a)h(single)396 2273 y(on-the-wire)d
(message.)i(This)g(is)i(widely)d(used)h(in)h(real)f(applications)f(and)
g(we')o(ll)i(look)e(at)i(that)f(later)h(in)f(this)h(chapter)396
2381 y(and)f(in)g(Adv)n(anced)e(Request-Reply)i(P)o(atterns)p
0 TeXcolorgray 1759 2381 a
SDict begin H.S end
 1759 2381 a Fj(Chapter)f(3)2084
2381 y
SDict begin 13 H.L end
 2084 2381 a 2084 2381 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2084 2381 a Black -1 w
Fj(.)-2 2565 y
SDict begin H.S end
 -2 2565 a -2 2565 a
SDict begin 13 H.A end
 -2 2565 a -2 2565
a
SDict begin [/View [/XYZ H.V]/Dest (0:712) cvn /DEST pdfmark end
 -2 2565 a 396 2655 a Fj(Some)h(other)g(things)f(that)i(are)f(w)o
(orth)f(kno)n(wing)g(about)g(messages:)-2 2673 y
SDict begin H.S end
 -2 2673
a -2 2673 a
SDict begin 13 H.A end
 -2 2673 a -2 2673 a
SDict begin [/View [/XYZ H.V]/Dest (0:713) cvn /DEST pdfmark end
 -2 2673 a -2 2683 a
SDict begin H.S end
 -2
2683 a -2 2683 a
SDict begin 13 H.A end
 -2 2683 a -2 2683 a
SDict begin [/View [/XYZ H.V]/Dest (0:714) cvn /DEST pdfmark end
 -2 2683 a Black
396 2825 a Fe(\225)p Black 479 2825 a
SDict begin H.S end
 479 2825 a 479
2825 a
SDict begin 13 H.A end
 479 2825 a 479 2825 a
SDict begin [/View [/XYZ H.V]/Dest (0:715) cvn /DEST pdfmark end
 479 2825 a Fj(\330MQ)i(sends)f(and)g
(recei)n(v)o(es)f(them)h(atomically)-5 b(,)18 b(i.e.)j(you)e(get)h(a)h
(whole)e(message,)h(or)g(you)f(don')o(t)g(get)h(it)h(at)g(all.)f(This)
479 2933 y(is)h(also)g(true)f(for)f(multi-part)g(messages.)-2
2951 y
SDict begin H.S end
 -2 2951 a -2 2951 a
SDict begin 13 H.A end
 -2 2951 a -2 2951 a
SDict begin [/View [/XYZ H.V]/Dest (0:716) cvn /DEST pdfmark end
 -2 2951
a Black 396 3083 a Fe(\225)p Black 479 3083 a
SDict begin H.S end
 479 3083
a 479 3083 a
SDict begin 13 H.A end
 479 3083 a 479 3083 a
SDict begin [/View [/XYZ H.V]/Dest (0:717) cvn /DEST pdfmark end
 479 3083 a Fj(\330MQ)i(does)f(not)g
(send)f(a)i(message)f(right)g(a)o(w)o(ay)g(b)n(ut)g(at)g(some)g
(indeterminate)f(later)h(time.)-2 3101 y
SDict begin H.S end
 -2 3101 a -2
3101 a
SDict begin 13 H.A end
 -2 3101 a -2 3101 a
SDict begin [/View [/XYZ H.V]/Dest (0:718) cvn /DEST pdfmark end
 -2 3101 a Black 396 3232 a
Fe(\225)p Black 479 3232 a
SDict begin H.S end
 479 3232 a 479 3232 a
SDict begin 13 H.A end
 479
3232 a 479 3232 a
SDict begin [/View [/XYZ H.V]/Dest (0:719) cvn /DEST pdfmark end
 479 3232 a Fj(Y)-9 b(ou)20 b(may)g(send)g
(zero-length)d(messages,)j(e.g.)g(for)g(sending)f(a)h(signal)g(from)g
(one)f(thread)g(to)i(another)-5 b(.)-2 3250 y
SDict begin H.S end
 -2 3250
a -2 3250 a
SDict begin 13 H.A end
 -2 3250 a -2 3250 a
SDict begin [/View [/XYZ H.V]/Dest (0:720) cvn /DEST pdfmark end
 -2 3250 a Black 396 3382
a Fe(\225)p Black 479 3382 a
SDict begin H.S end
 479 3382 a 479 3382 a
SDict begin 13 H.A end
 479
3382 a 479 3382 a
SDict begin [/View [/XYZ H.V]/Dest (0:721) cvn /DEST pdfmark end
 479 3382 a Fj(A)21 b(message)f(must)g(\002t)h(in)g
(memory)-5 b(.)17 b(If)j(you)g(w)o(ant)g(to)g(send)g(\002les)h(of)f
(arbitrary)f(sizes,)i(you)e(should)g(break)h(them)f(into)479
3490 y(pieces)i(and)e(send)h(each)g(piece)g(as)h(a)f(separate)g
(message.)-2 3508 y
SDict begin H.S end
 -2 3508 a -2 3508 a
SDict begin 13 H.A end
 -2 3508 a -2
3508 a
SDict begin [/View [/XYZ H.V]/Dest (0:722) cvn /DEST pdfmark end
 -2 3508 a Black 396 3639 a Fe(\225)p Black 479
3639 a
SDict begin H.S end
 479 3639 a 479 3639 a
SDict begin 13 H.A end
 479 3639 a 479 3639 a
SDict begin [/View [/XYZ H.V]/Dest (0:723) cvn /DEST pdfmark end
 479
3639 a Fj(Y)-9 b(ou)20 b(must)g(call)957 3639 y
SDict begin H.S end
 957 3639
a 957 3639 a
SDict begin 13 H.A end
 957 3639 a 957 3639 a
SDict begin [/View [/XYZ H.V]/Dest (0:724) cvn /DEST pdfmark end
 957 3639 a Fg(zmq-msg-close[3])e
Fj(when)h(\002nished)h(with)g(a)h(message,)f(in)g(languages)f(that)h
(don')o(t)479 3747 y(automatically)f(destro)o(y)g(objects)h(when)g(a)g
(scope)g(closes.)-2 3931 y
SDict begin H.S end
 -2 3931 a -2 3931 a
SDict begin 13 H.A end
 -2 3931
a -2 3931 a
SDict begin [/View [/XYZ H.V]/Dest (0:725) cvn /DEST pdfmark end
 -2 3931 a 396 4021 a Fj(And)g(to)g(be)g(necessarily)g
(repetiti)n(v)o(e,)f(do)h(not)f(use)1848 4021 y
SDict begin H.S end
 1848
4021 a 1848 4021 a
SDict begin 13 H.A end
 1848 4021 a 1848 4021 a
SDict begin [/View [/XYZ H.V]/Dest (0:726) cvn /DEST pdfmark end
 1848 4021
a Fg(zmq-msg-init-data[3])p Fj(,)e(yet.)j(This)g(is)h(a)g(zero-cop)o(y)
d(method)396 4129 y(and)i(guaranteed)e(to)i(create)g(trouble)f(for)h
(you.)f(There)g(are)h(f)o(ar)g(more)g(important)e(things)i(to)g(learn)g
(about)f(\330MQ)i(before)396 4237 y(you)f(start)g(to)h(w)o(orry)e
(about)g(sha)n(ving)g(of)n(f)h(microseconds.)-2 4265
y
SDict begin H.S end
 -2 4265 a -2 4265 a
SDict begin 13 H.A end
 -2 4265 a -2 4265 a
SDict begin [/View [/XYZ H.V]/Dest (0:727) cvn /DEST pdfmark end
 -2 4265 a 396
4575 a Fd(2.2.3.)36 b(Handling)e(Multiple)g(Soc)n(kets)2213
4575 y
SDict begin H.S end
 2213 4575 a 2213 4575 a
SDict begin 18.72 H.A end
 2213 4575 a 2213 4575
a
SDict begin [/View [/XYZ H.V]/Dest (7.20.10.2) cvn /DEST pdfmark end
 2213 4575 a -2 4768 a
SDict begin H.S end
 -2 4768 a -2 4768 a
SDict begin 13 H.A end
 -2 4768 a
-2 4768 a
SDict begin [/View [/XYZ H.V]/Dest (0:729) cvn /DEST pdfmark end
 -2 4768 a 396 4849 a Fj(In)20 b(all)h(the)f(e)o(xamples)f(so)
i(f)o(ar)m(,)e(the)i(main)e(loop)h(of)g(most)g(e)o(xamples)f(has)h
(been:)-2 4867 y
SDict begin H.S end
 -2 4867 a -2 4867 a
SDict begin 13 H.A end
 -2 4867 a -2 4867
a
SDict begin [/View [/XYZ H.V]/Dest (0:730) cvn /DEST pdfmark end
 -2 4867 a -2 4877 a
SDict begin H.S end
 -2 4877 a -2 4877 a
SDict begin 13 H.A end
 -2 4877 a -2
4877 a
SDict begin [/View [/XYZ H.V]/Dest (0:731) cvn /DEST pdfmark end
 -2 4877 a Black 463 5020 a Fj(1.)p Black 546 5020
a
SDict begin H.S end
 546 5020 a 546 5020 a
SDict begin 13 H.A end
 546 5020 a 546 5020 a
SDict begin [/View [/XYZ H.V]/Dest (0:732) cvn /DEST pdfmark end
 546 5020
a Fj(w)o(ait)h(for)e(message)h(on)g(sock)o(et)-2 5037
y
SDict begin H.S end
 -2 5037 a -2 5037 a
SDict begin 13 H.A end
 -2 5037 a -2 5037 a
SDict begin [/View [/XYZ H.V]/Dest (0:733) cvn /DEST pdfmark end
 -2 5037 a Black
463 5169 a Fj(2.)p Black 546 5169 a
SDict begin H.S end
 546 5169 a 546 5169
a
SDict begin 13 H.A end
 546 5169 a 546 5169 a
SDict begin [/View [/XYZ H.V]/Dest (0:734) cvn /DEST pdfmark end
 546 5169 a Fj(process)f(message)-2
5187 y
SDict begin H.S end
 -2 5187 a -2 5187 a
SDict begin 13 H.A end
 -2 5187 a -2 5187 a
SDict begin [/View [/XYZ H.V]/Dest (0:735) cvn /DEST pdfmark end
 -2 5187
a Black 3800 5569 a Fi(38)p Black eop end
%%Page: 39 53
TeXDict begin 39 52 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.39) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black Black 463 72 a Fj(3.)p Black 546 72
a
SDict begin H.S end
 546 72 a 546 72 a
SDict begin 13 H.A end
 546 72 a 546 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:736) cvn /DEST pdfmark end
 546 72 a Fj(repeat)396
346 y(What)21 b(if)f(we)h(w)o(ant)f(to)h(read)e(from)g(multiple)h
(endpoints)f(at)h(the)g(same)h(time?)f(The)g(simplest)g(w)o(ay)h(is)g
(to)f(connect)f(one)396 454 y(sock)o(et)h(to)h(all)f(the)h(endpoints)d
(and)i(get)g(\330MQ)h(to)f(do)g(the)g(f)o(an-in)f(for)h(us.)g(This)g
(is)h(le)o(gal)f(if)g(the)h(remote)e(endpoints)g(are)396
562 y(in)i(the)f(same)g(pattern)f(b)n(ut)i(it)g(w)o(ould)e(be)h(wrong)f
(to)h(e.g.)g(connect)f(a)i(PULL)f(sock)o(et)g(to)g(a)h(PUB)g(endpoint.)
-2 746 y
SDict begin H.S end
 -2 746 a -2 746 a
SDict begin 13 H.A end
 -2 746 a -2 746 a
SDict begin [/View [/XYZ H.V]/Dest (0:738) cvn /DEST pdfmark end
 -2 746 a
396 836 a Fj(T)-7 b(o)21 b(actually)e(read)h(from)f(multiple)h(sock)o
(ets)g(at)h(once,)e(use)2104 836 y
SDict begin H.S end
 2104 836 a 2104 836
a
SDict begin 13 H.A end
 2104 836 a 2104 836 a
SDict begin [/View [/XYZ H.V]/Dest (0:739) cvn /DEST pdfmark end
 2104 836 a Fg(zmq-poll[3])p Fj(.)g(An)h(e)n(v)o
(en)f(better)h(w)o(ay)g(might)g(be)g(to)g(wrap)396 944
y
SDict begin H.S end
 396 944 a 396 944 a
SDict begin 13 H.A end
 396 944 a 396 944 a
SDict begin [/View [/XYZ H.V]/Dest (0:740) cvn /DEST pdfmark end
 396 944 a Fg(zmq-poll[3])f
Fj(in)i(a)f(frame)n(w)o(ork)e(that)i(turns)g(it)h(into)f(a)h(nice)f(e)n
(v)o(ent-dri)n(v)o(en)2635 944 y
SDict begin H.S end
 2635 944 a 2635 944
a
SDict begin 13 H.A end
 2635 944 a 2635 944 a
SDict begin [/View [/XYZ H.V]/Dest (0:741) cvn /DEST pdfmark end
 2635 944 a Fi(r)m(eactor)r Fj(,)f(b)n(ut)h(it')
-5 b(s)22 b(signi\002cantly)d(more)396 1052 y(w)o(ork)h(than)g(we)g(w)o
(ant)g(to)h(co)o(v)o(er)d(here.)-2 1219 y
SDict begin H.S end
 -2 1219 a -2
1219 a
SDict begin 13 H.A end
 -2 1219 a -2 1219 a
SDict begin [/View [/XYZ H.V]/Dest (0:742) cvn /DEST pdfmark end
 -2 1219 a 396 1326 a Fj(Let')-5
b(s)21 b(start)g(with)f(a)h(dirty)e(hack,)h(partly)f(for)h(the)g(fun)f
(of)h(not)g(doing)f(it)i(right,)e(b)n(ut)h(mainly)g(because)f(it)i
(lets)g(me)f(sho)n(w)396 1434 y(you)g(ho)n(w)f(to)i(do)e(non-blocking)e
(sock)o(et)j(reads.)g(Here)g(is)h(a)f(simple)h(e)o(xample)d(of)i
(reading)f(from)g(tw)o(o)i(sock)o(ets)f(using)396 1542
y(non-blocking)d(reads.)i(This)i(rather)e(confused)g(program)f(acts)j
(both)e(as)i(a)f(subscriber)f(to)i(weather)e(updates,)g(and)h(a)396
1650 y(w)o(ork)o(er)f(for)h(parallel)g(tasks:)-2 1668
y
SDict begin H.S end
 -2 1668 a -2 1668 a
SDict begin 13 H.A end
 -2 1668 a -2 1668 a
SDict begin [/View [/XYZ H.V]/Dest (0:msreader-php) cvn /DEST pdfmark
end
 -2 1668 a 396
1851 a Fk(Example)h(2-1.)e(Multiple)i(sock)o(et)f(r)o(eader)g(\(msr)o
(eader)-8 b(.php\))-2 1951 y
SDict begin H.S end
 -2 1951 a -2 1951 a
SDict begin 11.7 H.A end
 -2 1951
a -2 1951 a
SDict begin [/View [/XYZ H.V]/Dest (0:745) cvn /DEST pdfmark end
 -2 1951 a 396 2031 a Fg(<?php)396 2129 y(/)441
2142 y(*)441 2239 y(*)576 2226 y(Reading)43 b(from)h(multiple)g
(sockets)441 2336 y(*)576 2323 y(This)g(version)f(uses)i(a)f(simple)g
(recv)g(loop)441 2433 y(*)531 2420 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 2530 y(*)486
2517 y(/)396 2711 y(//)90 b(Prepare)43 b(our)i(context)e(and)i(sockets)
396 2808 y($context)f(=)g(new)h(ZMQContext\(\);)396 3003
y(//)90 b(Connect)43 b(to)i(task)f(ventilator)396 3100
y($receiver)g(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_PULL\);)396
3197 y($receiver->connect\("tcp://localhost:5557")o(\);)396
3391 y(//)90 b(Connect)43 b(to)i(weather)e(server)396
3488 y($subscriber)g(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_SUB\);)396 3586 y
($subscriber->connect\("tcp://localhost:555)o(6"\);)396
3683 y($subscriber->setSockOpt\(ZMQ::SOCKOPT_SUBS)o(CRIBE,)c
("10001"\);)396 3877 y(//)90 b(Process)43 b(messages)h(from)g(both)g
(sockets)396 3974 y(//)90 b(We)44 b(prioritize)f(traffic)h(from)g(the)g
(task)h(ventilator)396 4071 y(while\(true\))e({)441 4168
y(//)89 b(Process)44 b(any)g(waiting)g(tasks)441 4266
y(try)g({)486 4363 y(for\($rc)g(=)g(0;)h(!$rc;\))f({)531
4460 y(if\($rc)g(=)g($receiver->recv\(ZMQ::MODE_NOBLOCK\)\))39
b({)576 4557 y(//)44 b(process)g(task)531 4654 y(})486
4751 y(})441 4848 y(})h(catch)f(\(ZMQSocketException)d($e\))k({)486
4945 y(//)f(do)h(nothing)441 5043 y(})p Black 3800 5569
a Fi(39)p Black eop end
%%Page: 40 54
TeXDict begin 40 53 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.40) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 441 72 a Fg(try)44 b({)486 170 y(//)89
b(Process)44 b(any)g(waiting)g(weather)g(updates)486
267 y(for\($rc)g(=)g(0;)h(!$rc;\))f({)531 364 y(if\($rc)g(=)g
($subscriber->recv\(ZMQ::MODE_NOBLOCK\)\))39 b({)576
461 y(//)44 b(process)g(weather)f(update)531 558 y(})486
655 y(})441 752 y(})i(catch)f(\(ZMQSocketException)d($e\))k({)486
850 y(//)f(do)h(nothing)441 947 y(})441 1141 y(//)89
b(No)45 b(activity,)e(so)i(sleep)f(for)g(1)h(msec)441
1238 y(usleep\(1\);)-2 1416 y
SDict begin H.S end
 -2 1416 a -2 1416 a
SDict begin 13 H.A end
 -2
1416 a -2 1416 a
SDict begin [/View [/XYZ H.V]/Dest (0:746) cvn /DEST pdfmark end
 -2 1416 a 396 1512 a Fj(The)20 b(cost)h(of)e(this)i
(approach)d(is)j(some)f(additional)f(latenc)o(y)g(on)h(the)g(\002rst)h
(message)f(\(the)g(sleep)g(at)h(the)f(end)g(of)g(the)g(loop,)396
1620 y(when)g(there)g(are)g(no)f(w)o(aiting)h(messages)h(to)f
(process\).)f(This)i(w)o(ould)e(be)h(a)h(problem)d(in)j(applications)e
(where)396 1728 y(sub-millisecond)f(latenc)o(y)i(w)o(as)h(vital.)f
(Also,)g(you)f(need)h(to)g(check)g(the)g(documentation)d(for)j
(nanosleep\(\))e(or)396 1836 y(whate)n(v)o(er)h(function)f(you)i(use)g
(to)g(mak)o(e)g(sure)g(it)h(does)f(not)g(b)n(usy-loop.)-2
2020 y
SDict begin H.S end
 -2 2020 a -2 2020 a
SDict begin 13 H.A end
 -2 2020 a -2 2020 a
SDict begin [/View [/XYZ H.V]/Dest (0:747) cvn /DEST pdfmark end
 -2 2020
a 396 2110 a Fj(Y)-9 b(ou)20 b(can)g(treat)g(the)g(sock)o(ets)h(f)o
(airly)e(by)h(reading)f(\002rst)i(from)e(one,)g(then)h(the)g(second)g
(rather)f(than)h(prioritizing)e(them)i(as)396 2218 y(we)h(did)f(in)g
(this)h(e)o(xample.)-2 2402 y
SDict begin H.S end
 -2 2402 a -2 2402 a
SDict begin 13 H.A end
 -2
2402 a -2 2402 a
SDict begin [/View [/XYZ H.V]/Dest (0:748) cvn /DEST pdfmark end
 -2 2402 a 396 2492 a Fj(No)n(w)f(let')-5
b(s)21 b(see)g(the)f(same)h(little)g(senseless)g(application)e(done)g
(right,)g(using)2645 2492 y
SDict begin H.S end
 2645 2492 a 2645 2492 a
SDict begin 13 H.A end
 2645
2492 a 2645 2492 a
SDict begin [/View [/XYZ H.V]/Dest (0:749) cvn /DEST pdfmark end
 2645 2492 a Fg(zmq-poll[3])p Fj(:)-2
2510 y
SDict begin H.S end
 -2 2510 a -2 2510 a
SDict begin 13 H.A end
 -2 2510 a -2 2510 a
SDict begin [/View [/XYZ H.V]/Dest (0:mspoller-php) cvn /DEST pdfmark
end
 -2 2510
a 396 2693 a Fk(Example)i(2-2.)e(Multiple)i(sock)o(et)f(poller)h
(\(mspoller)-8 b(.php\))-2 2793 y
SDict begin H.S end
 -2 2793 a -2 2793 a
SDict begin 11.7 H.A end

-2 2793 a -2 2793 a
SDict begin [/View [/XYZ H.V]/Dest (0:752) cvn /DEST pdfmark end
 -2 2793 a 396 2873 a Fg(<?php)396
2970 y(/)441 2983 y(*)441 3080 y(*)576 3067 y(Reading)43
b(from)h(multiple)g(sockets)441 3178 y(*)576 3165 y(This)g(version)f
(uses)i(zmq_poll\(\))441 3275 y(*)531 3262 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 3372 y(*)486
3359 y(/)396 3553 y($context)g(=)g(new)h(ZMQContext\(\);)396
3747 y(//)90 b(Connect)43 b(to)i(task)f(ventilator)396
3845 y($receiver)g(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PULL\);)396 3942 y
($receiver->connect\("tcp://localhost:5557")o(\);)396
4136 y(//)90 b(Connect)43 b(to)i(weather)e(server)396
4233 y($subscriber)g(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_SUB\);)396 4330 y
($subscriber->connect\("tcp://localhost:555)o(6"\);)396
4427 y($subscriber->setSockOpt\(ZMQ::SOCKOPT_SUBS)o(CRIBE,)c
("10001"\);)396 4622 y(//)90 b(Initialize)43 b(poll)h(set)396
4719 y($poll)g(=)h(new)f(ZMQPoll\(\);)396 4816 y
($poll->add\($receiver,)e(ZMQ::POLL_IN\);)396 4913 y
($poll->add\($subscriber,)f(ZMQ::POLL_IN\);)396 5107
y($readable)j(=)g($writeable)f(=)i(array\(\);)p Black
3800 5569 a Fi(40)p Black eop end
%%Page: 41 55
TeXDict begin 41 54 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.41) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 170 a Fg(//)90 b(Process)43 b(messages)h(from)g
(both)g(sockets)396 267 y(while\(true\))f({)441 364 y($events)h(=)g
($poll->poll\($readable,)e($writeable\);)441 461 y(if\($events)h(>)i
(0\))f({)486 558 y(foreach\($readable)e(as)i($socket\))g({)531
655 y(if\($socket)f(===)h($receiver\))f({)576 752 y($message)g(=)i
($socket->recv\(\);)576 850 y(//)f(Process)g(task)531
947 y(})531 1044 y(else)g(if\($socket)f(===)h($subscriber\))f({)576
1141 y($mesage)g(=)i($socket->recv\(\);)576 1238 y(//)f(Process)g
(weather)f(update)531 1335 y(})486 1432 y(})441 1530
y(})396 1627 y(})396 1821 y(//)90 b(We)44 b(never)g(get)g(her)-2
1998 y
SDict begin H.S end
 -2 1998 a -2 1998 a
SDict begin 13 H.A end
 -2 1998 a -2 1998 a
SDict begin [/View [/XYZ H.V]/Dest (0:753) cvn /DEST pdfmark end
 -2 1998
a 396 2095 a Fj(The)20 b(items)h(structure)e(has)h(these)h(four)e
(members:)-2 2179 y
SDict begin H.S end
 -2 2179 a -2 2179 a
SDict begin 11.7 H.A end
 -2 2179 a -2
2179 a
SDict begin [/View [/XYZ H.V]/Dest (0:754) cvn /DEST pdfmark end
 -2 2179 a 396 2275 a Fg(typedef)44 b(struct)g({)576
2372 y(void)800 2385 y(*)845 2372 y(socket;)312 b(//)90
b(0MQ)44 b(socket)g(to)g(poll)g(on)576 2469 y(int)g(fd;)582
b(//)90 b(OR,)44 b(native)g(file)g(handle)g(to)g(poll)g(on)576
2566 y(short)g(events;)312 b(//)90 b(Events)43 b(to)i(poll)f(on)576
2664 y(short)g(revents;)267 b(//)90 b(Events)43 b(returned)h(after)g
(poll)396 2761 y(})h(zmq-pollitem-t;)-2 2855 y
SDict begin H.S end
 -2 2855
a -2 2855 a
SDict begin 13 H.A end
 -2 2855 a -2 2855 a
SDict begin [/View [/XYZ H.V]/Dest (0:755) cvn /DEST pdfmark end
 -2 2855 a 396 3172 a
Fd(2.2.4.)36 b(Multi-par)r(t)d(Messa)o(g)q(es)1878 3172
y
SDict begin H.S end
 1878 3172 a 1878 3172 a
SDict begin 18.72 H.A end
 1878 3172 a 1878 3172 a
SDict begin [/View [/XYZ H.V]/Dest (7.20.11.2) cvn /DEST pdfmark end
 1878
3172 a -2 3364 a
SDict begin H.S end
 -2 3364 a -2 3364 a
SDict begin 13 H.A end
 -2 3364 a -2 3364
a
SDict begin [/View [/XYZ H.V]/Dest (0:757) cvn /DEST pdfmark end
 -2 3364 a 396 3446 a Fj(\330MQ)21 b(lets)g(us)f(compose)f(a)i
(message)f(out)g(of)g(se)n(v)o(eral)f(frames,)h(gi)n(ving)e(us)j(a)g
("multi-part)d(message".)i(Realistic)396 3554 y(applications)f(use)i
(multi-part)e(messages)h(hea)n(vily)-5 b(,)19 b(both)g(for)h(wrapping)e
(messages)i(with)h(address)e(information,)f(and)396 3662
y(for)i(simple)g(serialization.)f(W)-7 b(e')o(ll)22 b(look)d(at)i
(address)e(en)m(v)o(elopes)g(later)-5 b(.)-2 3846 y
SDict begin H.S end
 -2
3846 a -2 3846 a
SDict begin 13 H.A end
 -2 3846 a -2 3846 a
SDict begin [/View [/XYZ H.V]/Dest (0:758) cvn /DEST pdfmark end
 -2 3846 a 396 3936
a Fj(What)21 b(we')o(ll)f(learn)g(no)n(w)g(is)h(simply)f(ho)n(w)f(to)i
(safely)f(\(b)n(ut)g(blindly\))e(read)i(and)f(write)i(multi-part)e
(messages)h(in)g(an)o(y)396 4044 y(application)f(\(lik)o(e)h(a)h
(proxy\))d(that)i(needs)g(to)g(forw)o(ard)f(messages)h(without)g
(inspecting)f(them.)-2 4228 y
SDict begin H.S end
 -2 4228 a -2 4228 a
SDict begin 13 H.A end
 -2
4228 a -2 4228 a
SDict begin [/View [/XYZ H.V]/Dest (0:759) cvn /DEST pdfmark end
 -2 4228 a 396 4318 a Fj(When)h(you)g(w)o(ork)f(with)h
(multi-part)f(messages,)h(each)g(part)g(is)h(a)2284 4318
y
SDict begin H.S end
 2284 4318 a 2284 4318 a
SDict begin 13 H.A end
 2284 4318 a 2284 4318 a
SDict begin [/View [/XYZ H.V]/Dest (0:760) cvn /DEST pdfmark end
 2284
4318 a Fg(zmq-msg)e Fj(item.)i(E.g.)e(if)i(you)e(are)h(sending)f(a)396
4425 y(message)h(with)h(\002)n(v)o(e)f(parts,)g(you)f(must)h
(construct,)f(send,)h(and)f(destro)o(y)h(\002)n(v)o(e)2626
4425 y
SDict begin H.S end
 2626 4425 a 2626 4425 a
SDict begin 13 H.A end
 2626 4425 a 2626 4425
a
SDict begin [/View [/XYZ H.V]/Dest (0:761) cvn /DEST pdfmark end
 2626 4425 a Fg(zmq-msg)f Fj(items.)i(Y)-9 b(ou)19 b(can)h(do)g(this)h
(in)396 4533 y(adv)n(ance)e(\(and)g(store)h(the)1160
4533 y
SDict begin H.S end
 1160 4533 a 1160 4533 a
SDict begin 13 H.A end
 1160 4533 a 1160 4533
a
SDict begin [/View [/XYZ H.V]/Dest (0:762) cvn /DEST pdfmark end
 1160 4533 a Fg(zmq-msg)f Fj(items)i(in)f(an)g(array)g(or)f
(structure\),)g(or)h(as)h(you)e(send)h(them,)g(one)f(by)h(one.)-2
4717 y
SDict begin H.S end
 -2 4717 a -2 4717 a
SDict begin 13 H.A end
 -2 4717 a -2 4717 a
SDict begin [/View [/XYZ H.V]/Dest (0:763) cvn /DEST pdfmark end
 -2 4717
a 396 4807 a Fj(Here)g(is)h(ho)n(w)f(we)h(send)f(the)g(frames)f(in)i(a)
f(multi-part)f(message)h(\(we)g(recei)n(v)o(e)g(each)f(frame)h(into)g
(a)g(message)g(object\):)-2 4908 y
SDict begin H.S end
 -2 4908 a -2 4908
a
SDict begin 11.7 H.A end
 -2 4908 a -2 4908 a
SDict begin [/View [/XYZ H.V]/Dest (0:764) cvn /DEST pdfmark end
 -2 4908 a 396 4988 a Fg(zmq-msg-send)43
b(\(socket,)h(&message,)f(ZMQ-SNDMORE\);)396 5085 y(...)p
Black 3800 5569 a Fi(41)p Black eop end
%%Page: 42 56
TeXDict begin 42 55 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.42) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fg(zmq-msg-send)43 b(\(socket,)h(&message,)f
(ZMQ-SNDMORE\);)396 170 y(...)396 267 y(zmq-msg-send)g(\(socket,)h
(&message,)f(0\);)-2 444 y
SDict begin H.S end
 -2 444 a -2 444 a
SDict begin 13 H.A end
 -2 444 a
-2 444 a
SDict begin [/View [/XYZ H.V]/Dest (0:765) cvn /DEST pdfmark end
 -2 444 a 396 541 a Fj(Here)20 b(is)h(ho)n(w)f(we)h(recei)n(v)o
(e)e(and)g(process)h(all)h(the)f(parts)g(in)h(a)f(message,)g(be)g(it)h
(single)f(part)g(or)g(multi-part:)-2 642 y
SDict begin H.S end
 -2 642 a -2
642 a
SDict begin 11.7 H.A end
 -2 642 a -2 642 a
SDict begin [/View [/XYZ H.V]/Dest (0:766) cvn /DEST pdfmark end
 -2 642 a 396 721 a Fg(while)44
b(\(1\))h({)576 818 y(zmq-msg-t)e(message;)576 915 y(zmq-msg-init)f
(\(&message\);)576 1012 y(zmq-msg-recv)g(\(socket,)i(&message,)f(0\);)
576 1109 y(//)89 b(Process)44 b(the)g(message)g(frame)576
1207 y(zmq-msg-close)e(\(&message\);)576 1304 y(int-t)i(more;)576
1401 y(size-t)f(more-size)h(=)g(sizeof)g(\(more\);)576
1498 y(zmq-getsockopt)e(\(socket,)i(ZMQ-RCVMORE,)e(&more,)i
(&more-size\);)576 1595 y(if)g(\(!more\))755 1692 y(break;)268
b(//)89 b(Last)44 b(message)g(frame)396 1789 y(})-2 1964
y
SDict begin H.S end
 -2 1964 a -2 1964 a
SDict begin 13 H.A end
 -2 1964 a -2 1964 a
SDict begin [/View [/XYZ H.V]/Dest (0:767) cvn /DEST pdfmark end
 -2 1964 a 396
2063 a Fj(Some)20 b(things)g(to)g(kno)n(w)f(about)h(multi-part)e
(messages:)-2 2081 y
SDict begin H.S end
 -2 2081 a -2 2081 a
SDict begin 13 H.A end
 -2 2081 a -2
2081 a
SDict begin [/View [/XYZ H.V]/Dest (0:768) cvn /DEST pdfmark end
 -2 2081 a -2 2091 a
SDict begin H.S end
 -2 2091 a -2 2091 a
SDict begin 13 H.A end
 -2 2091
a -2 2091 a
SDict begin [/View [/XYZ H.V]/Dest (0:769) cvn /DEST pdfmark end
 -2 2091 a Black 396 2234 a Fe(\225)p Black
479 2234 a
SDict begin H.S end
 479 2234 a 479 2234 a
SDict begin 13 H.A end
 479 2234 a 479 2234
a
SDict begin [/View [/XYZ H.V]/Dest (0:770) cvn /DEST pdfmark end
 479 2234 a Fj(When)i(you)g(send)g(a)g(multi-part)f(message,)h(the)g
(\002rst)h(part)f(\(and)f(all)i(follo)n(wing)d(parts\))i(are)g(only)g
(actually)f(sent)i(on)479 2341 y(the)f(wire)h(when)e(you)h(send)g(the)g
(\002nal)g(part.)-2 2359 y
SDict begin H.S end
 -2 2359 a -2 2359 a
SDict begin 13 H.A end
 -2 2359
a -2 2359 a
SDict begin [/View [/XYZ H.V]/Dest (0:771) cvn /DEST pdfmark end
 -2 2359 a Black 396 2491 a Fe(\225)p Black
479 2491 a
SDict begin H.S end
 479 2491 a 479 2491 a
SDict begin 13 H.A end
 479 2491 a 479 2491
a
SDict begin [/View [/XYZ H.V]/Dest (0:772) cvn /DEST pdfmark end
 479 2491 a Fj(If)g(you)g(are)g(using)1023 2491 y
SDict begin H.S end
 1023
2491 a 1023 2491 a
SDict begin 13 H.A end
 1023 2491 a 1023 2491 a
SDict begin [/View [/XYZ H.V]/Dest (0:773) cvn /DEST pdfmark end
 1023 2491
a Fg(zmq-poll[3])p Fj(,)f(when)h(you)f(recei)n(v)o(e)g(the)h(\002rst)h
(part)f(of)g(a)h(message,)e(all)i(the)f(rest)h(has)f(also)479
2599 y(arri)n(v)o(ed.)-2 2600 y
SDict begin H.S end
 -2 2600 a -2 2600 a
SDict begin 13 H.A end
 -2
2600 a -2 2600 a
SDict begin [/View [/XYZ H.V]/Dest (0:774) cvn /DEST pdfmark end
 -2 2600 a Black 396 2748 a Fe(\225)p
Black 479 2748 a
SDict begin H.S end
 479 2748 a 479 2748 a
SDict begin 13 H.A end
 479 2748 a 479
2748 a
SDict begin [/View [/XYZ H.V]/Dest (0:775) cvn /DEST pdfmark end
 479 2748 a Fj(Y)-9 b(ou)20 b(will)h(recei)n(v)o(e)e(all)i(parts)
f(of)g(a)g(message,)g(or)g(none)f(at)i(all.)-2 2766 y
SDict begin H.S end

-2 2766 a -2 2766 a
SDict begin 13 H.A end
 -2 2766 a -2 2766 a
SDict begin [/View [/XYZ H.V]/Dest (0:776) cvn /DEST pdfmark end
 -2 2766 a Black
396 2898 a Fe(\225)p Black 479 2898 a
SDict begin H.S end
 479 2898 a 479
2898 a
SDict begin 13 H.A end
 479 2898 a 479 2898 a
SDict begin [/View [/XYZ H.V]/Dest (0:777) cvn /DEST pdfmark end
 479 2898 a Fj(Each)f(part)g(of)g(a)g
(message)g(is)i(a)e(separate)1692 2898 y
SDict begin H.S end
 1692 2898 a
1692 2898 a
SDict begin 13 H.A end
 1692 2898 a 1692 2898 a
SDict begin [/View [/XYZ H.V]/Dest (0:778) cvn /DEST pdfmark end
 1692 2898 a Fg(zmq-msg)f
Fj(item.)-2 2916 y
SDict begin H.S end
 -2 2916 a -2 2916 a
SDict begin 13 H.A end
 -2 2916 a -2 2916
a
SDict begin [/View [/XYZ H.V]/Dest (0:779) cvn /DEST pdfmark end
 -2 2916 a Black 396 3047 a Fe(\225)p Black 479 3047
a
SDict begin H.S end
 479 3047 a 479 3047 a
SDict begin 13 H.A end
 479 3047 a 479 3047 a
SDict begin [/View [/XYZ H.V]/Dest (0:780) cvn /DEST pdfmark end
 479 3047
a Fj(Y)-9 b(ou)20 b(will)h(recei)n(v)o(e)e(all)i(parts)f(of)g(a)g
(message)g(whether)g(or)f(not)h(you)g(check)f(the)h(RCVMORE)h(option.)
-2 3065 y
SDict begin H.S end
 -2 3065 a -2 3065 a
SDict begin 13 H.A end
 -2 3065 a -2 3065 a
SDict begin [/View [/XYZ H.V]/Dest (0:781) cvn /DEST pdfmark end
 -2
3065 a Black 396 3197 a Fe(\225)p Black 479 3197 a
SDict begin H.S end
 479
3197 a 479 3197 a
SDict begin 13 H.A end
 479 3197 a 479 3197 a
SDict begin [/View [/XYZ H.V]/Dest (0:782) cvn /DEST pdfmark end
 479 3197 a Fj(On)f(sending,)f
(\330MQ)i(queues)e(message)h(frames)g(in)g(memory)f(until)h(the)g(last)
h(is)g(recei)n(v)o(ed,)d(then)i(sends)g(them)g(all.)-2
3215 y
SDict begin H.S end
 -2 3215 a -2 3215 a
SDict begin 13 H.A end
 -2 3215 a -2 3215 a
SDict begin [/View [/XYZ H.V]/Dest (0:783) cvn /DEST pdfmark end
 -2 3215
a Black 396 3346 a Fe(\225)p Black 479 3346 a
SDict begin H.S end
 479 3346
a 479 3346 a
SDict begin 13 H.A end
 479 3346 a 479 3346 a
SDict begin [/View [/XYZ H.V]/Dest (0:784) cvn /DEST pdfmark end
 479 3346 a Fj(There)g(is)h(no)f(w)o
(ay)g(to)g(cancel)g(a)h(partially)e(sent)i(message,)e(e)o(xcept)g(by)h
(closing)g(the)g(sock)o(et.)-2 3406 y
SDict begin H.S end
 -2 3406 a -2 3406
a
SDict begin 13 H.A end
 -2 3406 a -2 3406 a
SDict begin [/View [/XYZ H.V]/Dest (0:785) cvn /DEST pdfmark end
 -2 3406 a 396 3716 a Fd(2.2.5.)36
b(Intermediaries)f(and)f(Pr)n(o)l(xies)2250 3716 y
SDict begin H.S end
 2250
3716 a 2250 3716 a
SDict begin 18.72 H.A end
 2250 3716 a 2250 3716 a
SDict begin [/View [/XYZ H.V]/Dest (7.20.12.2) cvn /DEST pdfmark end
 2250 3716
a -2 3883 a
SDict begin H.S end
 -2 3883 a -2 3883 a
SDict begin 13 H.A end
 -2 3883 a -2 3883 a
SDict begin [/View [/XYZ H.V]/Dest (0:787) cvn /DEST pdfmark end
 -2
3883 a 396 3990 a Fj(\330MQ)21 b(aims)f(for)g(decentralized)e
(intelligence)h(b)n(ut)i(that)f(doesn')o(t)e(mean)i(your)f(netw)o(ork)g
(is)i(empty)e(space)i(in)f(the)396 4098 y(middle.)f(It')-5
b(s)21 b(\002lled)g(with)f(message-a)o(w)o(are)f(infrastructure)f(and)h
(quite)h(often,)f(we)i(b)n(uild)f(that)g(infrastructure)e(with)396
4205 y(\330MQ.)i(The)g(\330MQ)h(plumbing)d(can)i(range)f(from)g(tin)o
(y)h(pipes)g(to)g(full-blo)n(wn)e(service-oriented)g(brok)o(ers.)h(The)
396 4313 y(messaging)g(industry)f(calls)i(this)g("intermediation",)c
(meaning)i(that)i(the)f(stuf)n(f)g(in)h(the)f(middle)g(deals)g(with)h
(either)f(side.)396 4421 y(In)h(\330MQ)h(we)f(call)h(these)f(proxies,)f
(queues,)g(forw)o(arders,)f(de)n(vice,)i(or)f(brok)o(ers,)g(depending)f
(on)i(the)g(conte)o(xt.)-2 4605 y
SDict begin H.S end
 -2 4605 a -2 4605 a
SDict begin 13 H.A end

-2 4605 a -2 4605 a
SDict begin [/View [/XYZ H.V]/Dest (0:788) cvn /DEST pdfmark end
 -2 4605 a 396 4695 a Fj(This)h(pattern)e(is)i(e)o
(xtremely)e(common)f(in)i(the)g(real)h(w)o(orld)e(and)h(is)h(why)e(our)
h(societies)g(and)g(economies)f(are)h(\002lled)396 4803
y(with)h(intermediaries)d(who)i(ha)n(v)o(e)g(no)f(other)h(real)g
(function)e(than)i(to)h(reduce)e(the)h(comple)o(xity)e(and)h(scaling)h
(costs)h(of)396 4911 y(lar)o(ger)e(netw)o(orks.)g(Real-w)o(orld)h
(intermediaries)e(are)i(typically)g(called)g(wholesalers,)f(distrib)n
(utors,)g(managers,)g(etc.)-2 4940 y
SDict begin H.S end
 -2 4940 a -2 4940
a
SDict begin 13 H.A end
 -2 4940 a -2 4940 a
SDict begin [/View [/XYZ H.V]/Dest (0:789) cvn /DEST pdfmark end
 -2 4940 a Black 3800 5569 a Fi(42)p
Black eop end
%%Page: 43 57
TeXDict begin 43 56 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.43) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 77 a Fd(2.2.6.)36 b(The)d(Dynamic)j(Disco)n(ver)q
(y)f(Pr)n(ob)o(lem)2584 77 y
SDict begin H.S end
 2584 77 a 2584 77 a
SDict begin 18.72 H.A end
 2584
77 a 2584 77 a
SDict begin [/View [/XYZ H.V]/Dest (7.20.13.2) cvn /DEST pdfmark end
 2584 77 a -2 267 a
SDict begin H.S end
 -2 267 a -2 267 a
SDict begin 13 H.A end
 -2
267 a -2 267 a
SDict begin [/View [/XYZ H.V]/Dest (0:791) cvn /DEST pdfmark end
 -2 267 a 396 351 a Fj(One)20 b(of)g(the)g(problems)f
(you)h(will)g(hit)h(as)g(you)e(design)h(lar)o(ger)e(distrib)n(uted)i
(architectures)f(is)i(disco)o(v)o(ery)-5 b(.)17 b(That)j(is,)h(ho)n(w)
396 459 y(do)f(pieces)g(kno)n(w)f(about)h(each)f(other?)h(It')-5
b(s)21 b(especially)e(dif)n(\002cult)h(if)g(pieces)h(come)e(and)h(go,)f
(thus)i(we)f(can)g(call)h(this)f(the)396 566 y("dynamic)f(disco)o(v)o
(ery)f(problem".)-2 751 y
SDict begin H.S end
 -2 751 a -2 751 a
SDict begin 13 H.A end
 -2 751 a
-2 751 a
SDict begin [/View [/XYZ H.V]/Dest (0:792) cvn /DEST pdfmark end
 -2 751 a 396 840 a Fj(There)i(are)g(se)n(v)o(eral)f(solutions)
h(to)g(dynamic)f(disco)o(v)o(ery)-5 b(.)17 b(The)j(simplest)h(is)g(to)f
(entirely)g(a)n(v)n(oid)g(it)g(by)g(hard-coding)d(\(or)396
948 y(con\002guring\))g(the)k(netw)o(ork)e(architecture)f(so)j(disco)o
(v)o(ery)d(is)j(done)e(by)h(hand.)f(That)h(is,)h(when)e(you)h(add)f(a)i
(ne)n(w)f(piece,)396 1056 y(you)g(recon\002gure)d(the)k(netw)o(ork)e
(to)h(kno)n(w)f(about)g(it.)-2 1240 y
SDict begin H.S end
 -2 1240 a -2 1240
a
SDict begin 13 H.A end
 -2 1240 a -2 1240 a
SDict begin [/View [/XYZ H.V]/Dest (0:793) cvn /DEST pdfmark end
 -2 1240 a 396 1330 a Fj(In)h(practice)g(this)g
(leads)h(to)f(increasingly)f(fragile)g(and)h(hard-to-manage)c
(architectures.)j(Let')-5 b(s)21 b(say)f(you)f(ha)n(v)o(e)h(one)396
1438 y(publisher)f(and)h(a)g(hundred)e(subscribers.)h(Y)-9
b(ou)20 b(connect)f(each)h(subscriber)e(to)j(the)f(publisher)f(by)h
(con\002guring)d(a)396 1546 y(publisher)i(endpoint)f(in)j(each)f
(subscriber)-5 b(.)19 b(That')-5 b(s)20 b(easy\()p 0
TeXcolorgray 2078 1546 a
SDict begin H.S end
 2078 1546 a Fj(Figure)f(2-4)2427
1546 y
SDict begin 13 H.L end
 2427 1546 a 2427 1546 a
SDict begin [/Subtype /Link/Dest (0:figure-12) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2427 1546 a Black -2 w
Fj(\).)i(Subscribers)e(are)h(dynamic,)e(the)i(publisher)f(is)396
1654 y(static.)i(No)n(w)f(say)h(you)e(add)g(more)h(publishers.)f
(Suddenly)f(it')-5 b(s)21 b(not)f(so)h(easy)f(an)o(y)f(more.)h(If)g
(you)f(continue)g(to)h(connect)396 1762 y(each)g(subscriber)f(to)h
(each)g(publisher)m(,)e(the)j(cost)f(of)g(a)n(v)n(oiding)f(dynamic)g
(disco)o(v)o(ery)f(gets)i(higher)f(and)h(higher)-5 b(.)-2
1780 y
SDict begin H.S end
 -2 1780 a -2 1780 a
SDict begin 13 H.A end
 -2 1780 a -2 1780 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-12) cvn /DEST pdfmark
end
 -2 1780
a 396 1963 a Fk(Figur)o(e)20 b(2-4.)f(Small-scale)h(Pub-Sub)h(Netw)o
(ork)-2 2063 y
SDict begin H.S end
 -2 2063 a -2 2063 a
SDict begin 13 H.A end
 -2 2063 a -2 2063
a
SDict begin [/View [/XYZ H.V]/Dest (0:797) cvn /DEST pdfmark end
 -2 2063 a 396 4488 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4488 a @beginspecial 0 @llx
-286 @lly 416 @urx 0 @ury 4160 @rwi @setspecial
%%BeginDocument: images/fig12.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -286 416 0
%%HiResBoundingBox: 0.0 -286.0 416.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -29.400239944458008 moveto
158.40023803710938 -71.40023803710938 lineto
254.40023803710938 -71.40023803710938 lineto
254.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -74.40023803710938 moveto
158.40023803710938 -90.40023803710938 lineto
158.40023803710938 -93.7335713704427 159.73357137044272 -95.40023803710938 162.40023803710938 -95.40023803710938 curveto
250.40023803710938 -95.40023803710938 lineto
250.40023803710938 -95.40023803710938 lineto
253.06690470377603 -95.40023803710938 254.40023803710938 -93.7335713704427 254.40023803710938 -90.40023803710938 curveto
254.40023803710938 -75.00023651123047 lineto
254.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -194.40023803710938 moveto
23.73357327779134 -194.40023803710938 22.400239944458008 -196.40023803710938 22.400239944458008 -200.40023803710938 curveto
22.400239944458008 -214.40023803710938 lineto
126.40023803710938 -214.40023803710938 lineto
126.40023803710938 -200.40023803710938 lineto
126.40023803710938 -196.40023803710938 125.06690470377605 -194.40023803710938 122.40023803710938 -194.40023803710938 curveto
26.400239944458008 -194.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -217.40023803710938 moveto
22.400239944458008 -260.4002380371094 lineto
126.40023803710938 -260.4002380371094 lineto
126.40023803710938 -217.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
162.40023803710938 -194.40023803710938 moveto
159.73357137044272 -194.40023803710938 158.40023803710938 -196.40023803710938 158.40023803710938 -200.40023803710938 curveto
158.40023803710938 -214.40023803710938 lineto
262.4002380371094 -214.40023803710938 lineto
262.4002380371094 -200.40023803710938 lineto
262.4002380371094 -196.40023803710938 261.06690470377606 -194.40023803710938 258.4002380371094 -194.40023803710938 curveto
162.40023803710938 -194.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -217.40023803710938 moveto
158.40023803710938 -260.4002380371094 lineto
262.4002380371094 -260.4002380371094 lineto
262.4002380371094 -217.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
298.4002380371094 -194.40023803710938 moveto
295.7335713704427 -194.40023803710938 294.4002380371094 -196.40023803710938 294.4002380371094 -200.40023803710938 curveto
294.4002380371094 -214.40023803710938 lineto
398.4002380371094 -214.40023803710938 lineto
398.4002380371094 -200.40023803710938 lineto
398.4002380371094 -196.40023803710938 397.06690470377606 -194.40023803710938 394.4002380371094 -194.40023803710938 curveto
298.4002380371094 -194.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
294.4002380371094 -217.40023803710938 moveto
294.4002380371094 -260.4002380371094 lineto
398.4002380371094 -260.4002380371094 lineto
398.4002380371094 -217.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -27.0 moveto
156.0 -69.0 lineto
252.0 -69.0 lineto
252.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
156.0 -27.0 moveto
156.0 -69.0 lineto
252.0 -69.0 lineto
252.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -72.0 moveto
156.0 -88.0 lineto
156.0 -91.33333333333333 157.33333333333334 -93.0 160.0 -93.0 curveto
248.0 -93.0 lineto
248.0 -93.0 lineto
250.66666666666666 -93.0 252.0 -91.33333333333333 252.0 -88.0 curveto
252.0 -72.5999984741211 lineto
252.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -72.0 moveto
156.0 -88.0 lineto
156.0 -91.33333333333333 157.33333333333334 -93.0 160.0 -93.0 curveto
248.0 -93.0 lineto
248.0 -93.0 lineto
250.66666666666666 -93.0 252.0 -91.33333333333333 252.0 -88.0 curveto
252.0 -72.5999984741211 lineto
252.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -192.0 moveto
21.333333333333332 -192.0 20.0 -194.0 20.0 -198.0 curveto
20.0 -212.0 lineto
124.0 -212.0 lineto
124.0 -198.0 lineto
124.0 -194.0 122.66666666666667 -192.0 120.0 -192.0 curveto
24.0 -192.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -192.0 moveto
21.333333333333332 -192.0 20.0 -194.0 20.0 -198.0 curveto
20.0 -212.0 lineto
124.0 -212.0 lineto
124.0 -198.0 lineto
124.0 -194.0 122.66666666666667 -192.0 120.0 -192.0 curveto
24.0 -192.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -215.0 moveto
20.0 -258.0 lineto
124.0 -258.0 lineto
124.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -215.0 moveto
20.0 -258.0 lineto
124.0 -258.0 lineto
124.0 -215.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -192.0 moveto
157.33333333333334 -192.0 156.0 -194.0 156.0 -198.0 curveto
156.0 -212.0 lineto
260.0 -212.0 lineto
260.0 -198.0 lineto
260.0 -194.0 258.6666666666667 -192.0 256.0 -192.0 curveto
160.0 -192.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -192.0 moveto
157.33333333333334 -192.0 156.0 -194.0 156.0 -198.0 curveto
156.0 -212.0 lineto
260.0 -212.0 lineto
260.0 -198.0 lineto
260.0 -194.0 258.6666666666667 -192.0 256.0 -192.0 curveto
160.0 -192.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -215.0 moveto
156.0 -258.0 lineto
260.0 -258.0 lineto
260.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -215.0 moveto
156.0 -258.0 lineto
260.0 -258.0 lineto
260.0 -215.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
296.0 -192.0 moveto
293.3333333333333 -192.0 292.0 -194.0 292.0 -198.0 curveto
292.0 -212.0 lineto
396.0 -212.0 lineto
396.0 -198.0 lineto
396.0 -194.0 394.6666666666667 -192.0 392.0 -192.0 curveto
296.0 -192.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
296.0 -192.0 moveto
293.3333333333333 -192.0 292.0 -194.0 292.0 -198.0 curveto
292.0 -212.0 lineto
396.0 -212.0 lineto
396.0 -198.0 lineto
396.0 -194.0 394.6666666666667 -192.0 392.0 -192.0 curveto
296.0 -192.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
292.0 -215.0 moveto
292.0 -258.0 lineto
396.0 -258.0 lineto
396.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
292.0 -215.0 moveto
292.0 -258.0 lineto
396.0 -258.0 lineto
396.0 -215.0 lineto
closepath
stroke
newpath
204.0 -126.0 moveto
204.0 -148.0 lineto
stroke
newpath
68.0 -170.0 moveto
68.0 -148.0 lineto
204.0 -148.0 lineto
stroke
newpath
204.0 -170.0 moveto
204.0 -148.0 lineto
stroke
newpath
340.0 -170.0 moveto
340.0 -148.0 lineto
204.0 -148.0 lineto
stroke
/Helvetica findfont
11 scalefont setfont
174.0 -54.0 moveto
(Publisher) show
193.0 -87.0 moveto
(PUB) show
186.0 -109.0 moveto
(bind) show
120.0 -120.0 moveto
(tcp //192.168.55.210 5556) show
43.0 -186.0 moveto
(connect) show
187.0 -186.0 moveto
(connect) show
323.0 -186.0 moveto
(connect) show
57.0 -208.0 moveto
(SUB) show
193.0 -208.0 moveto
(SUB) show
329.0 -208.0 moveto
(SUB) show
38.0 -241.0 moveto
(Subscriber) show
174.0 -241.0 moveto
(Subscriber) show
310.0 -241.0 moveto
(Subscriber) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4488 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4488 a -2 4654 a
SDict begin H.S end
 -2 4654
a -2 4654 a
SDict begin 13 H.A end
 -2 4654 a -2 4654 a
SDict begin [/View [/XYZ H.V]/Dest (0:800) cvn /DEST pdfmark end
 -2 4654 a 396 4762 a
Fj(There)f(are)g(quite)g(a)g(fe)n(w)g(answers)g(to)h(this)g(b)n(ut)f
(the)g(v)o(ery)f(simplest)i(answer)e(is)j(to)e(add)f(an)i(intermediary)
-5 b(,)17 b(that)j(is,)h(a)396 4870 y(static)g(point)f(in)g(the)g(netw)
o(ork)f(to)i(which)e(all)i(other)e(nodes)h(connect.)f(In)g(classic)j
(messaging,)d(this)h(is)h(the)g(job)e(of)h(the)396 4978
y("message)g(brok)o(er".)e(\330MQ)j(doesn')o(t)e(come)g(with)h(a)h
(message)f(brok)o(er)f(as)i(such,)e(b)n(ut)i(it)f(lets)i(us)e(b)n(uild)
g(intermediaries)396 5086 y(quite)g(easily)-5 b(.)p Black
3800 5569 a Fi(43)p Black eop end
%%Page: 44 58
TeXDict begin 44 57 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.44) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:809) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:801) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Y)e(ou)20 b(might)f(w)o(onder)m(,)g(if)h
(all)h(netw)o(orks)e(e)n(v)o(entually)g(get)h(lar)o(ge)f(enough)f(to)j
(need)e(intermediaries,)f(why)i(don')o(t)e(we)396 180
y(simply)i(ha)n(v)o(e)g(a)g(message)g(brok)o(er)f(in)h(place)g(for)g
(all)h(applications?)d(F)o(or)i(be)o(ginners,)e(it')-5
b(s)22 b(a)e(f)o(air)g(compromise.)e(Just)396 288 y(al)o(w)o(ays)j(use)
f(a)h(star)g(topology)-5 b(,)17 b(for)o(get)h(about)i(performance,)d
(and)i(things)h(will)h(usually)f(w)o(ork.)f(Ho)n(we)n(v)o(er)g(message)
396 396 y(brok)o(ers)g(are)h(greedy)f(things;)h(in)g(their)g(role)g(as)
h(central)e(intermediaries,)g(the)o(y)g(become)g(too)h(comple)o(x,)e
(too)i(stateful,)396 504 y(and)g(e)n(v)o(entually)e(a)j(problem.)-2
688 y
SDict begin H.S end
 -2 688 a -2 688 a
SDict begin 13 H.A end
 -2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:802) cvn /DEST pdfmark end
 -2 688 a 396
778 a Fj(It')-5 b(s)21 b(better)f(to)g(think)g(of)g(intermediaries)e
(as)j(simple)f(stateless)i(message)e(switches.)g(The)g(best)h(analogy)d
(is)j(an)g(HTTP)396 886 y(proxy;)e(it')-5 b(s)21 b(there)f(b)n(ut)g
(doesn')o(t)f(ha)n(v)o(e)g(an)o(y)h(special)g(role.)g(Adding)e(a)j
(pub-sub)d(proxy)h(solv)o(es)h(the)g(dynamic)f(disco)o(v)o(ery)396
994 y(problem)g(in)h(our)f(e)o(xample.)g(W)-7 b(e)21
b(set)g(the)g(proxy)d(in)i(the)h("middle")e(of)h(the)g(netw)o(ork\()p
0 TeXcolorgray 2851 994 a
SDict begin H.S end
 2851 994 a Fj(Figure)d(2-5)3198
994 y
SDict begin 13 H.L end
 3198 994 a 3198 994 a
SDict begin [/Subtype /Link/Dest (0:figure-13) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3198 994 a Black -1 w Fj(\).)j(The)g(proxy)
e(opens)396 1102 y(an)i(XSUB)i(sock)o(et,)d(an)h(XPUB)i(sock)o(et,)d
(and)h(binds)g(each)g(to)g(well-kno)n(wn)e(IP)j(addresses)f(and)f
(ports.)h(Then)f(all)i(other)396 1210 y(processes)f(connect)f(to)h(the)
h(proxy)-5 b(,)17 b(instead)j(of)g(to)h(each)f(other)-5
b(.)19 b(It)i(becomes)e(tri)n(vial)h(to)g(add)g(more)f(subscribers)g
(or)396 1318 y(publishers.)-2 1336 y
SDict begin H.S end
 -2 1336 a -2 1336
a
SDict begin 13 H.A end
 -2 1336 a -2 1336 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-13) cvn /DEST pdfmark
end
 -2 1336 a Black 3800 5569 a Fi(44)p
Black eop end
%%Page: 45 59
TeXDict begin 45 58 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.45) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:816) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-5.)f(Pub-Sub)i(Netw)o
(ork)f(with)g(a)h(Pr)o(oxy)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end

-2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:806) cvn /DEST pdfmark end
 -2 172 a 396 3972 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3972 a @beginspecial
0 @llx -451 @lly 416 @urx 0 @ury 4160 @rwi @setspecial
%%BeginDocument: images/fig13.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -451 416 0
%%HiResBoundingBox: 0.0 -451.0 416.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -29.400239944458008 moveto
22.400239944458008 -71.40023803710938 lineto
126.40023803710938 -71.40023803710938 lineto
126.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -74.40023803710938 moveto
22.400239944458008 -90.40023803710938 lineto
22.400239944458008 -93.7335713704427 23.73357327779134 -95.40023803710938 26.400239944458008 -95.40023803710938 curveto
122.40023803710938 -95.40023803710938 lineto
122.40023803710938 -95.40023803710938 lineto
125.06690470377605 -95.40023803710938 126.40023803710938 -93.7335713704427 126.40023803710938 -90.40023803710938 curveto
126.40023803710938 -75.00023651123047 lineto
126.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -29.400239944458008 moveto
158.40023803710938 -71.40023803710938 lineto
262.4002380371094 -71.40023803710938 lineto
262.4002380371094 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -74.40023803710938 moveto
158.40023803710938 -90.40023803710938 lineto
158.40023803710938 -93.7335713704427 159.73357137044272 -95.40023803710938 162.40023803710938 -95.40023803710938 curveto
258.4002380371094 -95.40023803710938 lineto
258.4002380371094 -95.40023803710938 lineto
261.06690470377606 -95.40023803710938 262.4002380371094 -93.7335713704427 262.4002380371094 -90.40023803710938 curveto
262.4002380371094 -75.00023651123047 lineto
262.4002380371094 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
294.4002380371094 -29.400239944458008 moveto
294.4002380371094 -71.40023803710938 lineto
398.4002380371094 -71.40023803710938 lineto
398.4002380371094 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
294.4002380371094 -74.40023803710938 moveto
294.4002380371094 -90.40023803710938 lineto
294.4002380371094 -93.7335713704427 295.7335713704427 -95.40023803710938 298.4002380371094 -95.40023803710938 curveto
394.4002380371094 -95.40023803710938 lineto
394.4002380371094 -95.40023803710938 lineto
397.06690470377606 -95.40023803710938 398.4002380371094 -93.7335713704427 398.4002380371094 -90.40023803710938 curveto
398.4002380371094 -75.00023651123047 lineto
398.4002380371094 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
162.40023803710938 -183.40023803710938 moveto
159.73357137044272 -183.40023803710938 158.40023803710938 -185.40023803710938 158.40023803710938 -189.40023803710938 curveto
158.40023803710938 -203.40023803710938 lineto
262.4002380371094 -203.40023803710938 lineto
262.4002380371094 -189.40023803710938 lineto
262.4002380371094 -185.40023803710938 261.06690470377606 -183.40023803710938 258.4002380371094 -183.40023803710938 curveto
162.40023803710938 -183.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -206.40023803710938 moveto
158.40023803710938 -247.40023803710938 lineto
262.4002380371094 -247.40023803710938 lineto
262.4002380371094 -206.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -250.40023803710938 moveto
158.40023803710938 -266.4002380371094 lineto
158.40023803710938 -269.7335713704427 159.73357137044272 -271.4002380371094 162.40023803710938 -271.4002380371094 curveto
258.4002380371094 -271.4002380371094 lineto
258.4002380371094 -271.4002380371094 lineto
261.06690470377606 -271.4002380371094 262.4002380371094 -269.7335713704427 262.4002380371094 -266.4002380371094 curveto
262.4002380371094 -251.000244140625 lineto
262.4002380371094 -250.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -359.4002380371094 moveto
23.73357327779134 -359.4002380371094 22.400239944458008 -361.4002380371094 22.400239944458008 -365.4002380371094 curveto
22.400239944458008 -379.4002380371094 lineto
126.40023803710938 -379.4002380371094 lineto
126.40023803710938 -365.4002380371094 lineto
126.40023803710938 -361.4002380371094 125.06690470377605 -359.4002380371094 122.40023803710938 -359.4002380371094 curveto
26.400239944458008 -359.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -382.4002380371094 moveto
22.400239944458008 -425.4002380371094 lineto
126.40023803710938 -425.4002380371094 lineto
126.40023803710938 -382.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
162.40023803710938 -359.4002380371094 moveto
159.73357137044272 -359.4002380371094 158.40023803710938 -361.4002380371094 158.40023803710938 -365.4002380371094 curveto
158.40023803710938 -379.4002380371094 lineto
262.4002380371094 -379.4002380371094 lineto
262.4002380371094 -365.4002380371094 lineto
262.4002380371094 -361.4002380371094 261.06690470377606 -359.4002380371094 258.4002380371094 -359.4002380371094 curveto
162.40023803710938 -359.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -382.4002380371094 moveto
158.40023803710938 -425.4002380371094 lineto
262.4002380371094 -425.4002380371094 lineto
262.4002380371094 -382.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
298.4002380371094 -359.4002380371094 moveto
295.7335713704427 -359.4002380371094 294.4002380371094 -361.4002380371094 294.4002380371094 -365.4002380371094 curveto
294.4002380371094 -379.4002380371094 lineto
398.4002380371094 -379.4002380371094 lineto
398.4002380371094 -365.4002380371094 lineto
398.4002380371094 -361.4002380371094 397.06690470377606 -359.4002380371094 394.4002380371094 -359.4002380371094 curveto
298.4002380371094 -359.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
294.4002380371094 -382.4002380371094 moveto
294.4002380371094 -425.4002380371094 lineto
398.4002380371094 -425.4002380371094 lineto
398.4002380371094 -382.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -27.0 moveto
20.0 -69.0 lineto
124.0 -69.0 lineto
124.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -27.0 moveto
20.0 -69.0 lineto
124.0 -69.0 lineto
124.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -72.0 moveto
20.0 -88.0 lineto
20.0 -91.33333333333333 21.333333333333332 -93.0 24.0 -93.0 curveto
120.0 -93.0 lineto
120.0 -93.0 lineto
122.66666666666667 -93.0 124.0 -91.33333333333333 124.0 -88.0 curveto
124.0 -72.5999984741211 lineto
124.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -72.0 moveto
20.0 -88.0 lineto
20.0 -91.33333333333333 21.333333333333332 -93.0 24.0 -93.0 curveto
120.0 -93.0 lineto
120.0 -93.0 lineto
122.66666666666667 -93.0 124.0 -91.33333333333333 124.0 -88.0 curveto
124.0 -72.5999984741211 lineto
124.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -27.0 moveto
156.0 -69.0 lineto
260.0 -69.0 lineto
260.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -27.0 moveto
156.0 -69.0 lineto
260.0 -69.0 lineto
260.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -72.0 moveto
156.0 -88.0 lineto
156.0 -91.33333333333333 157.33333333333334 -93.0 160.0 -93.0 curveto
256.0 -93.0 lineto
256.0 -93.0 lineto
258.6666666666667 -93.0 260.0 -91.33333333333333 260.0 -88.0 curveto
260.0 -72.5999984741211 lineto
260.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -72.0 moveto
156.0 -88.0 lineto
156.0 -91.33333333333333 157.33333333333334 -93.0 160.0 -93.0 curveto
256.0 -93.0 lineto
256.0 -93.0 lineto
258.6666666666667 -93.0 260.0 -91.33333333333333 260.0 -88.0 curveto
260.0 -72.5999984741211 lineto
260.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
292.0 -27.0 moveto
292.0 -69.0 lineto
396.0 -69.0 lineto
396.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
292.0 -27.0 moveto
292.0 -69.0 lineto
396.0 -69.0 lineto
396.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
292.0 -72.0 moveto
292.0 -88.0 lineto
292.0 -91.33333333333333 293.3333333333333 -93.0 296.0 -93.0 curveto
392.0 -93.0 lineto
392.0 -93.0 lineto
394.6666666666667 -93.0 396.0 -91.33333333333333 396.0 -88.0 curveto
396.0 -72.5999984741211 lineto
396.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
292.0 -72.0 moveto
292.0 -88.0 lineto
292.0 -91.33333333333333 293.3333333333333 -93.0 296.0 -93.0 curveto
392.0 -93.0 lineto
392.0 -93.0 lineto
394.6666666666667 -93.0 396.0 -91.33333333333333 396.0 -88.0 curveto
396.0 -72.5999984741211 lineto
396.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -181.0 moveto
157.33333333333334 -181.0 156.0 -183.0 156.0 -187.0 curveto
156.0 -201.0 lineto
260.0 -201.0 lineto
260.0 -187.0 lineto
260.0 -183.0 258.6666666666667 -181.0 256.0 -181.0 curveto
160.0 -181.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -181.0 moveto
157.33333333333334 -181.0 156.0 -183.0 156.0 -187.0 curveto
156.0 -201.0 lineto
260.0 -201.0 lineto
260.0 -187.0 lineto
260.0 -183.0 258.6666666666667 -181.0 256.0 -181.0 curveto
160.0 -181.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -204.0 moveto
156.0 -245.0 lineto
260.0 -245.0 lineto
260.0 -204.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -204.0 moveto
156.0 -245.0 lineto
260.0 -245.0 lineto
260.0 -204.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -248.0 moveto
156.0 -264.0 lineto
156.0 -267.3333333333333 157.33333333333334 -269.0 160.0 -269.0 curveto
256.0 -269.0 lineto
256.0 -269.0 lineto
258.6666666666667 -269.0 260.0 -267.3333333333333 260.0 -264.0 curveto
260.0 -248.60000610351562 lineto
260.0 -248.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -248.0 moveto
156.0 -264.0 lineto
156.0 -267.3333333333333 157.33333333333334 -269.0 160.0 -269.0 curveto
256.0 -269.0 lineto
256.0 -269.0 lineto
258.6666666666667 -269.0 260.0 -267.3333333333333 260.0 -264.0 curveto
260.0 -248.60000610351562 lineto
260.0 -248.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -357.0 moveto
21.333333333333332 -357.0 20.0 -359.0 20.0 -363.0 curveto
20.0 -377.0 lineto
124.0 -377.0 lineto
124.0 -363.0 lineto
124.0 -359.0 122.66666666666667 -357.0 120.0 -357.0 curveto
24.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -357.0 moveto
21.333333333333332 -357.0 20.0 -359.0 20.0 -363.0 curveto
20.0 -377.0 lineto
124.0 -377.0 lineto
124.0 -363.0 lineto
124.0 -359.0 122.66666666666667 -357.0 120.0 -357.0 curveto
24.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -380.0 moveto
20.0 -423.0 lineto
124.0 -423.0 lineto
124.0 -380.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -380.0 moveto
20.0 -423.0 lineto
124.0 -423.0 lineto
124.0 -380.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -357.0 moveto
157.33333333333334 -357.0 156.0 -359.0 156.0 -363.0 curveto
156.0 -377.0 lineto
260.0 -377.0 lineto
260.0 -363.0 lineto
260.0 -359.0 258.6666666666667 -357.0 256.0 -357.0 curveto
160.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -357.0 moveto
157.33333333333334 -357.0 156.0 -359.0 156.0 -363.0 curveto
156.0 -377.0 lineto
260.0 -377.0 lineto
260.0 -363.0 lineto
260.0 -359.0 258.6666666666667 -357.0 256.0 -357.0 curveto
160.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -380.0 moveto
156.0 -423.0 lineto
260.0 -423.0 lineto
260.0 -380.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -380.0 moveto
156.0 -423.0 lineto
260.0 -423.0 lineto
260.0 -380.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
296.0 -357.0 moveto
293.3333333333333 -357.0 292.0 -359.0 292.0 -363.0 curveto
292.0 -377.0 lineto
396.0 -377.0 lineto
396.0 -363.0 lineto
396.0 -359.0 394.6666666666667 -357.0 392.0 -357.0 curveto
296.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
296.0 -357.0 moveto
293.3333333333333 -357.0 292.0 -359.0 292.0 -363.0 curveto
292.0 -377.0 lineto
396.0 -377.0 lineto
396.0 -363.0 lineto
396.0 -359.0 394.6666666666667 -357.0 392.0 -357.0 curveto
296.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
292.0 -380.0 moveto
292.0 -423.0 lineto
396.0 -423.0 lineto
396.0 -380.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
292.0 -380.0 moveto
292.0 -423.0 lineto
396.0 -423.0 lineto
396.0 -380.0 lineto
closepath
stroke
newpath
68.0 -115.0 moveto
68.0 -137.0 lineto
204.0 -137.0 lineto
stroke
newpath
204.0 -115.0 moveto
204.0 -137.0 lineto
stroke
newpath
340.0 -115.0 moveto
340.0 -137.0 lineto
204.0 -137.0 lineto
stroke
newpath
204.0 -159.0 moveto
204.0 -137.0 lineto
stroke
newpath
204.0 -291.0 moveto
204.0 -313.0 lineto
stroke
newpath
68.0 -335.0 moveto
68.0 -313.0 lineto
204.0 -313.0 lineto
stroke
newpath
204.0 -335.0 moveto
204.0 -313.0 lineto
stroke
newpath
340.0 -335.0 moveto
340.0 -313.0 lineto
204.0 -313.0 lineto
stroke
/Helvetica findfont
11 scalefont setfont
38.0 -54.0 moveto
(Publisher) show
174.0 -54.0 moveto
(Publisher) show
310.0 -54.0 moveto
(Publisher) show
57.0 -87.0 moveto
(PUB) show
193.0 -87.0 moveto
(PUB) show
329.0 -87.0 moveto
(PUB) show
43.0 -109.0 moveto
(connect) show
179.0 -109.0 moveto
(connect) show
315.0 -109.0 moveto
(connect) show
194.0 -175.0 moveto
(bind) show
193.0 -197.0 moveto
(XSUB) show
187.0 -230.0 moveto
(Proxy) show
193.0 -263.0 moveto
(XPUB) show
194.0 -285.0 moveto
(bind) show
43.0 -351.0 moveto
(connect) show
187.0 -351.0 moveto
(connect) show
323.0 -351.0 moveto
(connect) show
57.0 -373.0 moveto
(SUB) show
193.0 -373.0 moveto
(SUB) show
329.0 -373.0 moveto
(SUB) show
38.0 -406.0 moveto
(Subscriber) show
174.0 -406.0 moveto
(Subscriber) show
310.0 -406.0 moveto
(Subscriber) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3972 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3972 a 274 x Fj(W)-7 b(e)22
b(need)d(XPUB)i(and)f(XSUB)h(sock)o(ets)f(because)g(\330MQ)g(does)g
(subscription)f(forw)o(arding:)f(SUB)j(sock)o(ets)f(actually)396
4354 y(send)g(subscriptions)f(to)h(PUB)i(sock)o(ets)e(as)h(special)f
(messages.)g(The)g(proxy)f(has)h(to)g(forw)o(ard)f(these)h(as)h(well,)g
(by)396 4462 y(reading)e(them)h(from)f(the)h(XPUB)h(sock)o(et)f(and)g
(writing)g(them)f(to)i(the)f(XSUB)h(sock)o(et.)f(This)g(is)h(the)g
(main)e(use-case)h(for)396 4570 y(XSUB)h(and)f(XPUB\()p
0 TeXcolorgray 1028 4570 a
SDict begin H.S end
 1028 4570 a Fj(Figure)g(2-6)1378
4570 y
SDict begin 13 H.L end
 1378 4570 a 1378 4570 a
SDict begin [/Subtype /Link/Dest (0:figure-14) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1378 4570 a Black -2 w
Fj(\).)-2 4588 y
SDict begin H.S end
 -2 4588 a -2 4588 a
SDict begin 13 H.A end
 -2 4588 a -2 4588
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-14) cvn /DEST pdfmark
end
 -2 4588 a Black 3800 5569 a Fi(45)p Black eop end
%%Page: 46 60
TeXDict begin 46 59 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.46) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-6.)f(Extended)h
(Publish-Subscribe)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172
a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:813) cvn /DEST pdfmark end
 -2 172 a 396 3364 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3364 a @beginspecial
0 @llx -378 @lly 430 @urx 0 @ury 4300 @rwi @setspecial
%%BeginDocument: images/fig14.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -378 430 0
%%HiResBoundingBox: 0.0 -378.0 430.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -59.000301361083984 lineto
28.00029945373535 -63.66696548461914 29.666966756184895 -66.00029754638672 33.000301361083984 -66.00029754638672 curveto
123.00029754638672 -66.00029754638672 lineto
123.00029754638672 -66.00029754638672 lineto
126.33363596598308 -66.00029754638672 128.00030517578125 -63.66696548461914 128.00030517578125 -59.000301361083984 curveto
128.00030517578125 -38.000301361083984 lineto
128.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -38.000301361083984 moveto
168.00030517578125 -59.000301361083984 lineto
168.00030517578125 -63.66696548461914 169.6669718424479 -66.00029754638672 173.00030517578125 -66.00029754638672 curveto
263.00030517578125 -66.00029754638672 lineto
263.00030517578125 -66.00029754638672 lineto
266.33363850911456 -66.00029754638672 268.00030517578125 -63.66696548461914 268.00030517578125 -59.000301361083984 curveto
268.00030517578125 -38.000301361083984 lineto
268.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -38.000301361083984 moveto
308.00030517578125 -59.000301361083984 lineto
308.00030517578125 -63.66696548461914 309.66697184244794 -66.00029754638672 313.00030517578125 -66.00029754638672 curveto
403.00030517578125 -66.00029754638672 lineto
403.00030517578125 -66.00029754638672 lineto
406.33363850911456 -66.00029754638672 408.00030517578125 -63.66696548461914 408.00030517578125 -59.000301361083984 curveto
408.00030517578125 -38.000301361083984 lineto
408.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.00030517578125 -150.00030517578125 moveto
159.6669718424479 -150.00030517578125 158.00030517578125 -152.3336385091146 158.00030517578125 -157.00030517578125 curveto
158.00030517578125 -176.00030517578125 lineto
278.00030517578125 -176.00030517578125 lineto
278.00030517578125 -157.00030517578125 lineto
278.00030517578125 -152.3336385091146 276.33363850911456 -150.00030517578125 273.00030517578125 -150.00030517578125 curveto
163.00030517578125 -150.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -180.00030517578125 moveto
158.00030517578125 -204.00030517578125 lineto
278.00030517578125 -204.00030517578125 lineto
278.00030517578125 -180.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -208.00030517578125 moveto
158.00030517578125 -227.00030517578125 lineto
158.00030517578125 -231.6669718424479 159.6669718424479 -234.00030517578125 163.00030517578125 -234.00030517578125 curveto
273.00030517578125 -234.00030517578125 lineto
273.00030517578125 -234.00030517578125 lineto
276.33363850911456 -234.00030517578125 278.00030517578125 -231.6669718424479 278.00030517578125 -227.00030517578125 curveto
278.00030517578125 -208.00030517578125 lineto
278.00030517578125 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -318.00030517578125 moveto
29.666966756184895 -318.00030517578125 28.00029945373535 -320.33363850911456 28.00029945373535 -325.00030517578125 curveto
28.00029945373535 -346.00030517578125 lineto
128.00030517578125 -346.00030517578125 lineto
128.00030517578125 -325.00030517578125 lineto
128.00030517578125 -320.33363850911456 126.33363596598308 -318.00030517578125 123.00029754638672 -318.00030517578125 curveto
33.000301361083984 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
173.00030517578125 -318.00030517578125 moveto
169.6669718424479 -318.00030517578125 168.00030517578125 -320.33363850911456 168.00030517578125 -325.00030517578125 curveto
168.00030517578125 -346.00030517578125 lineto
268.00030517578125 -346.00030517578125 lineto
268.00030517578125 -325.00030517578125 lineto
268.00030517578125 -320.33363850911456 266.33363850911456 -318.00030517578125 263.00030517578125 -318.00030517578125 curveto
173.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
313.00030517578125 -318.00030517578125 moveto
309.66697184244794 -318.00030517578125 308.00030517578125 -320.33363850911456 308.00030517578125 -325.00030517578125 curveto
308.00030517578125 -346.00030517578125 lineto
408.00030517578125 -346.00030517578125 lineto
408.00030517578125 -325.00030517578125 lineto
408.00030517578125 -320.33363850911456 406.33363850911456 -318.00030517578125 403.00030517578125 -318.00030517578125 curveto
313.00030517578125 -318.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -56.0 lineto
25.0 -60.666666666666664 26.666666666666668 -63.0 30.0 -63.0 curveto
120.0 -63.0 lineto
120.0 -63.0 lineto
123.33333333333333 -63.0 125.0 -60.666666666666664 125.0 -56.0 curveto
125.0 -35.0 lineto
125.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -56.0 lineto
25.0 -60.666666666666664 26.666666666666668 -63.0 30.0 -63.0 curveto
120.0 -63.0 lineto
120.0 -63.0 lineto
123.33333333333333 -63.0 125.0 -60.666666666666664 125.0 -56.0 curveto
125.0 -35.0 lineto
125.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -56.0 lineto
165.0 -60.666666666666664 166.66666666666666 -63.0 170.0 -63.0 curveto
260.0 -63.0 lineto
260.0 -63.0 lineto
263.3333333333333 -63.0 265.0 -60.666666666666664 265.0 -56.0 curveto
265.0 -35.0 lineto
265.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -56.0 lineto
165.0 -60.666666666666664 166.66666666666666 -63.0 170.0 -63.0 curveto
260.0 -63.0 lineto
260.0 -63.0 lineto
263.3333333333333 -63.0 265.0 -60.666666666666664 265.0 -56.0 curveto
265.0 -35.0 lineto
265.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -56.0 lineto
305.0 -60.666666666666664 306.6666666666667 -63.0 310.0 -63.0 curveto
400.0 -63.0 lineto
400.0 -63.0 lineto
403.3333333333333 -63.0 405.0 -60.666666666666664 405.0 -56.0 curveto
405.0 -35.0 lineto
405.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -56.0 lineto
305.0 -60.666666666666664 306.6666666666667 -63.0 310.0 -63.0 curveto
400.0 -63.0 lineto
400.0 -63.0 lineto
403.3333333333333 -63.0 405.0 -60.666666666666664 405.0 -56.0 curveto
405.0 -35.0 lineto
405.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -147.0 moveto
156.66666666666666 -147.0 155.0 -149.33333333333334 155.0 -154.0 curveto
155.0 -173.0 lineto
275.0 -173.0 lineto
275.0 -154.0 lineto
275.0 -149.33333333333334 273.3333333333333 -147.0 270.0 -147.0 curveto
160.0 -147.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -147.0 moveto
156.66666666666666 -147.0 155.0 -149.33333333333334 155.0 -154.0 curveto
155.0 -173.0 lineto
275.0 -173.0 lineto
275.0 -154.0 lineto
275.0 -149.33333333333334 273.3333333333333 -147.0 270.0 -147.0 curveto
160.0 -147.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -177.0 moveto
155.0 -201.0 lineto
275.0 -201.0 lineto
275.0 -177.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -177.0 moveto
155.0 -201.0 lineto
275.0 -201.0 lineto
275.0 -177.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -205.0 moveto
155.0 -224.0 lineto
155.0 -228.66666666666666 156.66666666666666 -231.0 160.0 -231.0 curveto
270.0 -231.0 lineto
270.0 -231.0 lineto
273.3333333333333 -231.0 275.0 -228.66666666666666 275.0 -224.0 curveto
275.0 -205.0 lineto
275.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -205.0 moveto
155.0 -224.0 lineto
155.0 -228.66666666666666 156.66666666666666 -231.0 160.0 -231.0 curveto
270.0 -231.0 lineto
270.0 -231.0 lineto
273.3333333333333 -231.0 275.0 -228.66666666666666 275.0 -224.0 curveto
275.0 -205.0 lineto
275.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -315.0 moveto
26.666666666666668 -315.0 25.0 -317.3333333333333 25.0 -322.0 curveto
25.0 -343.0 lineto
125.0 -343.0 lineto
125.0 -322.0 lineto
125.0 -317.3333333333333 123.33333333333333 -315.0 120.0 -315.0 curveto
30.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -315.0 moveto
26.666666666666668 -315.0 25.0 -317.3333333333333 25.0 -322.0 curveto
25.0 -343.0 lineto
125.0 -343.0 lineto
125.0 -322.0 lineto
125.0 -317.3333333333333 123.33333333333333 -315.0 120.0 -315.0 curveto
30.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
170.0 -315.0 moveto
166.66666666666666 -315.0 165.0 -317.3333333333333 165.0 -322.0 curveto
165.0 -343.0 lineto
265.0 -343.0 lineto
265.0 -322.0 lineto
265.0 -317.3333333333333 263.3333333333333 -315.0 260.0 -315.0 curveto
170.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
170.0 -315.0 moveto
166.66666666666666 -315.0 165.0 -317.3333333333333 165.0 -322.0 curveto
165.0 -343.0 lineto
265.0 -343.0 lineto
265.0 -322.0 lineto
265.0 -317.3333333333333 263.3333333333333 -315.0 260.0 -315.0 curveto
170.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
310.0 -315.0 moveto
306.6666666666667 -315.0 305.0 -317.3333333333333 305.0 -322.0 curveto
305.0 -343.0 lineto
405.0 -343.0 lineto
405.0 -322.0 lineto
405.0 -317.3333333333333 403.3333333333333 -315.0 400.0 -315.0 curveto
310.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
310.0 -315.0 moveto
306.6666666666667 -315.0 305.0 -317.3333333333333 305.0 -322.0 curveto
305.0 -343.0 lineto
405.0 -343.0 lineto
405.0 -322.0 lineto
405.0 -317.3333333333333 403.3333333333333 -315.0 400.0 -315.0 curveto
310.0 -315.0 lineto
closepath
stroke
newpath
75.0 -63.0 moveto
75.0 -105.0 lineto
215.0 -105.0 lineto
stroke
newpath
215.0 -63.0 moveto
215.0 -105.0 lineto
stroke
newpath
355.0 -63.0 moveto
355.0 -105.0 lineto
215.0 -105.0 lineto
stroke
newpath
215.0 -147.0 moveto
215.0 -105.0 lineto
stroke
newpath
215.0 -231.0 moveto
215.0 -273.0 lineto
stroke
newpath
75.0 -315.0 moveto
75.0 -273.0 lineto
215.0 -273.0 lineto
stroke
newpath
215.0 -315.0 moveto
215.0 -273.0 lineto
stroke
newpath
355.0 -315.0 moveto
355.0 -273.0 lineto
215.0 -273.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
60.0 -54.0 moveto
(PUB) show
200.0 -54.0 moveto
(PUB) show
340.0 -54.0 moveto
(PUB) show
191.0 -166.0 moveto
(XSUB) show
191.0 -194.0 moveto
(code) show
190.0 -222.0 moveto
(XPUB) show
61.0 -334.0 moveto
(SUB) show
201.0 -334.0 moveto
(SUB) show
341.0 -334.0 moveto
(SUB) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3364 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3364 a -2 3447 a
SDict begin H.S end
 -2 3447
a -2 3447 a
SDict begin 13 H.A end
 -2 3447 a -2 3447 a
SDict begin [/View [/XYZ H.V]/Dest (0:816) cvn /DEST pdfmark end
 -2 3447 a 396 3775 a
Fd(2.2.7.)36 b(Shared)d(Queue)h(\(DEALER)g(and)g(R)n(OUTER)f(soc)n
(kets\))3399 3775 y
SDict begin H.S end
 3399 3775 a 3399 3775 a
SDict begin 18.72 H.A end
 3399 3775
a 3399 3775 a
SDict begin [/View [/XYZ H.V]/Dest (7.20.14.2) cvn /DEST pdfmark end
 3399 3775 a -2 3966 a
SDict begin H.S end
 -2 3966 a -2 3966
a
SDict begin 13 H.A end
 -2 3966 a -2 3966 a
SDict begin [/View [/XYZ H.V]/Dest (0:818) cvn /DEST pdfmark end
 -2 3966 a 396 4049 a Fj(In)20 b(the)g(Hello)h(W)
-7 b(orld)20 b(client-serv)o(er)e(application)h(we)i(ha)n(v)o(e)e(one)h
(client)g(that)g(talks)h(to)f(one)g(service.)f(Ho)n(we)n(v)o(er)g(in)h
(real)396 4157 y(cases)h(we)g(usually)e(need)h(to)g(allo)n(w)g
(multiple)g(services)g(as)h(well)g(as)g(multiple)e(clients.)h(This)h
(lets)g(us)f(scale)h(up)f(the)396 4265 y(po)n(wer)f(of)h(the)f(service)
h(\(man)o(y)e(threads)h(or)h(processes)f(or)h(nodes)f(rather)g(than)g
(just)h(one\).)f(The)g(only)g(constraint)g(is)i(that)396
4373 y(services)f(must)h(be)f(stateless,)h(all)g(state)g(being)e(in)h
(the)g(request)g(or)g(in)g(some)g(shared)g(storage)f(such)h(as)h(a)g
(database.)-2 4557 y
SDict begin H.S end
 -2 4557 a -2 4557 a
SDict begin 13 H.A end
 -2 4557 a -2
4557 a
SDict begin [/View [/XYZ H.V]/Dest (0:819) cvn /DEST pdfmark end
 -2 4557 a 396 4647 a Fj(There)f(are)g(tw)o(o)g(w)o(ays)h(to)f
(connect)f(multiple)h(clients)g(to)g(multiple)g(serv)o(ers.)f(The)h
(brute-force)e(w)o(ay)i(is)h(to)f(connect)396 4755 y(each)g(client)g
(sock)o(et)g(to)h(multiple)e(service)h(endpoints.)f(One)h(client)g
(sock)o(et)g(can)g(connect)f(to)h(multiple)g(service)396
4863 y(sock)o(ets,)g(and)g(the)g(REQ)h(sock)o(et)f(will)h(then)f
(load-balance)e(requests)h(among)g(these)i(services.)e(Let')-5
b(s)21 b(say)g(you)e(connect)396 4971 y(a)i(client)e(sock)o(et)h(to)g
(three)f(service)h(endpoints,)e(A,)i(B,)h(and)e(C.)h(The)g(client)g
(mak)o(es)f(requests)h(R1,)g(R2,)g(R3,)g(R4.)g(R1)g(and)396
5078 y(R4)h(go)f(to)g(service)g(A,)g(R2)h(goes)f(to)g(B,)h(and)f(R3)g
(goes)g(to)h(service)f(C\()p 0 TeXcolorgray 2389 5078
a
SDict begin H.S end
 2389 5078 a Fj(Figure)f(2-7)2738 5078 y
SDict begin 13 H.L end
 2738 5078 a
2738 5078 a
SDict begin [/Subtype /Link/Dest (0:figure-15) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2738 5078 a Black -1 w Fj(\).)-2 5096 y
SDict begin H.S end
 -2
5096 a -2 5096 a
SDict begin 13 H.A end
 -2 5096 a -2 5096 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-15) cvn /DEST pdfmark
end
 -2 5096 a Black
3798 5569 a Fi(46)p Black eop end
%%Page: 47 61
TeXDict begin 47 60 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.47) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-7.)f(Load-balancing)g
(of)h(Requests)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:823) cvn /DEST pdfmark end
 -2 172 a 396 3364 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3364 a @beginspecial 0
@llx -378 @lly 430 @urx 0 @ury 4300 @rwi @setspecial
%%BeginDocument: images/fig15.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -378 430 0
%%HiResBoundingBox: 0.0 -378.0 430.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -38.000301361083984 moveto
158.00030517578125 -92.00029754638672 lineto
278.00030517578125 -92.00029754638672 lineto
278.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -96.00029754638672 moveto
158.00030517578125 -115.00029754638672 lineto
158.00030517578125 -119.66696421305339 159.6669718424479 -122.00029754638672 163.00030517578125 -122.00029754638672 curveto
273.00030517578125 -122.00029754638672 lineto
273.00030517578125 -122.00029754638672 lineto
276.33363850911456 -122.00029754638672 278.00030517578125 -119.66696421305339 278.00030517578125 -115.00029754638672 curveto
278.00030517578125 -96.00029754638672 lineto
278.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -248.00030517578125 moveto
29.666966756184895 -248.00030517578125 28.00029945373535 -250.3336385091146 28.00029945373535 -255.00030517578125 curveto
28.00029945373535 -274.00030517578125 lineto
128.00030517578125 -274.00030517578125 lineto
128.00030517578125 -255.00030517578125 lineto
128.00030517578125 -250.3336385091146 126.33363596598308 -248.00030517578125 123.00029754638672 -248.00030517578125 curveto
33.000301361083984 -248.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -278.00030517578125 moveto
28.00029945373535 -346.00030517578125 lineto
128.00030517578125 -346.00030517578125 lineto
128.00030517578125 -278.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
173.00030517578125 -248.00030517578125 moveto
169.6669718424479 -248.00030517578125 168.00030517578125 -250.3336385091146 168.00030517578125 -255.00030517578125 curveto
168.00030517578125 -274.00030517578125 lineto
268.00030517578125 -274.00030517578125 lineto
268.00030517578125 -255.00030517578125 lineto
268.00030517578125 -250.3336385091146 266.33363850911456 -248.00030517578125 263.00030517578125 -248.00030517578125 curveto
173.00030517578125 -248.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -278.00030517578125 moveto
168.00030517578125 -346.00030517578125 lineto
268.00030517578125 -346.00030517578125 lineto
268.00030517578125 -278.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
313.00030517578125 -248.00030517578125 moveto
309.66697184244794 -248.00030517578125 308.00030517578125 -250.3336385091146 308.00030517578125 -255.00030517578125 curveto
308.00030517578125 -274.00030517578125 lineto
408.00030517578125 -274.00030517578125 lineto
408.00030517578125 -255.00030517578125 lineto
408.00030517578125 -250.3336385091146 406.33363850911456 -248.00030517578125 403.00030517578125 -248.00030517578125 curveto
313.00030517578125 -248.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -278.00030517578125 moveto
308.00030517578125 -346.00030517578125 lineto
408.00030517578125 -346.00030517578125 lineto
408.00030517578125 -278.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -35.0 moveto
155.0 -89.0 lineto
275.0 -89.0 lineto
275.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
155.0 -35.0 moveto
155.0 -89.0 lineto
275.0 -89.0 lineto
275.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -93.0 moveto
155.0 -112.0 lineto
155.0 -116.66666666666667 156.66666666666666 -119.0 160.0 -119.0 curveto
270.0 -119.0 lineto
270.0 -119.0 lineto
273.3333333333333 -119.0 275.0 -116.66666666666667 275.0 -112.0 curveto
275.0 -93.0 lineto
275.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -93.0 moveto
155.0 -112.0 lineto
155.0 -116.66666666666667 156.66666666666666 -119.0 160.0 -119.0 curveto
270.0 -119.0 lineto
270.0 -119.0 lineto
273.3333333333333 -119.0 275.0 -116.66666666666667 275.0 -112.0 curveto
275.0 -93.0 lineto
275.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -245.0 moveto
26.666666666666668 -245.0 25.0 -247.33333333333334 25.0 -252.0 curveto
25.0 -271.0 lineto
125.0 -271.0 lineto
125.0 -252.0 lineto
125.0 -247.33333333333334 123.33333333333333 -245.0 120.0 -245.0 curveto
30.0 -245.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -245.0 moveto
26.666666666666668 -245.0 25.0 -247.33333333333334 25.0 -252.0 curveto
25.0 -271.0 lineto
125.0 -271.0 lineto
125.0 -252.0 lineto
125.0 -247.33333333333334 123.33333333333333 -245.0 120.0 -245.0 curveto
30.0 -245.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -275.0 moveto
25.0 -343.0 lineto
125.0 -343.0 lineto
125.0 -275.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -275.0 moveto
25.0 -343.0 lineto
125.0 -343.0 lineto
125.0 -275.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
170.0 -245.0 moveto
166.66666666666666 -245.0 165.0 -247.33333333333334 165.0 -252.0 curveto
165.0 -271.0 lineto
265.0 -271.0 lineto
265.0 -252.0 lineto
265.0 -247.33333333333334 263.3333333333333 -245.0 260.0 -245.0 curveto
170.0 -245.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
170.0 -245.0 moveto
166.66666666666666 -245.0 165.0 -247.33333333333334 165.0 -252.0 curveto
165.0 -271.0 lineto
265.0 -271.0 lineto
265.0 -252.0 lineto
265.0 -247.33333333333334 263.3333333333333 -245.0 260.0 -245.0 curveto
170.0 -245.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -275.0 moveto
165.0 -343.0 lineto
265.0 -343.0 lineto
265.0 -275.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -275.0 moveto
165.0 -343.0 lineto
265.0 -343.0 lineto
265.0 -275.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
310.0 -245.0 moveto
306.6666666666667 -245.0 305.0 -247.33333333333334 305.0 -252.0 curveto
305.0 -271.0 lineto
405.0 -271.0 lineto
405.0 -252.0 lineto
405.0 -247.33333333333334 403.3333333333333 -245.0 400.0 -245.0 curveto
310.0 -245.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
310.0 -245.0 moveto
306.6666666666667 -245.0 305.0 -247.33333333333334 305.0 -252.0 curveto
305.0 -271.0 lineto
405.0 -271.0 lineto
405.0 -252.0 lineto
405.0 -247.33333333333334 403.3333333333333 -245.0 400.0 -245.0 curveto
310.0 -245.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -275.0 moveto
305.0 -343.0 lineto
405.0 -343.0 lineto
405.0 -275.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -275.0 moveto
305.0 -343.0 lineto
405.0 -343.0 lineto
405.0 -275.0 lineto
closepath
stroke
newpath
75.0 -210.0 moveto
75.0 -231.0 lineto
stroke
newpath
215.0 -119.0 moveto
215.0 -139.0 lineto
stroke
newpath
70.0 -224.0 moveto
75.0 -238.0 lineto
80.0 -224.0 lineto
closepath
fill
newpath
210.0 -224.0 moveto
215.0 -238.0 lineto
220.0 -224.0 lineto
closepath
fill
newpath
350.0 -224.0 moveto
355.0 -238.0 lineto
360.0 -224.0 lineto
closepath
fill
newpath
215.0 -161.0 moveto
215.0 -175.0 lineto
stroke
newpath
75.0 -189.0 moveto
75.0 -175.0 lineto
215.0 -175.0 lineto
stroke
newpath
215.0 -231.0 moveto
215.0 -175.0 lineto
stroke
newpath
355.0 -231.0 moveto
355.0 -175.0 lineto
215.0 -175.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
197.0 -68.0 moveto
(Client) show
200.0 -110.0 moveto
(REQ) show
162.0 -152.0 moveto
(R1, R2, R3, R4) show
44.0 -208.0 moveto
(R1, R4) show
210.0 -208.0 moveto
(R2) show
350.0 -208.0 moveto
(R3) show
61.0 -264.0 moveto
(REP) show
201.0 -264.0 moveto
(REP) show
341.0 -264.0 moveto
(REP) show
45.0 -306.0 moveto
(Service) show
72.0 -320.0 moveto
(A ) show
185.0 -306.0 moveto
(Service) show
212.0 -320.0 moveto
(B ) show
325.0 -306.0 moveto
(Service) show
352.0 -320.0 moveto
(C ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3364 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3364 a -2 3530 a
SDict begin H.S end
 -2 3530
a -2 3530 a
SDict begin 13 H.A end
 -2 3530 a -2 3530 a
SDict begin [/View [/XYZ H.V]/Dest (0:826) cvn /DEST pdfmark end
 -2 3530 a 396 3638 a
Fj(This)h(design)e(lets)i(you)f(add)f(more)h(clients)g(cheaply)-5
b(.)18 b(Y)-9 b(ou)20 b(can)g(also)g(add)g(more)f(services.)h(Each)g
(client)g(will)396 3746 y(load-balance)e(its)j(requests)f(to)h(the)f
(services.)g(But)g(each)g(client)g(has)h(to)f(kno)n(w)f(the)i(service)e
(topology)-5 b(.)18 b(If)i(you)f(ha)n(v)o(e)396 3854
y(100)h(clients)g(and)g(then)f(you)h(decide)f(to)i(add)e(three)h(more)f
(services,)h(you)f(need)h(to)g(recon\002gure)e(and)i(restart)g(100)396
3962 y(clients)h(in)f(order)f(for)h(the)g(clients)g(to)h(kno)n(w)e
(about)g(the)h(three)g(ne)n(w)g(services.)-2 4128 y
SDict begin H.S end
 -2
4128 a -2 4128 a
SDict begin 13 H.A end
 -2 4128 a -2 4128 a
SDict begin [/View [/XYZ H.V]/Dest (0:827) cvn /DEST pdfmark end
 -2 4128 a 396 4236
a Fj(That')-5 b(s)21 b(clearly)e(not)h(the)g(kind)g(of)g(thing)f(we)i
(w)o(ant)f(to)g(be)g(doing)f(at)i(3am)f(when)f(our)h(supercomputing)c
(cluster)k(has)h(run)396 4344 y(out)f(of)g(resources)f(and)h(we)g
(desperately)f(need)h(to)g(add)g(a)g(couple)f(of)h(hundred)e(ne)n(w)i
(service)g(nodes.)f(T)-7 b(oo)20 b(man)o(y)f(static)396
4451 y(pieces)h(are)h(lik)o(e)f(liquid)g(concrete:)f(kno)n(wledge)f(is)
j(distrib)n(uted)e(and)h(the)g(more)f(static)i(pieces)f(you)g(ha)n(v)o
(e,)f(the)h(more)396 4559 y(ef)n(fort)f(it)i(is)g(to)g(change)e(the)h
(topology)-5 b(.)17 b(What)k(we)f(w)o(ant)h(is)g(something)d(sitting)j
(in)f(between)g(clients)g(and)g(services)g(that)396 4667
y(centralizes)g(all)h(kno)n(wledge)d(of)i(the)g(topology)-5
b(.)17 b(Ideally)-5 b(,)19 b(we)h(should)g(be)g(able)g(to)g(add)g(and)f
(remo)o(v)o(e)g(services)h(or)396 4775 y(clients)h(at)f(an)o(y)g(time)g
(without)g(touching)e(an)o(y)h(other)h(part)g(of)g(the)g(topology)-5
b(.)-2 4959 y
SDict begin H.S end
 -2 4959 a -2 4959 a
SDict begin 13 H.A end
 -2 4959 a -2 4959 a
SDict begin [/View [/XYZ H.V]/Dest (0:828) cvn /DEST pdfmark end

-2 4959 a 396 5049 a Fj(So)21 b(we')o(ll)f(write)h(a)f(little)h
(message)f(queuing)e(brok)o(er)h(that)h(gi)n(v)o(es)g(us)h(this)f
(\003e)o(xibility)-5 b(.)19 b(The)h(brok)o(er)f(binds)g(to)i(tw)o(o)396
5157 y(endpoints,)e(a)h(frontend)e(for)i(clients)g(and)g(a)h(back)o
(end)d(for)i(services.)g(It)g(then)g(uses)2796 5157 y
SDict begin H.S end

2796 5157 a 2796 5157 a
SDict begin 13 H.A end
 2796 5157 a 2796 5157 a
SDict begin [/View [/XYZ H.V]/Dest (0:829) cvn /DEST pdfmark end
 2796
5157 a Fg(zmq-poll[3])e Fj(to)j(monitor)e(these)p Black
3797 5569 a Fi(47)p Black eop end
%%Page: 48 62
TeXDict begin 48 61 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.48) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:842) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(tw)o(o)21 b(sock)o(ets)f(for)g(acti)n
(vity)f(and)h(when)g(it)g(has)h(some,)f(it)h(shuttles)f(messages)g
(between)g(its)h(tw)o(o)f(sock)o(ets.)h(It)f(doesn')o(t)396
180 y(actually)g(manage)f(an)o(y)g(queues)h(e)o(xplicitly)f(--)h
(\330MQ)g(does)g(that)g(automatically)f(on)h(each)g(sock)o(et.)-2
364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:830) cvn /DEST pdfmark end
 -2 364 a 396
454 a Fj(When)g(you)f(use)h(REQ)g(to)g(talk)g(to)g(REP)h(you)e(get)h(a)
g(strictly)g(synchronous)d(request-reply)g(dialog.)i(The)h(client)f
(sends)h(a)396 562 y(request.)g(The)f(service)h(reads)g(the)g(request)g
(and)g(sends)g(a)g(reply)-5 b(.)19 b(The)h(client)g(then)g(reads)g(the)
g(reply)-5 b(.)19 b(If)h(either)g(the)396 670 y(client)g(or)g(the)h
(service)e(try)h(to)h(do)f(an)o(ything)e(else)j(\(e.g.)e(sending)g(tw)o
(o)h(requests)g(in)g(a)h(ro)n(w)f(without)f(w)o(aiting)h(for)g(a)396
778 y(response\))f(the)o(y)h(will)h(get)f(an)g(error)-5
b(.)-2 962 y
SDict begin H.S end
 -2 962 a -2 962 a
SDict begin 13 H.A end
 -2 962 a -2 962 a
SDict begin [/View [/XYZ H.V]/Dest (0:831) cvn /DEST pdfmark end
 -2 962
a 396 1052 a Fj(But)20 b(our)f(brok)o(er)f(has)h(to)h(be)f
(non-blocking.)d(Ob)o(viously)i(we)h(can)h(use)2447 1052
y
SDict begin H.S end
 2447 1052 a 2447 1052 a
SDict begin 13 H.A end
 2447 1052 a 2447 1052 a
SDict begin [/View [/XYZ H.V]/Dest (0:832) cvn /DEST pdfmark end
 2447
1052 a Fg(zmq-poll[3])f Fj(to)g(w)o(ait)h(for)f(acti)n(vity)g(on)g
(either)396 1160 y(sock)o(et,)h(b)n(ut)g(we)h(can')o(t)e(use)h(REP)h
(and)f(REQ.)-2 1341 y
SDict begin H.S end
 -2 1341 a -2 1341 a
SDict begin 13 H.A end
 -2 1341 a -2
1341 a
SDict begin [/View [/XYZ H.V]/Dest (0:833) cvn /DEST pdfmark end
 -2 1341 a 396 1434 a Fj(Luckily)f(there)h(are)g(tw)o(o)h(sock)o
(ets)f(called)g(DEALER)g(and)g(R)m(OUTER)g(that)h(let)f(you)g(do)f
(non-blocking)396 1542 y(request-response.)d(Y)-9 b(ou')o(ll)19
b(see)g(in)g(Adv)n(anced)e(Request-Reply)h(P)o(atterns)p
0 TeXcolorgray 2564 1542 a
SDict begin H.S end
 2564 1542 a Fj(Chapter)h(3)2889
1542 y
SDict begin 13 H.L end
 2889 1542 a 2889 1542 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2889 1542 a Black 19 w
Fj(ho)n(w)f(DEALER)h(and)f(R)m(OUTER)396 1650 y(sock)o(ets)j(let)f(you)
g(b)n(uild)f(all)i(kinds)f(of)g(asynchronous)d(request-reply)h(\003o)n
(ws.)i(F)o(or)g(no)n(w)-5 b(,)19 b(we')l(re)h(just)g(going)f(to)i(see)f
(ho)n(w)396 1758 y(DEALER)g(and)g(R)m(OUTER)h(let)f(us)h(e)o(xtend)e
(REQ-REP)i(across)f(an)g(intermediary)-5 b(,)17 b(that)j(is,)h(our)f
(little)h(brok)o(er)-5 b(.)-2 1942 y
SDict begin H.S end
 -2 1942 a -2 1942
a
SDict begin 13 H.A end
 -2 1942 a -2 1942 a
SDict begin [/View [/XYZ H.V]/Dest (0:835) cvn /DEST pdfmark end
 -2 1942 a 396 2032 a Fj(In)20 b(this)h(simple)f
(stretched)g(request-reply)d(pattern,)i(REQ)i(talks)g(to)f(R)m(OUTER)h
(and)e(DEALER)h(talks)h(to)f(REP)-9 b(.)21 b(In)396 2140
y(between)f(the)g(DEALER)g(and)g(R)m(OUTER)g(we)h(ha)n(v)o(e)e(to)i(ha)
n(v)o(e)e(code)h(\(lik)o(e)g(our)f(brok)o(er\))g(that)h(pulls)g
(messages)g(of)n(f)g(the)396 2248 y(one)g(sock)o(et)g(and)g(sho)o(v)o
(es)f(them)h(onto)f(the)h(other\()p 0 TeXcolorgray 1831
2248 a
SDict begin H.S end
 1831 2248 a Fj(Figure)e(2-8)2179 2248 y
SDict begin 13 H.L end
 2179 2248
a 2179 2248 a
SDict begin [/Subtype /Link/Dest (0:figure-16) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2179 2248 a Black -1 w Fj(\).)-2 2266 y
SDict begin H.S end

-2 2266 a -2 2266 a
SDict begin 13 H.A end
 -2 2266 a -2 2266 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-16) cvn /DEST pdfmark
end
 -2 2266 a Black
3800 5569 a Fi(48)p Black eop end
%%Page: 49 63
TeXDict begin 49 62 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.49) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-8.)f(Extended)h
(Request-r)o(eply)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:839) cvn /DEST pdfmark end
 -2 172 a 396 3364 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3364 a @beginspecial
0 @llx -378 @lly 430 @urx 0 @ury 4300 @rwi @setspecial
%%BeginDocument: images/fig16.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -378 430 0
%%HiResBoundingBox: 0.0 -378.0 430.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -59.000301361083984 lineto
28.00029945373535 -63.66696548461914 29.666966756184895 -66.00029754638672 33.000301361083984 -66.00029754638672 curveto
123.00029754638672 -66.00029754638672 lineto
123.00029754638672 -66.00029754638672 lineto
126.33363596598308 -66.00029754638672 128.00030517578125 -63.66696548461914 128.00030517578125 -59.000301361083984 curveto
128.00030517578125 -38.000301361083984 lineto
128.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -38.000301361083984 moveto
168.00030517578125 -59.000301361083984 lineto
168.00030517578125 -63.66696548461914 169.6669718424479 -66.00029754638672 173.00030517578125 -66.00029754638672 curveto
263.00030517578125 -66.00029754638672 lineto
263.00030517578125 -66.00029754638672 lineto
266.33363850911456 -66.00029754638672 268.00030517578125 -63.66696548461914 268.00030517578125 -59.000301361083984 curveto
268.00030517578125 -38.000301361083984 lineto
268.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -38.000301361083984 moveto
308.00030517578125 -59.000301361083984 lineto
308.00030517578125 -63.66696548461914 309.66697184244794 -66.00029754638672 313.00030517578125 -66.00029754638672 curveto
403.00030517578125 -66.00029754638672 lineto
403.00030517578125 -66.00029754638672 lineto
406.33363850911456 -66.00029754638672 408.00030517578125 -63.66696548461914 408.00030517578125 -59.000301361083984 curveto
408.00030517578125 -38.000301361083984 lineto
408.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.00030517578125 -150.00030517578125 moveto
159.6669718424479 -150.00030517578125 158.00030517578125 -152.3336385091146 158.00030517578125 -157.00030517578125 curveto
158.00030517578125 -176.00030517578125 lineto
278.00030517578125 -176.00030517578125 lineto
278.00030517578125 -157.00030517578125 lineto
278.00030517578125 -152.3336385091146 276.33363850911456 -150.00030517578125 273.00030517578125 -150.00030517578125 curveto
163.00030517578125 -150.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -180.00030517578125 moveto
158.00030517578125 -204.00030517578125 lineto
278.00030517578125 -204.00030517578125 lineto
278.00030517578125 -180.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -208.00030517578125 moveto
158.00030517578125 -227.00030517578125 lineto
158.00030517578125 -231.6669718424479 159.6669718424479 -234.00030517578125 163.00030517578125 -234.00030517578125 curveto
273.00030517578125 -234.00030517578125 lineto
273.00030517578125 -234.00030517578125 lineto
276.33363850911456 -234.00030517578125 278.00030517578125 -231.6669718424479 278.00030517578125 -227.00030517578125 curveto
278.00030517578125 -208.00030517578125 lineto
278.00030517578125 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -318.00030517578125 moveto
29.666966756184895 -318.00030517578125 28.00029945373535 -320.33363850911456 28.00029945373535 -325.00030517578125 curveto
28.00029945373535 -346.00030517578125 lineto
128.00030517578125 -346.00030517578125 lineto
128.00030517578125 -325.00030517578125 lineto
128.00030517578125 -320.33363850911456 126.33363596598308 -318.00030517578125 123.00029754638672 -318.00030517578125 curveto
33.000301361083984 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
173.00030517578125 -318.00030517578125 moveto
169.6669718424479 -318.00030517578125 168.00030517578125 -320.33363850911456 168.00030517578125 -325.00030517578125 curveto
168.00030517578125 -346.00030517578125 lineto
268.00030517578125 -346.00030517578125 lineto
268.00030517578125 -325.00030517578125 lineto
268.00030517578125 -320.33363850911456 266.33363850911456 -318.00030517578125 263.00030517578125 -318.00030517578125 curveto
173.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
313.00030517578125 -318.00030517578125 moveto
309.66697184244794 -318.00030517578125 308.00030517578125 -320.33363850911456 308.00030517578125 -325.00030517578125 curveto
308.00030517578125 -346.00030517578125 lineto
408.00030517578125 -346.00030517578125 lineto
408.00030517578125 -325.00030517578125 lineto
408.00030517578125 -320.33363850911456 406.33363850911456 -318.00030517578125 403.00030517578125 -318.00030517578125 curveto
313.00030517578125 -318.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -56.0 lineto
25.0 -60.666666666666664 26.666666666666668 -63.0 30.0 -63.0 curveto
120.0 -63.0 lineto
120.0 -63.0 lineto
123.33333333333333 -63.0 125.0 -60.666666666666664 125.0 -56.0 curveto
125.0 -35.0 lineto
125.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -56.0 lineto
25.0 -60.666666666666664 26.666666666666668 -63.0 30.0 -63.0 curveto
120.0 -63.0 lineto
120.0 -63.0 lineto
123.33333333333333 -63.0 125.0 -60.666666666666664 125.0 -56.0 curveto
125.0 -35.0 lineto
125.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -56.0 lineto
165.0 -60.666666666666664 166.66666666666666 -63.0 170.0 -63.0 curveto
260.0 -63.0 lineto
260.0 -63.0 lineto
263.3333333333333 -63.0 265.0 -60.666666666666664 265.0 -56.0 curveto
265.0 -35.0 lineto
265.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -56.0 lineto
165.0 -60.666666666666664 166.66666666666666 -63.0 170.0 -63.0 curveto
260.0 -63.0 lineto
260.0 -63.0 lineto
263.3333333333333 -63.0 265.0 -60.666666666666664 265.0 -56.0 curveto
265.0 -35.0 lineto
265.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -56.0 lineto
305.0 -60.666666666666664 306.6666666666667 -63.0 310.0 -63.0 curveto
400.0 -63.0 lineto
400.0 -63.0 lineto
403.3333333333333 -63.0 405.0 -60.666666666666664 405.0 -56.0 curveto
405.0 -35.0 lineto
405.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -56.0 lineto
305.0 -60.666666666666664 306.6666666666667 -63.0 310.0 -63.0 curveto
400.0 -63.0 lineto
400.0 -63.0 lineto
403.3333333333333 -63.0 405.0 -60.666666666666664 405.0 -56.0 curveto
405.0 -35.0 lineto
405.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -147.0 moveto
156.66666666666666 -147.0 155.0 -149.33333333333334 155.0 -154.0 curveto
155.0 -173.0 lineto
275.0 -173.0 lineto
275.0 -154.0 lineto
275.0 -149.33333333333334 273.3333333333333 -147.0 270.0 -147.0 curveto
160.0 -147.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -147.0 moveto
156.66666666666666 -147.0 155.0 -149.33333333333334 155.0 -154.0 curveto
155.0 -173.0 lineto
275.0 -173.0 lineto
275.0 -154.0 lineto
275.0 -149.33333333333334 273.3333333333333 -147.0 270.0 -147.0 curveto
160.0 -147.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -177.0 moveto
155.0 -201.0 lineto
275.0 -201.0 lineto
275.0 -177.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -177.0 moveto
155.0 -201.0 lineto
275.0 -201.0 lineto
275.0 -177.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -205.0 moveto
155.0 -224.0 lineto
155.0 -228.66666666666666 156.66666666666666 -231.0 160.0 -231.0 curveto
270.0 -231.0 lineto
270.0 -231.0 lineto
273.3333333333333 -231.0 275.0 -228.66666666666666 275.0 -224.0 curveto
275.0 -205.0 lineto
275.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -205.0 moveto
155.0 -224.0 lineto
155.0 -228.66666666666666 156.66666666666666 -231.0 160.0 -231.0 curveto
270.0 -231.0 lineto
270.0 -231.0 lineto
273.3333333333333 -231.0 275.0 -228.66666666666666 275.0 -224.0 curveto
275.0 -205.0 lineto
275.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -315.0 moveto
26.666666666666668 -315.0 25.0 -317.3333333333333 25.0 -322.0 curveto
25.0 -343.0 lineto
125.0 -343.0 lineto
125.0 -322.0 lineto
125.0 -317.3333333333333 123.33333333333333 -315.0 120.0 -315.0 curveto
30.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -315.0 moveto
26.666666666666668 -315.0 25.0 -317.3333333333333 25.0 -322.0 curveto
25.0 -343.0 lineto
125.0 -343.0 lineto
125.0 -322.0 lineto
125.0 -317.3333333333333 123.33333333333333 -315.0 120.0 -315.0 curveto
30.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
170.0 -315.0 moveto
166.66666666666666 -315.0 165.0 -317.3333333333333 165.0 -322.0 curveto
165.0 -343.0 lineto
265.0 -343.0 lineto
265.0 -322.0 lineto
265.0 -317.3333333333333 263.3333333333333 -315.0 260.0 -315.0 curveto
170.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
170.0 -315.0 moveto
166.66666666666666 -315.0 165.0 -317.3333333333333 165.0 -322.0 curveto
165.0 -343.0 lineto
265.0 -343.0 lineto
265.0 -322.0 lineto
265.0 -317.3333333333333 263.3333333333333 -315.0 260.0 -315.0 curveto
170.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
310.0 -315.0 moveto
306.6666666666667 -315.0 305.0 -317.3333333333333 305.0 -322.0 curveto
305.0 -343.0 lineto
405.0 -343.0 lineto
405.0 -322.0 lineto
405.0 -317.3333333333333 403.3333333333333 -315.0 400.0 -315.0 curveto
310.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
310.0 -315.0 moveto
306.6666666666667 -315.0 305.0 -317.3333333333333 305.0 -322.0 curveto
305.0 -343.0 lineto
405.0 -343.0 lineto
405.0 -322.0 lineto
405.0 -317.3333333333333 403.3333333333333 -315.0 400.0 -315.0 curveto
310.0 -315.0 lineto
closepath
stroke
newpath
75.0 -63.0 moveto
75.0 -105.0 lineto
215.0 -105.0 lineto
stroke
newpath
215.0 -63.0 moveto
215.0 -105.0 lineto
stroke
newpath
355.0 -63.0 moveto
355.0 -105.0 lineto
215.0 -105.0 lineto
stroke
newpath
215.0 -147.0 moveto
215.0 -105.0 lineto
stroke
newpath
215.0 -231.0 moveto
215.0 -273.0 lineto
stroke
newpath
75.0 -315.0 moveto
75.0 -273.0 lineto
215.0 -273.0 lineto
stroke
newpath
215.0 -315.0 moveto
215.0 -273.0 lineto
stroke
newpath
355.0 -315.0 moveto
355.0 -273.0 lineto
215.0 -273.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
60.0 -54.0 moveto
(REQ) show
200.0 -54.0 moveto
(REQ) show
340.0 -54.0 moveto
(REQ) show
181.0 -166.0 moveto
(ROUTER) show
191.0 -194.0 moveto
(code) show
181.0 -222.0 moveto
(DEALER) show
61.0 -334.0 moveto
(REP) show
201.0 -334.0 moveto
(REP) show
341.0 -334.0 moveto
(REP) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3364 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3364 a 274 x Fj(The)g(request-reply)e(brok)
o(er)h(binds)g(to)i(tw)o(o)f(endpoints,)e(one)i(for)g(clients)g(to)g
(connect)f(to)i(\(the)f(frontend)e(sock)o(et\))h(and)396
3746 y(one)h(for)f(w)o(ork)o(ers)h(to)g(connect)f(to)i(\(the)e(back)o
(end\).)f(T)-7 b(o)21 b(test)g(this)g(brok)o(er)m(,)d(you)h(will)i(w)o
(ant)f(to)g(change)f(your)g(w)o(ork)o(ers)h(so)396 3854
y(the)o(y)g(connect)f(to)h(the)g(back)o(end)f(sock)o(et.)h(Here)g(is)h
(a)f(client)h(that)f(sho)n(ws)g(what)g(I)h(mean:)-2 3872
y
SDict begin H.S end
 -2 3872 a -2 3872 a
SDict begin 13 H.A end
 -2 3872 a -2 3872 a
SDict begin [/View [/XYZ H.V]/Dest (0:rrclient-php) cvn /DEST pdfmark
end
 -2 3872 a 396
4055 a Fk(Example)g(2-3.)e(Request-r)o(eply)g(client)i(\(rr)o
(client.php\))-2 4155 y
SDict begin H.S end
 -2 4155 a -2 4155 a
SDict begin 11.7 H.A end
 -2 4155 a
-2 4155 a
SDict begin [/View [/XYZ H.V]/Dest (0:845) cvn /DEST pdfmark end
 -2 4155 a 396 4235 a Fg(<?php)396 4332 y(/)441
4345 y(*)441 4442 y(*)531 4429 y(Hello)44 b(World)g(client)441
4540 y(*)531 4527 y(Connects)f(REQ)i(socket)e(to)i
(tcp://localhost:5559)441 4637 y(*)531 4624 y(Sends)f("Hello")f(to)i
(server,)f(expects)f("World")h(back)441 4734 y(*)531
4721 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4831 y(*)486
4818 y(/)396 5012 y($context)g(=)g(new)h(ZMQContext\(\);)p
Black 3800 5569 a Fi(49)p Black eop end
%%Page: 50 64
TeXDict begin 50 63 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.50) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fg(//)90 b(Socket)43 b(to)i(talk)f(to)h
(server)396 170 y($requester)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REQ\);)396 267 y
($requester->connect\("tcp://localhost:5559)o("\);)396
461 y(for\($request_nbr)g(=)j(0;)g($request_nbr)d(<)j(10;)f
($request_nbr++\))f({)441 558 y($requester->send\("Hello"\);)441
655 y($string)h(=)g($requester->recv\(\);)441 752 y(printf)g
(\("Received)f(reply)h(\045d)h([\045s]\045s",)e($request_nbr,)g
($string,)g(PHP_EOL\);)-2 930 y
SDict begin H.S end
 -2 930 a -2 930 a
SDict begin 13 H.A end
 -2
930 a -2 930 a
SDict begin [/View [/XYZ H.V]/Dest (0:846) cvn /DEST pdfmark end
 -2 930 a 396 1026 a Fj(Here)20 b(is)h(the)g(w)o(ork)o
(er:)-2 1027 y
SDict begin H.S end
 -2 1027 a -2 1027 a
SDict begin 13 H.A end
 -2 1027 a -2 1027
a
SDict begin [/View [/XYZ H.V]/Dest (0:rrworker-php) cvn /DEST pdfmark
end
 -2 1027 a 396 1228 a Fk(Example)g(2-4.)e(Request-r)o(eply)g(w)o(ork)o
(er)h(\(rrw)o(ork)o(er)-8 b(.php\))-2 1328 y
SDict begin H.S end
 -2 1328
a -2 1328 a
SDict begin 11.7 H.A end
 -2 1328 a -2 1328 a
SDict begin [/View [/XYZ H.V]/Dest (0:849) cvn /DEST pdfmark end
 -2 1328 a 396 1408 a
Fg(<?php)396 1505 y(/)441 1518 y(*)441 1615 y(*)531 1602
y(Hello)44 b(World)g(server)441 1712 y(*)531 1699 y(Connects)f(REP)i
(socket)e(to)i(tcp://)1832 1712 y(*)1877 1699 y(:5560)441
1809 y(*)531 1796 y(Expects)e("Hello")h(from)g(client,)g(replies)g
(with)g("World")441 1907 y(*)531 1894 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 2004 y(*)486
1991 y(/)396 2185 y($context)g(=)g(new)h(ZMQContext\(\);)396
2379 y(//)90 b(Socket)43 b(to)i(talk)f(to)h(clients)396
2476 y($responder)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REP\);)396 2574 y
($responder->connect\("tcp://localhost:5560)o("\);)396
2768 y(while\(true\))h({)441 2865 y(//)89 b(Wait)45 b(for)f(next)g
(request)g(from)g(client)441 2962 y($string)g(=)g
($responder->recv\(\);)441 3059 y(printf)g(\("Received)f(request:)h
([\045s]\045s",)f($string,)h(PHP_EOL\);)441 3253 y(//)h(Do)f(some)g
('work')441 3351 y(sleep\(1\);)441 3545 y(//)89 b(Send)45
b(reply)f(back)g(to)g(client)441 3642 y($responder->send\("World"\);)
396 3739 y(})-2 3913 y
SDict begin H.S end
 -2 3913 a -2 3913 a
SDict begin 13 H.A end
 -2 3913 a
-2 3913 a
SDict begin [/View [/XYZ H.V]/Dest (0:850) cvn /DEST pdfmark end
 -2 3913 a 396 4013 a Fj(And)20 b(here)g(is)h(the)f(brok)o(er)
m(,)e(which)i(properly)e(handles)h(multi-part)g(messages:)-2
4031 y
SDict begin H.S end
 -2 4031 a -2 4031 a
SDict begin 13 H.A end
 -2 4031 a -2 4031 a
SDict begin [/View [/XYZ H.V]/Dest (0:rrbroker-php) cvn /DEST pdfmark
end
 -2 4031
a 396 4214 a Fk(Example)i(2-5.)e(Request-r)o(eply)g(br)o(ok)o(er)h
(\(rrbr)o(ok)o(er)-8 b(.php\))-2 4314 y
SDict begin H.S end
 -2 4314 a -2
4314 a
SDict begin 11.7 H.A end
 -2 4314 a -2 4314 a
SDict begin [/View [/XYZ H.V]/Dest (0:853) cvn /DEST pdfmark end
 -2 4314 a 396 4395 a Fg(<?php)396
4492 y(/)441 4505 y(*)441 4602 y(*)531 4589 y(Simple)44
b(request-reply)e(broker)441 4699 y(*)531 4686 y(@author)h(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
4796 y(*)486 4783 y(/)396 4977 y(//)90 b(Prepare)43 b(our)i(context)e
(and)i(sockets)396 5075 y($context)f(=)g(new)h(ZMQContext\(\);)p
Black 3800 5569 a Fi(50)p Black eop end
%%Page: 51 65
TeXDict begin 51 64 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.51) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:861) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fg($frontend)44 b(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)396 170
y($backend)j(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_DEALER\);)396
267 y($frontend->bind\("tcp://)1431 280 y(*)1476 267
y(:5559"\);)396 364 y($backend->bind\("tcp://)1386 377
y(*)1431 364 y(:5560"\);)396 558 y(//)90 b(Initialize)43
b(poll)h(set)396 655 y($poll)g(=)h(new)f(ZMQPoll\(\);)396
752 y($poll->add\($frontend,)e(ZMQ::POLL_IN\);)396 850
y($poll->add\($backend,)g(ZMQ::POLL_IN\);)396 947 y($readable)i(=)g
($writeable)f(=)i(array\(\);)396 1141 y(//)90 b(Switch)43
b(messages)h(between)g(sockets)396 1238 y(while\(true\))f({)441
1335 y($events)h(=)g($poll->poll\($readable,)e($writeable\);)441
1530 y(foreach\($readable)g(as)j($socket\))e({)486 1627
y(if\($socket)g(===)h($frontend\))g({)531 1724 y(//)89
b(Process)44 b(all)g(parts)g(of)h(the)f(message)531 1821
y(while\(true\))f({)576 1918 y($message)g(=)i($socket->recv\(\);)576
2015 y(//)89 b(Multipart)43 b(detection)576 2112 y($more)h(=)g
($socket->getSockOpt\(ZMQ::SOCKOPT_RCVMORE\))o(;)576
2209 y($backend->send\($message,)c($more)k(?)h(ZMQ::MODE_SNDMORE)d(:)j
(null\);)576 2307 y(if\(!$more\))e({)620 2404 y(break;)h(//)90
b(Last)44 b(message)f(part)576 2501 y(})531 2598 y(})486
2695 y(})486 2792 y(else)h(if\($socket)f(===)i($backend\))e({)531
2889 y($message)g(=)i($socket->recv\(\);)531 2987 y(//)89
b(Multipart)43 b(detection)531 3084 y($more)h(=)g
($socket->getSockOpt\(ZMQ::SOCKOPT_RCVMORE\);)531 3181
y($frontend->send\($message,)c($more)k(?)h(ZMQ::MODE_SNDMORE)d(:)j
(null\);)531 3278 y(if\(!$more\))e({)576 3375 y(break;)g(//)90
b(Last)44 b(message)g(part)531 3472 y(})486 3569 y(})441
3666 y(})-2 3841 y
SDict begin H.S end
 -2 3841 a -2 3841 a
SDict begin 13 H.A end
 -2 3841 a -2 3841
a
SDict begin [/View [/XYZ H.V]/Dest (0:854) cvn /DEST pdfmark end
 -2 3841 a 396 3940 a Fj(Using)20 b(a)h(request-reply)d(brok)o(er)g
(mak)o(es)i(your)f(client-serv)o(er)g(architectures)g(easier)h(to)g
(scale)h(since)f(clients)h(don')o(t)e(see)396 4048 y(w)o(ork)o(ers,)h
(and)f(w)o(ork)o(ers)h(don')o(t)e(see)j(clients.)f(The)g(only)f(static)
i(node)f(is)h(the)f(brok)o(er)f(in)h(the)g(middle\()p
0 TeXcolorgray 3309 4048 a
SDict begin H.S end
 3309 4048 a Fj(Figure)e(2-9)3657
4048 y
SDict begin 13 H.L end
 3657 4048 a 3657 4048 a
SDict begin [/Subtype /Link/Dest (0:figure-17) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3657 4048 a Black -1 w
Fj(\).)-2 4066 y
SDict begin H.S end
 -2 4066 a -2 4066 a
SDict begin 13 H.A end
 -2 4066 a -2 4066
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-17) cvn /DEST pdfmark
end
 -2 4066 a Black 3800 5569 a Fi(51)p Black eop end
%%Page: 52 66
TeXDict begin 52 65 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.52) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-9.)f(Request-r)o(eply)g
(Br)o(ok)o(er)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:858) cvn /DEST pdfmark end
 -2 172 a 396 5931 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 5931 a @beginspecial 0
@llx -686 @lly 430 @urx 0 @ury 4300 @rwi @setspecial
%%BeginDocument: images/fig17.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -686 430 0
%%HiResBoundingBox: 0.0 -686.0 430.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -92.00029754638672 lineto
128.00030517578125 -92.00029754638672 lineto
128.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -96.00029754638672 moveto
28.00029945373535 -115.00029754638672 lineto
28.00029945373535 -119.66696421305339 29.666966756184895 -122.00029754638672 33.000301361083984 -122.00029754638672 curveto
123.00029754638672 -122.00029754638672 lineto
123.00029754638672 -122.00029754638672 lineto
126.33363596598308 -122.00029754638672 128.00030517578125 -119.66696421305339 128.00030517578125 -115.00029754638672 curveto
128.00030517578125 -96.00029754638672 lineto
128.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -38.000301361083984 moveto
168.00030517578125 -92.00029754638672 lineto
268.00030517578125 -92.00029754638672 lineto
268.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -96.00029754638672 moveto
168.00030517578125 -115.00029754638672 lineto
168.00030517578125 -119.66696421305339 169.6669718424479 -122.00029754638672 173.00030517578125 -122.00029754638672 curveto
263.00030517578125 -122.00029754638672 lineto
263.00030517578125 -122.00029754638672 lineto
266.33363850911456 -122.00029754638672 268.00030517578125 -119.66696421305339 268.00030517578125 -115.00029754638672 curveto
268.00030517578125 -96.00029754638672 lineto
268.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -38.000301361083984 moveto
308.00030517578125 -92.00029754638672 lineto
408.00030517578125 -92.00029754638672 lineto
408.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -96.00029754638672 moveto
308.00030517578125 -115.00029754638672 lineto
308.00030517578125 -119.66696421305339 309.66697184244794 -122.00029754638672 313.00030517578125 -122.00029754638672 curveto
403.00030517578125 -122.00029754638672 lineto
403.00030517578125 -122.00029754638672 lineto
406.33363850911456 -122.00029754638672 408.00030517578125 -119.66696421305339 408.00030517578125 -115.00029754638672 curveto
408.00030517578125 -96.00029754638672 lineto
408.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.00030517578125 -290.00030517578125 moveto
159.6669718424479 -290.00030517578125 158.00030517578125 -292.33363850911456 158.00030517578125 -297.00030517578125 curveto
158.00030517578125 -316.00030517578125 lineto
278.00030517578125 -316.00030517578125 lineto
278.00030517578125 -297.00030517578125 lineto
278.00030517578125 -292.33363850911456 276.33363850911456 -290.00030517578125 273.00030517578125 -290.00030517578125 curveto
163.00030517578125 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -320.00030517578125 moveto
158.00030517578125 -372.00030517578125 lineto
278.00030517578125 -372.00030517578125 lineto
278.00030517578125 -320.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.00030517578125 -376.00030517578125 moveto
158.00030517578125 -395.00030517578125 lineto
158.00030517578125 -399.66697184244794 159.6669718424479 -402.00030517578125 163.00030517578125 -402.00030517578125 curveto
273.00030517578125 -402.00030517578125 lineto
273.00030517578125 -402.00030517578125 lineto
276.33363850911456 -402.00030517578125 278.00030517578125 -399.66697184244794 278.00030517578125 -395.00030517578125 curveto
278.00030517578125 -376.00030517578125 lineto
278.00030517578125 -376.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -556.0003051757812 moveto
29.666966756184895 -556.0003051757812 28.00029945373535 -558.3336385091146 28.00029945373535 -563.0003051757812 curveto
28.00029945373535 -582.0003051757812 lineto
128.00030517578125 -582.0003051757812 lineto
128.00030517578125 -563.0003051757812 lineto
128.00030517578125 -558.3336385091146 126.33363596598308 -556.0003051757812 123.00029754638672 -556.0003051757812 curveto
33.000301361083984 -556.0003051757812 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -586.0003051757812 moveto
28.00029945373535 -654.0003051757812 lineto
128.00030517578125 -654.0003051757812 lineto
128.00030517578125 -586.0003051757812 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
173.00030517578125 -556.0003051757812 moveto
169.6669718424479 -556.0003051757812 168.00030517578125 -558.3336385091146 168.00030517578125 -563.0003051757812 curveto
168.00030517578125 -582.0003051757812 lineto
268.00030517578125 -582.0003051757812 lineto
268.00030517578125 -563.0003051757812 lineto
268.00030517578125 -558.3336385091146 266.33363850911456 -556.0003051757812 263.00030517578125 -556.0003051757812 curveto
173.00030517578125 -556.0003051757812 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.00030517578125 -586.0003051757812 moveto
168.00030517578125 -654.0003051757812 lineto
268.00030517578125 -654.0003051757812 lineto
268.00030517578125 -586.0003051757812 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
313.00030517578125 -556.0003051757812 moveto
309.66697184244794 -556.0003051757812 308.00030517578125 -558.3336385091146 308.00030517578125 -563.0003051757812 curveto
308.00030517578125 -582.0003051757812 lineto
408.00030517578125 -582.0003051757812 lineto
408.00030517578125 -563.0003051757812 lineto
408.00030517578125 -558.3336385091146 406.33363850911456 -556.0003051757812 403.00030517578125 -556.0003051757812 curveto
313.00030517578125 -556.0003051757812 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
308.00030517578125 -586.0003051757812 moveto
308.00030517578125 -654.0003051757812 lineto
408.00030517578125 -654.0003051757812 lineto
408.00030517578125 -586.0003051757812 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
125.0 -89.0 lineto
125.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
125.0 -89.0 lineto
125.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
120.0 -119.0 lineto
120.0 -119.0 lineto
123.33333333333333 -119.0 125.0 -116.66666666666667 125.0 -112.0 curveto
125.0 -93.0 lineto
125.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
120.0 -119.0 lineto
120.0 -119.0 lineto
123.33333333333333 -119.0 125.0 -116.66666666666667 125.0 -112.0 curveto
125.0 -93.0 lineto
125.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -89.0 lineto
265.0 -89.0 lineto
265.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -35.0 moveto
165.0 -89.0 lineto
265.0 -89.0 lineto
265.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -93.0 moveto
165.0 -112.0 lineto
165.0 -116.66666666666667 166.66666666666666 -119.0 170.0 -119.0 curveto
260.0 -119.0 lineto
260.0 -119.0 lineto
263.3333333333333 -119.0 265.0 -116.66666666666667 265.0 -112.0 curveto
265.0 -93.0 lineto
265.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -93.0 moveto
165.0 -112.0 lineto
165.0 -116.66666666666667 166.66666666666666 -119.0 170.0 -119.0 curveto
260.0 -119.0 lineto
260.0 -119.0 lineto
263.3333333333333 -119.0 265.0 -116.66666666666667 265.0 -112.0 curveto
265.0 -93.0 lineto
265.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -89.0 lineto
405.0 -89.0 lineto
405.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -35.0 moveto
305.0 -89.0 lineto
405.0 -89.0 lineto
405.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -93.0 moveto
305.0 -112.0 lineto
305.0 -116.66666666666667 306.6666666666667 -119.0 310.0 -119.0 curveto
400.0 -119.0 lineto
400.0 -119.0 lineto
403.3333333333333 -119.0 405.0 -116.66666666666667 405.0 -112.0 curveto
405.0 -93.0 lineto
405.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -93.0 moveto
305.0 -112.0 lineto
305.0 -116.66666666666667 306.6666666666667 -119.0 310.0 -119.0 curveto
400.0 -119.0 lineto
400.0 -119.0 lineto
403.3333333333333 -119.0 405.0 -116.66666666666667 405.0 -112.0 curveto
405.0 -93.0 lineto
405.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -287.0 moveto
156.66666666666666 -287.0 155.0 -289.3333333333333 155.0 -294.0 curveto
155.0 -313.0 lineto
275.0 -313.0 lineto
275.0 -294.0 lineto
275.0 -289.3333333333333 273.3333333333333 -287.0 270.0 -287.0 curveto
160.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -287.0 moveto
156.66666666666666 -287.0 155.0 -289.3333333333333 155.0 -294.0 curveto
155.0 -313.0 lineto
275.0 -313.0 lineto
275.0 -294.0 lineto
275.0 -289.3333333333333 273.3333333333333 -287.0 270.0 -287.0 curveto
160.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -317.0 moveto
155.0 -369.0 lineto
275.0 -369.0 lineto
275.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -317.0 moveto
155.0 -369.0 lineto
275.0 -369.0 lineto
275.0 -317.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
155.0 -373.0 moveto
155.0 -392.0 lineto
155.0 -396.6666666666667 156.66666666666666 -399.0 160.0 -399.0 curveto
270.0 -399.0 lineto
270.0 -399.0 lineto
273.3333333333333 -399.0 275.0 -396.6666666666667 275.0 -392.0 curveto
275.0 -373.0 lineto
275.0 -373.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
155.0 -373.0 moveto
155.0 -392.0 lineto
155.0 -396.6666666666667 156.66666666666666 -399.0 160.0 -399.0 curveto
270.0 -399.0 lineto
270.0 -399.0 lineto
273.3333333333333 -399.0 275.0 -396.6666666666667 275.0 -392.0 curveto
275.0 -373.0 lineto
275.0 -373.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -553.0 moveto
26.666666666666668 -553.0 25.0 -555.3333333333334 25.0 -560.0 curveto
25.0 -579.0 lineto
125.0 -579.0 lineto
125.0 -560.0 lineto
125.0 -555.3333333333334 123.33333333333333 -553.0 120.0 -553.0 curveto
30.0 -553.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -553.0 moveto
26.666666666666668 -553.0 25.0 -555.3333333333334 25.0 -560.0 curveto
25.0 -579.0 lineto
125.0 -579.0 lineto
125.0 -560.0 lineto
125.0 -555.3333333333334 123.33333333333333 -553.0 120.0 -553.0 curveto
30.0 -553.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -583.0 moveto
25.0 -651.0 lineto
125.0 -651.0 lineto
125.0 -583.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -583.0 moveto
25.0 -651.0 lineto
125.0 -651.0 lineto
125.0 -583.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
170.0 -553.0 moveto
166.66666666666666 -553.0 165.0 -555.3333333333334 165.0 -560.0 curveto
165.0 -579.0 lineto
265.0 -579.0 lineto
265.0 -560.0 lineto
265.0 -555.3333333333334 263.3333333333333 -553.0 260.0 -553.0 curveto
170.0 -553.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
170.0 -553.0 moveto
166.66666666666666 -553.0 165.0 -555.3333333333334 165.0 -560.0 curveto
165.0 -579.0 lineto
265.0 -579.0 lineto
265.0 -560.0 lineto
265.0 -555.3333333333334 263.3333333333333 -553.0 260.0 -553.0 curveto
170.0 -553.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
165.0 -583.0 moveto
165.0 -651.0 lineto
265.0 -651.0 lineto
265.0 -583.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
165.0 -583.0 moveto
165.0 -651.0 lineto
265.0 -651.0 lineto
265.0 -583.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
310.0 -553.0 moveto
306.6666666666667 -553.0 305.0 -555.3333333333334 305.0 -560.0 curveto
305.0 -579.0 lineto
405.0 -579.0 lineto
405.0 -560.0 lineto
405.0 -555.3333333333334 403.3333333333333 -553.0 400.0 -553.0 curveto
310.0 -553.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
310.0 -553.0 moveto
306.6666666666667 -553.0 305.0 -555.3333333333334 305.0 -560.0 curveto
305.0 -579.0 lineto
405.0 -579.0 lineto
405.0 -560.0 lineto
405.0 -555.3333333333334 403.3333333333333 -553.0 400.0 -553.0 curveto
310.0 -553.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
305.0 -583.0 moveto
305.0 -651.0 lineto
405.0 -651.0 lineto
405.0 -583.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
305.0 -583.0 moveto
305.0 -651.0 lineto
405.0 -651.0 lineto
405.0 -583.0 lineto
closepath
stroke
newpath
190.0 -231.0 moveto
199.0 -231.0 lineto
stroke
newpath
210.0 -252.0 moveto
215.0 -266.0 lineto
220.0 -252.0 lineto
closepath
fill
newpath
70.0 -518.0 moveto
75.0 -532.0 lineto
80.0 -518.0 lineto
closepath
fill
newpath
210.0 -518.0 moveto
215.0 -532.0 lineto
220.0 -518.0 lineto
closepath
fill
newpath
350.0 -518.0 moveto
355.0 -532.0 lineto
360.0 -518.0 lineto
closepath
fill
newpath
75.0 -147.0 moveto
75.0 -203.0 lineto
215.0 -203.0 lineto
stroke
newpath
215.0 -147.0 moveto
215.0 -203.0 lineto
stroke
newpath
355.0 -147.0 moveto
355.0 -203.0 lineto
215.0 -203.0 lineto
stroke
newpath
215.0 -259.0 moveto
215.0 -203.0 lineto
stroke
newpath
215.0 -427.0 moveto
215.0 -469.0 lineto
stroke
newpath
75.0 -525.0 moveto
75.0 -469.0 lineto
215.0 -469.0 lineto
stroke
newpath
215.0 -525.0 moveto
215.0 -469.0 lineto
stroke
newpath
355.0 -525.0 moveto
355.0 -469.0 lineto
215.0 -469.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
47.0 -68.0 moveto
(Client) show
187.0 -68.0 moveto
(Client) show
327.0 -68.0 moveto
(Client) show
60.0 -110.0 moveto
(REQ) show
200.0 -110.0 moveto
(REQ) show
340.0 -110.0 moveto
(REQ) show
43.0 -138.0 moveto
(connect) show
183.0 -138.0 moveto
(connect) show
323.0 -138.0 moveto
(connect) show
44.0 -180.0 moveto
(request) show
184.0 -180.0 moveto
(request) show
324.0 -180.0 moveto
(request) show
162.0 -236.0 moveto
(fair queuing) show
193.0 -278.0 moveto
(bind) show
181.0 -306.0 moveto
(ROUTER) show
193.0 -348.0 moveto
(Broker) show
181.0 -390.0 moveto
(DEALER) show
193.0 -418.0 moveto
(bind) show
152.0 -446.0 moveto
(load balancing) show
44.0 -502.0 moveto
(request) show
184.0 -502.0 moveto
(request) show
324.0 -502.0 moveto
(request) show
43.0 -544.0 moveto
(connect) show
183.0 -544.0 moveto
(connect) show
323.0 -544.0 moveto
(connect) show
61.0 -572.0 moveto
(REP) show
201.0 -572.0 moveto
(REP) show
341.0 -572.0 moveto
(REP) show
45.0 -614.0 moveto
(Service) show
72.0 -628.0 moveto
(A ) show
185.0 -614.0 moveto
(Service) show
212.0 -628.0 moveto
(B ) show
325.0 -614.0 moveto
(Service) show
352.0 -628.0 moveto
(C ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 5931 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 5931 a Black 3800 5569 a
Fi(52)p Black eop end
%%Page: 53 67
TeXDict begin 53 66 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.53) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:861) cvn /DEST pdfmark end
 -2 -11 a 396 80 a Fd(2.2.8.)36 b(\330MQ')-7
b(s)33 b(Built-in)h(Pr)n(o)l(xy)f(Function)2448 80 y
SDict begin H.S end

2448 80 a 2448 80 a
SDict begin 18.72 H.A end
 2448 80 a 2448 80 a
SDict begin [/View [/XYZ H.V]/Dest (7.20.15.2) cvn /DEST pdfmark end
 2448 80 a -2
270 a
SDict begin H.S end
 -2 270 a -2 270 a
SDict begin 13 H.A end
 -2 270 a -2 270 a
SDict begin [/View [/XYZ H.V]/Dest (0:863) cvn /DEST pdfmark end
 -2 270 a 396
354 a Fj(It)21 b(turns)f(out)f(that)i(the)f(core)g(loop)f(in)h(the)g
(pre)n(vious)f(section')-5 b(s)20 b(rrbrok)o(er)e(is)j(v)o(ery)e
(useful,)h(and)g(reusable.)f(It)h(lets)h(us)396 462 y(b)n(uild)f
(pub-sub)e(forw)o(arders)h(and)g(shared)h(queues)f(and)h(other)f
(little)i(intermediaries,)e(with)h(v)o(ery)f(little)i(ef)n(fort.)e
(\330MQ)396 569 y(wraps)h(this)h(up)f(in)g(a)h(single)f(method,)1512
569 y
SDict begin H.S end
 1512 569 a 1512 569 a
SDict begin 13 H.A end
 1512 569 a 1512 569 a
SDict begin [/View [/XYZ H.V]/Dest (0:864) cvn /DEST pdfmark end
 1512
569 a Fg(zmq-proxy[3])p Fj(:)-2 670 y
SDict begin H.S end
 -2 670 a -2 670
a
SDict begin 11.7 H.A end
 -2 670 a -2 670 a
SDict begin [/View [/XYZ H.V]/Dest (0:865) cvn /DEST pdfmark end
 -2 670 a 396 750 a Fg(zmq-proxy)44
b(\(frontend,)f(backend,)g(capture\);)-2 927 y
SDict begin H.S end
 -2 927
a -2 927 a
SDict begin 13 H.A end
 -2 927 a -2 927 a
SDict begin [/View [/XYZ H.V]/Dest (0:866) cvn /DEST pdfmark end
 -2 927 a 396 1024 a Fj(The)20
b(tw)o(o)h(\(or)e(three)h(sock)o(ets,)g(if)g(we)h(w)o(ant)f(to)h
(capture)e(data\))g(must)i(be)f(properly)e(connected,)g(bound,)g
(con\002gured.)396 1132 y(When)i(we)h(call)f(the)996
1132 y
SDict begin H.S end
 996 1132 a 996 1132 a
SDict begin 13 H.A end
 996 1132 a 996 1132 a
SDict begin [/View [/XYZ H.V]/Dest (0:867) cvn /DEST pdfmark end
 996
1132 a Fg(zmq-proxy)f Fj(method)g(it')-5 b(s)21 b(e)o(xactly)e(lik)o(e)
i(starting)f(the)g(main)g(loop)f(of)h(rrbrok)o(er)-5
b(.)18 b(Let')-5 b(s)21 b(re)n(write)396 1239 y(the)f(request-reply)e
(brok)o(er)h(to)h(call)1440 1239 y
SDict begin H.S end
 1440 1239 a 1440 1239
a
SDict begin 13 H.A end
 1440 1239 a 1440 1239 a
SDict begin [/View [/XYZ H.V]/Dest (0:868) cvn /DEST pdfmark end
 1440 1239 a Fg(zmq-proxy)p
Fj(,)f(and)g(re-badge)g(this)h(as)h(an)f(e)o(xpensi)n(v)o(e-sounding)c
("message)396 1347 y(queue")j(\(people)g(ha)n(v)o(e)g(char)o(ged)g
(houses)g(for)h(code)f(that)i(did)e(less\):)-2 1365 y
SDict begin H.S end

-2 1365 a -2 1365 a
SDict begin 13 H.A end
 -2 1365 a -2 1365 a
SDict begin [/View [/XYZ H.V]/Dest (0:msgqueue-php) cvn /DEST pdfmark
end
 -2 1365 a 396
1549 a Fk(Example)i(2-6.)e(Message)h(queue)h(br)o(ok)o(er)f
(\(msgqueue.php\))-2 1649 y
SDict begin H.S end
 -2 1649 a -2 1649 a
SDict begin 11.7 H.A end
 -2 1649
a -2 1649 a
SDict begin [/View [/XYZ H.V]/Dest (0:871) cvn /DEST pdfmark end
 -2 1649 a 396 1729 a Fg(<?php)396 1923 y(/)441
1936 y(*)441 2033 y(*)576 2020 y(Simple)43 b(message)h(queuing)g
(broker)441 2130 y(*)576 2117 y(Same)g(as)g(request-reply)f(broker)h
(but)g(using)g(QUEUE)g(device)441 2228 y(*)531 2215 y(@author)f(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
2325 y(*)486 2312 y(/)396 2506 y($context)g(=)g(new)h(ZMQContext\(\);)
396 2700 y(//)90 b(Socket)43 b(facing)h(clients)396 2797
y($frontend)g(=)g($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396
2895 y($frontend->bind\("tcp://)1431 2908 y(*)1476 2895
y(:5559"\);)396 3089 y(//)90 b(Socket)43 b(facing)h(services)396
3186 y($backend)g(=)g($context->getSocket\(ZMQ::SOCKET_DEALER\);)396
3283 y($backend->bind\("tcp://)1386 3296 y(*)1431 3283
y(:5560"\);)396 3477 y(//)90 b(Start)44 b(built-in)f(device)396
3574 y(new)i(ZMQDevice\($frontend,)c($backend\);)396
3769 y(//)90 b(We)44 b(never)g(get)g(here...)-2 3946
y
SDict begin H.S end
 -2 3946 a -2 3946 a
SDict begin 13 H.A end
 -2 3946 a -2 3946 a
SDict begin [/View [/XYZ H.V]/Dest (0:872) cvn /DEST pdfmark end
 -2 3946 a 396
4043 a Fj(If)20 b(you')l(re)f(lik)o(e)h(most)g(\330MQ)h(users,)f(at)h
(this)f(stage)h(your)e(mind)g(is)i(starting)f(to)g(think,)g("what)g
(kind)f(of)h(e)n(vil)g(stuf)n(f)g(can)g(I)396 4151 y(do)g(if)h(I)f
(plug)f(random)g(sock)o(et)h(types)g(into)g(the)g(proxy?")e(The)i
(short)g(answer)g(is:)h(try)f(it)h(and)e(w)o(ork)h(out)g(what)g(is)396
4259 y(happening.)e(In)i(practice)f(you)g(w)o(ould)h(usually)f(stick)i
(to)f(R)m(OUTER/DEALER,)g(XSUB/XPUB,)i(or)e(PULL/PUSH.)-2
4287 y
SDict begin H.S end
 -2 4287 a -2 4287 a
SDict begin 13 H.A end
 -2 4287 a -2 4287 a
SDict begin [/View [/XYZ H.V]/Dest (0:873) cvn /DEST pdfmark end
 -2 4287
a 396 4597 a Fd(2.2.9.)36 b(T)-10 b(ranspor)r(t)34 b(Bridging)1804
4597 y
SDict begin H.S end
 1804 4597 a 1804 4597 a
SDict begin 18.72 H.A end
 1804 4597 a 1804 4597
a
SDict begin [/View [/XYZ H.V]/Dest (7.20.16.2) cvn /DEST pdfmark end
 1804 4597 a -2 4790 a
SDict begin H.S end
 -2 4790 a -2 4790 a
SDict begin 13 H.A end
 -2 4790 a
-2 4790 a
SDict begin [/View [/XYZ H.V]/Dest (0:875) cvn /DEST pdfmark end
 -2 4790 a 396 4871 a Fj(A)21 b(frequent)d(request)i(from)f
(\330MQ)h(users)h(is)g("ho)n(w)e(do)h(I)h(connect)e(my)g(\330MQ)i(netw)
o(ork)e(with)h(technology)e(X?")i(where)396 4979 y(X)h(is)g(some)f
(other)f(netw)o(orking)g(or)g(messaging)h(technology)-5
b(.)17 b(The)j(simple)g(answer)g(is)h(to)f(b)n(uild)g(a)h("bridge".)d
(A)j(bridge)396 5087 y(is)g(a)g(small)g(application)d(that)j(speaks)f
(one)f(protocol)g(at)i(one)e(sock)o(et,)h(and)g(con)m(v)o(erts)e
(to/from)h(a)i(second)e(protocol)f(at)p Black 3800 5569
a Fi(53)p Black eop end
%%Page: 54 68
TeXDict begin 54 67 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.54) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(another)19 b(sock)o(et.)h(A)g(protocol)f
(interpreter)m(,)f(if)i(you)g(lik)o(e.)g(A)h(common)d(bridging)g
(problem)h(in)h(\330MQ)g(is)h(to)g(bridge)e(tw)o(o)396
180 y(transports)g(or)h(netw)o(orks.)-2 364 y
SDict begin H.S end
 -2 364
a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:876) cvn /DEST pdfmark end
 -2 364 a 396 454 a Fj(As)g(an)f(e)o
(xample,)e(we')l(re)h(going)g(to)h(write)g(a)g(little)h(proxy)d(that)i
(sits)h(in)f(between)f(a)i(publisher)d(and)h(a)i(set)f(of)g
(subscribers,)396 562 y(bridging)f(tw)o(o)j(netw)o(orks.)e(The)h
(frontend)e(sock)o(et)i(\(SUB\))g(f)o(aces)h(the)f(internal)f(netw)o
(ork,)g(where)h(the)g(weather)f(serv)o(er)396 670 y(is)i(sitting,)g
(and)e(the)h(back)o(end)f(\(PUB\))h(f)o(aces)h(subscribers)e(on)h(the)g
(e)o(xternal)f(netw)o(ork.)g(It)h(subscribes)g(to)g(the)g(weather)396
778 y(service)g(on)g(the)g(frontend)e(sock)o(et,)i(and)g(republishes)f
(its)i(data)f(on)g(the)g(back)o(end)e(sock)o(et\()p 0
TeXcolorgray 2993 778 a
SDict begin H.S end
 2993 778 a Fj(Figure)h(2-10)3384
778 y
SDict begin 13 H.L end
 3384 778 a 3384 778 a
SDict begin [/Subtype /Link/Dest (0:figure-18) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3384 778 a Black -2 w Fj(\).)-2
796 y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:wuproxy-php) cvn /DEST pdfmark
end
 -2 796 a 396
979 a Fk(Example)i(2-7.)e(W)-5 b(eather)19 b(update)h(pr)o(oxy)f
(\(wupr)o(oxy)-6 b(.php\))-2 1079 y
SDict begin H.S end
 -2 1079 a -2 1079
a
SDict begin 11.7 H.A end
 -2 1079 a -2 1079 a
SDict begin [/View [/XYZ H.V]/Dest (0:880) cvn /DEST pdfmark end
 -2 1079 a 396 1160 a Fg(<?php)396
1257 y(/)441 1270 y(*)441 1367 y(*)576 1354 y(Weather)43
b(proxy)h(device)441 1464 y(*)531 1451 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1561 y(*)486
1548 y(/)396 1742 y($context)g(=)g(new)h(ZMQContext\(\);)396
1937 y(//)90 b(This)44 b(is)g(where)g(the)h(weather)e(server)h(sits)396
2034 y($frontend)g(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_SUB\);)
396 2131 y($frontend->connect\("tcp://192.168.55.210:)o(5556"\))o(;)396
2325 y(//)90 b(This)44 b(is)g(our)h(public)e(endpoint)h(for)g
(subscribers)396 2422 y($backend)g(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PUB\);)396 2520 y
($backend->bind\("tcp://10.1.1.0:8100"\);)396 2714 y(//)90
b(Subscribe)43 b(on)h(everything)396 2811 y
($frontend->setSockOpt\(ZMQ::SOCKOPT_SUBSCR)o(IBE,)39
b(""\);)396 3005 y(//)90 b(Shunt)44 b(messages)f(out)h(to)h(our)f(own)h
(subscribers)396 3102 y(while\(true\))e({)441 3200 y(while\(true\))g({)
486 3297 y(//)89 b(Process)44 b(all)g(parts)g(of)h(the)f(message)486
3394 y($message)f(=)i($frontend->recv\(\);)486 3491 y($more)f(=)h
($frontend->getSockOpt\(ZMQ::SOCKOPT_RC)o(VMORE\))o(;)486
3588 y($backend->send\($message,)c($more)j(?)g(ZMQ::SOCKOPT_SNDMORE)e
(:)j(0\);)486 3685 y(if\(!$more\))e({)531 3782 y(break;)h(//)g(Last)g
(message)g(part)486 3879 y(})441 3977 y(})-2 4151 y
SDict begin H.S end
 -2
4151 a -2 4151 a
SDict begin 13 H.A end
 -2 4151 a -2 4151 a
SDict begin [/View [/XYZ H.V]/Dest (0:881) cvn /DEST pdfmark end
 -2 4151 a 396 4251
a Fj(It)21 b(looks)e(v)o(ery)g(similar)i(to)f(the)g(earlier)g(proxy)f
(e)o(xample)f(b)n(ut)j(the)f(k)o(e)o(y)f(part)h(is)h(that)g(the)f
(frontend)e(and)i(back)o(end)396 4358 y(sock)o(ets)h(are)f(on)g(tw)o(o)
g(dif)n(ferent)e(netw)o(orks.)i(W)-7 b(e)21 b(can)f(use)g(this)h(model)
e(for)h(e)o(xample)f(to)h(connect)f(a)i(multicast)f(netw)o(ork)396
4466 y(\()424 4466 y
SDict begin H.S end
 424 4466 a 424 4466 a
SDict begin 13 H.A end
 424 4466 a
424 4466 a
SDict begin [/View [/XYZ H.V]/Dest (0:882) cvn /DEST pdfmark end
 424 4466 a Fg(pgm)g Fj(transport\))f(to)h(a)h(TCP)g
(publisher)-5 b(.)-2 4484 y
SDict begin H.S end
 -2 4484 a -2 4484 a
SDict begin 13 H.A end
 -2 4484
a -2 4484 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-18) cvn /DEST pdfmark
end
 -2 4484 a Black 3800 5569 a Fi(54)p Black
eop end
%%Page: 55 69
TeXDict begin 55 68 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.55) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:892) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-10.)e(Pub-Sub)j(F)n
(orwarder)e(Pr)o(oxy)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172
a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:885) cvn /DEST pdfmark end
 -2 172 a 396 3514 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3514 a @beginspecial
0 @llx -396 @lly 427 @urx 0 @ury 4270 @rwi @setspecial
%%BeginDocument: images/fig18.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -396 427 0
%%HiResBoundingBox: 0.0 -396.0 427.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
138.10020446777344 -24.100210189819336 moveto
138.10020446777344 -58.1002082824707 lineto
222.10020446777344 -58.1002082824707 lineto
222.10020446777344 -24.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
138.10020446777344 -61.1002082824707 moveto
138.10020446777344 -74.10021209716797 lineto
138.10020446777344 -76.76687876383464 139.43353780110678 -78.10021209716797 142.10020446777344 -78.10021209716797 curveto
219.10020446777344 -78.10021209716797 lineto
219.10020446777344 -78.10021209716797 lineto
221.10020446777344 -78.10021209716797 222.10020446777344 -76.76687876383464 222.10020446777344 -74.10021209716797 curveto
222.10020446777344 -61.50020980834961 lineto
222.10020446777344 -61.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
23.100210189819336 -159.10020446777344 moveto
20.433543523152668 -159.10020446777344 19.100210189819336 -160.7668711344401 19.100210189819336 -164.10020446777344 curveto
19.100210189819336 -175.10020446777344 lineto
110.10021209716797 -175.10020446777344 lineto
110.10021209716797 -164.10020446777344 lineto
110.10021209716797 -160.7668711344401 109.10021209716797 -159.10020446777344 107.10021209716797 -159.10020446777344 curveto
23.100210189819336 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.100210189819336 -178.10020446777344 moveto
19.100210189819336 -213.10020446777344 lineto
110.10021209716797 -213.10020446777344 lineto
110.10021209716797 -178.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.10020446777344 -159.10020446777344 moveto
139.43353780110678 -159.10020446777344 138.10020446777344 -160.7668711344401 138.10020446777344 -164.10020446777344 curveto
138.10020446777344 -175.10020446777344 lineto
229.10020446777344 -175.10020446777344 lineto
229.10020446777344 -164.10020446777344 lineto
229.10020446777344 -160.7668711344401 228.10020446777344 -159.10020446777344 226.10020446777344 -159.10020446777344 curveto
142.10020446777344 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
138.10020446777344 -178.10020446777344 moveto
138.10020446777344 -213.10020446777344 lineto
229.10020446777344 -213.10020446777344 lineto
229.10020446777344 -178.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
261.1002197265625 -168.10020446777344 moveto
258.4335530598958 -168.10020446777344 257.1002197265625 -169.7668711344401 257.1002197265625 -173.10020446777344 curveto
257.1002197265625 -184.10020446777344 lineto
348.1002197265625 -184.10020446777344 lineto
348.1002197265625 -173.10020446777344 lineto
348.1002197265625 -169.7668711344401 347.1002197265625 -168.10020446777344 345.1002197265625 -168.10020446777344 curveto
261.1002197265625 -168.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
257.1002197265625 -187.10020446777344 moveto
257.1002197265625 -220.10020446777344 lineto
348.1002197265625 -220.10020446777344 lineto
348.1002197265625 -187.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
257.1002197265625 -223.10020446777344 moveto
257.1002197265625 -236.10020446777344 lineto
257.1002197265625 -238.7668711344401 258.4335530598958 -240.10020446777344 261.1002197265625 -240.10020446777344 curveto
345.1002197265625 -240.10020446777344 lineto
345.1002197265625 -240.10020446777344 lineto
347.1002197265625 -240.10020446777344 348.1002197265625 -238.7668711344401 348.1002197265625 -236.10020446777344 curveto
348.1002197265625 -223.5001983642578 lineto
348.1002197265625 -223.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
198.10020446777344 -321.1002197265625 moveto
195.43353780110678 -321.1002197265625 194.10020446777344 -322.7668863932292 194.10020446777344 -326.1002197265625 curveto
194.10020446777344 -337.1002197265625 lineto
285.1002197265625 -337.1002197265625 lineto
285.1002197265625 -326.1002197265625 lineto
285.1002197265625 -322.7668863932292 284.1002197265625 -321.1002197265625 282.1002197265625 -321.1002197265625 curveto
198.10020446777344 -321.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
194.10020446777344 -340.1002197265625 moveto
194.10020446777344 -375.1002197265625 lineto
285.1002197265625 -375.1002197265625 lineto
285.1002197265625 -340.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
324.1002197265625 -321.1002197265625 moveto
321.4335530598958 -321.1002197265625 320.1002197265625 -322.7668863932292 320.1002197265625 -326.1002197265625 curveto
320.1002197265625 -337.1002197265625 lineto
411.1002197265625 -337.1002197265625 lineto
411.1002197265625 -326.1002197265625 lineto
411.1002197265625 -322.7668863932292 410.1002197265625 -321.1002197265625 408.1002197265625 -321.1002197265625 curveto
324.1002197265625 -321.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
320.1002197265625 -340.1002197265625 moveto
320.1002197265625 -375.1002197265625 lineto
411.1002197265625 -375.1002197265625 lineto
411.1002197265625 -340.1002197265625 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
136.0 -22.0 moveto
136.0 -56.0 lineto
220.0 -56.0 lineto
220.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
136.0 -22.0 moveto
136.0 -56.0 lineto
220.0 -56.0 lineto
220.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
136.0 -59.0 moveto
136.0 -72.0 lineto
136.0 -74.66666666666667 137.33333333333334 -76.0 140.0 -76.0 curveto
217.0 -76.0 lineto
217.0 -76.0 lineto
219.0 -76.0 220.0 -74.66666666666667 220.0 -72.0 curveto
220.0 -59.400001525878906 lineto
220.0 -59.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
136.0 -59.0 moveto
136.0 -72.0 lineto
136.0 -74.66666666666667 137.33333333333334 -76.0 140.0 -76.0 curveto
217.0 -76.0 lineto
217.0 -76.0 lineto
219.0 -76.0 220.0 -74.66666666666667 220.0 -72.0 curveto
220.0 -59.400001525878906 lineto
220.0 -59.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
21.0 -157.0 moveto
18.333333333333332 -157.0 17.0 -158.66666666666666 17.0 -162.0 curveto
17.0 -173.0 lineto
108.0 -173.0 lineto
108.0 -162.0 lineto
108.0 -158.66666666666666 107.0 -157.0 105.0 -157.0 curveto
21.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
21.0 -157.0 moveto
18.333333333333332 -157.0 17.0 -158.66666666666666 17.0 -162.0 curveto
17.0 -173.0 lineto
108.0 -173.0 lineto
108.0 -162.0 lineto
108.0 -158.66666666666666 107.0 -157.0 105.0 -157.0 curveto
21.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
17.0 -176.0 moveto
17.0 -211.0 lineto
108.0 -211.0 lineto
108.0 -176.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
17.0 -176.0 moveto
17.0 -211.0 lineto
108.0 -211.0 lineto
108.0 -176.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -157.0 moveto
137.33333333333334 -157.0 136.0 -158.66666666666666 136.0 -162.0 curveto
136.0 -173.0 lineto
227.0 -173.0 lineto
227.0 -162.0 lineto
227.0 -158.66666666666666 226.0 -157.0 224.0 -157.0 curveto
140.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -157.0 moveto
137.33333333333334 -157.0 136.0 -158.66666666666666 136.0 -162.0 curveto
136.0 -173.0 lineto
227.0 -173.0 lineto
227.0 -162.0 lineto
227.0 -158.66666666666666 226.0 -157.0 224.0 -157.0 curveto
140.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
136.0 -176.0 moveto
136.0 -211.0 lineto
227.0 -211.0 lineto
227.0 -176.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
136.0 -176.0 moveto
136.0 -211.0 lineto
227.0 -211.0 lineto
227.0 -176.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
259.0 -166.0 moveto
256.3333333333333 -166.0 254.99999999999997 -167.66666666666666 255.0 -171.0 curveto
255.0 -182.0 lineto
346.0 -182.0 lineto
346.0 -171.0 lineto
346.0 -167.66666666666666 345.0 -166.0 343.0 -166.0 curveto
259.0 -166.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
259.0 -166.0 moveto
256.3333333333333 -166.0 254.99999999999997 -167.66666666666666 255.0 -171.0 curveto
255.0 -182.0 lineto
346.0 -182.0 lineto
346.0 -171.0 lineto
346.0 -167.66666666666666 345.0 -166.0 343.0 -166.0 curveto
259.0 -166.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
255.0 -185.0 moveto
255.0 -218.0 lineto
346.0 -218.0 lineto
346.0 -185.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
255.0 -185.0 moveto
255.0 -218.0 lineto
346.0 -218.0 lineto
346.0 -185.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
255.0 -221.0 moveto
255.0 -234.0 lineto
255.0 -236.66666666666666 256.3333333333333 -238.0 259.0 -238.0 curveto
343.0 -238.0 lineto
343.0 -238.0 lineto
345.0 -238.0 346.0 -236.66666666666666 346.0 -234.0 curveto
346.0 -221.39999389648438 lineto
346.0 -221.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
255.0 -221.0 moveto
255.0 -234.0 lineto
255.0 -236.66666666666666 256.3333333333333 -238.0 259.0 -238.0 curveto
343.0 -238.0 lineto
343.0 -238.0 lineto
345.0 -238.0 346.0 -236.66666666666666 346.0 -234.0 curveto
346.0 -221.39999389648438 lineto
346.0 -221.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
196.0 -319.0 moveto
193.33333333333334 -319.0 192.0 -320.6666666666667 192.0 -324.0 curveto
192.0 -335.0 lineto
283.0 -335.0 lineto
283.0 -324.0 lineto
283.0 -320.6666666666667 282.0 -319.0 280.0 -319.0 curveto
196.0 -319.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
196.0 -319.0 moveto
193.33333333333334 -319.0 192.0 -320.6666666666667 192.0 -324.0 curveto
192.0 -335.0 lineto
283.0 -335.0 lineto
283.0 -324.0 lineto
283.0 -320.6666666666667 282.0 -319.0 280.0 -319.0 curveto
196.0 -319.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
192.0 -338.0 moveto
192.0 -373.0 lineto
283.0 -373.0 lineto
283.0 -338.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
192.0 -338.0 moveto
192.0 -373.0 lineto
283.0 -373.0 lineto
283.0 -338.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
322.0 -319.0 moveto
319.3333333333333 -319.0 318.0 -320.6666666666667 318.0 -324.0 curveto
318.0 -335.0 lineto
409.0 -335.0 lineto
409.0 -324.0 lineto
409.0 -320.6666666666667 408.0 -319.0 406.0 -319.0 curveto
322.0 -319.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
322.0 -319.0 moveto
319.3333333333333 -319.0 318.0 -320.6666666666667 318.0 -324.0 curveto
318.0 -335.0 lineto
409.0 -335.0 lineto
409.0 -324.0 lineto
409.0 -320.6666666666667 408.0 -319.0 406.0 -319.0 curveto
322.0 -319.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
318.0 -338.0 moveto
318.0 -373.0 lineto
409.0 -373.0 lineto
409.0 -338.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
318.0 -338.0 moveto
318.0 -373.0 lineto
409.0 -373.0 lineto
409.0 -338.0 lineto
closepath
stroke
newpath
21.0 -238.0 moveto
255.0 -238.0 lineto
stroke
newpath
346.0 -238.0 moveto
406.0 -238.0 lineto
stroke
newpath
178.0 -103.0 moveto
178.0 -121.0 lineto
stroke
newpath
59.0 -139.0 moveto
59.0 -121.0 lineto
178.0 -121.0 lineto
stroke
newpath
178.0 -139.0 moveto
178.0 -121.0 lineto
stroke
newpath
297.0 -148.0 moveto
297.0 -121.0 lineto
178.0 -121.0 lineto
stroke
newpath
297.0 -265.0 moveto
297.0 -283.0 lineto
stroke
newpath
234.0 -301.0 moveto
234.0 -283.0 lineto
297.0 -283.0 lineto
stroke
newpath
360.0 -301.0 moveto
360.0 -283.0 lineto
297.0 -283.0 lineto
stroke
/Helvetica findfont
9 scalefont setfont
156.0 -44.0 moveto
(Publisher) show
169.0 -71.0 moveto
(PUB) show
165.0 -89.0 moveto
(bind) show
115.0 -98.0 moveto
(tcp //192.168.55.210 5556) show
40.0 -152.0 moveto
(connect) show
166.0 -152.0 moveto
(connect) show
285.0 -161.0 moveto
(connect) show
50.0 -170.0 moveto
(SUB) show
169.0 -170.0 moveto
(SUB) show
288.0 -179.0 moveto
(XSUB) show
38.0 -197.0 moveto
(Subscriber) show
157.0 -197.0 moveto
(Subscriber) show
272.0 -206.0 moveto
(Forwarder) show
37.0 -233.0 moveto
(Internal network) show
288.0 -233.0 moveto
(XPUB) show
35.0 -251.0 moveto
(External network) show
291.0 -251.0 moveto
(bind) show
259.0 -260.0 moveto
(tcp //10.1.1.0 8100) show
215.0 -314.0 moveto
(connect) show
341.0 -314.0 moveto
(connect) show
225.0 -332.0 moveto
(SUB) show
351.0 -332.0 moveto
(SUB) show
213.0 -359.0 moveto
(Subscriber) show
339.0 -359.0 moveto
(Subscriber) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3514 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3514 a -2 3680 a
SDict begin H.S end
 -2 3680
a -2 3680 a
SDict begin 13 H.A end
 -2 3680 a -2 3680 a
SDict begin [/View [/XYZ H.V]/Dest (0:888) cvn /DEST pdfmark end
 -2 3680 a 377 x Fh(2.3.)39
b(Handling)f(Err)m(or)n(s)g(and)h(ETERM)2195 4057 y
SDict begin H.S end
 2195
4057 a 2195 4057 a
SDict begin 22.464 H.A end
 2195 4057 a 2195 4057 a
SDict begin [/View [/XYZ H.V]/Dest (7.21.1) cvn /DEST pdfmark end
 2195 4057
a -2 4255 a
SDict begin H.S end
 -2 4255 a -2 4255 a
SDict begin 13 H.A end
 -2 4255 a -2 4255 a
SDict begin [/View [/XYZ H.V]/Dest (0:890) cvn /DEST pdfmark end
 -2
4255 a 396 4331 a Fj(\330MQ')-5 b(s)21 b(error)e(handling)f(philosophy)
g(is)j(a)g(mix)f(of)f(f)o(ail-f)o(ast)i(and)e(resilience.)h(Processes,)
g(we)h(belie)n(v)o(e,)e(should)g(be)h(as)396 4439 y(vulnerable)e(as)j
(possible)f(to)h(internal)e(errors,)g(and)h(as)h(rob)n(ust)e(as)i
(possible)f(against)g(e)o(xternal)f(attacks)h(and)g(errors.)f(T)-7
b(o)396 4547 y(gi)n(v)o(e)20 b(an)g(analogy)-5 b(,)18
b(a)i(li)n(ving)g(cell)g(will)h(self-destruct)f(if)g(it)h(detects)f(a)h
(single)f(internal)f(error)m(,)g(yet)h(it)h(will)g(resist)g(attack)396
4655 y(from)e(the)i(outside)e(by)h(all)h(means)f(possible.)-2
4839 y
SDict begin H.S end
 -2 4839 a -2 4839 a
SDict begin 13 H.A end
 -2 4839 a -2 4839 a
SDict begin [/View [/XYZ H.V]/Dest (0:891) cvn /DEST pdfmark end
 -2 4839
a 396 4929 a Fj(Assertions,)g(which)g(pepper)f(the)h(\330MQ)g(code,)g
(are)g(absolutely)f(vital)h(to)g(rob)n(ust)g(code,)f(the)o(y)h(just)g
(ha)n(v)o(e)g(to)g(be)h(on)e(the)396 5037 y(right)h(side)g(of)g(the)g
(cellular)g(w)o(all.)h(And)f(there)f(should)g(be)i(such)f(a)g(w)o(all.)
h(If)f(it)h(is)g(unclear)e(whether)g(a)i(f)o(ault)f(is)h(internal)396
5145 y(or)f(e)o(xternal,)f(that)h(is)h(a)g(design)e(\003a)o(w)i(to)f
(be)g(\002x)o(ed.)g(In)g(C/C++,)h(assertions)f(stop)g(the)g
(application)f(immediately)g(with)p Black 3800 5569 a
Fi(55)p Black eop end
%%Page: 56 70
TeXDict begin 56 69 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.56) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(an)20 b(error)-5 b(.)20
b(In)g(other)f(languages)g(you)g(may)h(get)g(e)o(xceptions)e(or)i
(halts.)396 346 y(When)g(\330MQ)h(detects)f(an)g(e)o(xternal)f(f)o
(ault)h(it)h(returns)e(an)i(error)e(to)h(the)g(calling)g(code.)f(In)h
(some)g(rare)g(cases)h(it)g(drops)396 454 y(messages)g(silently)-5
b(,)19 b(if)i(there)e(is)j(no)d(ob)o(vious)g(strate)o(gy)g(for)h(reco)o
(v)o(ering)d(from)i(the)h(error)-5 b(.)-2 638 y
SDict begin H.S end
 -2 638
a -2 638 a
SDict begin 13 H.A end
 -2 638 a -2 638 a
SDict begin [/View [/XYZ H.V]/Dest (0:893) cvn /DEST pdfmark end
 -2 638 a 396 728 a Fj(In)20
b(most)g(of)g(the)h(C)g(e)o(xamples)e(we')l(v)o(e)g(seen)h(so)h(f)o(ar)
f(there')-5 b(s)20 b(been)f(no)h(error)f(handling.)2920
728 y
SDict begin H.S end
 2920 728 a 2920 728 a
SDict begin 13 H.A end
 2920 728 a 2920 728 a
SDict begin [/View [/XYZ H.V]/Dest (0:894) cvn /DEST pdfmark end
 2920
728 a Fk(Real)i(code)f(should)h(do)f(err)o(or)396 836
y(handling)h(on)f(e)o(v)o(ery)g(single)g(\330MQ)h(call)p
Fj(.)f(If)g(you')l(re)e(using)i(a)g(language)f(binding)f(other)i(than)f
(C,)i(the)f(binding)f(may)396 944 y(handle)g(errors)h(for)f(you.)g(In)h
(C)h(you)f(do)f(need)h(to)g(do)g(this)h(yourself.)d(There)i(are)g(some)
g(simple)g(rules,)g(starting)g(with)396 1052 y(POSIX)h(con)m(v)o
(entions:)-2 1053 y
SDict begin H.S end
 -2 1053 a -2 1053 a
SDict begin 13 H.A end
 -2 1053 a -2
1053 a
SDict begin [/View [/XYZ H.V]/Dest (0:895) cvn /DEST pdfmark end
 -2 1053 a -2 1063 a
SDict begin H.S end
 -2 1063 a -2 1063 a
SDict begin 13 H.A end
 -2 1063
a -2 1063 a
SDict begin [/View [/XYZ H.V]/Dest (0:896) cvn /DEST pdfmark end
 -2 1063 a Black 396 1222 a Fe(\225)p Black
479 1222 a
SDict begin H.S end
 479 1222 a 479 1222 a
SDict begin 13 H.A end
 479 1222 a 479 1222
a
SDict begin [/View [/XYZ H.V]/Dest (0:897) cvn /DEST pdfmark end
 479 1222 a Fj(Methods)f(that)g(create)g(objects)g(return)f(NULL)h(if)
g(the)o(y)g(f)o(ail.)-2 1240 y
SDict begin H.S end
 -2 1240 a -2 1240 a
SDict begin 13 H.A end
 -2
1240 a -2 1240 a
SDict begin [/View [/XYZ H.V]/Dest (0:898) cvn /DEST pdfmark end
 -2 1240 a Black 396 1372 a Fe(\225)p
Black 479 1372 a
SDict begin H.S end
 479 1372 a 479 1372 a
SDict begin 13 H.A end
 479 1372 a 479
1372 a
SDict begin [/View [/XYZ H.V]/Dest (0:899) cvn /DEST pdfmark end
 479 1372 a Fj(Methods)g(that)g(process)g(data)g(may)f(return)g
(the)i(number)d(of)i(bytes)g(processed,)f(or)h(-1)g(on)f(an)i(error)e
(or)h(f)o(ailure.)-2 1390 y
SDict begin H.S end
 -2 1390 a -2 1390 a
SDict begin 13 H.A end
 -2 1390
a -2 1390 a
SDict begin [/View [/XYZ H.V]/Dest (0:900) cvn /DEST pdfmark end
 -2 1390 a Black 396 1521 a Fe(\225)p Black
479 1521 a
SDict begin H.S end
 479 1521 a 479 1521 a
SDict begin 13 H.A end
 479 1521 a 479 1521
a
SDict begin [/View [/XYZ H.V]/Dest (0:901) cvn /DEST pdfmark end
 479 1521 a Fj(Other)g(methods)f(return)g(0)h(on)g(success)h(and)f(-1)
g(on)f(an)h(error)g(or)f(f)o(ailure.)-2 1522 y
SDict begin H.S end
 -2 1522
a -2 1522 a
SDict begin 13 H.A end
 -2 1522 a -2 1522 a
SDict begin [/View [/XYZ H.V]/Dest (0:902) cvn /DEST pdfmark end
 -2 1522 a Black 396 1671
a Fe(\225)p Black 479 1671 a
SDict begin H.S end
 479 1671 a 479 1671 a
SDict begin 13 H.A end
 479
1671 a 479 1671 a
SDict begin [/View [/XYZ H.V]/Dest (0:903) cvn /DEST pdfmark end
 479 1671 a Fj(The)h(error)f(code)h(is)h(pro)o(vided)c
(in)1465 1671 y
SDict begin H.S end
 1465 1671 a 1465 1671 a
SDict begin 13 H.A end
 1465 1671 a 1465
1671 a
SDict begin [/View [/XYZ H.V]/Dest (0:904) cvn /DEST pdfmark end
 1465 1671 a Fg(errno)j Fj(or)1800 1671 y
SDict begin H.S end
 1800
1671 a 1800 1671 a
SDict begin 13 H.A end
 1800 1671 a 1800 1671 a
SDict begin [/View [/XYZ H.V]/Dest (0:905) cvn /DEST pdfmark end
 1800 1671
a Fg(zmq-errno[3])p Fj(.)-2 1689 y
SDict begin H.S end
 -2 1689 a -2 1689
a
SDict begin 13 H.A end
 -2 1689 a -2 1689 a
SDict begin [/View [/XYZ H.V]/Dest (0:906) cvn /DEST pdfmark end
 -2 1689 a Black 396 1820 a Fe(\225)p
Black 479 1820 a
SDict begin H.S end
 479 1820 a 479 1820 a
SDict begin 13 H.A end
 479 1820 a 479
1820 a
SDict begin [/View [/XYZ H.V]/Dest (0:907) cvn /DEST pdfmark end
 479 1820 a Fj(A)h(descripti)n(v)o(e)e(error)g(te)o(xt)h(for)f
(logging)g(is)i(pro)o(vided)d(by)2154 1820 y
SDict begin H.S end
 2154 1820
a 2154 1820 a
SDict begin 13 H.A end
 2154 1820 a 2154 1820 a
SDict begin [/View [/XYZ H.V]/Dest (0:908) cvn /DEST pdfmark end
 2154 1820 a Fg(zmq-strerror[3])p
Fj(.)-2 2004 y
SDict begin H.S end
 -2 2004 a -2 2004 a
SDict begin 13 H.A end
 -2 2004 a -2 2004
a
SDict begin [/View [/XYZ H.V]/Dest (0:909) cvn /DEST pdfmark end
 -2 2004 a 396 2094 a Fj(F)o(or)i(e)o(xample:)-2 2195
y
SDict begin H.S end
 -2 2195 a -2 2195 a
SDict begin 11.7 H.A end
 -2 2195 a -2 2195 a
SDict begin [/View [/XYZ H.V]/Dest (0:910) cvn /DEST pdfmark end
 -2 2195 a 396
2274 a Fg(void)620 2287 y(*)665 2274 y(context)44 b(=)h(zmq-ctx-new)e
(\(\);)396 2371 y(assert)h(\(context\);)396 2468 y(void)620
2481 y(*)665 2468 y(socket)g(=)h(zmq-socket)e(\(context,)g(ZMQ-REP\);)
396 2566 y(assert)h(\(socket\);)396 2663 y(int)h(rc)f(=)h(zmq-bind)e
(\(socket,)h("tcp://)1922 2676 y(*)1967 2663 y(:5555"\);)396
2760 y(if)h(\(rc)f(!=)h(0\))f({)576 2857 y(printf)f(\("E:)i(bind)f
(failed:)f(\045s\\n",)h(strerror)g(\(errno\)\);)576 2954
y(return)f(-1;)396 3051 y(})-2 3226 y
SDict begin H.S end
 -2 3226 a -2 3226
a
SDict begin 13 H.A end
 -2 3226 a -2 3226 a
SDict begin [/View [/XYZ H.V]/Dest (0:911) cvn /DEST pdfmark end
 -2 3226 a 396 3325 a Fj(There)20
b(are)g(tw)o(o)g(main)g(e)o(xceptional)e(conditions)h(that)h(you)g(may)
f(w)o(ant)i(to)f(handle)f(as)i(non-f)o(atal:)-2 3343
y
SDict begin H.S end
 -2 3343 a -2 3343 a
SDict begin 13 H.A end
 -2 3343 a -2 3343 a
SDict begin [/View [/XYZ H.V]/Dest (0:912) cvn /DEST pdfmark end
 -2 3343 a -2
3353 a
SDict begin H.S end
 -2 3353 a -2 3353 a
SDict begin 13 H.A end
 -2 3353 a -2 3353 a
SDict begin [/View [/XYZ H.V]/Dest (0:913) cvn /DEST pdfmark end
 -2 3353
a Black 396 3495 a Fe(\225)p Black 479 3495 a
SDict begin H.S end
 479 3495
a 479 3495 a
SDict begin 13 H.A end
 479 3495 a 479 3495 a
SDict begin [/View [/XYZ H.V]/Dest (0:914) cvn /DEST pdfmark end
 479 3495 a Fj(When)f(a)h(thread)e
(calls)1157 3495 y
SDict begin H.S end
 1157 3495 a 1157 3495 a
SDict begin 13 H.A end
 1157 3495
a 1157 3495 a
SDict begin [/View [/XYZ H.V]/Dest (0:915) cvn /DEST pdfmark end
 1157 3495 a Fg(zmq-msg-recv[3])f Fj(with)j(the)2141
3495 y
SDict begin H.S end
 2141 3495 a 2141 3495 a
SDict begin 13 H.A end
 2141 3495 a 2141 3495
a
SDict begin [/View [/XYZ H.V]/Dest (0:916) cvn /DEST pdfmark end
 2141 3495 a Fg(ZMQ-DONTWAIT)e Fj(option)g(and)g(there)h(is)h(no)f(w)o
(aiting)g(data.)479 3603 y(\330MQ)h(will)g(return)e(-1)h(and)f(set)1406
3603 y
SDict begin H.S end
 1406 3603 a 1406 3603 a
SDict begin 13 H.A end
 1406 3603 a 1406 3603
a
SDict begin [/View [/XYZ H.V]/Dest (0:917) cvn /DEST pdfmark end
 1406 3603 a Fg(errno)h Fj(to)1736 3603 y
SDict begin H.S end
 1736 3603
a 1736 3603 a
SDict begin 13 H.A end
 1736 3603 a 1736 3603 a
SDict begin [/View [/XYZ H.V]/Dest (0:918) cvn /DEST pdfmark end
 1736 3603 a Fg(EAGAIN)p
Fj(.)-2 3618 y
SDict begin H.S end
 -2 3618 a -2 3618 a
SDict begin 13 H.A end
 -2 3618 a -2 3618
a
SDict begin [/View [/XYZ H.V]/Dest (0:919) cvn /DEST pdfmark end
 -2 3618 a Black 396 3753 a Fe(\225)p Black 479 3753
a
SDict begin H.S end
 479 3753 a 479 3753 a
SDict begin 13 H.A end
 479 3753 a 479 3753 a
SDict begin [/View [/XYZ H.V]/Dest (0:920) cvn /DEST pdfmark end
 479 3753
a Fj(When)g(a)h(thread)e(calls)1157 3753 y
SDict begin H.S end
 1157 3753
a 1157 3753 a
SDict begin 13 H.A end
 1157 3753 a 1157 3753 a
SDict begin [/View [/XYZ H.V]/Dest (0:921) cvn /DEST pdfmark end
 1157 3753 a Fg
(zmq-ctx-destroy[3])f Fj(and)h(other)h(threads)f(are)h(doing)f
(blocking)g(w)o(ork.)g(The)479 3861 y
SDict begin H.S end
 479 3861 a 479
3861 a
SDict begin 13 H.A end
 479 3861 a 479 3861 a
SDict begin [/View [/XYZ H.V]/Dest (0:922) cvn /DEST pdfmark end
 479 3861 a Fg(zmq-ctx-destroy[3])f
Fj(call)j(closes)f(the)h(conte)o(xt)d(and)i(all)h(blocking)d(calls)j(e)
o(xit)f(with)h(-1,)e(and)h(errno)f(set)i(to)479 3969
y
SDict begin H.S end
 479 3969 a 479 3969 a
SDict begin 13 H.A end
 479 3969 a 479 3969 a
SDict begin [/View [/XYZ H.V]/Dest (0:923) cvn /DEST pdfmark end
 479 3969
a Fg(ETERM)p Fj(.)-2 4136 y
SDict begin H.S end
 -2 4136 a -2 4136 a
SDict begin 13 H.A end
 -2 4136
a -2 4136 a
SDict begin [/View [/XYZ H.V]/Dest (0:924) cvn /DEST pdfmark end
 -2 4136 a 396 4243 a Fj(In)f(C/C++,)h(asserts)g(can)f(be)g
(remo)o(v)o(ed)e(entirely)i(in)g(optimized)f(code,)g(so)i(don')o(t)d
(mak)o(e)i(the)g(mistak)o(e)g(of)g(wrapping)e(the)396
4351 y(whole)i(\330MQ)g(call)h(in)f(an)g(assert\(\).)g(It)h(looks)e
(neat,)h(then)g(the)g(optimizer)f(remo)o(v)o(es)g(all)i(the)f(asserts)h
(and)e(the)i(calls)g(you)396 4459 y(w)o(ant)g(to)f(mak)o(e,)f(and)h
(your)f(application)g(breaks)g(in)h(impressi)n(v)o(e)g(w)o(ays.)-2
4643 y
SDict begin H.S end
 -2 4643 a -2 4643 a
SDict begin 13 H.A end
 -2 4643 a -2 4643 a
SDict begin [/View [/XYZ H.V]/Dest (0:925) cvn /DEST pdfmark end
 -2 4643
a 396 4733 a Fj(Let')-5 b(s)21 b(see)g(ho)n(w)e(to)i(shut)f(do)n(wn)f
(a)i(process)e(cleanly)-5 b(.)19 b(W)-7 b(e')o(ll)22
b(tak)o(e)e(the)g(parallel)g(pipeline)f(e)o(xample)g(from)g(the)h(pre)n
(vious)396 4840 y(section.)g(If)g(we')l(v)o(e)f(started)h(a)h(whole)f
(lot)g(of)g(w)o(ork)o(ers)f(in)i(the)f(background,)c(we)21
b(no)n(w)f(w)o(ant)g(to)g(kill)h(them)f(when)f(the)396
4948 y(batch)h(is)h(\002nished.)e(Let')-5 b(s)21 b(do)f(this)h(by)e
(sending)h(a)g(kill)h(message)f(to)g(the)g(w)o(ork)o(ers.)f(The)h(best)
h(place)f(to)g(do)g(this)h(is)g(the)396 5056 y(sink,)f(since)h(it)f
(really)g(kno)n(ws)g(when)f(the)h(batch)g(is)h(done.)p
Black 3798 5569 a Fi(56)p Black eop end
%%Page: 57 71
TeXDict begin 57 70 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.57) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:944) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:926) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Ho)n(w)20 b(do)g(we)h(connect)e(the)h
(sink)g(to)g(the)h(w)o(ork)o(ers?)e(The)h(PUSH/PULL)g(sock)o(ets)h(are)
f(one-w)o(ay)f(only)-5 b(.)18 b(The)i(standard)396 180
y(\330MQ)h(answer)f(is:)h(create)f(a)g(ne)n(w)g(sock)o(et)g(\003o)n(w)h
(for)e(each)h(type)g(of)g(problem)e(you)h(need)h(to)g(solv)o(e.)g(W)-7
b(e')o(ll)21 b(use)g(a)396 288 y(publish-subscribe)d(model)h(to)h(send)
g(kill)h(messages)f(to)g(the)h(w)o(ork)o(ers\()p 0 TeXcolorgray
2458 288 a
SDict begin H.S end
 2458 288 a Fj(Figure)d(2-11)2848 288 y
SDict begin 13 H.L end
 2848
288 a 2848 288 a
SDict begin [/Subtype /Link/Dest (0:figure-19) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2848 288 a Black -2 w Fj(\):)-2 306
y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2 306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:928) cvn /DEST pdfmark end
 -2 306 a -2 316
a
SDict begin H.S end
 -2 316 a -2 316 a
SDict begin 13 H.A end
 -2 316 a -2 316 a
SDict begin [/View [/XYZ H.V]/Dest (0:929) cvn /DEST pdfmark end
 -2 316 a Black
396 459 a Fe(\225)p Black 479 459 a
SDict begin H.S end
 479 459 a 479 459
a
SDict begin 13 H.A end
 479 459 a 479 459 a
SDict begin [/View [/XYZ H.V]/Dest (0:930) cvn /DEST pdfmark end
 479 459 a Fj(The)i(sink)g(creates)h(a)f(PUB)h
(sock)o(et)f(on)g(a)h(ne)n(w)f(endpoint.)-2 477 y
SDict begin H.S end
 -2
477 a -2 477 a
SDict begin 13 H.A end
 -2 477 a -2 477 a
SDict begin [/View [/XYZ H.V]/Dest (0:931) cvn /DEST pdfmark end
 -2 477 a Black 396 608
a Fe(\225)p Black 479 608 a
SDict begin H.S end
 479 608 a 479 608 a
SDict begin 13 H.A end
 479 608
a 479 608 a
SDict begin [/View [/XYZ H.V]/Dest (0:932) cvn /DEST pdfmark end
 479 608 a Fj(W)-7 b(ork)o(ers)20 b(bind)g(their)g(input)f
(sock)o(et)h(to)h(this)f(endpoint.)-2 626 y
SDict begin H.S end
 -2 626 a
-2 626 a
SDict begin 13 H.A end
 -2 626 a -2 626 a
SDict begin [/View [/XYZ H.V]/Dest (0:933) cvn /DEST pdfmark end
 -2 626 a Black 396 757 a Fe(\225)p
Black 479 757 a
SDict begin H.S end
 479 757 a 479 757 a
SDict begin 13 H.A end
 479 757 a 479 757
a
SDict begin [/View [/XYZ H.V]/Dest (0:934) cvn /DEST pdfmark end
 479 757 a Fj(When)g(the)h(sink)f(detects)g(the)g(end)g(of)g(the)g
(batch)g(it)g(sends)h(a)f(kill)h(to)f(its)h(PUB)h(sock)o(et.)-2
758 y
SDict begin H.S end
 -2 758 a -2 758 a
SDict begin 13 H.A end
 -2 758 a -2 758 a
SDict begin [/View [/XYZ H.V]/Dest (0:935) cvn /DEST pdfmark end
 -2 758 a Black
396 907 a Fe(\225)p Black 479 907 a
SDict begin H.S end
 479 907 a 479 907
a
SDict begin 13 H.A end
 479 907 a 479 907 a
SDict begin [/View [/XYZ H.V]/Dest (0:936) cvn /DEST pdfmark end
 479 907 a Fj(When)e(a)h(w)o(ork)o(er)e(detects)h
(this)h(kill)g(message,)e(it)i(e)o(xits.)-2 1091 y
SDict begin H.S end
 -2
1091 a -2 1091 a
SDict begin 13 H.A end
 -2 1091 a -2 1091 a
SDict begin [/View [/XYZ H.V]/Dest (0:937) cvn /DEST pdfmark end
 -2 1091 a 396 1181
a Fj(It)g(doesn')o(t)d(tak)o(e)j(much)e(ne)n(w)h(code)f(in)i(the)f
(sink:)-2 1265 y
SDict begin H.S end
 -2 1265 a -2 1265 a
SDict begin 11.7 H.A end
 -2 1265 a -2 1265
a
SDict begin [/View [/XYZ H.V]/Dest (0:938) cvn /DEST pdfmark end
 -2 1265 a 396 1361 a Fg(void)620 1374 y(*)665 1361
y(control)44 b(=)h(zmq-socket)e(\(context,)g(ZMQ-PUB\);)396
1458 y(zmq-bind)h(\(control,)f("tcp://)1563 1471 y(*)1608
1458 y(:5559"\);)396 1555 y(...)396 1652 y(//)90 b(Send)44
b(kill)g(signal)g(to)g(workers)396 1750 y(zmq-msg-init-data)e
(\(&message,)h("KILL",)h(5\);)396 1847 y(zmq-msg-send)f(\(control,)g
(&message,)h(0\);)396 1944 y(zmq-msg-close)f(\(&message\);)-2
1956 y
SDict begin H.S end
 -2 1956 a -2 1956 a
SDict begin 13 H.A end
 -2 1956 a -2 1956 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-19) cvn /DEST pdfmark
end
 -2 1956
a Black 3797 5569 a Fi(57)p Black eop end
%%Page: 58 72
TeXDict begin 58 71 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.58) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-11.)e(P)o(arallel)i
(Pipeline)h(with)f(Kill)h(Signaling)-2 172 y
SDict begin H.S end
 -2 172 a
-2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:941) cvn /DEST pdfmark end
 -2 172 a 396 4797 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4797
a @beginspecial 0 @llx -550 @lly 432 @urx 0 @ury 4320
@rwi @setspecial
%%BeginDocument: images/fig19.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -550 432 0
%%HiResBoundingBox: 0.0 -550.0 432.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
126.40023803710938 -29.400239944458008 moveto
126.40023803710938 -71.40023803710938 lineto
238.40023803710938 -71.40023803710938 lineto
238.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
126.40023803710938 -74.40023803710938 moveto
126.40023803710938 -90.40023803710938 lineto
126.40023803710938 -93.7335713704427 127.7335713704427 -95.40023803710938 130.40023803710938 -95.40023803710938 curveto
234.40023803710938 -95.40023803710938 lineto
234.40023803710938 -95.40023803710938 lineto
237.06690470377603 -95.40023803710938 238.40023803710938 -93.7335713704427 238.40023803710938 -90.40023803710938 curveto
238.40023803710938 -75.00023651123047 lineto
238.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
146.40023803710938 -392.4002380371094 moveto
143.73357137044272 -392.4002380371094 142.40023803710938 -394.4002380371094 142.40023803710938 -398.4002380371094 curveto
142.40023803710938 -412.4002380371094 lineto
254.40023803710938 -412.4002380371094 lineto
254.40023803710938 -398.4002380371094 lineto
254.40023803710938 -394.4002380371094 253.06690470377603 -392.4002380371094 250.40023803710938 -392.4002380371094 curveto
146.40023803710938 -392.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -415.4002380371094 moveto
142.40023803710938 -456.4002380371094 lineto
254.40023803710938 -456.4002380371094 lineto
254.40023803710938 -415.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -459.4002380371094 moveto
142.40023803710938 -475.4002380371094 lineto
142.40023803710938 -478.7335713704427 143.73357137044272 -480.4002380371094 146.40023803710938 -480.4002380371094 curveto
250.40023803710938 -480.4002380371094 lineto
250.40023803710938 -480.4002380371094 lineto
253.06690470377603 -480.4002380371094 254.40023803710938 -478.7335713704427 254.40023803710938 -475.4002380371094 curveto
254.40023803710938 -460.000244140625 lineto
254.40023803710938 -459.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -205.40023803710938 moveto
23.73357327779134 -205.40023803710938 22.400239944458008 -207.40023803710938 22.400239944458008 -211.40023803710938 curveto
22.400239944458008 -227.40023803710938 lineto
76.40023803710938 -227.40023803710938 lineto
76.40023803710938 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
79.40023803710938 -205.40023803710938 moveto
79.40023803710938 -227.40023803710938 lineto
126.40023803710938 -227.40023803710938 lineto
126.40023803710938 -211.40023803710938 lineto
126.40023803710938 -207.40023803710938 125.06690470377605 -205.40023803710938 122.40023803710938 -205.40023803710938 curveto
80.00023651123047 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -205.40023803710938 moveto
151.73357137044272 -205.40023803710938 150.40023803710938 -207.40023803710938 150.40023803710938 -211.40023803710938 curveto
150.40023803710938 -227.40023803710938 lineto
204.40023803710938 -227.40023803710938 lineto
204.40023803710938 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
207.40023803710938 -205.40023803710938 moveto
207.40023803710938 -227.40023803710938 lineto
254.40023803710938 -227.40023803710938 lineto
254.40023803710938 -211.40023803710938 lineto
254.40023803710938 -207.40023803710938 253.06690470377603 -205.40023803710938 250.40023803710938 -205.40023803710938 curveto
208.000244140625 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -205.40023803710938 moveto
279.7335713704427 -205.40023803710938 278.4002380371094 -207.40023803710938 278.4002380371094 -211.40023803710938 curveto
278.4002380371094 -227.40023803710938 lineto
332.4002380371094 -227.40023803710938 lineto
332.4002380371094 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
335.4002380371094 -205.40023803710938 moveto
335.4002380371094 -227.40023803710938 lineto
382.4002380371094 -227.40023803710938 lineto
382.4002380371094 -211.40023803710938 lineto
382.4002380371094 -207.40023803710938 381.06690470377606 -205.40023803710938 378.4002380371094 -205.40023803710938 curveto
336.000244140625 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -227.40023803710938 moveto
22.400239944458008 -269.4002380371094 lineto
126.40023803710938 -269.4002380371094 lineto
126.40023803710938 -227.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -227.40023803710938 moveto
150.40023803710938 -269.4002380371094 lineto
254.40023803710938 -269.4002380371094 lineto
254.40023803710938 -227.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -227.40023803710938 moveto
278.4002380371094 -269.4002380371094 lineto
382.4002380371094 -269.4002380371094 lineto
382.4002380371094 -227.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -272.4002380371094 moveto
22.400239944458008 -288.4002380371094 lineto
22.400239944458008 -291.7335713704427 23.73357327779134 -293.4002380371094 26.400239944458008 -293.4002380371094 curveto
122.40023803710938 -293.4002380371094 lineto
122.40023803710938 -293.4002380371094 lineto
125.06690470377605 -293.4002380371094 126.40023803710938 -291.7335713704427 126.40023803710938 -288.4002380371094 curveto
126.40023803710938 -273.000244140625 lineto
126.40023803710938 -272.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -272.4002380371094 moveto
150.40023803710938 -288.4002380371094 lineto
150.40023803710938 -291.7335713704427 151.73357137044272 -293.4002380371094 154.40023803710938 -293.4002380371094 curveto
250.40023803710938 -293.4002380371094 lineto
250.40023803710938 -293.4002380371094 lineto
253.06690470377603 -293.4002380371094 254.40023803710938 -291.7335713704427 254.40023803710938 -288.4002380371094 curveto
254.40023803710938 -273.000244140625 lineto
254.40023803710938 -272.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -272.4002380371094 moveto
278.4002380371094 -288.4002380371094 lineto
278.4002380371094 -291.7335713704427 279.7335713704427 -293.4002380371094 282.4002380371094 -293.4002380371094 curveto
378.4002380371094 -293.4002380371094 lineto
378.4002380371094 -293.4002380371094 lineto
381.06690470377606 -293.4002380371094 382.4002380371094 -291.7335713704427 382.4002380371094 -288.4002380371094 curveto
382.4002380371094 -273.000244140625 lineto
382.4002380371094 -272.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
124.0 -27.0 moveto
124.0 -69.0 lineto
236.0 -69.0 lineto
236.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
124.0 -27.0 moveto
124.0 -69.0 lineto
236.0 -69.0 lineto
236.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
124.0 -72.0 moveto
124.0 -88.0 lineto
124.0 -91.33333333333333 125.33333333333333 -93.0 128.0 -93.0 curveto
232.0 -93.0 lineto
232.0 -93.0 lineto
234.66666666666666 -93.0 236.0 -91.33333333333333 236.0 -88.0 curveto
236.0 -72.5999984741211 lineto
236.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
124.0 -72.0 moveto
124.0 -88.0 lineto
124.0 -91.33333333333333 125.33333333333333 -93.0 128.0 -93.0 curveto
232.0 -93.0 lineto
232.0 -93.0 lineto
234.66666666666666 -93.0 236.0 -91.33333333333333 236.0 -88.0 curveto
236.0 -72.5999984741211 lineto
236.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
144.0 -390.0 moveto
141.33333333333334 -390.0 140.0 -392.0 140.0 -396.0 curveto
140.0 -410.0 lineto
252.0 -410.0 lineto
252.0 -396.0 lineto
252.0 -392.0 250.66666666666666 -390.0 248.0 -390.0 curveto
144.0 -390.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
144.0 -390.0 moveto
141.33333333333334 -390.0 140.0 -392.0 140.0 -396.0 curveto
140.0 -410.0 lineto
252.0 -410.0 lineto
252.0 -396.0 lineto
252.0 -392.0 250.66666666666666 -390.0 248.0 -390.0 curveto
144.0 -390.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -413.0 moveto
140.0 -454.0 lineto
252.0 -454.0 lineto
252.0 -413.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -413.0 moveto
140.0 -454.0 lineto
252.0 -454.0 lineto
252.0 -413.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -457.0 moveto
140.0 -473.0 lineto
140.0 -476.3333333333333 141.33333333333334 -478.0 144.0 -478.0 curveto
248.0 -478.0 lineto
248.0 -478.0 lineto
250.66666666666666 -478.0 252.0 -476.3333333333333 252.0 -473.0 curveto
252.0 -457.6000061035156 lineto
252.0 -457.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -457.0 moveto
140.0 -473.0 lineto
140.0 -476.3333333333333 141.33333333333334 -478.0 144.0 -478.0 curveto
248.0 -478.0 lineto
248.0 -478.0 lineto
250.66666666666666 -478.0 252.0 -476.3333333333333 252.0 -473.0 curveto
252.0 -457.6000061035156 lineto
252.0 -457.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -203.0 moveto
21.333333333333332 -203.0 20.0 -205.0 20.0 -209.0 curveto
20.0 -225.0 lineto
74.0 -225.0 lineto
74.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -203.0 moveto
21.333333333333332 -203.0 20.0 -205.0 20.0 -209.0 curveto
20.0 -225.0 lineto
74.0 -225.0 lineto
74.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
77.0 -203.0 moveto
77.0 -225.0 lineto
124.0 -225.0 lineto
124.0 -209.0 lineto
124.0 -205.0 122.66666666666667 -203.0 120.0 -203.0 curveto
77.5999984741211 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
77.0 -203.0 moveto
77.0 -225.0 lineto
124.0 -225.0 lineto
124.0 -209.0 lineto
124.0 -205.0 122.66666666666667 -203.0 120.0 -203.0 curveto
77.5999984741211 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -203.0 moveto
149.33333333333334 -203.0 148.0 -205.0 148.0 -209.0 curveto
148.0 -225.0 lineto
202.0 -225.0 lineto
202.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -203.0 moveto
149.33333333333334 -203.0 148.0 -205.0 148.0 -209.0 curveto
148.0 -225.0 lineto
202.0 -225.0 lineto
202.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
205.0 -203.0 moveto
205.0 -225.0 lineto
252.0 -225.0 lineto
252.0 -209.0 lineto
252.0 -205.0 250.66666666666666 -203.0 248.0 -203.0 curveto
205.60000610351562 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
205.0 -203.0 moveto
205.0 -225.0 lineto
252.0 -225.0 lineto
252.0 -209.0 lineto
252.0 -205.0 250.66666666666666 -203.0 248.0 -203.0 curveto
205.60000610351562 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -203.0 moveto
277.3333333333333 -203.0 276.0 -205.0 276.0 -209.0 curveto
276.0 -225.0 lineto
330.0 -225.0 lineto
330.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -203.0 moveto
277.3333333333333 -203.0 276.0 -205.0 276.0 -209.0 curveto
276.0 -225.0 lineto
330.0 -225.0 lineto
330.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
333.0 -203.0 moveto
333.0 -225.0 lineto
380.0 -225.0 lineto
380.0 -209.0 lineto
380.0 -205.0 378.6666666666667 -203.0 376.0 -203.0 curveto
333.6000061035156 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
333.0 -203.0 moveto
333.0 -225.0 lineto
380.0 -225.0 lineto
380.0 -209.0 lineto
380.0 -205.0 378.6666666666667 -203.0 376.0 -203.0 curveto
333.6000061035156 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -225.0 moveto
20.0 -267.0 lineto
124.0 -267.0 lineto
124.0 -225.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -225.0 moveto
20.0 -267.0 lineto
124.0 -267.0 lineto
124.0 -225.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -225.0 moveto
148.0 -267.0 lineto
252.0 -267.0 lineto
252.0 -225.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -225.0 moveto
148.0 -267.0 lineto
252.0 -267.0 lineto
252.0 -225.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -225.0 moveto
276.0 -267.0 lineto
380.0 -267.0 lineto
380.0 -225.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -225.0 moveto
276.0 -267.0 lineto
380.0 -267.0 lineto
380.0 -225.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -270.0 moveto
20.0 -286.0 lineto
20.0 -289.3333333333333 21.333333333333332 -291.0 24.0 -291.0 curveto
120.0 -291.0 lineto
120.0 -291.0 lineto
122.66666666666667 -291.0 124.0 -289.3333333333333 124.0 -286.0 curveto
124.0 -270.6000061035156 lineto
124.0 -270.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -270.0 moveto
20.0 -286.0 lineto
20.0 -289.3333333333333 21.333333333333332 -291.0 24.0 -291.0 curveto
120.0 -291.0 lineto
120.0 -291.0 lineto
122.66666666666667 -291.0 124.0 -289.3333333333333 124.0 -286.0 curveto
124.0 -270.6000061035156 lineto
124.0 -270.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -270.0 moveto
148.0 -286.0 lineto
148.0 -289.3333333333333 149.33333333333334 -291.0 152.0 -291.0 curveto
248.0 -291.0 lineto
248.0 -291.0 lineto
250.66666666666666 -291.0 252.0 -289.3333333333333 252.0 -286.0 curveto
252.0 -270.6000061035156 lineto
252.0 -270.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -270.0 moveto
148.0 -286.0 lineto
148.0 -289.3333333333333 149.33333333333334 -291.0 152.0 -291.0 curveto
248.0 -291.0 lineto
248.0 -291.0 lineto
250.66666666666666 -291.0 252.0 -289.3333333333333 252.0 -286.0 curveto
252.0 -270.6000061035156 lineto
252.0 -270.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -270.0 moveto
276.0 -286.0 lineto
276.0 -289.3333333333333 277.3333333333333 -291.0 280.0 -291.0 curveto
376.0 -291.0 lineto
376.0 -291.0 lineto
378.6666666666667 -291.0 380.0 -289.3333333333333 380.0 -286.0 curveto
380.0 -270.6000061035156 lineto
380.0 -270.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -270.0 moveto
276.0 -286.0 lineto
276.0 -289.3333333333333 277.3333333333333 -291.0 280.0 -291.0 curveto
376.0 -291.0 lineto
376.0 -291.0 lineto
378.6666666666667 -291.0 380.0 -289.3333333333333 380.0 -286.0 curveto
380.0 -270.6000061035156 lineto
380.0 -270.0 lineto
closepath
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
176.0 -159.0 moveto
104.0 -159.0 lineto
101.33333333333333 -159.0 100.0 -161.0 100.0 -165.0 curveto
100.0 -192.0 lineto
100.0 -192.0 lineto
stroke
newpath
48.0 -187.0 moveto
52.0 -198.0 lineto
56.0 -187.0 lineto
closepath
fill
newpath
96.0 -187.0 moveto
100.0 -198.0 lineto
104.0 -187.0 lineto
closepath
fill
newpath
176.0 -187.0 moveto
180.0 -198.0 lineto
184.0 -187.0 lineto
closepath
fill
newpath
224.0 -187.0 moveto
228.0 -198.0 lineto
232.0 -187.0 lineto
closepath
fill
newpath
304.0 -187.0 moveto
308.0 -198.0 lineto
312.0 -187.0 lineto
closepath
fill
newpath
352.0 -187.0 moveto
356.0 -198.0 lineto
360.0 -187.0 lineto
closepath
fill
newpath
192.0 -374.0 moveto
196.0 -385.0 lineto
200.0 -374.0 lineto
closepath
fill
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
188.0 -159.0 moveto
228.0 -159.0 lineto
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
300.0 -159.0 moveto
228.0 -159.0 lineto
stroke
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
228.0 -192.0 moveto
228.0 -159.0 lineto
stroke
newpath
180.0 -93.0 moveto
180.0 -137.0 lineto
stroke
newpath
52.0 -192.0 moveto
52.0 -137.0 lineto
180.0 -137.0 lineto
stroke
newpath
180.0 -192.0 moveto
180.0 -137.0 lineto
stroke
newpath
308.0 -192.0 moveto
308.0 -137.0 lineto
180.0 -137.0 lineto
stroke
newpath
316.0 -159.0 moveto
356.0 -159.0 lineto
stroke
newpath
356.0 -192.0 moveto
356.0 -159.0 lineto
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
196.0 -478.0 moveto
196.0 -517.0 lineto
196.0 -520.3333333333334 197.33333333333334 -522.0 200.0 -522.0 curveto
408.0 -522.0 lineto
408.0 -522.0 lineto
410.6666666666667 -522.0 412.0 -520.3333333333334 412.0 -517.0 curveto
412.0 -165.0 lineto
412.0 -165.0 lineto
412.0 -161.0 410.6666666666667 -159.0 408.0 -159.0 curveto
356.0 -159.0 lineto
356.0 -159.0 lineto
stroke
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
68.0 -291.0 moveto
68.0 -335.0 lineto
196.0 -335.0 lineto
stroke
newpath
196.0 -291.0 moveto
196.0 -335.0 lineto
stroke
newpath
324.0 -291.0 moveto
324.0 -335.0 lineto
196.0 -335.0 lineto
stroke
newpath
196.0 -379.0 moveto
196.0 -335.0 lineto
stroke
/Helvetica findfont
11 scalefont setfont
153.0 -54.0 moveto
(Ventilator) show
161.0 -87.0 moveto
(PUSH) show
163.0 -120.0 moveto
(tasks) show
35.0 -175.0 moveto
(task) show
163.0 -175.0 moveto
(task) show
299.0 -175.0 moveto
(task) show
33.0 -219.0 moveto
(PULL) show
89.0 -219.0 moveto
(SUB) show
161.0 -219.0 moveto
(PULL) show
217.0 -219.0 moveto
(SUB) show
289.0 -219.0 moveto
(PULL) show
345.0 -219.0 moveto
(SUB) show
49.0 -252.0 moveto
(Worker) show
177.0 -252.0 moveto
(Worker) show
305.0 -252.0 moveto
(Worker) show
57.0 -285.0 moveto
(PUSH) show
185.0 -285.0 moveto
(PUSH) show
313.0 -285.0 moveto
(PUSH) show
54.0 -318.0 moveto
(result) show
182.0 -318.0 moveto
(result) show
310.0 -318.0 moveto
(result) show
174.0 -362.0 moveto
(results) show
177.0 -406.0 moveto
(PULL) show
179.0 -439.0 moveto
(Sink) show
185.0 -472.0 moveto
(PUB) show
161.0 -505.0 moveto
(KILL signal) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4797 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4797 a 274 x Fj(Here)f(is)h(the)g(w)o(ork)o
(er)e(process,)g(which)h(manages)f(tw)o(o)i(sock)o(ets)f(\(a)g(PULL)h
(sock)o(et)f(getting)f(tasks,)i(and)e(a)i(SUB)g(sock)o(et)p
Black 3800 5569 a Fi(58)p Black eop end
%%Page: 59 73
TeXDict begin 59 72 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.59) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(getting)20 b(control)f(commands\))f
(using)h(the)i Fg(zmq-poll[3])e Fj(technique)f(we)j(sa)o(w)f(earlier:)
-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:taskwork2-php) cvn /DEST pdfmark
end
 -2 90 a 396 274
a Fk(Example)h(2-8.)e(P)o(arallel)g(task)i(w)o(ork)o(er)f(with)h(kill)g
(signaling)f(\(taskw)o(ork2.php\))-2 374 y
SDict begin H.S end
 -2 374 a -2
374 a
SDict begin 11.7 H.A end
 -2 374 a -2 374 a
SDict begin [/View [/XYZ H.V]/Dest (0:948) cvn /DEST pdfmark end
 -2 374 a 396 454 a Fg(<?php)396
551 y(/)441 564 y(*)441 661 y(*)576 648 y(Task)44 b(worker)g(-)g
(design)g(2)441 758 y(*)576 745 y(Adds)g(pub-sub)f(flow)i(to)f(receive)
g(and)g(respond)g(to)g(kill)g(signal)441 856 y(*)531
843 y(@author)f(Ian)i(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)
441 953 y(*)486 940 y(/)396 1134 y($context)g(=)g(new)h
(ZMQContext\(\);)396 1328 y(//)90 b(Socket)43 b(to)i(receive)f
(messages)f(on)396 1425 y($receiver)h(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PULL\);)396 1522 y
($receiver->connect\("tcp://localhost:5557")o(\);)396
1717 y(//)90 b(Socket)43 b(to)i(send)f(messages)g(to)396
1814 y($sender)g(=)h(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_PUSH\);)
396 1911 y($sender->connect\("tcp://localhost:5558"\);)396
2105 y(//)90 b(Socket)43 b(for)i(control)e(input)396
2202 y($controller)g(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_SUB\);)396 2300 y
($controller->connect\("tcp://localhost:555)o(9"\);)396
2397 y($controller->setSockOpt\(ZMQ::SOCKOPT_SUBS)o(CRIBE,)c(""\);)396
2591 y(//)90 b(Process)43 b(messages)h(from)g(receiver)f(and)i
(controller)396 2688 y($poll)f(=)h(new)f(ZMQPoll\(\);)396
2785 y($poll->add\($receiver,)e(ZMQ::POLL_IN\);)396 2882
y($poll->add\($controller,)f(ZMQ::POLL_IN\);)396 2979
y($readable)j(=)g($writeable)f(=)i(array\(\);)396 3174
y(//)90 b(Process)43 b(messages)h(from)g(both)g(sockets)396
3271 y(while)g(\(true\))g({)441 3368 y($events)g(=)g
($poll->poll\($readable,)e($writeable\);)441 3465 y(if\($events)h(>)i
(0\))f({)486 3562 y(foreach\($readable)e(as)i($socket\))g({)531
3659 y(if\($socket)f(===)h($receiver\))f({)576 3757 y($message)g(=)i
($socket->recv\(\);)576 3854 y(//)89 b(Simple)44 b(progress)f
(indicator)h(for)g(the)g(viewer)576 3951 y(echo)g($message,)f(PHP_EOL;)
576 4145 y(//)89 b(Do)44 b(the)h(work)576 4242 y(usleep\($message)1293
4255 y(*)1383 4242 y(1000\);)665 4437 y(//)90 b(Send)44
b(results)f(to)i(sink)576 4534 y($sender->send\(""\);)531
4631 y(})531 4728 y(//)89 b(Any)44 b(waiting)g(controller)f(command)h
(acts)g(as)h('KILL')531 4825 y(else)f(if\($socket)f(===)h
($controller\))f({)576 4922 y(exit\(\);)531 5019 y(})486
5116 y(})p Black 3800 5569 a Fi(59)p Black eop end
%%Page: 60 74
TeXDict begin 60 73 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.60) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 441 72 a Fg(})-2 247 y
SDict begin H.S end
 -2 247 a -2
247 a
SDict begin 13 H.A end
 -2 247 a -2 247 a
SDict begin [/View [/XYZ H.V]/Dest (0:949) cvn /DEST pdfmark end
 -2 247 a 396 346 a Fj(Here)20
b(is)h(the)g(modi\002ed)e(sink)h(application.)e(When)i(it')-5
b(s)22 b(\002nished)d(collecting)g(results)i(it)g(broadcasts)e(a)i
(kill)f(message)g(to)396 454 y(all)h(w)o(ork)o(ers:)-2
455 y
SDict begin H.S end
 -2 455 a -2 455 a
SDict begin 13 H.A end
 -2 455 a -2 455 a
SDict begin [/View [/XYZ H.V]/Dest (0:tasksink2-php) cvn /DEST pdfmark
end
 -2 455 a 396
656 a Fk(Example)g(2-9.)e(P)o(arallel)g(task)i(sink)g(with)g(kill)g
(signaling)f(\(tasksink2.php\))-2 756 y
SDict begin H.S end
 -2 756 a -2 756
a
SDict begin 11.7 H.A end
 -2 756 a -2 756 a
SDict begin [/View [/XYZ H.V]/Dest (0:952) cvn /DEST pdfmark end
 -2 756 a 396 836 a Fg(<?php)396 933
y(/)441 946 y(*)441 1043 y(*)576 1030 y(Task)44 b(design)g(2)441
1140 y(*)576 1127 y(Adds)g(pub-sub)f(flow)i(to)f(send)g(kill)g(signal)g
(to)h(workers)441 1237 y(*)531 1224 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1335 y(*)486
1322 y(/)396 1516 y($context)g(=)g(new)h(ZMQContext\(\);)396
1710 y(//)90 b(Socket)43 b(to)i(receive)f(messages)f(on)396
1807 y($receiver)h(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PULL\);)396 1904 y($receiver->bind\("tcp://)1431
1917 y(*)1476 1904 y(:5558"\);)396 2099 y(//)90 b(Socket)43
b(for)i(worker)f(control)396 2196 y($controller)f(=)i(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_PUB\);)396 2293 y
($controller->bind\("tcp://)1521 2306 y(*)1566 2293 y(:5559"\);)396
2487 y(//)90 b(Wait)44 b(for)g(start)g(of)h(batch)396
2584 y($string)f(=)h($receiver->recv\(\);)396 2779 y(//)90
b(Process)43 b(100)i(confirmations)396 2876 y($tstart)f(=)h
(microtime\(true\);)396 2973 y($total_msec)e(=)i(0;)224
b(//)89 b(Total)44 b(calculated)f(cost)h(in)h(msecs)396
3070 y(for)g(\($task_nbr)e(=)h(0;)h($task_nbr)e(<)i(100;)f
($task_nbr++\))f({)441 3167 y($string)h(=)g($receiver->recv\(\);)441
3361 y(if\($task_nbr)f(\045)i(10)f(==)h(0\))f({)486 3459
y(echo)g(":";)441 3556 y(})h(else)f({)486 3653 y(echo)g(".";)441
3750 y(})396 3847 y(})396 4041 y($tend)g(=)h(microtime\(true\);)396
4236 y($total_msec)e(=)i(\($tend)f(-)g($tstart\))1831
4249 y(*)1921 4236 y(1000;)396 4333 y(echo)g(PHP_EOL;)396
4430 y(printf)g(\("Total)g(elapsed)f(time:)h(\045d)h(msec",)f
($total_msec\);)396 4527 y(echo)g(PHP_EOL;)396 4721 y(//)90
b(Send)44 b(kill)g(signal)g(to)g(workers)396 4818 y
($controller->send\("KILL"\);)396 5013 y(//)90 b(Finished)396
5110 y(sleep)44 b(\(1\);)627 b(//)90 b(Give)44 b(0MQ)g(time)g(to)h
(deliver)p Black 3800 5569 a Fi(60)p Black eop end
%%Page: 61 75
TeXDict begin 61 74 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.61) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:953) cvn /DEST pdfmark end
 -2 -11 a 105 x Fh(2.4.)39 b(Handling)f(Interrupt)f(Signals)
2072 94 y
SDict begin H.S end
 2072 94 a 2072 94 a
SDict begin 22.464 H.A end
 2072 94 a 2072 94 a
SDict begin [/View [/XYZ H.V]/Dest (7.22.1) cvn /DEST pdfmark end
 2072
94 a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2 292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:955) cvn /DEST pdfmark end
 -2
292 a 396 368 a Fj(Realistic)22 b(applications)d(need)g(to)h(shut)h(do)
n(wn)e(cleanly)g(when)h(interrupted)e(with)i(Ctrl-C)h(or)f(another)f
(signal)h(such)g(as)396 476 y(SIGTERM.)g(By)h(def)o(ault,)e(these)h
(simply)g(kill)h(the)f(process,)f(meaning)g(messages)h(w)o(on')o(t)g
(be)g(\003ushed,)f(\002les)i(w)o(on')o(t)e(be)396 584
y(closed)h(cleanly)-5 b(,)19 b(etc.)-2 768 y
SDict begin H.S end
 -2 768 a
-2 768 a
SDict begin 13 H.A end
 -2 768 a -2 768 a
SDict begin [/View [/XYZ H.V]/Dest (0:956) cvn /DEST pdfmark end
 -2 768 a 396 858 a Fj(Here)h(is)h(ho)n(w)f
(we)h(handle)e(a)h(signal)g(in)h(v)n(arious)e(languages:)-2
876 y
SDict begin H.S end
 -2 876 a -2 876 a
SDict begin 13 H.A end
 -2 876 a -2 876 a
SDict begin [/View [/XYZ H.V]/Dest (0:interrupt-php) cvn /DEST pdfmark
end
 -2 876 a 396
1059 a Fk(Example)i(2-10.)d(Handling)i(Ctrl-C)g(cleanly)g
(\(interrupt.php\))-2 1159 y
SDict begin H.S end
 -2 1159 a -2 1159 a
SDict begin 11.7 H.A end
 -2 1159
a -2 1159 a
SDict begin [/View [/XYZ H.V]/Dest (0:959) cvn /DEST pdfmark end
 -2 1159 a 396 1239 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 1417 y
SDict begin H.S end
 -2 1417
a -2 1417 a
SDict begin 13 H.A end
 -2 1417 a -2 1417 a
SDict begin [/View [/XYZ H.V]/Dest (0:960) cvn /DEST pdfmark end
 -2 1417 a 396 1513 a
Fj(The)20 b(program)e(pro)o(vides)1154 1513 y
SDict begin H.S end
 1154 1513
a 1154 1513 a
SDict begin 13 H.A end
 1154 1513 a 1154 1513 a
SDict begin [/View [/XYZ H.V]/Dest (0:961) cvn /DEST pdfmark end
 1154 1513 a Fg
(s-catch-signals\(\))p Fj(,)f(which)j(traps)g(Ctrl-C)h(\()2624
1513 y
SDict begin H.S end
 2624 1513 a 2624 1513 a
SDict begin 13 H.A end
 2624 1513 a 2624 1513
a
SDict begin [/View [/XYZ H.V]/Dest (0:962) cvn /DEST pdfmark end
 2624 1513 a Fg(SIGINT)p Fj(\))e(and)3082 1513 y
SDict begin H.S end
 3082
1513 a 3082 1513 a
SDict begin 13 H.A end
 3082 1513 a 3082 1513 a
SDict begin [/View [/XYZ H.V]/Dest (0:963) cvn /DEST pdfmark end
 3082 1513
a Fg(SIGTERM)p Fj(.)g(When)h(either)396 1621 y(of)g(these)h(signals)f
(arri)n(v)o(e,)f(the)1283 1621 y
SDict begin H.S end
 1283 1621 a 1283 1621
a
SDict begin 13 H.A end
 1283 1621 a 1283 1621 a
SDict begin [/View [/XYZ H.V]/Dest (0:964) cvn /DEST pdfmark end
 1283 1621 a Fg(s-catch-signals\(\))f
Fj(handler)h(sets)i(the)f(global)f(v)n(ariable)3117 1621
y
SDict begin H.S end
 3117 1621 a 3117 1621 a
SDict begin 13 H.A end
 3117 1621 a 3117 1621 a
SDict begin [/View [/XYZ H.V]/Dest (0:965) cvn /DEST pdfmark end
 3117
1621 a Fg(s-interrupted)p Fj(.)396 1729 y(Thanks)g(to)i(your)e(signal)h
(handler)m(,)e(your)h(application)g(will)i(not)e(die)i(automatically)-5
b(.)18 b(Instead,)h(you)g(ha)n(v)o(e)h(a)g(chance)g(to)396
1837 y(clean)g(up)f(and)h(e)o(xit)f(gracefully)-5 b(.)18
b(Y)-9 b(ou)19 b(ha)n(v)o(e)g(to)h(no)n(w)f(e)o(xplicitly)g(check)g
(for)g(an)h(interrupt,)e(and)h(handle)g(it)i(properly)-5
b(.)17 b(Do)396 1945 y(this)k(by)f(calling)887 1945 y
SDict begin H.S end

887 1945 a 887 1945 a
SDict begin 13 H.A end
 887 1945 a 887 1945 a
SDict begin [/View [/XYZ H.V]/Dest (0:966) cvn /DEST pdfmark end
 887 1945
a Fg(s-catch-signals\(\))e Fj(\(cop)o(y)h(this)i(from)2202
1945 y
SDict begin H.S end
 2202 1945 a 2202 1945 a
SDict begin 13 H.A end
 2202 1945 a 2202 1945
a
SDict begin [/View [/XYZ H.V]/Dest (0:967) cvn /DEST pdfmark end
 2202 1945 a Fg(interrupt.c)p Fj(\))e(at)h(the)h(start)f(of)g(your)f
(main)h(code.)396 2053 y(This)h(sets-up)f(the)g(signal)g(handling.)e
(The)i(interrupt)f(will)h(af)n(fect)g(\330MQ)h(calls)f(as)h(follo)n
(ws:)-2 2071 y
SDict begin H.S end
 -2 2071 a -2 2071 a
SDict begin 13 H.A end
 -2 2071 a -2 2071
a
SDict begin [/View [/XYZ H.V]/Dest (0:968) cvn /DEST pdfmark end
 -2 2071 a -2 2081 a
SDict begin H.S end
 -2 2081 a -2 2081 a
SDict begin 13 H.A end
 -2 2081 a -2
2081 a
SDict begin [/View [/XYZ H.V]/Dest (0:969) cvn /DEST pdfmark end
 -2 2081 a Black 396 2223 a Fe(\225)p Black 479
2223 a
SDict begin H.S end
 479 2223 a 479 2223 a
SDict begin 13 H.A end
 479 2223 a 479 2223 a
SDict begin [/View [/XYZ H.V]/Dest (0:970) cvn /DEST pdfmark end
 479
2223 a Fj(If)f(your)f(code)g(is)h(blocking)e(in)1376
2223 y
SDict begin H.S end
 1376 2223 a 1376 2223 a
SDict begin 13 H.A end
 1376 2223 a 1376 2223
a
SDict begin [/View [/XYZ H.V]/Dest (0:971) cvn /DEST pdfmark end
 1376 2223 a Fg(zmq-msg-recv[3])p Fj(,)2090 2223 y
SDict begin H.S end
 2090
2223 a 2090 2223 a
SDict begin 13 H.A end
 2090 2223 a 2090 2223 a
SDict begin [/View [/XYZ H.V]/Dest (0:972) cvn /DEST pdfmark end
 2090 2223
a Fg(zmq-poll[3])p Fj(,)g(or)2714 2223 y
SDict begin H.S end
 2714 2223 a
2714 2223 a
SDict begin 13 H.A end
 2714 2223 a 2714 2223 a
SDict begin [/View [/XYZ H.V]/Dest (0:973) cvn /DEST pdfmark end
 2714 2223 a Fg(zmq-msg-send[3])p
Fj(,)f(when)j(a)g(signal)479 2331 y(arri)n(v)o(es,)f(the)i(call)f(will)
h(return)e(with)1544 2331 y
SDict begin H.S end
 1544 2331 a 1544 2331 a
SDict begin 13 H.A end
 1544
2331 a 1544 2331 a
SDict begin [/View [/XYZ H.V]/Dest (0:974) cvn /DEST pdfmark end
 1544 2331 a Fg(EINTR)p Fj(.)-2 2343
y
SDict begin H.S end
 -2 2343 a -2 2343 a
SDict begin 13 H.A end
 -2 2343 a -2 2343 a
SDict begin [/View [/XYZ H.V]/Dest (0:975) cvn /DEST pdfmark end
 -2 2343 a Black
396 2481 a Fe(\225)p Black 479 2481 a
SDict begin H.S end
 479 2481 a 479
2481 a
SDict begin 13 H.A end
 479 2481 a 479 2481 a
SDict begin [/View [/XYZ H.V]/Dest (0:976) cvn /DEST pdfmark end
 479 2481 a Fj(Wrappers)h(lik)o(e)967
2481 y
SDict begin H.S end
 967 2481 a 967 2481 a
SDict begin 13 H.A end
 967 2481 a 967 2481 a
SDict begin [/View [/XYZ H.V]/Dest (0:977) cvn /DEST pdfmark end
 967
2481 a Fg(s-recv\(\))g Fj(return)f(NULL)h(if)g(the)o(y)g(are)g
(interrupted.)-2 2665 y
SDict begin H.S end
 -2 2665 a -2 2665 a
SDict begin 13 H.A end
 -2 2665 a
-2 2665 a
SDict begin [/View [/XYZ H.V]/Dest (0:978) cvn /DEST pdfmark end
 -2 2665 a 396 2755 a Fj(So)h(check)e(for)h(an)936
2755 y
SDict begin H.S end
 936 2755 a 936 2755 a
SDict begin 13 H.A end
 936 2755 a 936 2755 a
SDict begin [/View [/XYZ H.V]/Dest (0:979) cvn /DEST pdfmark end
 936
2755 a Fg(EINTR)g Fj(return)f(code,)g(a)i(NULL)f(return,)e(and/or)2370
2755 y
SDict begin H.S end
 2370 2755 a 2370 2755 a
SDict begin 13 H.A end
 2370 2755 a 2370 2755
a
SDict begin [/View [/XYZ H.V]/Dest (0:980) cvn /DEST pdfmark end
 2370 2755 a Fg(s-interrupted)p Fj(.)-2 2933 y
SDict begin H.S end
 -2 2933
a -2 2933 a
SDict begin 13 H.A end
 -2 2933 a -2 2933 a
SDict begin [/View [/XYZ H.V]/Dest (0:981) cvn /DEST pdfmark end
 -2 2933 a 396 3029 a
Fj(Here)i(is)h(a)g(typical)f(code)f(fragment:)-2 3130
y
SDict begin H.S end
 -2 3130 a -2 3130 a
SDict begin 11.7 H.A end
 -2 3130 a -2 3130 a
SDict begin [/View [/XYZ H.V]/Dest (0:982) cvn /DEST pdfmark end
 -2 3130 a 396
3209 a Fg(s-catch-signals)43 b(\(\);)396 3306 y(client)h(=)h
(zmq-socket)e(\(...\);)396 3403 y(while)h(\(!s-interrupted\))e({)576
3500 y(char)800 3513 y(*)845 3500 y(message)h(=)i(s-recv)f(\(client\);)
576 3597 y(if)g(\(!message\))755 3694 y(break;)447 b(//)90
b(Ctrl-C)43 b(used)396 3791 y(})396 3889 y(zmq-close)h(\(client\);)-2
4066 y
SDict begin H.S end
 -2 4066 a -2 4066 a
SDict begin 13 H.A end
 -2 4066 a -2 4066 a
SDict begin [/View [/XYZ H.V]/Dest (0:983) cvn /DEST pdfmark end
 -2 4066
a 396 4163 a Fj(If)20 b(you)g(call)758 4163 y
SDict begin H.S end
 758 4163
a 758 4163 a
SDict begin 13 H.A end
 758 4163 a 758 4163 a
SDict begin [/View [/XYZ H.V]/Dest (0:984) cvn /DEST pdfmark end
 758 4163 a Fg(s-catch-signals\(\))e
Fj(and)i(don')o(t)e(test)j(for)f(interrupts,)f(the)h(your)f
(application)f(will)j(become)e(immune)396 4271 y(to)i(Ctrl-C)g(and)e
(SIGTERM,)h(which)g(may)f(be)i(useful,)e(b)n(ut)h(is)h(usually)f(not.)
-2 4299 y
SDict begin H.S end
 -2 4299 a -2 4299 a
SDict begin 13 H.A end
 -2 4299 a -2 4299 a
SDict begin [/View [/XYZ H.V]/Dest (0:985) cvn /DEST pdfmark end
 -2
4299 a 359 x Fh(2.5.)39 b(Detecting)e(Memor)q(y)i(Leaks)1970
4658 y
SDict begin H.S end
 1970 4658 a 1970 4658 a
SDict begin 22.464 H.A end
 1970 4658 a 1970 4658
a
SDict begin [/View [/XYZ H.V]/Dest (7.23.1) cvn /DEST pdfmark end
 1970 4658 a -2 4856 a
SDict begin H.S end
 -2 4856 a -2 4856 a
SDict begin 13 H.A end
 -2 4856 a
-2 4856 a
SDict begin [/View [/XYZ H.V]/Dest (0:987) cvn /DEST pdfmark end
 -2 4856 a 396 4932 a Fj(An)o(y)20 b(long-running)c
(application)j(has)h(to)h(manage)d(memory)h(correctly)-5
b(,)18 b(or)i(e)n(v)o(entually)e(it')o(ll)j(use)g(up)e(all)i(a)n(v)n
(ailable)396 5040 y(memory)e(and)g(crash.)h(If)g(you)f(use)i(a)f
(language)f(that)h(handles)g(this)g(automatically)f(for)h(you,)f
(congratulations.)e(If)j(you)p Black 3800 5569 a Fi(61)p
Black eop end
%%Page: 62 76
TeXDict begin 62 75 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.62) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1010) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(program)18 b(in)j(C)g(or)f(C++)g(or)g(an)
o(y)g(other)f(language)g(where)g(you')l(re)f(responsible)h(for)h
(memory)e(management,)g(here')-5 b(s)20 b(a)396 180 y(short)g(tutorial)
g(on)f(using)h(v)n(algrind,)e(which)i(among)f(other)g(things)h(will)h
(report)e(on)g(an)o(y)h(leaks)g(your)f(programs)f(ha)n(v)o(e.)-2
198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:988) cvn /DEST pdfmark end
 -2 198 a -2
208 a
SDict begin H.S end
 -2 208 a -2 208 a
SDict begin 13 H.A end
 -2 208 a -2 208 a
SDict begin [/View [/XYZ H.V]/Dest (0:989) cvn /DEST pdfmark end
 -2 208 a Black
396 351 a Fe(\225)p Black 479 351 a
SDict begin H.S end
 479 351 a 479 351
a
SDict begin 13 H.A end
 479 351 a 479 351 a
SDict begin [/View [/XYZ H.V]/Dest (0:990) cvn /DEST pdfmark end
 479 351 a Fj(T)-7 b(o)21 b(install)f(v)n
(algrind,)f(e.g.)g(on)h(Ub)n(untu)f(or)h(Debian)g(issue:)-2
452 y
SDict begin H.S end
 -2 452 a -2 452 a
SDict begin 11.7 H.A end
 -2 452 a -2 452 a
SDict begin [/View [/XYZ H.V]/Dest (0:991) cvn /DEST pdfmark end
 -2 452 a 396
531 a Fg(sudo)44 b(apt-get)g(install)g(valgrind)-2 543
y
SDict begin H.S end
 -2 543 a -2 543 a
SDict begin 13 H.A end
 -2 543 a -2 543 a
SDict begin [/View [/XYZ H.V]/Dest (0:992) cvn /DEST pdfmark end
 -2 543 a -2 625
a
SDict begin H.S end
 -2 625 a -2 625 a
SDict begin 13 H.A end
 -2 625 a -2 625 a
SDict begin [/View [/XYZ H.V]/Dest (0:993) cvn /DEST pdfmark end
 -2 625 a Black
396 888 a Fe(\225)p Black 479 888 a
SDict begin H.S end
 479 888 a 479 888
a
SDict begin 13 H.A end
 479 888 a 479 888 a
SDict begin [/View [/XYZ H.V]/Dest (0:994) cvn /DEST pdfmark end
 479 888 a Fj(By)21 b(def)o(ault,)e(\330MQ)i(will)
g(cause)f(v)n(algrind)e(to)i(complain)f(a)i(lot.)f(T)-7
b(o)20 b(remo)o(v)o(e)f(these)h(w)o(arnings,)f(create)h(a)h(\002le)f
(called)479 996 y
SDict begin H.S end
 479 996 a 479 996 a
SDict begin 13 H.A end
 479 996 a 479 996
a
SDict begin [/View [/XYZ H.V]/Dest (0:995) cvn /DEST pdfmark end
 479 996 a Fg(valgrind.supp)f Fj(that)h(contains)g(this:)-2
1090 y
SDict begin H.S end
 -2 1090 a -2 1090 a
SDict begin 11.7 H.A end
 -2 1090 a -2 1090 a
SDict begin [/View [/XYZ H.V]/Dest (0:996) cvn /DEST pdfmark end
 -2 1090
a 396 1176 a Fg({)531 1273 y(<socketcall-sendto>)531
1370 y(Memcheck:Param)531 1467 y(socketcall.sendto\(msg\))531
1564 y(fun:send)531 1662 y(...)396 1759 y(})396 1856
y({)531 1953 y(<socketcall-sendto>)531 2050 y(Memcheck:Param)531
2147 y(socketcall.send\(msg\))531 2244 y(fun:send)531
2341 y(...)396 2439 y(})-2 2447 y
SDict begin H.S end
 -2 2447 a -2 2447 a
SDict begin 13 H.A end

-2 2447 a -2 2447 a
SDict begin [/View [/XYZ H.V]/Dest (0:997) cvn /DEST pdfmark end
 -2 2447 a -2 2530 a
SDict begin H.S end
 -2 2530 a -2
2530 a
SDict begin 13 H.A end
 -2 2530 a -2 2530 a
SDict begin [/View [/XYZ H.V]/Dest (0:998) cvn /DEST pdfmark end
 -2 2530 a Black 396 2796 a
Fe(\225)p Black 479 2796 a
SDict begin H.S end
 479 2796 a 479 2796 a
SDict begin 13 H.A end
 479
2796 a 479 2796 a
SDict begin [/View [/XYZ H.V]/Dest (0:999) cvn /DEST pdfmark end
 479 2796 a Fj(Fix)h(your)e(applications)g(to)h(e)o
(xit)g(cleanly)g(after)f(Ctrl-C.)i(F)o(or)f(an)o(y)f(application)g
(that)h(e)o(xits)h(by)f(itself,)g(that')-5 b(s)21 b(not)479
2904 y(needed,)e(b)n(ut)h(for)g(long-running)c(applications,)j(this)h
(is)i(essential,)e(otherwise)g(v)n(algrind)e(will)j(complain)e(about)g
(all)479 3011 y(currently)g(allocated)g(memory)-5 b(.)-2
3029 y
SDict begin H.S end
 -2 3029 a -2 3029 a
SDict begin 13 H.A end
 -2 3029 a -2 3029 a
SDict begin [/View [/XYZ H.V]/Dest (0:1000) cvn /DEST pdfmark end
 -2 3029
a Black 396 3161 a Fe(\225)p Black 479 3161 a
SDict begin H.S end
 479 3161
a 479 3161 a
SDict begin 13 H.A end
 479 3161 a 479 3161 a
SDict begin [/View [/XYZ H.V]/Dest (0:1001) cvn /DEST pdfmark end
 479 3161 a Fj(Build)21
b(your)e(application)f(with)j(-DDEB)o(UG,)f(if)g(it')-5
b(s)22 b(not)d(your)g(def)o(ault)h(setting.)g(That)g(ensures)f(v)n
(algrind)g(can)h(tell)479 3269 y(you)g(e)o(xactly)f(where)g(memory)g
(is)i(being)e(leak)o(ed.)-2 3287 y
SDict begin H.S end
 -2 3287 a -2 3287
a
SDict begin 13 H.A end
 -2 3287 a -2 3287 a
SDict begin [/View [/XYZ H.V]/Dest (0:1002) cvn /DEST pdfmark end
 -2 3287 a Black 396 3418 a Fe(\225)p
Black 479 3418 a
SDict begin H.S end
 479 3418 a 479 3418 a
SDict begin 13 H.A end
 479 3418 a 479
3418 a
SDict begin [/View [/XYZ H.V]/Dest (0:1003) cvn /DEST pdfmark end
 479 3418 a Fj(Finally)-5 b(,)20 b(run)f(v)n(algrind)f(thus:)-2
3519 y
SDict begin H.S end
 -2 3519 a -2 3519 a
SDict begin 11.7 H.A end
 -2 3519 a -2 3519 a
SDict begin [/View [/XYZ H.V]/Dest (0:1004) cvn /DEST pdfmark end
 -2 3519
a 396 3598 a Fg(valgrind)44 b(--tool=memcheck)e(--leak-check=full)g
(--suppressions=valgrind.supp)e(someprog)-2 3776 y
SDict begin H.S end
 -2
3776 a -2 3776 a
SDict begin 13 H.A end
 -2 3776 a -2 3776 a
SDict begin [/View [/XYZ H.V]/Dest (0:1005) cvn /DEST pdfmark end
 -2 3776 a 396 3872
a Fj(And)20 b(after)g(\002xing)f(an)o(y)h(errors)f(it)i(reported,)d
(you)h(should)h(get)g(the)g(pleasant)g(message:)-2 3973
y
SDict begin H.S end
 -2 3973 a -2 3973 a
SDict begin 11.7 H.A end
 -2 3973 a -2 3973 a
SDict begin [/View [/XYZ H.V]/Dest (0:1006) cvn /DEST pdfmark end
 -2 3973 a 396
4053 a Fg(==30536==)44 b(ERROR)g(SUMMARY:)f(0)i(errors)f(from)g(0)g
(contexts...)-2 4137 y
SDict begin H.S end
 -2 4137 a -2 4137 a
SDict begin 13 H.A end
 -2 4137 a
-2 4137 a
SDict begin [/View [/XYZ H.V]/Dest (0:1007) cvn /DEST pdfmark end
 -2 4137 a 376 x Fh(2.6.)39 b(Multithreading)d(with)j(\330MQ)
1976 4513 y
SDict begin H.S end
 1976 4513 a 1976 4513 a
SDict begin 22.464 H.A end
 1976 4513 a 1976
4513 a
SDict begin [/View [/XYZ H.V]/Dest (7.24.1) cvn /DEST pdfmark end
 1976 4513 a -2 4711 a
SDict begin H.S end
 -2 4711 a -2 4711 a
SDict begin 13 H.A end
 -2 4711
a -2 4711 a
SDict begin [/View [/XYZ H.V]/Dest (0:1009) cvn /DEST pdfmark end
 -2 4711 a 396 4787 a Fj(\330MQ)21 b(is)g(perhaps)e(the)h
(nicest)g(w)o(ay)h(e)n(v)o(er)e(to)h(write)h(multithreaded)d(\(MT\))h
(applications.)g(Whereas)h(as)h(\330MQ)f(sock)o(ets)396
4895 y(require)f(some)h(readjustment)f(if)h(you)g(are)g(used)g(to)g
(traditional)f(sock)o(ets,)h(\330MQ)h(multithreading)c(will)k(tak)o(e)
396 5003 y(e)n(v)o(erything)d(you)h(kno)n(w)g(about)g(writing)h(MT)g
(applications,)f(thro)n(w)g(it)i(into)f(a)h(heap)e(in)i(the)f(garden,)e
(pour)h(gasoline)p Black 3800 5569 a Fi(62)p Black eop
end
%%Page: 63 77
TeXDict begin 63 76 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.63) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(o)o(v)o(er)19 b(it,)i(and)e(set)i(it)g
(alight.)f(It')-5 b(s)21 b(a)f(rare)g(book)f(that)h(deserv)o(es)g(b)n
(urning,)e(b)n(ut)i(most)g(books)f(on)h(concurrent)396
180 y(programming)d(do.)396 454 y(T)-7 b(o)21 b(mak)o(e)e(utterly)h
(perfect)f(MT)h(programs)f(\(and)g(I)h(mean)g(that)g(literally\))g
Fk(we)h(don't)e(need)i(mutexes,)f(locks,)h(or)f(any)396
562 y(other)g(f)n(orm)g(of)g(inter)m(-thr)o(ead)e(communication)i
(except)g(messages)g(sent)h(acr)o(oss)f(\330MQ)g(sock)o(ets.)-2
745 y
SDict begin H.S end
 -2 745 a -2 745 a
SDict begin 13 H.A end
 -2 745 a -2 745 a
SDict begin [/View [/XYZ H.V]/Dest (0:1012) cvn /DEST pdfmark end
 -2 745 a 396
836 a Fj(By)h("perfect")e(MT)h(programs)e(I)j(mean)e(code)h(that')-5
b(s)21 b(easy)f(to)g(write)h(and)e(understand,)f(that)i(w)o(orks)g
(with)h(the)f(same)396 944 y(design)g(approach)e(in)i(an)o(y)g
(programming)c(language,)i(and)i(on)g(an)o(y)f(operating)g(system,)h
(and)f(that)i(scales)g(across)f(an)o(y)396 1052 y(number)f(of)h(CPUs)h
(with)f(zero)g(w)o(ait)h(states)g(and)f(no)g(point)f(of)h(diminishing)e
(returns.)-2 1236 y
SDict begin H.S end
 -2 1236 a -2 1236 a
SDict begin 13 H.A end
 -2 1236 a -2
1236 a
SDict begin [/View [/XYZ H.V]/Dest (0:1013) cvn /DEST pdfmark end
 -2 1236 a 396 1326 a Fj(If)i(you')l(v)o(e)e(spent)i(years)g
(learning)f(tricks)h(to)h(mak)o(e)e(your)g(MT)i(code)e(w)o(ork)h(at)g
(all,)h(let)g(alone)e(rapidly)-5 b(,)18 b(with)j(locks)f(and)396
1434 y(semaphores)f(and)h(critical)g(sections,)g(you)f(will)i(be)f
(disgusted)g(when)f(you)h(realize)g(it)g(w)o(as)h(all)g(for)f(nothing.)
e(If)i(there')-5 b(s)396 1542 y(one)20 b(lesson)g(we')l(v)o(e)f
(learned)g(from)h(30+)f(years)h(of)g(concurrent)e(programming)f(it)j
(is:)2882 1542 y
SDict begin H.S end
 2882 1542 a 2882 1542 a
SDict begin 13 H.A end
 2882 1542 a
2882 1542 a
SDict begin [/View [/XYZ H.V]/Dest (0:1014) cvn /DEST pdfmark end
 2882 1542 a Fi(just)g(don')n(t)f(shar)m(e)h(state)p
Fj(.)g(It')-5 b(s)21 b(lik)o(e)396 1650 y(tw)o(o)g(drunkards)c(trying)j
(to)g(share)g(a)g(beer)-5 b(.)20 b(It)h(doesn')o(t)d(matter)i(if)h(the)
o(y')l(re)d(good)h(b)n(uddies.)g(Sooner)g(or)h(later)g(the)o(y')l(re)
396 1758 y(going)e(to)i(get)f(into)g(a)h(\002ght.)f(And)g(the)h(more)e
(drunkards)f(you)i(add)g(to)g(the)g(table,)h(the)f(more)g(the)o(y)f
(\002ght)i(each)f(other)f(o)o(v)o(er)396 1866 y(the)i(beer)-5
b(.)20 b(The)g(tragic)g(majority)f(of)h(MT)g(applications)f(look)h(lik)
o(e)g(drunk)o(en)e(bar)i(\002ghts.)-2 2050 y
SDict begin H.S end
 -2 2050
a -2 2050 a
SDict begin 13 H.A end
 -2 2050 a -2 2050 a
SDict begin [/View [/XYZ H.V]/Dest (0:1015) cvn /DEST pdfmark end
 -2 2050 a 396 2140 a
Fj(The)g(list)h(of)f(weird)g(problems)f(that)h(you)f(need)h(to)g
(\002ght)g(as)h(you)f(write)g(classic)h(shared-state)e(MT)i(code)e(w)o
(ould)g(be)396 2248 y(hilarious)g(if)i(it)f(didn')o(t)f(translate)h
(directly)f(into)h(stress)h(and)e(risk,)h(as)h(code)e(that)h(seems)h
(to)f(w)o(ork)f(suddenly)f(f)o(ails)j(under)396 2356
y(pressure.)e(A)i(lar)o(ge)e(\002rm)h(with)h(w)o(orld-beating)d(e)o
(xperience)g(in)i(b)n(uggy)f(code)g(released)h(its)h(list)g(of)f("11)g
(Lik)o(ely)396 2464 y(Problems)g(In)g(Y)-9 b(our)19 b(Multithreaded)f
(Code",)i(which)f(co)o(v)o(ers)g(for)o(gotten)f(synchronization,)f
(incorrect)i(granularity)-5 b(,)396 2571 y(read)20 b(and)g(write)g
(tearing,)f(lock-free)f(reordering,)g(lock)h(con)m(v)n(o)o(ys,)g(tw)o
(o-step)h(dance,)f(and)g(priority)g(in)m(v)o(ersion.)-2
2755 y
SDict begin H.S end
 -2 2755 a -2 2755 a
SDict begin 13 H.A end
 -2 2755 a -2 2755 a
SDict begin [/View [/XYZ H.V]/Dest (0:1016) cvn /DEST pdfmark end
 -2 2755
a 396 2845 a Fj(Y)-8 b(eah,)20 b(we)g(also)h(counted)d(se)n(v)o(en)i
(problems,)e(not)i(ele)n(v)o(en.)f(That')-5 b(s)20 b(not)g(the)g(point)
g(though.)e(The)i(point)f(is,)i(do)f(you)396 2953 y(really)g(w)o(ant)g
(that)h(code)e(running)f(the)i(po)n(wer)g(grid)f(or)h(stock)g(mark)o
(et)f(to)i(start)g(getting)e(tw)o(o-step)h(lock)f(con)m(v)n(o)o(ys)g
(at)396 3061 y(3pm)h(on)f(a)i(b)n(usy)f(Thursday?)e(Who)i(cares)h(what)
f(the)g(terms)g(actually)g(mean.)f(This)h(is)i(not)d(what)i(turned)d
(us)j(on)f(to)396 3169 y(programming,)d(\002ghting)i(e)n(v)o(er)g(more)
h(comple)o(x)e(side-ef)n(fects)h(with)i(e)n(v)o(er)e(more)g(comple)o(x)
g(hacks.)-2 3353 y
SDict begin H.S end
 -2 3353 a -2 3353 a
SDict begin 13 H.A end
 -2 3353 a -2 3353
a
SDict begin [/View [/XYZ H.V]/Dest (0:1017) cvn /DEST pdfmark end
 -2 3353 a 396 3443 a Fj(Some)h(widely)g(used)g(models,)f(despite)h
(being)f(the)i(basis)f(for)g(entire)g(industries,)f(are)h
(fundamentally)e(brok)o(en,)g(and)396 3551 y(shared)i(state)h
(concurrenc)o(y)16 b(is)22 b(one)d(of)h(them.)g(Code)g(that)g(w)o(ants)
h(to)f(scale)h(without)e(limit)i(does)f(it)h(lik)o(e)f(the)g(Internet)
396 3659 y(does,)g(by)g(sending)f(messages)h(and)g(sharing)f(nothing)f
(e)o(xcept)i(a)g(common)f(contempt)f(for)i(brok)o(en)e(programming)396
3767 y(models.)-2 3934 y
SDict begin H.S end
 -2 3934 a -2 3934 a
SDict begin 13 H.A end
 -2 3934
a -2 3934 a
SDict begin [/View [/XYZ H.V]/Dest (0:1018) cvn /DEST pdfmark end
 -2 3934 a 396 4041 a Fj(Y)-9 b(ou)20 b(should)f(follo)n(w)g
(some)h(rules)h(to)f(write)g(happ)o(y)f(multithreaded)f(code)i(with)g
(\330MQ:)-2 4059 y
SDict begin H.S end
 -2 4059 a -2 4059 a
SDict begin 13 H.A end
 -2 4059 a -2 4059
a
SDict begin [/View [/XYZ H.V]/Dest (0:1019) cvn /DEST pdfmark end
 -2 4059 a -2 4069 a
SDict begin H.S end
 -2 4069 a -2 4069 a
SDict begin 13 H.A end
 -2 4069 a -2
4069 a
SDict begin [/View [/XYZ H.V]/Dest (0:1020) cvn /DEST pdfmark end
 -2 4069 a Black 396 4211 a Fe(\225)p Black 479
4211 a
SDict begin H.S end
 479 4211 a 479 4211 a
SDict begin 13 H.A end
 479 4211 a 479 4211 a
SDict begin [/View [/XYZ H.V]/Dest (0:1021) cvn /DEST pdfmark end
 479
4211 a Fj(Y)-9 b(ou)20 b(must)g(not)g(access)h(the)f(same)g(data)g
(from)g(multiple)f(threads.)g(Using)h(classic)i(MT)e(techniques)f(lik)o
(e)h(mute)o(x)o(es)479 4319 y(are)g(an)h(anti-pattern)d(in)i(\330MQ)h
(applications.)e(The)g(only)h(e)o(xception)e(to)i(this)h(is)g(a)g
(\330MQ)f(conte)o(xt)f(object,)h(which)f(is)479 4427
y(threadsafe.)-2 4428 y
SDict begin H.S end
 -2 4428 a -2 4428 a
SDict begin 13 H.A end
 -2 4428 a
-2 4428 a
SDict begin [/View [/XYZ H.V]/Dest (0:1022) cvn /DEST pdfmark end
 -2 4428 a Black 396 4576 a Fe(\225)p Black
479 4576 a
SDict begin H.S end
 479 4576 a 479 4576 a
SDict begin 13 H.A end
 479 4576 a 479 4576
a
SDict begin [/View [/XYZ H.V]/Dest (0:1023) cvn /DEST pdfmark end
 479 4576 a Fj(Y)-9 b(ou)20 b(must)g(create)g(a)h(\330MQ)f(conte)o(xt)
f(for)h(your)f(process,)g(and)h(pass)g(that)h(to)f(all)h(threads)e
(that)i(you)e(w)o(ant)h(to)h(connect)479 4684 y(via)601
4684 y
SDict begin H.S end
 601 4684 a 601 4684 a
SDict begin 13 H.A end
 601 4684 a 601 4684 a
SDict begin [/View [/XYZ H.V]/Dest (0:1024) cvn /DEST pdfmark end
 601
4684 a Fg(inproc)f Fj(sock)o(ets.)-2 4696 y
SDict begin H.S end
 -2 4696 a
-2 4696 a
SDict begin 13 H.A end
 -2 4696 a -2 4696 a
SDict begin [/View [/XYZ H.V]/Dest (0:1025) cvn /DEST pdfmark end
 -2 4696 a Black 396 4834
a Fe(\225)p Black 479 4834 a
SDict begin H.S end
 479 4834 a 479 4834 a
SDict begin 13 H.A end
 479
4834 a 479 4834 a
SDict begin [/View [/XYZ H.V]/Dest (0:1026) cvn /DEST pdfmark end
 479 4834 a Fj(Y)-9 b(ou)20 b(may)g(treat)g(threads)f
(as)i(separate)f(tasks,)h(with)f(their)g(o)n(wn)g(conte)o(xt,)e(b)n(ut)
i(these)h(threads)e(cannot)g(communicate)479 4942 y(o)o(v)o(er)645
4942 y
SDict begin H.S end
 645 4942 a 645 4942 a
SDict begin 13 H.A end
 645 4942 a 645 4942 a
SDict begin [/View [/XYZ H.V]/Dest (0:1027) cvn /DEST pdfmark end
 645
4942 a Fg(inproc)p Fj(.)h(Ho)n(we)n(v)o(er)e(the)o(y)i(will)h(be)f
(easier)g(to)g(break)g(into)g(standalone)e(processes)i(afterw)o(ards.)
-2 4960 y
SDict begin H.S end
 -2 4960 a -2 4960 a
SDict begin 13 H.A end
 -2 4960 a -2 4960 a
SDict begin [/View [/XYZ H.V]/Dest (0:1028) cvn /DEST pdfmark end
 -2
4960 a Black 3800 5569 a Fi(63)p Black eop end
%%Page: 64 78
TeXDict begin 64 77 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.64) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1029) cvn /DEST pdfmark end
 479 72 a Fj(Y)e(ou)20
b(must)g(not)g(share)g(\330MQ)g(sock)o(ets)h(between)e(threads.)g
(\330MQ)i(sock)o(ets)f(are)g(not)g(threadsafe.)f(T)-6
b(echnically)19 b(it')-5 b(s)479 180 y(possible)20 b(to)h(do)e(this,)i
(b)n(ut)f(it)h(demands)e(semaphores,)f(locks,)i(or)g(mute)o(x)o(es.)f
(This)h(will)h(mak)o(e)f(your)f(application)479 288 y(slo)n(w)i(and)e
(fragile.)h(The)f(only)h(place)g(where)f(it')-5 b(s)22
b(remotely)d(sane)h(to)g(share)g(sock)o(ets)g(between)g(threads)f(are)h
(in)479 396 y(language)f(bindings)g(that)h(need)f(to)i(do)e(magic)h
(lik)o(e)h(garbage)d(collection)h(on)h(sock)o(ets.)-2
580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:1030) cvn /DEST pdfmark end
 -2 580 a 396
670 a Fj(If)g(you)f(need)g(to)h(start)g(more)f(than)g(one)h(proxy)e(in)
h(an)h(application,)e(for)h(e)o(xample,)f(you)h(will)i(w)o(ant)f(to)g
(run)f(each)g(in)h(their)396 778 y(o)n(wn)g(thread.)f(It)h(is)h(easy)f
(to)h(mak)o(e)e(the)h(error)f(of)h(creating)f(the)i(proxy)d(frontend)g
(and)h(back)o(end)g(sock)o(ets)h(in)g(one)g(thread,)396
886 y(and)g(then)g(passing)f(the)i(sock)o(ets)f(to)g(the)h(proxy)d(in)i
(another)f(thread.)g(This)h(may)g(appear)f(to)h(w)o(ork)g(b)n(ut)g
(will)h(f)o(ail)396 994 y(randomly)-5 b(.)18 b(Remember:)1159
994 y
SDict begin H.S end
 1159 994 a 1159 994 a
SDict begin 13 H.A end
 1159 994 a 1159 994 a
SDict begin [/View [/XYZ H.V]/Dest (0:1031) cvn /DEST pdfmark end
 1159
994 a Fi(Do)i(not)g(use)g(or)h(close)f(soc)n(k)o(ets)h(e)n(xcept)f(in)h
(the)f(thr)m(ead)f(that)h(cr)m(eated)g(them.)-2 1178
y
SDict begin H.S end
 -2 1178 a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:1032) cvn /DEST pdfmark end
 -2 1178 a 396
1268 a Fj(If)g(you)g(follo)n(w)f(these)h(rules,)g(you)g(can)g(quite)f
(easily)i(split)g(threads)e(into)h(separate)g(processes,)f(when)h(you)f
(need)h(to.)396 1376 y(Application)f(logic)h(can)g(sit)h(in)f(threads,)
g(processes,)f(nodes:)h(whate)n(v)o(er)f(your)f(scale)j(needs.)-2
1560 y
SDict begin H.S end
 -2 1560 a -2 1560 a
SDict begin 13 H.A end
 -2 1560 a -2 1560 a
SDict begin [/View [/XYZ H.V]/Dest (0:1033) cvn /DEST pdfmark end
 -2 1560
a 396 1650 a Fj(\330MQ)g(uses)f(nati)n(v)o(e)g(OS)h(threads)e(rather)h
(than)f(virtual)h("green")f(threads.)g(The)h(adv)n(antage)e(is)j(that)f
(you)g(don')o(t)e(need)i(to)396 1758 y(learn)g(an)o(y)f(ne)n(w)h
(threading)f(API,)h(and)g(that)g(\330MQ)g(threads)g(map)g(cleanly)f(to)
h(your)f(operating)g(system.)h(Y)-9 b(ou)19 b(can)h(use)396
1866 y(standard)f(tools)i(lik)o(e)f(Intel')-5 b(s)20
b(ThreadCheck)o(er)e(to)i(see)h(what)f(your)f(application)g(is)i
(doing.)e(The)g(disadv)n(antages)g(are)396 1974 y(that)i(your)d(code,)i
(when)f(it)i(for)f(instance)g(starts)h(ne)n(w)f(threads,)f(w)o(on')o(t)
g(be)h(portable,)f(and)g(that)i(if)f(you)f(ha)n(v)o(e)h(a)h(huge)396
2082 y(number)e(of)h(threads)f(\(thousands\),)f(some)i(operating)e
(systems)j(will)g(get)f(stressed.)-2 2266 y
SDict begin H.S end
 -2 2266 a
-2 2266 a
SDict begin 13 H.A end
 -2 2266 a -2 2266 a
SDict begin [/View [/XYZ H.V]/Dest (0:1034) cvn /DEST pdfmark end
 -2 2266 a 396 2356 a Fj(Let')-5
b(s)21 b(see)g(ho)n(w)e(this)i(w)o(orks)f(in)g(practice.)g(W)-7
b(e')o(ll)21 b(turn)e(our)h(old)g(Hello)g(W)-7 b(orld)20
b(serv)o(er)g(into)f(something)g(more)h(capable.)396
2464 y(The)g(original)f(serv)o(er)g(ran)h(in)h(a)f(single)g(thread.)f
(If)h(the)h(w)o(ork)e(per)h(request)f(is)j(lo)n(w)-5
b(,)19 b(that')-5 b(s)21 b(\002ne:)f(one)g(\330MQ)g(thread)f(can)396
2571 y(run)h(at)g(full)g(speed)g(on)g(a)h(CPU)g(core,)e(with)i(no)e(w)o
(aits,)i(doing)e(an)h(a)o(wful)g(lot)g(of)g(w)o(ork.)g(But)g(realistic)
h(serv)o(ers)e(ha)n(v)o(e)h(to)396 2679 y(do)g(non-tri)n(vial)e(w)o
(ork)h(per)g(request.)g(A)h(single)g(core)f(may)h(not)f(be)h(enough)e
(when)h(10,000)f(clients)i(hit)g(the)g(serv)o(er)f(all)h(at)396
2787 y(once.)g(So)g(a)h(realistic)f(serv)o(er)f(must)i(start)f
(multiple)g(w)o(ork)o(er)f(threads.)g(It)i(then)f(accepts)g(requests)g
(as)g(f)o(ast)h(as)g(it)g(can,)396 2895 y(and)f(distrib)n(utes)g(these)
g(to)h(its)g(w)o(ork)o(er)e(threads.)g(The)h(w)o(ork)o(er)f(threads)h
(grind)f(through)f(the)i(w)o(ork,)f(and)h(e)n(v)o(entually)396
3003 y(send)g(their)g(replies)g(back.)-2 3187 y
SDict begin H.S end
 -2 3187
a -2 3187 a
SDict begin 13 H.A end
 -2 3187 a -2 3187 a
SDict begin [/View [/XYZ H.V]/Dest (0:1035) cvn /DEST pdfmark end
 -2 3187 a 396 3277 a
Fj(Y)-9 b(ou)20 b(can)g(of)g(course)f(do)h(all)h(this)f(using)g(a)h
(proxy)d(brok)o(er)h(and)g(e)o(xternal)g(w)o(ork)o(er)h(processes,)f(b)
n(ut)h(often)g(it')-5 b(s)21 b(easier)f(to)396 3385 y(start)h(one)f
(process)f(that)i(gobbles)e(up)g(sixteen)h(cores)g(than)g(sixteen)g
(processes,)g(each)g(gobbling)d(up)j(one)g(core.)396
3493 y(Further)m(,)f(running)f(w)o(ork)o(ers)h(as)i(threads)f(will)h
(cut)f(out)g(a)g(netw)o(ork)f(hop,)g(latenc)o(y)-5 b(,)19
b(and)h(netw)o(ork)f(traf)n(\002c.)-2 3677 y
SDict begin H.S end
 -2 3677
a -2 3677 a
SDict begin 13 H.A end
 -2 3677 a -2 3677 a
SDict begin [/View [/XYZ H.V]/Dest (0:1036) cvn /DEST pdfmark end
 -2 3677 a 396 3767 a
Fj(The)h(MT)g(v)o(ersion)f(of)h(the)g(Hello)h(W)-7 b(orld)20
b(service)g(basically)g(collapses)g(the)g(brok)o(er)f(and)g(w)o(ork)o
(ers)h(into)g(a)g(single)396 3875 y(process.)g(W)-7 b(e)21
b(use)g(pthreads)e(because)g(it')-5 b(s)21 b(the)g(most)f(widespread)f
(standard)g(for)g(multithreading:)-2 3893 y
SDict begin H.S end
 -2 3893 a
-2 3893 a
SDict begin 13 H.A end
 -2 3893 a -2 3893 a
SDict begin [/View [/XYZ H.V]/Dest (0:mtserver-php) cvn /DEST pdfmark
end
 -2 3893 a 396 4076 a Fk(Example)i(2-11.)d
(Multithr)o(eaded)i(ser)o(vice)g(\(mtser)o(v)o(er)-8
b(.php\))-2 4176 y
SDict begin H.S end
 -2 4176 a -2 4176 a
SDict begin 11.7 H.A end
 -2 4176 a -2 4176
a
SDict begin [/View [/XYZ H.V]/Dest (0:1039) cvn /DEST pdfmark end
 -2 4176 a 396 4256 a Fg(<?php)396 4354 y(/)441 4367
y(*)441 4464 y(*)531 4451 y(Multithreaded)42 b(Hello)i(World)g(server.)
g(Uses)g(proceses)g(due)441 4561 y(*)531 4548 y(to)g(PHP's)g(lack)g(of)
h(threads!)441 4658 y(*)531 4645 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4755 y(*)486
4742 y(/)396 4936 y(function)g(worker_routine\(\))e({)441
5033 y($context)i(=)g(new)h(ZMQContext\(\);)441 5131
y(//)g(Socket)e(to)i(talk)f(to)h(dispatcher)p Black 3800
5569 a Fi(64)p Black eop end
%%Page: 65 79
TeXDict begin 65 78 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.65) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 441 72 a Fg($receiver)43 b(=)i(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_REP\);)441 170 y
($receiver->connect\("ipc://workers.ipc"\);)441 364 y(while\(true\))h
({)486 461 y($string)h(=)g($receiver->recv\(\);)486 558
y(printf)g(\("Received)f(request:)g([\045s]\045s",)h($string,)f
(PHP_EOL\);)486 752 y(//)h(Do)h(some)f('work')486 850
y(sleep\(1\);)486 1044 y(//)g(Send)h(reply)f(back)g(to)g(client)486
1141 y($receiver->send\("World"\);)441 1238 y(})396 1335
y(})396 1530 y(//)90 b(Launch)43 b(pool)i(of)f(worker)g(threads)396
1627 y(for\($thread_nbr)f(=)h(0;)h($thread_nbr)e(!=)h(5;)h
($thread_nbr++\))d({)441 1724 y($pid)i(=)h(pcntl_fork\(\);)441
1821 y(if\($pid)f(==)g(0\))h({)486 1918 y(worker_routine\(\);)486
2015 y(exit\(\);)441 2112 y(})396 2209 y(})396 2404 y(//)90
b(Prepare)43 b(our)i(context)e(and)i(sockets)396 2501
y($context)f(=)g(new)h(ZMQContext\(\);)396 2695 y(//)90
b(Socket)43 b(to)i(talk)f(to)h(clients)396 2792 y($clients)f(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)396 2889
y($clients->bind\("tcp://)1386 2902 y(*)1431 2889 y(:5555"\);)396
3084 y(//)90 b(Socket)43 b(to)i(talk)f(to)h(workers)396
3181 y($workers)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_DEALER\);)396 3278 y
($workers->bind\("ipc://workers.ipc"\);)396 3472 y(//)90
b(Connect)43 b(work)h(threads)g(to)h(client)e(threads)h(via)g(a)h
(queue)396 3569 y($device)f(=)h(new)f(ZMQDevice\($clients,)e
($workers\);)396 3666 y($device->run)h(\(\);)-2 3842
y
SDict begin H.S end
 -2 3842 a -2 3842 a
SDict begin 13 H.A end
 -2 3842 a -2 3842 a
SDict begin [/View [/XYZ H.V]/Dest (0:1040) cvn /DEST pdfmark end
 -2 3842 a 396
3940 a Fj(All)21 b(the)f(code)g(should)f(be)h(recognizable)e(to)i(you)g
(by)f(no)n(w)-5 b(.)19 b(Ho)n(w)i(it)f(w)o(orks:)-2 3958
y
SDict begin H.S end
 -2 3958 a -2 3958 a
SDict begin 13 H.A end
 -2 3958 a -2 3958 a
SDict begin [/View [/XYZ H.V]/Dest (0:1041) cvn /DEST pdfmark end
 -2 3958 a -2
3968 a
SDict begin H.S end
 -2 3968 a -2 3968 a
SDict begin 13 H.A end
 -2 3968 a -2 3968 a
SDict begin [/View [/XYZ H.V]/Dest (0:1042) cvn /DEST pdfmark end
 -2 3968
a Black 396 4111 a Fe(\225)p Black 479 4111 a
SDict begin H.S end
 479 4111
a 479 4111 a
SDict begin 13 H.A end
 479 4111 a 479 4111 a
SDict begin [/View [/XYZ H.V]/Dest (0:1043) cvn /DEST pdfmark end
 479 4111 a Fj(The)g(serv)o(er)f
(starts)i(a)g(set)g(of)f(w)o(ork)o(er)f(threads.)g(Each)h(w)o(ork)o(er)
f(thread)h(creates)g(a)g(REP)h(sock)o(et)g(and)e(then)h(processes)479
4219 y(requests)g(on)g(this)h(sock)o(et.)e(W)-7 b(ork)o(er)20
b(threads)g(are)g(just)h(lik)o(e)f(single-threaded)e(serv)o(ers.)h(The)
h(only)f(dif)n(ferences)g(are)479 4327 y(the)h(transport)f(\()945
4327 y
SDict begin H.S end
 945 4327 a 945 4327 a
SDict begin 13 H.A end
 945 4327 a 945 4327 a
SDict begin [/View [/XYZ H.V]/Dest (0:1044) cvn /DEST pdfmark end
 945
4327 a Fg(inproc)h Fj(instead)g(of)1581 4327 y
SDict begin H.S end
 1581 4327
a 1581 4327 a
SDict begin 13 H.A end
 1581 4327 a 1581 4327 a
SDict begin [/View [/XYZ H.V]/Dest (0:1045) cvn /DEST pdfmark end
 1581 4327 a Fg(tcp)p
Fj(\),)f(and)h(the)g(bind-connect)d(direction.)-2 4344
y
SDict begin H.S end
 -2 4344 a -2 4344 a
SDict begin 13 H.A end
 -2 4344 a -2 4344 a
SDict begin [/View [/XYZ H.V]/Dest (0:1046) cvn /DEST pdfmark end
 -2 4344 a Black
396 4476 a Fe(\225)p Black 479 4476 a
SDict begin H.S end
 479 4476 a 479
4476 a
SDict begin 13 H.A end
 479 4476 a 479 4476 a
SDict begin [/View [/XYZ H.V]/Dest (0:1047) cvn /DEST pdfmark end
 479 4476 a Fj(The)j(serv)o(er)f(creates)i
(a)f(R)m(OUTER)h(sock)o(et)f(to)g(talk)h(to)f(clients)g(and)g(binds)g
(this)g(to)h(its)g(e)o(xternal)e(interf)o(ace)g(\(o)o(v)o(er)479
4584 y
SDict begin H.S end
 479 4584 a 479 4584 a
SDict begin 13 H.A end
 479 4584 a 479 4584 a
SDict begin [/View [/XYZ H.V]/Dest (0:1048) cvn /DEST pdfmark end
 479
4584 a Fg(tcp)p Fj(\).)-2 4599 y
SDict begin H.S end
 -2 4599 a -2 4599 a
SDict begin 13 H.A end

-2 4599 a -2 4599 a
SDict begin [/View [/XYZ H.V]/Dest (0:1049) cvn /DEST pdfmark end
 -2 4599 a Black 396 4733 a Fe(\225)p
Black 479 4733 a
SDict begin H.S end
 479 4733 a 479 4733 a
SDict begin 13 H.A end
 479 4733 a 479
4733 a
SDict begin [/View [/XYZ H.V]/Dest (0:1050) cvn /DEST pdfmark end
 479 4733 a Fj(The)h(serv)o(er)f(creates)h(a)g(DEALER)g(sock)o
(et)g(to)g(talk)f(to)i(the)e(w)o(ork)o(ers)h(and)f(binds)g(this)i(to)f
(its)g(internal)g(interf)o(ace)f(\(o)o(v)o(er)479 4841
y
SDict begin H.S end
 479 4841 a 479 4841 a
SDict begin 13 H.A end
 479 4841 a 479 4841 a
SDict begin [/View [/XYZ H.V]/Dest (0:1051) cvn /DEST pdfmark end
 479 4841
a Fg(inproc)p Fj(\).)-2 4856 y
SDict begin H.S end
 -2 4856 a -2 4856 a
SDict begin 13 H.A end
 -2
4856 a -2 4856 a
SDict begin [/View [/XYZ H.V]/Dest (0:1052) cvn /DEST pdfmark end
 -2 4856 a Black 396 4991 a Fe(\225)p
Black 479 4991 a
SDict begin H.S end
 479 4991 a 479 4991 a
SDict begin 13 H.A end
 479 4991 a 479
4991 a
SDict begin [/View [/XYZ H.V]/Dest (0:1053) cvn /DEST pdfmark end
 479 4991 a Fj(The)h(serv)o(er)f(starts)i(a)g(proxy)e(that)h
(connects)f(the)h(tw)o(o)h(sock)o(ets.)f(The)g(proxy)e(pulls)i
(incoming)f(requests)h(f)o(airly)f(from)479 5099 y(all)i(clients,)f
(and)g(distrib)n(utes)g(those)g(out)g(to)g(w)o(ork)o(ers.)f(It)i(also)f
(routes)g(replies)g(back)g(to)g(their)g(origin.)p Black
3800 5569 a Fi(65)p Black eop end
%%Page: 66 80
TeXDict begin 66 79 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.66) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1066) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1054) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Note)20 b(that)h(creating)e(threads)g(is)
j(not)d(portable)g(in)i(most)f(programming)c(languages.)j(The)h(POSIX)g
(library)g(is)396 180 y(pthreads,)f(b)n(ut)h(on)g(W)m(indo)n(ws)g(you)f
(ha)n(v)o(e)g(to)i(use)f(a)h(dif)n(ferent)d(API.)j(In)f(our)f(e)o
(xample,)g(the)3021 180 y
SDict begin H.S end
 3021 180 a 3021 180 a
SDict begin 13 H.A end
 3021
180 a 3021 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:1055) cvn /DEST pdfmark end
 3021 180 a Fg(pthread-create)f Fj(call)396
288 y(starts)j(up)f(a)h(ne)n(w)f(thread)f(running)f(the)1540
288 y
SDict begin H.S end
 1540 288 a 1540 288 a
SDict begin 13 H.A end
 1540 288 a 1540 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:1056) cvn /DEST pdfmark end
 1540
288 a Fg(worker-routine)h Fj(function)f(we)j(de\002ned.)d(W)-7
b(e')o(ll)22 b(see)f(in)f(Adv)n(anced)396 396 y(Request-Reply)f(P)o
(atterns)p 0 TeXcolorgray 1177 396 a
SDict begin H.S end
 1177 396 a Fj(Chapter)g(3)1502
396 y
SDict begin 13 H.L end
 1502 396 a 1502 396 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1502 396 a Black 21 w Fj(ho)n(w)g(to)i
(wrap)e(this)i(in)f(a)h(portable)e(API.)-2 580 y
SDict begin H.S end
 -2 580
a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:1058) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(Here)h(the)h('w)o
(ork')d(is)j(just)g(a)g(one-second)d(pause.)h(W)-7 b(e)22
b(could)d(do)h(an)o(ything)e(in)i(the)g(w)o(ork)o(ers,)f(including)g
(talking)g(to)396 778 y(other)h(nodes.)f(This)h(is)h(what)f(the)h(MT)f
(serv)o(er)f(looks)h(lik)o(e)g(in)h(terms)f(of)g(\330MQ)g(sock)o(ets)h
(and)e(nodes.)h(Note)g(ho)n(w)f(the)396 886 y(request-reply)f(chain)i
(is)1132 886 y
SDict begin H.S end
 1132 886 a 1132 886 a
SDict begin 13 H.A end
 1132 886 a 1132
886 a
SDict begin [/View [/XYZ H.V]/Dest (0:1059) cvn /DEST pdfmark end
 1132 886 a Fg(REQ-ROUTER-queue-DEALER-REP)p Fj(\()p
0 TeXcolorgray 2375 886 a
SDict begin H.S end
 2375 886 a Fj(Figure)14 b(2-12)2761
886 y
SDict begin 13 H.L end
 2761 886 a 2761 886 a
SDict begin [/Subtype /Link/Dest (0:figure-20) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2761 886 a Black -1 w Fj(\).)-2
904 y
SDict begin H.S end
 -2 904 a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-20) cvn /DEST pdfmark
end
 -2 904 a Black
3798 5569 a Fi(66)p Black eop end
%%Page: 67 81
TeXDict begin 67 80 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.67) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-12.)e(Multithr)o(eaded)i
(Ser)o(v)o(er)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1063) cvn /DEST pdfmark end
 -2 172 a 396 4714 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4714 a @beginspecial 0
@llx -540 @lly 432 @urx 0 @ury 4320 @rwi @setspecial
%%BeginDocument: images/fig20.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -540 432 0
%%HiResBoundingBox: 0.0 -540.0 432.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.7002716064453 -32.70027160644531 moveto
159.7002716064453 -78.70027160644531 lineto
276.70025634765625 -78.70027160644531 lineto
276.70025634765625 -32.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.7002716064453 -81.70027160644531 moveto
159.7002716064453 -98.70027160644531 lineto
159.7002716064453 -102.70027160644531 161.36693827311197 -104.70027160644531 164.7002716064453 -104.70027160644531 curveto
272.70025634765625 -104.70027160644531 lineto
272.70025634765625 -104.70027160644531 lineto
275.36692301432294 -104.70027160644531 276.70025634765625 -102.70027160644531 276.70025634765625 -98.70027160644531 curveto
276.70025634765625 -82.50027465820312 lineto
276.70025634765625 -81.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
164.7002716064453 -188.7002716064453 moveto
161.36693827311197 -188.7002716064453 159.7002716064453 -190.7002716064453 159.7002716064453 -194.7002716064453 curveto
159.7002716064453 -210.7002716064453 lineto
276.70025634765625 -210.7002716064453 lineto
276.70025634765625 -194.7002716064453 lineto
276.70025634765625 -190.7002716064453 275.36692301432294 -188.7002716064453 272.70025634765625 -188.7002716064453 curveto
164.7002716064453 -188.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.7002716064453 -213.7002716064453 moveto
159.7002716064453 -258.70025634765625 lineto
276.70025634765625 -258.70025634765625 lineto
276.70025634765625 -213.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.7002716064453 -261.70025634765625 moveto
159.7002716064453 -318.70025634765625 lineto
276.70025634765625 -318.70025634765625 lineto
276.70025634765625 -261.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.7002716064453 -321.70025634765625 moveto
159.7002716064453 -338.70025634765625 lineto
159.7002716064453 -342.70025634765625 161.36693827311197 -344.70025634765625 164.7002716064453 -344.70025634765625 curveto
272.70025634765625 -344.70025634765625 lineto
272.70025634765625 -344.70025634765625 lineto
275.36692301432294 -344.70025634765625 276.70025634765625 -342.70025634765625 276.70025634765625 -338.70025634765625 curveto
276.70025634765625 -322.500244140625 lineto
276.70025634765625 -321.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
74.70027160644531 -416.70025634765625 moveto
71.36693827311198 -416.70025634765625 69.70027160644531 -418.70025634765625 69.70027160644531 -422.70025634765625 curveto
69.70027160644531 -438.70025634765625 lineto
150.7002716064453 -438.70025634765625 lineto
150.7002716064453 -422.70025634765625 lineto
150.7002716064453 -418.70025634765625 149.36693827311197 -416.70025634765625 146.7002716064453 -416.70025634765625 curveto
74.70027160644531 -416.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
69.70027160644531 -441.70025634765625 moveto
69.70027160644531 -488.70025634765625 lineto
150.7002716064453 -488.70025634765625 lineto
150.7002716064453 -441.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
182.7002716064453 -416.70025634765625 moveto
179.36693827311197 -416.70025634765625 177.7002716064453 -418.70025634765625 177.7002716064453 -422.70025634765625 curveto
177.7002716064453 -438.70025634765625 lineto
258.70025634765625 -438.70025634765625 lineto
258.70025634765625 -422.70025634765625 lineto
258.70025634765625 -418.70025634765625 257.36692810058594 -416.70025634765625 254.7002716064453 -416.70025634765625 curveto
182.7002716064453 -416.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
177.7002716064453 -441.70025634765625 moveto
177.7002716064453 -488.70025634765625 lineto
258.70025634765625 -488.70025634765625 lineto
258.70025634765625 -441.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
290.70025634765625 -416.70025634765625 moveto
287.36692301432294 -416.70025634765625 285.70025634765625 -418.70025634765625 285.70025634765625 -422.70025634765625 curveto
285.70025634765625 -438.70025634765625 lineto
366.70025634765625 -438.70025634765625 lineto
366.70025634765625 -422.70025634765625 lineto
366.70025634765625 -418.70025634765625 365.36692301432294 -416.70025634765625 362.70025634765625 -416.70025634765625 curveto
290.70025634765625 -416.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
285.70025634765625 -441.70025634765625 moveto
285.70025634765625 -488.70025634765625 lineto
366.70025634765625 -488.70025634765625 lineto
366.70025634765625 -441.70025634765625 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -30.0 moveto
157.0 -76.0 lineto
274.0 -76.0 lineto
274.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
157.0 -30.0 moveto
157.0 -76.0 lineto
274.0 -76.0 lineto
274.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -79.0 moveto
157.0 -96.0 lineto
157.0 -100.0 158.66666666666666 -102.0 162.0 -102.0 curveto
270.0 -102.0 lineto
270.0 -102.0 lineto
272.6666666666667 -102.0 274.0 -100.0 274.0 -96.0 curveto
274.0 -79.80000305175781 lineto
274.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -79.0 moveto
157.0 -96.0 lineto
157.0 -100.0 158.66666666666666 -102.0 162.0 -102.0 curveto
270.0 -102.0 lineto
270.0 -102.0 lineto
272.6666666666667 -102.0 274.0 -100.0 274.0 -96.0 curveto
274.0 -79.80000305175781 lineto
274.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
162.0 -186.0 moveto
158.66666666666666 -186.0 157.0 -188.0 157.0 -192.0 curveto
157.0 -208.0 lineto
274.0 -208.0 lineto
274.0 -192.0 lineto
274.0 -188.0 272.6666666666667 -186.0 270.0 -186.0 curveto
162.0 -186.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
162.0 -186.0 moveto
158.66666666666666 -186.0 157.0 -188.0 157.0 -192.0 curveto
157.0 -208.0 lineto
274.0 -208.0 lineto
274.0 -192.0 lineto
274.0 -188.0 272.6666666666667 -186.0 270.0 -186.0 curveto
162.0 -186.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -211.0 moveto
157.0 -256.0 lineto
274.0 -256.0 lineto
274.0 -211.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -211.0 moveto
157.0 -256.0 lineto
274.0 -256.0 lineto
274.0 -211.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -259.0 moveto
157.0 -316.0 lineto
274.0 -316.0 lineto
274.0 -259.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -259.0 moveto
157.0 -316.0 lineto
274.0 -316.0 lineto
274.0 -259.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -319.0 moveto
157.0 -336.0 lineto
157.0 -340.0 158.66666666666666 -342.0 162.0 -342.0 curveto
270.0 -342.0 lineto
270.0 -342.0 lineto
272.6666666666667 -342.0 274.0 -340.0 274.0 -336.0 curveto
274.0 -319.79998779296875 lineto
274.0 -319.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -319.0 moveto
157.0 -336.0 lineto
157.0 -340.0 158.66666666666666 -342.0 162.0 -342.0 curveto
270.0 -342.0 lineto
270.0 -342.0 lineto
272.6666666666667 -342.0 274.0 -340.0 274.0 -336.0 curveto
274.0 -319.79998779296875 lineto
274.0 -319.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
72.0 -414.0 moveto
68.66666666666667 -414.0 67.0 -416.0 67.0 -420.0 curveto
67.0 -436.0 lineto
148.0 -436.0 lineto
148.0 -420.0 lineto
148.0 -416.0 146.66666666666666 -414.0 144.0 -414.0 curveto
72.0 -414.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
72.0 -414.0 moveto
68.66666666666667 -414.0 67.0 -416.0 67.0 -420.0 curveto
67.0 -436.0 lineto
148.0 -436.0 lineto
148.0 -420.0 lineto
148.0 -416.0 146.66666666666666 -414.0 144.0 -414.0 curveto
72.0 -414.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
67.0 -439.0 moveto
67.0 -486.0 lineto
148.0 -486.0 lineto
148.0 -439.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
67.0 -439.0 moveto
67.0 -486.0 lineto
148.0 -486.0 lineto
148.0 -439.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
180.0 -414.0 moveto
176.66666666666666 -414.0 175.0 -416.0 175.0 -420.0 curveto
175.0 -436.0 lineto
256.0 -436.0 lineto
256.0 -420.0 lineto
256.0 -416.0 254.66666666666666 -414.0 252.0 -414.0 curveto
180.0 -414.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
180.0 -414.0 moveto
176.66666666666666 -414.0 175.0 -416.0 175.0 -420.0 curveto
175.0 -436.0 lineto
256.0 -436.0 lineto
256.0 -420.0 lineto
256.0 -416.0 254.66666666666666 -414.0 252.0 -414.0 curveto
180.0 -414.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
175.0 -439.0 moveto
175.0 -486.0 lineto
256.0 -486.0 lineto
256.0 -439.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
175.0 -439.0 moveto
175.0 -486.0 lineto
256.0 -486.0 lineto
256.0 -439.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
288.0 -414.0 moveto
284.6666666666667 -414.0 283.0 -416.0 283.0 -420.0 curveto
283.0 -436.0 lineto
364.0 -436.0 lineto
364.0 -420.0 lineto
364.0 -416.0 362.6666666666667 -414.0 360.0 -414.0 curveto
288.0 -414.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
288.0 -414.0 moveto
284.6666666666667 -414.0 283.0 -416.0 283.0 -420.0 curveto
283.0 -436.0 lineto
364.0 -436.0 lineto
364.0 -420.0 lineto
364.0 -416.0 362.6666666666667 -414.0 360.0 -414.0 curveto
288.0 -414.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
283.0 -439.0 moveto
283.0 -486.0 lineto
364.0 -486.0 lineto
364.0 -439.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
283.0 -439.0 moveto
283.0 -486.0 lineto
364.0 -486.0 lineto
364.0 -439.0 lineto
closepath
stroke
0.9 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
189.0 -162.0 moveto
27.0 -162.0 lineto
23.666666666666668 -162.0 22.0 -164.0 22.0 -168.0 curveto
22.0 -504.0 lineto
22.0 -504.0 lineto
22.0 -508.0 23.666666666666668 -510.0 27.0 -510.0 curveto
405.0 -510.0 lineto
405.0 -510.0 lineto
407.6666666666667 -510.0 409.0 -508.0 409.0 -504.0 curveto
409.0 -168.0 lineto
409.0 -168.0 lineto
409.0 -164.0 407.6666666666667 -162.0 405.0 -162.0 curveto
243.0 -162.0 lineto
243.0 -162.0 lineto
stroke
newpath
198.0 -162.0 moveto
234.0 -162.0 lineto
stroke
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
193.0 -102.0 moveto
193.0 -174.0 lineto
stroke
newpath
238.0 -114.0 moveto
238.0 -186.0 lineto
stroke
newpath
238.0 -108.0 moveto
234.0 -120.0 lineto
243.0 -120.0 lineto
closepath
fill
newpath
189.0 -168.0 moveto
193.0 -180.0 lineto
198.0 -168.0 lineto
closepath
fill
newpath
211.0 -348.0 moveto
207.0 -360.0 lineto
216.0 -360.0 lineto
closepath
fill
newpath
99.0 -396.0 moveto
103.0 -408.0 lineto
108.0 -396.0 lineto
closepath
fill
newpath
207.0 -396.0 moveto
211.0 -408.0 lineto
216.0 -396.0 lineto
closepath
fill
newpath
315.0 -396.0 moveto
319.0 -408.0 lineto
324.0 -396.0 lineto
closepath
fill
newpath
211.0 -354.0 moveto
211.0 -378.0 lineto
stroke
newpath
103.0 -402.0 moveto
103.0 -378.0 lineto
211.0 -378.0 lineto
stroke
newpath
211.0 -402.0 moveto
211.0 -378.0 lineto
stroke
newpath
319.0 -402.0 moveto
319.0 -378.0 lineto
211.0 -378.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
195.0 -59.0 moveto
(Client) show
198.0 -94.0 moveto
(REQ) show
150.0 -143.0 moveto
("Hello") show
228.0 -143.0 moveto
("World") show
191.0 -202.0 moveto
(ROUTER) show
193.0 -239.0 moveto
(Server) show
190.0 -286.0 moveto
(Queue) show
191.0 -299.0 moveto
(proxy) show
190.0 -334.0 moveto
(DEALER) show
90.0 -430.0 moveto
(REP) show
198.0 -430.0 moveto
(REP) show
306.0 -430.0 moveto
(REP) show
82.0 -467.0 moveto
(Worker) show
190.0 -467.0 moveto
(Worker) show
298.0 -467.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4714 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4714 a -2 4797 a
SDict begin H.S end
 -2 4797
a -2 4797 a
SDict begin 13 H.A end
 -2 4797 a -2 4797 a
SDict begin [/View [/XYZ H.V]/Dest (0:1066) cvn /DEST pdfmark end
 -2 4797 a Black 3797
5569 a Fi(67)p Black eop end
%%Page: 68 82
TeXDict begin 68 81 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.68) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 94 a Fh(2.7.)39 b(Signaling)f(between)f(Threads)h
(\(P)-14 b(AIR)38 b(soc)m(kets\))3171 94 y
SDict begin H.S end
 3171 94 a
3171 94 a
SDict begin 22.464 H.A end
 3171 94 a 3171 94 a
SDict begin [/View [/XYZ H.V]/Dest (7.25.1) cvn /DEST pdfmark end
 3171 94 a -2 292 a
SDict begin H.S end
 -2 292
a -2 292 a
SDict begin 13 H.A end
 -2 292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:1068) cvn /DEST pdfmark end
 -2 292 a 396 368 a Fj(When)20
b(you)g(start)g(making)f(multithreaded)f(applications)h(with)h(\330MQ,)
h(you')o(ll)e(encounter)f(the)i(question)f(of)h(ho)n(w)g(to)396
476 y(coordinate)e(your)h(threads.)h(Though)e(you)h(might)h(be)g
(tempted)f(to)h(insert)g(')-5 b(sleep')21 b(statements,)f(or)f(use)i
(multithreading)396 584 y(techniques)e(such)h(as)h(semaphores)e(or)h
(mute)o(x)o(es,)1853 584 y
SDict begin H.S end
 1853 584 a 1853 584 a
SDict begin 13 H.A end
 1853
584 a 1853 584 a
SDict begin [/View [/XYZ H.V]/Dest (0:1069) cvn /DEST pdfmark end
 1853 584 a Fk(the)h(only)f(mechanism)h(that)e(y)n(ou)h
(should)h(use)g(ar)o(e)f(\330MQ)396 692 y(messages)p
Fj(.)h(Remember)e(the)h(story)g(of)g(The)f(Drunkards)g(and)g(the)h
(Beer)h(Bottle.)-2 876 y
SDict begin H.S end
 -2 876 a -2 876 a
SDict begin 13 H.A end
 -2 876 a -2
876 a
SDict begin [/View [/XYZ H.V]/Dest (0:1070) cvn /DEST pdfmark end
 -2 876 a 396 966 a Fj(Let')-5 b(s)21 b(mak)o(e)f(three)g(threads)
f(that)h(signal)g(each)g(other)g(when)f(the)o(y)h(are)g(ready\()p
0 TeXcolorgray 2658 966 a
SDict begin H.S end
 2658 966 a Fj(Figure)d(2-13)3047
966 y
SDict begin 13 H.L end
 3047 966 a 3047 966 a
SDict begin [/Subtype /Link/Dest (0:figure-21) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3047 966 a Black -1 w Fj(\).)j(In)g(this)g
(e)o(xample)f(we)i(use)396 1074 y(P)-8 b(AIR)22 b(sock)o(ets)e(o)o(v)o
(er)f(the)1151 1074 y
SDict begin H.S end
 1151 1074 a 1151 1074 a
SDict begin 13 H.A end
 1151 1074
a 1151 1074 a
SDict begin [/View [/XYZ H.V]/Dest (0:1072) cvn /DEST pdfmark end
 1151 1074 a Fg(inproc)h Fj(transport:)-2
1092 y
SDict begin H.S end
 -2 1092 a -2 1092 a
SDict begin 13 H.A end
 -2 1092 a -2 1092 a
SDict begin [/View [/XYZ H.V]/Dest (0:mtrelay-php) cvn /DEST pdfmark
end
 -2 1092
a 396 1275 a Fk(Example)h(2-12.)d(Multithr)o(eaded)i(r)o(elay)f(\(mtr)o
(elay)-6 b(.php\))-2 1375 y
SDict begin H.S end
 -2 1375 a -2 1375 a
SDict begin 11.7 H.A end
 -2 1375
a -2 1375 a
SDict begin [/View [/XYZ H.V]/Dest (0:1075) cvn /DEST pdfmark end
 -2 1375 a 396 1455 a Fg(<?php)396 1552 y(/)441
1565 y(*)441 1663 y(*)531 1650 y(Multithreaded)42 b(relay.)i(Actually)g
(using)g(processes)f(due)h(a)h(lack)441 1760 y(*)531
1747 y(of)f(PHP)h(threads.)441 1857 y(*)531 1844 y(@author)e(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
1954 y(*)486 1941 y(/)396 2135 y(function)g(step1\(\))f({)441
2232 y($context)h(=)g(new)h(ZMQContext\(\);)441 2329
y(//)g(Signal)e(downstream)h(to)g(step)g(2)441 2427 y($sender)g(=)g
(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_PAIR\);)441
2524 y($sender->connect\("ipc://step2.ipc"\);)441 2621
y($sender->send\(""\);)396 2718 y(})396 2912 y(function)j(step2\(\))f
({)441 3009 y($pid)h(=)h(pcntl_fork\(\);)441 3107 y(if\($pid)f(==)g
(0\))h({)486 3204 y(step1\(\);)486 3301 y(exit\(\);)441
3398 y(})441 3592 y($context)f(=)g(new)h(ZMQContext\(\);)441
3689 y(//)89 b(Bind)45 b(to)f(ipc:)g(endpoint,)g(then)g(start)g
(upstream)f(thread)441 3787 y($receiver)g(=)i(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_PAIR\);)441 3884
y($receiver->bind\("ipc://step2.ipc"\);)441 4078 y(//)j(Wait)f(for)g
(signal)441 4175 y($receiver->recv\(\);)441 4369 y(//)h(Signal)e
(downstream)h(to)g(step)g(3)441 4466 y($sender)g(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_PAIR\);)441 4564
y($sender->connect\("ipc://step3.ipc"\);)441 4661 y
($sender->send\(""\);)396 4758 y(})396 5146 y(//)k(Start)f(upstream)f
(thread)h(then)g(bind)g(to)h(icp:)f(endpoint)p Black
3800 5569 a Fi(68)p Black eop end
%%Page: 69 83
TeXDict begin 69 82 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.69) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1081) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fg($pid)44 b(=)h(pcntl_fork\(\);)396
170 y(if\($pid)f(==)g(0\))h({)441 267 y(step2\(\);)441
364 y(exit\(\);)396 461 y(})396 655 y($context)f(=)g(new)h
(ZMQContext\(\);)396 752 y($receiver)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PAIR\);)396 850 y($receiver->bind\("ipc://step3.ipc"\);)
396 1141 y(//)k(Wait)f(for)g(signal)396 1238 y($receiver->recv\(\);)396
1432 y(echo)g("Test)g(succesful!",)f(PHP_EOL)-2 1442
y
SDict begin H.S end
 -2 1442 a -2 1442 a
SDict begin 13 H.A end
 -2 1442 a -2 1442 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-21) cvn /DEST pdfmark
end
 -2 1442 a Black
3800 5569 a Fi(69)p Black eop end
%%Page: 70 84
TeXDict begin 70 83 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.70) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-13.)e(The)k(Relay)d
(Race)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1078) cvn /DEST pdfmark end
 -2
172 a 396 4531 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4531 a @beginspecial 0 @llx -518
@lly 180 @urx 0 @ury 1800 @rwi @setspecial
%%BeginDocument: images/fig21.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -518 180 0
%%HiResBoundingBox: 0.0 -518.0 180.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -92.00029754638672 lineto
158.00030517578125 -92.00029754638672 lineto
158.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -96.00029754638672 moveto
28.00029945373535 -115.00029754638672 lineto
28.00029945373535 -119.66696421305339 29.666966756184895 -122.00029754638672 33.000301361083984 -122.00029754638672 curveto
153.00030517578125 -122.00029754638672 lineto
153.00030517578125 -122.00029754638672 lineto
156.3336385091146 -122.00029754638672 158.00030517578125 -119.66696421305339 158.00030517578125 -115.00029754638672 curveto
158.00030517578125 -96.00029754638672 lineto
158.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -206.00030517578125 moveto
29.666966756184895 -206.00030517578125 28.00029945373535 -208.3336385091146 28.00029945373535 -213.00030517578125 curveto
28.00029945373535 -232.00030517578125 lineto
158.00030517578125 -232.00030517578125 lineto
158.00030517578125 -213.00030517578125 lineto
158.00030517578125 -208.3336385091146 156.3336385091146 -206.00030517578125 153.00030517578125 -206.00030517578125 curveto
33.000301361083984 -206.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -236.00030517578125 moveto
28.00029945373535 -288.00030517578125 lineto
158.00030517578125 -288.00030517578125 lineto
158.00030517578125 -236.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -292.00030517578125 moveto
28.00029945373535 -311.00030517578125 lineto
28.00029945373535 -315.66697184244794 29.666966756184895 -318.00030517578125 33.000301361083984 -318.00030517578125 curveto
153.00030517578125 -318.00030517578125 lineto
153.00030517578125 -318.00030517578125 lineto
156.3336385091146 -318.00030517578125 158.00030517578125 -315.66697184244794 158.00030517578125 -311.00030517578125 curveto
158.00030517578125 -292.00030517578125 lineto
158.00030517578125 -292.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -402.00030517578125 moveto
29.666966756184895 -402.00030517578125 28.00029945373535 -404.33363850911456 28.00029945373535 -409.00030517578125 curveto
28.00029945373535 -428.00030517578125 lineto
158.00030517578125 -428.00030517578125 lineto
158.00030517578125 -409.00030517578125 lineto
158.00030517578125 -404.33363850911456 156.3336385091146 -402.00030517578125 153.00030517578125 -402.00030517578125 curveto
33.000301361083984 -402.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -432.00030517578125 moveto
28.00029945373535 -486.00030517578125 lineto
158.00030517578125 -486.00030517578125 lineto
158.00030517578125 -432.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
155.0 -89.0 lineto
155.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
155.0 -89.0 lineto
155.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
150.0 -119.0 lineto
150.0 -119.0 lineto
153.33333333333334 -119.0 155.0 -116.66666666666667 155.0 -112.0 curveto
155.0 -93.0 lineto
155.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
150.0 -119.0 lineto
150.0 -119.0 lineto
153.33333333333334 -119.0 155.0 -116.66666666666667 155.0 -112.0 curveto
155.0 -93.0 lineto
155.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -203.0 moveto
26.666666666666668 -203.0 25.0 -205.33333333333334 25.0 -210.0 curveto
25.0 -229.0 lineto
155.0 -229.0 lineto
155.0 -210.0 lineto
155.0 -205.33333333333334 153.33333333333334 -203.0 150.0 -203.0 curveto
30.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -203.0 moveto
26.666666666666668 -203.0 25.0 -205.33333333333334 25.0 -210.0 curveto
25.0 -229.0 lineto
155.0 -229.0 lineto
155.0 -210.0 lineto
155.0 -205.33333333333334 153.33333333333334 -203.0 150.0 -203.0 curveto
30.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -233.0 moveto
25.0 -285.0 lineto
155.0 -285.0 lineto
155.0 -233.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -233.0 moveto
25.0 -285.0 lineto
155.0 -285.0 lineto
155.0 -233.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -289.0 moveto
25.0 -308.0 lineto
25.0 -312.6666666666667 26.666666666666668 -315.0 30.0 -315.0 curveto
150.0 -315.0 lineto
150.0 -315.0 lineto
153.33333333333334 -315.0 155.0 -312.6666666666667 155.0 -308.0 curveto
155.0 -289.0 lineto
155.0 -289.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -289.0 moveto
25.0 -308.0 lineto
25.0 -312.6666666666667 26.666666666666668 -315.0 30.0 -315.0 curveto
150.0 -315.0 lineto
150.0 -315.0 lineto
153.33333333333334 -315.0 155.0 -312.6666666666667 155.0 -308.0 curveto
155.0 -289.0 lineto
155.0 -289.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -399.0 moveto
26.666666666666668 -399.0 25.0 -401.3333333333333 25.0 -406.0 curveto
25.0 -425.0 lineto
155.0 -425.0 lineto
155.0 -406.0 lineto
155.0 -401.3333333333333 153.33333333333334 -399.0 150.0 -399.0 curveto
30.0 -399.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -399.0 moveto
26.666666666666668 -399.0 25.0 -401.3333333333333 25.0 -406.0 curveto
25.0 -425.0 lineto
155.0 -425.0 lineto
155.0 -406.0 lineto
155.0 -401.3333333333333 153.33333333333334 -399.0 150.0 -399.0 curveto
30.0 -399.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -429.0 moveto
25.0 -483.0 lineto
155.0 -483.0 lineto
155.0 -429.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -429.0 moveto
25.0 -483.0 lineto
155.0 -483.0 lineto
155.0 -429.0 lineto
closepath
stroke
newpath
85.0 -119.0 moveto
85.0 -189.0 lineto
stroke
newpath
85.0 -315.0 moveto
85.0 -385.0 lineto
stroke
newpath
80.0 -182.0 moveto
85.0 -196.0 lineto
90.0 -182.0 lineto
closepath
fill
newpath
80.0 -378.0 moveto
85.0 -392.0 lineto
90.0 -378.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
64.0 -68.0 moveto
(Step 1) show
71.0 -110.0 moveto
(PAIR) show
61.0 -166.0 moveto
(Ready!) show
71.0 -222.0 moveto
(PAIR) show
64.0 -264.0 moveto
(Step 2) show
71.0 -306.0 moveto
(PAIR) show
61.0 -362.0 moveto
(Ready!) show
71.0 -418.0 moveto
(PAIR) show
64.0 -460.0 moveto
(Step 3) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4531 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4531 a 274 x Fj(This)i(is)g(a)f(classic)h
(pattern)f(for)f(multithreading)f(with)i(\330MQ:)-2 4822
y
SDict begin H.S end
 -2 4822 a -2 4822 a
SDict begin 13 H.A end
 -2 4822 a -2 4822 a
SDict begin [/View [/XYZ H.V]/Dest (0:1082) cvn /DEST pdfmark end
 -2 4822 a -2
4832 a
SDict begin H.S end
 -2 4832 a -2 4832 a
SDict begin 13 H.A end
 -2 4832 a -2 4832 a
SDict begin [/View [/XYZ H.V]/Dest (0:1083) cvn /DEST pdfmark end
 -2 4832
a Black 463 4975 a Fj(1.)p Black 546 4975 a
SDict begin H.S end
 546 4975
a 546 4975 a
SDict begin 13 H.A end
 546 4975 a 546 4975 a
SDict begin [/View [/XYZ H.V]/Dest (0:1084) cvn /DEST pdfmark end
 546 4975 a Fj(T)-7
b(w)o(o)20 b(threads)g(communicate)e(o)o(v)o(er)1606
4975 y
SDict begin H.S end
 1606 4975 a 1606 4975 a
SDict begin 13 H.A end
 1606 4975 a 1606 4975
a
SDict begin [/View [/XYZ H.V]/Dest (0:1085) cvn /DEST pdfmark end
 1606 4975 a Fg(inproc)p Fj(,)h(using)h(a)g(shared)g(conte)o(xt.)-2
4993 y
SDict begin H.S end
 -2 4993 a -2 4993 a
SDict begin 13 H.A end
 -2 4993 a -2 4993 a
SDict begin [/View [/XYZ H.V]/Dest (0:1086) cvn /DEST pdfmark end
 -2 4993
a Black 463 5124 a Fj(2.)p Black 546 5124 a
SDict begin H.S end
 546 5124
a 546 5124 a
SDict begin 13 H.A end
 546 5124 a 546 5124 a
SDict begin [/View [/XYZ H.V]/Dest (0:1087) cvn /DEST pdfmark end
 546 5124 a Fj(The)g(parent)f(thread)
g(creates)h(one)g(sock)o(et,)g(binds)f(it)i(to)g(an)f(inproc://)f
(endpoint,)f(and)3024 5124 y
SDict begin H.S end
 3024 5124 a 3024 5124 a
SDict begin 13 H.A end

3024 5124 a 3024 5124 a
SDict begin [/View [/XYZ H.V]/Dest (0:1088) cvn /DEST pdfmark end
 3024 5124 a Fi(then)h Fj(starts)i(the)f(child)p
Black 3800 5569 a Fi(70)p Black eop end
%%Page: 71 85
TeXDict begin 71 84 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.71) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 546 72 a Fj(thread,)19 b(passing)h(the)g(conte)o(xt)f
(to)h(it.)-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:1089) cvn /DEST pdfmark end
 -2
90 a Black 463 222 a Fj(3.)p Black 546 222 a
SDict begin H.S end
 546 222
a 546 222 a
SDict begin 13 H.A end
 546 222 a 546 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:1090) cvn /DEST pdfmark end
 546 222 a Fj(The)g(child)f(thread)h
(creates)g(the)g(second)f(sock)o(et,)h(connects)f(it)i(to)g(that)f
(inproc://)f(endpoint,)f(and)3372 222 y
SDict begin H.S end
 3372 222 a 3372
222 a
SDict begin 13 H.A end
 3372 222 a 3372 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:1091) cvn /DEST pdfmark end
 3372 222 a Fi(then)h Fj(signals)i(to)546
330 y(the)f(parent)f(thread)g(that)i(it')-5 b(s)21 b(ready)-5
b(.)-2 514 y
SDict begin H.S end
 -2 514 a -2 514 a
SDict begin 13 H.A end
 -2 514 a -2 514 a
SDict begin [/View [/XYZ H.V]/Dest (0:1092) cvn /DEST pdfmark end
 -2 514
a 396 604 a Fj(Note)20 b(that)h(multithreading)c(code)j(using)g(this)g
(pattern)g(is)h(not)f(scalable)g(out)g(to)g(processes.)g(If)g(you)f
(use)3419 604 y
SDict begin H.S end
 3419 604 a 3419 604 a
SDict begin 13 H.A end
 3419 604 a 3419
604 a
SDict begin [/View [/XYZ H.V]/Dest (0:1093) cvn /DEST pdfmark end
 3419 604 a Fg(inproc)h Fj(and)396 712 y(sock)o(et)g(pairs,)g(you)
f(are)i(b)n(uilding)e(a)h(tightly-bound)d(application,)h(i.e.)j(one)e
(where)h(your)f(threads)g(are)h(structurally)396 820
y(interdependent.)d(Do)j(this)h(when)f(lo)n(w)g(latenc)o(y)f(is)i
(really)f(vital.)g(The)g(other)f(design)h(pattern)f(is)i(a)g
(loosely-bound)396 928 y(application,)e(where)g(threads)h(ha)n(v)o(e)f
(their)h(o)n(wn)g(conte)o(xt)f(and)h(communicate)e(o)o(v)o(er)2838
928 y
SDict begin H.S end
 2838 928 a 2838 928 a
SDict begin 13 H.A end
 2838 928 a 2838 928 a
SDict begin [/View [/XYZ H.V]/Dest (0:1094) cvn /DEST pdfmark end
 2838
928 a Fg(ipc)j Fj(or)3084 928 y
SDict begin H.S end
 3084 928 a 3084 928 a
SDict begin 13 H.A end

3084 928 a 3084 928 a
SDict begin [/View [/XYZ H.V]/Dest (0:1095) cvn /DEST pdfmark end
 3084 928 a Fg(tcp)p Fj(.)f(Y)-9
b(ou)19 b(can)h(easily)396 1036 y(break)f(loosely-bound)e(threads)j
(into)g(separate)f(processes.)-2 1220 y
SDict begin H.S end
 -2 1220 a -2
1220 a
SDict begin 13 H.A end
 -2 1220 a -2 1220 a
SDict begin [/View [/XYZ H.V]/Dest (0:1096) cvn /DEST pdfmark end
 -2 1220 a 396 1310 a Fj(This)i(is)g(the)f
(\002rst)h(time)f(we')l(v)o(e)f(sho)n(wn)h(an)g(e)o(xample)f(using)g(P)
-8 b(AIR)22 b(sock)o(ets.)e(Why)g(use)g(P)-8 b(AIR?)21
b(Other)f(sock)o(et)396 1417 y(combinations)e(might)i(seem)g(to)h(w)o
(ork)e(b)n(ut)h(the)o(y)g(all)h(ha)n(v)o(e)e(side-ef)n(fects)h(that)g
(could)f(interfere)g(with)h(signaling:)-2 1435 y
SDict begin H.S end
 -2 1435
a -2 1435 a
SDict begin 13 H.A end
 -2 1435 a -2 1435 a
SDict begin [/View [/XYZ H.V]/Dest (0:1097) cvn /DEST pdfmark end
 -2 1435 a -2 1445 a
SDict begin H.S end
 -2
1445 a -2 1445 a
SDict begin 13 H.A end
 -2 1445 a -2 1445 a
SDict begin [/View [/XYZ H.V]/Dest (0:1098) cvn /DEST pdfmark end
 -2 1445 a Black
396 1588 a Fe(\225)p Black 479 1588 a
SDict begin H.S end
 479 1588 a 479
1588 a
SDict begin 13 H.A end
 479 1588 a 479 1588 a
SDict begin [/View [/XYZ H.V]/Dest (0:1099) cvn /DEST pdfmark end
 479 1588 a Fj(Y)-9 b(ou)20
b(can)g(use)g(PUSH)h(for)f(the)g(sender)f(and)h(PULL)g(for)g(the)g
(recei)n(v)o(er)-5 b(.)19 b(This)h(looks)g(simple)g(and)g(will)h(w)o
(ork,)e(b)n(ut)479 1696 y(remember)g(that)h(PUSH)h(will)g(load-balance)
d(messages)i(to)g(all)h(a)n(v)n(ailable)f(recei)n(v)o(ers.)f(If)h(you)f
(by)h(accident)f(start)479 1803 y(tw)o(o)i(recei)n(v)o(ers)e(\(e.g.)g
(you)g(already)g(ha)n(v)o(e)h(one)g(running)e(and)h(you)h(start)g(a)h
(second\),)e(you')o(ll)g("lose")h(half)g(of)g(your)479
1911 y(signals.)g(P)-8 b(AIR)22 b(has)e(the)g(adv)n(antage)f(of)g
(refusing)g(more)h(than)f(one)h(connection;)e(the)i(pair)g(is)3197
1911 y
SDict begin H.S end
 3197 1911 a 3197 1911 a
SDict begin 13 H.A end
 3197 1911 a 3197 1911
a
SDict begin [/View [/XYZ H.V]/Dest (0:1100) cvn /DEST pdfmark end
 3197 1911 a Fi(e)n(xclusive)p Fj(.)-2 1929 y
SDict begin H.S end
 -2 1929
a -2 1929 a
SDict begin 13 H.A end
 -2 1929 a -2 1929 a
SDict begin [/View [/XYZ H.V]/Dest (0:1101) cvn /DEST pdfmark end
 -2 1929 a Black 396 2061
a Fe(\225)p Black 479 2061 a
SDict begin H.S end
 479 2061 a 479 2061 a
SDict begin 13 H.A end
 479
2061 a 479 2061 a
SDict begin [/View [/XYZ H.V]/Dest (0:1102) cvn /DEST pdfmark end
 479 2061 a Fj(Y)-9 b(ou)20 b(can)g(use)g(DEALER)g
(for)g(the)g(sender)g(and)f(R)m(OUTER)i(for)e(the)i(recei)n(v)o(er)-5
b(.)19 b(R)m(OUTER)h(ho)n(we)n(v)o(er)e(wraps)i(your)479
2169 y(message)g(in)h(an)f("en)m(v)o(elope",)d(meaning)i(your)g
(zero-size)g(signal)h(turns)g(into)g(a)h(multi-part)d(message.)i(If)g
(you)g(don')o(t)479 2277 y(care)g(about)g(the)g(data,)g(and)f(treat)h
(an)o(ything)f(as)h(a)h(v)n(alid)f(signal,)g(and)f(if)i(you)e(don')o(t)
g(read)g(more)h(than)f(once)h(from)f(the)479 2385 y(sock)o(et,)h(that)g
(w)o(on')o(t)f(matter)-5 b(.)21 b(If)f(ho)n(we)n(v)o(er)e(you)h(decide)
h(to)g(send)g(real)g(data,)g(you)f(will)i(suddenly)e(\002nd)h(R)m
(OUTER)479 2493 y(pro)o(viding)e(you)h(with)h("wrong")f(messages.)h
(DEALER)g(also)h(load-balances,)d(gi)n(ving)h(the)h(same)g(risk)g(as)h
(PUSH.)-2 2511 y
SDict begin H.S end
 -2 2511 a -2 2511 a
SDict begin 13 H.A end
 -2 2511 a -2 2511
a
SDict begin [/View [/XYZ H.V]/Dest (0:1103) cvn /DEST pdfmark end
 -2 2511 a Black 396 2642 a Fe(\225)p Black 479 2642
a
SDict begin H.S end
 479 2642 a 479 2642 a
SDict begin 13 H.A end
 479 2642 a 479 2642 a
SDict begin [/View [/XYZ H.V]/Dest (0:1104) cvn /DEST pdfmark end
 479 2642
a Fj(Y)-9 b(ou)20 b(can)g(use)g(PUB)i(for)d(the)h(sender)g(and)f(SUB)j
(for)d(the)h(recei)n(v)o(er)-5 b(.)19 b(This)i(will)g(correctly)d(deli)
n(v)o(er)h(your)g(messages)479 2750 y(e)o(xactly)g(as)i(you)e(sent)h
(them)f(and)g(PUB)i(does)f(not)f(load-balance)f(as)i(PUSH)h(or)e
(DEALER)h(do.)f(Ho)n(we)n(v)o(er)g(you)f(need)479 2858
y(to)j(con\002gure)d(the)i(subscriber)f(with)h(an)g(empty)f
(subscription,)g(which)g(is)i(anno)o(ying.)d(W)-7 b(orse,)20
b(the)g(reliability)g(of)g(the)479 2966 y(PUB-SUB)i(link)e(is)h(timing)
e(dependent)f(and)i(messages)g(can)g(get)g(lost)h(if)g(the)f(SUB)h
(sock)o(et)f(is)h(connecting)d(while)479 3074 y(the)i(PUB)i(sock)o(et)e
(is)h(sending)e(its)i(messages.)-2 3258 y
SDict begin H.S end
 -2 3258 a -2
3258 a
SDict begin 13 H.A end
 -2 3258 a -2 3258 a
SDict begin [/View [/XYZ H.V]/Dest (0:1105) cvn /DEST pdfmark end
 -2 3258 a 396 3348 a Fj(F)o(or)f(these)g
(reasons,)g(P)-8 b(AIR)21 b(mak)o(es)f(the)g(best)h(choice)e(for)h
(coordination)d(between)j(pairs)g(of)g(threads.)-2 3376
y
SDict begin H.S end
 -2 3376 a -2 3376 a
SDict begin 13 H.A end
 -2 3376 a -2 3376 a
SDict begin [/View [/XYZ H.V]/Dest (0:1106) cvn /DEST pdfmark end
 -2 3376 a 359
x Fh(2.8.)39 b(Node)f(Coor)m(dination)1568 3735 y
SDict begin H.S end
 1568
3735 a 1568 3735 a
SDict begin 22.464 H.A end
 1568 3735 a 1568 3735 a
SDict begin [/View [/XYZ H.V]/Dest (7.26.1) cvn /DEST pdfmark end
 1568 3735
a -2 3903 a
SDict begin H.S end
 -2 3903 a -2 3903 a
SDict begin 13 H.A end
 -2 3903 a -2 3903 a
SDict begin [/View [/XYZ H.V]/Dest (0:1108) cvn /DEST pdfmark end
 -2
3903 a 396 4009 a Fj(When)20 b(you)g(w)o(ant)g(to)g(coordinate)e
(nodes,)i(P)-8 b(AIR)21 b(sock)o(ets)f(w)o(on')o(t)f(w)o(ork)h(well)h
(an)o(y)e(more.)g(This)h(is)i(one)d(of)h(the)g(fe)n(w)396
4117 y(areas)h(where)e(the)h(strate)o(gies)g(for)g(threads)f(and)h
(nodes)g(are)g(dif)n(ferent.)e(Principally)h(nodes)h(come)f(and)h(go)g
(whereas)396 4225 y(threads)g(are)g(static.)h(P)-8 b(AIR)21
b(sock)o(ets)f(do)g(not)g(automatically)f(reconnect)f(if)j(the)f
(remote)f(node)g(goes)h(a)o(w)o(ay)g(and)g(comes)396
4333 y(back.)-2 4500 y
SDict begin H.S end
 -2 4500 a -2 4500 a
SDict begin 13 H.A end
 -2 4500 a
-2 4500 a
SDict begin [/View [/XYZ H.V]/Dest (0:1109) cvn /DEST pdfmark end
 -2 4500 a 396 4607 a Fj(The)g(second)f(signi\002cant)h(dif)n
(ference)e(between)i(threads)f(and)h(nodes)f(is)i(that)g(you)e
(typically)g(ha)n(v)o(e)h(a)h(\002x)o(ed)e(number)f(of)396
4715 y(threads)i(b)n(ut)g(a)h(more)e(v)n(ariable)g(number)f(of)i
(nodes.)g(Let')-5 b(s)20 b(tak)o(e)h(one)e(of)h(our)g(earlier)f
(scenarios)h(\(the)g(weather)f(serv)o(er)396 4823 y(and)h(clients\))g
(and)g(use)g(node)f(coordination)f(to)i(ensure)f(that)i(subscribers)e
(don')o(t)g(lose)h(data)g(when)g(starting)g(up.)-2 5007
y
SDict begin H.S end
 -2 5007 a -2 5007 a
SDict begin 13 H.A end
 -2 5007 a -2 5007 a
SDict begin [/View [/XYZ H.V]/Dest (0:1110) cvn /DEST pdfmark end
 -2 5007 a 396
5097 a Fj(This)h(is)g(ho)n(w)e(the)i(application)d(will)j(w)o(ork:)-2
5115 y
SDict begin H.S end
 -2 5115 a -2 5115 a
SDict begin 13 H.A end
 -2 5115 a -2 5115 a
SDict begin [/View [/XYZ H.V]/Dest (0:1111) cvn /DEST pdfmark end
 -2 5115
a -2 5125 a
SDict begin H.S end
 -2 5125 a -2 5125 a
SDict begin 13 H.A end
 -2 5125 a -2 5125 a
SDict begin [/View [/XYZ H.V]/Dest (0:1112) cvn /DEST pdfmark end
 -2
5125 a Black 3800 5569 a Fi(71)p Black eop end
%%Page: 72 86
TeXDict begin 72 85 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.72) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1128) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1113) cvn /DEST pdfmark end
 479 72 a Fj(The)20
b(publisher)f(kno)n(ws)g(in)i(adv)n(ance)d(ho)n(w)i(man)o(y)f
(subscribers)g(it)i(e)o(xpects.)e(This)i(is)g(just)g(a)f(magic)g
(number)e(it)j(gets)479 180 y(from)e(some)n(where.)-2
181 y
SDict begin H.S end
 -2 181 a -2 181 a
SDict begin 13 H.A end
 -2 181 a -2 181 a
SDict begin [/View [/XYZ H.V]/Dest (0:1114) cvn /DEST pdfmark end
 -2 181 a Black
396 330 a Fe(\225)p Black 479 330 a
SDict begin H.S end
 479 330 a 479 330
a
SDict begin 13 H.A end
 479 330 a 479 330 a
SDict begin [/View [/XYZ H.V]/Dest (0:1115) cvn /DEST pdfmark end
 479 330 a Fj(The)h(publisher)f(starts)i(up)f(and)
f(w)o(aits)j(for)d(all)i(subscribers)e(to)h(connect.)f(This)i(is)g(the)
f(node)f(coordination)e(part.)479 438 y(Each)j(subscriber)f(subscribes)
h(and)f(then)h(tells)h(the)f(publisher)f(it')-5 b(s)21
b(ready)f(via)g(another)e(sock)o(et.)-2 456 y
SDict begin H.S end
 -2 456
a -2 456 a
SDict begin 13 H.A end
 -2 456 a -2 456 a
SDict begin [/View [/XYZ H.V]/Dest (0:1116) cvn /DEST pdfmark end
 -2 456 a Black 396 587 a
Fe(\225)p Black 479 587 a
SDict begin H.S end
 479 587 a 479 587 a
SDict begin 13 H.A end
 479 587
a 479 587 a
SDict begin [/View [/XYZ H.V]/Dest (0:1117) cvn /DEST pdfmark end
 479 587 a Fj(When)i(the)h(publisher)d(has)j(all)f
(subscribers)g(connected,)e(it)j(starts)g(to)f(publish)f(data.)-2
771 y
SDict begin H.S end
 -2 771 a -2 771 a
SDict begin 13 H.A end
 -2 771 a -2 771 a
SDict begin [/View [/XYZ H.V]/Dest (0:1118) cvn /DEST pdfmark end
 -2 771 a 396
861 a Fj(In)h(this)h(case)g(we')o(ll)f(use)g(a)h(REQ-REP)g(sock)o(et)f
(\003o)n(w)g(to)g(synchronize)e(subscribers)i(and)f(publisher\()p
0 TeXcolorgray 3316 861 a
SDict begin H.S end
 3316 861 a Fj(Figure)e(2-14)3705
861 y
SDict begin 13 H.L end
 3705 861 a 3705 861 a
SDict begin [/Subtype /Link/Dest (0:figure-22) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3705 861 a Black -1 w Fj(\).)396
969 y(Here)j(is)h(the)g(publisher:)-2 987 y
SDict begin H.S end
 -2 987 a
-2 987 a
SDict begin 13 H.A end
 -2 987 a -2 987 a
SDict begin [/View [/XYZ H.V]/Dest (0:syncpub-php) cvn /DEST pdfmark
end
 -2 987 a 396 1170 a Fk(Example)g(2-13.)d
(Synchr)o(onized)i(publisher)i(\(syncpub)m(.php\))-2
1270 y
SDict begin H.S end
 -2 1270 a -2 1270 a
SDict begin 11.7 H.A end
 -2 1270 a -2 1270 a
SDict begin [/View [/XYZ H.V]/Dest (0:1122) cvn /DEST pdfmark end
 -2 1270
a 396 1351 a Fg(<?php)396 1448 y(/)441 1461 y(*)441 1558
y(*)531 1545 y(Synchronized)43 b(publisher)441 1655 y(*)441
1752 y(*)531 1739 y(@author)g(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1849 y(*)486
1836 y(/)396 2031 y(//)90 b(We)44 b(wait)g(for)h(10)f(subscribers)396
2128 y(define\("SUBSCRIBERS_EXPECTED",)c(10\);)396 2322
y($context)k(=)g(new)h(ZMQContext\(\);)396 2516 y(//)90
b(Socket)43 b(to)i(talk)f(to)h(clients)396 2613 y($publisher)e(=)i(new)
f(ZMQSocket\($context,)e(ZMQ::SOCKET_PUB\);)396 2711
y($publisher->bind\("tcp://)1476 2724 y(*)1521 2711 y(:5561"\);)396
2905 y(//)90 b(Socket)43 b(to)i(receive)f(signals)396
3002 y($syncservice)f(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REP\);)396 3099 y($syncservice->bind\("tcp://)1566
3112 y(*)1611 3099 y(:5562"\);)396 3293 y(//)90 b(Get)44
b(synchronization)e(from)i(subscribers)396 3390 y($subscribers)f(=)i
(0;)396 3488 y(while)f(\($subscribers)f(<)i(SUBSCRIBERS_EXPECTED\))c({)
441 3585 y(//)89 b(-)45 b(wait)f(for)h(synchronization)d(request)441
3682 y($string)i(=)g($syncservice->recv\(\);)441 3779
y(//)89 b(-)45 b(send)f(synchronization)f(reply)441 3876
y($syncservice->send\(""\);)441 3973 y($subscribers++;)396
4070 y(})396 4265 y(//)90 b(Now)44 b(broadcast)f(exactly)h(1M)g
(updates)g(followed)g(by)g(END)396 4362 y(for)h(\($update_nbr)d(=)j(0;)
g($update_nbr)e(<)h(1000000;)g($update_nbr++\))e({)441
4459 y($publisher->send\("Rhubarb"\);)396 4556 y(})396
4750 y($publisher->send\("END"\);)396 4945 y(sleep)i(\(1\);)627
b(//)90 b(Give)44 b(0MQ/2.0.x)f(time)h(to)h(flush)f(outpu)-2
4957 y
SDict begin H.S end
 -2 4957 a -2 4957 a
SDict begin 13 H.A end
 -2 4957 a -2 4957 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-22) cvn /DEST pdfmark
end
 -2 4957
a Black 3800 5569 a Fi(72)p Black eop end
%%Page: 73 87
TeXDict begin 73 86 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.73) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-14.)e(Pub-Sub)j(Synchr)o
(onization)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172
a
SDict begin [/View [/XYZ H.V]/Dest (0:1125) cvn /DEST pdfmark end
 -2 172 a 396 3131 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3131 a @beginspecial 0 @llx
-350 @lly 220 @urx 0 @ury 2200 @rwi @setspecial
%%BeginDocument: images/fig22.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -350 220 0
%%HiResBoundingBox: 0.0 -350.0 220.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -94.00029754638672 lineto
198.00030517578125 -94.00029754638672 lineto
198.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -94.00029754638672 moveto
28.00029945373535 -115.00029754638672 lineto
28.00029945373535 -119.66696421305339 29.666966756184895 -122.00029754638672 33.000301361083984 -122.00029754638672 curveto
116.00029754638672 -122.00029754638672 lineto
116.00029754638672 -122.00029754638672 lineto
116.00029754638672 -94.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
120.00029754638672 -94.00029754638672 moveto
120.00029754638672 -122.00029754638672 lineto
193.00030517578125 -122.00029754638672 lineto
196.3336385091146 -122.00029754638672 198.00030517578125 -119.66696421305339 198.00030517578125 -115.00029754638672 curveto
198.00030517578125 -94.00029754638672 lineto
198.00030517578125 -94.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
33.000301361083984 -234.00030517578125 moveto
29.666966756184895 -234.00030517578125 28.00029945373535 -236.3336385091146 28.00029945373535 -241.00030517578125 curveto
28.00029945373535 -262.00030517578125 lineto
116.00029754638672 -262.00030517578125 lineto
116.00029754638672 -234.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
120.00029754638672 -234.00030517578125 moveto
120.00029754638672 -262.00030517578125 lineto
198.00030517578125 -262.00030517578125 lineto
198.00030517578125 -241.00030517578125 lineto
198.00030517578125 -236.3336385091146 196.3336385091146 -234.00030517578125 193.00030517578125 -234.00030517578125 curveto
120.00029754638672 -234.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -262.00030517578125 moveto
28.00029945373535 -318.00030517578125 lineto
198.00030517578125 -318.00030517578125 lineto
198.00030517578125 -262.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -91.0 lineto
195.0 -91.0 lineto
195.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -91.0 lineto
195.0 -91.0 lineto
195.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -91.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
113.0 -119.0 lineto
113.0 -119.0 lineto
113.0 -91.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -91.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
113.0 -119.0 lineto
113.0 -119.0 lineto
113.0 -91.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
117.0 -91.0 moveto
117.0 -119.0 lineto
190.0 -119.0 lineto
193.33333333333334 -119.0 195.0 -116.66666666666667 195.0 -112.0 curveto
195.0 -91.0 lineto
195.0 -91.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
117.0 -91.0 moveto
117.0 -119.0 lineto
190.0 -119.0 lineto
193.33333333333334 -119.0 195.0 -116.66666666666667 195.0 -112.0 curveto
195.0 -91.0 lineto
195.0 -91.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
30.0 -231.0 moveto
26.666666666666668 -231.0 25.0 -233.33333333333334 25.0 -238.0 curveto
25.0 -259.0 lineto
113.0 -259.0 lineto
113.0 -231.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
30.0 -231.0 moveto
26.666666666666668 -231.0 25.0 -233.33333333333334 25.0 -238.0 curveto
25.0 -259.0 lineto
113.0 -259.0 lineto
113.0 -231.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
117.0 -231.0 moveto
117.0 -259.0 lineto
195.0 -259.0 lineto
195.0 -238.0 lineto
195.0 -233.33333333333334 193.33333333333334 -231.0 190.0 -231.0 curveto
117.0 -231.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
117.0 -231.0 moveto
117.0 -259.0 lineto
195.0 -259.0 lineto
195.0 -238.0 lineto
195.0 -233.33333333333334 193.33333333333334 -231.0 190.0 -231.0 curveto
117.0 -231.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -259.0 moveto
25.0 -315.0 lineto
195.0 -315.0 lineto
195.0 -259.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -259.0 moveto
25.0 -315.0 lineto
195.0 -315.0 lineto
195.0 -259.0 lineto
closepath
stroke
newpath
135.0 -133.0 moveto
135.0 -153.0 lineto
stroke
newpath
155.0 -168.0 moveto
155.0 -181.0 lineto
stroke
newpath
195.0 -168.0 moveto
195.0 -181.0 lineto
stroke
newpath
175.0 -196.0 moveto
175.0 -217.0 lineto
stroke
newpath
65.0 -119.0 moveto
65.0 -217.0 lineto
stroke
newpath
175.0 -119.0 moveto
175.0 -168.0 lineto
stroke
newpath
135.0 -182.0 moveto
135.0 -231.0 lineto
stroke
newpath
135.0 -126.0 moveto
130.0 -140.0 lineto
140.0 -140.0 lineto
closepath
fill
newpath
60.0 -210.0 moveto
65.0 -224.0 lineto
70.0 -210.0 lineto
closepath
fill
newpath
170.0 -210.0 moveto
175.0 -224.0 lineto
180.0 -210.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
68.0 -68.0 moveto
(Publisher) show
50.0 -110.0 moveto
(PUB) show
141.0 -110.0 moveto
(REP) show
123.0 -166.0 moveto
(\(1\)) show
52.0 -180.0 moveto
([3]}}) show
163.0 -194.0 moveto
(\(2\)) show
51.0 -250.0 moveto
(SUB) show
140.0 -250.0 moveto
(REQ) show
67.0 -292.0 moveto
(Subscriber) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3131 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3131 a 274 x Fj(And)f(here)g(is)h(the)f
(subscriber:)-2 3406 y
SDict begin H.S end
 -2 3406 a -2 3406 a
SDict begin 13 H.A end
 -2 3406 a
-2 3406 a
SDict begin [/View [/XYZ H.V]/Dest (0:syncsub-php) cvn /DEST pdfmark
end
 -2 3406 a 396 3606 a Fk(Example)h(2-14.)d(Synchr)o(onized)i
(subscriber)h(\(syncsub)m(.php\))-2 3706 y
SDict begin H.S end
 -2 3706 a
-2 3706 a
SDict begin 11.7 H.A end
 -2 3706 a -2 3706 a
SDict begin [/View [/XYZ H.V]/Dest (0:1131) cvn /DEST pdfmark end
 -2 3706 a 396 3786 a Fg(<?php)396
3883 y(/)441 3896 y(*)441 3993 y(*)531 3980 y(Synchronized)43
b(subscriber)441 4090 y(*)441 4188 y(*)531 4175 y(@author)g(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
4285 y(*)486 4272 y(/)396 4466 y($context)g(=)g(new)h(ZMQContext\(\);)
396 4660 y(//)90 b(First,)43 b(connect)h(our)g(subscriber)g(socket)396
4757 y($subscriber)f(=)i($context->getSocket\(ZMQ::SOCKET_SUB\);)396
4854 y($subscriber->connect\("tcp://localhost:556)o(1"\);)396
4952 y($subscriber->setSockOpt\(ZMQ::SOCKOPT_SUBS)o(CRIBE,)38
b(""\);)396 5146 y(//)90 b(Second,)43 b(synchronize)g(with)h(publisher)
p Black 3800 5569 a Fi(73)p Black eop end
%%Page: 74 88
TeXDict begin 74 87 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.74) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fg($syncclient)43 b(=)i
($context->getSocket\(ZMQ::SOCKET_REQ\);)396 170 y
($syncclient->connect\("tcp://localhost:556)o(2"\);)396
364 y(//)90 b(-)44 b(send)g(a)h(synchronization)d(request)396
461 y($syncclient->send\(""\);)396 655 y(//)90 b(-)44
b(wait)g(for)h(synchronization)d(reply)396 752 y($string)i(=)h
($syncclient->recv\(\);)396 947 y(//)90 b(Third,)43 b(get)i(our)f
(updates)g(and)g(report)g(how)g(many)g(we)h(got)396 1044
y($update_nbr)e(=)i(0;)396 1141 y(while)f(\(true\))g({)441
1238 y($string)g(=)g($subscriber->recv\(\);)441 1335
y(if\($string)f(==)i("END"\))f({)486 1432 y(break;)441
1530 y(})441 1627 y($update_nbr++;)396 1724 y(})396 1821
y(printf)g(\("Received)f(\045d)i(updates)e(\045s",)i($update_nbr,)d
(PHP_EOL\))-2 1998 y
SDict begin H.S end
 -2 1998 a -2 1998 a
SDict begin 13 H.A end
 -2 1998 a -2
1998 a
SDict begin [/View [/XYZ H.V]/Dest (0:1132) cvn /DEST pdfmark end
 -2 1998 a 396 2095 a Fj(This)21 b(Bash)f(shell)h(script)f(will)h
(start)g(ten)f(subscribers)f(and)h(then)g(the)g(publisher:)-2
2196 y
SDict begin H.S end
 -2 2196 a -2 2196 a
SDict begin 11.7 H.A end
 -2 2196 a -2 2196 a
SDict begin [/View [/XYZ H.V]/Dest (0:1133) cvn /DEST pdfmark end
 -2 2196
a 396 2275 a Fg(echo)44 b("Starting)g(subscribers...")396
2372 y(for)h(\(\(a=0;)e(a<10;)h(a++\)\);)g(do)576 2469
y(syncsub)f(&)396 2566 y(done)396 2664 y(echo)h("Starting)g
(publisher...")396 2761 y(syncpub)-2 2938 y
SDict begin H.S end
 -2 2938 a
-2 2938 a
SDict begin 13 H.A end
 -2 2938 a -2 2938 a
SDict begin [/View [/XYZ H.V]/Dest (0:1134) cvn /DEST pdfmark end
 -2 2938 a 396 3035 a Fj(Which)20
b(gi)n(v)o(es)g(us)h(this)f(satisfying)g(output:)-2 3136
y
SDict begin H.S end
 -2 3136 a -2 3136 a
SDict begin 11.7 H.A end
 -2 3136 a -2 3136 a
SDict begin [/View [/XYZ H.V]/Dest (0:1135) cvn /DEST pdfmark end
 -2 3136 a 396
3215 a Fg(Starting)44 b(subscribers...)396 3312 y(Starting)g
(publisher...)396 3409 y(Received)g(1000000)f(updates)396
3506 y(Received)h(1000000)f(updates)396 3603 y(Received)h(1000000)f
(updates)396 3701 y(Received)h(1000000)f(updates)396
3798 y(Received)h(1000000)f(updates)396 3895 y(Received)h(1000000)f
(updates)396 3992 y(Received)h(1000000)f(updates)396
4089 y(Received)h(1000000)f(updates)396 4186 y(Received)h(1000000)f
(updates)396 4283 y(Received)h(1000000)f(updates)-2 4461
y
SDict begin H.S end
 -2 4461 a -2 4461 a
SDict begin 13 H.A end
 -2 4461 a -2 4461 a
SDict begin [/View [/XYZ H.V]/Dest (0:1136) cvn /DEST pdfmark end
 -2 4461 a 396
4557 a Fj(W)-7 b(e)22 b(can')o(t)d(assume)h(that)g(the)g(SUB)i(connect)
d(will)i(be)f(\002nished)f(by)h(the)g(time)h(the)f(REQ/REP)h(dialog)e
(is)j(complete.)396 4665 y(There)e(are)g(no)g(guarantees)e(that)j
(outbound)c(connects)i(will)i(\002nish)f(in)h(an)o(y)e(order)g(whatsoe)
n(v)o(er)m(,)f(if)j(you')l(re)d(using)i(an)o(y)396 4773
y(transport)f(e)o(xcept)948 4773 y
SDict begin H.S end
 948 4773 a 948 4773
a
SDict begin 13 H.A end
 948 4773 a 948 4773 a
SDict begin [/View [/XYZ H.V]/Dest (0:1137) cvn /DEST pdfmark end
 948 4773 a Fg(inproc)p Fj(.)h(So,)g(the)g(e)o
(xample)f(does)h(a)h(brute-force)c(sleep)j(of)g(one)g(second)f(between)
h(subscribing,)396 4881 y(and)g(sending)f(the)h(REQ/REP)h
(synchronization.)-2 5065 y
SDict begin H.S end
 -2 5065 a -2 5065 a
SDict begin 13 H.A end
 -2 5065
a -2 5065 a
SDict begin [/View [/XYZ H.V]/Dest (0:1138) cvn /DEST pdfmark end
 -2 5065 a 396 5155 a Fj(A)g(more)e(rob)n(ust)h(model)f
(could)h(be:)-2 5156 y
SDict begin H.S end
 -2 5156 a -2 5156 a
SDict begin 13 H.A end
 -2 5156 a
-2 5156 a
SDict begin [/View [/XYZ H.V]/Dest (0:1139) cvn /DEST pdfmark end
 -2 5156 a -2 5166 a
SDict begin H.S end
 -2 5166 a -2 5166 a
SDict begin 13 H.A end
 -2
5166 a -2 5166 a
SDict begin [/View [/XYZ H.V]/Dest (0:1140) cvn /DEST pdfmark end
 -2 5166 a Black 3800 5569 a Fi(74)p
Black eop end
%%Page: 75 89
TeXDict begin 75 88 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.75) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1141) cvn /DEST pdfmark end
 479 72 a Fj(Publisher)20
b(opens)f(PUB)i(sock)o(et)f(and)g(starts)h(sending)e("Hello")h
(messages)g(\(not)g(data\).)-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2
90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:1142) cvn /DEST pdfmark end
 -2 90 a Black 396 222 a Fe(\225)p Black
479 222 a
SDict begin H.S end
 479 222 a 479 222 a
SDict begin 13 H.A end
 479 222 a 479 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:1143) cvn /DEST pdfmark end
 479
222 a Fj(Subscribers)f(connect)g(SUB)j(sock)o(et)e(and)f(when)h(the)o
(y)f(recei)n(v)o(e)g(a)i(Hello)f(message)g(the)o(y)g(tell)h(the)f
(publisher)f(via)h(a)479 330 y(REQ/REP)h(sock)o(et)f(pair)-5
b(.)-2 348 y
SDict begin H.S end
 -2 348 a -2 348 a
SDict begin 13 H.A end
 -2 348 a -2 348 a
SDict begin [/View [/XYZ H.V]/Dest (0:1144) cvn /DEST pdfmark end
 -2 348
a Black 396 479 a Fe(\225)p Black 479 479 a
SDict begin H.S end
 479 479 a
479 479 a
SDict begin 13 H.A end
 479 479 a 479 479 a
SDict begin [/View [/XYZ H.V]/Dest (0:1145) cvn /DEST pdfmark end
 479 479 a Fj(When)20 b(the)h(publisher)d
(has)j(had)e(all)i(the)f(necessary)g(con\002rmations,)e(it)j(starts)g
(to)f(send)g(real)g(data.)-2 539 y
SDict begin H.S end
 -2 539 a -2 539 a
SDict begin 13 H.A end

-2 539 a -2 539 a
SDict begin [/View [/XYZ H.V]/Dest (0:1146) cvn /DEST pdfmark end
 -2 539 a 359 x Fh(2.9.)39 b(Zer)m(o)g(Cop)n(y)983
898 y
SDict begin H.S end
 983 898 a 983 898 a
SDict begin 22.464 H.A end
 983 898 a 983 898 a
SDict begin [/View [/XYZ H.V]/Dest (7.27.1) cvn /DEST pdfmark end
 983 898
a -2 1094 a
SDict begin H.S end
 -2 1094 a -2 1094 a
SDict begin 13 H.A end
 -2 1094 a -2 1094 a
SDict begin [/View [/XYZ H.V]/Dest (0:1148) cvn /DEST pdfmark end
 -2
1094 a 396 1172 a Fj(\330MQ')-5 b(s)21 b(message)f(API)h(lets)g(you)e
(can)h(send)g(and)g(recei)n(v)o(e)f(messages)h(directly)f(from)h(and)f
(to)h(application)f(b)n(uf)n(fers)396 1280 y(without)h(cop)o(ying)e
(data.)i(W)-7 b(e)21 b(call)g("zero-cop)o(y",)c(and)j(it)h(can)f(impro)
o(v)o(e)e(performance)f(in)j(some)g(applications.)f(Lik)o(e)396
1388 y(all)i(optimizations,)e(use)h(this)h(when)e(you)h(kno)n(w)f(it)i
(helps,)e(and)h(measure)f(before)g(and)h(after)-5 b(.)20
b(Zero-cop)o(y)e(mak)o(es)i(your)396 1496 y(code)g(more)f(comple)o(x.)
-2 1680 y
SDict begin H.S end
 -2 1680 a -2 1680 a
SDict begin 13 H.A end
 -2 1680 a -2 1680 a
SDict begin [/View [/XYZ H.V]/Dest (0:1149) cvn /DEST pdfmark end
 -2
1680 a 396 1770 a Fj(T)-7 b(o)21 b(do)e(zero-cop)o(y)f(you)i(use)1235
1770 y
SDict begin H.S end
 1235 1770 a 1235 1770 a
SDict begin 13 H.A end
 1235 1770 a 1235 1770
a
SDict begin [/View [/XYZ H.V]/Dest (0:1150) cvn /DEST pdfmark end
 1235 1770 a Fg(zmq-msg-init-data[3])d Fj(to)k(create)f(a)g(message)g
(that)h(refers)e(to)i(a)f(block)f(of)h(data)396 1878
y(already)f(allocated)h(on)g(the)g(heap)f(with)1554 1878
y
SDict begin H.S end
 1554 1878 a 1554 1878 a
SDict begin 13 H.A end
 1554 1878 a 1554 1878 a
SDict begin [/View [/XYZ H.V]/Dest (0:1151) cvn /DEST pdfmark end
 1554
1878 a Fg(malloc\(\))p Fj(,)g(and)g(then)h(you)f(pass)i(that)f(to)2798
1878 y
SDict begin H.S end
 2798 1878 a 2798 1878 a
SDict begin 13 H.A end
 2798 1878 a 2798 1878
a
SDict begin [/View [/XYZ H.V]/Dest (0:1152) cvn /DEST pdfmark end
 2798 1878 a Fg(zmq-msg-send[3])p Fj(.)e(When)i(you)396
1986 y(create)g(the)g(message)g(you)g(also)g(pass)h(a)g(function)d
(that)i(\330MQ)h(will)g(call)f(to)h(free)e(the)i(block)e(of)h(data,)g
(when)f(it)i(has)396 2093 y(\002nished)f(sending)f(the)h(message.)g
(This)g(is)h(the)g(simplest)f(e)o(xample,)f(assuming)g('b)n(uf)n(fer')f
(is)j(a)g(block)e(of)h(1000)f(bytes)396 2201 y(allocated)h(on)g(the)g
(heap:)-2 2302 y
SDict begin H.S end
 -2 2302 a -2 2302 a
SDict begin 11.7 H.A end
 -2 2302 a -2 2302
a
SDict begin [/View [/XYZ H.V]/Dest (0:1153) cvn /DEST pdfmark end
 -2 2302 a 396 2382 a Fg(void)44 b(my-free)g(\(void)1248
2395 y(*)1293 2382 y(data,)g(void)1786 2395 y(*)1831
2382 y(hint\))g({)576 2479 y(free)g(\(data\);)396 2576
y(})396 2673 y(//)90 b(Send)44 b(message)f(from)i(buffer,)e(which)h(we)
h(allocate)e(and)i(0MQ)f(will)g(free)g(for)g(us)396 2770
y(zmq-msg-t)g(message;)396 2867 y(zmq-msg-init-data)e(\(&message,)h
(buffer,)h(1000,)g(my-free,)g(NULL\);)396 2964 y(zmq-msg-send)f
(\(socket,)h(&message,)f(0\);)-2 3142 y
SDict begin H.S end
 -2 3142 a -2
3142 a
SDict begin 13 H.A end
 -2 3142 a -2 3142 a
SDict begin [/View [/XYZ H.V]/Dest (0:1154) cvn /DEST pdfmark end
 -2 3142 a 396 3238 a Fj(There)20
b(is)h(no)f(w)o(ay)g(to)g(do)g(zero-cop)o(y)e(on)i(recei)n(v)o(e:)f
(\330MQ)h(deli)n(v)o(ers)f(you)h(a)g(b)n(uf)n(fer)f(that)h(you)g(can)g
(store)g(as)h(long)e(as)i(you)396 3346 y(wish)g(b)n(ut)f(it)h(will)g
(not)f(write)g(data)g(directly)g(into)f(application)g(b)n(uf)n(fers.)-2
3530 y
SDict begin H.S end
 -2 3530 a -2 3530 a
SDict begin 13 H.A end
 -2 3530 a -2 3530 a
SDict begin [/View [/XYZ H.V]/Dest (0:1155) cvn /DEST pdfmark end
 -2 3530
a 396 3620 a Fj(On)h(writing,)g(\330MQ')-5 b(s)21 b(multi-part)d
(messages)j(w)o(ork)e(nicely)h(together)f(with)h(zero-cop)o(y)-5
b(.)17 b(In)j(traditional)f(messaging)396 3728 y(you)h(need)f(to)h
(marshal)g(dif)n(ferent)f(b)n(uf)n(fers)g(together)f(into)i(one)g(b)n
(uf)n(fer)f(that)h(you)f(can)h(send.)g(That)g(means)g(cop)o(ying)396
3836 y(data.)g(W)m(ith)h(\330MQ,)f(you)f(can)h(send)g(multiple)g(b)n
(uf)n(fers)f(coming)f(from)i(dif)n(ferent)e(sources)i(as)h(indi)n
(vidual)d(message)396 3944 y(frames.)i(Send)f(each)h(\002eld)h(as)g(a)f
(length-delimited)e(frame.)h(T)-7 b(o)20 b(the)g(application)f(it)i
(looks)f(lik)o(e)g(a)h(series)g(of)f(send)f(and)396 4052
y(recv)h(calls.)h(But)f(internally)f(the)h(multiple)g(parts)g(get)g
(written)g(to)h(the)f(netw)o(ork)f(and)h(read)f(back)h(with)g(single)g
(system)396 4160 y(calls,)h(so)g(it')-5 b(s)21 b(v)o(ery)e(ef)n
(\002cient.)-2 4188 y
SDict begin H.S end
 -2 4188 a -2 4188 a
SDict begin 13 H.A end
 -2 4188 a -2
4188 a
SDict begin [/View [/XYZ H.V]/Dest (0:1156) cvn /DEST pdfmark end
 -2 4188 a 359 x Fh(2.10.)39 b(Pub-Sub)e(Messa)o(g)q(e)h(En)-6
b(velopes)2346 4547 y
SDict begin H.S end
 2346 4547 a 2346 4547 a
SDict begin 22.464 H.A end
 2346 4547
a 2346 4547 a
SDict begin [/View [/XYZ H.V]/Dest (7.28.1) cvn /DEST pdfmark end
 2346 4547 a -2 4745 a
SDict begin H.S end
 -2 4745 a -2 4745
a
SDict begin 13 H.A end
 -2 4745 a -2 4745 a
SDict begin [/View [/XYZ H.V]/Dest (0:1158) cvn /DEST pdfmark end
 -2 4745 a 396 4821 a Fj(In)20 b(the)g(pub-sub)f
(pattern)g(we)h(can)g(split)h(the)f(k)o(e)o(y)g(into)g(a)h(separate)e
(message)h(frame)g(that)g(we)h(call)f(an)g("en)m(v)o(elope".)e(If)396
4929 y(you)i(w)o(ant)g(to)g(use)h(pub-sub)d(en)m(v)o(elopes,)g(mak)o(e)
i(them)f(yourself.)g(It')-5 b(s)21 b(optional,)d(and)i(in)g(pre)n
(vious)f(pub-sub)f(e)o(xamples)396 5037 y(we)j(didn')o(t)d(do)i(this.)h
(Using)f(a)g(pub-sub)f(en)m(v)o(elope)f(is)j(a)f(little)h(more)f(w)o
(ork)f(for)h(simple)g(cases)h(b)n(ut)f(it')-5 b(s)21
b(cleaner)396 5145 y(especially)f(for)g(real)g(cases,)g(where)g(the)g
(k)o(e)o(y)g(and)f(the)i(data)f(are)g(naturally)f(separate)g(things.)p
Black 3800 5569 a Fi(75)p Black eop end
%%Page: 76 90
TeXDict begin 76 89 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.76) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1159) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Here)20 b(is)h(what)g(a)f
(publish-subscribe)e(message)i(with)g(an)g(en)m(v)o(elope)e(looks)i
(lik)o(e:)-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-23) cvn /DEST pdfmark
end
 -2
90 a 396 274 a Fk(Figur)o(e)g(2-15.)e(Pub-Sub)j(En)m(v)o(elope)f(with)h
(Separate)e(K)n(ey)-2 374 y
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 13 H.A end
 -2 374
a -2 374 a
SDict begin [/View [/XYZ H.V]/Dest (0:1162) cvn /DEST pdfmark end
 -2 374 a 396 1240 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 1240 a @beginspecial
0 @llx -99 @lly 424 @urx 0 @ury 4240 @rwi @setspecial
%%BeginDocument: images/fig23.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -99 424 0
%%HiResBoundingBox: 0.0 -99.0 424.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -29.400239944458008 moveto
102.40023803710938 -49.40024185180664 lineto
214.40023803710938 -49.40024185180664 lineto
214.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -52.40024185180664 moveto
102.40023803710938 -73.40023803710938 lineto
214.40023803710938 -73.40023803710938 lineto
214.40023803710938 -52.40024185180664 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
212.0 -47.0 lineto
212.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
212.0 -47.0 lineto
212.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -71.0 lineto
212.0 -71.0 lineto
212.0 -50.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -71.0 lineto
212.0 -71.0 lineto
212.0 -50.0 lineto
closepath
stroke
/Helvetica findfont
11 scalefont setfont
18.0 -43.0 moveto
(Frame 1) show
112.0 -43.0 moveto
(Key) show
260.0 -43.0 moveto
(Message envelope) show
18.0 -65.0 moveto
(Frame 2) show
113.0 -65.0 moveto
(Data) show
264.0 -65.0 moveto
(Actual message body) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1240 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1240 a -2 1406 a
SDict begin H.S end
 -2 1406
a -2 1406 a
SDict begin 13 H.A end
 -2 1406 a -2 1406 a
SDict begin [/View [/XYZ H.V]/Dest (0:1165) cvn /DEST pdfmark end
 -2 1406 a 396 1514 a
Fj(Recall)i(that)f(subscriptions)f(do)h(a)h(pre\002x)e(match.)h(That)g
(is,)g("all)h(messages)f(starting)g(with)h(XYZ".)f(The)f(ob)o(vious)396
1622 y(question)g(is:)j(ho)n(w)d(to)i(delimit)f(k)o(e)o(ys)f(from)h
(data)g(so)g(that)h(the)f(pre\002x)f(match)h(doesn')o(t)f(accidentally)
f(match)i(data.)g(The)396 1730 y(best)h(answer)f(is)h(to)f(use)h(an)f
(en)m(v)o(elope,)d(since)k(the)f(match)g(w)o(on')o(t)f(cross)h(a)h
(frame)e(boundary)-5 b(.)-2 1914 y
SDict begin H.S end
 -2 1914 a -2 1914
a
SDict begin 13 H.A end
 -2 1914 a -2 1914 a
SDict begin [/View [/XYZ H.V]/Dest (0:1166) cvn /DEST pdfmark end
 -2 1914 a 396 2004 a Fj(Here)20
b(is)h(a)g(minimalist)f(e)o(xample)f(of)h(ho)n(w)f(pub-sub)g(en)m(v)o
(elopes)f(look)h(in)i(code.)e(This)h(publisher)f(sends)h(messages)h(of)
396 2112 y(tw)o(o)g(types,)e(A)i(and)f(B.)h(The)f(en)m(v)o(elope)d
(holds)j(the)g(message)g(type:)-2 2130 y
SDict begin H.S end
 -2 2130 a -2
2130 a
SDict begin 13 H.A end
 -2 2130 a -2 2130 a
SDict begin [/View [/XYZ H.V]/Dest (0:psenvpub-php) cvn /DEST pdfmark
end
 -2 2130 a 396 2313 a Fk(Example)h(2-15.)d
(Pub-Sub)j(en)m(v)o(elope)f(publisher)h(\(psen)m(vpub)m(.php\))-2
2413 y
SDict begin H.S end
 -2 2413 a -2 2413 a
SDict begin 11.7 H.A end
 -2 2413 a -2 2413 a
SDict begin [/View [/XYZ H.V]/Dest (0:1169) cvn /DEST pdfmark end
 -2 2413
a 396 2493 a Fg(<?php)396 2591 y(/)441 2604 y(*)441 2701
y(*)531 2688 y(Pubsub)44 b(envelope)f(publisher)441 2798
y(*)531 2785 y(@author)g(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 2895 y(*)486
2882 y(/)396 3076 y(//)90 b(Prepare)43 b(our)i(context)e(and)i
(publisher)396 3173 y($context)f(=)g(new)h(ZMQContext\(\);)396
3270 y($publisher)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_PUB\);)396 3368 y($publisher->bind\("tcp://)1476
3381 y(*)1521 3368 y(:5563"\);)396 3562 y(while)i(\(true\))g({)441
3659 y(//)89 b(Write)44 b(two)h(messages,)e(each)h(with)g(an)h
(envelope)e(and)i(content)441 3756 y($publisher->send\("A",)c
(ZMQ::MODE_SNDMORE\);)441 3853 y($publisher->send\("We)h(don't)i(want)g
(to)g(see)h(this"\);)441 3950 y($publisher->send\("B",)c
(ZMQ::MODE_SNDMORE\);)441 4048 y($publisher->send\("We)h(would)i(like)g
(to)g(see)h(this"\);)441 4145 y(sleep)f(\(1\);)396 4242
y(})396 4436 y(//)90 b(We)44 b(never)g(get)g(her)-2 4614
y
SDict begin H.S end
 -2 4614 a -2 4614 a
SDict begin 13 H.A end
 -2 4614 a -2 4614 a
SDict begin [/View [/XYZ H.V]/Dest (0:1170) cvn /DEST pdfmark end
 -2 4614 a 396
4710 a Fj(The)20 b(subscriber)f(w)o(ants)i(only)e(messages)h(of)g(type)
g(B:)-2 4728 y
SDict begin H.S end
 -2 4728 a -2 4728 a
SDict begin 13 H.A end
 -2 4728 a -2 4728
a
SDict begin [/View [/XYZ H.V]/Dest (0:psenvsub-php) cvn /DEST pdfmark
end
 -2 4728 a Black 3798 5569 a Fi(76)p Black eop end
%%Page: 77 91
TeXDict begin 77 90 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.77) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Example)21 b(2-16.)d(Pub-Sub)j(en)m(v)o
(elope)f(subscriber)h(\(psen)m(vsub)m(.php\))-2 172 y
SDict begin H.S end

-2 172 a -2 172 a
SDict begin 11.7 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1173) cvn /DEST pdfmark end
 -2 172 a 396 253
a Fg(<?php)396 350 y(/)441 363 y(*)441 460 y(*)531 447
y(Pubsub)44 b(envelope)f(subscriber)441 557 y(*)531 544
y(@author)g(Ian)i(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
654 y(*)486 641 y(/)396 835 y(//)90 b(Prepare)43 b(our)i(context)e(and)
i(subscriber)396 933 y($context)f(=)g(new)h(ZMQContext\(\);)396
1030 y($subscriber)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_SUB\);)396 1127 y
($subscriber->connect\("tcp://localhost:556)o(3"\);)396
1224 y($subscriber->setSockOpt\(ZMQ::SOCKOPT_SUBS)o(CRIBE,)c("B"\);)396
1418 y(while)44 b(\(true\))g({)441 1515 y(//)89 b(Read)45
b(envelope)e(with)h(address)441 1613 y($address)g(=)g
($subscriber->recv\(\);)441 1710 y(//)89 b(Read)45 b(message)e
(contents)441 1807 y($contents)g(=)i($subscriber->recv\(\);)441
1904 y(printf)f(\("[\045s])g(\045s\045s",)g($address,)f($contents,)g
(PHP_EOL\);)396 2001 y(})396 2098 y(//)90 b(We)44 b(never)g(get)g(here)
-2 2276 y
SDict begin H.S end
 -2 2276 a -2 2276 a
SDict begin 13 H.A end
 -2 2276 a -2 2276 a
SDict begin [/View [/XYZ H.V]/Dest (0:1174) cvn /DEST pdfmark end
 -2
2276 a 396 2372 a Fj(When)20 b(you)g(run)f(the)h(tw)o(o)h(programs,)d
(the)i(subscriber)f(should)g(sho)n(w)h(you)f(this:)-2
2473 y
SDict begin H.S end
 -2 2473 a -2 2473 a
SDict begin 11.7 H.A end
 -2 2473 a -2 2473 a
SDict begin [/View [/XYZ H.V]/Dest (0:1175) cvn /DEST pdfmark end
 -2 2473
a 396 2552 a Fg([B])45 b(We)f(would)g(like)g(to)h(see)f(this)396
2649 y([B])h(We)f(would)g(like)g(to)h(see)f(this)396
2747 y([B])h(We)f(would)g(like)g(to)h(see)f(this)396
2844 y([B])h(We)f(would)g(like)g(to)h(see)f(this)396
2941 y(...)-2 3108 y
SDict begin H.S end
 -2 3108 a -2 3108 a
SDict begin 13 H.A end
 -2 3108 a -2
3108 a
SDict begin [/View [/XYZ H.V]/Dest (0:1176) cvn /DEST pdfmark end
 -2 3108 a 396 3215 a Fj(This)21 b(e)o(xamples)e(sho)n(ws)h(that)
g(the)g(subscription)f(\002lter)i(rejects)f(or)g(accepts)g(the)g
(entire)g(multi-part)f(message)h(\(k)o(e)o(y)f(plus)396
3323 y(data\).)h(Y)-9 b(ou)19 b(w)o(on')o(t)g(get)i(part)f(of)f(a)i
(multi-part)e(message,)h(e)n(v)o(er)-5 b(.)-2 3507 y
SDict begin H.S end

-2 3507 a -2 3507 a
SDict begin 13 H.A end
 -2 3507 a -2 3507 a
SDict begin [/View [/XYZ H.V]/Dest (0:1177) cvn /DEST pdfmark end
 -2 3507 a 396
3597 a Fj(If)20 b(you)g(subscribe)f(to)h(multiple)g(publishers)f(and)h
(you)f(w)o(ant)h(to)g(kno)n(w)g(their)g(identity)f(so)i(that)f(you)f
(can)h(send)g(them)396 3705 y(data)g(via)h(another)d(sock)o(et)i(\(and)
g(this)g(is)h(a)g(f)o(airly)f(typical)g(use-case\),)f(create)h(a)g
(three-part)f(message:)-2 3723 y
SDict begin H.S end
 -2 3723 a -2 3723 a
SDict begin 13 H.A end

-2 3723 a -2 3723 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-24) cvn /DEST pdfmark
end
 -2 3723 a 396 3906 a Fk(Figur)o(e)h(2-16.)e
(Pub-Sub)j(En)m(v)o(elope)f(with)h(Sender)g(Addr)o(ess)-2
4006 y
SDict begin H.S end
 -2 4006 a -2 4006 a
SDict begin 13 H.A end
 -2 4006 a -2 4006 a
SDict begin [/View [/XYZ H.V]/Dest (0:1180) cvn /DEST pdfmark end
 -2 4006
a 396 5056 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 5056 a @beginspecial 0 @llx -121 @lly
432 @urx 0 @ury 4320 @rwi @setspecial
%%BeginDocument: images/fig24.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -121 432 0
%%HiResBoundingBox: 0.0 -121.0 432.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -29.400239944458008 moveto
102.40023803710938 -49.40024185180664 lineto
214.40023803710938 -49.40024185180664 lineto
214.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -52.40024185180664 moveto
102.40023803710938 -71.40023803710938 lineto
214.40023803710938 -71.40023803710938 lineto
214.40023803710938 -52.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -74.40023803710938 moveto
102.40023803710938 -95.40023803710938 lineto
214.40023803710938 -95.40023803710938 lineto
214.40023803710938 -74.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
212.0 -47.0 lineto
212.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
212.0 -47.0 lineto
212.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
212.0 -69.0 lineto
212.0 -50.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
212.0 -69.0 lineto
212.0 -50.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -93.0 lineto
212.0 -93.0 lineto
212.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -93.0 lineto
212.0 -93.0 lineto
212.0 -72.0 lineto
closepath
stroke
/Helvetica findfont
11 scalefont setfont
18.0 -43.0 moveto
(Frame 1) show
112.0 -43.0 moveto
(Key) show
267.0 -43.0 moveto
(Subscription key) show
18.0 -65.0 moveto
(Frame 2) show
120.0 -65.0 moveto
(Identity) show
270.0 -65.0 moveto
(Address of publisher) show
18.0 -87.0 moveto
(Frame 3) show
113.0 -87.0 moveto
(Data) show
264.0 -87.0 moveto
(Actual message body) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 5056 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 5056 a -2 5139 a
SDict begin H.S end
 -2 5139
a -2 5139 a
SDict begin 13 H.A end
 -2 5139 a -2 5139 a
SDict begin [/View [/XYZ H.V]/Dest (0:1183) cvn /DEST pdfmark end
 -2 5139 a Black 3797
5569 a Fi(77)p Black eop end
%%Page: 78 92
TeXDict begin 78 91 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.78) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 94 a Fh(2.11.)39 b(High)f(W)-6 b(ater)40
b(Marks)1564 94 y
SDict begin H.S end
 1564 94 a 1564 94 a
SDict begin 22.464 H.A end
 1564 94 a 1564
94 a
SDict begin [/View [/XYZ H.V]/Dest (7.29.1) cvn /DEST pdfmark end
 1564 94 a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2 292 a -2
292 a
SDict begin [/View [/XYZ H.V]/Dest (0:1185) cvn /DEST pdfmark end
 -2 292 a 396 368 a Fj(When)20 b(you)g(can)g(send)f(messages)i
(rapidly)e(from)g(process)h(to)g(process,)f(you)h(soon)f(disco)o(v)o
(er)g(that)h(memory)f(is)i(a)396 476 y(precious)e(resource,)g(and)h
(one)f(that)i(can)f(be)g(tri)n(vially)f(\002lled)i(up.)e(A)i(fe)n(w)f
(seconds)g(of)g(delay)f(some)n(where)g(in)h(a)h(process)396
584 y(can)f(turn)g(into)g(a)g(backlog)f(that)h(blo)n(ws)g(up)g(a)h
(serv)o(er)m(,)d(unless)j(you)e(understand)f(the)i(problem)f(and)g(tak)
o(e)i(precautions.)-2 768 y
SDict begin H.S end
 -2 768 a -2 768 a
SDict begin 13 H.A end
 -2 768
a -2 768 a
SDict begin [/View [/XYZ H.V]/Dest (0:1186) cvn /DEST pdfmark end
 -2 768 a 396 858 a Fj(The)e(problem)d(is)k(this:)f(if)g(you)
f(ha)n(v)o(e)g(process)g(A)h(sending)f(messages)g(to)h(process)f(B,)i
(which)e(suddenly)f(gets)i(v)o(ery)e(b)n(usy)396 966
y(\(garbage)h(collection,)h(CPU)i(o)o(v)o(erload,)d(whate)n(v)o(er\),)g
(then)i(what)g(happens)e(to)j(the)f(messages)g(that)h(process)e(A)i(w)o
(ants)396 1074 y(to)g(send?)e(Some)h(will)h(sit)g(in)g(B')-5
b(s)21 b(netw)o(ork)e(b)n(uf)n(fers.)g(Some)h(will)h(sit)g(on)f(the)g
(Ethernet)f(wire)h(itself.)h(Some)f(will)h(sit)g(in)396
1182 y(A)-9 b(')k(s)21 b(netw)o(ork)e(b)n(uf)n(fers.)g(And)h(the)g
(rest)h(will)f(accumulate)f(in)i(A)-9 b(')k(s)21 b(memory)-5
b(.)17 b(If)j(you)g(don')o(t)e(tak)o(e)i(some)g(precaution,)e(A)396
1290 y(can)i(easily)h(run)e(out)h(of)g(memory)e(and)i(crash.)g(It)g(is)
h(a)g(consistent,)e(classic)j(problem)c(with)i(message)g(brok)o(ers.)-2
1474 y
SDict begin H.S end
 -2 1474 a -2 1474 a
SDict begin 13 H.A end
 -2 1474 a -2 1474 a
SDict begin [/View [/XYZ H.V]/Dest (0:1187) cvn /DEST pdfmark end
 -2 1474
a 396 1564 a Fj(What)h(are)f(the)g(answers?)g(One)g(is)h(to)g(pass)f
(the)h(problem)d(upstream.)h(A)i(is)g(getting)e(the)h(messages)h(from)e
(some)n(where)396 1672 y(else.)i(So)f(tell)h(that)f(process,)g("stop!")
f(And)h(so)h(on.)e(This)i(is)g(called)f("\003o)n(w)g(control".)f(It)h
(sounds)f(great,)h(b)n(ut)g(what)g(if)396 1779 y(you')l(re)f(sending)g
(out)g(a)i(T)-7 b(witter)21 b(feed?)e(Do)h(you)g(tell)g(the)h(whole)e
(w)o(orld)h(to)g(stop)g(tweeting)g(while)g(B)h(gets)g(its)g(act)396
1887 y(together?)-2 2071 y
SDict begin H.S end
 -2 2071 a -2 2071 a
SDict begin 13 H.A end
 -2 2071
a -2 2071 a
SDict begin [/View [/XYZ H.V]/Dest (0:1188) cvn /DEST pdfmark end
 -2 2071 a 396 2161 a Fj(Flo)n(w)g(control)e(w)o(orks)g(in)i
(some)f(cases)h(b)n(ut)f(in)g(others.)g(The)g(transport)e(layer)i(can')
o(t)f(tell)i(the)f(application)f(layer)h(to)396 2269
y("stop")g(an)o(y)g(more)f(than)h(a)g(subw)o(ay)g(system)g(can)g(tell)h
(a)g(lar)o(ge)e(b)n(usiness,)h("please)g(k)o(eep)g(your)f(staf)n(f)h
(at)h(w)o(ork)e(another)396 2377 y(half)h(an)g(hour)m(,)f(I'm)g(too)h
(b)n(usy".)-2 2561 y
SDict begin H.S end
 -2 2561 a -2 2561 a
SDict begin 13 H.A end
 -2 2561 a -2
2561 a
SDict begin [/View [/XYZ H.V]/Dest (0:1189) cvn /DEST pdfmark end
 -2 2561 a 396 2651 a Fj(The)g(answer)g(for)g(messaging)f(is)i
(to)f(set)h(limits)g(on)f(the)g(size)h(of)f(b)n(uf)n(fers,)f(and)h
(then)f(when)h(we)g(reach)g(those)g(limits,)396 2759
y(tak)o(e)h(some)f(sensible)g(action.)f(In)h(most)g(cases)h(\(not)f
(for)f(a)i(subw)o(ay)e(system,)i(though\),)c(the)k(answer)e(is)j(to)e
(thro)n(w)f(a)o(w)o(ay)396 2867 y(messages.)h(In)g(a)h(fe)n(w)f
(others,)f(it')-5 b(s)22 b(to)e(w)o(ait.)-2 3051 y
SDict begin H.S end
 -2
3051 a -2 3051 a
SDict begin 13 H.A end
 -2 3051 a -2 3051 a
SDict begin [/View [/XYZ H.V]/Dest (0:1190) cvn /DEST pdfmark end
 -2 3051 a 396 3141
a Fj(\330MQ)h(uses)f(the)h(concept)e(of)g("high)h(w)o(ater)g(mark")f
(or)h(HWM)h(to)f(de\002ne)g(the)g(capacity)g(of)g(its)h(internal)e
(pipes.)h(Each)396 3249 y(connection)e(out)i(of)g(a)h(sock)o(et)f(or)g
(into)g(a)g(sock)o(et)g(has)h(its)g(o)n(wn)f(pipe,)f(and)h(HWM)h
(capacity)-5 b(.)-2 3433 y
SDict begin H.S end
 -2 3433 a -2 3433 a
SDict begin 13 H.A end
 -2 3433
a -2 3433 a
SDict begin [/View [/XYZ H.V]/Dest (0:1191) cvn /DEST pdfmark end
 -2 3433 a 396 3523 a Fj(In)20 b(\330MQ/2.x)f(the)i(HWM)g(w)
o(as)g(in\002nite)f(by)f(def)o(ault.)h(In)g(\330MQ/3.x)f(it')-5
b(s)21 b(set)g(to)f(1,000)f(by)h(def)o(ault,)f(which)h(is)h(more)396
3631 y(sensible.)f(If)g(you')l(re)f(still)i(using)f(\330MQ/2.x)f(you)g
(should)g(al)o(w)o(ays)i(set)g(a)g(HWM)g(on)e(your)g(sock)o(ets,)h(be)g
(it)h(1,000)e(to)396 3739 y(match)h(\330MQ/3.x)f(or)h(another)f
(\002gure)g(that)i(tak)o(es)f(into)g(account)f(your)g(message)h(sizes.)
-2 3923 y
SDict begin H.S end
 -2 3923 a -2 3923 a
SDict begin 13 H.A end
 -2 3923 a -2 3923 a
SDict begin [/View [/XYZ H.V]/Dest (0:1192) cvn /DEST pdfmark end
 -2
3923 a 396 4013 a Fj(The)g(high)f(w)o(ater)h(mark)f(af)n(fects)h(both)f
(the)h(transmit)g(and)f(recei)n(v)o(e)g(b)n(uf)n(fers)g(of)h(a)g
(single)g(sock)o(et.)g(Some)f(sock)o(ets)h(\(PUB,)396
4121 y(PUSH\))h(only)e(ha)n(v)o(e)h(transmit)g(b)n(uf)n(fers.)f(Some)g
(\(SUB,)i(PULL,)f(REQ,)h(REP\))f(only)g(ha)n(v)o(e)f(recei)n(v)o(e)g(b)
n(uf)n(fers.)g(Some)396 4229 y(\(DEALER,)h(R)m(OUTER,)g(P)-8
b(AIR\))21 b(ha)n(v)o(e)f(both)f(transmit)h(and)g(recei)n(v)o(e)f(b)n
(uf)n(fers.)-2 4410 y
SDict begin H.S end
 -2 4410 a -2 4410 a
SDict begin 13 H.A end
 -2 4410 a -2
4410 a
SDict begin [/View [/XYZ H.V]/Dest (0:1193) cvn /DEST pdfmark end
 -2 4410 a 396 4503 a Fj(When)h(your)f(sock)o(et)h(reaches)g(its)
h(high-w)o(ater)e(mark,)g(it)i(will)g(either)e(block)h(or)g(drop)f
(data)h(depending)d(on)j(the)g(sock)o(et)396 4611 y(type.)f(PUB)i(sock)
o(ets)f(will)h(drop)e(data)h(if)g(the)o(y)f(reach)g(their)h(high-w)o
(ater)e(mark,)h(while)h(other)f(sock)o(et)h(types)f(will)i(block.)-2
4795 y
SDict begin H.S end
 -2 4795 a -2 4795 a
SDict begin 13 H.A end
 -2 4795 a -2 4795 a
SDict begin [/View [/XYZ H.V]/Dest (0:1194) cvn /DEST pdfmark end
 -2 4795
a 396 4884 a Fj(Ov)o(er)f(the)704 4884 y
SDict begin H.S end
 704 4884 a 704
4884 a
SDict begin 13 H.A end
 704 4884 a 704 4884 a
SDict begin [/View [/XYZ H.V]/Dest (0:1195) cvn /DEST pdfmark end
 704 4884 a Fg(inproc)g Fj(transport,)e
(the)j(sender)e(and)h(recei)n(v)o(er)e(share)i(the)h(same)f(b)n(uf)n
(fers,)f(so)h(the)h(real)f(HWM)h(is)g(the)f(sum)396 4992
y(of)g(the)g(HWM)h(set)f(by)g(both)f(sides.)i(This)f(means)f(in)i(ef)n
(fect)e(that)h(if)g(one)g(side)g(does)g(not)g(set)g(a)h(HWM,)f(there)g
(is)h(no)e(limit)396 5100 y(to)i(the)f(b)n(uf)n(fer)f(size.)-2
5111 y
SDict begin H.S end
 -2 5111 a -2 5111 a
SDict begin 13 H.A end
 -2 5111 a -2 5111 a
SDict begin [/View [/XYZ H.V]/Dest (0:1196) cvn /DEST pdfmark end
 -2 5111
a Black 3800 5569 a Fi(78)p Black eop end
%%Page: 79 93
TeXDict begin 79 92 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.79) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1205) cvn /DEST pdfmark end
 -2 -201 a 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black -2 94 a Fh(2.12.)39 b(Missing)f(Messa)o(g)q(e)g(Pr)m
(ob)o(lem)f(Solver)2626 94 y
SDict begin H.S end
 2626 94 a 2626 94 a
SDict begin 22.464 H.A end
 2626
94 a 2626 94 a
SDict begin [/View [/XYZ H.V]/Dest (7.30.1) cvn /DEST pdfmark end
 2626 94 a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2
292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:1198) cvn /DEST pdfmark end
 -2 292 a 396 368 a Fj(As)21 b(you)f(b)n(uild)f
(applications)g(with)i(\330MQ)f(you)f(will)i(come)f(across)g(this)h
(problem)d(more)i(than)f(once:)h(losing)396 476 y(messages)h(that)f
(you)f(e)o(xpect)g(to)i(recei)n(v)o(e.)e(W)-7 b(e)21
b(ha)n(v)o(e)f(put)f(together)g(a)i(diagram\()p 0 TeXcolorgray
2704 476 a
SDict begin H.S end
 2704 476 a Fj(Figure)c(2-17)3093 476 y
SDict begin 13 H.L end
 3093
476 a 3093 476 a
SDict begin [/Subtype /Link/Dest (0:figure-25) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3093 476 a Black -2 w Fj(\))k(that)f(w)o(alks)h
(through)d(the)396 584 y(most)i(common)f(causes)h(for)g(this.)-2
585 y
SDict begin H.S end
 -2 585 a -2 585 a
SDict begin 13 H.A end
 -2 585 a -2 585 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-25) cvn /DEST pdfmark
end
 -2 585 a Black
3800 5569 a Fi(79)p Black eop end
%%Page: 80 94
TeXDict begin 80 93 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.80) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(2-17.)e(Missing)k(Message)
e(Pr)o(oblem)g(Solv)o(er)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2
172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1202) cvn /DEST pdfmark end
 -2 172 a 396 5581 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 5581 a @beginspecial
0 @llx -644 @lly 405 @urx 0 @ury 4050 @rwi @setspecial
%%BeginDocument: images/fig25.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -644 405 0
%%HiResBoundingBox: 0.0 -644.0 405.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -18.500150680541992 moveto
13.500149726867676 -46.50014877319336 lineto
103.50015258789062 -46.50014877319336 lineto
103.50015258789062 -18.500150680541992 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -25.500150680541992 moveto
148.50015258789062 -60.50014877319336 lineto
238.50015258789062 -60.50014877319336 lineto
238.50015258789062 -25.500150680541992 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
283.5001525878906 -25.500150680541992 moveto
283.5001525878906 -60.50014877319336 lineto
368.5001525878906 -60.50014877319336 lineto
368.5001525878906 -25.500150680541992 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -67.50015258789062 moveto
13.500149726867676 -102.50015258789062 lineto
103.50015258789062 -102.50015258789062 lineto
103.50015258789062 -67.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -81.50015258789062 moveto
148.50015258789062 -116.50015258789062 lineto
238.50015258789062 -116.50015258789062 lineto
238.50015258789062 -81.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
283.5001525878906 -81.50015258789062 moveto
283.5001525878906 -123.50015258789062 lineto
368.5001525878906 -123.50015258789062 lineto
368.5001525878906 -81.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
143.50015258789062 -137.50015258789062 moveto
143.50015258789062 -165.50015258789062 lineto
248.50015258789062 -165.50015258789062 lineto
248.50015258789062 -137.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -158.50015258789062 moveto
13.500149726867676 -200.50015258789062 lineto
103.50015258789062 -200.50015258789062 lineto
103.50015258789062 -158.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.5001525878906 -158.50015258789062 moveto
278.5001525878906 -200.50015258789062 lineto
383.5001525878906 -200.50015258789062 lineto
383.5001525878906 -158.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -214.50015258789062 moveto
148.50015258789062 -256.5001525878906 lineto
258.5001525878906 -256.5001525878906 lineto
258.5001525878906 -214.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
303.5001525878906 -214.50015258789062 moveto
303.5001525878906 -256.5001525878906 lineto
393.5001525878906 -256.5001525878906 lineto
393.5001525878906 -214.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -221.50015258789062 moveto
13.500149726867676 -249.50015258789062 lineto
103.50015258789062 -249.50015258789062 lineto
103.50015258789062 -221.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -270.5001525878906 moveto
13.500149726867676 -305.5001525878906 lineto
103.50015258789062 -305.5001525878906 lineto
103.50015258789062 -270.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -270.5001525878906 moveto
148.50015258789062 -305.5001525878906 lineto
238.50015258789062 -305.5001525878906 lineto
238.50015258789062 -270.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -326.5001525878906 moveto
13.500149726867676 -361.5001525878906 lineto
103.50015258789062 -361.5001525878906 lineto
103.50015258789062 -326.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -326.5001525878906 moveto
148.50015258789062 -361.5001525878906 lineto
238.50015258789062 -361.5001525878906 lineto
238.50015258789062 -326.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
283.5001525878906 -326.5001525878906 moveto
283.5001525878906 -361.5001525878906 lineto
378.5001525878906 -361.5001525878906 lineto
378.5001525878906 -326.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -389.5001525878906 moveto
148.50015258789062 -424.5001525878906 lineto
238.50015258789062 -424.5001525878906 lineto
238.50015258789062 -389.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
283.5001525878906 -389.5001525878906 moveto
283.5001525878906 -424.5001525878906 lineto
378.5001525878906 -424.5001525878906 lineto
378.5001525878906 -389.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -396.5001525878906 moveto
13.500149726867676 -431.5001525878906 lineto
103.50015258789062 -431.5001525878906 lineto
103.50015258789062 -396.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -445.5001525878906 moveto
148.50015258789062 -473.5001525878906 lineto
238.50015258789062 -473.5001525878906 lineto
238.50015258789062 -445.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -487.5001525878906 moveto
13.500149726867676 -522.5001220703125 lineto
103.50015258789062 -522.5001220703125 lineto
103.50015258789062 -487.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -487.5001525878906 moveto
148.50015258789062 -529.5001220703125 lineto
238.50015258789062 -529.5001220703125 lineto
238.50015258789062 -487.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
283.5001525878906 -487.5001525878906 moveto
283.5001525878906 -529.5001220703125 lineto
373.5001525878906 -529.5001220703125 lineto
373.5001525878906 -487.5001525878906 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -543.5001220703125 moveto
13.500149726867676 -578.5001220703125 lineto
103.50015258789062 -578.5001220703125 lineto
103.50015258789062 -543.5001220703125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.50015258789062 -543.5001220703125 moveto
148.50015258789062 -585.5001220703125 lineto
253.50015258789062 -585.5001220703125 lineto
253.50015258789062 -543.5001220703125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -599.5001220703125 moveto
13.500149726867676 -627.5001220703125 lineto
103.50015258789062 -627.5001220703125 lineto
103.50015258789062 -599.5001220703125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -17.0 moveto
12.0 -45.0 lineto
102.0 -45.0 lineto
102.0 -17.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.5 setlinewidth
1 setlinecap
[] 0 setdash
newpath
12.0 -17.0 moveto
12.0 -45.0 lineto
102.0 -45.0 lineto
102.0 -17.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -24.0 moveto
147.0 -59.0 lineto
237.0 -59.0 lineto
237.0 -24.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -24.0 moveto
147.0 -59.0 lineto
237.0 -59.0 lineto
237.0 -24.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
282.0 -24.0 moveto
282.0 -59.0 lineto
367.0 -59.0 lineto
367.0 -24.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
282.0 -24.0 moveto
282.0 -59.0 lineto
367.0 -59.0 lineto
367.0 -24.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -66.0 moveto
12.0 -101.0 lineto
102.0 -101.0 lineto
102.0 -66.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -66.0 moveto
12.0 -101.0 lineto
102.0 -101.0 lineto
102.0 -66.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -80.0 moveto
147.0 -115.0 lineto
237.0 -115.0 lineto
237.0 -80.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -80.0 moveto
147.0 -115.0 lineto
237.0 -115.0 lineto
237.0 -80.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
282.0 -80.0 moveto
282.0 -122.0 lineto
367.0 -122.0 lineto
367.0 -80.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
282.0 -80.0 moveto
282.0 -122.0 lineto
367.0 -122.0 lineto
367.0 -80.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
142.0 -136.0 moveto
142.0 -164.0 lineto
247.0 -164.0 lineto
247.0 -136.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
142.0 -136.0 moveto
142.0 -164.0 lineto
247.0 -164.0 lineto
247.0 -136.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -157.0 moveto
12.0 -199.0 lineto
102.0 -199.0 lineto
102.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -157.0 moveto
12.0 -199.0 lineto
102.0 -199.0 lineto
102.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
277.0 -157.0 moveto
277.0 -199.0 lineto
382.0 -199.0 lineto
382.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
277.0 -157.0 moveto
277.0 -199.0 lineto
382.0 -199.0 lineto
382.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -213.0 moveto
147.0 -255.0 lineto
257.0 -255.0 lineto
257.0 -213.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -213.0 moveto
147.0 -255.0 lineto
257.0 -255.0 lineto
257.0 -213.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
302.0 -213.0 moveto
302.0 -255.0 lineto
392.0 -255.0 lineto
392.0 -213.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
302.0 -213.0 moveto
302.0 -255.0 lineto
392.0 -255.0 lineto
392.0 -213.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -220.0 moveto
12.0 -248.0 lineto
102.0 -248.0 lineto
102.0 -220.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -220.0 moveto
12.0 -248.0 lineto
102.0 -248.0 lineto
102.0 -220.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -269.0 moveto
12.0 -304.0 lineto
102.0 -304.0 lineto
102.0 -269.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -269.0 moveto
12.0 -304.0 lineto
102.0 -304.0 lineto
102.0 -269.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -269.0 moveto
147.0 -304.0 lineto
237.0 -304.0 lineto
237.0 -269.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -269.0 moveto
147.0 -304.0 lineto
237.0 -304.0 lineto
237.0 -269.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -325.0 moveto
12.0 -360.0 lineto
102.0 -360.0 lineto
102.0 -325.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -325.0 moveto
12.0 -360.0 lineto
102.0 -360.0 lineto
102.0 -325.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -325.0 moveto
147.0 -360.0 lineto
237.0 -360.0 lineto
237.0 -325.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -325.0 moveto
147.0 -360.0 lineto
237.0 -360.0 lineto
237.0 -325.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
282.0 -325.0 moveto
282.0 -360.0 lineto
377.0 -360.0 lineto
377.0 -325.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
282.0 -325.0 moveto
282.0 -360.0 lineto
377.0 -360.0 lineto
377.0 -325.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -388.0 moveto
147.0 -423.0 lineto
237.0 -423.0 lineto
237.0 -388.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -388.0 moveto
147.0 -423.0 lineto
237.0 -423.0 lineto
237.0 -388.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
282.0 -388.0 moveto
282.0 -423.0 lineto
377.0 -423.0 lineto
377.0 -388.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
282.0 -388.0 moveto
282.0 -423.0 lineto
377.0 -423.0 lineto
377.0 -388.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -395.0 moveto
12.0 -430.0 lineto
102.0 -430.0 lineto
102.0 -395.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -395.0 moveto
12.0 -430.0 lineto
102.0 -430.0 lineto
102.0 -395.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -444.0 moveto
147.0 -472.0 lineto
237.0 -472.0 lineto
237.0 -444.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -444.0 moveto
147.0 -472.0 lineto
237.0 -472.0 lineto
237.0 -444.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -486.0 moveto
12.0 -521.0 lineto
102.0 -521.0 lineto
102.0 -486.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -486.0 moveto
12.0 -521.0 lineto
102.0 -521.0 lineto
102.0 -486.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -486.0 moveto
147.0 -528.0 lineto
237.0 -528.0 lineto
237.0 -486.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -486.0 moveto
147.0 -528.0 lineto
237.0 -528.0 lineto
237.0 -486.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
282.0 -486.0 moveto
282.0 -528.0 lineto
372.0 -528.0 lineto
372.0 -486.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
282.0 -486.0 moveto
282.0 -528.0 lineto
372.0 -528.0 lineto
372.0 -486.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -542.0 moveto
12.0 -577.0 lineto
102.0 -577.0 lineto
102.0 -542.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -542.0 moveto
12.0 -577.0 lineto
102.0 -577.0 lineto
102.0 -542.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -542.0 moveto
147.0 -584.0 lineto
252.0 -584.0 lineto
252.0 -542.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -542.0 moveto
147.0 -584.0 lineto
252.0 -584.0 lineto
252.0 -542.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
12.0 -598.0 moveto
12.0 -626.0 lineto
102.0 -626.0 lineto
102.0 -598.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
12.0 -598.0 moveto
12.0 -626.0 lineto
102.0 -626.0 lineto
102.0 -598.0 lineto
closepath
stroke
newpath
305.0 -38.0 moveto
309.0 -38.0 lineto
stroke
newpath
305.0 -45.0 moveto
309.0 -45.0 lineto
stroke
newpath
330.0 -395.0 moveto
334.0 -395.0 lineto
stroke
newpath
350.0 -395.0 moveto
354.0 -395.0 lineto
stroke
newpath
180.0 -402.0 moveto
184.0 -402.0 lineto
stroke
newpath
200.0 -402.0 moveto
204.0 -402.0 lineto
stroke
newpath
57.0 -45.0 moveto
57.0 -59.0 lineto
stroke
newpath
237.0 -38.0 moveto
277.0 -38.0 lineto
stroke
newpath
192.0 -59.0 moveto
192.0 -73.0 lineto
stroke
newpath
142.0 -38.0 moveto
125.0 -38.0 lineto
123.0 -38.0 122.0 -39.333333333333336 122.0 -42.0 curveto
122.0 -77.0 lineto
122.0 -77.0 lineto
122.0 -79.0 121.33333333333333 -80.0 120.0 -80.0 curveto
102.0 -80.0 lineto
102.0 -80.0 lineto
stroke
newpath
57.0 -101.0 moveto
57.0 -154.0 lineto
stroke
newpath
237.0 -94.0 moveto
277.0 -94.0 lineto
stroke
newpath
192.0 -115.0 moveto
192.0 -129.0 lineto
stroke
newpath
102.0 -178.0 moveto
272.0 -178.0 lineto
stroke
newpath
57.0 -199.0 moveto
57.0 -213.0 lineto
stroke
newpath
257.0 -234.0 moveto
297.0 -234.0 lineto
stroke
newpath
102.0 -234.0 moveto
142.0 -234.0 lineto
stroke
newpath
57.0 -248.0 moveto
57.0 -262.0 lineto
stroke
newpath
102.0 -283.0 moveto
142.0 -283.0 lineto
stroke
newpath
57.0 -304.0 moveto
57.0 -318.0 lineto
stroke
newpath
102.0 -339.0 moveto
142.0 -339.0 lineto
stroke
newpath
237.0 -339.0 moveto
277.0 -339.0 lineto
stroke
newpath
237.0 -402.0 moveto
277.0 -402.0 lineto
stroke
newpath
192.0 -423.0 moveto
192.0 -437.0 lineto
stroke
newpath
102.0 -409.0 moveto
142.0 -409.0 lineto
stroke
newpath
57.0 -430.0 moveto
57.0 -479.0 lineto
stroke
newpath
102.0 -507.0 moveto
142.0 -507.0 lineto
stroke
newpath
57.0 -521.0 moveto
57.0 -535.0 lineto
stroke
newpath
237.0 -507.0 moveto
277.0 -507.0 lineto
stroke
newpath
102.0 -556.0 moveto
142.0 -556.0 lineto
stroke
newpath
57.0 -577.0 moveto
57.0 -591.0 lineto
stroke
newpath
140.0 -35.0 moveto
145.0 -38.0 lineto
140.0 -42.0 lineto
closepath
fill
newpath
275.0 -35.0 moveto
280.0 -38.0 lineto
275.0 -42.0 lineto
closepath
fill
newpath
55.0 -56.0 moveto
57.0 -63.0 lineto
60.0 -56.0 lineto
closepath
fill
newpath
190.0 -70.0 moveto
192.0 -77.0 lineto
195.0 -70.0 lineto
closepath
fill
newpath
275.0 -91.0 moveto
280.0 -94.0 lineto
275.0 -98.0 lineto
closepath
fill
newpath
190.0 -126.0 moveto
192.0 -133.0 lineto
195.0 -126.0 lineto
closepath
fill
newpath
270.0 -175.0 moveto
275.0 -178.0 lineto
270.0 -182.0 lineto
closepath
fill
newpath
55.0 -210.0 moveto
57.0 -217.0 lineto
60.0 -210.0 lineto
closepath
fill
newpath
140.0 -231.0 moveto
145.0 -234.0 lineto
140.0 -238.0 lineto
closepath
fill
newpath
295.0 -231.0 moveto
300.0 -234.0 lineto
295.0 -238.0 lineto
closepath
fill
newpath
55.0 -259.0 moveto
57.0 -266.0 lineto
60.0 -259.0 lineto
closepath
fill
newpath
140.0 -280.0 moveto
145.0 -283.0 lineto
140.0 -287.0 lineto
closepath
fill
newpath
55.0 -315.0 moveto
57.0 -322.0 lineto
60.0 -315.0 lineto
closepath
fill
newpath
140.0 -336.0 moveto
145.0 -339.0 lineto
140.0 -343.0 lineto
closepath
fill
newpath
275.0 -336.0 moveto
280.0 -339.0 lineto
275.0 -343.0 lineto
closepath
fill
newpath
55.0 -385.0 moveto
57.0 -392.0 lineto
60.0 -385.0 lineto
closepath
fill
newpath
275.0 -399.0 moveto
280.0 -402.0 lineto
275.0 -406.0 lineto
closepath
fill
newpath
140.0 -406.0 moveto
145.0 -409.0 lineto
140.0 -413.0 lineto
closepath
fill
newpath
190.0 -434.0 moveto
192.0 -441.0 lineto
195.0 -434.0 lineto
closepath
fill
newpath
55.0 -476.0 moveto
57.0 -483.0 lineto
60.0 -476.0 lineto
closepath
fill
newpath
140.0 -504.0 moveto
145.0 -507.0 lineto
140.0 -511.0 lineto
closepath
fill
newpath
275.0 -504.0 moveto
280.0 -507.0 lineto
275.0 -511.0 lineto
closepath
fill
newpath
55.0 -532.0 moveto
57.0 -539.0 lineto
60.0 -532.0 lineto
closepath
fill
newpath
140.0 -553.0 moveto
145.0 -556.0 lineto
140.0 -560.0 lineto
closepath
fill
newpath
55.0 -588.0 moveto
57.0 -595.0 lineto
60.0 -588.0 lineto
closepath
fill
newpath
57.0 -360.0 moveto
57.0 -374.0 lineto
stroke
newpath
192.0 -360.0 moveto
192.0 -374.0 lineto
57.0 -374.0 lineto
stroke
newpath
57.0 -388.0 moveto
57.0 -374.0 lineto
stroke
/Helvetica findfont
7 scalefont setfont
29.0 -28.0 moveto
(I'm not getting) show
40.0 -35.0 moveto
(my data!) show
160.0 -35.0 moveto
(Do you set a) show
160.0 -42.0 moveto
(subscription) show
160.0 -49.0 moveto
(for messages?) show
290.0 -35.0 moveto
(Use the) show
290.0 -42.0 moveto
(zmq setsockopt) show
290.0 -49.0 moveto
(ZMQ SUBSCRIBE) show
290.0 -56.0 moveto
(\(""\) option) show
246.0 -48.0 moveto
(No) show
200.0 -70.0 moveto
(Yes) show
35.0 -77.0 moveto
(Are you losing) show
35.0 -84.0 moveto
(messages in a) show
33.0 -91.0 moveto
(SUB socket?) show
110.0 -91.0 moveto
(Yes) show
160.0 -91.0 moveto
(Do you start) show
160.0 -98.0 moveto
(the SUB socket) show
160.0 -105.0 moveto
(after the PUB?) show
290.0 -91.0 moveto
(Start all SUB) show
290.0 -98.0 moveto
(sockets first,) show
290.0 -105.0 moveto
(then the PUB) show
290.0 -112.0 moveto
(sockets to) show
290.0 -119.0 moveto
(avoid loss) show
245.0 -105.0 moveto
(Yes) show
66.0 -111.0 moveto
(No) show
201.0 -125.0 moveto
(No) show
150.0 -147.0 moveto
(See explanation of) show
150.0 -154.0 moveto
(the "slow joiner") show
150.0 -161.0 moveto
(syndrome in text.) show
285.0 -168.0 moveto
(With REQ, send and) show
285.0 -175.0 moveto
(recv in a loop and) show
285.0 -182.0 moveto
(check the return) show
285.0 -189.0 moveto
(codes. With REP) show
285.0 -196.0 moveto
(it's recv + send.) show
31.0 -175.0 moveto
(Are you using) show
32.0 -182.0 moveto
(REQ and REP) show
43.0 -189.0 moveto
(sockets?) show
110.0 -189.0 moveto
(Yes) show
66.0 -209.0 moveto
(No) show
155.0 -224.0 moveto
(The 1st PULL socket) show
155.0 -231.0 moveto
(to connect can grab) show
155.0 -238.0 moveto
(1000's of messages) show
155.0 -245.0 moveto
(before the others) show
155.0 -252.0 moveto
(get there.) show
310.0 -224.0 moveto
(You may need to) show
310.0 -231.0 moveto
(do extra work to) show
310.0 -238.0 moveto
(synchronize your) show
310.0 -245.0 moveto
(sockets before) show
310.0 -252.0 moveto
(sending tasks.) show
31.0 -231.0 moveto
(Are you using) show
28.0 -238.0 moveto
(PUSH sockets?) show
110.0 -245.0 moveto
(Yes) show
66.0 -258.0 moveto
(No) show
29.0 -280.0 moveto
(Do you check) show
27.0 -287.0 moveto
(return codes on) show
31.0 -294.0 moveto
(all methods?) show
158.0 -280.0 moveto
(Check every 0MQ) show
163.0 -287.0 moveto
(method call. In) show
164.0 -294.0 moveto
(C, use asserts.) show
111.0 -293.0 moveto
(No) show
65.0 -315.0 moveto
(Yes) show
26.0 -336.0 moveto
(Are you using) show
20.0 -343.0 moveto
(threads in your) show
34.0 -350.0 moveto
(app already?) show
168.0 -336.0 moveto
(Do you pass) show
159.0 -343.0 moveto
(sockets between) show
173.0 -350.0 moveto
(threads?) show
290.0 -336.0 moveto
(Create a socket) show
290.0 -343.0 moveto
(in the thread) show
290.0 -350.0 moveto
(where you use it) show
110.0 -350.0 moveto
(Yes) show
245.0 -350.0 moveto
(Yes) show
66.0 -370.0 moveto
(No) show
201.0 -370.0 moveto
(No) show
164.0 -399.0 moveto
(Are you calling) show
168.0 -406.0 moveto
(zmq ctx new) show
160.0 -413.0 moveto
(more than once?) show
290.0 -399.0 moveto
(Call zmq ctx new) show
290.0 -406.0 moveto
(exactly once in) show
290.0 -413.0 moveto
(every process.) show
31.0 -406.0 moveto
(Are you using) show
36.0 -413.0 moveto
(the inproc) show
35.0 -420.0 moveto
(transport?) show
245.0 -413.0 moveto
(Yes) show
110.0 -420.0 moveto
(Yes) show
201.0 -433.0 moveto
(No) show
66.0 -440.0 moveto
(No) show
155.0 -455.0 moveto
(Check that you) show
155.0 -462.0 moveto
(bind before you) show
155.0 -469.0 moveto
(connect.) show
155.0 -497.0 moveto
(Check that the) show
155.0 -504.0 moveto
(reply address) show
155.0 -511.0 moveto
(is valid. 0MQ) show
155.0 -518.0 moveto
(drops messages) show
155.0 -525.0 moveto
(it can't route.) show
290.0 -497.0 moveto
(If you're using) show
290.0 -504.0 moveto
(identities make) show
290.0 -511.0 moveto
(sure to set them) show
290.0 -518.0 moveto
(before not after) show
290.0 -525.0 moveto
(you connect.) show
31.0 -504.0 moveto
(Are you using) show
23.0 -511.0 moveto
(ROUTER sockets?) show
110.0 -518.0 moveto
(Yes) show
66.0 -531.0 moveto
(No) show
28.0 -553.0 moveto
(Are you losing) show
29.0 -560.0 moveto
(every second) show
36.0 -567.0 moveto
(message?) show
155.0 -553.0 moveto
(You probably have) show
155.0 -560.0 moveto
(a client running) show
155.0 -567.0 moveto
(in the background.) show
155.0 -574.0 moveto
(Kill it and start) show
155.0 -581.0 moveto
(again.) show
110.0 -567.0 moveto
(Yes) show
66.0 -587.0 moveto
(No) show
20.0 -609.0 moveto
(Make a minimal) show
20.0 -616.0 moveto
(test case, ask) show
20.0 -623.0 moveto
(on IRC channel.) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 5581 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 5581 a Black 3800 5569 a
Fi(80)p Black eop end
%%Page: 81 95
TeXDict begin 81 94 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.81) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2820 -132 a Fi(Chapter)20 b(2.)g(Soc)n(k)o(ets)g(and)f(P)-7
b(atterns)p Black 396 72 a Fj(If)20 b(you')l(re)f(using)g(\330MQ)i(in)f
(a)h(conte)o(xt)e(where)g(f)o(ailures)h(are)g(e)o(xpensi)n(v)o(e,)e
(then)i(you)f(w)o(ant)h(to)h(plan)f(properly)-5 b(.)17
b(First,)396 180 y(b)n(uild)j(prototypes)e(that)j(let)f(you)g(learn)f
(and)h(test)h(the)f(dif)n(ferent)f(aspects)h(of)g(your)f(design.)g
(Stress)j(them)d(until)h(the)o(y)396 288 y(break,)f(so)i(that)f(you)f
(kno)n(w)g(e)o(xactly)h(ho)n(w)f(strong)h(your)f(designs)g(are.)h
(Second,)f(in)m(v)o(est)h(in)g(testing.)g(This)g(means)396
396 y(b)n(uilding)f(test)i(frame)n(w)o(orks,)d(ensuring)h(you)g(ha)n(v)
o(e)h(access)h(to)f(realistic)h(setups)f(with)g(suf)n(\002cient)g
(computer)e(po)n(wer)m(,)396 504 y(and)i(getting)f(time)i(or)f(help)f
(to)i(actually)e(test)i(seriously)-5 b(.)19 b(Ideally)-5
b(,)19 b(one)h(team)g(writes)g(the)h(code,)e(a)h(second)g(team)g(tries)
396 612 y(to)h(break)e(it.)h(Lastly)-5 b(,)20 b(do)g(get)g(your)f(or)o
(ganization)e(to)j(contact)g(iMatix)g(\(http://www)-5
b(.imatix.com/contact\))15 b(to)21 b(discuss)396 720
y(ho)n(w)f(we)g(can)g(help)g(to)h(mak)o(e)e(sure)h(things)g(w)o(ork)g
(properly)-5 b(,)17 b(and)j(can)g(be)g(\002x)o(ed)f(rapidly)g(if)i(the)
o(y)e(break.)-2 904 y
SDict begin H.S end
 -2 904 a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904
a
SDict begin [/View [/XYZ H.V]/Dest (0:1207) cvn /DEST pdfmark end
 -2 904 a 396 994 a Fj(In)h(short:)g(if)h(you)e(ha)n(v)o(e)g(not)h
(pro)o(v)o(en)e(an)i(architecture)f(w)o(orks)h(in)g(realistic)h
(conditions,)d(it)j(will)g(most)f(lik)o(ely)g(break)f(at)396
1102 y(the)h(w)o(orst)h(possible)f(moment.)p Black 3800
5569 a Fi(81)p Black eop end
%%Page: 82 96
TeXDict begin 82 95 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.82) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:advanced-request-reply) cvn /DEST
pdfmark end
 -2 -11 a 126 x Fl(Chapter)48 b(3.)f(Ad)m(v)m(anced)h(Request-Repl)m
(y)h(P)-5 b(atterns)3687 115 y
SDict begin H.S end
 3687 115 a 3687 115 a
SDict begin 26.957 H.A end

3687 115 a 3687 115 a
SDict begin [/View [/XYZ H.V]/Dest (8.0) cvn /DEST pdfmark end
 3687 115 a -2 371 a
SDict begin H.S end
 -2 371 a -2
371 a
SDict begin 13 H.A end
 -2 371 a -2 371 a
SDict begin [/View [/XYZ H.V]/Dest (0:1210) cvn /DEST pdfmark end
 -2 371 a 396 443 a Fj(In)20 b(Sock)o(ets)g(and)
g(P)o(atterns)p 0 TeXcolorgray 1172 443 a
SDict begin H.S end
 1172 443 a
Fj(Chapter)f(2)1497 443 y
SDict begin 13 H.L end
 1497 443 a 1497 443 a
SDict begin [/Subtype /Link/Dest (0:sockets-and-patterns) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1497
443 a Black 20 w Fj(we)i(w)o(ork)o(ed)e(through)f(the)i(basics)h(of)f
(using)f(\330MQ)i(by)e(de)n(v)o(eloping)f(a)i(series)h(of)396
551 y(small)g(applications,)e(each)h(time)g(e)o(xploring)e(ne)n(w)i
(aspects)g(of)g(\330MQ.)g(W)-7 b(e')o(ll)22 b(continue)c(this)j
(approach)d(in)i(this)396 659 y(chapter)m(,)f(as)i(we)f(e)o(xplore)f
(adv)n(anced)f(patterns)i(b)n(uilt)g(on)g(top)g(of)f(\330MQ')-5
b(s)21 b(core)f(request-reply)e(pattern.)-2 843 y
SDict begin H.S end
 -2
843 a -2 843 a
SDict begin 13 H.A end
 -2 843 a -2 843 a
SDict begin [/View [/XYZ H.V]/Dest (0:1212) cvn /DEST pdfmark end
 -2 843 a 396 933 a Fj(W)-7
b(e')o(ll)22 b(co)o(v)o(er:)-2 934 y
SDict begin H.S end
 -2 934 a -2 934
a
SDict begin 13 H.A end
 -2 934 a -2 934 a
SDict begin [/View [/XYZ H.V]/Dest (0:1213) cvn /DEST pdfmark end
 -2 934 a -2 944 a
SDict begin H.S end
 -2 944 a -2 944
a
SDict begin 13 H.A end
 -2 944 a -2 944 a
SDict begin [/View [/XYZ H.V]/Dest (0:1214) cvn /DEST pdfmark end
 -2 944 a Black 396 1103 a Fe(\225)p
Black 479 1103 a
SDict begin H.S end
 479 1103 a 479 1103 a
SDict begin 13 H.A end
 479 1103 a 479
1103 a
SDict begin [/View [/XYZ H.V]/Dest (0:1215) cvn /DEST pdfmark end
 479 1103 a Fj(Ho)n(w)e(to)h(create)f(and)f(use)i(message)f(en)m
(v)o(elopes)e(for)h(request-reply)-5 b(.)-2 1121 y
SDict begin H.S end
 -2
1121 a -2 1121 a
SDict begin 13 H.A end
 -2 1121 a -2 1121 a
SDict begin [/View [/XYZ H.V]/Dest (0:1216) cvn /DEST pdfmark end
 -2 1121 a Black
396 1252 a Fe(\225)p Black 479 1252 a
SDict begin H.S end
 479 1252 a 479
1252 a
SDict begin 13 H.A end
 479 1252 a 479 1252 a
SDict begin [/View [/XYZ H.V]/Dest (0:1217) cvn /DEST pdfmark end
 479 1252 a Fj(Ho)n(w)20
b(to)h(use)f(the)g(REQ,)h(REP)-9 b(,)20 b(DEALER,)g(and)g(R)m(OUTER)h
(sock)o(ets.)-2 1267 y
SDict begin H.S end
 -2 1267 a -2 1267 a
SDict begin 13 H.A end
 -2 1267 a
-2 1267 a
SDict begin [/View [/XYZ H.V]/Dest (0:1218) cvn /DEST pdfmark end
 -2 1267 a Black 396 1402 a Fe(\225)p Black
479 1402 a
SDict begin H.S end
 479 1402 a 479 1402 a
SDict begin 13 H.A end
 479 1402 a 479 1402
a
SDict begin [/View [/XYZ H.V]/Dest (0:1219) cvn /DEST pdfmark end
 479 1402 a Fj(Ho)n(w)f(to)h(set)g(manual)e(reply)g(addresses)h(using)
g(identities.)-2 1420 y
SDict begin H.S end
 -2 1420 a -2 1420 a
SDict begin 13 H.A end
 -2 1420 a
-2 1420 a
SDict begin [/View [/XYZ H.V]/Dest (0:1220) cvn /DEST pdfmark end
 -2 1420 a Black 396 1551 a Fe(\225)p Black
479 1551 a
SDict begin H.S end
 479 1551 a 479 1551 a
SDict begin 13 H.A end
 479 1551 a 479 1551
a
SDict begin [/View [/XYZ H.V]/Dest (0:1221) cvn /DEST pdfmark end
 479 1551 a Fj(Ho)n(w)g(to)h(do)e(custom)h(random)e(scatter)j
(routing.)-2 1569 y
SDict begin H.S end
 -2 1569 a -2 1569 a
SDict begin 13 H.A end
 -2 1569 a -2
1569 a
SDict begin [/View [/XYZ H.V]/Dest (0:1222) cvn /DEST pdfmark end
 -2 1569 a Black 396 1701 a Fe(\225)p Black 479
1701 a
SDict begin H.S end
 479 1701 a 479 1701 a
SDict begin 13 H.A end
 479 1701 a 479 1701 a
SDict begin [/View [/XYZ H.V]/Dest (0:1223) cvn /DEST pdfmark end
 479
1701 a Fj(Ho)n(w)f(to)h(do)e(custom)h(least-recently)f(used)h(routing.)
-2 1719 y
SDict begin H.S end
 -2 1719 a -2 1719 a
SDict begin 13 H.A end
 -2 1719 a -2 1719 a
SDict begin [/View [/XYZ H.V]/Dest (0:1224) cvn /DEST pdfmark end
 -2
1719 a Black 396 1850 a Fe(\225)p Black 479 1850 a
SDict begin H.S end
 479
1850 a 479 1850 a
SDict begin 13 H.A end
 479 1850 a 479 1850 a
SDict begin [/View [/XYZ H.V]/Dest (0:1225) cvn /DEST pdfmark end
 479 1850 a Fj(Ho)n(w)g(to)h(b)n
(uild)e(a)i(higher)n(-le)n(v)o(el)d(message)i(class.)-2
1868 y
SDict begin H.S end
 -2 1868 a -2 1868 a
SDict begin 13 H.A end
 -2 1868 a -2 1868 a
SDict begin [/View [/XYZ H.V]/Dest (0:1226) cvn /DEST pdfmark end
 -2 1868
a Black 396 1999 a Fe(\225)p Black 479 1999 a
SDict begin H.S end
 479 1999
a 479 1999 a
SDict begin 13 H.A end
 479 1999 a 479 1999 a
SDict begin [/View [/XYZ H.V]/Dest (0:1227) cvn /DEST pdfmark end
 479 1999 a Fj(Ho)n(w)g(to)h(b)n
(uild)e(a)i(basic)f(request-reply)e(brok)o(er)-5 b(.)-2
2017 y
SDict begin H.S end
 -2 2017 a -2 2017 a
SDict begin 13 H.A end
 -2 2017 a -2 2017 a
SDict begin [/View [/XYZ H.V]/Dest (0:1228) cvn /DEST pdfmark end
 -2 2017
a Black 396 2149 a Fe(\225)p Black 479 2149 a
SDict begin H.S end
 479 2149
a 479 2149 a
SDict begin 13 H.A end
 479 2149 a 479 2149 a
SDict begin [/View [/XYZ H.V]/Dest (0:1229) cvn /DEST pdfmark end
 479 2149 a Fj(Ho)n(w)20
b(to)h(choose)e(good)g(names)h(for)f(sock)o(ets.)-2 2167
y
SDict begin H.S end
 -2 2167 a -2 2167 a
SDict begin 13 H.A end
 -2 2167 a -2 2167 a
SDict begin [/View [/XYZ H.V]/Dest (0:1230) cvn /DEST pdfmark end
 -2 2167 a Black
396 2298 a Fe(\225)p Black 479 2298 a
SDict begin H.S end
 479 2298 a 479
2298 a
SDict begin 13 H.A end
 479 2298 a 479 2298 a
SDict begin [/View [/XYZ H.V]/Dest (0:1231) cvn /DEST pdfmark end
 479 2298 a Fj(Ho)n(w)h(to)h(simulate)f(a)g
(cluster)h(of)e(clients)i(and)f(w)o(ork)o(ers.)-2 2299
y
SDict begin H.S end
 -2 2299 a -2 2299 a
SDict begin 13 H.A end
 -2 2299 a -2 2299 a
SDict begin [/View [/XYZ H.V]/Dest (0:1232) cvn /DEST pdfmark end
 -2 2299 a Black
396 2448 a Fe(\225)p Black 479 2448 a
SDict begin H.S end
 479 2448 a 479
2448 a
SDict begin 13 H.A end
 479 2448 a 479 2448 a
SDict begin [/View [/XYZ H.V]/Dest (0:1233) cvn /DEST pdfmark end
 479 2448 a Fj(Ho)n(w)g(to)h(b)n(uild)e(a)i
(scalable)f(cloud)g(of)f(request-reply)f(clusters.)-2
2466 y
SDict begin H.S end
 -2 2466 a -2 2466 a
SDict begin 13 H.A end
 -2 2466 a -2 2466 a
SDict begin [/View [/XYZ H.V]/Dest (0:1234) cvn /DEST pdfmark end
 -2 2466
a Black 396 2597 a Fe(\225)p Black 479 2597 a
SDict begin H.S end
 479 2597
a 479 2597 a
SDict begin 13 H.A end
 479 2597 a 479 2597 a
SDict begin [/View [/XYZ H.V]/Dest (0:1235) cvn /DEST pdfmark end
 479 2597 a Fj(Ho)n(w)i(to)h(use)f
(pipeline)f(sock)o(ets)i(for)e(monitoring)f(threads.)-2
2615 y
SDict begin H.S end
 -2 2615 a -2 2615 a
SDict begin 13 H.A end
 -2 2615 a -2 2615 a
SDict begin [/View [/XYZ H.V]/Dest (0:1236) cvn /DEST pdfmark end
 -2 2615
a 359 x Fh(3.1.)39 b(Request-Repl)n(y)d(En)-6 b(velopes)2033
2974 y
SDict begin H.S end
 2033 2974 a 2033 2974 a
SDict begin 22.464 H.A end
 2033 2974 a 2033 2974
a
SDict begin [/View [/XYZ H.V]/Dest (8.31.1) cvn /DEST pdfmark end
 2033 2974 a -2 3170 a
SDict begin H.S end
 -2 3170 a -2 3170 a
SDict begin 13 H.A end
 -2 3170 a
-2 3170 a
SDict begin [/View [/XYZ H.V]/Dest (0:1238) cvn /DEST pdfmark end
 -2 3170 a 396 3248 a Fj(W)f(e')l(v)o(e)20 b(look)o(ed)f
(brie\003y)h(at)g(multi-part)f(messages.)h(Let')-5 b(s)21
b(no)n(w)f(look)f(at)i(their)f(\002rst)h(use)f(case,)g(which)g(is)3434
3248 y
SDict begin H.S end
 3434 3248 a 3434 3248 a
SDict begin 13 H.A end
 3434 3248 a 3434 3248
a
SDict begin [/View [/XYZ H.V]/Dest (0:1239) cvn /DEST pdfmark end
 3434 3248 a Fi(messa)o(g)o(e)396 3356 y(en)m(velopes)p
Fj(.)f(An)h(en)m(v)o(elope)e(is)j(a)g(w)o(ay)f(of)g(safely)g(packaging)
e(up)i(data)g(with)g(an)g(address,)g(without)f(touching)f(the)j(data)
396 3464 y(itself.)g(By)f(separating)f(addresses)h(into)g(an)g(en)m(v)o
(elope)e(we)j(mak)o(e)f(it)h(possible)e(to)i(write)f(general-purpose)
396 3572 y(intermediaries)f(such)h(as)h(APIs)g(and)e(proxies)g(that)i
(create,)e(read,)h(remo)o(v)o(e)e(addresses)i(no)g(matter)g(what)g(the)
g(message)396 3680 y(payload)f(or)h(structure.)-2 3864
y
SDict begin H.S end
 -2 3864 a -2 3864 a
SDict begin 13 H.A end
 -2 3864 a -2 3864 a
SDict begin [/View [/XYZ H.V]/Dest (0:1240) cvn /DEST pdfmark end
 -2 3864 a 396
3954 a Fj(In)g(the)g(request-reply)e(pattern,)h(the)h(en)m(v)o(elope)e
(holds)i(the)g(return)f(address)h(for)f(replies.)h(It)h(is)g(ho)n(w)f
(a)g(\330MQ)h(netw)o(ork)396 4062 y(with)g(no)e(state)i(can)f(create)g
(round-trip)e(request-reply)f(dialogs.)-2 4246 y
SDict begin H.S end
 -2 4246
a -2 4246 a
SDict begin 13 H.A end
 -2 4246 a -2 4246 a
SDict begin [/View [/XYZ H.V]/Dest (0:1241) cvn /DEST pdfmark end
 -2 4246 a 396 4336 a
Fj(Y)-9 b(ou)20 b(don')o(t)e(in)j(f)o(act)f(need)g(to)g(understand)e
(ho)n(w)i(request-reply)d(en)m(v)o(elopes)i(w)o(ork)g(to)h(use)h(them)f
(for)f(common)g(cases.)396 4444 y(When)h(you)g(use)g(REQ)h(and)e(REP)-9
b(,)21 b(your)e(sock)o(ets)h(b)n(uild)g(and)g(use)g(en)m(v)o(elopes)e
(automatically)-5 b(.)18 b(When)i(you)g(write)g(a)396
4552 y(proxy)-5 b(,)18 b(if)j(you)e(don')o(t)f(call)1178
4552 y
SDict begin H.S end
 1178 4552 a 1178 4552 a
SDict begin 13 H.A end
 1178 4552 a 1178 4552
a
SDict begin [/View [/XYZ H.V]/Dest (0:1242) cvn /DEST pdfmark end
 1178 4552 a Fg(zmq_proxy\(\))p Fj(,)h(you)g(need)g(to)i(read)e(and)h
(write)g(all)h(the)f(parts)h(of)e(a)i(message.)f(\330MQ)396
4660 y(implements)f(en)m(v)o(elopes)g(using)g(multi-part)g(data,)h(so)h
(if)f(you)f(cop)o(y)h(multi-part)e(data)j(safely)-5 b(,)19
b(you)g(implicitly)h(cop)o(y)396 4768 y(en)m(v)o(elopes)e(too.)-2
4952 y
SDict begin H.S end
 -2 4952 a -2 4952 a
SDict begin 13 H.A end
 -2 4952 a -2 4952 a
SDict begin [/View [/XYZ H.V]/Dest (0:1243) cvn /DEST pdfmark end
 -2 4952
a 396 5042 a Fj(Ho)n(we)n(v)o(er)m(,)g(getting)i(under)f(the)h(hood)f
(and)g(playing)g(with)h(request-reply)e(en)m(v)o(elopes)g(is)j
(necessary)f(for)f(adv)n(anced)396 5150 y(request-reply)f(w)o(ork.)h
(It')-5 b(s)21 b(time)g(to)f(e)o(xplain)f(ho)n(w)g(the)i(R)m(OUTER)f
(sock)o(et)g(w)o(orks,)g(in)g(terms)g(of)g(en)m(v)o(elopes:)-2
5168 y
SDict begin H.S end
 -2 5168 a -2 5168 a
SDict begin 13 H.A end
 -2 5168 a -2 5168 a
SDict begin [/View [/XYZ H.V]/Dest (0:1244) cvn /DEST pdfmark end
 -2 5168
a Black 3800 5569 a Fi(82)p Black eop end
%%Page: 83 97
TeXDict begin 83 96 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.83) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1245) cvn /DEST pdfmark end
 -2 -11 a Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1246) cvn /DEST pdfmark end
 479 72 a Fj(When)20
b(you)g(recei)n(v)o(e)f(a)h(message)g(from)f(a)i(R)m(OUTER)g(sock)o
(et,)e(it)i(sho)o(v)o(es)f(a)g(bro)n(wn)f(paper)g(en)m(v)o(elope)f
(around)g(the)479 180 y(message)i(and)f(scribbles)h(on)f(with)h
(indelible)f(ink,)g("This)h(came)f(from)g(Luc)o(y".)f(Then)h(it)i(gi)n
(v)o(es)e(that)h(to)g(you.)f(That)g(is,)479 288 y(the)h(R)m(OUTER)h(gi)
n(v)o(es)f(you)f(what)h(came)g(of)n(f)g(the)g(wire,)g(wrapped)e(up)i
(in)h(an)f(en)m(v)o(elope)e(with)i(the)g(reply)f(address)h(on)479
396 y(it.)-2 397 y
SDict begin H.S end
 -2 397 a -2 397 a
SDict begin 13 H.A end
 -2 397 a -2 397
a
SDict begin [/View [/XYZ H.V]/Dest (0:1247) cvn /DEST pdfmark end
 -2 397 a Black 396 546 a Fe(\225)p Black 479 546 a
SDict begin H.S end

479 546 a 479 546 a
SDict begin 13 H.A end
 479 546 a 479 546 a
SDict begin [/View [/XYZ H.V]/Dest (0:1248) cvn /DEST pdfmark end
 479 546 a Fj(When)g(you)g(send)
g(a)g(message)g(to)h(a)f(R)m(OUTER,)g(it)h(rips)g(of)n(f)e(that)h(bro)n
(wn)f(paper)g(en)m(v)o(elope,)f(tries)j(to)f(read)g(its)h(o)n(wn)479
654 y(handwriting,)d(and)i(if)g(it)h(kno)n(ws)f(who)f("Luc)o(y")g(is,)i
(sends)f(the)g(contents)g(back)f(to)i(Luc)o(y)-5 b(.)18
b(That)i(is)h(the)f(re)n(v)o(erse)479 762 y(process)g(of)g(recei)n
(ving)f(a)h(message.)-2 946 y
SDict begin H.S end
 -2 946 a -2 946 a
SDict begin 13 H.A end
 -2 946
a -2 946 a
SDict begin [/View [/XYZ H.V]/Dest (0:1249) cvn /DEST pdfmark end
 -2 946 a 396 1036 a Fj(If)g(you)g(lea)n(v)o(e)g(the)g(bro)n
(wn)f(en)m(v)o(elope)f(alone,)h(and)h(then)f(pass)i(that)f(message)g
(to)h(another)d(R)m(OUTER)j(\(e.g.)e(by)h(sending)396
1143 y(to)h(a)f(DEALER)g(connected)f(to)h(a)h(R)m(OUTER\),)f(the)g
(second)f(R)m(OUTER)i(will)g(in)f(turn)f(stick)i(another)e(bro)n(wn)g
(en)m(v)o(elope)396 1251 y(on)h(it,)h(and)e(scribble)h(the)g(name)g(of)
g(that)g(DEALER)g(on)g(it.)-2 1429 y
SDict begin H.S end
 -2 1429 a -2 1429
a
SDict begin 13 H.A end
 -2 1429 a -2 1429 a
SDict begin [/View [/XYZ H.V]/Dest (0:1250) cvn /DEST pdfmark end
 -2 1429 a 396 1525 a Fj(The)g(whole)g(point)f(of)
h(this)h(is)g(that)f(each)g(R)m(OUTER)h(kno)n(ws)e(ho)n(w)h(to)g(send)g
(replies)g(back)g(to)g(the)g(right)g(place.)f(All)i(you)396
1633 y(need)f(to)g(do,)g(in)g(your)f(application,)f(is)k(respect)d(the)
i(bro)n(wn)d(en)m(v)o(elopes.)g(No)n(w)i(the)h(REP)g(sock)o(et)f(mak)o
(es)g(sense.)g(It)396 1741 y(carefully)f(slices)i(open)e(the)i(bro)n
(wn)d(en)m(v)o(elopes,)g(one)i(by)g(one,)f(k)o(eeps)h(them)g(safely)g
(aside,)g(and)g(gi)n(v)o(es)f(you)h(\(the)396 1849 y(application)f
(code)g(that)i(o)n(wns)f(the)g(REP)h(sock)o(et\))f(the)g(original)f
(message.)h(When)g(you)f(send)h(the)g(reply)-5 b(,)19
b(it)i(re-wraps)396 1957 y(the)f(reply)g(in)g(the)g(bro)n(wn)f(paper)g
(en)m(v)o(elopes,)f(so)j(it)g(can)f(hand)f(the)h(resulting)f(bro)n(wn)g
(package)g(back)g(to)i(the)396 2065 y(R)m(OUTERs)g(do)n(wn)e(the)h
(chain.)-2 2232 y
SDict begin H.S end
 -2 2232 a -2 2232 a
SDict begin 13 H.A end
 -2 2232 a -2 2232
a
SDict begin [/View [/XYZ H.V]/Dest (0:1251) cvn /DEST pdfmark end
 -2 2232 a 396 2339 a Fj(Which)g(lets)h(you)f(insert)g(R)m
(OUTER-DEALER)g(proxies)f(into)h(a)g(request-reply)e(pattern)h(lik)o(e)
i(this:)-2 2440 y
SDict begin H.S end
 -2 2440 a -2 2440 a
SDict begin 11.7 H.A end
 -2 2440 a -2 2440
a
SDict begin [/View [/XYZ H.V]/Dest (0:1252) cvn /DEST pdfmark end
 -2 2440 a 396 2519 a Fg([REQ])44 b(<-->)g([REP])396
2616 y([REQ])g(<-->)g([ROUTER--DEALER])f(<-->)h([REP])396
2713 y([REQ])g(<-->)g([ROUTER--DEALER])f(<-->)h([ROUTER--DEALER])e
(<-->)i([REP])396 2811 y(...etc.)-2 2978 y
SDict begin H.S end
 -2 2978 a
-2 2978 a
SDict begin 13 H.A end
 -2 2978 a -2 2978 a
SDict begin [/View [/XYZ H.V]/Dest (0:1253) cvn /DEST pdfmark end
 -2 2978 a 396 3085 a Fj(If)20
b(you)g(connect)f(a)h(REQ)h(sock)o(et)f(to)g(a)h(R)m(OUTER,)f(and)g
(send)g(one)f(request)h(message,)g(you)f(will)i(get)f(a)h(message)f
(that)396 3192 y(consists)h(of)f(three)g(frames:)f(a)i(reply)e
(address,)h(an)g(empty)f(message)h(frame,)f(and)h(the)g(')l(real')g
(message\()p 0 TeXcolorgray 3400 3192 a
SDict begin H.S end
 3400 3192 a Fj(Figure)e(3-1)
3748 3192 y
SDict begin 13 H.L end
 3748 3192 a 3748 3192 a
SDict begin [/Subtype /Link/Dest (0:figure-26) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3748 3192 a Black
-1 w Fj(\).)-2 3210 y
SDict begin H.S end
 -2 3210 a -2 3210 a
SDict begin 13 H.A end
 -2 3210 a -2
3210 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-26) cvn /DEST pdfmark
end
 -2 3210 a 396 3394 a Fk(Figur)o(e)i(3-1.)f(Single-hop)h
(Request-r)o(eply)f(En)m(v)o(elope)-2 3494 y
SDict begin H.S end
 -2 3494
a -2 3494 a
SDict begin 13 H.A end
 -2 3494 a -2 3494 a
SDict begin [/View [/XYZ H.V]/Dest (0:1257) cvn /DEST pdfmark end
 -2 3494 a 396 4452 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate

396 4452 a @beginspecial 0 @llx -110 @lly 399 @urx 0
@ury 3990 @rwi @setspecial
%%BeginDocument: images/fig26.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -110 399 0
%%HiResBoundingBox: 0.0 -110.0 399.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -27.100210189819336 moveto
89.10021209716797 -47.1002082824707 lineto
201.10020446777344 -47.1002082824707 lineto
201.10020446777344 -27.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -47.1002082824707 moveto
89.10021209716797 -67.10021209716797 lineto
117.10021209716797 -67.10021209716797 lineto
117.10021209716797 -47.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -67.10021209716797 moveto
89.10021209716797 -87.10021209716797 lineto
383.1002197265625 -87.10021209716797 lineto
383.1002197265625 -67.10021209716797 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -25.0 moveto
87.0 -45.0 lineto
199.0 -45.0 lineto
199.0 -25.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -25.0 moveto
87.0 -45.0 lineto
199.0 -45.0 lineto
199.0 -25.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -65.0 lineto
115.0 -65.0 lineto
115.0 -45.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -65.0 lineto
115.0 -65.0 lineto
115.0 -45.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -65.0 moveto
87.0 -85.0 lineto
381.0 -85.0 lineto
381.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -65.0 moveto
87.0 -85.0 lineto
381.0 -85.0 lineto
381.0 -65.0 lineto
closepath
stroke
newpath
227.0 -35.0 moveto
266.0 -35.0 lineto
stroke
newpath
143.0 -55.0 moveto
189.0 -55.0 lineto
stroke
newpath
231.0 -30.0 moveto
224.0 -35.0 lineto
231.0 -40.0 lineto
closepath
fill
newpath
147.0 -50.0 moveto
140.0 -55.0 lineto
147.0 -60.0 lineto
closepath
fill
/Helvetica findfont
10 scalefont setfont
15.0 -39.0 moveto
(Frame 1) show
103.0 -39.0 moveto
(Reply address) show
276.0 -39.0 moveto
(Envelope) show
15.0 -59.0 moveto
(Frame 2) show
199.0 -59.0 moveto
(Empty message frame) show
15.0 -79.0 moveto
(Frame 3) show
99.0 -79.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4452 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4452 a -2 4618 a
SDict begin H.S end
 -2 4618
a -2 4618 a
SDict begin 13 H.A end
 -2 4618 a -2 4618 a
SDict begin [/View [/XYZ H.V]/Dest (0:1260) cvn /DEST pdfmark end
 -2 4618 a 396 4726 a
Fj(Breaking)g(this)i(do)n(wn:)-2 4744 y
SDict begin H.S end
 -2 4744 a -2
4744 a
SDict begin 13 H.A end
 -2 4744 a -2 4744 a
SDict begin [/View [/XYZ H.V]/Dest (0:1261) cvn /DEST pdfmark end
 -2 4744 a -2 4754 a
SDict begin H.S end
 -2 4754
a -2 4754 a
SDict begin 13 H.A end
 -2 4754 a -2 4754 a
SDict begin [/View [/XYZ H.V]/Dest (0:1262) cvn /DEST pdfmark end
 -2 4754 a Black 396 4896
a Fe(\225)p Black 479 4896 a
SDict begin H.S end
 479 4896 a 479 4896 a
SDict begin 13 H.A end
 479
4896 a 479 4896 a
SDict begin [/View [/XYZ H.V]/Dest (0:1263) cvn /DEST pdfmark end
 479 4896 a Fj(The)f(data)g(in)h(frame)e(3)h(is)h
(what)f(the)h(sending)e(application)f(sends)j(to)f(the)g(REQ)h(sock)o
(et.)-2 4914 y
SDict begin H.S end
 -2 4914 a -2 4914 a
SDict begin 13 H.A end
 -2 4914 a -2 4914
a
SDict begin [/View [/XYZ H.V]/Dest (0:1264) cvn /DEST pdfmark end
 -2 4914 a Black 396 5045 a Fe(\225)p Black 479 5045
a
SDict begin H.S end
 479 5045 a 479 5045 a
SDict begin 13 H.A end
 479 5045 a 479 5045 a
SDict begin [/View [/XYZ H.V]/Dest (0:1265) cvn /DEST pdfmark end
 479 5045
a Fj(The)f(empty)f(message)h(frame)g(in)g(frame)g(2)g(is)h(prepended)c
(by)j(the)g(REQ)h(sock)o(et)f(when)g(it)h(sends)f(the)g(message)g(to)
479 5153 y(the)g(R)m(OUTER.)-2 5154 y
SDict begin H.S end
 -2 5154 a -2 5154
a
SDict begin 13 H.A end
 -2 5154 a -2 5154 a
SDict begin [/View [/XYZ H.V]/Dest (0:1266) cvn /DEST pdfmark end
 -2 5154 a Black 3800 5569 a Fi(83)p
Black eop end
%%Page: 84 98
TeXDict begin 84 97 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.84) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1293) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1267) cvn /DEST pdfmark end
 479 72 a
Fj(The)20 b(reply)g(address)f(in)i(frame)e(1)h(is)h(prepended)d(by)i
(the)g(R)m(OUTER)g(before)f(it)i(passes)g(the)f(message)g(to)h(the)479
180 y(recei)n(ving)e(application.)-2 364 y
SDict begin H.S end
 -2 364 a -2
364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:1268) cvn /DEST pdfmark end
 -2 364 a 396 454 a Fj(No)n(w)h(if)h(we)f(e)o
(xtend)f(this)i(with)f(a)h(chain)f(of)f(proxies,)g(we)i(get)f(en)m(v)o
(elope)e(on)i(en)m(v)o(elope,)d(with)k(the)f(ne)n(west)g(en)m(v)o
(elope)396 562 y(al)o(w)o(ays)h(stuck)f(at)h(the)f(be)o(ginning)d(of)j
(the)h(stack\()p 0 TeXcolorgray 1808 562 a
SDict begin H.S end
 1808 562 a
Fj(Figure)d(3-2)2156 562 y
SDict begin 13 H.L end
 2156 562 a 2156 562 a
SDict begin [/Subtype /Link/Dest (0:figure-27) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2156
562 a Black -1 w Fj(\).)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2
580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-27) cvn /DEST pdfmark
end
 -2 580 a 396 764 a Fk(Figur)o(e)i(3-2.)f(Multihop)i
(Request-r)o(eply)e(En)m(v)o(elope)-2 864 y
SDict begin H.S end
 -2 864 a
-2 864 a
SDict begin 13 H.A end
 -2 864 a -2 864 a
SDict begin [/View [/XYZ H.V]/Dest (0:1272) cvn /DEST pdfmark end
 -2 864 a 396 2322 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2322
a @beginspecial 0 @llx -170 @lly 406 @urx 0 @ury 4060
@rwi @setspecial
%%BeginDocument: images/fig27.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -170 406 0
%%HiResBoundingBox: 0.0 -170.0 406.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -47.1002082824707 moveto
89.10021209716797 -65.10021209716797 lineto
201.10020446777344 -65.10021209716797 lineto
201.10020446777344 -47.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -68.10021209716797 moveto
89.10021209716797 -85.10021209716797 lineto
201.10020446777344 -85.10021209716797 lineto
201.10020446777344 -68.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -88.10021209716797 moveto
89.10021209716797 -107.10021209716797 lineto
201.10020446777344 -107.10021209716797 lineto
201.10020446777344 -88.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -107.10021209716797 moveto
89.10021209716797 -127.10021209716797 lineto
117.10021209716797 -127.10021209716797 lineto
117.10021209716797 -107.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -127.10021209716797 moveto
89.10021209716797 -147.10020446777344 lineto
383.1002197265625 -147.10020446777344 lineto
383.1002197265625 -127.10021209716797 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -63.0 lineto
199.0 -63.0 lineto
199.0 -45.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -45.0 moveto
87.0 -63.0 lineto
199.0 -63.0 lineto
199.0 -45.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -66.0 moveto
87.0 -83.0 lineto
199.0 -83.0 lineto
199.0 -66.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -66.0 moveto
87.0 -83.0 lineto
199.0 -83.0 lineto
199.0 -66.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -86.0 moveto
87.0 -105.0 lineto
199.0 -105.0 lineto
199.0 -86.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -86.0 moveto
87.0 -105.0 lineto
199.0 -105.0 lineto
199.0 -86.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -105.0 moveto
87.0 -125.0 lineto
115.0 -125.0 lineto
115.0 -105.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -105.0 moveto
87.0 -125.0 lineto
115.0 -125.0 lineto
115.0 -105.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -125.0 moveto
87.0 -145.0 lineto
381.0 -145.0 lineto
381.0 -125.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -125.0 moveto
87.0 -145.0 lineto
381.0 -145.0 lineto
381.0 -125.0 lineto
closepath
stroke
newpath
227.0 -55.0 moveto
266.0 -55.0 lineto
stroke
newpath
227.0 -75.0 moveto
266.0 -75.0 lineto
stroke
newpath
227.0 -95.0 moveto
266.0 -95.0 lineto
stroke
newpath
143.0 -115.0 moveto
189.0 -115.0 lineto
stroke
newpath
231.0 -50.0 moveto
224.0 -55.0 lineto
231.0 -60.0 lineto
closepath
fill
newpath
231.0 -70.0 moveto
224.0 -75.0 lineto
231.0 -80.0 lineto
closepath
fill
newpath
231.0 -90.0 moveto
224.0 -95.0 lineto
231.0 -100.0 lineto
closepath
fill
newpath
147.0 -110.0 moveto
140.0 -115.0 lineto
147.0 -120.0 lineto
closepath
fill
/Helvetica findfont
10 scalefont setfont
68.0 -29.0 moveto
(\(Next envelope will go here\)) show
15.0 -59.0 moveto
(Frame 1) show
103.0 -59.0 moveto
(Reply address) show
278.0 -59.0 moveto
(Envelope \(ROUTER\)) show
15.0 -79.0 moveto
(Frame 2) show
103.0 -79.0 moveto
(Reply address) show
278.0 -79.0 moveto
(Envelope \(ROUTER\)) show
15.0 -99.0 moveto
(Frame 3) show
103.0 -99.0 moveto
(Reply address) show
278.0 -99.0 moveto
(Envelope \(ROUTER\)) show
15.0 -119.0 moveto
(Frame 4) show
202.0 -119.0 moveto
(Empty message frame \(REQ\)) show
15.0 -139.0 moveto
(Frame 5) show
99.0 -139.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2322 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2322 a -2 2488 a
SDict begin H.S end
 -2 2488
a -2 2488 a
SDict begin 13 H.A end
 -2 2488 a -2 2488 a
SDict begin [/View [/XYZ H.V]/Dest (0:1275) cvn /DEST pdfmark end
 -2 2488 a 396 2596 a
Fj(Here)h(no)n(w)g(is)h(a)g(more)e(detailed)h(e)o(xplanation)e(of)h
(the)i(four)e(sock)o(et)h(types)g(we)g(use)h(for)e(request-reply)f
(patterns:)-2 2614 y
SDict begin H.S end
 -2 2614 a -2 2614 a
SDict begin 13 H.A end
 -2 2614 a -2
2614 a
SDict begin [/View [/XYZ H.V]/Dest (0:1276) cvn /DEST pdfmark end
 -2 2614 a -2 2624 a
SDict begin H.S end
 -2 2624 a -2 2624 a
SDict begin 13 H.A end
 -2 2624
a -2 2624 a
SDict begin [/View [/XYZ H.V]/Dest (0:1277) cvn /DEST pdfmark end
 -2 2624 a Black 396 2766 a Fe(\225)p Black
479 2766 a
SDict begin H.S end
 479 2766 a 479 2766 a
SDict begin 13 H.A end
 479 2766 a 479 2766
a
SDict begin [/View [/XYZ H.V]/Dest (0:1278) cvn /DEST pdfmark end
 479 2766 a Fj(DEALER)i(just)h(deals)g(out)e(the)i(messages)f(you)f
(send)h(to)h(all)f(connected)f(peers)h(\(aka)f("round-robin"\),)d(and)j
(deals)479 2874 y(in)i(\(aka)e("f)o(air)h(queuing"\))e(the)i(messages)h
(it)g(recei)n(v)o(es.)e(It)h(is)h(e)o(xactly)f(lik)o(e)g(a)h(PUSH)g
(and)e(PULL)i(sock)o(et)f(combined.)-2 2892 y
SDict begin H.S end
 -2 2892
a -2 2892 a
SDict begin 13 H.A end
 -2 2892 a -2 2892 a
SDict begin [/View [/XYZ H.V]/Dest (0:1279) cvn /DEST pdfmark end
 -2 2892 a Black 396 3023
a Fe(\225)p Black 479 3023 a
SDict begin H.S end
 479 3023 a 479 3023 a
SDict begin 13 H.A end
 479
3023 a 479 3023 a
SDict begin [/View [/XYZ H.V]/Dest (0:1280) cvn /DEST pdfmark end
 479 3023 a Fj(REQ)h(prepends)e(an)h(empty)f(message)h
(frame)f(to)i(e)n(v)o(ery)e(message)h(you)f(send,)h(and)f(remo)o(v)o
(es)g(the)h(empty)f(message)479 3131 y(frame)h(from)f(each)h(message)g
(you)f(recei)n(v)o(e.)g(It)h(then)g(w)o(orks)g(lik)o(e)g(DEALER)h
(\(and)e(in)h(f)o(act)h(is)g(b)n(uilt)f(on)g(DEALER\))479
3239 y(e)o(xcept)f(it)i(also)g(imposes)f(a)g(strict)h(send)f(/)h(recei)
n(v)o(e)e(c)o(ycle.)-2 3257 y
SDict begin H.S end
 -2 3257 a -2 3257 a
SDict begin 13 H.A end
 -2
3257 a -2 3257 a
SDict begin [/View [/XYZ H.V]/Dest (0:1281) cvn /DEST pdfmark end
 -2 3257 a Black 396 3389 a Fe(\225)p
Black 479 3389 a
SDict begin H.S end
 479 3389 a 479 3389 a
SDict begin 13 H.A end
 479 3389 a 479
3389 a
SDict begin [/View [/XYZ H.V]/Dest (0:1282) cvn /DEST pdfmark end
 479 3389 a Fj(R)m(OUTER)i(prepends)d(an)i(en)m(v)o(elope)d(with)
j(reply)f(address)h(to)g(each)g(message)f(it)i(recei)n(v)o(es,)e
(before)f(passing)i(it)h(to)f(the)479 3496 y(application.)f(It)h(also)h
(chops)e(of)n(f)h(the)g(en)m(v)o(elope)e(\(the)i(\002rst)h(message)f
(frame\))f(from)g(each)h(message)g(it)h(sends,)f(and)479
3604 y(uses)h(that)f(reply)g(address)f(to)i(decide)e(which)h(peer)f
(the)i(message)f(should)f(go)h(to.)-2 3622 y
SDict begin H.S end
 -2 3622
a -2 3622 a
SDict begin 13 H.A end
 -2 3622 a -2 3622 a
SDict begin [/View [/XYZ H.V]/Dest (0:1283) cvn /DEST pdfmark end
 -2 3622 a Black 396 3754
a Fe(\225)p Black 479 3754 a
SDict begin H.S end
 479 3754 a 479 3754 a
SDict begin 13 H.A end
 479
3754 a 479 3754 a
SDict begin [/View [/XYZ H.V]/Dest (0:1284) cvn /DEST pdfmark end
 479 3754 a Fj(REP)h(stores)g(all)g(the)f(message)g
(frames)f(up)h(to)h(the)f(\002rst)h(empty)e(message)h(frame,)f(when)h
(you)f(recei)n(v)o(e)g(a)i(message)479 3862 y(and)f(it)h(passes)g(the)f
(rest)h(\(the)e(data\))h(to)g(your)f(application.)g(When)h(you)f(send)h
(a)h(reply)-5 b(,)18 b(REP)j(prepends)e(the)h(sa)n(v)o(ed)479
3970 y(en)m(v)o(elopes)e(to)j(the)f(message)g(and)g(sends)g(it)h(back)e
(using)h(the)g(same)h(semantics)f(as)h(R)m(OUTER)f(\(and)f(in)i(f)o
(act)f(REP)h(is)479 4078 y(b)n(uilt)g(on)e(top)h(of)g(R)m(OUTER\),)g(b)
n(ut)g(matching)f(REQ,)i(imposes)f(a)g(strict)h(recei)n(v)o(e)e(/)i
(send)f(c)o(ycle.)-2 4262 y
SDict begin H.S end
 -2 4262 a -2 4262 a
SDict begin 13 H.A end
 -2 4262
a -2 4262 a
SDict begin [/View [/XYZ H.V]/Dest (0:1285) cvn /DEST pdfmark end
 -2 4262 a 396 4352 a Fj(REP)h(requires)e(that)i(the)f(en)m
(v)o(elopes)e(end)i(with)g(an)g(empty)g(message)g(frame.)f(If)h(you')l
(re)e(not)i(using)g(REQ)g(at)h(the)f(other)396 4460 y(end)g(of)g(the)g
(chain)g(then)f(you)h(must)g(add)f(the)i(empty)e(message)h(frame)f
(yourself.)-2 4644 y
SDict begin H.S end
 -2 4644 a -2 4644 a
SDict begin 13 H.A end
 -2 4644 a -2
4644 a
SDict begin [/View [/XYZ H.V]/Dest (0:1286) cvn /DEST pdfmark end
 -2 4644 a 396 4733 a Fj(So)i(the)f(ob)o(vious)e(question)h
(about)h(R)m(OUTER)g(is,)h(where)f(does)g(it)h(get)f(the)g(reply)f
(addresses)h(from?)f(And)h(the)g(ob)o(vious)396 4841
y(answer)g(is,)h(it)g(uses)g(the)f(sock)o(et')-5 b(s)20
b(identity)-5 b(.)19 b(As)i(we)g(already)e(learned,)g(if)h(a)h(sock)o
(et)f(does)g(not)g(set)h(an)f(identity)-5 b(,)18 b(the)396
4949 y(R)m(OUTER)j(generates)e(an)h(identity)g(that)g(it)h(can)f
(associate)g(with)h(the)f(connection)e(to)i(that)h(sock)o(et\()p
0 TeXcolorgray 3269 4949 a
SDict begin H.S end
 3269 4949 a Fj(Figure)d(3-3)3617
4949 y
SDict begin 13 H.L end
 3617 4949 a 3617 4949 a
SDict begin [/Subtype /Link/Dest (0:figure-28) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3617 4949 a Black -1 w
Fj(\).)-2 4967 y
SDict begin H.S end
 -2 4967 a -2 4967 a
SDict begin 13 H.A end
 -2 4967 a -2 4967
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-28) cvn /DEST pdfmark
end
 -2 4967 a Black 3800 5569 a Fi(84)p Black eop end
%%Page: 85 99
TeXDict begin 85 98 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.85) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-3.)f(R)n(OUTER)h(In)m(v)
o(ents)h(a)f(UUID)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1290) cvn /DEST pdfmark end
 -2 172 a 396 1789 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 1789 a @beginspecial
0 @llx -189 @lly 372 @urx 0 @ury 3720 @rwi @setspecial
%%BeginDocument: images/fig28.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -189 372 0
%%HiResBoundingBox: 0.0 -189.0 372.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -41.80017852783203 moveto
16.800180435180664 -57.80017852783203 lineto
88.80017852783203 -57.80017852783203 lineto
88.80017852783203 -41.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -60.80017852783203 moveto
16.800180435180664 -73.80017852783203 lineto
16.800180435180664 -76.4668451944987 17.800180435180664 -77.80017852783203 19.800180435180664 -77.80017852783203 curveto
85.80017852783203 -77.80017852783203 lineto
85.80017852783203 -77.80017852783203 lineto
87.80017852783203 -77.80017852783203 88.80017852783203 -76.4668451944987 88.80017852783203 -73.80017852783203 curveto
88.80017852783203 -61.000179290771484 lineto
88.80017852783203 -60.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -59.80017852783203 moveto
136.80018615722656 -77.80017852783203 lineto
196.80018615722656 -77.80017852783203 lineto
196.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -113.80017852783203 moveto
17.800180435180664 -113.80017852783203 16.800180435180664 -115.4668451944987 16.800180435180664 -118.80017852783203 curveto
16.800180435180664 -129.80018615722656 lineto
88.80017852783203 -129.80018615722656 lineto
88.80017852783203 -118.80017852783203 lineto
88.80017852783203 -115.4668451944987 87.80017852783203 -113.80017852783203 85.80017852783203 -113.80017852783203 curveto
19.800180435180664 -113.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -132.80018615722656 moveto
16.800180435180664 -167.80018615722656 lineto
88.80017852783203 -167.80018615722656 lineto
88.80017852783203 -132.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -113.80017852783203 moveto
136.80018615722656 -131.80018615722656 lineto
196.80018615722656 -131.80018615722656 lineto
196.80018615722656 -113.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -131.80018615722656 moveto
136.80018615722656 -149.80018615722656 lineto
148.80018615722656 -149.80018615722656 lineto
148.80018615722656 -131.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -149.80018615722656 moveto
136.80018615722656 -167.80018615722656 lineto
196.80018615722656 -167.80018615722656 lineto
196.80018615722656 -149.80018615722656 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -40.0 moveto
15.0 -56.0 lineto
87.0 -56.0 lineto
87.0 -40.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
15.0 -40.0 moveto
15.0 -56.0 lineto
87.0 -56.0 lineto
87.0 -40.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -59.0 moveto
15.0 -72.0 lineto
15.0 -74.66666666666667 16.0 -76.0 18.0 -76.0 curveto
84.0 -76.0 lineto
84.0 -76.0 lineto
86.0 -76.0 87.0 -74.66666666666667 87.0 -72.0 curveto
87.0 -59.20000076293945 lineto
87.0 -59.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -59.0 moveto
15.0 -72.0 lineto
15.0 -74.66666666666667 16.0 -76.0 18.0 -76.0 curveto
84.0 -76.0 lineto
84.0 -76.0 lineto
86.0 -76.0 87.0 -74.66666666666667 87.0 -72.0 curveto
87.0 -59.20000076293945 lineto
87.0 -59.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -58.0 moveto
135.0 -76.0 lineto
195.0 -76.0 lineto
195.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -58.0 moveto
135.0 -76.0 lineto
195.0 -76.0 lineto
195.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -112.0 moveto
16.0 -112.0 15.0 -113.66666666666667 15.0 -117.0 curveto
15.0 -128.0 lineto
87.0 -128.0 lineto
87.0 -117.0 lineto
87.0 -113.66666666666667 86.0 -112.0 84.0 -112.0 curveto
18.0 -112.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
18.0 -112.0 moveto
16.0 -112.0 15.0 -113.66666666666667 15.0 -117.0 curveto
15.0 -128.0 lineto
87.0 -128.0 lineto
87.0 -117.0 lineto
87.0 -113.66666666666667 86.0 -112.0 84.0 -112.0 curveto
18.0 -112.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -131.0 moveto
15.0 -166.0 lineto
87.0 -166.0 lineto
87.0 -131.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -131.0 moveto
15.0 -166.0 lineto
87.0 -166.0 lineto
87.0 -131.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -112.0 moveto
135.0 -130.0 lineto
195.0 -130.0 lineto
195.0 -112.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -112.0 moveto
135.0 -130.0 lineto
195.0 -130.0 lineto
195.0 -112.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -130.0 moveto
135.0 -148.0 lineto
147.0 -148.0 lineto
147.0 -130.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -130.0 moveto
135.0 -148.0 lineto
147.0 -148.0 lineto
147.0 -130.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -148.0 moveto
135.0 -166.0 lineto
195.0 -166.0 lineto
195.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -148.0 moveto
135.0 -166.0 lineto
195.0 -166.0 lineto
195.0 -148.0 lineto
closepath
stroke
newpath
15.0 -18.0 moveto
15.0 -40.0 lineto
stroke
newpath
87.0 -18.0 moveto
87.0 -40.0 lineto
stroke
newpath
51.0 -76.0 moveto
51.0 -103.0 lineto
stroke
newpath
48.0 -99.0 moveto
51.0 -108.0 lineto
54.0 -99.0 lineto
closepath
fill
/Helvetica findfont
9 scalefont setfont
40.0 -26.0 moveto
(Client) show
43.0 -71.0 moveto
(REQ) show
151.0 -71.0 moveto
(Data) show
239.0 -71.0 moveto
(Client sends this) show
77.0 -98.0 moveto
("My identity is empty") show
32.0 -125.0 moveto
(ROUTER) show
150.0 -125.0 moveto
(UUID) show
228.0 -125.0 moveto
(ROUTER invents UUID to) show
228.0 -134.0 moveto
(use as reply address) show
33.0 -152.0 moveto
(Service) show
151.0 -161.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1789 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1789 a 274 x Fj(When)g(we)h(set)g(our)e(o)n
(wn)h(identity)f(on)h(a)h(sock)o(et,)f(this)g(gets)h(passed)f(to)g(the)
g(R)m(OUTER,)h(which)e(passes)i(it)g(to)f(the)396 2171
y(application)f(as)i(part)f(of)g(the)g(en)m(v)o(elope)e(for)h(each)h
(message)g(that)g(comes)g(in\()p 0 TeXcolorgray 2617
2171 a
SDict begin H.S end
 2617 2171 a Fj(Figure)f(3-4)2966 2171 y
SDict begin 13 H.L end
 2966 2171
a 2966 2171 a
SDict begin [/Subtype /Link/Dest (0:figure-29) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2966 2171 a Black -1 w Fj(\).)-2 2189 y
SDict begin H.S end

-2 2189 a -2 2189 a
SDict begin 13 H.A end
 -2 2189 a -2 2189 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-29) cvn /DEST pdfmark
end
 -2 2189 a 396
2372 a Fk(Figur)o(e)h(3-4.)f(R)n(OUTER)h(uses)i(Identity)e(If)h(It)f
(kno)o(ws)h(It)-2 2472 y
SDict begin H.S end
 -2 2472 a -2 2472 a
SDict begin 13 H.A end
 -2 2472
a -2 2472 a
SDict begin [/View [/XYZ H.V]/Dest (0:1297) cvn /DEST pdfmark end
 -2 2472 a 396 4088 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4088 a @beginspecial
0 @llx -189 @lly 378 @urx 0 @ury 3780 @rwi @setspecial
%%BeginDocument: images/fig29.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -189 378 0
%%HiResBoundingBox: 0.0 -189.0 378.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -23.800180435180664 moveto
16.800180435180664 -57.80017852783203 lineto
88.80017852783203 -57.80017852783203 lineto
88.80017852783203 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -60.80017852783203 moveto
16.800180435180664 -73.80017852783203 lineto
16.800180435180664 -76.4668451944987 17.800180435180664 -77.80017852783203 19.800180435180664 -77.80017852783203 curveto
85.80017852783203 -77.80017852783203 lineto
85.80017852783203 -77.80017852783203 lineto
87.80017852783203 -77.80017852783203 88.80017852783203 -76.4668451944987 88.80017852783203 -73.80017852783203 curveto
88.80017852783203 -61.000179290771484 lineto
88.80017852783203 -60.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -59.80017852783203 moveto
136.80018615722656 -77.80017852783203 lineto
196.80018615722656 -77.80017852783203 lineto
196.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -113.80017852783203 moveto
17.800180435180664 -113.80017852783203 16.800180435180664 -115.4668451944987 16.800180435180664 -118.80017852783203 curveto
16.800180435180664 -129.80018615722656 lineto
88.80017852783203 -129.80018615722656 lineto
88.80017852783203 -118.80017852783203 lineto
88.80017852783203 -115.4668451944987 87.80017852783203 -113.80017852783203 85.80017852783203 -113.80017852783203 curveto
19.800180435180664 -113.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -132.80018615722656 moveto
16.800180435180664 -167.80018615722656 lineto
88.80017852783203 -167.80018615722656 lineto
88.80017852783203 -132.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -113.80017852783203 moveto
136.80018615722656 -131.80018615722656 lineto
196.80018615722656 -131.80018615722656 lineto
196.80018615722656 -113.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -131.80018615722656 moveto
136.80018615722656 -149.80018615722656 lineto
148.80018615722656 -149.80018615722656 lineto
148.80018615722656 -131.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
136.80018615722656 -149.80018615722656 moveto
136.80018615722656 -167.80018615722656 lineto
196.80018615722656 -167.80018615722656 lineto
196.80018615722656 -149.80018615722656 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -22.0 moveto
15.0 -56.0 lineto
87.0 -56.0 lineto
87.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
15.0 -22.0 moveto
15.0 -56.0 lineto
87.0 -56.0 lineto
87.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -59.0 moveto
15.0 -72.0 lineto
15.0 -74.66666666666667 16.0 -76.0 18.0 -76.0 curveto
84.0 -76.0 lineto
84.0 -76.0 lineto
86.0 -76.0 87.0 -74.66666666666667 87.0 -72.0 curveto
87.0 -59.20000076293945 lineto
87.0 -59.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -59.0 moveto
15.0 -72.0 lineto
15.0 -74.66666666666667 16.0 -76.0 18.0 -76.0 curveto
84.0 -76.0 lineto
84.0 -76.0 lineto
86.0 -76.0 87.0 -74.66666666666667 87.0 -72.0 curveto
87.0 -59.20000076293945 lineto
87.0 -59.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -58.0 moveto
135.0 -76.0 lineto
195.0 -76.0 lineto
195.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -58.0 moveto
135.0 -76.0 lineto
195.0 -76.0 lineto
195.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -112.0 moveto
16.0 -112.0 15.0 -113.66666666666667 15.0 -117.0 curveto
15.0 -128.0 lineto
87.0 -128.0 lineto
87.0 -117.0 lineto
87.0 -113.66666666666667 86.0 -112.0 84.0 -112.0 curveto
18.0 -112.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
18.0 -112.0 moveto
16.0 -112.0 15.0 -113.66666666666667 15.0 -117.0 curveto
15.0 -128.0 lineto
87.0 -128.0 lineto
87.0 -117.0 lineto
87.0 -113.66666666666667 86.0 -112.0 84.0 -112.0 curveto
18.0 -112.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -131.0 moveto
15.0 -166.0 lineto
87.0 -166.0 lineto
87.0 -131.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -131.0 moveto
15.0 -166.0 lineto
87.0 -166.0 lineto
87.0 -131.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -112.0 moveto
135.0 -130.0 lineto
195.0 -130.0 lineto
195.0 -112.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -112.0 moveto
135.0 -130.0 lineto
195.0 -130.0 lineto
195.0 -112.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -130.0 moveto
135.0 -148.0 lineto
147.0 -148.0 lineto
147.0 -130.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -130.0 moveto
135.0 -148.0 lineto
147.0 -148.0 lineto
147.0 -130.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
135.0 -148.0 moveto
135.0 -166.0 lineto
195.0 -166.0 lineto
195.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
135.0 -148.0 moveto
135.0 -166.0 lineto
195.0 -166.0 lineto
195.0 -148.0 lineto
closepath
stroke
newpath
51.0 -76.0 moveto
51.0 -103.0 lineto
stroke
newpath
48.0 -99.0 moveto
51.0 -108.0 lineto
54.0 -99.0 lineto
closepath
fill
/Helvetica findfont
9 scalefont setfont
141.0 -35.0 moveto
(zmq_setsockopt \(socket,) show
166.0 -44.0 moveto
(ZMQ_IDENTITY, "Lucy", 4\);) show
40.0 -44.0 moveto
(Client) show
43.0 -71.0 moveto
(REQ) show
151.0 -71.0 moveto
(Data) show
239.0 -71.0 moveto
(Client sends this) show
75.0 -98.0 moveto
("Hi, my name is Lucy") show
32.0 -125.0 moveto
(ROUTER) show
148.0 -125.0 moveto
('Lucy') show
238.0 -125.0 moveto
(ROUTER uses identity of) show
242.0 -134.0 moveto
(client as reply address) show
33.0 -152.0 moveto
(Service) show
151.0 -161.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4088 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4088 a -2 4255 a
SDict begin H.S end
 -2 4255
a -2 4255 a
SDict begin 13 H.A end
 -2 4255 a -2 4255 a
SDict begin [/View [/XYZ H.V]/Dest (0:1300) cvn /DEST pdfmark end
 -2 4255 a 396 4362 a
Fj(Let')-5 b(s)21 b(observ)o(e)e(the)h(abo)o(v)o(e)e(tw)o(o)j(cases)g
(in)f(practice.)g(This)g(program)e(dumps)h(the)h(contents)g(of)g(the)g
(message)g(frames)396 4470 y(that)h(a)f(R)m(OUTER)h(recei)n(v)o(es)e
(from)g(tw)o(o)i(REP)g(sock)o(ets,)f(one)f(not)h(using)g(identities,)g
(and)g(one)f(using)h(an)g(identity)396 4578 y('Hello':)-2
4579 y
SDict begin H.S end
 -2 4579 a -2 4579 a
SDict begin 13 H.A end
 -2 4579 a -2 4579 a
SDict begin [/View [/XYZ H.V]/Dest (0:identity-php) cvn /DEST pdfmark
end
 -2 4579
a 396 4780 a Fk(Example)h(3-1.)e(Identity)h(check)h(\(identity)-6
b(.php\))-2 4880 y
SDict begin H.S end
 -2 4880 a -2 4880 a
SDict begin 11.7 H.A end
 -2 4880 a -2 4880
a
SDict begin [/View [/XYZ H.V]/Dest (0:1303) cvn /DEST pdfmark end
 -2 4880 a 396 4960 a Fg(<?php)396 5057 y(/)441 5070
y(*)441 5167 y(*)531 5154 y(Demonstrate)43 b(identities)g(as)h(used)h
(by)f(the)g(request-reply)f(pattern.)88 b(Run)45 b(this)p
Black 3800 5569 a Fi(85)p Black eop end
%%Page: 86 100
TeXDict begin 86 99 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.86) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 441 85 a Fg(*)531 72 y(program)43 b(by)i(itself.)88
b(Note)45 b(that)f(the)g(utility)g(functions)f(s_)i(are)f(provided)f
(by)441 183 y(*)531 170 y(zhelpers.h.)88 b(It)44 b(gets)g(boring)g(for)
g(everyone)g(to)g(keep)h(repeating)e(this)h(code.)441
280 y(*)531 267 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 377 y(*)486
364 y(/)396 461 y(include)g("zhelpers.php";)396 655 y($context)g(=)g
(new)h(ZMQContext\(\);)396 850 y($sink)f(=)h(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_ROUTER\);)396 947
y($sink->bind\("inproc://example"\);)396 1141 y(//)90
b(First)44 b(allow)g(0MQ)g(to)g(set)h(the)f(identity)396
1238 y($anonymous)f(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REQ\);)396 1335 y
($anonymous->connect\("inproc://example"\);)396 1432
y($anonymous->send\("ROUTER)f(uses)j(a)h(generated)e(UUID"\);)396
1530 y(s_dump)h(\($sink\);)396 1724 y(//)90 b(Then)44
b(set)g(the)g(identity)g(ourself)396 1821 y($identified)f(=)i(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_REQ\);)396 1918 y
($identified->setSockOpt\(ZMQ::SOCKOPT_IDEN)o(TITY,)c("Hello"\);)396
2015 y($identified->connect\("inproc://example"\);)396
2112 y($identified->send\("ROUTER)j(socket)j(uses)g(REQ's)g(socket)g
(identity"\);)396 2209 y(s_dump)g(\($sink\))-2 2387 y
SDict begin H.S end

-2 2387 a -2 2387 a
SDict begin 13 H.A end
 -2 2387 a -2 2387 a
SDict begin [/View [/XYZ H.V]/Dest (0:1304) cvn /DEST pdfmark end
 -2 2387 a 396
2483 a Fj(Here)20 b(is)h(what)g(the)f(dump)f(function)f(prints:)-2
2584 y
SDict begin H.S end
 -2 2584 a -2 2584 a
SDict begin 11.7 H.A end
 -2 2584 a -2 2584 a
SDict begin [/View [/XYZ H.V]/Dest (0:1305) cvn /DEST pdfmark end
 -2 2584
a 396 2664 a Fg(----------------------------------------)396
2761 y([017])44 b(00314F043F46C441E28DD0AC54BE8DA727)396
2858 y([000])396 2955 y([026])g(ROUTER)g(uses)g(a)h(generated)e(UUID)
396 3052 y(----------------------------------------)396
3149 y([005])h(Hello)396 3246 y([000])396 3344 y([038])g(ROUTER)g(uses)
g(REQ's)g(socket)g(identity)-2 3438 y
SDict begin H.S end
 -2 3438 a -2 3438
a
SDict begin 13 H.A end
 -2 3438 a -2 3438 a
SDict begin [/View [/XYZ H.V]/Dest (0:1306) cvn /DEST pdfmark end
 -2 3438 a 366 x Fh(3.2.)39 b(Custom)f
(Request-Repl)n(y)e(Routing)2437 3804 y
SDict begin H.S end
 2437 3804 a 2437
3804 a
SDict begin 22.464 H.A end
 2437 3804 a 2437 3804 a
SDict begin [/View [/XYZ H.V]/Dest (8.32.1) cvn /DEST pdfmark end
 2437 3804 a -2 4002 a
SDict begin H.S end

-2 4002 a -2 4002 a
SDict begin 13 H.A end
 -2 4002 a -2 4002 a
SDict begin [/View [/XYZ H.V]/Dest (0:1308) cvn /DEST pdfmark end
 -2 4002 a 396
4078 a Fj(W)-7 b(e)22 b(already)d(sa)o(w)h(that)h(R)m(OUTER)f(uses)h
(the)f(message)g(en)m(v)o(elope)e(to)i(decide)g(which)f(client)i(to)f
(route)f(a)i(reply)e(back)h(to.)396 4186 y(No)n(w)g(let)h(me)f(e)o
(xpress)g(that)g(in)g(another)f(w)o(ay:)1752 4186 y
SDict begin H.S end
 1752
4186 a 1752 4186 a
SDict begin 13 H.A end
 1752 4186 a 1752 4186 a
SDict begin [/View [/XYZ H.V]/Dest (0:1309) cvn /DEST pdfmark end
 1752 4186
a Fi(R)m(OUTER)h(will)i(r)l(oute)e(messa)o(g)o(es)g(async)o(hr)l
(onously)e(to)j(any)e(peer)396 4294 y(connected)g(to)h(it,)h(if)g(you)e
(pr)l(o)o(vide)h(the)g(corr)m(ect)h(r)l(outing)e(addr)m(ess)h(via)g(a)h
(pr)l(operly)f(constructed)f(en)m(velope)o(.)-2 4477
y
SDict begin H.S end
 -2 4477 a -2 4477 a
SDict begin 13 H.A end
 -2 4477 a -2 4477 a
SDict begin [/View [/XYZ H.V]/Dest (0:1310) cvn /DEST pdfmark end
 -2 4477 a 396
4567 a Fj(So)i(R)m(OUTER)f(is)h(really)f(a)h(fully)e(controllable)g(R)m
(OUTER.)h(W)-7 b(e')o(ll)21 b(dig)f(into)g(this)h(magic)e(in)i(detail.)
-2 4752 y
SDict begin H.S end
 -2 4752 a -2 4752 a
SDict begin 13 H.A end
 -2 4752 a -2 4752 a
SDict begin [/View [/XYZ H.V]/Dest (0:1311) cvn /DEST pdfmark end
 -2
4752 a 396 4841 a Fj(But)g(\002rst,)g(and)e(because)h(we')l(re)f(going)
g(to)i(go)e(of)n(f-road)f(into)i(some)g(rough)e(and)i(possibly)g(ille)o
(gal)f(terrain)h(no)n(w)-5 b(,)19 b(let')-5 b(s)396 4949
y(look)20 b(closer)g(at)g(REQ)h(and)f(REP)-9 b(.)20 b(These)g(pro)o
(vide)e(your)h(kinder)o(garten)e(request-reply)h(sock)o(et)i(pattern.)f
(It')-5 b(s)21 b(an)f(easy)396 5057 y(pattern)g(to)g(learn)g(b)n(ut)g
(quite)g(rapidly)f(gets)h(anno)o(ying)e(as)j(it)g(pro)o(vides,)d(for)i
(instance,)f(no)h(w)o(ay)g(to)h(resend)e(a)i(request)e(if)396
5165 y(it)i(got)f(lost)h(for)e(some)h(reason.)p Black
3798 5569 a Fi(86)p Black eop end
%%Page: 87 101
TeXDict begin 87 100 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.87) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1338) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1312) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(While)21 b(we)f(usually)g(think)g
(of)f(request-reply)f(as)j(a)g(to-and-fro)c(pattern,)i(in)h(f)o(act)h
(it)g(can)f(be)g(fully)f(asynchronous,)f(as)396 180 y(long)i(as)h(we)f
(understand)e(that)i(an)o(y)g(REQs)h(and)f(REPS)h(will)g(be)f(at)h(the)
f(end)f(of)h(a)h(chain,)e(ne)n(v)o(er)g(in)h(the)h(middle)e(of)h(it,)
396 288 y(and)g(al)o(w)o(ays)h(synchronous.)c(All)k(we)f(need)g(to)g
(kno)n(w)f(is)i(the)f(address)g(of)g(the)g(peer)g(we)h(w)o(ant)f(to)g
(talk)g(to,)h(and)e(then)h(we)396 396 y(can)g(then)g(send)g(it)h
(messages)f(asynchronously)-5 b(,)16 b(via)21 b(a)f(R)m(OUTER.)g(The)g
(R)m(OUTER)h(is)g(the)f(one)g(and)f(only)h(\330MQ)396
504 y(sock)o(et)g(type)g(capable)f(of)h(being)f(told)h("send)g(this)h
(message)f(to)g(X")h(where)e(X)i(is)g(the)f(address)g(of)g(a)h
(connected)d(peer)-5 b(.)-2 688 y
SDict begin H.S end
 -2 688 a -2 688 a
SDict begin 13 H.A end
 -2
688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:1313) cvn /DEST pdfmark end
 -2 688 a 396 778 a Fj(These)20 b(are)g(the)h(w)o(ays)f
(we)h(can)f(kno)n(w)f(the)h(address)g(to)g(send)g(a)h(message)f(to,)g
(and)f(you')o(ll)h(see)g(most)h(of)f(these)g(used)g(in)396
886 y(the)g(e)o(xamples)g(of)f(custom)h(request-reply)e(routing:)-2
904 y
SDict begin H.S end
 -2 904 a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:1314) cvn /DEST pdfmark end
 -2 904 a -2
914 a
SDict begin H.S end
 -2 914 a -2 914 a
SDict begin 13 H.A end
 -2 914 a -2 914 a
SDict begin [/View [/XYZ H.V]/Dest (0:1315) cvn /DEST pdfmark end
 -2 914 a Black
396 1056 a Fe(\225)p Black 479 1056 a
SDict begin H.S end
 479 1056 a 479
1056 a
SDict begin 13 H.A end
 479 1056 a 479 1056 a
SDict begin [/View [/XYZ H.V]/Dest (0:1316) cvn /DEST pdfmark end
 479 1056 a Fj(By)j(def)o(ault,)e(a)i(peer)
e(has)i(a)f(null)g(identity)g(and)f(the)i(R)m(OUTER)f(will)h(generate)e
(a)i(UUID)f(and)g(use)g(that)g(to)h(refer)e(to)479 1164
y(the)h(connection)f(when)g(it)i(deli)n(v)o(ers)e(you)h(each)f
(incoming)g(message)h(from)f(that)h(peer)-5 b(.)-2 1182
y
SDict begin H.S end
 -2 1182 a -2 1182 a
SDict begin 13 H.A end
 -2 1182 a -2 1182 a
SDict begin [/View [/XYZ H.V]/Dest (0:1317) cvn /DEST pdfmark end
 -2 1182 a Black
396 1314 a Fe(\225)p Black 479 1314 a
SDict begin H.S end
 479 1314 a 479
1314 a
SDict begin 13 H.A end
 479 1314 a 479 1314 a
SDict begin [/View [/XYZ H.V]/Dest (0:1318) cvn /DEST pdfmark end
 479 1314 a Fj(If)20 b(the)h(peer)e(sock)o
(et)h(set)h(an)f(identity)-5 b(,)19 b(the)h(R)m(OUTER)h(will)g(gi)n(v)o
(e)e(that)i(identity)e(when)h(it)g(deli)n(v)o(ers)g(an)g(incoming)479
1422 y(request)g(en)m(v)o(elope)e(from)h(that)h(peer)-5
b(.)-2 1440 y
SDict begin H.S end
 -2 1440 a -2 1440 a
SDict begin 13 H.A end
 -2 1440 a -2 1440 a
SDict begin [/View [/XYZ H.V]/Dest (0:1319) cvn /DEST pdfmark end

-2 1440 a Black 396 1571 a Fe(\225)p Black 479 1571 a
SDict begin H.S end

479 1571 a 479 1571 a
SDict begin 13 H.A end
 479 1571 a 479 1571 a
SDict begin [/View [/XYZ H.V]/Dest (0:1320) cvn /DEST pdfmark end
 479 1571
a Fj(Peers)21 b(with)f(e)o(xplicit)g(identities)g(can)g(send)g(them)g
(via)g(some)g(other)f(mechanism,)g(e.g.)h(via)g(some)g(other)f(sock)o
(ets.)-2 1589 y
SDict begin H.S end
 -2 1589 a -2 1589 a
SDict begin 13 H.A end
 -2 1589 a -2 1589
a
SDict begin [/View [/XYZ H.V]/Dest (0:1321) cvn /DEST pdfmark end
 -2 1589 a Black 396 1720 a Fe(\225)p Black 479 1720
a
SDict begin H.S end
 479 1720 a 479 1720 a
SDict begin 13 H.A end
 479 1720 a 479 1720 a
SDict begin [/View [/XYZ H.V]/Dest (0:1322) cvn /DEST pdfmark end
 479 1720
a Fj(Peers)i(can)f(ha)n(v)o(e)f(prior)h(kno)n(wledge)e(of)h(each)h
(others')g(identities,)g(e.g.)f(via)h(con\002guration)e(\002les)j(or)f
(some)g(other)479 1828 y(magic.)-2 2012 y
SDict begin H.S end
 -2 2012 a -2
2012 a
SDict begin 13 H.A end
 -2 2012 a -2 2012 a
SDict begin [/View [/XYZ H.V]/Dest (0:1323) cvn /DEST pdfmark end
 -2 2012 a 396 2102 a Fj(There)g(are)g(at)g
(least)h(three)f(routing)f(patterns,)g(one)h(for)f(each)h(of)g(the)g
(sock)o(et)g(types)g(we)h(can)f(easily)g(connect)f(to)i(a)396
2210 y(R)m(OUTER:)-2 2211 y
SDict begin H.S end
 -2 2211 a -2 2211 a
SDict begin 13 H.A end
 -2 2211
a -2 2211 a
SDict begin [/View [/XYZ H.V]/Dest (0:1324) cvn /DEST pdfmark end
 -2 2211 a -2 2221 a
SDict begin H.S end
 -2 2221 a -2 2221 a
SDict begin 13 H.A end
 -2
2221 a -2 2221 a
SDict begin [/View [/XYZ H.V]/Dest (0:1325) cvn /DEST pdfmark end
 -2 2221 a Black 396 2380 a Fe(\225)p
Black 479 2380 a
SDict begin H.S end
 479 2380 a 479 2380 a
SDict begin 13 H.A end
 479 2380 a 479
2380 a
SDict begin [/View [/XYZ H.V]/Dest (0:1326) cvn /DEST pdfmark end
 479 2380 a Fj(R)m(OUTER-to-DEALER.)-2 2381 y
SDict begin H.S end
 -2
2381 a -2 2381 a
SDict begin 13 H.A end
 -2 2381 a -2 2381 a
SDict begin [/View [/XYZ H.V]/Dest (0:1327) cvn /DEST pdfmark end
 -2 2381 a Black
396 2530 a Fe(\225)p Black 479 2530 a
SDict begin H.S end
 479 2530 a 479
2530 a
SDict begin 13 H.A end
 479 2530 a 479 2530 a
SDict begin [/View [/XYZ H.V]/Dest (0:1328) cvn /DEST pdfmark end
 479 2530 a Fj(R)m(OUTER-to-REQ.)-2
2545 y
SDict begin H.S end
 -2 2545 a -2 2545 a
SDict begin 13 H.A end
 -2 2545 a -2 2545 a
SDict begin [/View [/XYZ H.V]/Dest (0:1329) cvn /DEST pdfmark end
 -2 2545
a Black 396 2679 a Fe(\225)p Black 479 2679 a
SDict begin H.S end
 479 2679
a 479 2679 a
SDict begin 13 H.A end
 479 2679 a 479 2679 a
SDict begin [/View [/XYZ H.V]/Dest (0:1330) cvn /DEST pdfmark end
 479 2679 a Fj(R)m(OUTER-to-REP)-9
b(.)-2 2846 y
SDict begin H.S end
 -2 2846 a -2 2846 a
SDict begin 13 H.A end
 -2 2846 a -2 2846 a
SDict begin [/View [/XYZ H.V]/Dest (0:1331) cvn /DEST pdfmark end

-2 2846 a 396 2953 a Fj(In)20 b(each)g(of)g(these)g(cases)h(we)g(ha)n
(v)o(e)e(total)i(control)e(o)o(v)o(er)g(ho)n(w)g(we)i(route)e
(messages,)h(b)n(ut)g(the)h(dif)n(ferent)d(patterns)i(co)o(v)o(er)396
3061 y(dif)n(ferent)f(use-cases)h(and)g(message)g(\003o)n(ws.)g(Let')-5
b(s)21 b(break)e(it)i(do)n(wn)e(o)o(v)o(er)g(the)h(ne)o(xt)g(sections)g
(with)g(e)o(xamples)f(of)396 3169 y(dif)n(ferent)g(routing)f
(algorithms.)-2 3198 y
SDict begin H.S end
 -2 3198 a -2 3198 a
SDict begin 13 H.A end
 -2 3198 a
-2 3198 a
SDict begin [/View [/XYZ H.V]/Dest (0:1332) cvn /DEST pdfmark end
 -2 3198 a 359 x Fh(3.3.)39 b(R)m(OUTER-to-DEALER)34
b(Routing)2284 3557 y
SDict begin H.S end
 2284 3557 a 2284 3557 a
SDict begin 22.464 H.A end
 2284 3557
a 2284 3557 a
SDict begin [/View [/XYZ H.V]/Dest (8.33.1) cvn /DEST pdfmark end
 2284 3557 a -2 3755 a
SDict begin H.S end
 -2 3755 a -2 3755
a
SDict begin 13 H.A end
 -2 3755 a -2 3755 a
SDict begin [/View [/XYZ H.V]/Dest (0:1334) cvn /DEST pdfmark end
 -2 3755 a 396 3831 a Fj(The)20
b(R)m(OUTER-to-DEALER)f(pattern)g(is)i(the)g(simplest.)f(Y)-9
b(ou)19 b(connect)g(one)h(R)m(OUTER)h(to)f(man)o(y)f(DEALERs,)h(and)396
3939 y(then)g(distrib)n(ute)g(messages)g(to)g(the)h(DEALERs)f(using)g
(an)o(y)f(algorithm)g(you)g(lik)o(e.)h(The)g(DEALERs)h(can)f(be)g
(sinks)396 4047 y(\(process)g(the)g(messages)g(without)g(an)o(y)f
(response\),)g(proxies)g(\(send)g(the)i(messages)f(on)g(to)g(other)f
(nodes\),)g(or)h(services)396 4154 y(\(send)g(back)f(replies\).)-2
4338 y
SDict begin H.S end
 -2 4338 a -2 4338 a
SDict begin 13 H.A end
 -2 4338 a -2 4338 a
SDict begin [/View [/XYZ H.V]/Dest (0:1335) cvn /DEST pdfmark end
 -2 4338
a 396 4428 a Fj(If)h(you)g(e)o(xpect)f(the)h(DEALER)g(to)h(reply)-5
b(,)18 b(there)i(should)f(only)h(be)g(one)f(R)m(OUTER)i(talking)e(to)i
(it.)f(DEALERs)h(ha)n(v)o(e)e(no)396 4536 y(idea)h(ho)n(w)g(to)g(reply)
g(to)g(a)h(speci\002c)f(peer)m(,)f(so)i(if)f(the)o(y)g(ha)n(v)o(e)f
(multiple)h(peers,)f(the)o(y)h(will)h(just)g(round-robin)16
b(between)396 4644 y(them,)k(which)f(w)o(ould)h(be)g(weird.)g(If)g(the)
g(DEALER)g(is)h(a)g(sink,)f(an)o(y)f(number)g(of)g(R)m(OUTERs)i(can)f
(talk)h(to)f(it.)-2 4828 y
SDict begin H.S end
 -2 4828 a -2 4828 a
SDict begin 13 H.A end
 -2 4828
a -2 4828 a
SDict begin [/View [/XYZ H.V]/Dest (0:1336) cvn /DEST pdfmark end
 -2 4828 a 396 4918 a Fj(What)h(kind)e(of)h(routing)f(can)h
(you)f(do)h(with)g(a)h(R)m(OUTER-to-DEALER)e(pattern?)g(If)h(the)g
(DEALERs)h(talk)f(back)f(to)396 5026 y(the)h(R)m(OUTER,)h(e.g.)e
(telling)h(the)h(R)m(OUTER)f(when)g(the)o(y)f(\002nished)h(a)g(task,)h
(you)e(can)h(use)g(that)h(kno)n(wledge)d(to)i(route)p
Black 3797 5569 a Fi(87)p Black eop end
%%Page: 88 102
TeXDict begin 88 101 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.88) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fj(depending)18 b(on)i(ho)n(w)f(f)o(ast)i(a)
g(DEALER)f(is.)h(Since)f(both)f(R)m(OUTER)i(and)f(DEALER)g(are)g
(asynchronous,)d(it)k(can)f(get)g(a)396 180 y(little)h(trick)o(y)-5
b(.)19 b(Y)-9 b(ou')l(d)18 b(need)i(to)g(use)1412 180
y
SDict begin H.S end
 1412 180 a 1412 180 a
SDict begin 13 H.A end
 1412 180 a 1412 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:1337) cvn /DEST pdfmark end
 1412 180
a Fg(zmq_poll\(\))f Fj(at)h(least.)396 454 y(W)-7 b(e')o(ll)22
b(mak)o(e)d(an)h(e)o(xample)f(where)h(the)g(DEALERs)h(don')o(t)d(talk)i
(back,)g(the)o(y')l(re)e(pure)h(sinks.)i(Our)e(routing)g(algorithm)396
562 y(will)i(be)f(a)h(weighted)e(random)f(scatter:)j(we)g(ha)n(v)o(e)e
(tw)o(o)i(DEALERs)f(and)g(we)g(send)g(twice)h(as)g(man)o(y)e(messages)h
(to)g(one)396 670 y(as)h(to)g(the)f(other\()p 0 TeXcolorgray
894 670 a
SDict begin H.S end
 894 670 a Fj(Figure)e(3-5)1242 670 y
SDict begin 13 H.L end
 1242 670
a 1242 670 a
SDict begin [/Subtype /Link/Dest (0:figure-30) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1242 670 a Black -2 w Fj(\).)-2 688 y
SDict begin H.S end
 -2
688 a -2 688 a
SDict begin 13 H.A end
 -2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-30) cvn /DEST pdfmark
end
 -2 688 a 396 872 a Fk(Figur)o(e)i
(3-5.)f(R)n(OUTER-to-DEALER)h(Custom)g(Routing)-2 971
y
SDict begin H.S end
 -2 971 a -2 971 a
SDict begin 13 H.A end
 -2 971 a -2 971 a
SDict begin [/View [/XYZ H.V]/Dest (0:1342) cvn /DEST pdfmark end
 -2 971 a 396 3721
a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3721 a @beginspecial 0 @llx -325 @lly 414 @urx
0 @ury 4140 @rwi @setspecial
%%BeginDocument: images/fig30.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -325 414 0
%%HiResBoundingBox: 0.0 -325.0 414.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
87.70027160644531 -34.70027160644531 moveto
87.70027160644531 -84.70027160644531 lineto
213.7002716064453 -84.70027160644531 lineto
213.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
87.70027160644531 -87.70027160644531 moveto
87.70027160644531 -106.70027160644531 lineto
87.70027160644531 -110.70027160644531 89.36693827311198 -112.70027160644531 92.70027160644531 -112.70027160644531 curveto
209.7002716064453 -112.70027160644531 lineto
209.7002716064453 -112.70027160644531 lineto
212.36693827311197 -112.70027160644531 213.7002716064453 -110.70027160644531 213.7002716064453 -106.70027160644531 curveto
213.7002716064453 -88.50027465820312 lineto
213.7002716064453 -87.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
29.70026969909668 -203.7002716064453 moveto
26.366936365763348 -203.7002716064453 24.70026969909668 -206.03360493977866 24.70026969909668 -210.7002716064453 curveto
24.70026969909668 -240.7002716064453 lineto
132.7002716064453 -240.7002716064453 lineto
132.7002716064453 -210.7002716064453 lineto
132.7002716064453 -206.03360493977866 131.36693827311197 -203.7002716064453 128.7002716064453 -203.7002716064453 curveto
29.70026969909668 -203.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -243.7002716064453 moveto
24.70026969909668 -294.70025634765625 lineto
132.7002716064453 -294.70025634765625 lineto
132.7002716064453 -243.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
173.7002716064453 -203.7002716064453 moveto
170.36693827311197 -203.7002716064453 168.7002716064453 -206.03360493977866 168.7002716064453 -210.7002716064453 curveto
168.7002716064453 -240.7002716064453 lineto
276.70025634765625 -240.7002716064453 lineto
276.70025634765625 -210.7002716064453 lineto
276.70025634765625 -206.03360493977866 275.36692301432294 -203.7002716064453 272.70025634765625 -203.7002716064453 curveto
173.7002716064453 -203.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.7002716064453 -243.7002716064453 moveto
168.7002716064453 -294.70025634765625 lineto
276.70025634765625 -294.70025634765625 lineto
276.70025634765625 -243.7002716064453 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
85.0 -32.0 moveto
85.0 -82.0 lineto
211.0 -82.0 lineto
211.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
85.0 -32.0 moveto
85.0 -82.0 lineto
211.0 -82.0 lineto
211.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
85.0 -85.0 moveto
85.0 -104.0 lineto
85.0 -108.0 86.66666666666667 -110.0 90.0 -110.0 curveto
207.0 -110.0 lineto
207.0 -110.0 lineto
209.66666666666666 -110.0 211.0 -108.0 211.0 -104.0 curveto
211.0 -85.80000305175781 lineto
211.0 -85.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
85.0 -85.0 moveto
85.0 -104.0 lineto
85.0 -108.0 86.66666666666667 -110.0 90.0 -110.0 curveto
207.0 -110.0 lineto
207.0 -110.0 lineto
209.66666666666666 -110.0 211.0 -108.0 211.0 -104.0 curveto
211.0 -85.80000305175781 lineto
211.0 -85.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -201.0 moveto
23.666666666666668 -201.0 22.0 -203.33333333333334 22.0 -208.0 curveto
22.0 -238.0 lineto
130.0 -238.0 lineto
130.0 -208.0 lineto
130.0 -203.33333333333334 128.66666666666666 -201.0 126.0 -201.0 curveto
27.0 -201.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -201.0 moveto
23.666666666666668 -201.0 22.0 -203.33333333333334 22.0 -208.0 curveto
22.0 -238.0 lineto
130.0 -238.0 lineto
130.0 -208.0 lineto
130.0 -203.33333333333334 128.66666666666666 -201.0 126.0 -201.0 curveto
27.0 -201.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -241.0 moveto
22.0 -292.0 lineto
130.0 -292.0 lineto
130.0 -241.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
22.0 -241.0 moveto
22.0 -292.0 lineto
130.0 -292.0 lineto
130.0 -241.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
171.0 -201.0 moveto
167.66666666666666 -201.0 166.0 -203.33333333333334 166.0 -208.0 curveto
166.0 -238.0 lineto
274.0 -238.0 lineto
274.0 -208.0 lineto
274.0 -203.33333333333334 272.6666666666667 -201.0 270.0 -201.0 curveto
171.0 -201.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
171.0 -201.0 moveto
167.66666666666666 -201.0 166.0 -203.33333333333334 166.0 -208.0 curveto
166.0 -238.0 lineto
274.0 -238.0 lineto
274.0 -208.0 lineto
274.0 -203.33333333333334 272.6666666666667 -201.0 270.0 -201.0 curveto
171.0 -201.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
166.0 -241.0 moveto
166.0 -292.0 lineto
274.0 -292.0 lineto
274.0 -241.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
166.0 -241.0 moveto
166.0 -292.0 lineto
274.0 -292.0 lineto
274.0 -241.0 lineto
closepath
stroke
newpath
72.0 -182.0 moveto
76.0 -195.0 lineto
81.0 -182.0 lineto
closepath
fill
newpath
216.0 -182.0 moveto
220.0 -195.0 lineto
225.0 -182.0 lineto
closepath
fill
newpath
148.0 -110.0 moveto
148.0 -149.0 lineto
stroke
newpath
76.0 -188.0 moveto
76.0 -149.0 lineto
148.0 -149.0 lineto
stroke
newpath
220.0 -188.0 moveto
220.0 -149.0 lineto
148.0 -149.0 lineto
stroke
/Helvetica findfont
14 scalefont setfont
122.0 -64.0 moveto
(Client) show
244.0 -64.0 moveto
(Send to "A" or "B") show
119.0 -102.0 moveto
(ROUTER) show
46.0 -219.0 moveto
(DEALER) show
64.0 -233.0 moveto
("A") show
190.0 -219.0 moveto
(DEALER) show
208.0 -233.0 moveto
("B") show
46.0 -272.0 moveto
(Worker) show
199.0 -272.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3721 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3721 a -2 3887 a
SDict begin H.S end
 -2 3887
a -2 3887 a
SDict begin 13 H.A end
 -2 3887 a -2 3887 a
SDict begin [/View [/XYZ H.V]/Dest (0:1345) cvn /DEST pdfmark end
 -2 3887 a 396 3995 a
Fj(Here')-5 b(s)21 b(code)e(that)h(sho)n(ws)h(ho)n(w)e(this)i(w)o
(orks:)-2 3996 y
SDict begin H.S end
 -2 3996 a -2 3996 a
SDict begin 13 H.A end
 -2 3996 a -2 3996
a
SDict begin [/View [/XYZ H.V]/Dest (0:rtdealer-php) cvn /DEST pdfmark
end
 -2 3996 a 396 4197 a Fk(Example)g(3-2.)e(R)n(OUTER-to-DEALER)h
(\(rtdealer)-8 b(.php\))-2 4296 y
SDict begin H.S end
 -2 4296 a -2 4296 a
SDict begin 11.7 H.A end

-2 4296 a -2 4296 a
SDict begin [/View [/XYZ H.V]/Dest (0:1348) cvn /DEST pdfmark end
 -2 4296 a 396 4377 a Fg(<?php)396
4474 y(/)441 4487 y(*)441 4584 y(*)531 4571 y(Custom)44
b(routing)f(Router)h(to)h(Dealer)441 4681 y(*)531 4668
y(@author)e(Ian)i(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
4778 y(*)486 4765 y(/)396 5057 y(//)90 b(We)44 b(have)g(two)h(workers,)
e(here)h(we)h(copy)f(the)g(code,)g(normally)g(these)g(would)396
5154 y(//)90 b(run)44 b(on)g(different)g(boxes...)p Black
3800 5569 a Fi(88)p Black eop end
%%Page: 89 103
TeXDict begin 89 102 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.89) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fg(function)44 b(worker_a\(\))f({)441
170 y($context)h(=)g(new)h(ZMQContext\(\);)441 267 y($worker)f(=)g
($context->getSocket\(ZMQ::SOCKET_DEALER\);)441 364 y
($worker->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)39 b("A"\);)441
461 y($worker->connect\("ipc://routing.ipc"\);)441 655
y($total)44 b(=)h(0;)441 752 y(while\(true\))e({)486
850 y(//)89 b(We)45 b(receive)e(one)i(part,)f(with)g(the)g(workload)486
947 y($request)f(=)i($worker->recv\(\);)486 1044 y(if\($request)e(==)h
('END'\))g({)531 1141 y(printf)g(\("A)g(received:)f(\045d\045s",)h
($total,)g(PHP_EOL\);)531 1238 y(break;)486 1335 y(})486
1432 y($total++;)441 1530 y(})396 1627 y(})396 1821 y(function)g
(worker_b\(\))f({)441 1918 y($context)h(=)g(new)h(ZMQContext\(\);)441
2015 y($worker)f(=)g($context->getSocket\(ZMQ::SOCKET_DEALER\);)441
2112 y($worker->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)39
b("B"\);)441 2209 y($worker->connect\("ipc://routing.ipc"\);)441
2404 y($total)44 b(=)h(0;)441 2501 y(while\(true\))e({)486
2598 y(//)89 b(We)45 b(receive)e(one)i(part,)f(with)g(the)g(workload)
486 2695 y($request)f(=)i($worker->recv\(\);)486 2792
y(if\($request)e(==)h('END'\))g({)531 2889 y(printf)g(\("B)g(received:)
f(\045d\045s",)h($total,)g(PHP_EOL\);)531 2987 y(break;)486
3084 y(})486 3181 y($total++;)441 3278 y(})396 3375 y(})396
3569 y($pid)g(=)h(pcntl_fork\(\);)396 3666 y(if\($pid)f(==)g(0\))h({)g
(worker_a\(\);)e(exit\(\);)g(})396 3764 y($pid)h(=)h(pcntl_fork\(\);)
396 3861 y(if\($pid)f(==)g(0\))h({)g(worker_b\(\);)e(exit\(\);)g(})396
4055 y($context)h(=)g(new)h(ZMQContext\(\);)396 4152
y($client)f(=)h(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_ROUTER\);)396
4249 y($client->bind\("ipc://routing.ipc"\);)396 4444
y(//)90 b(Wait)44 b(for)g(threads)g(to)g(stabilize)396
4541 y(sleep\(1\);)396 4735 y(//)90 b(Send)44 b(10)g(tasks)g(scattered)
g(to)g(A)h(twice)f(as)g(often)g(as)h(B)396 4832 y(for)g(\($task_nbr)e
(=)h(0;)h($task_nbr)e(!=)i(10;)f($task_nbr++\))f({)441
4929 y(//)89 b(Send)45 b(two)f(message)g(parts,)f(first)h(the)h
(address...)441 5026 y(if\(mt_rand\(0,)e(2\))h(>)h(0\))f({)486
5124 y($client->send\("A",)e(ZMQ::MODE_SNDMORE\);)p Black
3800 5569 a Fi(89)p Black eop end
%%Page: 90 104
TeXDict begin 90 103 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.90) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 441 72 a Fg(})45 b(else)f({)486 170
y($client->send\("B",)e(ZMQ::MODE_SNDMORE\);)441 267
y(})441 364 y(//)89 b(And)45 b(then)f(the)g(workload)441
461 y($client->send\("This)e(is)i(the)h(workload"\);)396
558 y(})396 752 y($client->send\("A",)d(ZMQ::MODE_SNDMORE\);)396
850 y($client->send\("END"\);)396 1044 y($client->send\("B",)g
(ZMQ::MODE_SNDMORE\);)396 1141 y($client->send\("END"\);)396
1335 y(sleep)i(\(1\);)627 b(//)90 b(Give)44 b(0MQ/2.0.x)f(time)h(to)h
(flush)f(output)-2 1513 y
SDict begin H.S end
 -2 1513 a -2 1513 a
SDict begin 13 H.A end
 -2 1513
a -2 1513 a
SDict begin [/View [/XYZ H.V]/Dest (0:1349) cvn /DEST pdfmark end
 -2 1513 a 396 1609 a Fj(Some)20 b(comments)f(on)h(this)h
(code:)-2 1610 y
SDict begin H.S end
 -2 1610 a -2 1610 a
SDict begin 13 H.A end
 -2 1610 a -2 1610
a
SDict begin [/View [/XYZ H.V]/Dest (0:1350) cvn /DEST pdfmark end
 -2 1610 a -2 1620 a
SDict begin H.S end
 -2 1620 a -2 1620 a
SDict begin 13 H.A end
 -2 1620 a -2
1620 a
SDict begin [/View [/XYZ H.V]/Dest (0:1351) cvn /DEST pdfmark end
 -2 1620 a Black 396 1779 a Fe(\225)p Black 479
1779 a
SDict begin H.S end
 479 1779 a 479 1779 a
SDict begin 13 H.A end
 479 1779 a 479 1779 a
SDict begin [/View [/XYZ H.V]/Dest (0:1352) cvn /DEST pdfmark end
 479
1779 a Fj(The)f(R)m(OUTER)h(doesn')o(t)d(kno)n(w)h(when)h(the)g
(DEALERs)h(are)f(ready)-5 b(,)18 b(and)i(it)h(w)o(ould)e(be)i
(distracting)e(for)g(our)479 1887 y(e)o(xample)g(to)h(add)g(in)g(the)h
(signaling)e(to)h(do)g(that.)g(So)g(the)h(R)m(OUTER)f(just)h(does)f(a)g
("sleep)h(\(1\)")e(after)h(starting)g(the)479 1995 y(DEALER)g(threads.)
g(W)m(ithout)f(this)i(sleep,)f(the)g(R)m(OUTER)h(will)g(send)f(out)g
(messages)g(that)g(can')o(t)f(be)i(routed,)d(and)479
2103 y(\330MQ)j(will)g(discard)e(them.)-2 2118 y
SDict begin H.S end
 -2 2118
a -2 2118 a
SDict begin 13 H.A end
 -2 2118 a -2 2118 a
SDict begin [/View [/XYZ H.V]/Dest (0:1353) cvn /DEST pdfmark end
 -2 2118 a Black 396 2253
a Fe(\225)p Black 479 2253 a
SDict begin H.S end
 479 2253 a 479 2253 a
SDict begin 13 H.A end
 479
2253 a 479 2253 a
SDict begin [/View [/XYZ H.V]/Dest (0:1354) cvn /DEST pdfmark end
 479 2253 a Fj(Note)h(that)h(this)f(beha)n(vior)f(is)i
(speci\002c)g(to)f(R)m(OUTERs.)g(PUB)i(sock)o(ets)e(will)h(also)f
(discard)g(messages)g(if)h(there)f(are)479 2361 y(no)g(subscribers,)f
(b)n(ut)h(all)h(other)e(sock)o(et)h(types)g(will)h(queue)e(sent)i
(messages)f(until)g(there')-5 b(s)20 b(a)h(peer)f(to)g(recei)n(v)o(e)f
(them.)-2 2545 y
SDict begin H.S end
 -2 2545 a -2 2545 a
SDict begin 13 H.A end
 -2 2545 a -2 2545
a
SDict begin [/View [/XYZ H.V]/Dest (0:1355) cvn /DEST pdfmark end
 -2 2545 a 396 2635 a Fj(T)-7 b(o)21 b(route)e(to)h(a)h(DEALER,)f(we)g
(create)g(an)h(en)m(v)o(elope)c(consisting)j(of)g(just)h(an)f(identity)
f(frame)g(\(we)i(don')o(t)d(need)i(a)g(null)396 2742
y(separator\)\()p 0 TeXcolorgray 758 2742 a
SDict begin H.S end
 758 2742
a Fj(Figure)d(3-6)1105 2742 y
SDict begin 13 H.L end
 1105 2742 a 1105 2742 a
SDict begin [/Subtype /Link/Dest (0:figure-31) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

1105 2742 a Black -1 w Fj(\).)-2 2760 y
SDict begin H.S end
 -2 2760 a -2
2760 a
SDict begin 13 H.A end
 -2 2760 a -2 2760 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-31) cvn /DEST pdfmark
end
 -2 2760 a 396 2944 a Fk(Figur)o(e)j(3-6.)f
(Routing)h(En)m(v)o(elope)g(f)n(or)f(DEALER)-2 3044 y
SDict begin H.S end

-2 3044 a -2 3044 a
SDict begin 13 H.A end
 -2 3044 a -2 3044 a
SDict begin [/View [/XYZ H.V]/Dest (0:1359) cvn /DEST pdfmark end
 -2 3044 a 396
3835 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3835 a @beginspecial 0 @llx -90 @lly 385 @urx
0 @ury 3850 @rwi @setspecial
%%BeginDocument: images/fig31.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -90 385 0
%%HiResBoundingBox: 0.0 -90.0 385.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -27.100210189819336 moveto
89.10021209716797 -47.1002082824707 lineto
187.10020446777344 -47.1002082824707 lineto
187.10020446777344 -27.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -47.1002082824707 moveto
89.10021209716797 -67.10021209716797 lineto
369.1002197265625 -67.10021209716797 lineto
369.1002197265625 -47.1002082824707 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -25.0 moveto
87.0 -45.0 lineto
185.0 -45.0 lineto
185.0 -25.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -25.0 moveto
87.0 -45.0 lineto
185.0 -45.0 lineto
185.0 -25.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -65.0 lineto
367.0 -65.0 lineto
367.0 -45.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -65.0 lineto
367.0 -65.0 lineto
367.0 -45.0 lineto
closepath
stroke
/Helvetica findfont
10 scalefont setfont
15.0 -39.0 moveto
(Frame 1) show
99.0 -39.0 moveto
(Address) show
15.0 -59.0 moveto
(Frame 2) show
99.0 -59.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3835 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3835 a -2 4001 a
SDict begin H.S end
 -2 4001
a -2 4001 a
SDict begin 13 H.A end
 -2 4001 a -2 4001 a
SDict begin [/View [/XYZ H.V]/Dest (0:1362) cvn /DEST pdfmark end
 -2 4001 a 396 4109 a
Fj(The)h(R)m(OUTER)h(sock)o(et)f(remo)o(v)o(es)e(the)i(\002rst)h
(frame,)e(and)h(sends)g(the)h(second)e(frame,)g(which)h(the)g(DEALER)g
(gets)396 4217 y(as-is.)h(When)f(the)g(DEALER)g(sends)h(a)f(message)g
(to)h(the)f(R)m(OUTER,)g(it)h(sends)f(one)g(frame.)f(The)h(R)m(OUTER)g
(prepends)396 4325 y(the)g(DEALER')-5 b(s)21 b(address)f(and)f(gi)n(v)o
(es)h(us)h(back)e(a)i(similar)f(en)m(v)o(elope)e(in)i(tw)o(o)h(parts.)
-2 4509 y
SDict begin H.S end
 -2 4509 a -2 4509 a
SDict begin 13 H.A end
 -2 4509 a -2 4509 a
SDict begin [/View [/XYZ H.V]/Dest (0:1363) cvn /DEST pdfmark end
 -2
4509 a 396 4599 a Fj(Something)e(to)h(note:)g(if)g(you)g(use)g(an)g(in)
m(v)n(alid)f(address,)h(the)g(R)m(OUTER)h(discards)e(the)i(message)f
(silently)-5 b(.)19 b(There)h(is)396 4707 y(not)f(much)g(else)h(it)g
(can)f(do)g(usefully)-5 b(.)18 b(In)h(normal)f(cases)i(this)g(either)f
(means)h(the)f(peer)g(has)g(gone)g(a)o(w)o(ay)-5 b(,)18
b(or)h(that)h(there)f(is)396 4815 y(a)h(programming)d(error)h(some)n
(where)h(and)g(you')l(re)f(using)h(a)h(bogus)f(address.)g(In)h(an)o(y)f
(case)h(you)f(cannot)g(e)n(v)o(er)g(assume)g(a)396 4923
y(message)h(will)h(be)f(routed)f(successfully)h(until)g(and)f(unless)i
(you)e(get)h(a)h(reply)e(of)h(some)g(sort)g(from)g(the)g(destination)
396 5031 y(node.)f(W)-7 b(e')o(ll)21 b(come)f(to)g(creating)g(reliable)
f(patterns)h(later)g(on.)p Black 3800 5569 a Fi(90)p
Black eop end
%%Page: 91 105
TeXDict begin 91 104 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.91) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1388) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1364) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(DEALERs)21 b(in)f(f)o(act)g(w)o
(ork)g(e)o(xactly)f(lik)o(e)i(PUSH)g(and)e(PULL)i(combined.)d(Do)i(not)
g(ho)n(we)n(v)o(er)e(connect)h(PUSH)i(or)396 180 y(PULL)g(sock)o(ets)f
(to)g(DEALERS.)g(That)g(w)o(ould)g(just)g(be)h(nasty)f(and)f
(pointless.)-2 209 y
SDict begin H.S end
 -2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a -2 209
a
SDict begin [/View [/XYZ H.V]/Dest (0:1365) cvn /DEST pdfmark end
 -2 209 a 359 x Fh(3.4.)39 b(Least-Recentl)n(y)d(Used)j(Routing)e
(\(LR)m(U)i(P)l(attern\))3227 568 y
SDict begin H.S end
 3227 568 a 3227 568
a
SDict begin 22.464 H.A end
 3227 568 a 3227 568 a
SDict begin [/View [/XYZ H.V]/Dest (8.34.1) cvn /DEST pdfmark end
 3227 568 a -2 766 a
SDict begin H.S end
 -2 766 a
-2 766 a
SDict begin 13 H.A end
 -2 766 a -2 766 a
SDict begin [/View [/XYZ H.V]/Dest (0:1367) cvn /DEST pdfmark end
 -2 766 a 396 842 a Fj(REQ)21
b(sock)o(ets)f(don')o(t)f(listen)i(to)f(you,)f(and)h(if)g(you)f(try)h
(to)h(speak)f(out)f(of)h(turn)g(the)o(y')o(ll)f(ignore)g(you.)g(Y)-9
b(ou)20 b(ha)n(v)o(e)f(to)i(w)o(ait)396 950 y(for)f(them)g(to)g(say)g
(something,)f(and)1445 950 y
SDict begin H.S end
 1445 950 a 1445 950 a
SDict begin 13 H.A end
 1445
950 a 1445 950 a
SDict begin [/View [/XYZ H.V]/Dest (0:1368) cvn /DEST pdfmark end
 1445 950 a Fi(then)h Fj(you)f(can)h(gi)n(v)o(e)g(a)g
(sarcastic)h(answer)-5 b(.)20 b(This)h(is)g(v)o(ery)e(useful)g(for)h
(routing)396 1058 y(because)g(it)h(means)f(we)g(can)g(k)o(eep)g(a)g(b)n
(unch)f(of)h(REQs)h(w)o(aiting)f(for)g(answers.)g(In)g(ef)n(fect,)f(a)i
(REQ)g(sock)o(et)f(will)h(tell)f(us)396 1166 y(when)g(it')-5
b(s)21 b(ready)-5 b(.)-2 1350 y
SDict begin H.S end
 -2 1350 a -2 1350 a
SDict begin 13 H.A end
 -2
1350 a -2 1350 a
SDict begin [/View [/XYZ H.V]/Dest (0:1369) cvn /DEST pdfmark end
 -2 1350 a 396 1440 a Fj(Y)c(ou)20 b(can)g(connect)f
(one)g(R)m(OUTER)i(to)f(man)o(y)f(REQs,)i(and)f(distrib)n(ute)g
(messages)g(as)h(you)e(w)o(ould)h(to)g(DEALERs.)396 1548
y(REQs)g(will)f(usually)g(w)o(ant)g(to)f(reply)-5 b(,)18
b(b)n(ut)h(the)o(y)f(will)h(let)g(you)f(ha)n(v)o(e)g(the)h(last)h(w)o
(ord.)e(Ho)n(we)n(v)o(er)f(it')-5 b(s)20 b(one)e(thing)g(at)h(a)g
(time:)-2 1566 y
SDict begin H.S end
 -2 1566 a -2 1566 a
SDict begin 13 H.A end
 -2 1566 a -2 1566
a
SDict begin [/View [/XYZ H.V]/Dest (0:1370) cvn /DEST pdfmark end
 -2 1566 a -2 1576 a
SDict begin H.S end
 -2 1576 a -2 1576 a
SDict begin 13 H.A end
 -2 1576 a -2
1576 a
SDict begin [/View [/XYZ H.V]/Dest (0:1371) cvn /DEST pdfmark end
 -2 1576 a Black 396 1718 a Fe(\225)p Black 479
1718 a
SDict begin H.S end
 479 1718 a 479 1718 a
SDict begin 13 H.A end
 479 1718 a 479 1718 a
SDict begin [/View [/XYZ H.V]/Dest (0:1372) cvn /DEST pdfmark end
 479
1718 a Fj(REQ)i(speaks)f(to)h(R)m(OUTER)-2 1736 y
SDict begin H.S end
 -2
1736 a -2 1736 a
SDict begin 13 H.A end
 -2 1736 a -2 1736 a
SDict begin [/View [/XYZ H.V]/Dest (0:1373) cvn /DEST pdfmark end
 -2 1736 a Black
396 1867 a Fe(\225)p Black 479 1867 a
SDict begin H.S end
 479 1867 a 479
1867 a
SDict begin 13 H.A end
 479 1867 a 479 1867 a
SDict begin [/View [/XYZ H.V]/Dest (0:1374) cvn /DEST pdfmark end
 479 1867 a Fj(R)m(OUTER)g(replies)f(to)g
(REQ)-2 1885 y
SDict begin H.S end
 -2 1885 a -2 1885 a
SDict begin 13 H.A end
 -2 1885 a -2 1885
a
SDict begin [/View [/XYZ H.V]/Dest (0:1375) cvn /DEST pdfmark end
 -2 1885 a Black 396 2017 a Fe(\225)p Black 479 2017
a
SDict begin H.S end
 479 2017 a 479 2017 a
SDict begin 13 H.A end
 479 2017 a 479 2017 a
SDict begin [/View [/XYZ H.V]/Dest (0:1376) cvn /DEST pdfmark end
 479 2017
a Fj(REQ)h(speaks)f(to)h(R)m(OUTER)-2 2035 y
SDict begin H.S end
 -2 2035
a -2 2035 a
SDict begin 13 H.A end
 -2 2035 a -2 2035 a
SDict begin [/View [/XYZ H.V]/Dest (0:1377) cvn /DEST pdfmark end
 -2 2035 a Black 396 2166
a Fe(\225)p Black 479 2166 a
SDict begin H.S end
 479 2166 a 479 2166 a
SDict begin 13 H.A end
 479
2166 a 479 2166 a
SDict begin [/View [/XYZ H.V]/Dest (0:1378) cvn /DEST pdfmark end
 479 2166 a Fj(R)m(OUTER)g(replies)f(to)g(REQ)-2
2184 y
SDict begin H.S end
 -2 2184 a -2 2184 a
SDict begin 13 H.A end
 -2 2184 a -2 2184 a
SDict begin [/View [/XYZ H.V]/Dest (0:1379) cvn /DEST pdfmark end
 -2 2184
a Black 396 2316 a Fe(\225)p Black 479 2316 a
SDict begin H.S end
 479 2316
a 479 2316 a
SDict begin 13 H.A end
 479 2316 a 479 2316 a
SDict begin [/View [/XYZ H.V]/Dest (0:1380) cvn /DEST pdfmark end
 479 2316 a Fj(etc.)-2
2482 y
SDict begin H.S end
 -2 2482 a -2 2482 a
SDict begin 13 H.A end
 -2 2482 a -2 2482 a
SDict begin [/View [/XYZ H.V]/Dest (0:1381) cvn /DEST pdfmark end
 -2 2482
a 396 2589 a Fj(Lik)o(e)g(DEALERs,)h(REQs)g(can)f(only)f(talk)h(to)h
(one)e(R)m(OUTER)i(and)e(since)i(REQs)g(al)o(w)o(ays)g(start)f(by)g
(talking)f(to)i(the)396 2697 y(R)m(OUTER,)g(you)e(should)g(ne)n(v)o(er)
g(connect)g(one)g(REQ)i(to)g(more)e(than)h(one)f(R)m(OUTER)i(unless)f
(you)f(are)i(doing)d(sneak)o(y)396 2805 y(stuf)n(f)i(lik)o(e)h
(multi-pathw)o(ay)d(redundant)g(routing\()p 0 TeXcolorgray
1839 2805 a
SDict begin H.S end
 1839 2805 a Fj(Figure)f(3-7)2186 2805 y
SDict begin 13 H.L end
 2186
2805 a 2186 2805 a
SDict begin [/Subtype /Link/Dest (0:figure-32) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2186 2805 a Black -2 w Fj(\).)j(I'm)g(not)g(e)n(v)o
(en)f(going)g(to)h(e)o(xplain)f(that)h(no)n(w)-5 b(,)19
b(and)396 2913 y(hopefully)f(the)i(jar)o(gon)f(is)i(comple)o(x)d
(enough)h(to)h(stop)g(you)f(trying)g(this)i(until)f(you)f(need)h(it.)-2
2931 y
SDict begin H.S end
 -2 2931 a -2 2931 a
SDict begin 13 H.A end
 -2 2931 a -2 2931 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-32) cvn /DEST pdfmark
end
 -2 2931
a Black 3800 5569 a Fi(91)p Black eop end
%%Page: 92 106
TeXDict begin 92 105 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.92) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-7.)f(R)n(OUTER)h(to)g
(REQ)h(Custom)f(Routing)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2
172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1385) cvn /DEST pdfmark end
 -2 172 a 396 2597 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2597 a @beginspecial
0 @llx -286 @lly 432 @urx 0 @ury 4320 @rwi @setspecial
%%BeginDocument: images/fig32.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -286 432 0
%%HiResBoundingBox: 0.0 -286.0 432.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -29.400239944458008 moveto
78.40023803710938 -71.40023803710938 lineto
190.40023803710938 -71.40023803710938 lineto
190.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -74.40023803710938 moveto
78.40023803710938 -90.40023803710938 lineto
78.40023803710938 -93.7335713704427 79.7335713704427 -95.40023803710938 82.40023803710938 -95.40023803710938 curveto
186.40023803710938 -95.40023803710938 lineto
186.40023803710938 -95.40023803710938 lineto
189.06690470377603 -95.40023803710938 190.40023803710938 -93.7335713704427 190.40023803710938 -90.40023803710938 curveto
190.40023803710938 -75.00023651123047 lineto
190.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -183.40023803710938 moveto
23.73357327779134 -183.40023803710938 22.400239944458008 -185.40023803710938 22.400239944458008 -189.40023803710938 curveto
22.400239944458008 -214.40023803710938 lineto
118.40023803710938 -214.40023803710938 lineto
118.40023803710938 -189.40023803710938 lineto
118.40023803710938 -185.40023803710938 117.06690470377605 -183.40023803710938 114.40023803710938 -183.40023803710938 curveto
26.400239944458008 -183.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -217.40023803710938 moveto
22.400239944458008 -260.4002380371094 lineto
118.40023803710938 -260.4002380371094 lineto
118.40023803710938 -217.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -183.40023803710938 moveto
151.73357137044272 -183.40023803710938 150.40023803710938 -185.40023803710938 150.40023803710938 -189.40023803710938 curveto
150.40023803710938 -214.40023803710938 lineto
246.40023803710938 -214.40023803710938 lineto
246.40023803710938 -189.40023803710938 lineto
246.40023803710938 -185.40023803710938 245.06690470377603 -183.40023803710938 242.40023803710938 -183.40023803710938 curveto
154.40023803710938 -183.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -217.40023803710938 moveto
150.40023803710938 -260.4002380371094 lineto
246.40023803710938 -260.4002380371094 lineto
246.40023803710938 -217.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -27.0 moveto
76.0 -69.0 lineto
188.0 -69.0 lineto
188.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
76.0 -27.0 moveto
76.0 -69.0 lineto
188.0 -69.0 lineto
188.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -72.0 moveto
76.0 -88.0 lineto
76.0 -91.33333333333333 77.33333333333333 -93.0 80.0 -93.0 curveto
184.0 -93.0 lineto
184.0 -93.0 lineto
186.66666666666666 -93.0 188.0 -91.33333333333333 188.0 -88.0 curveto
188.0 -72.5999984741211 lineto
188.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -72.0 moveto
76.0 -88.0 lineto
76.0 -91.33333333333333 77.33333333333333 -93.0 80.0 -93.0 curveto
184.0 -93.0 lineto
184.0 -93.0 lineto
186.66666666666666 -93.0 188.0 -91.33333333333333 188.0 -88.0 curveto
188.0 -72.5999984741211 lineto
188.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -181.0 moveto
21.333333333333332 -181.0 20.0 -183.0 20.0 -187.0 curveto
20.0 -212.0 lineto
116.0 -212.0 lineto
116.0 -187.0 lineto
116.0 -183.0 114.66666666666667 -181.0 112.0 -181.0 curveto
24.0 -181.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -181.0 moveto
21.333333333333332 -181.0 20.0 -183.0 20.0 -187.0 curveto
20.0 -212.0 lineto
116.0 -212.0 lineto
116.0 -187.0 lineto
116.0 -183.0 114.66666666666667 -181.0 112.0 -181.0 curveto
24.0 -181.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -215.0 moveto
20.0 -258.0 lineto
116.0 -258.0 lineto
116.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -215.0 moveto
20.0 -258.0 lineto
116.0 -258.0 lineto
116.0 -215.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -181.0 moveto
149.33333333333334 -181.0 148.0 -183.0 148.0 -187.0 curveto
148.0 -212.0 lineto
244.0 -212.0 lineto
244.0 -187.0 lineto
244.0 -183.0 242.66666666666666 -181.0 240.0 -181.0 curveto
152.0 -181.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -181.0 moveto
149.33333333333334 -181.0 148.0 -183.0 148.0 -187.0 curveto
148.0 -212.0 lineto
244.0 -212.0 lineto
244.0 -187.0 lineto
244.0 -183.0 242.66666666666666 -181.0 240.0 -181.0 curveto
152.0 -181.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -215.0 moveto
148.0 -258.0 lineto
244.0 -258.0 lineto
244.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -215.0 moveto
148.0 -258.0 lineto
244.0 -258.0 lineto
244.0 -215.0 lineto
closepath
stroke
newpath
132.0 -99.0 moveto
128.0 -110.0 lineto
136.0 -110.0 lineto
closepath
fill
newpath
64.0 -165.0 moveto
68.0 -176.0 lineto
72.0 -165.0 lineto
closepath
fill
newpath
192.0 -165.0 moveto
196.0 -176.0 lineto
200.0 -165.0 lineto
closepath
fill
newpath
132.0 -104.0 moveto
132.0 -137.0 lineto
stroke
newpath
68.0 -170.0 moveto
68.0 -137.0 lineto
132.0 -137.0 lineto
stroke
newpath
196.0 -170.0 moveto
196.0 -137.0 lineto
132.0 -137.0 lineto
stroke
/Helvetica findfont
11 scalefont setfont
109.0 -54.0 moveto
(Client) show
231.0 -54.0 moveto
(Send to "A" or "B") show
106.0 -87.0 moveto
(ROUTER) show
163.0 -120.0 moveto
(\(1\) REQ says Hi) show
239.0 -164.0 moveto
(\(2\) ROUTER gives laundry) show
57.0 -197.0 moveto
(REQ) show
58.0 -208.0 moveto
("A") show
185.0 -197.0 moveto
(REQ) show
186.0 -208.0 moveto
("B") show
41.0 -241.0 moveto
(Worker) show
177.0 -241.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2597 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2597 a 274 x Fj(What)h(kind)e(of)h(routing)
f(can)h(you)f(do)h(with)g(a)h(R)m(OUTER-to-REQ)e(pattern?)g(Probably)g
(the)h(most)g(ob)o(vious)f(is)396 2979 y("least-recently-used")f(\(LR)m
(U\),)h(where)h(we)g(al)o(w)o(ays)h(route)e(to)i(the)f(REQ)h(that')-5
b(s)21 b(been)e(w)o(aiting)h(longest.)f(Here)h(is)i(an)396
3087 y(e)o(xample)d(that)h(does)g(LR)m(U)h(routing)d(to)j(a)f(set)h(of)
f(REQs:)-2 3105 y
SDict begin H.S end
 -2 3105 a -2 3105 a
SDict begin 13 H.A end
 -2 3105 a -2 3105
a
SDict begin [/View [/XYZ H.V]/Dest (0:rtmama-php) cvn /DEST pdfmark
end
 -2 3105 a 396 3288 a Fk(Example)h(3-3.)e(R)n(OUTER-to-REQ)g
(\(rtmama.php\))-2 3388 y
SDict begin H.S end
 -2 3388 a -2 3388 a
SDict begin 11.7 H.A end
 -2 3388
a -2 3388 a
SDict begin [/View [/XYZ H.V]/Dest (0:1391) cvn /DEST pdfmark end
 -2 3388 a 396 3469 a Fg(<?php)396 3566 y(/)441
3579 y(*)441 3676 y(*)531 3663 y(Custom)44 b(routing)f(Router)h(to)h
(Mama)f(\(ROUTER)f(to)i(REQ\))441 3773 y(*)531 3760 y(@author)e(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>a)441
3870 y(*)486 3857 y(/)396 4051 y(define\("NBR_WORKERS",)e(10\);)396
4246 y(function)i(worker_thread\(\))e({)441 4343 y($context)i(=)g(new)h
(ZMQContext\(\);)441 4440 y($worker)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_REQ\);)441 4537 y
($worker->connect\("ipc://routing.ipc"\);)441 4731 y($total)j(=)h(0;)
441 4828 y(while\(true\))e({)486 4926 y(//)89 b(Tell)44
b(the)h(router)f(we're)g(ready)g(for)g(work)486 5023
y($worker->send\("ready"\);)p Black 3800 5569 a Fi(92)p
Black eop end
%%Page: 93 107
TeXDict begin 93 106 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.93) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1393) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 486 72 a Fg(//)89 b(Get)45 b(workload)e(from)h
(router,)g(until)g(finished)486 170 y($workload)f(=)i
($worker->recv\(\);)486 267 y(if\($workload)e(==)h('END'\))g({)531
364 y(printf)g(\("Processed:)e(\045d)j(tasks\045s",)e($total,)h
(PHP_EOL\);)531 461 y(break;)486 558 y(})486 655 y($total++;)486
850 y(//)89 b(Do)45 b(some)f(random)g(work)486 947 y
(usleep\(mt_rand\(1,)e(1000000\)\);)441 1044 y(})396
1141 y(})396 1335 y(for)j(\($worker_nbr)d(=)j(0;)g($worker_nbr)e(<)h
(NBR_WORKERS;)f($worker_nbr++\))g({)441 1432 y(if\(pcntl_fork\(\))f(==)
j(0\))f({)486 1530 y(worker_thread\(\);)486 1627 y(exit\(\);)441
1724 y(})396 1821 y(})396 2015 y($context)g(=)g(new)h(ZMQContext\(\);)
396 2112 y($client)f(=)h($context->getSocket\(ZMQ::SOCKET_ROUTE)o(R\);)
396 2209 y($client->bind\("ipc://routing.ipc"\);)396
2404 y(for)g(\($task_nbr)e(=)h(0;)h($task_nbr)e(<)i(NBR_WORKERS)2369
2417 y(*)2459 2404 y(10;)f($task_nbr++\))f({)441 2501
y(//)89 b(LRU)45 b(worker)f(is)g(next)g(waiting)g(in)g(queue)441
2598 y($address)g(=)g($client->recv\(\);)441 2695 y($empty)g(=)h
($client->recv\(\);)441 2792 y($read)f(=)h($client->recv\(\);)441
2987 y($client->send\($address,)c(ZMQ::MODE_SNDMORE\);)441
3084 y($client->send\("",)h(ZMQ::MODE_SNDMORE\);)441
3181 y($client->send\("This)g(is)i(the)h(workload"\);)396
3278 y(})396 3472 y(//)90 b(Now)44 b(ask)g(mamas)g(to)h(shut)f(down)g
(and)g(report)g(their)g(results)396 3569 y(for)h(\($task_nbr)e(=)h(0;)h
($task_nbr)e(<)i(NBR_WORKERS;)e($task_nbr++\))g({)441
3666 y(//)89 b(LRU)45 b(worker)f(is)g(next)g(waiting)g(in)g(queue)441
3764 y($address)g(=)g($client->recv\(\);)441 3861 y($empty)g(=)h
($client->recv\(\);)441 3958 y($read)f(=)h($client->recv\(\);)441
4152 y($client->send\($address,)c(ZMQ::MODE_SNDMORE\);)441
4249 y($client->send\("",)h(ZMQ::MODE_SNDMORE\);)441
4346 y($client->send\("END"\);)396 4444 y(})396 4638
y(sleep)i(\(1\);)627 b(//)90 b(Give)44 b(0MQ/2.0.x)f(time)h(to)h(flush)
f(output)-2 4815 y
SDict begin H.S end
 -2 4815 a -2 4815 a
SDict begin 13 H.A end
 -2 4815 a -2 4815
a
SDict begin [/View [/XYZ H.V]/Dest (0:1392) cvn /DEST pdfmark end
 -2 4815 a 396 4912 a Fj(F)o(or)20 b(this)h(e)o(xample)e(the)h(LR)m(U)
g(doesn')o(t)f(need)g(an)o(y)h(particular)f(data)h(structures)f(abo)o
(v)o(e)g(what)h(\330MQ)g(gi)n(v)o(es)g(us)396 5020 y(\(message)g
(queues\))f(because)g(we)i(don')o(t)d(need)i(to)g(synchronize)e(the)i
(w)o(ork)o(ers)g(with)g(an)o(ything.)e(A)j(more)e(realistic)p
Black 3800 5569 a Fi(93)p Black eop end
%%Page: 94 108
TeXDict begin 94 107 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.94) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fj(LR)m(U)21 b(algorithm)d(w)o(ould)i(ha)n
(v)o(e)f(to)i(collect)f(w)o(ork)o(ers)f(as)i(the)o(y)f(become)f(ready)
-5 b(,)18 b(into)i(a)h(queue,)e(and)g(the)h(use)h(this)g(queue)396
180 y(when)f(routing)e(client)j(requests.)e(W)-7 b(e')o(ll)22
b(do)d(this)i(in)f(a)h(later)f(e)o(xample.)396 454 y(T)-7
b(o)21 b(pro)o(v)o(e)d(that)i(the)g(LR)m(U)h(is)g(w)o(orking)e(as)i(e)o
(xpected,)d(the)i(REQs)h(print)f(the)g(total)g(tasks)h(the)o(y)f(each)f
(did.)h(Since)g(the)396 562 y(REQs)h(do)f(random)f(w)o(ork,)g(and)g
(we')l(re)h(not)g(load)g(balancing,)e(we)i(e)o(xpect)g(each)f(REQ)i(to)
g(do)e(approximately)f(the)396 670 y(same)j(amount)d(b)n(ut)j(with)f
(random)e(v)n(ariation.)h(And)h(that)g(is)h(indeed)e(what)h(we)h(see:)
-2 754 y
SDict begin H.S end
 -2 754 a -2 754 a
SDict begin 11.7 H.A end
 -2 754 a -2 754 a
SDict begin [/View [/XYZ H.V]/Dest (0:1394) cvn /DEST pdfmark end
 -2 754 a
396 850 a Fg(Processed:)43 b(8)i(tasks)396 948 y(Processed:)e(8)i
(tasks)396 1045 y(Processed:)e(11)i(tasks)396 1142 y(Processed:)e(7)i
(tasks)396 1239 y(Processed:)e(9)i(tasks)396 1336 y(Processed:)e(11)i
(tasks)396 1433 y(Processed:)e(14)i(tasks)396 1530 y(Processed:)e(11)i
(tasks)396 1627 y(Processed:)e(11)i(tasks)396 1725 y(Processed:)e(10)i
(tasks)-2 1892 y
SDict begin H.S end
 -2 1892 a -2 1892 a
SDict begin 13 H.A end
 -2 1892 a -2 1892
a
SDict begin [/View [/XYZ H.V]/Dest (0:1395) cvn /DEST pdfmark end
 -2 1892 a 396 1999 a Fj(Some)20 b(comments)f(on)h(this)h(code)-2
2000 y
SDict begin H.S end
 -2 2000 a -2 2000 a
SDict begin 13 H.A end
 -2 2000 a -2 2000 a
SDict begin [/View [/XYZ H.V]/Dest (0:1396) cvn /DEST pdfmark end
 -2 2000
a -2 2010 a
SDict begin H.S end
 -2 2010 a -2 2010 a
SDict begin 13 H.A end
 -2 2010 a -2 2010 a
SDict begin [/View [/XYZ H.V]/Dest (0:1397) cvn /DEST pdfmark end
 -2
2010 a Black 396 2169 a Fe(\225)p Black 479 2169 a
SDict begin H.S end
 479
2169 a 479 2169 a
SDict begin 13 H.A end
 479 2169 a 479 2169 a
SDict begin [/View [/XYZ H.V]/Dest (0:1398) cvn /DEST pdfmark end
 479 2169 a Fj(W)-7
b(e)22 b(don')o(t)c(need)i(an)o(y)f(settle)i(time,)f(since)h(the)f
(REQs)h(e)o(xplicitly)e(tell)i(the)f(R)m(OUTER)h(when)e(the)o(y)h(are)g
(ready)-5 b(.)-2 2187 y
SDict begin H.S end
 -2 2187 a -2 2187 a
SDict begin 13 H.A end
 -2 2187 a
-2 2187 a
SDict begin [/View [/XYZ H.V]/Dest (0:1399) cvn /DEST pdfmark end
 -2 2187 a Black 396 2318 a Fe(\225)p Black
479 2318 a
SDict begin H.S end
 479 2318 a 479 2318 a
SDict begin 13 H.A end
 479 2318 a 479 2318
a
SDict begin [/View [/XYZ H.V]/Dest (0:1400) cvn /DEST pdfmark end
 479 2318 a Fj(W)e(e')l(re)21 b(generating)d(our)h(o)n(wn)h
(identities)g(here,)f(as)i(printable)e(strings,)h(using)g(the)g
(zhelpers.h)f(s_set_id)h(function.)479 2426 y(That')-5
b(s)21 b(just)f(to)h(mak)o(e)e(our)h(life)g(a)h(little)g(simpler)-5
b(.)20 b(In)g(a)g(realistic)h(application)e(the)h(REQs)h(w)o(ould)e(be)
i(fully)479 2534 y(anon)o(ymous)d(and)h(then)h(you')l(d)e(call)1537
2534 y
SDict begin H.S end
 1537 2534 a 1537 2534 a
SDict begin 13 H.A end
 1537 2534 a 1537 2534
a
SDict begin [/View [/XYZ H.V]/Dest (0:1401) cvn /DEST pdfmark end
 1537 2534 a Fg(zmq_msg_recv\(\))g Fj(and)2326 2534
y
SDict begin H.S end
 2326 2534 a 2326 2534 a
SDict begin 13 H.A end
 2326 2534 a 2326 2534 a
SDict begin [/View [/XYZ H.V]/Dest (0:1402) cvn /DEST pdfmark end
 2326
2534 a Fg(zmq_msg_send\(\))g Fj(directly)i(instead)g(of)g(the)479
2642 y(zhelpers)777 2642 y
SDict begin H.S end
 777 2642 a 777 2642 a
SDict begin 13 H.A end
 777
2642 a 777 2642 a
SDict begin [/View [/XYZ H.V]/Dest (0:1403) cvn /DEST pdfmark end
 777 2642 a Fg(s_recv)f Fj(and)1207
2642 y
SDict begin H.S end
 1207 2642 a 1207 2642 a
SDict begin 13 H.A end
 1207 2642 a 1207 2642
a
SDict begin [/View [/XYZ H.V]/Dest (0:1404) cvn /DEST pdfmark end
 1207 2642 a Fg(s_send)h Fj(functions,)e(which)i(can)g(only)f(handle)g
(strings.)-2 2660 y
SDict begin H.S end
 -2 2660 a -2 2660 a
SDict begin 13 H.A end
 -2 2660 a -2
2660 a
SDict begin [/View [/XYZ H.V]/Dest (0:1405) cvn /DEST pdfmark end
 -2 2660 a Black 396 2791 a Fe(\225)p Black 479
2791 a
SDict begin H.S end
 479 2791 a 479 2791 a
SDict begin 13 H.A end
 479 2791 a 479 2791 a
SDict begin [/View [/XYZ H.V]/Dest (0:1406) cvn /DEST pdfmark end
 479
2791 a Fj(If)h(you)g(cop)o(y)f(and)h(paste)g(e)o(xample)f(code)g
(without)h(understanding)d(it,)k(you)e(deserv)o(e)g(what)h(you)f(get.)h
(It')-5 b(s)21 b(lik)o(e)479 2899 y(w)o(atching)f(Spiderman)e(leap)i
(of)n(f)g(the)g(roof)f(and)h(then)f(trying)g(that)i(yourself.)-2
3083 y
SDict begin H.S end
 -2 3083 a -2 3083 a
SDict begin 13 H.A end
 -2 3083 a -2 3083 a
SDict begin [/View [/XYZ H.V]/Dest (0:1407) cvn /DEST pdfmark end
 -2 3083
a 396 3173 a Fj(T)-7 b(o)21 b(route)e(to)h(a)h(REQ,)f(we)h(must)f
(create)g(a)h(REQ-friendly)d(en)m(v)o(elope)g(consisting)i(of)f(an)i
(address)e(plus)h(an)h(empty)396 3281 y(message)f(frame\()p
0 TeXcolorgray 921 3281 a
SDict begin H.S end
 921 3281 a Fj(Figure)e(3-8)1269
3281 y
SDict begin 13 H.L end
 1269 3281 a 1269 3281 a
SDict begin [/Subtype /Link/Dest (0:figure-33) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1269 3281 a Black -1 w
Fj(\).)-2 3299 y
SDict begin H.S end
 -2 3299 a -2 3299 a
SDict begin 13 H.A end
 -2 3299 a -2 3299
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-33) cvn /DEST pdfmark
end
 -2 3299 a 396 3483 a Fk(Figur)o(e)i(3-8.)f(Routing)h(En)m(v)o(elope)g
(f)n(or)f(REQ)-2 3582 y
SDict begin H.S end
 -2 3582 a -2 3582 a
SDict begin 13 H.A end
 -2 3582 a
-2 3582 a
SDict begin [/View [/XYZ H.V]/Dest (0:1411) cvn /DEST pdfmark end
 -2 3582 a 396 4541 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4541 a @beginspecial
0 @llx -110 @lly 385 @urx 0 @ury 3850 @rwi @setspecial
%%BeginDocument: images/fig33.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -110 385 0
%%HiResBoundingBox: 0.0 -110.0 385.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -27.100210189819336 moveto
89.10021209716797 -47.1002082824707 lineto
187.10020446777344 -47.1002082824707 lineto
187.10020446777344 -27.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -47.1002082824707 moveto
89.10021209716797 -67.10021209716797 lineto
117.10021209716797 -67.10021209716797 lineto
117.10021209716797 -47.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -67.10021209716797 moveto
89.10021209716797 -87.10021209716797 lineto
369.1002197265625 -87.10021209716797 lineto
369.1002197265625 -67.10021209716797 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -25.0 moveto
87.0 -45.0 lineto
185.0 -45.0 lineto
185.0 -25.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -25.0 moveto
87.0 -45.0 lineto
185.0 -45.0 lineto
185.0 -25.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -65.0 lineto
115.0 -65.0 lineto
115.0 -45.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -45.0 moveto
87.0 -65.0 lineto
115.0 -65.0 lineto
115.0 -45.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -65.0 moveto
87.0 -85.0 lineto
367.0 -85.0 lineto
367.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -65.0 moveto
87.0 -85.0 lineto
367.0 -85.0 lineto
367.0 -65.0 lineto
closepath
stroke
newpath
143.0 -55.0 moveto
189.0 -55.0 lineto
stroke
newpath
147.0 -50.0 moveto
140.0 -55.0 lineto
147.0 -60.0 lineto
closepath
fill
/Helvetica findfont
10 scalefont setfont
15.0 -39.0 moveto
(Frame 1) show
99.0 -39.0 moveto
(Address) show
15.0 -59.0 moveto
(Frame 2) show
199.0 -59.0 moveto
(Empty message frame) show
15.0 -79.0 moveto
(Frame 3) show
99.0 -79.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4541 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4541 a -2 4624 a
SDict begin H.S end
 -2 4624
a -2 4624 a
SDict begin 13 H.A end
 -2 4624 a -2 4624 a
SDict begin [/View [/XYZ H.V]/Dest (0:1414) cvn /DEST pdfmark end
 -2 4624 a Black 3800
5569 a Fi(94)p Black eop end
%%Page: 95 109
TeXDict begin 95 108 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.95) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1431) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 94 a Fh(3.5.)39 b(Ad)o(dress-based)d
(Routing)1896 94 y
SDict begin H.S end
 1896 94 a 1896 94 a
SDict begin 22.464 H.A end
 1896 94 a 1896
94 a
SDict begin [/View [/XYZ H.V]/Dest (8.35.1) cvn /DEST pdfmark end
 1896 94 a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2 292 a -2
292 a
SDict begin [/View [/XYZ H.V]/Dest (0:1416) cvn /DEST pdfmark end
 -2 292 a 396 368 a Fj(In)20 b(a)h(classic)g(request-reply)d
(pattern)h(a)i(R)m(OUTER)f(w)o(ouldn')o(t)e(talk)j(to)f(a)h(REP)g(sock)
o(et)f(at)g(all,)h(b)n(ut)f(rather)f(w)o(ould)h(get)g(a)396
476 y(DEALER)g(to)h(do)f(the)g(job)g(for)f(it.)i(It')-5
b(s)21 b(w)o(orth)e(remembering)f(with)i(\330MQ)h(that)f(the)g(classic)
h(patterns)f(are)g(the)g(ones)396 584 y(that)h(w)o(ork)e(best,)h(that)h
(the)f(beaten)f(path)h(is)h(there)f(for)f(a)i(reason,)e(and)h(that)g
(when)g(we)g(go)g(of)n(f-road)e(we)i(tak)o(e)h(the)f(risk)g(of)396
692 y(f)o(alling)f(of)n(f)g(clif)n(fs)h(and)f(getting)g(eaten)g(by)h
(zombies.)e(Ha)n(ving)h(said)h(that,)g(let')-5 b(s)20
b(plug)f(a)h(R)m(OUTER)g(into)g(a)g(REP)g(and)f(see)396
800 y(what)h(the)h(heck)e(emer)o(ges.)-2 984 y
SDict begin H.S end
 -2 984
a -2 984 a
SDict begin 13 H.A end
 -2 984 a -2 984 a
SDict begin [/View [/XYZ H.V]/Dest (0:1417) cvn /DEST pdfmark end
 -2 984 a 396 1074 a Fj(The)h(special)g
(thing)g(about)f(REPs)i(is)h(actually)d(tw)o(o)i(things:)-2
1092 y
SDict begin H.S end
 -2 1092 a -2 1092 a
SDict begin 13 H.A end
 -2 1092 a -2 1092 a
SDict begin [/View [/XYZ H.V]/Dest (0:1418) cvn /DEST pdfmark end
 -2 1092
a -2 1102 a
SDict begin H.S end
 -2 1102 a -2 1102 a
SDict begin 13 H.A end
 -2 1102 a -2 1102 a
SDict begin [/View [/XYZ H.V]/Dest (0:1419) cvn /DEST pdfmark end
 -2
1102 a Black 396 1244 a Fe(\225)p Black 479 1244 a
SDict begin H.S end
 479
1244 a 479 1244 a
SDict begin 13 H.A end
 479 1244 a 479 1244 a
SDict begin [/View [/XYZ H.V]/Dest (0:1420) cvn /DEST pdfmark end
 479 1244 a Fj(One,)f(the)o(y)g
(are)g(strictly)g(lockstep)g(request-reply)-5 b(.)-2
1262 y
SDict begin H.S end
 -2 1262 a -2 1262 a
SDict begin 13 H.A end
 -2 1262 a -2 1262 a
SDict begin [/View [/XYZ H.V]/Dest (0:1421) cvn /DEST pdfmark end
 -2 1262
a Black 396 1393 a Fe(\225)p Black 479 1393 a
SDict begin H.S end
 479 1393
a 479 1393 a
SDict begin 13 H.A end
 479 1393 a 479 1393 a
SDict begin [/View [/XYZ H.V]/Dest (0:1422) cvn /DEST pdfmark end
 479 1393 a Fj(T)e(w)o(o,)21
b(the)o(y)e(accept)h(an)g(en)m(v)o(elope)e(stack)i(of)g(an)o(y)f(size)i
(and)f(will)h(return)e(that)h(intact.)-2 1577 y
SDict begin H.S end
 -2 1577
a -2 1577 a
SDict begin 13 H.A end
 -2 1577 a -2 1577 a
SDict begin [/View [/XYZ H.V]/Dest (0:1423) cvn /DEST pdfmark end
 -2 1577 a 396 1667 a
Fj(In)g(the)g(normal)f(request-reply)f(pattern,)h(REPs)i(are)g(anon)o
(ymous)c(and)j(replaceable,)e(b)n(ut)i(we')l(re)g(learning)f(about)396
1775 y(custom)h(routing.)e(So,)i(in)h(our)e(use-case)h(we)h(ha)n(v)o(e)
e(reason)h(to)g(send)g(a)h(request)e(to)h(REP)h(A)g(rather)f(than)f
(REP)i(B.)g(This)396 1883 y(is)g(essential)g(if)g(you)e(w)o(ant)h(to)h
(k)o(eep)e(some)h(kind)g(of)f(a)i(con)m(v)o(ersation)d(going)g(between)
i(you,)f(at)i(one)e(end)h(of)g(a)g(lar)o(ge)396 1991
y(netw)o(ork,)f(and)h(a)g(REP)h(sitting)g(some)n(where)d(f)o(ar)j(a)o
(w)o(ay)-5 b(.)-2 2175 y
SDict begin H.S end
 -2 2175 a -2 2175 a
SDict begin 13 H.A end
 -2 2175
a -2 2175 a
SDict begin [/View [/XYZ H.V]/Dest (0:1424) cvn /DEST pdfmark end
 -2 2175 a 396 2265 a Fj(A)21 b(core)f(philosophy)d(of)j
(\330MQ)g(is)h(that)g(the)f(edges)g(are)g(smart)g(and)g(man)o(y)-5
b(,)18 b(and)i(the)g(middle)f(is)i(v)n(ast)g(and)f(dumb)m(.)e(This)396
2373 y(does)i(mean)g(the)g(edges)g(can)g(address)g(each)f(other)m(,)g
(and)h(this)h(also)f(means)g(we)g(w)o(ant)h(to)f(kno)n(w)f(ho)n(w)h(to)
g(reach)g(a)g(gi)n(v)o(en)396 2481 y(REP)-9 b(.)21 b(Doing)e(routing)g
(across)h(multiple)g(hops)f(is)i(something)e(we')o(ll)h(look)g(at)h
(later)f(b)n(ut)g(for)g(no)n(w)f(we')o(ll)i(look)e(just)i(at)396
2589 y(the)f(\002nal)h(step:)f(a)h(R)m(OUTER)g(talking)e(to)h(a)h
(speci\002c)f(REP\()p 0 TeXcolorgray 2120 2589 a
SDict begin H.S end
 2120
2589 a Fj(Figure)g(3-9)2470 2589 y
SDict begin 13 H.L end
 2470 2589 a 2470 2589
a
SDict begin [/Subtype /Link/Dest (0:figure-34) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2470 2589 a Black -2 w Fj(\).)-2 2607 y
SDict begin H.S end
 -2 2607 a -2
2607 a
SDict begin 13 H.A end
 -2 2607 a -2 2607 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-34) cvn /DEST pdfmark
end
 -2 2607 a Black 3800 5569
a Fi(95)p Black eop end
%%Page: 96 110
TeXDict begin 96 109 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.96) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-9.)f(R)n(OUTER-to-REP)g
(Custom)h(Routing)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1428) cvn /DEST pdfmark end
 -2 172 a 396 3031 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3031 a @beginspecial
0 @llx -338 @lly 423 @urx 0 @ury 4230 @rwi @setspecial
%%BeginDocument: images/fig34.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -338 423 0
%%HiResBoundingBox: 0.0 -338.0 423.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
87.70027160644531 -34.70027160644531 moveto
87.70027160644531 -84.70027160644531 lineto
213.7002716064453 -84.70027160644531 lineto
213.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
87.70027160644531 -87.70027160644531 moveto
87.70027160644531 -106.70027160644531 lineto
87.70027160644531 -110.70027160644531 89.36693827311198 -112.70027160644531 92.70027160644531 -112.70027160644531 curveto
209.7002716064453 -112.70027160644531 lineto
209.7002716064453 -112.70027160644531 lineto
212.36693827311197 -112.70027160644531 213.7002716064453 -110.70027160644531 213.7002716064453 -106.70027160644531 curveto
213.7002716064453 -88.50027465820312 lineto
213.7002716064453 -87.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
29.70026969909668 -216.7002716064453 moveto
26.366936365763348 -216.7002716064453 24.70026969909668 -219.03360493977866 24.70026969909668 -223.7002716064453 curveto
24.70026969909668 -253.7002716064453 lineto
132.7002716064453 -253.7002716064453 lineto
132.7002716064453 -223.7002716064453 lineto
132.7002716064453 -219.03360493977866 131.36693827311197 -216.7002716064453 128.7002716064453 -216.7002716064453 curveto
29.70026969909668 -216.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -256.70025634765625 moveto
24.70026969909668 -307.70025634765625 lineto
132.7002716064453 -307.70025634765625 lineto
132.7002716064453 -256.70025634765625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
173.7002716064453 -216.7002716064453 moveto
170.36693827311197 -216.7002716064453 168.7002716064453 -219.03360493977866 168.7002716064453 -223.7002716064453 curveto
168.7002716064453 -253.7002716064453 lineto
276.70025634765625 -253.7002716064453 lineto
276.70025634765625 -223.7002716064453 lineto
276.70025634765625 -219.03360493977866 275.36692301432294 -216.7002716064453 272.70025634765625 -216.7002716064453 curveto
173.7002716064453 -216.7002716064453 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
168.7002716064453 -256.70025634765625 moveto
168.7002716064453 -307.70025634765625 lineto
276.70025634765625 -307.70025634765625 lineto
276.70025634765625 -256.70025634765625 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
85.0 -32.0 moveto
85.0 -82.0 lineto
211.0 -82.0 lineto
211.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
85.0 -32.0 moveto
85.0 -82.0 lineto
211.0 -82.0 lineto
211.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
85.0 -85.0 moveto
85.0 -104.0 lineto
85.0 -108.0 86.66666666666667 -110.0 90.0 -110.0 curveto
207.0 -110.0 lineto
207.0 -110.0 lineto
209.66666666666666 -110.0 211.0 -108.0 211.0 -104.0 curveto
211.0 -85.80000305175781 lineto
211.0 -85.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
85.0 -85.0 moveto
85.0 -104.0 lineto
85.0 -108.0 86.66666666666667 -110.0 90.0 -110.0 curveto
207.0 -110.0 lineto
207.0 -110.0 lineto
209.66666666666666 -110.0 211.0 -108.0 211.0 -104.0 curveto
211.0 -85.80000305175781 lineto
211.0 -85.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -214.0 moveto
23.666666666666668 -214.0 22.0 -216.33333333333334 22.0 -221.0 curveto
22.0 -251.0 lineto
130.0 -251.0 lineto
130.0 -221.0 lineto
130.0 -216.33333333333334 128.66666666666666 -214.0 126.0 -214.0 curveto
27.0 -214.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -214.0 moveto
23.666666666666668 -214.0 22.0 -216.33333333333334 22.0 -221.0 curveto
22.0 -251.0 lineto
130.0 -251.0 lineto
130.0 -221.0 lineto
130.0 -216.33333333333334 128.66666666666666 -214.0 126.0 -214.0 curveto
27.0 -214.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -254.0 moveto
22.0 -305.0 lineto
130.0 -305.0 lineto
130.0 -254.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
22.0 -254.0 moveto
22.0 -305.0 lineto
130.0 -305.0 lineto
130.0 -254.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
171.0 -214.0 moveto
167.66666666666666 -214.0 166.0 -216.33333333333334 166.0 -221.0 curveto
166.0 -251.0 lineto
274.0 -251.0 lineto
274.0 -221.0 lineto
274.0 -216.33333333333334 272.6666666666667 -214.0 270.0 -214.0 curveto
171.0 -214.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
171.0 -214.0 moveto
167.66666666666666 -214.0 166.0 -216.33333333333334 166.0 -221.0 curveto
166.0 -251.0 lineto
274.0 -251.0 lineto
274.0 -221.0 lineto
274.0 -216.33333333333334 272.6666666666667 -214.0 270.0 -214.0 curveto
171.0 -214.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
166.0 -254.0 moveto
166.0 -305.0 lineto
274.0 -305.0 lineto
274.0 -254.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
166.0 -254.0 moveto
166.0 -305.0 lineto
274.0 -305.0 lineto
274.0 -254.0 lineto
closepath
stroke
newpath
148.0 -117.0 moveto
144.0 -130.0 lineto
153.0 -130.0 lineto
closepath
fill
newpath
72.0 -195.0 moveto
76.0 -208.0 lineto
81.0 -195.0 lineto
closepath
fill
newpath
216.0 -195.0 moveto
220.0 -208.0 lineto
225.0 -195.0 lineto
closepath
fill
newpath
148.0 -123.0 moveto
148.0 -162.0 lineto
stroke
newpath
76.0 -201.0 moveto
76.0 -162.0 lineto
148.0 -162.0 lineto
stroke
newpath
220.0 -201.0 moveto
220.0 -162.0 lineto
148.0 -162.0 lineto
stroke
/Helvetica findfont
14 scalefont setfont
122.0 -64.0 moveto
(Client) show
253.0 -64.0 moveto
(Send to "A" or "B") show
119.0 -102.0 moveto
(ROUTER) show
63.0 -232.0 moveto
(REP) show
64.0 -246.0 moveto
("A") show
207.0 -232.0 moveto
(REP) show
208.0 -246.0 moveto
("B") show
46.0 -285.0 moveto
(Worker) show
199.0 -285.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3031 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3031 a 274 x Fj(This)h(e)o(xample)d(sho)n
(ws)j(a)f(v)o(ery)f(speci\002c)i(chain)e(of)h(e)n(v)o(ents:)-2
3322 y
SDict begin H.S end
 -2 3322 a -2 3322 a
SDict begin 13 H.A end
 -2 3322 a -2 3322 a
SDict begin [/View [/XYZ H.V]/Dest (0:1432) cvn /DEST pdfmark end
 -2 3322
a -2 3332 a
SDict begin H.S end
 -2 3332 a -2 3332 a
SDict begin 13 H.A end
 -2 3332 a -2 3332 a
SDict begin [/View [/XYZ H.V]/Dest (0:1433) cvn /DEST pdfmark end
 -2
3332 a Black 396 3475 a Fe(\225)p Black 479 3475 a
SDict begin H.S end
 479
3475 a 479 3475 a
SDict begin 13 H.A end
 479 3475 a 479 3475 a
SDict begin [/View [/XYZ H.V]/Dest (0:1434) cvn /DEST pdfmark end
 479 3475 a Fj(The)g(client)g
(has)h(a)f(message)g(that)h(it)g(e)o(xpects)e(to)h(route)g(back)f
(\(via)h(another)f(R)m(OUTER\))h(to)g(some)g(node.)f(The)479
3583 y(message)h(has)h(tw)o(o)f(addresses)g(\(a)g(stack\),)g(an)g
(empty)g(part,)f(and)h(a)g(body)-5 b(.)-2 3601 y
SDict begin H.S end
 -2 3601
a -2 3601 a
SDict begin 13 H.A end
 -2 3601 a -2 3601 a
SDict begin [/View [/XYZ H.V]/Dest (0:1435) cvn /DEST pdfmark end
 -2 3601 a Black 396 3732
a Fe(\225)p Black 479 3732 a
SDict begin H.S end
 479 3732 a 479 3732 a
SDict begin 13 H.A end
 479
3732 a 479 3732 a
SDict begin [/View [/XYZ H.V]/Dest (0:1436) cvn /DEST pdfmark end
 479 3732 a Fj(The)20 b(client)g(passes)h(that)g(to)f
(the)g(R)m(OUTER)h(b)n(ut)f(speci\002es)g(a)h(REP)g(address)f(\002rst.)
-2 3750 y
SDict begin H.S end
 -2 3750 a -2 3750 a
SDict begin 13 H.A end
 -2 3750 a -2 3750 a
SDict begin [/View [/XYZ H.V]/Dest (0:1437) cvn /DEST pdfmark end
 -2
3750 a Black 396 3882 a Fe(\225)p Black 479 3882 a
SDict begin H.S end
 479
3882 a 479 3882 a
SDict begin 13 H.A end
 479 3882 a 479 3882 a
SDict begin [/View [/XYZ H.V]/Dest (0:1438) cvn /DEST pdfmark end
 479 3882 a Fj(The)g(R)m(OUTER)h
(remo)o(v)o(es)d(the)i(REP)h(address,)f(uses)h(that)f(to)g(decide)g
(which)f(REP)i(to)g(send)f(the)g(message)g(to.)-2 3899
y
SDict begin H.S end
 -2 3899 a -2 3899 a
SDict begin 13 H.A end
 -2 3899 a -2 3899 a
SDict begin [/View [/XYZ H.V]/Dest (0:1439) cvn /DEST pdfmark end
 -2 3899 a Black
396 4031 a Fe(\225)p Black 479 4031 a
SDict begin H.S end
 479 4031 a 479
4031 a
SDict begin 13 H.A end
 479 4031 a 479 4031 a
SDict begin [/View [/XYZ H.V]/Dest (0:1440) cvn /DEST pdfmark end
 479 4031 a Fj(The)g(REP)h(recei)n(v)o(es)f
(the)g(addresses,)f(empty)h(part,)f(and)h(body)-5 b(.)-2
4049 y
SDict begin H.S end
 -2 4049 a -2 4049 a
SDict begin 13 H.A end
 -2 4049 a -2 4049 a
SDict begin [/View [/XYZ H.V]/Dest (0:1441) cvn /DEST pdfmark end
 -2 4049
a Black 396 4180 a Fe(\225)p Black 479 4180 a
SDict begin H.S end
 479 4180
a 479 4180 a
SDict begin 13 H.A end
 479 4180 a 479 4180 a
SDict begin [/View [/XYZ H.V]/Dest (0:1442) cvn /DEST pdfmark end
 479 4180 a Fj(It)21
b(remo)o(v)o(es)d(the)j(addresses,)e(sa)n(v)o(es)i(them,)e(and)h
(passes)h(the)f(body)f(to)h(the)g(w)o(ork)o(er)-5 b(.)-2
4198 y
SDict begin H.S end
 -2 4198 a -2 4198 a
SDict begin 13 H.A end
 -2 4198 a -2 4198 a
SDict begin [/View [/XYZ H.V]/Dest (0:1443) cvn /DEST pdfmark end
 -2 4198
a Black 396 4330 a Fe(\225)p Black 479 4330 a
SDict begin H.S end
 479 4330
a 479 4330 a
SDict begin 13 H.A end
 479 4330 a 479 4330 a
SDict begin [/View [/XYZ H.V]/Dest (0:1444) cvn /DEST pdfmark end
 479 4330 a Fj(The)20
b(w)o(ork)o(er)f(sends)i(a)f(reply)g(back)f(to)h(the)h(REP)-9
b(.)-2 4348 y
SDict begin H.S end
 -2 4348 a -2 4348 a
SDict begin 13 H.A end
 -2 4348 a -2 4348 a
SDict begin [/View [/XYZ H.V]/Dest (0:1445) cvn /DEST pdfmark end

-2 4348 a Black 396 4479 a Fe(\225)p Black 479 4479 a
SDict begin H.S end

479 4479 a 479 4479 a
SDict begin 13 H.A end
 479 4479 a 479 4479 a
SDict begin [/View [/XYZ H.V]/Dest (0:1446) cvn /DEST pdfmark end
 479 4479
a Fj(The)20 b(REP)h(recreates)f(the)g(en)m(v)o(elope)e(stack)i(and)g
(sends)g(that)h(back)e(with)h(the)h(w)o(ork)o(er')-5
b(s)19 b(reply)h(to)g(the)g(R)m(OUTER.)-2 4497 y
SDict begin H.S end
 -2 4497
a -2 4497 a
SDict begin 13 H.A end
 -2 4497 a -2 4497 a
SDict begin [/View [/XYZ H.V]/Dest (0:1447) cvn /DEST pdfmark end
 -2 4497 a Black 396 4629
a Fe(\225)p Black 479 4629 a
SDict begin H.S end
 479 4629 a 479 4629 a
SDict begin 13 H.A end
 479
4629 a 479 4629 a
SDict begin [/View [/XYZ H.V]/Dest (0:1448) cvn /DEST pdfmark end
 479 4629 a Fj(The)g(R)m(OUTER)h(prepends)d(the)i
(REP')-5 b(s)22 b(address)d(and)h(pro)o(vides)f(that)h(to)g(the)g
(client)h(along)e(with)h(the)g(rest)h(of)f(the)479 4737
y(address)g(stack,)g(empty)f(part,)h(and)g(the)g(body)-5
b(.)-2 4921 y
SDict begin H.S end
 -2 4921 a -2 4921 a
SDict begin 13 H.A end
 -2 4921 a -2 4921 a
SDict begin [/View [/XYZ H.V]/Dest (0:1449) cvn /DEST pdfmark end

-2 4921 a 396 5011 a Fj(It')g(s)21 b(comple)o(x)e(b)n(ut)h(w)o(orth)f
(w)o(orking)g(through)f(until)i(you)f(understand)f(it.)j(Just)g
(remember)d(a)j(REP)g(is)g(garbage)d(in,)396 5119 y(garbage)g(out.)-2
5137 y
SDict begin H.S end
 -2 5137 a -2 5137 a
SDict begin 13 H.A end
 -2 5137 a -2 5137 a
SDict begin [/View [/XYZ H.V]/Dest (0:rtpapa-php) cvn /DEST pdfmark
end
 -2 5137
a Black 3798 5569 a Fi(96)p Black eop end
%%Page: 97 111
TeXDict begin 97 110 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.97) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Example)21 b(3-4.)e(R)n(OUTER-to-REP)g
(\(rtpapa.php\))-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 11.7 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1452) cvn /DEST pdfmark end
 -2 172 a 396 253 a Fg(<?php)396 350 y(/)441 363
y(*)441 460 y(*)531 447 y(Custom)44 b(routing)f(Router)h(to)h(Papa)f
(\(ROUTER)f(to)i(REP\))441 557 y(*)531 544 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>a)441 654 y(*)486
641 y(/)396 738 y(include)g("zhelpers.php";)396 933 y(//)90
b(We)44 b(will)g(do)h(this)f(all)g(in)h(one)f(thread)g(to)g(emphasize)g
(the)g(sequence)396 1030 y(//)90 b(of)44 b(events...)396
1127 y($context)g(=)g(new)h(ZMQContext\(\);)396 1224
y($client)f(=)h(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_ROUTER\);)396
1321 y($client->bind\("inproc://routing"\);)396 1515
y($worker)i(=)h(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_REP\);)396
1613 y($worker->setSockOpt\(ZMQ::SOCKOPT_IDENTITY)o(,)d("A"\);)396
1710 y($worker->connect\("inproc://routing"\);)396 1904
y(//)90 b(Send)44 b(papa)g(address,)f(address)h(stack,)g(empty)g(part,)
g(and)g(request)396 2001 y($client->send\("A",)e(ZMQ::MODE_SNDMORE\);)
396 2098 y($client->send\("address)f(3",)k(ZMQ::MODE_SNDMORE\);)396
2195 y($client->send\("address)c(2",)k(ZMQ::MODE_SNDMORE\);)396
2292 y($client->send\("address)c(1",)k(ZMQ::MODE_SNDMORE\);)396
2390 y($client->send\("",)d(ZMQ::MODE_SNDMORE\);)396
2487 y($client->send\("This)g(is)i(the)h(workload"\);)396
2681 y(//)90 b(Worker)43 b(should)h(get)h(just)f(the)g(workload)396
2778 y(s_dump\($worker\);)396 2972 y(//)90 b(We)44 b(don't)g(play)g
(with)g(envelopes)g(in)g(the)h(worker)396 3070 y($worker->send\("This)d
(is)i(the)h(reply"\);)396 3264 y(//)90 b(Now)44 b(dump)g(what)g(we)h
(got)f(off)g(the)h(ROUTER)f(socket...)396 3361 y(s_dump\($client\);)-2
3539 y
SDict begin H.S end
 -2 3539 a -2 3539 a
SDict begin 13 H.A end
 -2 3539 a -2 3539 a
SDict begin [/View [/XYZ H.V]/Dest (0:1453) cvn /DEST pdfmark end
 -2 3539
a 396 3635 a Fj(Run)20 b(this)h(program)d(and)i(it)h(should)e(sho)n(w)h
(you)f(this:)-2 3736 y
SDict begin H.S end
 -2 3736 a -2 3736 a
SDict begin 11.7 H.A end
 -2 3736 a
-2 3736 a
SDict begin [/View [/XYZ H.V]/Dest (0:1454) cvn /DEST pdfmark end
 -2 3736 a 396 3815 a Fg
(----------------------------------------)396 3912 y([020])44
b(This)g(is)h(the)f(workload)396 4009 y
(----------------------------------------)396 4107 y([001])g(A)396
4204 y([009])g(address)g(3)396 4301 y([009])g(address)g(2)396
4398 y([009])g(address)g(1)396 4495 y([000])396 4592
y([017])g(This)g(is)h(the)f(reply)-2 4770 y
SDict begin H.S end
 -2 4770 a
-2 4770 a
SDict begin 13 H.A end
 -2 4770 a -2 4770 a
SDict begin [/View [/XYZ H.V]/Dest (0:1455) cvn /DEST pdfmark end
 -2 4770 a 396 4866 a Fj(Some)20
b(comments)f(on)h(this)h(code:)-2 4867 y
SDict begin H.S end
 -2 4867 a -2
4867 a
SDict begin 13 H.A end
 -2 4867 a -2 4867 a
SDict begin [/View [/XYZ H.V]/Dest (0:1456) cvn /DEST pdfmark end
 -2 4867 a -2 4877 a
SDict begin H.S end
 -2 4877
a -2 4877 a
SDict begin 13 H.A end
 -2 4877 a -2 4877 a
SDict begin [/View [/XYZ H.V]/Dest (0:1457) cvn /DEST pdfmark end
 -2 4877 a Black 396 5036
a Fe(\225)p Black 479 5036 a
SDict begin H.S end
 479 5036 a 479 5036 a
SDict begin 13 H.A end
 479
5036 a 479 5036 a
SDict begin [/View [/XYZ H.V]/Dest (0:1458) cvn /DEST pdfmark end
 479 5036 a Fj(In)f(reality)g(we')l(d)g(ha)n(v)o(e)f
(the)h(REP)h(and)f(R)m(OUTER)h(in)f(separate)g(nodes.)f(This)h(e)o
(xample)f(does)h(it)h(all)g(in)f(one)g(thread)479 5144
y(because)g(it)h(mak)o(es)f(the)g(sequence)f(of)h(e)n(v)o(ents)f
(really)h(clear)-5 b(.)-2 5162 y
SDict begin H.S end
 -2 5162 a -2 5162 a
SDict begin 13 H.A end

-2 5162 a -2 5162 a
SDict begin [/View [/XYZ H.V]/Dest (0:1459) cvn /DEST pdfmark end
 -2 5162 a Black 3797 5569 a Fi(97)p
Black eop end
%%Page: 98 112
TeXDict begin 98 111 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.98) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1490) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1460) cvn /DEST pdfmark end
 479 72 a
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1461) cvn /DEST pdfmark end
 479 72 a
Fg(zmq_connect\(\))19 b Fj(doesn')o(t)g(happen)f(instantly)-5
b(.)19 b(When)h(the)g(REP)h(sock)o(et)f(connects)g(to)g(the)g(R)m
(OUTER,)h(that)f(tak)o(es)479 180 y(a)h(certain)f(time)g(and)g(happens)
e(in)j(the)f(background.)c(In)k(a)h(realistic)g(application)d(the)i(R)m
(OUTER)h(w)o(ouldn')o(t)d(e)n(v)o(en)479 288 y(kno)n(w)h(the)i(REP)g(e)
o(xisted)e(until)h(there)g(had)g(been)f(some)h(pre)n(vious)f(dialog.)g
(In)h(our)f(to)o(y)h(e)o(xample)f(we')o(ll)i(just)3639
288 y
SDict begin H.S end
 3639 288 a 3639 288 a
SDict begin 13 H.A end
 3639 288 a 3639 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:1462) cvn /DEST pdfmark end
 3639
288 a Fg(sleep)479 396 y(\(1\);)f Fj(to)h(mak)o(e)e(sure)i(the)f
(connection')-5 b(s)18 b(done.)h(If)h(you)f(remo)o(v)o(e)g(the)h
(sleep,)g(the)g(REP)h(sock)o(et)f(w)o(on')o(t)f(get)i(the)479
504 y(message.)f(\(T)m(ry)f(it.\))-2 522 y
SDict begin H.S end
 -2 522 a -2
522 a
SDict begin 13 H.A end
 -2 522 a -2 522 a
SDict begin [/View [/XYZ H.V]/Dest (0:1463) cvn /DEST pdfmark end
 -2 522 a Black 396 654 a Fe(\225)p
Black 479 654 a
SDict begin H.S end
 479 654 a 479 654 a
SDict begin 13 H.A end
 479 654 a 479 654
a
SDict begin [/View [/XYZ H.V]/Dest (0:1464) cvn /DEST pdfmark end
 479 654 a Fj(W)-7 b(e')l(re)21 b(routing)d(using)i(the)g(REP')-5
b(s)22 b(identity)-5 b(.)18 b(Just)j(to)g(con)m(vince)d(yourself)h
(this)h(really)g(is)h(happening,)d(try)i(sending)479
762 y(to)h(a)f(wrong)f(address,)h(lik)o(e)g("B".)h(The)f(REP)h(w)o(on')
o(t)e(get)h(the)g(message.)-2 780 y
SDict begin H.S end
 -2 780 a -2 780 a
SDict begin 13 H.A end

-2 780 a -2 780 a
SDict begin [/View [/XYZ H.V]/Dest (0:1465) cvn /DEST pdfmark end
 -2 780 a Black 396 911 a Fe(\225)p
Black 479 911 a
SDict begin H.S end
 479 911 a 479 911 a
SDict begin 13 H.A end
 479 911 a 479 911
a
SDict begin [/View [/XYZ H.V]/Dest (0:1466) cvn /DEST pdfmark end
 479 911 a Fj(The)g(s_dump)f(and)g(other)h(utility)g(functions)f(\(in)
h(the)g(C)h(code\))e(come)h(from)f(the)h(zhelpers.h)f(header)g(\002le.)
h(It)479 1019 y(becomes)g(clear)g(that)g(we)g(do)g(the)g(same)h(w)o
(ork)e(o)o(v)o(er)g(and)h(o)o(v)o(er)f(on)g(sock)o(ets,)h(and)g(there)g
(are)g(interesting)f(layers)h(we)479 1127 y(can)g(b)n(uild)g(on)g(top)g
(of)g(the)g(\330MQ)g(API.)h(W)-7 b(e')o(ll)21 b(come)e(back)h(to)g
(this)h(later)f(when)g(we)g(mak)o(e)g(a)h(real)f(application)479
1235 y(rather)g(than)f(these)i(to)o(y)f(e)o(xamples.)-2
1419 y
SDict begin H.S end
 -2 1419 a -2 1419 a
SDict begin 13 H.A end
 -2 1419 a -2 1419 a
SDict begin [/View [/XYZ H.V]/Dest (0:1467) cvn /DEST pdfmark end
 -2 1419
a 396 1509 a Fj(T)-7 b(o)21 b(route)e(to)h(a)h(REP)-9
b(,)20 b(we)h(must)f(create)g(a)h(REP-friendly)d(en)m(v)o(elope\()p
0 TeXcolorgray 2387 1509 a
SDict begin H.S end
 2387 1509 a Fj(Figure)f(3-10)2776
1509 y
SDict begin 13 H.L end
 2776 1509 a 2776 1509 a
SDict begin [/Subtype /Link/Dest (0:figure-35) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2776 1509 a Black -2 w
Fj(\).)-2 1527 y
SDict begin H.S end
 -2 1527 a -2 1527 a
SDict begin 13 H.A end
 -2 1527 a -2 1527
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-35) cvn /DEST pdfmark
end
 -2 1527 a 396 1710 a Fk(Figur)o(e)j(3-10.)e(Routing)i(En)m(v)o(elope)
g(f)n(or)g(REP)-2 1810 y
SDict begin H.S end
 -2 1810 a -2 1810 a
SDict begin 13 H.A end
 -2 1810
a -2 1810 a
SDict begin [/View [/XYZ H.V]/Dest (0:1471) cvn /DEST pdfmark end
 -2 1810 a 396 2676 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2676 a @beginspecial
0 @llx -99 @lly 427 @urx 0 @ury 4270 @rwi @setspecial
%%BeginDocument: images/fig35.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -99 427 0
%%HiResBoundingBox: 0.0 -99.0 427.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -24.100210189819336 moveto
89.10021209716797 -42.1002082824707 lineto
187.10020446777344 -42.1002082824707 lineto
187.10020446777344 -24.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -42.1002082824707 moveto
89.10021209716797 -60.1002082824707 lineto
117.10021209716797 -60.1002082824707 lineto
117.10021209716797 -42.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -60.1002082824707 moveto
89.10021209716797 -78.10021209716797 lineto
369.1002197265625 -78.10021209716797 lineto
369.1002197265625 -60.1002082824707 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -22.0 moveto
87.0 -40.0 lineto
185.0 -40.0 lineto
185.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -22.0 moveto
87.0 -40.0 lineto
185.0 -40.0 lineto
185.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -40.0 moveto
87.0 -58.0 lineto
115.0 -58.0 lineto
115.0 -40.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -40.0 moveto
87.0 -58.0 lineto
115.0 -58.0 lineto
115.0 -40.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -58.0 moveto
87.0 -76.0 lineto
367.0 -76.0 lineto
367.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
87.0 -58.0 moveto
87.0 -76.0 lineto
367.0 -76.0 lineto
367.0 -58.0 lineto
closepath
stroke
newpath
206.0 -31.0 moveto
231.0 -31.0 lineto
stroke
newpath
143.0 -49.0 moveto
189.0 -49.0 lineto
stroke
newpath
210.0 -27.0 moveto
203.0 -31.0 lineto
210.0 -36.0 lineto
closepath
fill
newpath
147.0 -45.0 moveto
140.0 -49.0 lineto
147.0 -54.0 lineto
closepath
fill
/Helvetica findfont
9 scalefont setfont
18.0 -35.0 moveto
(Frame 1) show
103.0 -35.0 moveto
(Address) show
258.0 -35.0 moveto
(Zero or more of these) show
18.0 -53.0 moveto
(Frame 2) show
220.0 -53.0 moveto
(Exactly one empty message frame) show
18.0 -71.0 moveto
(Frame 3) show
101.0 -71.0 moveto
(Data) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2676 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2676 a -2 2759 a
SDict begin H.S end
 -2 2759
a -2 2759 a
SDict begin 13 H.A end
 -2 2759 a -2 2759 a
SDict begin [/View [/XYZ H.V]/Dest (0:1474) cvn /DEST pdfmark end
 -2 2759 a 378 x Fh(3.6.)39
b(A)g(Request-Repl)n(y)d(Messa)o(g)q(e)i(Br)m(oker)2569
3137 y
SDict begin H.S end
 2569 3137 a 2569 3137 a
SDict begin 22.464 H.A end
 2569 3137 a 2569 3137
a
SDict begin [/View [/XYZ H.V]/Dest (8.36.1) cvn /DEST pdfmark end
 2569 3137 a -2 3335 a
SDict begin H.S end
 -2 3335 a -2 3335 a
SDict begin 13 H.A end
 -2 3335 a
-2 3335 a
SDict begin [/View [/XYZ H.V]/Dest (0:1476) cvn /DEST pdfmark end
 -2 3335 a 396 3411 a Fj(I')o(ll)21 b(recap)e(the)h(kno)n
(wledge)e(we)j(ha)n(v)o(e)e(so)i(f)o(ar)f(about)f(doing)g(weird)h(stuf)
n(f)g(with)g(\330MQ)h(message)f(en)m(v)o(elopes,)e(and)h(b)n(uild)396
3519 y(the)h(core)g(of)g(a)h(generic)e(custom)g(routing)g(proxy)f(that)
j(we)f(can)g(properly)e(call)j(a)2729 3519 y
SDict begin H.S end
 2729 3519
a 2729 3519 a
SDict begin 13 H.A end
 2729 3519 a 2729 3519 a
SDict begin [/View [/XYZ H.V]/Dest (0:1477) cvn /DEST pdfmark end
 2729 3519 a Fi(messa)o(g)o(e)g
(br)l(ok)o(er)r Fj(.)f(Sorry)f(for)h(all)h(the)396 3626
y(b)n(uzzw)o(ords.)e(What)i(we')o(ll)f(mak)o(e)g(is)h(a)1520
3626 y
SDict begin H.S end
 1520 3626 a 1520 3626 a
SDict begin 13 H.A end
 1520 3626 a 1520 3626
a
SDict begin [/View [/XYZ H.V]/Dest (0:1478) cvn /DEST pdfmark end
 1520 3626 a Fi(pr)l(oxy)f Fj(that)g(connects)f(a)i(b)n(unch)e(of)2552
3626 y
SDict begin H.S end
 2552 3626 a 2552 3626 a
SDict begin 13 H.A end
 2552 3626 a 2552 3626
a
SDict begin [/View [/XYZ H.V]/Dest (0:1479) cvn /DEST pdfmark end
 2552 3626 a Fi(clients)h Fj(to)h(a)f(b)n(unch)f(of)3244
3626 y
SDict begin H.S end
 3244 3626 a 3244 3626 a
SDict begin 13 H.A end
 3244 3626 a 3244 3626
a
SDict begin [/View [/XYZ H.V]/Dest (0:1480) cvn /DEST pdfmark end
 3244 3626 a Fi(work)o(er)o(s)p Fj(,)i(and)f(lets)396
3734 y(you)g(use)673 3734 y
SDict begin H.S end
 673 3734 a 673 3734 a
SDict begin 13 H.A end
 673
3734 a 673 3734 a
SDict begin [/View [/XYZ H.V]/Dest (0:1481) cvn /DEST pdfmark end
 673 3734 a Fi(any)g(r)l(outing)f(algorithm)g
Fj(you)h(w)o(ant.)g(The)g(algorithm)e(we')o(ll)j(implement)e(is)2907
3734 y
SDict begin H.S end
 2907 3734 a 2907 3734 a
SDict begin 13 H.A end
 2907 3734 a 2907 3734
a
SDict begin [/View [/XYZ H.V]/Dest (0:1482) cvn /DEST pdfmark end
 2907 3734 a Fi(least-r)m(ecently)g(used)r Fj(,)h(since)h(it')-5
b(s)396 3842 y(the)20 b(most)h(ob)o(vious)d(use-case)i(after)g(simple)g
(round-robin)c(distrib)n(ution.)-2 4026 y
SDict begin H.S end
 -2 4026 a -2
4026 a
SDict begin 13 H.A end
 -2 4026 a -2 4026 a
SDict begin [/View [/XYZ H.V]/Dest (0:1483) cvn /DEST pdfmark end
 -2 4026 a 396 4116 a Fj(T)-7
b(o)21 b(start)f(with,)g(let')-5 b(s)22 b(look)d(back)g(at)i(the)f
(classic)h(request-reply)d(pattern)i(and)f(then)h(see)h(ho)n(w)e(it)i
(e)o(xtends)e(o)o(v)o(er)g(a)i(lar)o(ger)396 4224 y(and)f(lar)o(ger)f
(service-oriented)e(netw)o(ork.)i(The)h(basic)g(pattern)g(just)g(has)h
(one)e(client)i(talking)e(to)h(a)h(fe)n(w)396 4332 y(w)o(ork)o(ers\()p
0 TeXcolorgray 691 4332 a
SDict begin H.S end
 691 4332 a Fj(Figure)d(3-11)1081
4332 y
SDict begin 13 H.L end
 1081 4332 a 1081 4332 a
SDict begin [/Subtype /Link/Dest (0:figure-36) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1081 4332 a Black -2 w
Fj(\).)-2 4350 y
SDict begin H.S end
 -2 4350 a -2 4350 a
SDict begin 13 H.A end
 -2 4350 a -2 4350
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-36) cvn /DEST pdfmark
end
 -2 4350 a Black 3800 5569 a Fi(98)p Black eop end
%%Page: 99 113
TeXDict begin 99 112 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.99) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1497) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-11.)e(Basic)j
(Request-r)o(eply)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1487) cvn /DEST pdfmark end
 -2 172 a 396 2431 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2431 a @beginspecial
0 @llx -266 @lly 380 @urx 0 @ury 3800 @rwi @setspecial
%%BeginDocument: images/fig36.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -266 380 0
%%HiResBoundingBox: 0.0 -266.0 380.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -38.000301361083984 moveto
148.00030517578125 -64.00029754638672 lineto
238.00030517578125 -64.00029754638672 lineto
238.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -68.00029754638672 moveto
148.00030517578125 -94.00029754638672 lineto
238.00030517578125 -94.00029754638672 lineto
238.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -178.00030517578125 moveto
28.00029945373535 -204.00030517578125 lineto
118.00029754638672 -204.00030517578125 lineto
118.00029754638672 -178.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -178.00030517578125 moveto
148.00030517578125 -204.00030517578125 lineto
238.00030517578125 -204.00030517578125 lineto
238.00030517578125 -178.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -178.00030517578125 moveto
268.00030517578125 -204.00030517578125 lineto
358.00030517578125 -204.00030517578125 lineto
358.00030517578125 -178.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -208.00030517578125 moveto
28.00029945373535 -234.00030517578125 lineto
118.00029754638672 -234.00030517578125 lineto
118.00029754638672 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -208.00030517578125 moveto
148.00030517578125 -234.00030517578125 lineto
238.00030517578125 -234.00030517578125 lineto
238.00030517578125 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -208.00030517578125 moveto
268.00030517578125 -234.00030517578125 lineto
358.00030517578125 -234.00030517578125 lineto
358.00030517578125 -208.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -175.0 moveto
25.0 -201.0 lineto
115.0 -201.0 lineto
115.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -175.0 moveto
25.0 -201.0 lineto
115.0 -201.0 lineto
115.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -175.0 moveto
145.0 -201.0 lineto
235.0 -201.0 lineto
235.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -175.0 moveto
145.0 -201.0 lineto
235.0 -201.0 lineto
235.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -175.0 moveto
265.0 -201.0 lineto
355.0 -201.0 lineto
355.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -175.0 moveto
265.0 -201.0 lineto
355.0 -201.0 lineto
355.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -205.0 moveto
25.0 -231.0 lineto
115.0 -231.0 lineto
115.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -205.0 moveto
25.0 -231.0 lineto
115.0 -231.0 lineto
115.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -205.0 moveto
145.0 -231.0 lineto
235.0 -231.0 lineto
235.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -205.0 moveto
145.0 -231.0 lineto
235.0 -231.0 lineto
235.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -205.0 moveto
265.0 -231.0 lineto
355.0 -231.0 lineto
355.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -205.0 moveto
265.0 -231.0 lineto
355.0 -231.0 lineto
355.0 -205.0 lineto
closepath
stroke
newpath
185.0 -91.0 moveto
185.0 -133.0 lineto
stroke
newpath
65.0 -175.0 moveto
65.0 -133.0 lineto
185.0 -133.0 lineto
stroke
newpath
185.0 -175.0 moveto
185.0 -133.0 lineto
stroke
newpath
305.0 -175.0 moveto
305.0 -133.0 lineto
185.0 -133.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
167.0 -54.0 moveto
(Client) show
170.0 -82.0 moveto
(REQ) show
51.0 -194.0 moveto
(REP) show
171.0 -194.0 moveto
(REP) show
291.0 -194.0 moveto
(REP) show
41.0 -222.0 moveto
(Worker) show
161.0 -222.0 moveto
(Worker) show
281.0 -222.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2431 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2431 a 274 x Fj(This)g(e)o(xtends)e(to)h
(multiple)g(w)o(ork)o(ers,)f(b)n(ut)h(if)h(we)f(w)o(ant)g(to)h(handle)e
(multiple)g(clients)i(as)g(well,)f(we)h(need)e(a)i(proxy)d(in)396
2812 y(the)i(middle.)g(W)-7 b(e')l(d)20 b(use)g(a)h(simple)f(proxy)f
(connecting)f(a)i(R)m(OUTER)h(and)e(a)i(DEALER)f(back)g(to)g(back.)f
(This)i(proxy)396 2920 y(just)g(switches)g(message)f(frames)f(between)h
(the)g(tw)o(o)g(sock)o(ets)h(as)g(f)o(ast)f(as)h(it)g(can\()p
0 TeXcolorgray 2751 2920 a
SDict begin H.S end
 2751 2920 a Fj(Figure)e(3-12)3142
2920 y
SDict begin 13 H.L end
 3142 2920 a 3142 2920 a
SDict begin [/Subtype /Link/Dest (0:figure-37) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3142 2920 a Black -2 w
Fj(\).)-2 2938 y
SDict begin H.S end
 -2 2938 a -2 2938 a
SDict begin 13 H.A end
 -2 2938 a -2 2938
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-37) cvn /DEST pdfmark
end
 -2 2938 a Black 3800 5569 a Fi(99)p Black eop end
%%Page: 100 114
TeXDict begin 100 113 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.100) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1505) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-12.)e(Str)o
(etched)i(Request-r)o(eply)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end

-2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1494) cvn /DEST pdfmark end
 -2 172 a 396 3364 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3364 a @beginspecial
0 @llx -378 @lly 380 @urx 0 @ury 3800 @rwi @setspecial
%%BeginDocument: images/fig37.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -378 380 0
%%HiResBoundingBox: 0.0 -378.0 380.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -64.00029754638672 lineto
118.00029754638672 -64.00029754638672 lineto
118.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -38.000301361083984 moveto
148.00030517578125 -64.00029754638672 lineto
238.00030517578125 -64.00029754638672 lineto
238.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -38.000301361083984 moveto
268.00030517578125 -64.00029754638672 lineto
358.00030517578125 -64.00029754638672 lineto
358.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -68.00029754638672 moveto
28.00029945373535 -94.00029754638672 lineto
118.00029754638672 -94.00029754638672 lineto
118.00029754638672 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -68.00029754638672 moveto
148.00030517578125 -94.00029754638672 lineto
238.00030517578125 -94.00029754638672 lineto
238.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -68.00029754638672 moveto
268.00030517578125 -94.00029754638672 lineto
358.00030517578125 -94.00029754638672 lineto
358.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -150.00030517578125 moveto
148.00030517578125 -176.00030517578125 lineto
238.00030517578125 -176.00030517578125 lineto
238.00030517578125 -150.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -180.00030517578125 moveto
148.00030517578125 -204.00030517578125 lineto
238.00030517578125 -204.00030517578125 lineto
238.00030517578125 -180.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -208.00030517578125 moveto
148.00030517578125 -234.00030517578125 lineto
238.00030517578125 -234.00030517578125 lineto
238.00030517578125 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -290.00030517578125 moveto
28.00029945373535 -316.00030517578125 lineto
118.00029754638672 -316.00030517578125 lineto
118.00029754638672 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -290.00030517578125 moveto
148.00030517578125 -316.00030517578125 lineto
238.00030517578125 -316.00030517578125 lineto
238.00030517578125 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -290.00030517578125 moveto
268.00030517578125 -316.00030517578125 lineto
358.00030517578125 -316.00030517578125 lineto
358.00030517578125 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -320.00030517578125 moveto
28.00029945373535 -346.00030517578125 lineto
118.00029754638672 -346.00030517578125 lineto
118.00029754638672 -320.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -320.00030517578125 moveto
148.00030517578125 -346.00030517578125 lineto
238.00030517578125 -346.00030517578125 lineto
238.00030517578125 -320.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -320.00030517578125 moveto
268.00030517578125 -346.00030517578125 lineto
358.00030517578125 -346.00030517578125 lineto
358.00030517578125 -320.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -61.0 lineto
115.0 -61.0 lineto
115.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -61.0 lineto
115.0 -61.0 lineto
115.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -35.0 moveto
265.0 -61.0 lineto
355.0 -61.0 lineto
355.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -35.0 moveto
265.0 -61.0 lineto
355.0 -61.0 lineto
355.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -65.0 moveto
25.0 -91.0 lineto
115.0 -91.0 lineto
115.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -65.0 moveto
25.0 -91.0 lineto
115.0 -91.0 lineto
115.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -65.0 moveto
265.0 -91.0 lineto
355.0 -91.0 lineto
355.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -65.0 moveto
265.0 -91.0 lineto
355.0 -91.0 lineto
355.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -147.0 moveto
145.0 -173.0 lineto
235.0 -173.0 lineto
235.0 -147.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -147.0 moveto
145.0 -173.0 lineto
235.0 -173.0 lineto
235.0 -147.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -177.0 moveto
145.0 -201.0 lineto
235.0 -201.0 lineto
235.0 -177.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -177.0 moveto
145.0 -201.0 lineto
235.0 -201.0 lineto
235.0 -177.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -205.0 moveto
145.0 -231.0 lineto
235.0 -231.0 lineto
235.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -205.0 moveto
145.0 -231.0 lineto
235.0 -231.0 lineto
235.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -287.0 moveto
25.0 -313.0 lineto
115.0 -313.0 lineto
115.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -287.0 moveto
25.0 -313.0 lineto
115.0 -313.0 lineto
115.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -287.0 moveto
145.0 -313.0 lineto
235.0 -313.0 lineto
235.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -287.0 moveto
145.0 -313.0 lineto
235.0 -313.0 lineto
235.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -287.0 moveto
265.0 -313.0 lineto
355.0 -313.0 lineto
355.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -287.0 moveto
265.0 -313.0 lineto
355.0 -313.0 lineto
355.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -317.0 moveto
25.0 -343.0 lineto
115.0 -343.0 lineto
115.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -317.0 moveto
25.0 -343.0 lineto
115.0 -343.0 lineto
115.0 -317.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -317.0 moveto
145.0 -343.0 lineto
235.0 -343.0 lineto
235.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -317.0 moveto
145.0 -343.0 lineto
235.0 -343.0 lineto
235.0 -317.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -317.0 moveto
265.0 -343.0 lineto
355.0 -343.0 lineto
355.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -317.0 moveto
265.0 -343.0 lineto
355.0 -343.0 lineto
355.0 -317.0 lineto
closepath
stroke
newpath
65.0 -91.0 moveto
65.0 -119.0 lineto
185.0 -119.0 lineto
stroke
newpath
185.0 -91.0 moveto
185.0 -119.0 lineto
stroke
newpath
305.0 -91.0 moveto
305.0 -119.0 lineto
185.0 -119.0 lineto
stroke
newpath
185.0 -147.0 moveto
185.0 -119.0 lineto
stroke
newpath
185.0 -231.0 moveto
185.0 -259.0 lineto
stroke
newpath
65.0 -287.0 moveto
65.0 -259.0 lineto
185.0 -259.0 lineto
stroke
newpath
185.0 -287.0 moveto
185.0 -259.0 lineto
stroke
newpath
305.0 -287.0 moveto
305.0 -259.0 lineto
185.0 -259.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
47.0 -54.0 moveto
(Client) show
167.0 -54.0 moveto
(Client) show
287.0 -54.0 moveto
(Client) show
50.0 -82.0 moveto
(REQ) show
170.0 -82.0 moveto
(REQ) show
290.0 -82.0 moveto
(REQ) show
161.0 -166.0 moveto
(ROUTER) show
163.0 -194.0 moveto
(Device) show
161.0 -222.0 moveto
(DEALER) show
51.0 -306.0 moveto
(REP) show
171.0 -306.0 moveto
(REP) show
291.0 -306.0 moveto
(REP) show
41.0 -334.0 moveto
(Worker) show
161.0 -334.0 moveto
(Worker) show
281.0 -334.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3364 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3364 a 274 x Fj(The)g(k)o(e)o(y)g(here)f
(is)i(that)g(the)f(R)m(OUTER)g(stores)h(the)f(originating)e(client)i
(address)g(in)h(the)f(request)f(en)m(v)o(elope,)f(the)396
3746 y(DEALER)i(and)g(w)o(ork)o(ers)g(don')o(t)e(touch)h(that,)h(and)g
(so)h(the)f(R)m(OUTER)g(kno)n(ws)g(which)f(client)i(to)f(send)g(the)g
(reply)g(back)396 3854 y(to.)g(This)h(pattern)e(assumes)h(all)h(w)o
(ork)o(ers)f(pro)o(vide)e(the)i(e)o(xact)g(same)g(service.)-2
4038 y
SDict begin H.S end
 -2 4038 a -2 4038 a
SDict begin 13 H.A end
 -2 4038 a -2 4038 a
SDict begin [/View [/XYZ H.V]/Dest (0:1498) cvn /DEST pdfmark end
 -2 4038
a 396 4128 a Fj(In)g(the)g(abo)o(v)o(e)f(design,)g(we')l(re)h(using)f
(the)i(b)n(uilt-in)e(round-robin)e(routing)h(that)i(DEALER)h(pro)o
(vides.)d(Ho)n(we)n(v)o(er)g(this)396 4236 y(means)i(some)g(w)o(ork)o
(ers)g(may)f(be)i(idle)f(while)g(others)g(ha)n(v)o(e)f(multiple)h
(requests)g(w)o(aiting.)f(F)o(or)h(better)g(ef)n(\002cienc)o(y)f(and)
396 4344 y(proper)g(load-balancing)e(we)j(w)o(ant)h(to)f(use)h(a)f
(least-recently)f(used)h(algorithm,)e(so)j(we)g(tak)o(e)f(the)g(R)m
(OUTER-REQ)396 4451 y(pattern)g(we)g(learned,)f(and)h(apply)f(that\()p
0 TeXcolorgray 1550 4451 a
SDict begin H.S end
 1550 4451 a Fj(Figure)g(3-13)1941
4451 y
SDict begin 13 H.L end
 1941 4451 a 1941 4451 a
SDict begin [/Subtype /Link/Dest (0:figure-38) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1941 4451 a Black -2 w
Fj(\).)-2 4469 y
SDict begin H.S end
 -2 4469 a -2 4469 a
SDict begin 13 H.A end
 -2 4469 a -2 4469
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-38) cvn /DEST pdfmark
end
 -2 4469 a Black 3759 5569 a Fi(100)p Black eop end
%%Page: 101 115
TeXDict begin 101 114 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.101) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-13.)e(Str)o(etched)i
(Request-r)o(eply)f(with)i(LR)n(U)-2 172 y
SDict begin H.S end
 -2 172 a -2
172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1502) cvn /DEST pdfmark end
 -2 172 a 396 3364 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3364
a @beginspecial 0 @llx -378 @lly 380 @urx 0 @ury 3800
@rwi @setspecial
%%BeginDocument: images/fig38.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -378 380 0
%%HiResBoundingBox: 0.0 -378.0 380.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -64.00029754638672 lineto
118.00029754638672 -64.00029754638672 lineto
118.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -38.000301361083984 moveto
148.00030517578125 -64.00029754638672 lineto
238.00030517578125 -64.00029754638672 lineto
238.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -38.000301361083984 moveto
268.00030517578125 -64.00029754638672 lineto
358.00030517578125 -64.00029754638672 lineto
358.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -68.00029754638672 moveto
28.00029945373535 -94.00029754638672 lineto
118.00029754638672 -94.00029754638672 lineto
118.00029754638672 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -68.00029754638672 moveto
148.00030517578125 -94.00029754638672 lineto
238.00030517578125 -94.00029754638672 lineto
238.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -68.00029754638672 moveto
268.00030517578125 -94.00029754638672 lineto
358.00030517578125 -94.00029754638672 lineto
358.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -150.00030517578125 moveto
148.00030517578125 -176.00030517578125 lineto
238.00030517578125 -176.00030517578125 lineto
238.00030517578125 -150.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -180.00030517578125 moveto
148.00030517578125 -204.00030517578125 lineto
238.00030517578125 -204.00030517578125 lineto
238.00030517578125 -180.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -208.00030517578125 moveto
148.00030517578125 -234.00030517578125 lineto
238.00030517578125 -234.00030517578125 lineto
238.00030517578125 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -290.00030517578125 moveto
28.00029945373535 -316.00030517578125 lineto
118.00029754638672 -316.00030517578125 lineto
118.00029754638672 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -290.00030517578125 moveto
148.00030517578125 -316.00030517578125 lineto
238.00030517578125 -316.00030517578125 lineto
238.00030517578125 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -290.00030517578125 moveto
268.00030517578125 -316.00030517578125 lineto
358.00030517578125 -316.00030517578125 lineto
358.00030517578125 -290.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -320.00030517578125 moveto
28.00029945373535 -346.00030517578125 lineto
118.00029754638672 -346.00030517578125 lineto
118.00029754638672 -320.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -320.00030517578125 moveto
148.00030517578125 -346.00030517578125 lineto
238.00030517578125 -346.00030517578125 lineto
238.00030517578125 -320.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -320.00030517578125 moveto
268.00030517578125 -346.00030517578125 lineto
358.00030517578125 -346.00030517578125 lineto
358.00030517578125 -320.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -61.0 lineto
115.0 -61.0 lineto
115.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -61.0 lineto
115.0 -61.0 lineto
115.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -35.0 moveto
265.0 -61.0 lineto
355.0 -61.0 lineto
355.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -35.0 moveto
265.0 -61.0 lineto
355.0 -61.0 lineto
355.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -65.0 moveto
25.0 -91.0 lineto
115.0 -91.0 lineto
115.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -65.0 moveto
25.0 -91.0 lineto
115.0 -91.0 lineto
115.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -65.0 moveto
265.0 -91.0 lineto
355.0 -91.0 lineto
355.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -65.0 moveto
265.0 -91.0 lineto
355.0 -91.0 lineto
355.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -147.0 moveto
145.0 -173.0 lineto
235.0 -173.0 lineto
235.0 -147.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -147.0 moveto
145.0 -173.0 lineto
235.0 -173.0 lineto
235.0 -147.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -177.0 moveto
145.0 -201.0 lineto
235.0 -201.0 lineto
235.0 -177.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -177.0 moveto
145.0 -201.0 lineto
235.0 -201.0 lineto
235.0 -177.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -205.0 moveto
145.0 -231.0 lineto
235.0 -231.0 lineto
235.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -205.0 moveto
145.0 -231.0 lineto
235.0 -231.0 lineto
235.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -287.0 moveto
25.0 -313.0 lineto
115.0 -313.0 lineto
115.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -287.0 moveto
25.0 -313.0 lineto
115.0 -313.0 lineto
115.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -287.0 moveto
145.0 -313.0 lineto
235.0 -313.0 lineto
235.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -287.0 moveto
145.0 -313.0 lineto
235.0 -313.0 lineto
235.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -287.0 moveto
265.0 -313.0 lineto
355.0 -313.0 lineto
355.0 -287.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -287.0 moveto
265.0 -313.0 lineto
355.0 -313.0 lineto
355.0 -287.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -317.0 moveto
25.0 -343.0 lineto
115.0 -343.0 lineto
115.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -317.0 moveto
25.0 -343.0 lineto
115.0 -343.0 lineto
115.0 -317.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -317.0 moveto
145.0 -343.0 lineto
235.0 -343.0 lineto
235.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -317.0 moveto
145.0 -343.0 lineto
235.0 -343.0 lineto
235.0 -317.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -317.0 moveto
265.0 -343.0 lineto
355.0 -343.0 lineto
355.0 -317.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -317.0 moveto
265.0 -343.0 lineto
355.0 -343.0 lineto
355.0 -317.0 lineto
closepath
stroke
newpath
65.0 -91.0 moveto
65.0 -119.0 lineto
185.0 -119.0 lineto
stroke
newpath
185.0 -91.0 moveto
185.0 -119.0 lineto
stroke
newpath
305.0 -91.0 moveto
305.0 -119.0 lineto
185.0 -119.0 lineto
stroke
newpath
185.0 -147.0 moveto
185.0 -119.0 lineto
stroke
newpath
185.0 -231.0 moveto
185.0 -259.0 lineto
stroke
newpath
65.0 -287.0 moveto
65.0 -259.0 lineto
185.0 -259.0 lineto
stroke
newpath
185.0 -287.0 moveto
185.0 -259.0 lineto
stroke
newpath
305.0 -287.0 moveto
305.0 -259.0 lineto
185.0 -259.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
47.0 -54.0 moveto
(Client) show
167.0 -54.0 moveto
(Client) show
287.0 -54.0 moveto
(Client) show
50.0 -82.0 moveto
(REQ) show
170.0 -82.0 moveto
(REQ) show
290.0 -82.0 moveto
(REQ) show
161.0 -166.0 moveto
(ROUTER) show
263.0 -166.0 moveto
(Frontend) show
163.0 -194.0 moveto
(Device) show
261.0 -194.0 moveto
(LRU queue) show
161.0 -222.0 moveto
(ROUTER) show
260.0 -222.0 moveto
(Backend) show
50.0 -306.0 moveto
(REQ) show
170.0 -306.0 moveto
(REQ) show
290.0 -306.0 moveto
(REQ) show
41.0 -334.0 moveto
(Worker) show
161.0 -334.0 moveto
(Worker) show
281.0 -334.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3364 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3364 a 274 x Fj(Our)f(brok)o(er)f(-)h(a)h
(R)m(OUTER-to-R)m(OUTER)e(LR)m(U)h(queue)f(-)i(can')o(t)e(simply)h(cop)
o(y)f(message)h(frames)g(blindly)-5 b(.)18 b(Here)i(is)396
3746 y(the)g(code,)e(it')-5 b(s)20 b(a)g(f)o(air)f(chunk)f(of)h(code,)f
(b)n(ut)h(we)h(can)f(reuse)g(the)g(core)g(logic)g(an)o(y)f(time)i(we)f
(w)o(ant)g(to)h(do)f(load-balancing:)-2 3764 y
SDict begin H.S end
 -2 3764
a -2 3764 a
SDict begin 13 H.A end
 -2 3764 a -2 3764 a
SDict begin [/View [/XYZ H.V]/Dest (0:lruqueue-php) cvn /DEST pdfmark
end
 -2 3764 a 396 3947 a
Fk(Example)i(3-5.)e(LR)n(U)h(queue)h(br)o(ok)o(er)f(\(lruqueue.php\))-2
4047 y
SDict begin H.S end
 -2 4047 a -2 4047 a
SDict begin 11.7 H.A end
 -2 4047 a -2 4047 a
SDict begin [/View [/XYZ H.V]/Dest (0:1508) cvn /DEST pdfmark end
 -2 4047
a 396 4127 a Fg(<?php)396 4224 y(/)441 4237 y(*)441 4335
y(*)576 4322 y(Least-recently)42 b(used)i(\(LRU\))g(queue)g(device)441
4432 y(*)576 4419 y(Clients)f(and)i(workers)e(are)i(shown)f(here)g(as)g
(IPC)h(as)f(PHP)441 4529 y(*)576 4516 y(does)g(not)g(have)g(threads.)
441 4626 y(*)531 4613 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4723 y(*)486
4710 y(/)396 4807 y(define\("NBR_CLIENTS",)e(10\);)396
4904 y(define\("NBR_WORKERS",)g(3\);)396 5099 y(//)90
b(Basic)44 b(request-reply)e(client)i(using)g(REQ)g(socket)p
Black 3759 5569 a Fi(101)p Black eop end
%%Page: 102 116
TeXDict begin 102 115 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.102) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fg(function)44 b(client_thread\(\))e({)441
170 y($context)i(=)g(new)h(ZMQContext\(\);)441 267 y($client)f(=)g(new)
h(ZMQSocket\($context,)c(ZMQ::SOCKET_REQ\);)441 364 y
($client->connect\("ipc://frontend.ipc"\);)441 558 y(//)89
b(Send)45 b(request,)e(get)h(reply)441 655 y($client->send\("HELLO"\);)
441 752 y($reply)g(=)h($client->recv\(\);)441 850 y(printf\("Client:)d
(\045s\045s",)i($reply,)g(PHP_EOL\);)396 947 y(})396
1141 y(//)90 b(Worker)43 b(using)h(REQ)h(socket)f(to)g(do)h(LRU)f
(routing)396 1238 y(function)g(worker_thread)e(\(\))j({)441
1335 y($context)f(=)g(new)h(ZMQContext\(\);)441 1432
y($worker)f(=)g($context->getSocket\(ZMQ::SOCKET_REQ\);)441
1530 y($worker->connect\("ipc://backend.ipc"\);)576 1724
y(//)89 b(Tell)44 b(broker)g(we're)g(ready)g(for)g(work)441
1821 y($worker->send\("READY"\);)441 2015 y(while\(true\))f({)486
2112 y(//)89 b(Read)44 b(and)h(save)f(all)g(frames)g(until)g(we)h(get)f
(an)g(empty)g(frame)755 2209 y(//)89 b(In)45 b(this)f(example)g(there)g
(is)g(only)g(1)h(but)f(it)h(could)f(be)g(more)486 2307
y($address)f(=)i($worker->recv\(\);)486 2501 y(//)f(Additional)g(logic)
g(to)g(clean)g(up)h(workers.)486 2598 y(if\($address)e(==)h("END"\))g
({)531 2695 y(exit\(\);)486 2792 y(})486 2889 y($empty)g(=)g
($worker->recv\(\);)486 2987 y(assert\(empty\($empty\)\);)486
3181 y(//)89 b(Get)45 b(request,)e(send)h(reply)486 3278
y($request)f(=)i($worker->recv\(\);)486 3375 y(printf)f(\("Worker:)f
(\045s\045s",)h($request,)f(PHP_EOL\);)486 3569 y
($worker->send\($address,)e(ZMQ::MODE_SNDMORE\);)486
3666 y($worker->send\("",)h(ZMQ::MODE_SNDMORE\);)486
3764 y($worker->send\("OK"\);)576 3861 y(})396 3958 y(})396
4152 y(function)i(main\(\))g({)441 4249 y(for\($client_nbr)e(=)j(0;)g
($client_nbr)e(<)h(NBR_CLIENTS;)f($client_nbr++\))g({)486
4346 y($pid)h(=)h(pcntl_fork\(\);)486 4444 y(if\($pid)f(==)g(0\))h({)
531 4541 y(client_thread\(\);)531 4638 y(return;)486
4735 y(})441 4832 y(})441 5026 y(for\($worker_nbr)d(=)j(0;)g
($worker_nbr)e(<)h(NBR_WORKERS;)f($worker_nbr++\))g({)486
5124 y($pid)h(=)h(pcntl_fork\(\);)p Black 3759 5569 a
Fi(102)p Black eop end
%%Page: 103 117
TeXDict begin 103 116 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.103) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 486 72 a Fg(if\($pid)44 b(==)g(0\))h({)531
170 y(worker_thread\(\);)531 267 y(return;)486 364 y(})441
461 y(})441 655 y($context)f(=)g(new)h(ZMQContext\(\);)441
752 y($frontend)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_ROUTER\);)441 850 y($backend)i(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)441 947
y($frontend->bind\("ipc://frontend.ipc"\);)441 1044 y
($backend->bind\("ipc://backend.ipc"\);)441 1238 y(//)89
b(Logic)44 b(of)h(LRU)f(loop)576 1335 y(//)89 b(-)45
b(Poll)f(backend)f(always,)h(frontend)g(only)g(if)g(1+)h(worker)f
(ready)576 1432 y(//)89 b(-)45 b(If)f(worker)g(replies,)f(queue)h
(worker)g(as)h(ready)f(and)g(forward)g(reply)576 1530
y(//)179 b(to)44 b(client)g(if)g(necessary)576 1627 y(//)89
b(-)45 b(If)f(client)g(requests,)f(pop)i(next)f(worker)g(and)g(send)g
(request)g(to)g(it)576 1821 y(//)89 b(Queue)44 b(of)g(available)g
(workers)441 1918 y($available_workers)e(=)j(0;)441 2015
y($worker_queue)e(=)h(array\(\);)441 2112 y($writeable)f(=)i($readable)
e(=)i(array\(\);)441 2307 y(while\($client_nbr)d(>)j(0\))f({)486
2404 y($poll)g(=)h(new)f(ZMQPoll\(\);)486 2598 y(//)89
b(Poll)44 b(front-end)g(only)g(if)g(we)h(have)f(available)f(workers)486
2695 y(if\($available_workers)e(>)k(0\))f({)531 2792
y($poll->add\($frontend,)d(ZMQ::POLL_IN\);)486 2889 y(})486
3084 y(//)89 b(Always)44 b(poll)g(for)h(worker)e(activity)h(on)g
(backend)486 3181 y($poll->add\($backend,)d(ZMQ::POLL_IN\);)486
3278 y($events)j(=)g($poll->poll\($readable,)d($writeable\);)486
3472 y(if\($events)i(>)i(0\))f({)531 3569 y(foreach\($readable)e(as)i
($socket\))g({)576 3666 y(//)89 b(Handle)44 b(worker)g(activity)f(on)i
(backend)576 3764 y(if\($socket)e(===)h($backend\))f({)620
3861 y(//)90 b(Queue)44 b(worker)g(address)f(for)i(LRU)f(routing)620
3958 y($worker_addr)f(=)i($socket->recv\(\);)620 4055
y(assert\($available_workers)c(<)k(NBR_WORKERS\);)620
4152 y($available_workers++;)620 4249 y(array_push\($worker_queue,)c
($worker_addr\);)620 4444 y(//)90 b(Second)44 b(frame)g(is)g(empty)620
4541 y($empty)g(=)h($socket->recv\(\);)620 4638 y
(assert\(empty\($empty\)\);)620 4832 y(//)90 b(Third)44
b(frame)g(is)g(READY)g(or)h(else)f(a)h(client)e(reply)h(address)620
4929 y($client_addr)f(=)i($socket->recv\(\);)620 5124
y(if\($client_addr)e(!=)h("READY"\))g({)p Black 3759
5569 a Fi(103)p Black eop end
%%Page: 104 118
TeXDict begin 104 117 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.104) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 665 72 a Fg($empty)44 b(=)h($socket->recv\(\);)665
170 y(assert\(empty\($empty\)\);)665 267 y($reply)f(=)h
($socket->recv\(\);)665 364 y($frontend->send\($client_addr,)40
b(ZMQ::MODE_SNDMORE\);)665 461 y($frontend->send\("",)i
(ZMQ::MODE_SNDMORE\);)665 558 y($frontend->send\($reply\);)665
752 y(//)j(exit)f(after)g(all)g(messages)g(relayed)665
850 y($client_nbr--;)620 947 y(})576 1044 y(})g(else)g(if\($socket)g
(===)g($frontend\))f({)620 1141 y(//)90 b(Now)44 b(get)g(next)h(client)
e(request,)h(route)g(to)g(LRU)h(worker)620 1238 y(//)90
b(Client)44 b(request)f(is)i([address][empty][request])620
1335 y($client_addr)e(=)i($socket->recv\(\);)620 1432
y($empty)f(=)h($socket->recv\(\);)620 1530 y
(assert\(empty\($empty\)\);)620 1627 y($request)f(=)h
($socket->recv\(\);)620 1821 y
($backend->send\(array_shift\($worker_queue\),)38 b
(ZMQ::MODE_SNDMORE\);)620 1918 y($backend->send\("",)k
(ZMQ::MODE_SNDMORE\);)620 2015 y($backend->send\($client_addr,)f
(ZMQ::MODE_SNDMORE\);)620 2112 y($backend->send\("",)h
(ZMQ::MODE_SNDMORE\);)620 2209 y($backend->send\($request\);)620
2404 y($available_workers--;)576 2501 y(})531 2598 y(})486
2695 y(})441 2792 y(})441 2987 y(//)j(Clean)f(up)g(our)g(worker)g
(processes)441 3084 y(foreach\($worker_queue)d(as)k($worker\))e({)486
3181 y($backend->send\($worker,)e(ZMQ::MODE_SNDMORE\);)486
3278 y($backend->send\("",)h(ZMQ::MODE_SNDMORE\);)486
3375 y($backend->send\('END'\);)441 3472 y(})441 3666
y(sleep\(1\);)396 3764 y(})396 3958 y(main\(\);)-2 4132
y
SDict begin H.S end
 -2 4132 a -2 4132 a
SDict begin 13 H.A end
 -2 4132 a -2 4132 a
SDict begin [/View [/XYZ H.V]/Dest (0:1509) cvn /DEST pdfmark end
 -2 4132 a 396
4232 a Fj(The)20 b(dif)n(\002cult)g(part)g(of)f(this)i(program)d(is)j
(\(a\))f(the)g(en)m(v)o(elopes)f(that)h(each)g(sock)o(et)g(reads)g(and)
f(writes,)i(and)e(\(b\))h(the)g(LR)m(U)396 4340 y(algorithm.)f(W)-7
b(e')o(ll)21 b(tak)o(e)f(these)h(in)f(turn,)f(starting)h(with)g(the)h
(message)f(en)m(v)o(elope)d(formats.)-2 4524 y
SDict begin H.S end
 -2 4524
a -2 4524 a
SDict begin 13 H.A end
 -2 4524 a -2 4524 a
SDict begin [/View [/XYZ H.V]/Dest (0:1510) cvn /DEST pdfmark end
 -2 4524 a 396 4614 a
Fj(First,)k(recall)f(that)g(a)h(REQ)g(REQ)g(sock)o(et)f(al)o(w)o(ays)g
(puts)h(on)e(an)h(empty)g(part)g(\(the)f(en)m(v)o(elope)f(delimiter\))i
(on)f(sending)396 4722 y(and)h(remo)o(v)o(es)e(this)j(empty)e(part)h
(on)g(reception.)f(The)g(reason)h(for)f(this)i(isn')o(t)f(important,)e
(it')-5 b(s)22 b(just)e(part)g(of)g(the)396 4830 y('normal')f
(request-reply)e(pattern.)i(What)i(we)f(care)g(about)g(here)f(is)i
(just)g(k)o(eeping)e(REQ)i(happ)o(y)e(by)g(doing)g(precisely)396
4938 y(what)h(she)h(needs.)e(Second,)g(the)i(R)m(OUTER)f(al)o(w)o(ays)h
(adds)f(an)g(en)m(v)o(elope)e(with)i(the)g(address)g(of)g(whome)n(v)o
(er)e(the)396 5045 y(message)i(came)g(from.)p Black 3759
5569 a Fi(104)p Black eop end
%%Page: 105 119
TeXDict begin 105 118 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.105) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1532) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1511) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(W)g(e)22 b(can)e(no)n(w)f(w)o(alk)i
(through)d(a)i(full)g(request-reply)e(chain)i(from)f(client)h(to)g(w)o
(ork)o(er)g(and)f(back.)g(In)h(this)h(code)f(we)g(set)396
180 y(the)g(identity)g(of)g(client)g(and)g(w)o(ork)o(er)f(sock)o(ets)h
(to)h(mak)o(e)e(it)i(easier)g(to)f(trace)g(the)g(message)g(frames.)g
(Most)g(normal)396 288 y(applications)f(do)h(not)g(use)g(identities.)g
(Let')-5 b(s)21 b(assume)f(the)g(client')-5 b(s)21 b(identity)f(is)h
("CLIENT")e(and)h(the)g(w)o(ork)o(er')-5 b(s)396 396
y(identity)20 b(is)h("W)o(ORKER".)g(The)f(client)g(sends)g(a)h(single)f
(frame)f(with)i(the)f(message\()p 0 TeXcolorgray 2867
396 a
SDict begin H.S end
 2867 396 a Fj(Figure)e(3-14)3257 396 y
SDict begin 13 H.L end
 3257 396
a 3257 396 a
SDict begin [/Subtype /Link/Dest (0:figure-39) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3257 396 a Black -1 w Fj(\).)-2 414 y
SDict begin H.S end
 -2
414 a -2 414 a
SDict begin 13 H.A end
 -2 414 a -2 414 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-39) cvn /DEST pdfmark
end
 -2 414 a 396 598 a Fk(Figur)o(e)i
(3-14.)e(Message)j(that)f(Client)g(Sends)-2 697 y
SDict begin H.S end
 -2
697 a -2 697 a
SDict begin 13 H.A end
 -2 697 a -2 697 a
SDict begin [/View [/XYZ H.V]/Dest (0:1515) cvn /DEST pdfmark end
 -2 697 a 396 1556 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate

396 1556 a @beginspecial 0 @llx -98 @lly 440 @urx 0 @ury
4400 @rwi @setspecial
%%BeginDocument: images/fig39.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -98 440 0
%%HiResBoundingBox: 0.0 -98.0 440.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
128.00030517578125 -38.000301361083984 moveto
128.00030517578125 -66.00029754638672 lineto
166.00030517578125 -66.00029754638672 lineto
166.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
170.00030517578125 -38.000301361083984 moveto
170.00030517578125 -66.00029754638672 lineto
248.00030517578125 -66.00029754638672 lineto
248.00030517578125 -38.000301361083984 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
125.0 -35.0 moveto
125.0 -63.0 lineto
163.0 -63.0 lineto
163.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
125.0 -35.0 moveto
125.0 -63.0 lineto
163.0 -63.0 lineto
163.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
167.0 -35.0 moveto
167.0 -63.0 lineto
245.0 -63.0 lineto
245.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
167.0 -35.0 moveto
167.0 -63.0 lineto
245.0 -63.0 lineto
245.0 -35.0 lineto
closepath
stroke
/Helvetica findfont
15 scalefont setfont
21.0 -54.0 moveto
(Frame 1) show
143.0 -54.0 moveto
(5 ) show
180.0 -54.0 moveto
(HELLO) show
323.0 -54.0 moveto
(Data frame) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1556 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1556 a -2 1722 a
SDict begin H.S end
 -2 1722
a -2 1722 a
SDict begin 13 H.A end
 -2 1722 a -2 1722 a
SDict begin [/View [/XYZ H.V]/Dest (0:1518) cvn /DEST pdfmark end
 -2 1722 a 396 1830 a
Fj(What)h(the)f(queue)f(gets,)h(when)g(reading)f(of)n(f)g(the)h(R)m
(OUTER)h(frontend)d(sock)o(et,)i(are)g(three)g(frames)f(consisting)h
(of)g(the)396 1938 y(sender)g(address,)f(empty)h(frame)f(delimiter)m(,)
g(and)g(the)i(data)f(part\()p 0 TeXcolorgray 2285 1938
a
SDict begin H.S end
 2285 1938 a Fj(Figure)e(3-15)2675 1938 y
SDict begin 13 H.L end
 2675 1938
a 2675 1938 a
SDict begin [/Subtype /Link/Dest (0:figure-40) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2675 1938 a Black -2 w Fj(\).)-2 1956 y
SDict begin H.S end

-2 1956 a -2 1956 a
SDict begin 13 H.A end
 -2 1956 a -2 1956 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-40) cvn /DEST pdfmark
end
 -2 1956 a 396
2139 a Fk(Figur)o(e)i(3-15.)e(Message)j(Coming)f(in)h(on)f(Fr)o(ontend)
-2 2239 y
SDict begin H.S end
 -2 2239 a -2 2239 a
SDict begin 13 H.A end
 -2 2239 a -2 2239 a
SDict begin [/View [/XYZ H.V]/Dest (0:1522) cvn /DEST pdfmark end
 -2
2239 a 396 3289 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3289 a @beginspecial 0 @llx -121
@lly 424 @urx 0 @ury 4240 @rwi @setspecial
%%BeginDocument: images/fig40.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -121 424 0
%%HiResBoundingBox: 0.0 -121.0 424.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -29.400239944458008 moveto
102.40023803710938 -49.40024185180664 lineto
132.40023803710938 -49.40024185180664 lineto
132.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -29.400239944458008 moveto
135.40023803710938 -51.40024185180664 lineto
206.40023803710938 -51.40024185180664 lineto
206.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -52.40024185180664 moveto
102.40023803710938 -71.40023803710938 lineto
134.40023803710938 -71.40023803710938 lineto
134.40023803710938 -52.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -74.40023803710938 moveto
102.40023803710938 -95.40023803710938 lineto
132.40023803710938 -95.40023803710938 lineto
132.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -73.40023803710938 moveto
135.40023803710938 -95.40023803710938 lineto
198.40023803710938 -95.40023803710938 lineto
198.40023803710938 -73.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
130.0 -47.0 lineto
130.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
130.0 -47.0 lineto
130.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -27.0 moveto
133.0 -49.0 lineto
204.0 -49.0 lineto
204.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -27.0 moveto
133.0 -49.0 lineto
204.0 -49.0 lineto
204.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -50.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -50.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -93.0 lineto
130.0 -93.0 lineto
130.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -93.0 lineto
130.0 -93.0 lineto
130.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -71.0 moveto
133.0 -93.0 lineto
196.0 -93.0 lineto
196.0 -71.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -71.0 moveto
133.0 -93.0 lineto
196.0 -93.0 lineto
196.0 -71.0 lineto
closepath
stroke
/Helvetica findfont
11 scalefont setfont
18.0 -43.0 moveto
(Frame 1) show
114.0 -43.0 moveto
(6 ) show
146.0 -43.0 moveto
(CLIENT) show
259.0 -43.0 moveto
(Identity of client) show
18.0 -65.0 moveto
(Frame 2) show
114.0 -65.0 moveto
(0 ) show
262.0 -65.0 moveto
(Empty message frame) show
18.0 -87.0 moveto
(Frame 3) show
114.0 -87.0 moveto
(5 ) show
147.0 -87.0 moveto
(HELLO) show
261.0 -87.0 moveto
(Data frame) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3289 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3289 a -2 3455 a
SDict begin H.S end
 -2 3455
a -2 3455 a
SDict begin 13 H.A end
 -2 3455 a -2 3455 a
SDict begin [/View [/XYZ H.V]/Dest (0:1525) cvn /DEST pdfmark end
 -2 3455 a 396 3563 a
Fj(The)g(brok)o(er)f(sends)h(this)h(to)f(the)g(w)o(ork)o(er)m(,)f
(pre\002x)o(ed)f(by)i(the)g(address)g(of)g(the)g(w)o(ork)o(er)m(,)f
(tak)o(en)h(from)f(the)h(LR)m(U)h(queue,)396 3670 y(plus)f(an)h
(additional)d(empty)i(part)g(to)g(k)o(eep)g(the)g(REQ)h(at)f(the)g
(other)g(end)f(happ)o(y\()p 0 TeXcolorgray 2723 3670
a
SDict begin H.S end
 2723 3670 a Fj(Figure)f(3-16)3113 3670 y
SDict begin 13 H.L end
 3113 3670
a 3113 3670 a
SDict begin [/Subtype /Link/Dest (0:figure-41) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3113 3670 a Black -2 w Fj(\).)-2 3688 y
SDict begin H.S end

-2 3688 a -2 3688 a
SDict begin 13 H.A end
 -2 3688 a -2 3688 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-41) cvn /DEST pdfmark
end
 -2 3688 a Black
3759 5569 a Fi(105)p Black eop end
%%Page: 106 120
TeXDict begin 106 119 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.106) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-16.)e(Message)j(Sent)f
(to)g(Back)o(end)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1529) cvn /DEST pdfmark end
 -2 172 a 396 1589 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 1589 a @beginspecial
0 @llx -165 @lly 424 @urx 0 @ury 4240 @rwi @setspecial
%%BeginDocument: images/fig41.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -165 424 0
%%HiResBoundingBox: 0.0 -165.0 424.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -29.400239944458008 moveto
102.40023803710938 -49.40024185180664 lineto
132.40023803710938 -49.40024185180664 lineto
132.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -29.400239944458008 moveto
135.40023803710938 -51.40024185180664 lineto
206.40023803710938 -51.40024185180664 lineto
206.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -52.40024185180664 moveto
102.40023803710938 -71.40023803710938 lineto
134.40023803710938 -71.40023803710938 lineto
134.40023803710938 -52.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -74.40023803710938 moveto
102.40023803710938 -93.40023803710938 lineto
132.40023803710938 -93.40023803710938 lineto
132.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -73.40023803710938 moveto
135.40023803710938 -95.40023803710938 lineto
206.40023803710938 -95.40023803710938 lineto
206.40023803710938 -73.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -96.40023803710938 moveto
102.40023803710938 -115.40023803710938 lineto
134.40023803710938 -115.40023803710938 lineto
134.40023803710938 -96.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -118.40023803710938 moveto
102.40023803710938 -139.40023803710938 lineto
132.40023803710938 -139.40023803710938 lineto
132.40023803710938 -118.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -117.40023803710938 moveto
135.40023803710938 -139.40023803710938 lineto
198.40023803710938 -139.40023803710938 lineto
198.40023803710938 -117.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
130.0 -47.0 lineto
130.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
130.0 -47.0 lineto
130.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -27.0 moveto
133.0 -49.0 lineto
204.0 -49.0 lineto
204.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -27.0 moveto
133.0 -49.0 lineto
204.0 -49.0 lineto
204.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -50.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -50.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -91.0 lineto
130.0 -91.0 lineto
130.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -91.0 lineto
130.0 -91.0 lineto
130.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -71.0 moveto
133.0 -93.0 lineto
204.0 -93.0 lineto
204.0 -71.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -71.0 moveto
133.0 -93.0 lineto
204.0 -93.0 lineto
204.0 -71.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -94.0 moveto
100.0 -113.0 lineto
132.0 -113.0 lineto
132.0 -94.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -94.0 moveto
100.0 -113.0 lineto
132.0 -113.0 lineto
132.0 -94.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -116.0 moveto
100.0 -137.0 lineto
130.0 -137.0 lineto
130.0 -116.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -116.0 moveto
100.0 -137.0 lineto
130.0 -137.0 lineto
130.0 -116.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -115.0 moveto
133.0 -137.0 lineto
196.0 -137.0 lineto
196.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -115.0 moveto
133.0 -137.0 lineto
196.0 -137.0 lineto
196.0 -115.0 lineto
closepath
stroke
/Helvetica findfont
11 scalefont setfont
18.0 -43.0 moveto
(Frame 1) show
114.0 -43.0 moveto
(6 ) show
146.0 -42.0 moveto
(WORKER) show
263.0 -43.0 moveto
(Identity of worker) show
18.0 -65.0 moveto
(Frame 2) show
114.0 -65.0 moveto
(0 ) show
262.0 -65.0 moveto
(Empty message frame) show
18.0 -87.0 moveto
(Frame 3) show
114.0 -87.0 moveto
(6 ) show
146.0 -87.0 moveto
(CLIENT) show
259.0 -87.0 moveto
(Identity of client) show
18.0 -109.0 moveto
(Frame 4) show
114.0 -109.0 moveto
(0 ) show
262.0 -109.0 moveto
(Empty message frame) show
18.0 -131.0 moveto
(Frame 5) show
114.0 -131.0 moveto
(5 ) show
147.0 -131.0 moveto
(HELLO) show
261.0 -131.0 moveto
(Data frame) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1589 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1589 a 274 x Fj(This)h(comple)o(x)d(en)m(v)
o(elope)g(stack)i(gets)h(che)n(wed)e(up)h(\002rst)h(by)f(the)g(back)o
(end)e(R)m(OUTER)j(sock)o(et,)f(which)f(remo)o(v)o(es)g(the)396
1971 y(\002rst)i(frame.)e(Then)h(the)g(REQ)h(sock)o(et)f(in)g(the)g(w)o
(ork)o(er)f(remo)o(v)o(es)g(the)h(empty)g(part,)f(and)h(pro)o(vides)e
(the)i(rest)h(to)f(the)396 2079 y(w)o(ork)o(er)f(application\()p
0 TeXcolorgray 1049 2079 a
SDict begin H.S end
 1049 2079 a Fj(Figure)f(3-17)1439
2079 y
SDict begin 13 H.L end
 1439 2079 a 1439 2079 a
SDict begin [/Subtype /Link/Dest (0:figure-42) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1439 2079 a Black -2 w
Fj(\).)-2 2097 y
SDict begin H.S end
 -2 2097 a -2 2097 a
SDict begin 13 H.A end
 -2 2097 a -2 2097
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-42) cvn /DEST pdfmark
end
 -2 2097 a 396 2280 a Fk(Figur)o(e)i(3-17.)e(Message)j(Deli)o(v)o(er)o
(ed)f(to)g(W)-6 b(ork)o(er)-2 2380 y
SDict begin H.S end
 -2 2380 a -2 2380
a
SDict begin 13 H.A end
 -2 2380 a -2 2380 a
SDict begin [/View [/XYZ H.V]/Dest (0:1536) cvn /DEST pdfmark end
 -2 2380 a 396 3430 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3430 a
@beginspecial 0 @llx -121 @lly 424 @urx 0 @ury 4240 @rwi
@setspecial
%%BeginDocument: images/fig42.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -121 424 0
%%HiResBoundingBox: 0.0 -121.0 424.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -29.400239944458008 moveto
102.40023803710938 -49.40024185180664 lineto
132.40023803710938 -49.40024185180664 lineto
132.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -29.400239944458008 moveto
135.40023803710938 -51.40024185180664 lineto
206.40023803710938 -51.40024185180664 lineto
206.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -52.40024185180664 moveto
102.40023803710938 -71.40023803710938 lineto
134.40023803710938 -71.40023803710938 lineto
134.40023803710938 -52.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
102.40023803710938 -74.40023803710938 moveto
102.40023803710938 -95.40023803710938 lineto
132.40023803710938 -95.40023803710938 lineto
132.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
135.40023803710938 -73.40023803710938 moveto
135.40023803710938 -95.40023803710938 lineto
198.40023803710938 -95.40023803710938 lineto
198.40023803710938 -73.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
130.0 -47.0 lineto
130.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
100.0 -27.0 moveto
100.0 -47.0 lineto
130.0 -47.0 lineto
130.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -27.0 moveto
133.0 -49.0 lineto
204.0 -49.0 lineto
204.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -27.0 moveto
133.0 -49.0 lineto
204.0 -49.0 lineto
204.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -50.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -50.0 moveto
100.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -50.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -93.0 lineto
130.0 -93.0 lineto
130.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -72.0 moveto
100.0 -93.0 lineto
130.0 -93.0 lineto
130.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
133.0 -71.0 moveto
133.0 -93.0 lineto
196.0 -93.0 lineto
196.0 -71.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
133.0 -71.0 moveto
133.0 -93.0 lineto
196.0 -93.0 lineto
196.0 -71.0 lineto
closepath
stroke
/Helvetica findfont
11 scalefont setfont
18.0 -43.0 moveto
(Frame 1) show
114.0 -43.0 moveto
(6 ) show
146.0 -43.0 moveto
(CLIENT) show
259.0 -43.0 moveto
(Identity of client) show
18.0 -65.0 moveto
(Frame 2) show
114.0 -65.0 moveto
(0 ) show
262.0 -65.0 moveto
(Empty message frame) show
18.0 -87.0 moveto
(Frame 3) show
114.0 -87.0 moveto
(5 ) show
147.0 -87.0 moveto
(HELLO) show
261.0 -87.0 moveto
(Data frame) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3430 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3430 a -2 3596 a
SDict begin H.S end
 -2 3596
a -2 3596 a
SDict begin 13 H.A end
 -2 3596 a -2 3596 a
SDict begin [/View [/XYZ H.V]/Dest (0:1539) cvn /DEST pdfmark end
 -2 3596 a 396 3704 a
Fj(Which)20 b(is)h(e)o(xactly)f(the)g(same)g(as)h(what)f(the)h(queue)e
(recei)n(v)o(ed)f(on)i(its)h(frontend)d(R)m(OUTER)j(sock)o(et.)f(The)f
(w)o(ork)o(er)h(has)396 3812 y(to)h(sa)n(v)o(e)f(the)g(en)m(v)o(elope)e
(\(which)h(is)j(all)e(the)h(parts)f(up)f(to)i(and)e(including)g(the)h
(empty)f(message)h(frame\))f(and)h(then)g(it)h(can)396
3920 y(do)f(what')-5 b(s)21 b(needed)d(with)j(the)f(data)g(part.)-2
4104 y
SDict begin H.S end
 -2 4104 a -2 4104 a
SDict begin 13 H.A end
 -2 4104 a -2 4104 a
SDict begin [/View [/XYZ H.V]/Dest (0:1540) cvn /DEST pdfmark end
 -2 4104
a 396 4194 a Fj(On)g(the)h(return)e(path)g(the)i(messages)f(are)g(the)g
(same)h(as)g(when)e(the)o(y)h(come)f(in,)h(i.e.)g(the)h(back)o(end)d
(sock)o(et)i(gi)n(v)o(es)g(the)396 4301 y(queue)f(a)i(message)f(in)g
(\002)n(v)o(e)g(parts,)g(and)g(the)g(queue)f(sends)h(the)g(frontend)e
(sock)o(et)j(a)f(message)g(in)g(three)g(parts,)g(and)g(the)396
4409 y(client)g(gets)h(a)g(message)f(in)g(one)g(part.)-2
4593 y
SDict begin H.S end
 -2 4593 a -2 4593 a
SDict begin 13 H.A end
 -2 4593 a -2 4593 a
SDict begin [/View [/XYZ H.V]/Dest (0:1541) cvn /DEST pdfmark end
 -2 4593
a 396 4683 a Fj(No)n(w)g(let')-5 b(s)21 b(look)f(at)h(the)f(LR)m(U)g
(algorithm.)f(It)h(requires)f(that)i(both)e(clients)h(and)g(w)o(ork)o
(ers)g(use)g(REQ)h(sock)o(ets,)f(and)g(that)396 4791
y(w)o(ork)o(ers)g(correctly)f(store)h(and)f(replay)h(the)g(en)m(v)o
(elope)e(on)h(messages)i(the)o(y)e(get.)h(The)g(algorithm)f(is:)-2
4809 y
SDict begin H.S end
 -2 4809 a -2 4809 a
SDict begin 13 H.A end
 -2 4809 a -2 4809 a
SDict begin [/View [/XYZ H.V]/Dest (0:1542) cvn /DEST pdfmark end
 -2 4809
a -2 4819 a
SDict begin H.S end
 -2 4819 a -2 4819 a
SDict begin 13 H.A end
 -2 4819 a -2 4819 a
SDict begin [/View [/XYZ H.V]/Dest (0:1543) cvn /DEST pdfmark end
 -2
4819 a Black 396 4961 a Fe(\225)p Black 479 4961 a
SDict begin H.S end
 479
4961 a 479 4961 a
SDict begin 13 H.A end
 479 4961 a 479 4961 a
SDict begin [/View [/XYZ H.V]/Dest (0:1544) cvn /DEST pdfmark end
 479 4961 a Fj(Create)i(a)f
(pollset)h(which)e(polls)h(the)h(back)o(end)d(al)o(w)o(ays,)j(and)e
(the)h(frontend)e(only)i(if)g(there)g(are)g(one)g(or)g(more)479
5069 y(w)o(ork)o(ers)g(a)n(v)n(ailable.)-2 5070 y
SDict begin H.S end
 -2
5070 a -2 5070 a
SDict begin 13 H.A end
 -2 5070 a -2 5070 a
SDict begin [/View [/XYZ H.V]/Dest (0:1545) cvn /DEST pdfmark end
 -2 5070 a Black
3757 5569 a Fi(106)p Black eop end
%%Page: 107 121
TeXDict begin 107 120 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.107) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1546) cvn /DEST pdfmark end
 479 72 a Fj(Poll)21
b(for)e(acti)n(vity)h(with)h(in\002nite)f(timeout.)-2
90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:1547) cvn /DEST pdfmark end
 -2 90 a Black 396
222 a Fe(\225)p Black 479 222 a
SDict begin H.S end
 479 222 a 479 222 a
SDict begin 13 H.A end
 479
222 a 479 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:1548) cvn /DEST pdfmark end
 479 222 a Fj(If)g(there)g(is)h(acti)n(vity)f(on)g(the)g
(back)o(end,)e(we)j(either)f(ha)n(v)o(e)f(a)i("ready")e(message)h(or)g
(a)g(reply)g(for)f(a)i(client.)f(In)g(either)479 330
y(case)h(we)f(store)h(the)f(w)o(ork)o(er)f(address)h(\(the)g(\002rst)h
(part\))e(on)h(our)f(LR)m(U)i(queue,)e(and)g(if)i(the)f(rest)g(is)i(a)e
(client)g(reply)g(we)479 438 y(send)g(it)h(back)f(to)g(that)g(client)g
(via)h(the)f(frontend.)-2 439 y
SDict begin H.S end
 -2 439 a -2 439 a
SDict begin 13 H.A end
 -2
439 a -2 439 a
SDict begin [/View [/XYZ H.V]/Dest (0:1549) cvn /DEST pdfmark end
 -2 439 a Black 396 587 a Fe(\225)p Black
479 587 a
SDict begin H.S end
 479 587 a 479 587 a
SDict begin 13 H.A end
 479 587 a 479 587 a
SDict begin [/View [/XYZ H.V]/Dest (0:1550) cvn /DEST pdfmark end
 479
587 a Fj(If)g(there)g(is)h(acti)n(vity)f(on)g(the)g(frontend,)e(we)i
(tak)o(e)g(the)h(client)f(request,)f(pop)g(the)i(ne)o(xt)e(w)o(ork)o
(er)g(\(which)h(is)h(the)479 695 y(least-recently)e(used\),)h(and)f
(send)h(the)g(request)g(to)g(the)g(back)o(end.)f(This)h(means)g
(sending)f(the)h(w)o(ork)o(er)f(address,)479 803 y(empty)h(part,)f(and)
h(then)g(the)g(three)f(parts)i(of)f(the)g(client)g(request.)-2
987 y
SDict begin H.S end
 -2 987 a -2 987 a
SDict begin 13 H.A end
 -2 987 a -2 987 a
SDict begin [/View [/XYZ H.V]/Dest (0:1551) cvn /DEST pdfmark end
 -2 987 a 396
1077 a Fj(Y)-9 b(ou)20 b(should)f(no)n(w)h(see)g(that)h(you)e(can)h
(reuse)g(and)g(e)o(xtend)e(the)j(LR)m(U)f(algorithm)f(with)h(v)n
(ariations)f(based)h(on)g(the)396 1185 y(information)e(the)i(w)o(ork)o
(er)f(pro)o(vides)g(in)h(its)h(initial)g("ready")e(message.)h(F)o(or)f
(e)o(xample,)g(w)o(ork)o(ers)h(might)f(start)i(up)f(and)396
1293 y(do)g(a)h(performance)c(self-test,)j(then)g(tell)h(the)f(brok)o
(er)f(ho)n(w)g(f)o(ast)i(the)o(y)f(are.)f(The)h(brok)o(er)f(can)h(then)
g(choose)f(the)h(f)o(astest)396 1401 y(a)n(v)n(ailable)g(w)o(ork)o(er)f
(rather)h(than)f(LR)m(U)i(or)f(round-robin.)-2 1412 y
SDict begin H.S end

-2 1412 a -2 1412 a
SDict begin 13 H.A end
 -2 1412 a -2 1412 a
SDict begin [/View [/XYZ H.V]/Dest (0:1552) cvn /DEST pdfmark end
 -2 1412 a 376
x Fh(3.7.)39 b(A)g(High-Le)n(vel)e(API)j(f)m(or)f(\330MQ)2043
1788 y
SDict begin H.S end
 2043 1788 a 2043 1788 a
SDict begin 22.464 H.A end
 2043 1788 a 2043 1788
a
SDict begin [/View [/XYZ H.V]/Dest (8.37.1) cvn /DEST pdfmark end
 2043 1788 a -2 1986 a
SDict begin H.S end
 -2 1986 a -2 1986 a
SDict begin 13 H.A end
 -2 1986 a
-2 1986 a
SDict begin [/View [/XYZ H.V]/Dest (0:1554) cvn /DEST pdfmark end
 -2 1986 a 396 2062 a Fj(Reading)20 b(and)f(writing)h
(multi-part)f(messages)h(using)g(the)g(nati)n(v)o(e)f(\330MQ)i(API)f
(is,)h(to)g(be)f(polite,)f(a)i(lot)f(of)g(w)o(ork.)g(Look)396
2170 y(at)h(the)f(core)g(of)g(the)g(w)o(ork)o(er)f(thread)g(from)h(our)
f(LR)m(U)h(queue)f(brok)o(er:)-2 2271 y
SDict begin H.S end
 -2 2271 a -2
2271 a
SDict begin 11.7 H.A end
 -2 2271 a -2 2271 a
SDict begin [/View [/XYZ H.V]/Dest (0:1555) cvn /DEST pdfmark end
 -2 2271 a 396 2350 a Fg(while)44
b(\(true\))g({)576 2448 y(//)89 b(Read)44 b(and)g(save)h(all)f(frames)g
(until)g(we)g(get)h(an)f(empty)g(frame)576 2545 y(//)89
b(In)44 b(this)h(example)e(there)h(is)h(only)f(1)h(but)f(it)g(could)g
(be)h(more)576 2642 y(char)800 2655 y(*)845 2642 y(address)e(=)i
(s_recv)f(\(worker\);)576 2739 y(char)800 2752 y(*)845
2739 y(empty)g(=)g(s_recv)g(\(worker\);)576 2836 y(assert)f(\()934
2849 y(*)979 2836 y(empty)h(==)h(0\);)576 2933 y(free)f(\(empty\);)576
3127 y(//)89 b(Get)44 b(request,)g(send)g(reply)576 3225
y(char)800 3238 y(*)845 3225 y(request)f(=)i(s_recv)f(\(worker\);)576
3322 y(printf)f(\("Worker:)h(\045s\\n",)g(request\);)576
3419 y(free)g(\(request\);)576 3613 y(s_sendmore)f(\(worker,)g
(address\);)576 3710 y(s_sendmore)g(\(worker,)g(""\);)576
3807 y(s_send)223 b(\(worker,)43 b("OK"\);)576 3905 y(free)h
(\(address\);)396 4002 y(})-2 4176 y
SDict begin H.S end
 -2 4176 a -2 4176
a
SDict begin 13 H.A end
 -2 4176 a -2 4176 a
SDict begin [/View [/XYZ H.V]/Dest (0:1556) cvn /DEST pdfmark end
 -2 4176 a 396 4276 a Fj(That)20
b(code)g(isn')o(t)g(e)n(v)o(en)f(reusable,)g(because)g(it)i(can)f(only)
g(handle)f(one)g(en)m(v)o(elope.)f(And)i(this)g(code)g(already)f(does)h
(some)396 4384 y(wrapping)f(around)f(the)i(\330MQ)h(API.)f(If)g(we)g
(used)g(the)h(libzmq)e(API)h(directly)g(this)h(is)g(what)f(we')l(d)f
(ha)n(v)o(e)h(to)g(write:)-2 4485 y
SDict begin H.S end
 -2 4485 a -2 4485
a
SDict begin 11.7 H.A end
 -2 4485 a -2 4485 a
SDict begin [/View [/XYZ H.V]/Dest (0:1557) cvn /DEST pdfmark end
 -2 4485 a 396 4564 a Fg(while)44
b(\(true\))g({)576 4661 y(//)89 b(Read)44 b(and)g(save)h(all)f(frames)g
(until)g(we)g(get)h(an)f(empty)g(frame)576 4758 y(//)89
b(In)44 b(this)h(example)e(there)h(is)h(only)f(1)h(but)f(it)g(could)g
(be)h(more)576 4855 y(zmq_msg_t)e(address;)576 4952 y(zmq_msg_init)f
(\(&address\);)576 5049 y(zmq_msg_recv)g(\(worker,)i(&address,)f(0\);)p
Black 3756 5569 a Fi(107)p Black eop end
%%Page: 108 122
TeXDict begin 108 121 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.108) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 576 72 a Fg(zmq_msg_t)43 b(empty;)576
170 y(zmq_msg_init)f(\(&empty\);)576 267 y(zmq_msg_recv)g(\(worker,)i
(&empty,)g(0\);)576 461 y(//)89 b(Get)44 b(request,)g(send)g(reply)576
558 y(zmq_msg_t)f(payload;)576 655 y(zmq_msg_init)f(\(&payload\);)576
752 y(zmq_msg_recv)g(\(worker,)i(&payload,)f(0\);)576
947 y(int)h(char_nbr;)576 1044 y(printf)f(\("Worker:)h("\);)576
1141 y(for)g(\(char_nbr)f(=)i(0;)f(char_nbr)g(<)h(zmq_msg_size)d
(\(&payload\);)h(char_nbr++\))755 1238 y(printf)h(\("\045c",)1383
1251 y(*)1428 1238 y(\(char)1696 1251 y(*)1741 1238 y(\))h
(\(zmq_msg_data)e(\(&payload\))g(+)h(char_nbr\)\);)576
1335 y(printf)f(\("\\n"\);)576 1530 y(zmq_msg_init_size)f(\(&payload,)h
(2\);)576 1627 y(memcpy)g(\(zmq_msg_data)g(\(&payload\),)g("OK",)h
(2\);)576 1821 y(zmq_msg_send)e(\(worker,)i(&address,)f(ZMQ_SNDMORE\);)
576 1918 y(zmq_close)g(\(&address\);)576 2015 y(zmq_msg_send)f
(\(worker,)i(&empty,)g(ZMQ_SNDMORE\);)576 2112 y(zmq_close)f
(\(&empty\);)576 2209 y(zmq_msg_send)f(\(worker,)i(&payload,)f(0\);)576
2307 y(zmq_close)g(\(&payload\);)396 2404 y(})-2 2578
y
SDict begin H.S end
 -2 2578 a -2 2578 a
SDict begin 13 H.A end
 -2 2578 a -2 2578 a
SDict begin [/View [/XYZ H.V]/Dest (0:1558) cvn /DEST pdfmark end
 -2 2578 a 396
2678 a Fj(What)21 b(we)f(w)o(ant)h(is)g(an)f(API)g(that)h(lets)g(us)f
(recei)n(v)o(e)g(and)f(send)h(an)g(entire)g(message)g(in)g(one)g(shot,)
g(including)e(all)396 2786 y(en)m(v)o(elopes.)g(One)i(that)h(lets)g(us)
f(do)g(what)g(we)h(w)o(ant)f(with)g(the)h(absolute)e(least)i(lines)g
(of)e(code.)h(The)g(\330MQ)g(core)g(API)396 2894 y(itself)h(doesn')o(t)
e(aim)h(to)g(do)g(this,)h(b)n(ut)f(nothing)e(pre)n(v)o(ents)h(us)i
(making)d(layers)i(on)g(top,)g(and)f(part)h(of)g(learning)f(to)h(use)
396 3001 y(\330MQ)h(intelligently)e(is)i(to)f(do)g(e)o(xactly)f(that.)
-2 3186 y
SDict begin H.S end
 -2 3186 a -2 3186 a
SDict begin 13 H.A end
 -2 3186 a -2 3186 a
SDict begin [/View [/XYZ H.V]/Dest (0:1559) cvn /DEST pdfmark end
 -2
3186 a 396 3275 a Fj(Making)g(a)i(good)e(message)h(API)g(is)h(f)o
(airly)f(dif)n(\002cult,)f(especially)h(if)h(we)f(w)o(ant)h(to)f(a)n(v)
n(oid)g(cop)o(ying)e(data)i(around)f(too)396 3383 y(much.)g(W)-7
b(e)22 b(ha)n(v)o(e)d(a)i(problem)d(of)i(terminology:)e(\330MQ)i(uses)h
("message")f(to)g(describe)g(both)f(multi-part)g(messages,)396
3491 y(and)h(indi)n(vidual)e(parts)i(of)g(a)h(message.)f(W)-7
b(e)21 b(ha)n(v)o(e)f(a)g(problem)f(of)h(semantics:)g(sometimes)g(it')
-5 b(s)21 b(natural)e(to)i(see)396 3599 y(message)f(content)f(as)i
(printable)e(string)h(data,)g(sometimes)g(as)h(binary)e(blobs.)-2
3783 y
SDict begin H.S end
 -2 3783 a -2 3783 a
SDict begin 13 H.A end
 -2 3783 a -2 3783 a
SDict begin [/View [/XYZ H.V]/Dest (0:1560) cvn /DEST pdfmark end
 -2 3783
a 396 3873 a Fj(So)i(one)e(solution)h(is)h(to)f(use)h(three)e
(concepts:)1748 3873 y
SDict begin H.S end
 1748 3873 a 1748 3873 a
SDict begin 13 H.A end
 1748 3873
a 1748 3873 a
SDict begin [/View [/XYZ H.V]/Dest (0:1561) cvn /DEST pdfmark end
 1748 3873 a Fi(string)h Fj(\(already)f(the)h(basis)h(for)
e({{s_send})h(and)3188 3873 y
SDict begin H.S end
 3188 3873 a 3188 3873 a
SDict begin 13 H.A end

3188 3873 a 3188 3873 a
SDict begin [/View [/XYZ H.V]/Dest (0:1562) cvn /DEST pdfmark end
 3188 3873 a Fg(s_recv)p Fj(\),)3526
3873 y
SDict begin H.S end
 3526 3873 a 3526 3873 a
SDict begin 13 H.A end
 3526 3873 a 3526 3873
a
SDict begin [/View [/XYZ H.V]/Dest (0:1563) cvn /DEST pdfmark end
 3526 3873 a Fi(fr)o(ame)h Fj(\(a)396 3981 y(message)f(frame\),)f(and)
1102 3981 y
SDict begin H.S end
 1102 3981 a 1102 3981 a
SDict begin 13 H.A end
 1102 3981 a 1102
3981 a
SDict begin [/View [/XYZ H.V]/Dest (0:1564) cvn /DEST pdfmark end
 1102 3981 a Fi(messa)o(g)o(e)h Fj(\(a)g(list)i(of)e(one)f(or)h
(more)f(frames\).)g(Here)i(is)g(the)f(w)o(ork)o(er)f(code,)g(re)n
(written)h(onto)f(an)396 4089 y(API)i(using)e(these)i(concepts:)-2
4190 y
SDict begin H.S end
 -2 4190 a -2 4190 a
SDict begin 11.7 H.A end
 -2 4190 a -2 4190 a
SDict begin [/View [/XYZ H.V]/Dest (0:1565) cvn /DEST pdfmark end
 -2 4190
a 396 4269 a Fg(while)44 b(\(true\))g({)576 4366 y(zmsg_t)889
4379 y(*)934 4366 y(zmsg)g(=)h(zmsg_recv)e(\(worker\);)576
4464 y(zframe_print)f(\(zmsg_last)i(\(zmsg\),)f("Worker:)h("\);)576
4561 y(zframe_reset)e(\(zmsg_last)i(\(zmsg\),)f("OK",)h(2\);)576
4658 y(zmsg_send)f(\(&zmsg,)h(worker\);)396 4755 y(})p
Black 3759 5569 a Fi(108)p Black eop end
%%Page: 109 123
TeXDict begin 109 122 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.109) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1566) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Cutting)20 b(the)f(amount)g(of)g(code)g
(we)h(ha)n(v)o(e)f(to)h(write)g(is)g(pro\002table,)e(especially)i
(since)f(the)h(results)g(are)g(easy)f(to)h(read)f(and)396
180 y(understand.)f(W)-7 b(e)21 b(can)f(continue)f(this)i(process)f
(for)f(other)g(aspects)i(of)f(w)o(orking)f(with)h(\330MQ.)g(Let')-5
b(s)21 b(mak)o(e)f(a)g(wishlist)396 288 y(of)g(things)g(we)g(w)o(ould)g
(lik)o(e)g(in)h(a)f(higher)n(-le)n(v)o(el)e(API:)-2 306
y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2 306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:1567) cvn /DEST pdfmark end
 -2 306 a -2 316
a
SDict begin H.S end
 -2 316 a -2 316 a
SDict begin 13 H.A end
 -2 316 a -2 316 a
SDict begin [/View [/XYZ H.V]/Dest (0:1568) cvn /DEST pdfmark end
 -2 316 a Black
396 459 a Fe(\225)p Black 479 459 a
SDict begin H.S end
 479 459 a 479 459
a
SDict begin 13 H.A end
 479 459 a 479 459 a
SDict begin [/View [/XYZ H.V]/Dest (0:1569) cvn /DEST pdfmark end
 479 459 a 479 459 a
SDict begin H.S end
 479 459 a 479
459 a
SDict begin 13 H.A end
 479 459 a 479 459 a
SDict begin [/View [/XYZ H.V]/Dest (0:1570) cvn /DEST pdfmark end
 479 459 a Fi(A)n(utomatic)i(handling)e(of)i
(soc)n(k)o(ets.)h Fj(I)f(\002nd)g(it)h(really)f(anno)o(ying)e(to)i(ha)n
(v)o(e)g(to)g(close)g(sock)o(ets)h(manually)-5 b(,)18
b(and)i(to)g(ha)n(v)o(e)479 566 y(to)h(e)o(xplicitly)e(de\002ne)g(the)i
(linger)e(timeout)h(in)g(some)g(b)n(ut)g(not)g(all)h(cases.)f(It')l(d)g
(be)g(great)g(to)g(ha)n(v)o(e)g(a)g(w)o(ay)h(to)f(close)479
674 y(sock)o(ets)h(automatically)d(when)i(I)g(close)h(the)f(conte)o
(xt.)-2 692 y
SDict begin H.S end
 -2 692 a -2 692 a
SDict begin 13 H.A end
 -2 692 a -2 692 a
SDict begin [/View [/XYZ H.V]/Dest (0:1571) cvn /DEST pdfmark end
 -2
692 a Black 396 824 a Fe(\225)p Black 479 824 a
SDict begin H.S end
 479 824
a 479 824 a
SDict begin 13 H.A end
 479 824 a 479 824 a
SDict begin [/View [/XYZ H.V]/Dest (0:1572) cvn /DEST pdfmark end
 479 824 a 479 824 a
SDict begin H.S end
 479
824 a 479 824 a
SDict begin 13 H.A end
 479 824 a 479 824 a
SDict begin [/View [/XYZ H.V]/Dest (0:1573) cvn /DEST pdfmark end
 479 824 a Fi(P)-7
b(ortable)20 b(thr)m(ead)f(mana)o(g)o(ement.)g Fj(Ev)o(ery)f(non-tri)n
(vial)g(\330MQ)j(application)e(uses)h(threads,)g(b)n(ut)g(POSIX)g
(threads)479 932 y(aren')o(t)f(portable.)g(So)h(a)h(decent)e(high-le)n
(v)o(el)f(API)j(should)e(hide)h(this)g(under)f(a)i(portable)e(layer)-5
b(.)-2 950 y
SDict begin H.S end
 -2 950 a -2 950 a
SDict begin 13 H.A end
 -2 950 a -2 950 a
SDict begin [/View [/XYZ H.V]/Dest (0:1574) cvn /DEST pdfmark end
 -2 950
a Black 396 1081 a Fe(\225)p Black 479 1081 a
SDict begin H.S end
 479 1081
a 479 1081 a
SDict begin 13 H.A end
 479 1081 a 479 1081 a
SDict begin [/View [/XYZ H.V]/Dest (0:1575) cvn /DEST pdfmark end
 479 1081 a 479 1081
a
SDict begin H.S end
 479 1081 a 479 1081 a
SDict begin 13 H.A end
 479 1081 a 479 1081 a
SDict begin [/View [/XYZ H.V]/Dest (0:1576) cvn /DEST pdfmark end
 479 1081
a Fi(P)e(ortable)20 b(cloc)n(ks.)g Fj(Ev)o(en)f(getting)h(the)g(time)g
(to)h(a)f(millisecond)g(resolution,)e(or)i(sleeping)g(for)f(some)h
(milliseconds,)479 1189 y(is)h(not)f(portable.)f(Realistic)i(\330MQ)g
(applications)e(need)g(portable)g(clocks,)h(so)g(our)g(API)g(should)f
(pro)o(vide)f(them.)-2 1207 y
SDict begin H.S end
 -2 1207 a -2 1207 a
SDict begin 13 H.A end
 -2
1207 a -2 1207 a
SDict begin [/View [/XYZ H.V]/Dest (0:1577) cvn /DEST pdfmark end
 -2 1207 a Black 396 1339 a Fe(\225)p
Black 479 1339 a
SDict begin H.S end
 479 1339 a 479 1339 a
SDict begin 13 H.A end
 479 1339 a 479
1339 a
SDict begin [/View [/XYZ H.V]/Dest (0:1578) cvn /DEST pdfmark end
 479 1339 a 479 1339 a
SDict begin H.S end
 479 1339 a 479 1339 a
SDict begin 13 H.A end
 479
1339 a 479 1339 a
SDict begin [/View [/XYZ H.V]/Dest (0:1579) cvn /DEST pdfmark end
 479 1339 a Fi(A)j(r)m(eactor)f(to)g(r)m(eplace)1165
1339 y
SDict begin H.S end
 1165 1339 a 1165 1339 a
SDict begin 13 H.A end
 1165 1339 a 1165 1339
a
SDict begin [/View [/XYZ H.V]/Dest (0:1580) cvn /DEST pdfmark end
 1165 1339 a Fb(zmq_poll\(\))p Fi(.)f Fj(The)h(poll)f(loop)h(is)h
(simple)f(b)n(ut)g(clumsy)-5 b(.)19 b(Writing)h(a)h(lot)f(of)g(these,)g
(we)h(end)479 1446 y(up)f(doing)f(the)h(same)h(w)o(ork)e(o)o(v)o(er)g
(and)g(o)o(v)o(er:)g(calculating)g(timers,)h(and)g(calling)g(code)f
(when)h(sock)o(ets)g(are)g(ready)-5 b(.)19 b(A)479 1554
y(simple)h(reactor)g(with)g(sock)o(et)g(readers,)f(and)h(timers,)g(w)o
(ould)f(sa)n(v)o(e)i(a)f(lot)h(of)f(repeated)f(w)o(ork.)-2
1572 y
SDict begin H.S end
 -2 1572 a -2 1572 a
SDict begin 13 H.A end
 -2 1572 a -2 1572 a
SDict begin [/View [/XYZ H.V]/Dest (0:1581) cvn /DEST pdfmark end
 -2 1572
a Black 396 1704 a Fe(\225)p Black 479 1704 a
SDict begin H.S end
 479 1704
a 479 1704 a
SDict begin 13 H.A end
 479 1704 a 479 1704 a
SDict begin [/View [/XYZ H.V]/Dest (0:1582) cvn /DEST pdfmark end
 479 1704 a 479 1704
a
SDict begin H.S end
 479 1704 a 479 1704 a
SDict begin 13 H.A end
 479 1704 a 479 1704 a
SDict begin [/View [/XYZ H.V]/Dest (0:1583) cvn /DEST pdfmark end
 479 1704
a Fi(Pr)l(oper)i(handling)c(of)k(Ctrl-C.)g Fj(W)-7 b(e)22
b(already)d(sa)o(w)h(ho)n(w)g(to)g(catch)g(an)g(interrupt.)f(It)h(w)o
(ould)g(be)g(useful)f(if)i(this)479 1812 y(happened)d(in)j(all)f
(applications.)-2 1996 y
SDict begin H.S end
 -2 1996 a -2 1996 a
SDict begin 13 H.A end
 -2 1996
a -2 1996 a
SDict begin [/View [/XYZ H.V]/Dest (0:1584) cvn /DEST pdfmark end
 -2 1996 a 396 2086 a Fj(T)l(urning)f(this)h(wishlist)i
(into)e(reality)f(gi)n(v)o(es)h(us)1771 2086 y
SDict begin H.S end
 1771 2086
a 1771 2086 a
SDict begin 13 H.A end
 1771 2086 a 1771 2086 a
SDict begin [/View [/XYZ H.V]/Dest (0:1585) cvn /DEST pdfmark end
 1771 2086 a Fj(CZMQ)g
(\(http://zero.mq/c\),)d(a)k(high-le)n(v)o(el)d(C)j(API)g(for)e
(\330MQ.)h(This)396 2194 y(high-le)n(v)o(el)e(binding)h(in)h(f)o(act)h
(de)n(v)o(eloped)c(out)j(of)g(earlier)g(v)o(ersions)f(of)h(the)g
(Guide.)g(It)g(combines)f(nicer)h(semantics)g(for)396
2302 y(w)o(orking)f(with)h(\330MQ)h(with)f(some)g(portability)f
(layers,)h(and)f(\(importantly)f(for)i(C)h(b)n(ut)f(less)h(for)f(other)
f(languages\))396 2410 y(containers)g(lik)o(e)i(hashes)f(and)f(lists.)j
(CZMQ)e(also)h(uses)g(an)f(ele)o(gant)f(object)g(model)h(that)g(leads)g
(to)h(frankly)d(lo)o(v)o(ely)396 2517 y(code.)-2 2684
y
SDict begin H.S end
 -2 2684 a -2 2684 a
SDict begin 13 H.A end
 -2 2684 a -2 2684 a
SDict begin [/View [/XYZ H.V]/Dest (0:1586) cvn /DEST pdfmark end
 -2 2684 a 396
2791 a Fj(Here)i(is)h(the)g(LR)m(U)f(queue)f(brok)o(er)g(re)n(written)g
(to)h(use)h(a)g(higher)n(-le)n(v)o(el)c(API)k(\(CZMQ)f(for)g(the)g(C)h
(case\):)-2 2809 y
SDict begin H.S end
 -2 2809 a -2 2809 a
SDict begin 13 H.A end
 -2 2809 a -2 2809
a
SDict begin [/View [/XYZ H.V]/Dest (0:lruqueue2-php) cvn /DEST pdfmark
end
 -2 2809 a 396 2993 a Fk(Example)g(3-6.)e(LR)n(U)h(queue)h(br)o(ok)o
(er)f(using)h(high-le)o(v)o(el)f(API)g(\(lruqueue2.php\))-2
3093 y
SDict begin H.S end
 -2 3093 a -2 3093 a
SDict begin 11.7 H.A end
 -2 3093 a -2 3093 a
SDict begin [/View [/XYZ H.V]/Dest (0:1589) cvn /DEST pdfmark end
 -2 3093
a 396 3173 a Fg(<?php)396 3270 y(/)441 3283 y(*)441 3380
y(*)576 3367 y(Least-recently)42 b(used)i(\(LRU\))g(queue)g(device)441
3477 y(*)576 3464 y(Demonstrates)e(use)j(of)f(the)h(zmsg)f(class)441
3574 y(*)531 3561 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 3672 y(*)486
3659 y(/)396 3756 y(include)g("zmsg.php";)396 3950 y
(define\("NBR_CLIENTS",)e(10\);)396 4047 y(define\("NBR_WORKERS",)g
(3\);)396 4241 y(//)90 b(Basic)44 b(request-reply)e(client)i(using)g
(REQ)g(socket)396 4339 y(function)g(client_thread\(\))e({)441
4436 y($context)i(=)g(new)h(ZMQContext\(\);)441 4533
y($client)f(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_REQ\);)441
4630 y($client->connect\("ipc://frontend.ipc"\);)441
4824 y(//)89 b(Send)45 b(request,)e(get)h(reply)441 4921
y($client->send\("HELLO"\);)441 5019 y($reply)g(=)h($client->recv\(\);)
441 5116 y(printf\("Client:)d(\045s\045s",)i($reply,)g(PHP_EOL\);)p
Black 3759 5569 a Fi(109)p Black eop end
%%Page: 110 124
TeXDict begin 110 123 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.110) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fg(})396 267 y(//)90 b(Worker)43
b(using)h(REQ)h(socket)f(to)g(do)h(LRU)f(routing)396
364 y(function)g(worker_thread)e(\(\))j({)441 461 y($context)f(=)g(new)
h(ZMQContext\(\);)441 558 y($worker)f(=)g
($context->getSocket\(ZMQ::SOCKET_REQ\);)441 655 y
($worker->connect\("ipc://backend.ipc"\);)576 850 y(//)89
b(Tell)44 b(broker)g(we're)g(ready)g(for)g(work)441 947
y($worker->send\("READY"\);)441 1141 y(while\(true\))f({)486
1238 y($zmsg)h(=)h(new)f(Zmsg\($worker\);)486 1335 y($zmsg->recv\(\);)
486 1530 y(//)g(Additional)g(logic)g(to)g(clean)g(up)h(workers.)486
1627 y(if\($zmsg->address\(\))d(==)i("END"\))g({)531
1724 y(exit\(\);)486 1821 y(})486 2015 y(printf)g(\("Worker:)f
(\045s\\n",)h($zmsg->body\(\)\);)486 2209 y($zmsg->body_set\("OK"\);)
486 2307 y($zmsg->send\(\);)576 2404 y(})396 2501 y(})396
2695 y(function)g(main\(\))g({)441 2792 y(for\($client_nbr)e(=)j(0;)g
($client_nbr)e(<)h(NBR_CLIENTS;)f($client_nbr++\))g({)486
2889 y($pid)h(=)h(pcntl_fork\(\);)486 2987 y(if\($pid)f(==)g(0\))h({)
531 3084 y(client_thread\(\);)531 3181 y(return;)486
3278 y(})441 3375 y(})441 3569 y(for\($worker_nbr)d(=)j(0;)g
($worker_nbr)e(<)h(NBR_WORKERS;)f($worker_nbr++\))g({)486
3666 y($pid)h(=)h(pcntl_fork\(\);)486 3764 y(if\($pid)f(==)g(0\))h({)
531 3861 y(worker_thread\(\);)531 3958 y(return;)486
4055 y(})441 4152 y(})441 4346 y($context)f(=)g(new)h(ZMQContext\(\);)
441 4444 y($frontend)e(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_ROUTER\);)441 4541 y($backend)i(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)441 4638
y($frontend->bind\("ipc://frontend.ipc"\);)441 4735 y
($backend->bind\("ipc://backend.ipc"\);)441 4929 y(//)89
b(Logic)44 b(of)h(LRU)f(loop)576 5026 y(//)89 b(-)45
b(Poll)f(backend)f(always,)h(frontend)g(only)g(if)g(1+)h(worker)f
(ready)576 5124 y(//)89 b(-)45 b(If)f(worker)g(replies,)f(queue)h
(worker)g(as)h(ready)f(and)g(forward)g(reply)p Black
3759 5569 a Fi(110)p Black eop end
%%Page: 111 125
TeXDict begin 111 124 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.111) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 576 72 a Fg(//)179 b(to)44 b(client)g(if)g(necessary)
576 170 y(//)89 b(-)45 b(If)f(client)g(requests,)f(pop)i(next)f(worker)
g(and)g(send)g(request)g(to)g(it)576 364 y(//)89 b(Queue)44
b(of)g(available)g(workers)441 461 y($available_workers)e(=)j(0;)441
558 y($worker_queue)e(=)h(array\(\);)441 655 y($writeable)f(=)i
($readable)e(=)i(array\(\);)441 850 y(while\($client_nbr)d(>)j(0\))f({)
486 947 y($poll)g(=)h(new)f(ZMQPoll\(\);)486 1141 y(//)89
b(Poll)44 b(front-end)g(only)g(if)g(we)h(have)f(available)f(workers)486
1238 y(if\($available_workers)e(>)k(0\))f({)531 1335
y($poll->add\($frontend,)d(ZMQ::POLL_IN\);)486 1432 y(})486
1627 y(//)89 b(Always)44 b(poll)g(for)h(worker)e(activity)h(on)g
(backend)486 1724 y($poll->add\($backend,)d(ZMQ::POLL_IN\);)486
1821 y($events)j(=)g($poll->poll\($readable,)d($writeable\);)486
2015 y(if\($events)i(>)i(0\))f({)531 2112 y(foreach\($readable)e(as)i
($socket\))g({)576 2209 y(//)89 b(Handle)44 b(worker)g(activity)f(on)i
(backend)576 2307 y(if\($socket)e(===)h($backend\))f({)620
2404 y(//)90 b(Queue)44 b(worker)g(address)f(for)i(LRU)f(routing)620
2501 y($zmsg)g(=)h(new)f(Zmsg\($socket\);)620 2598 y($zmsg->recv\(\);)
620 2695 y(assert\($available_workers)d(<)k(NBR_WORKERS\);)620
2792 y($available_workers++;)620 2889 y(array_push\($worker_queue,)c
($zmsg->unwrap\(\)\);)620 3084 y(if\($zmsg->body\(\))i(!=)h("READY"\))g
({)665 3181 y($zmsg->set_socket\($frontend\)->send\(\);)665
3375 y(//)h(exit)f(after)g(all)g(messages)g(relayed)665
3472 y($client_nbr--;)620 3569 y(})576 3666 y(})g(else)g(if\($socket)g
(===)g($frontend\))f({)620 3764 y($zmsg)h(=)h(new)f(Zmsg\($socket\);)
620 3861 y($zmsg->recv\(\);)620 3958 y
($zmsg->wrap\(array_shift\($worker_queue\),)39 b(""\);)620
4055 y($zmsg->set_socket\($backend\)->send\(\);)620 4152
y($available_workers--;)576 4249 y(})531 4346 y(})486
4444 y(})441 4541 y(})441 4735 y(//)45 b(Clean)f(up)g(our)g(worker)g
(processes)441 4832 y(foreach\($worker_queue)d(as)k($worker\))e({)486
4929 y($zmsg)h(=)h(new)f(Zmsg\($backend\);)486 5026 y
($zmsg->body_set\('END'\)->wrap\($worker,)39 b(""\)->send\(\);)441
5124 y(})p Black 3759 5569 a Fi(111)p Black eop end
%%Page: 112 126
TeXDict begin 112 125 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.112) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1615) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 441 170 a Fg(sleep\(1\);)396
267 y(})396 461 y(main\(\))-2 635 y
SDict begin H.S end
 -2 635 a -2 635 a
SDict begin 13 H.A end

-2 635 a -2 635 a
SDict begin [/View [/XYZ H.V]/Dest (0:1590) cvn /DEST pdfmark end
 -2 635 a 396 735 a Fj(One)20 b(thing)g(CZMQ)g(pro)o
(vides)f(is)i(clean)f(interrupt)f(handling.)f(This)i(means)g(that)g
(Ctrl-C)h(will)g(cause)f(an)o(y)g(blocking)396 843 y(\330MQ)h(call)f
(to)h(e)o(xit)f(with)g(a)h(return)e(code)g(-1)h(and)g(errno)f(set)i(to)
f(EINTR.)g(The)g(high-le)n(v)o(el)e(recv)i(methods)f(will)i(return)396
951 y(NULL)f(in)h(such)f(cases.)g(So,)h(you)e(can)h(cleanly)f(e)o(xit)h
(a)h(loop)e(lik)o(e)i(this:)-2 1052 y
SDict begin H.S end
 -2 1052 a -2 1052
a
SDict begin 11.7 H.A end
 -2 1052 a -2 1052 a
SDict begin [/View [/XYZ H.V]/Dest (0:1591) cvn /DEST pdfmark end
 -2 1052 a 396 1131 a Fg(while)44
b(\(true\))g({)576 1228 y(zstr_send)f(\(client,)g("HELLO"\);)576
1325 y(char)800 1338 y(*)845 1325 y(reply)h(=)g(zstr_recv)g
(\(client\);)576 1422 y(if)g(\(!reply\))755 1520 y(break;)627
b(//)89 b(Interrupted)576 1617 y(printf)43 b(\("Client:)h(\045s\\n",)g
(reply\);)576 1714 y(free)g(\(reply\);)576 1811 y(sleep)g(\(1\);)396
1908 y(})-2 2082 y
SDict begin H.S end
 -2 2082 a -2 2082 a
SDict begin 13 H.A end
 -2 2082 a -2 2082
a
SDict begin [/View [/XYZ H.V]/Dest (0:1592) cvn /DEST pdfmark end
 -2 2082 a 396 2182 a Fj(Or)m(,)20 b(if)h(you')l(re)d(calling)1074
2182 y
SDict begin H.S end
 1074 2182 a 1074 2182 a
SDict begin 13 H.A end
 1074 2182 a 1074 2182
a
SDict begin [/View [/XYZ H.V]/Dest (0:1593) cvn /DEST pdfmark end
 1074 2182 a Fg(zmq_poll\(\))p Fj(,)g(test)j(on)f(the)g(return)f
(code:)-2 2283 y
SDict begin H.S end
 -2 2283 a -2 2283 a
SDict begin 11.7 H.A end
 -2 2283 a -2 2283
a
SDict begin [/View [/XYZ H.V]/Dest (0:1594) cvn /DEST pdfmark end
 -2 2283 a 396 2362 a Fg(if)45 b(\(zmq_poll)e(\(items,)h(2,)g(1000)
1696 2375 y(*)1786 2362 y(1000\))g(==)h(-1\))576 2459
y(break;)626 b(//)90 b(Interrupted)-2 2637 y
SDict begin H.S end
 -2 2637
a -2 2637 a
SDict begin 13 H.A end
 -2 2637 a -2 2637 a
SDict begin [/View [/XYZ H.V]/Dest (0:1595) cvn /DEST pdfmark end
 -2 2637 a 396 2733 a
Fj(The)20 b(pre)n(vious)f(e)o(xample)g(still)i(uses)1461
2733 y
SDict begin H.S end
 1461 2733 a 1461 2733 a
SDict begin 13 H.A end
 1461 2733 a 1461 2733
a
SDict begin [/View [/XYZ H.V]/Dest (0:1596) cvn /DEST pdfmark end
 1461 2733 a Fg(zmq_poll\(\))p Fj(.)d(So)j(ho)n(w)e(about)h(reactors?)
f(The)h(CZMQ)3157 2733 y
SDict begin H.S end
 3157 2733 a 3157 2733 a
SDict begin 13 H.A end
 3157
2733 a 3157 2733 a
SDict begin [/View [/XYZ H.V]/Dest (0:1597) cvn /DEST pdfmark end
 3157 2733 a Fg(zloop)f Fj(reactor)h(is)396
2841 y(simple)g(b)n(ut)h(functional.)d(It)i(lets)h(you:)-2
2859 y
SDict begin H.S end
 -2 2859 a -2 2859 a
SDict begin 13 H.A end
 -2 2859 a -2 2859 a
SDict begin [/View [/XYZ H.V]/Dest (0:1598) cvn /DEST pdfmark end
 -2 2859
a -2 2869 a
SDict begin H.S end
 -2 2869 a -2 2869 a
SDict begin 13 H.A end
 -2 2869 a -2 2869 a
SDict begin [/View [/XYZ H.V]/Dest (0:1599) cvn /DEST pdfmark end
 -2
2869 a Black 396 3011 a Fe(\225)p Black 479 3011 a
SDict begin H.S end
 479
3011 a 479 3011 a
SDict begin 13 H.A end
 479 3011 a 479 3011 a
SDict begin [/View [/XYZ H.V]/Dest (0:1600) cvn /DEST pdfmark end
 479 3011 a Fj(Set)g(a)g(reader)
e(on)h(an)o(y)f(sock)o(et,)h(i.e.)g(code)g(that)g(is)h(called)f(whene)n
(v)o(er)e(the)i(sock)o(et)g(has)h(input.)-2 3029 y
SDict begin H.S end
 -2
3029 a -2 3029 a
SDict begin 13 H.A end
 -2 3029 a -2 3029 a
SDict begin [/View [/XYZ H.V]/Dest (0:1601) cvn /DEST pdfmark end
 -2 3029 a Black
396 3161 a Fe(\225)p Black 479 3161 a
SDict begin H.S end
 479 3161 a 479
3161 a
SDict begin 13 H.A end
 479 3161 a 479 3161 a
SDict begin [/View [/XYZ H.V]/Dest (0:1602) cvn /DEST pdfmark end
 479 3161 a Fj(Cancel)g(a)f(reader)f(on)h
(a)h(sock)o(et.)-2 3162 y
SDict begin H.S end
 -2 3162 a -2 3162 a
SDict begin 13 H.A end
 -2 3162
a -2 3162 a
SDict begin [/View [/XYZ H.V]/Dest (0:1603) cvn /DEST pdfmark end
 -2 3162 a Black 396 3310 a Fe(\225)p Black
479 3310 a
SDict begin H.S end
 479 3310 a 479 3310 a
SDict begin 13 H.A end
 479 3310 a 479 3310
a
SDict begin [/View [/XYZ H.V]/Dest (0:1604) cvn /DEST pdfmark end
 479 3310 a Fj(Set)g(a)g(timer)f(that)g(goes)g(of)n(f)f(once)h(or)g
(multiple)f(times)i(at)g(speci\002c)f(interv)n(als.)-2
3328 y
SDict begin H.S end
 -2 3328 a -2 3328 a
SDict begin 13 H.A end
 -2 3328 a -2 3328 a
SDict begin [/View [/XYZ H.V]/Dest (0:1605) cvn /DEST pdfmark end
 -2 3328
a Black 396 3460 a Fe(\225)p Black 479 3460 a
SDict begin H.S end
 479 3460
a 479 3460 a
SDict begin 13 H.A end
 479 3460 a 479 3460 a
SDict begin [/View [/XYZ H.V]/Dest (0:1606) cvn /DEST pdfmark end
 479 3460 a Fj(Cancel)h(a)f(timer)-5
b(.)-2 3627 y
SDict begin H.S end
 -2 3627 a -2 3627 a
SDict begin 13 H.A end
 -2 3627 a -2 3627 a
SDict begin [/View [/XYZ H.V]/Dest (0:1607) cvn /DEST pdfmark end

-2 3627 a -2 3627 a
SDict begin H.S end
 -2 3627 a -2 3627 a
SDict begin 13 H.A end
 -2 3627 a -2
3627 a
SDict begin [/View [/XYZ H.V]/Dest (0:1608) cvn /DEST pdfmark end
 -2 3627 a 396 3734 a Fg(zloop)20 b Fj(of)g(course)g(uses)1132
3734 y
SDict begin H.S end
 1132 3734 a 1132 3734 a
SDict begin 13 H.A end
 1132 3734 a 1132 3734
a
SDict begin [/View [/XYZ H.V]/Dest (0:1609) cvn /DEST pdfmark end
 1132 3734 a Fg(zmq_poll\(\))f Fj(internally)-5 b(.)19
b(It)h(reb)n(uilds)g(its)h(poll)f(set)h(each)f(time)g(you)f(add)h(or)g
(remo)o(v)o(e)396 3842 y(readers,)f(and)h(it)h(calculates)f(the)g(poll)
g(timeout)g(to)g(match)g(the)g(ne)o(xt)f(timer)-5 b(.)21
b(Then,)e(it)i(calls)g(the)f(reader)f(and)h(timer)396
3950 y(handlers)f(for)h(each)g(sock)o(et)g(and)f(timer)h(that)h(needs)e
(attention.)-2 4116 y
SDict begin H.S end
 -2 4116 a -2 4116 a
SDict begin 13 H.A end
 -2 4116 a -2
4116 a
SDict begin [/View [/XYZ H.V]/Dest (0:1610) cvn /DEST pdfmark end
 -2 4116 a 396 4224 a Fj(When)h(we)h(use)f(a)h(reactor)e
(pattern,)g(our)h(code)f(turns)h(inside)g(out.)g(The)f(main)h(logic)g
(looks)g(lik)o(e)g(this:)-2 4325 y
SDict begin H.S end
 -2 4325 a -2 4325
a
SDict begin 11.7 H.A end
 -2 4325 a -2 4325 a
SDict begin [/View [/XYZ H.V]/Dest (0:1611) cvn /DEST pdfmark end
 -2 4325 a 396 4404 a Fg(zloop_t)755
4417 y(*)800 4404 y(reactor)43 b(=)i(zloop_new)e(\(\);)396
4501 y(zloop_reader)g(\(reactor,)g(self->backend,)g(s_handle_backend,)f
(self\);)396 4598 y(zloop_start)h(\(reactor\);)396 4695
y(zloop_destroy)g(\(&reactor\);)p Black 3759 5569 a Fi(112)p
Black eop end
%%Page: 113 127
TeXDict begin 113 126 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.113) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1636) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1612) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(While)21 b(the)f(actual)g(handling)
e(of)i(messages)h(sits)g(inside)f(dedicated)f(functions)g(or)h
(methods.)f(Y)-9 b(ou)19 b(may)h(not)g(lik)o(e)g(the)396
180 y(style,)h(it')-5 b(s)21 b(a)g(matter)e(of)h(taste.)h(What)g(it)f
(does)g(help)g(with)g(is)i(mixing)d(timers)h(and)g(sock)o(et)g(acti)n
(vity)-5 b(.)19 b(In)h(the)g(rest)h(of)e(this)396 288
y(te)o(xt)h(we')o(ll)h(use)862 288 y
SDict begin H.S end
 862 288 a 862 288
a
SDict begin 13 H.A end
 862 288 a 862 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:1613) cvn /DEST pdfmark end
 862 288 a Fg(zmq_poll\(\))e Fj(in)i(simpler)e
(cases,)i(and)2044 288 y
SDict begin H.S end
 2044 288 a 2044 288 a
SDict begin 13 H.A end
 2044 288
a 2044 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:1614) cvn /DEST pdfmark end
 2044 288 a Fg(zloop)f Fj(in)g(more)f(comple)o(x)g(e)o
(xamples.)396 562 y(Here)h(is)h(the)g(LR)m(U)f(queue)f(brok)o(er)g(re)n
(written)g(once)h(again,)f(this)h(time)h(to)f(use)g Fg(zloop)p
Fj(:)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:lruqueue3-php) cvn /DEST pdfmark
end
 -2
580 a 396 764 a Fk(Example)h(3-7.)e(LR)n(U)h(queue)h(br)o(ok)o(er)f
(using)h(zloop)f(\(lruqueue3.php\))-2 864 y
SDict begin H.S end
 -2 864 a
-2 864 a
SDict begin 11.7 H.A end
 -2 864 a -2 864 a
SDict begin [/View [/XYZ H.V]/Dest (0:1619) cvn /DEST pdfmark end
 -2 864 a 396 944 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
1121 y
SDict begin H.S end
 -2 1121 a -2 1121 a
SDict begin 13 H.A end
 -2 1121 a -2 1121 a
SDict begin [/View [/XYZ H.V]/Dest (0:1620) cvn /DEST pdfmark end
 -2 1121
a 396 1218 a Fj(Getting)20 b(applications)f(to)h(properly)e(shut-do)n
(wn)h(when)g(you)h(send)f(them)h(Ctrl-C)h(can)f(be)g(trick)o(y)-5
b(.)19 b(If)h(you)f(use)i(the)396 1326 y
SDict begin H.S end
 396 1326 a 396
1326 a
SDict begin 13 H.A end
 396 1326 a 396 1326 a
SDict begin [/View [/XYZ H.V]/Dest (0:1621) cvn /DEST pdfmark end
 396 1326 a Fg(zctx)f Fj(class)h(it')o(ll)f
(automatically)f(set-up)g(signal)h(handling,)d(b)n(ut)j(your)f(code)g
(still)i(has)f(to)g(cooperate.)e(Y)-9 b(ou)19 b(must)h(break)396
1434 y(an)o(y)g(loop)f(if)776 1434 y
SDict begin H.S end
 776 1434 a 776 1434
a
SDict begin 13 H.A end
 776 1434 a 776 1434 a
SDict begin [/View [/XYZ H.V]/Dest (0:1622) cvn /DEST pdfmark end
 776 1434 a Fg(zmq_poll)g Fj(returns)g(-1)h(or)g
(if)h(an)o(y)e(of)h(the)2009 1434 y
SDict begin H.S end
 2009 1434 a 2009
1434 a
SDict begin 13 H.A end
 2009 1434 a 2009 1434 a
SDict begin [/View [/XYZ H.V]/Dest (0:1623) cvn /DEST pdfmark end
 2009 1434 a Fg(zstr_recv)p
Fj(,)2454 1434 y
SDict begin H.S end
 2454 1434 a 2454 1434 a
SDict begin 13 H.A end
 2454 1434 a
2454 1434 a
SDict begin [/View [/XYZ H.V]/Dest (0:1624) cvn /DEST pdfmark end
 2454 1434 a Fg(zframe_recv)p Fj(,)f(or)3079
1434 y
SDict begin H.S end
 3079 1434 a 3079 1434 a
SDict begin 13 H.A end
 3079 1434 a 3079 1434
a
SDict begin [/View [/XYZ H.V]/Dest (0:1625) cvn /DEST pdfmark end
 3079 1434 a Fg(zmsg_recv)g Fj(methods)396 1542 y(return)g(NULL.)h(If)
g(you)f(ha)n(v)o(e)h(nested)g(loops,)f(it)i(can)f(be)g(useful)g(to)g
(mak)o(e)g(the)g(outer)g(ones)g(conditional)e(on)396
1649 y
SDict begin H.S end
 396 1649 a 396 1649 a
SDict begin 13 H.A end
 396 1649 a 396 1649 a
SDict begin [/View [/XYZ H.V]/Dest (0:1626) cvn /DEST pdfmark end
 396
1649 a Fg(!zctx_interrupted)p Fj(.)-2 1671 y
SDict begin H.S end
 -2 1671
a -2 1671 a
SDict begin 13 H.A end
 -2 1671 a -2 1671 a
SDict begin [/View [/XYZ H.V]/Dest (0:1627) cvn /DEST pdfmark end
 -2 1671 a 366 x Fh(3.8.)39
b(Async)o(hr)m(onous)d(Client-Ser)q(ver)2214 2037 y
SDict begin H.S end
 2214
2037 a 2214 2037 a
SDict begin 22.464 H.A end
 2214 2037 a 2214 2037 a
SDict begin [/View [/XYZ H.V]/Dest (8.38.1) cvn /DEST pdfmark end
 2214 2037
a -2 2233 a
SDict begin H.S end
 -2 2233 a -2 2233 a
SDict begin 13 H.A end
 -2 2233 a -2 2233 a
SDict begin [/View [/XYZ H.V]/Dest (0:1629) cvn /DEST pdfmark end
 -2
2233 a 396 2311 a Fj(In)20 b(the)g(R)m(OUTER-to-DEALER)f(e)o(xample)g
(we)i(sa)o(w)f(a)h(1-to-N)e(use)h(case)h(where)f(one)f(client)h(talks)h
(asynchronously)396 2419 y(to)g(multiple)e(w)o(ork)o(ers.)g(W)-7
b(e)22 b(can)e(turn)f(this)i(upside-do)n(wn)d(to)i(get)g(a)h(v)o(ery)e
(useful)g(N-to-1)h(architecture)e(where)i(v)n(arious)396
2527 y(clients)h(talk)f(to)g(a)h(single)f(serv)o(er)m(,)f(and)h(do)f
(this)i(asynchronously\()p 0 TeXcolorgray 2319 2527 a
SDict begin H.S end

2319 2527 a Fj(Figure)15 b(3-18)2706 2527 y
SDict begin 13 H.L end
 2706 2527
a 2706 2527 a
SDict begin [/Subtype /Link/Dest (0:figure-43) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2706 2527 a Black -1 w Fj(\).)-2 2545 y
SDict begin H.S end

-2 2545 a -2 2545 a
SDict begin 13 H.A end
 -2 2545 a -2 2545 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-43) cvn /DEST pdfmark
end
 -2 2545 a Black
3759 5569 a Fi(113)p Black eop end
%%Page: 114 128
TeXDict begin 114 127 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.114) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-18.)e(Asynchr)o(onous)i
(Client-Ser)o(v)o(er)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172
a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1633) cvn /DEST pdfmark end
 -2 172 a 396 3131 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3131 a @beginspecial
0 @llx -350 @lly 330 @urx 0 @ury 3300 @rwi @setspecial
%%BeginDocument: images/fig43.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -350 330 0
%%HiResBoundingBox: 0.0 -350.0 330.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -92.00029754638672 lineto
148.00030517578125 -92.00029754638672 lineto
148.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -96.00029754638672 moveto
28.00029945373535 -115.00029754638672 lineto
28.00029945373535 -119.66696421305339 29.666966756184895 -122.00029754638672 33.000301361083984 -122.00029754638672 curveto
143.00030517578125 -122.00029754638672 lineto
143.00030517578125 -122.00029754638672 lineto
146.3336385091146 -122.00029754638672 148.00030517578125 -119.66696421305339 148.00030517578125 -115.00029754638672 curveto
148.00030517578125 -96.00029754638672 lineto
148.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
188.00030517578125 -38.000301361083984 moveto
188.00030517578125 -92.00029754638672 lineto
308.00030517578125 -92.00029754638672 lineto
308.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
188.00030517578125 -96.00029754638672 moveto
188.00030517578125 -115.00029754638672 lineto
188.00030517578125 -119.66696421305339 189.6669718424479 -122.00029754638672 193.00030517578125 -122.00029754638672 curveto
303.00030517578125 -122.00029754638672 lineto
303.00030517578125 -122.00029754638672 lineto
306.33363850911456 -122.00029754638672 308.00030517578125 -119.66696421305339 308.00030517578125 -115.00029754638672 curveto
308.00030517578125 -96.00029754638672 lineto
308.00030517578125 -96.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
103.00029754638672 -234.00030517578125 moveto
99.66696421305339 -234.00030517578125 98.00029754638672 -236.3336385091146 98.00029754638672 -241.00030517578125 curveto
98.00029754638672 -260.00030517578125 lineto
238.00030517578125 -260.00030517578125 lineto
238.00030517578125 -241.00030517578125 lineto
238.00030517578125 -236.3336385091146 236.3336385091146 -234.00030517578125 233.00030517578125 -234.00030517578125 curveto
103.00029754638672 -234.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
98.00029754638672 -264.00030517578125 moveto
98.00029754638672 -318.00030517578125 lineto
238.00030517578125 -318.00030517578125 lineto
238.00030517578125 -264.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
145.0 -89.0 lineto
145.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -89.0 lineto
145.0 -89.0 lineto
145.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
140.0 -119.0 lineto
140.0 -119.0 lineto
143.33333333333334 -119.0 145.0 -116.66666666666667 145.0 -112.0 curveto
145.0 -93.0 lineto
145.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -93.0 moveto
25.0 -112.0 lineto
25.0 -116.66666666666667 26.666666666666668 -119.0 30.0 -119.0 curveto
140.0 -119.0 lineto
140.0 -119.0 lineto
143.33333333333334 -119.0 145.0 -116.66666666666667 145.0 -112.0 curveto
145.0 -93.0 lineto
145.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -35.0 moveto
185.0 -89.0 lineto
305.0 -89.0 lineto
305.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -35.0 moveto
185.0 -89.0 lineto
305.0 -89.0 lineto
305.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -93.0 moveto
185.0 -112.0 lineto
185.0 -116.66666666666667 186.66666666666666 -119.0 190.0 -119.0 curveto
300.0 -119.0 lineto
300.0 -119.0 lineto
303.3333333333333 -119.0 305.0 -116.66666666666667 305.0 -112.0 curveto
305.0 -93.0 lineto
305.0 -93.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -93.0 moveto
185.0 -112.0 lineto
185.0 -116.66666666666667 186.66666666666666 -119.0 190.0 -119.0 curveto
300.0 -119.0 lineto
300.0 -119.0 lineto
303.3333333333333 -119.0 305.0 -116.66666666666667 305.0 -112.0 curveto
305.0 -93.0 lineto
305.0 -93.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
100.0 -231.0 moveto
96.66666666666667 -231.0 95.0 -233.33333333333334 95.0 -238.0 curveto
95.0 -257.0 lineto
235.0 -257.0 lineto
235.0 -238.0 lineto
235.0 -233.33333333333334 233.33333333333334 -231.0 230.0 -231.0 curveto
100.0 -231.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
100.0 -231.0 moveto
96.66666666666667 -231.0 95.0 -233.33333333333334 95.0 -238.0 curveto
95.0 -257.0 lineto
235.0 -257.0 lineto
235.0 -238.0 lineto
235.0 -233.33333333333334 233.33333333333334 -231.0 230.0 -231.0 curveto
100.0 -231.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
95.0 -261.0 moveto
95.0 -315.0 lineto
235.0 -315.0 lineto
235.0 -261.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
95.0 -261.0 moveto
95.0 -315.0 lineto
235.0 -315.0 lineto
235.0 -261.0 lineto
closepath
stroke
newpath
85.0 -126.0 moveto
80.0 -140.0 lineto
90.0 -140.0 lineto
closepath
fill
newpath
245.0 -126.0 moveto
240.0 -140.0 lineto
250.0 -140.0 lineto
closepath
fill
newpath
160.0 -210.0 moveto
165.0 -224.0 lineto
170.0 -210.0 lineto
closepath
fill
newpath
85.0 -133.0 moveto
85.0 -175.0 lineto
165.0 -175.0 lineto
stroke
newpath
245.0 -133.0 moveto
245.0 -175.0 lineto
165.0 -175.0 lineto
stroke
newpath
165.0 -217.0 moveto
165.0 -175.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
57.0 -68.0 moveto
(Client) show
217.0 -68.0 moveto
(Client) show
51.0 -110.0 moveto
(DEALER) show
211.0 -110.0 moveto
(DEALER) show
131.0 -250.0 moveto
(ROUTER) show
133.0 -292.0 moveto
(Server) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3131 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3131 a 274 x Fj(Here')-5
b(s)21 b(ho)n(w)e(it)i(w)o(orks:)-2 3406 y
SDict begin H.S end
 -2 3406 a
-2 3406 a
SDict begin 13 H.A end
 -2 3406 a -2 3406 a
SDict begin [/View [/XYZ H.V]/Dest (0:1637) cvn /DEST pdfmark end
 -2 3406 a -2 3416 a
SDict begin H.S end
 -2
3416 a -2 3416 a
SDict begin 13 H.A end
 -2 3416 a -2 3416 a
SDict begin [/View [/XYZ H.V]/Dest (0:1638) cvn /DEST pdfmark end
 -2 3416 a Black
396 3575 a Fe(\225)p Black 479 3575 a
SDict begin H.S end
 479 3575 a 479
3575 a
SDict begin 13 H.A end
 479 3575 a 479 3575 a
SDict begin [/View [/XYZ H.V]/Dest (0:1639) cvn /DEST pdfmark end
 479 3575 a Fj(Clients)g(connect)e(to)i
(the)f(serv)o(er)f(and)h(send)g(requests.)-2 3593 y
SDict begin H.S end
 -2
3593 a -2 3593 a
SDict begin 13 H.A end
 -2 3593 a -2 3593 a
SDict begin [/View [/XYZ H.V]/Dest (0:1640) cvn /DEST pdfmark end
 -2 3593 a Black
396 3724 a Fe(\225)p Black 479 3724 a
SDict begin H.S end
 479 3724 a 479
3724 a
SDict begin 13 H.A end
 479 3724 a 479 3724 a
SDict begin [/View [/XYZ H.V]/Dest (0:1641) cvn /DEST pdfmark end
 479 3724 a Fj(F)o(or)g(each)g(request,)f
(the)h(serv)o(er)g(sends)g(0)g(to)h(N)f(replies.)-2 3742
y
SDict begin H.S end
 -2 3742 a -2 3742 a
SDict begin 13 H.A end
 -2 3742 a -2 3742 a
SDict begin [/View [/XYZ H.V]/Dest (0:1642) cvn /DEST pdfmark end
 -2 3742 a Black
396 3874 a Fe(\225)p Black 479 3874 a
SDict begin H.S end
 479 3874 a 479
3874 a
SDict begin 13 H.A end
 479 3874 a 479 3874 a
SDict begin [/View [/XYZ H.V]/Dest (0:1643) cvn /DEST pdfmark end
 479 3874 a Fj(Clients)h(can)f(send)g
(multiple)g(requests)g(without)f(w)o(aiting)h(for)g(a)g(reply)-5
b(.)-2 3892 y
SDict begin H.S end
 -2 3892 a -2 3892 a
SDict begin 13 H.A end
 -2 3892 a -2 3892 a
SDict begin [/View [/XYZ H.V]/Dest (0:1644) cvn /DEST pdfmark end

-2 3892 a Black 396 4023 a Fe(\225)p Black 479 4023 a
SDict begin H.S end

479 4023 a 479 4023 a
SDict begin 13 H.A end
 479 4023 a 479 4023 a
SDict begin [/View [/XYZ H.V]/Dest (0:1645) cvn /DEST pdfmark end
 479 4023
a Fj(Serv)o(ers)20 b(can)g(send)g(multiple)f(replies)h(without)g(w)o
(aiting)g(for)f(ne)n(w)h(requests.)-2 4207 y
SDict begin H.S end
 -2 4207
a -2 4207 a
SDict begin 13 H.A end
 -2 4207 a -2 4207 a
SDict begin [/View [/XYZ H.V]/Dest (0:1646) cvn /DEST pdfmark end
 -2 4207 a 396 4297 a
Fj(Here')-5 b(s)21 b(code)e(that)h(sho)n(ws)h(ho)n(w)e(this)i(w)o
(orks:)-2 4298 y
SDict begin H.S end
 -2 4298 a -2 4298 a
SDict begin 13 H.A end
 -2 4298 a -2 4298
a
SDict begin [/View [/XYZ H.V]/Dest (0:asyncsrv-php) cvn /DEST pdfmark
end
 -2 4298 a 396 4498 a Fk(Example)g(3-8.)e(Asynchr)o(onous)h
(client-ser)o(v)o(er)f(\(asyncsr)o(v)-6 b(.php\))-2 4598
y
SDict begin H.S end
 -2 4598 a -2 4598 a
SDict begin 11.7 H.A end
 -2 4598 a -2 4598 a
SDict begin [/View [/XYZ H.V]/Dest (0:1649) cvn /DEST pdfmark end
 -2 4598 a 396
4678 a Fg(<?php)396 4776 y(/)441 4789 y(*)441 4886 y(*)531
4873 y(Asynchronous)43 b(client-to-server)f(\(DEALER)h(to)i(ROUTER\))
441 4983 y(*)441 5080 y(*)531 5067 y(While)f(this)g(example)g(runs)g
(in)g(a)h(single)f(process,)f(that)h(is)h(just)f(to)h(make)441
5177 y(*)531 5164 y(it)f(easier)g(to)h(start)f(and)g(stop)g(the)g
(example.)g(Each)g(task)g(has)h(its)f(own)p Black 3759
5569 a Fi(114)p Black eop end
%%Page: 115 129
TeXDict begin 115 128 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.115) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 441 85 a Fg(*)531 72 y(context)43 b(and)i
(conceptually)e(acts)h(as)g(a)h(separate)e(process.)441
183 y(*)531 170 y(@author)g(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 280 y(*)486
267 y(/)396 364 y(include)g("zmsg.php";)396 558 y(/)441
571 y(*)531 558 y(--------------------------------------)o(------)o
(------)o(------)o(------)o(-----)o(--)441 668 y(*)531
655 y(This)g(is)g(our)h(client)f(task)441 765 y(*)531
752 y(It)g(connects)g(to)g(the)h(server,)e(and)i(then)f(sends)g(a)g
(request)g(once)g(per)h(second)441 863 y(*)531 850 y(It)f(collects)g
(responses)f(as)i(they)f(arrive,)f(and)i(it)f(prints)g(them)g(out.)g
(We)h(will)441 960 y(*)531 947 y(run)f(several)g(client)g(tasks)g(in)g
(parallel,)f(each)i(with)f(a)g(different)g(random)f(ID.)441
1057 y(*)486 1044 y(/)396 1141 y(function)h(client_task\(\))e({)441
1238 y($context)i(=)g(new)h(ZMQContext\(\);)441 1335
y($client)f(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_DEALER\);)441
1530 y(//)89 b(Generate)44 b(printable)f(identity)h(for)g(the)g(client)
441 1627 y($identity)f(=)i(sprintf)f(\("\04504X",)f(rand\(0,)h
(0x10000\)\);)441 1724 y($client->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o
(Y,)39 b($identity\);)441 1821 y
($client->connect\("tcp://localhost:5570"\))o(;)441 2015
y($read)44 b(=)h($write)f(=)g(array\(\);)441 2112 y($poll)g(=)h(new)f
(ZMQPoll\(\);)441 2209 y($poll->add\($client,)e(ZMQ::POLL_IN\);)441
2404 y($request_nbr)h(=)i(0;)441 2501 y(while\(true\))e({)486
2598 y(//)89 b(Tick)44 b(once)h(per)f(second,)g(pulling)f(in)i
(arriving)e(messages)486 2695 y(for\($centitick)f(=)j(0;)g($centitick)e
(<)h(100;)h($centitick++\))d({)531 2792 y($events)h(=)i
($poll->poll\($read,)d($write,)i(1000\);)531 2889 y($zmsg)g(=)g(new)h
(Zmsg\($client\);)531 2987 y(if\($events\))e({)576 3084
y($zmsg->recv\(\);)576 3181 y(printf)g(\("\045s:)h(\045s\045s",)g
($identity,)f($zmsg->body\(\),)g(PHP_EOL\);)531 3278
y(})486 3375 y(})486 3472 y($zmsg)h(=)h(new)f(Zmsg\($client\);)486
3569 y($zmsg->body_fmt\("request)d(#\045d",)j
(++$request_nbr\)->send\(\);)441 3666 y(})396 3764 y(})396
3958 y(/)441 3971 y(*)531 3958 y
(--------------------------------------)o(------)o(------)o(------)o
(------)o(-----)o(--)441 4068 y(*)531 4055 y(This)g(is)g(our)h(server)f
(task)441 4165 y(*)531 4152 y(It)g(uses)g(the)h(multithreaded)d(server)
i(model)g(to)h(deal)f(requests)f(out)i(to)f(a)h(pool)441
4262 y(*)531 4249 y(of)f(workers)g(and)g(route)g(replies)g(back)g(to)h
(clients.)e(One)h(worker)g(can)h(handle)441 4359 y(*)531
4346 y(one)f(request)g(at)g(a)h(time)f(but)g(one)h(client)f(can)g(talk)
g(to)h(multiple)e(workers)h(at)441 4457 y(*)531 4444
y(once.)441 4554 y(*)486 4541 y(/)396 4638 y(function)g
(server_task\(\))e({)441 4832 y(//)89 b(Launch)44 b(pool)g(of)h(worker)
f(threads,)f(precise)h(number)g(is)g(not)h(critical)441
4929 y(for\($thread_nbr)d(=)j(0;)g($thread_nbr)e(<)h(5;)h
($thread_nbr++\))d({)486 5026 y($pid)i(=)h(pcntl_fork\(\);)486
5124 y(if\($pid)f(==)g(0\))h({)p Black 3759 5569 a Fi(115)p
Black eop end
%%Page: 116 130
TeXDict begin 116 129 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.116) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 531 72 a Fg(server_worker\(\);)531
170 y(exit\(\);)486 267 y(})441 364 y(})441 558 y($context)44
b(=)g(new)h(ZMQContext\(\);)441 752 y(//)89 b(Frontend)44
b(socket)g(talks)g(to)g(clients)g(over)g(TCP)441 850
y($frontend)f(=)i(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_ROUTER\);)
441 947 y($frontend->bind\("tcp://)1476 960 y(*)1521
947 y(:5570"\);)441 1141 y(//)89 b(Backend)44 b(socket)g(talks)g(to)g
(workers)g(over)g(ipc)441 1238 y($backend)g(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_DEALER\);)441 1335
y($backend->bind\("ipc://backend"\);)441 1530 y(//)89
b(Connect)44 b(backend)g(to)g(frontend)g(via)g(a)h(queue)f(device)441
1627 y(//)89 b(We)45 b(could)f(do)g(this:)441 1724 y(//)269
b($device)43 b(=)i(new)f(ZMQDevice\($frontend,)e($backend\);)441
1821 y(//)89 b(But)45 b(doing)f(it)g(ourselves)g(means)g(we)g(can)g
(debug)g(this)h(more)f(easily)441 2015 y($read)g(=)h($write)f(=)g
(array\(\);)441 2112 y(//)89 b(Switch)44 b(messages)g(between)f
(frontend)h(and)g(backend)441 2209 y(while\(true\))f({)486
2307 y($poll)h(=)h(new)f(ZMQPoll\(\);)486 2404 y
($poll->add\($frontend,)d(ZMQ::POLL_IN\);)486 2501 y
($poll->add\($backend,)g(ZMQ::POLL_IN\);)486 2695 y
($poll->poll\($read,)h($write\);)486 2792 y(foreach\($read)h(as)h
($socket\))g({)531 2889 y($zmsg)g(=)g(new)h(Zmsg\($socket\);)531
2987 y($zmsg->recv\(\);)531 3084 y(if\($socket)e(===)h($frontend\))f({)
576 3181 y(//echo)g("Request)h(from)g(client:";)576 3278
y(//echo)f($zmsg->__toString\(\);)576 3375 y
($zmsg->set_socket\($backend\)->send\(\);)531 3472 y(})h(else)h
(if\($socket)e(===)h($backend\))f({)576 3569 y(//echo)g("Request)h
(from)g(worker:";)576 3666 y(//echo)f($zmsg->__toString\(\);)576
3764 y($zmsg->set_socket\($frontend\)->send\(\);)531
3861 y(})486 3958 y(})441 4055 y(})396 4152 y(})396 4346
y(function)h(server_worker\(\))e({)441 4444 y($context)i(=)g(new)h
(ZMQContext\(\);)441 4541 y($worker)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_DEALER\);)441 4638 y($worker->connect\("ipc://backend"\);)
441 4735 y($zmsg)j(=)h(new)f(Zmsg\($worker\);)441 4929
y(while\(true\))f({)486 5026 y(//)89 b(The)45 b(DEALER)e(socket)h
(gives)g(us)h(the)f(address)g(envelope)f(and)i(message)486
5124 y($zmsg->recv\(\);)p Black 3757 5569 a Fi(116)p
Black eop end
%%Page: 117 131
TeXDict begin 117 130 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.117) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 486 72 a Fg(assert\($zmsg->parts\(\))41
b(==)k(2\);)486 267 y(//)f(Send)h(0..4)f(replies)f(back)486
364 y($replies)g(=)i(rand\(0,4\);)486 461 y(for\($reply)e(=)i(0;)f
($reply)g(<)h($replies;)e($reply++\))g({)531 558 y(//)89
b(Sleep)44 b(for)g(some)h(fraction)e(of)i(a)f(second)531
655 y(usleep\(rand\(0,1000\))d(+)k(1\);)531 752 y
($zmsg->send\(Zmsg::NOCLEAR\);)486 850 y(})441 1044 y(})396
1141 y(})396 1335 y(/)441 1348 y(*)531 1335 y(This)f(main)g(thread)g
(simply)g(starts)g(several)f(clients,)h(and)g(a)h(server,)e(and)i(then)
441 1445 y(*)531 1432 y(waits)f(for)g(the)g(server)g(to)h(finish.)441
1543 y(*)486 1530 y(/)396 1627 y(function)f(main\(\))g({)441
1724 y(for\($num_clients)e(=)j(0;)f($num_clients)f(<)i(3;)f
($num_clients++\))f({)486 1821 y($pid)h(=)h(pcntl_fork\(\);)486
1918 y(if\($pid)f(==)g(0\))h({)531 2015 y(client_task\(\);)531
2112 y(exit\(\);)486 2209 y(})441 2307 y(})441 2501 y($pid)f(=)h
(pcntl_fork\(\);)441 2598 y(if\($pid)f(==)g(0\))h({)486
2695 y(server_task\(\);)486 2792 y(exit\(\);)441 2889
y(})396 3084 y(})396 3278 y(main\(\);)-2 3452 y
SDict begin H.S end
 -2 3452
a -2 3452 a
SDict begin 13 H.A end
 -2 3452 a -2 3452 a
SDict begin [/View [/XYZ H.V]/Dest (0:1650) cvn /DEST pdfmark end
 -2 3452 a 396 3552 a
Fj(Just)21 b(run)f(that)g(e)o(xample)f(by)g(itself.)i(Lik)o(e)f(other)f
(multi-task)h(e)o(xamples,)f(it)i(runs)e(in)i(a)f(single)g(process)g(b)
n(ut)g(each)g(task)396 3660 y(has)h(its)g(o)n(wn)f(conte)o(xt)e(and)i
(conceptually)e(acts)j(as)g(a)f(separate)g(process\()p
0 TeXcolorgray 2506 3660 a
SDict begin H.S end
 2506 3660 a Fj(Figure)e(3-19)2896
3660 y
SDict begin 13 H.L end
 2896 3660 a 2896 3660 a
SDict begin [/Subtype /Link/Dest (0:figure-44) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2896 3660 a Black -1 w
Fj(\).)i(Y)-9 b(ou)19 b(will)i(see)g(three)f(clients)396
3768 y(\(each)g(with)g(a)h(random)d(ID\),)i(printing)f(out)g(the)i
(replies)f(the)o(y)f(get)h(from)g(the)g(serv)o(er)-5
b(.)19 b(Look)g(carefully)g(and)h(you')o(ll)f(see)396
3876 y(each)h(client)g(task)h(gets)f(0)h(or)f(more)f(replies)h(per)g
(request.)-2 4060 y
SDict begin H.S end
 -2 4060 a -2 4060 a
SDict begin 13 H.A end
 -2 4060 a -2
4060 a
SDict begin [/View [/XYZ H.V]/Dest (0:1652) cvn /DEST pdfmark end
 -2 4060 a 396 4150 a Fj(Some)g(comments)f(on)h(this)h(code:)-2
4151 y
SDict begin H.S end
 -2 4151 a -2 4151 a
SDict begin 13 H.A end
 -2 4151 a -2 4151 a
SDict begin [/View [/XYZ H.V]/Dest (0:1653) cvn /DEST pdfmark end
 -2 4151
a -2 4161 a
SDict begin H.S end
 -2 4161 a -2 4161 a
SDict begin 13 H.A end
 -2 4161 a -2 4161 a
SDict begin [/View [/XYZ H.V]/Dest (0:1654) cvn /DEST pdfmark end
 -2
4161 a Black 396 4320 a Fe(\225)p Black 479 4320 a
SDict begin H.S end
 479
4320 a 479 4320 a
SDict begin 13 H.A end
 479 4320 a 479 4320 a
SDict begin [/View [/XYZ H.V]/Dest (0:1655) cvn /DEST pdfmark end
 479 4320 a Fj(The)e(clients)h
(send)f(a)h(request)e(once)h(per)g(second,)f(and)h(get)g(zero)g(or)g
(more)g(replies)g(back.)f(T)-7 b(o)20 b(mak)o(e)f(this)h(w)o(ork)e
(using)479 4428 y
SDict begin H.S end
 479 4428 a 479 4428 a
SDict begin 13 H.A end
 479 4428 a 479
4428 a
SDict begin [/View [/XYZ H.V]/Dest (0:1656) cvn /DEST pdfmark end
 479 4428 a Fg(zmq_poll\(\))p Fj(,)h(we)i(can')o(t)e(simply)h
(poll)g(with)g(a)h(1-second)d(timeout,)h(or)h(we')l(d)g(end)f(up)h
(sending)f(a)i(ne)n(w)f(request)479 4536 y(only)g(one)f(second)1040
4536 y
SDict begin H.S end
 1040 4536 a 1040 4536 a
SDict begin 13 H.A end
 1040 4536 a 1040 4536
a
SDict begin [/View [/XYZ H.V]/Dest (0:1657) cvn /DEST pdfmark end
 1040 4536 a Fi(after)h(we)h(r)m(eceived)f(the)g(last)h(r)m(eply)p
Fj(.)f(So)g(we)h(poll)f(at)h(a)f(high)g(frequenc)o(y)d(\(100)i(times)i
(at)f(1/100th)479 4644 y(of)g(a)h(second)e(per)h(poll\),)f(which)h(is)h
(approximately)c(accurate.)i(This)i(means)f(the)g(serv)o(er)f(could)g
(use)i(requests)f(as)h(a)479 4752 y(form)e(of)h(heartbeat,)f(i.e.)h
(detecting)f(when)h(clients)h(are)f(present)f(or)h(disconnected.)-2
4770 y
SDict begin H.S end
 -2 4770 a -2 4770 a
SDict begin 13 H.A end
 -2 4770 a -2 4770 a
SDict begin [/View [/XYZ H.V]/Dest (0:1658) cvn /DEST pdfmark end
 -2 4770
a Black 396 4901 a Fe(\225)p Black 479 4901 a
SDict begin H.S end
 479 4901
a 479 4901 a
SDict begin 13 H.A end
 479 4901 a 479 4901 a
SDict begin [/View [/XYZ H.V]/Dest (0:1659) cvn /DEST pdfmark end
 479 4901 a Fj(The)g(serv)o(er)f
(uses)h(a)g(pool)f(of)g(w)o(ork)o(er)g(threads,)g(each)g(processing)g
(one)g(request)g(synchronously)-5 b(.)16 b(It)k(connects)f(these)479
5009 y(to)i(its)g(frontend)d(sock)o(et)i(using)g(an)g(internal)f
(queue.)g(It)h(connects)g(the)g(frontend)e(and)h(back)o(end)g(sock)o
(ets)h(using)g(a)479 5117 y
SDict begin H.S end
 479 5117 a 479 5117 a
SDict begin 13 H.A end
 479
5117 a 479 5117 a
SDict begin [/View [/XYZ H.V]/Dest (0:1660) cvn /DEST pdfmark end
 479 5117 a Fg(zmq_proxy\(\))f Fj(call.)-2
5129 y
SDict begin H.S end
 -2 5129 a -2 5129 a
SDict begin 13 H.A end
 -2 5129 a -2 5129 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-44) cvn /DEST pdfmark
end
 -2 5129
a Black 3756 5569 a Fi(117)p Black eop end
%%Page: 118 132
TeXDict begin 118 131 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.118) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-19.)e(Detail)i(of)g
(Asynchr)o(onous)g(Ser)o(v)o(er)-2 172 y
SDict begin H.S end
 -2 172 a -2
172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1663) cvn /DEST pdfmark end
 -2 172 a 396 4156 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4156
a @beginspecial 0 @llx -473 @lly 408 @urx 0 @ury 4080
@rwi @setspecial
%%BeginDocument: images/fig44.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -473 408 0
%%HiResBoundingBox: 0.0 -473.0 408.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
54.40024185180664 -29.400239944458008 moveto
54.40024185180664 -71.40023803710938 lineto
134.40023803710938 -71.40023803710938 lineto
134.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
54.40024185180664 -74.40023803710938 moveto
54.40024185180664 -90.40023803710938 lineto
54.40024185180664 -93.7335713704427 55.733575185139976 -95.40023803710938 58.40024185180664 -95.40023803710938 curveto
130.40023803710938 -95.40023803710938 lineto
130.40023803710938 -95.40023803710938 lineto
133.06690470377603 -95.40023803710938 134.40023803710938 -93.7335713704427 134.40023803710938 -90.40023803710938 curveto
134.40023803710938 -75.00023651123047 lineto
134.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
166.40023803710938 -29.400239944458008 moveto
166.40023803710938 -71.40023803710938 lineto
246.40023803710938 -71.40023803710938 lineto
246.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
166.40023803710938 -74.40023803710938 moveto
166.40023803710938 -90.40023803710938 lineto
166.40023803710938 -93.7335713704427 167.73357137044272 -95.40023803710938 170.40023803710938 -95.40023803710938 curveto
242.40023803710938 -95.40023803710938 lineto
242.40023803710938 -95.40023803710938 lineto
245.06690470377603 -95.40023803710938 246.40023803710938 -93.7335713704427 246.40023803710938 -90.40023803710938 curveto
246.40023803710938 -75.00023651123047 lineto
246.40023803710938 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -29.400239944458008 moveto
278.4002380371094 -71.40023803710938 lineto
358.4002380371094 -71.40023803710938 lineto
358.4002380371094 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -74.40023803710938 moveto
278.4002380371094 -90.40023803710938 lineto
278.4002380371094 -93.7335713704427 279.7335713704427 -95.40023803710938 282.4002380371094 -95.40023803710938 curveto
354.4002380371094 -95.40023803710938 lineto
354.4002380371094 -95.40023803710938 lineto
357.06690470377606 -95.40023803710938 358.4002380371094 -93.7335713704427 358.4002380371094 -90.40023803710938 curveto
358.4002380371094 -75.00023651123047 lineto
358.4002380371094 -74.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
162.40023803710938 -194.40023803710938 moveto
159.73357137044272 -194.40023803710938 158.40023803710938 -196.40023803710938 158.40023803710938 -200.40023803710938 curveto
158.40023803710938 -214.40023803710938 lineto
254.40023803710938 -214.40023803710938 lineto
254.40023803710938 -200.40023803710938 lineto
254.40023803710938 -196.40023803710938 253.06690470377603 -194.40023803710938 250.40023803710938 -194.40023803710938 curveto
162.40023803710938 -194.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -217.40023803710938 moveto
158.40023803710938 -258.4002380371094 lineto
254.40023803710938 -258.4002380371094 lineto
254.40023803710938 -217.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
158.40023803710938 -261.4002380371094 moveto
158.40023803710938 -277.4002380371094 lineto
158.40023803710938 -280.7335713704427 159.73357137044272 -282.4002380371094 162.40023803710938 -282.4002380371094 curveto
250.40023803710938 -282.4002380371094 lineto
250.40023803710938 -282.4002380371094 lineto
253.06690470377603 -282.4002380371094 254.40023803710938 -280.7335713704427 254.40023803710938 -277.4002380371094 curveto
254.40023803710938 -262.000244140625 lineto
254.40023803710938 -261.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
58.40024185180664 -359.4002380371094 moveto
55.733575185139976 -359.4002380371094 54.40024185180664 -361.4002380371094 54.40024185180664 -365.4002380371094 curveto
54.40024185180664 -379.4002380371094 lineto
134.40023803710938 -379.4002380371094 lineto
134.40023803710938 -365.4002380371094 lineto
134.40023803710938 -361.4002380371094 133.06690470377603 -359.4002380371094 130.40023803710938 -359.4002380371094 curveto
58.40024185180664 -359.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
54.40024185180664 -382.4002380371094 moveto
54.40024185180664 -425.4002380371094 lineto
134.40023803710938 -425.4002380371094 lineto
134.40023803710938 -382.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
170.40023803710938 -359.4002380371094 moveto
167.73357137044272 -359.4002380371094 166.40023803710938 -361.4002380371094 166.40023803710938 -365.4002380371094 curveto
166.40023803710938 -379.4002380371094 lineto
246.40023803710938 -379.4002380371094 lineto
246.40023803710938 -365.4002380371094 lineto
246.40023803710938 -361.4002380371094 245.06690470377603 -359.4002380371094 242.40023803710938 -359.4002380371094 curveto
170.40023803710938 -359.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
166.40023803710938 -382.4002380371094 moveto
166.40023803710938 -425.4002380371094 lineto
246.40023803710938 -425.4002380371094 lineto
246.40023803710938 -382.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -359.4002380371094 moveto
279.7335713704427 -359.4002380371094 278.4002380371094 -361.4002380371094 278.4002380371094 -365.4002380371094 curveto
278.4002380371094 -379.4002380371094 lineto
358.4002380371094 -379.4002380371094 lineto
358.4002380371094 -365.4002380371094 lineto
358.4002380371094 -361.4002380371094 357.06690470377606 -359.4002380371094 354.4002380371094 -359.4002380371094 curveto
282.4002380371094 -359.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -382.4002380371094 moveto
278.4002380371094 -425.4002380371094 lineto
358.4002380371094 -425.4002380371094 lineto
358.4002380371094 -382.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
52.0 -27.0 moveto
52.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
52.0 -27.0 moveto
52.0 -69.0 lineto
132.0 -69.0 lineto
132.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
52.0 -72.0 moveto
52.0 -88.0 lineto
52.0 -91.33333333333333 53.333333333333336 -93.0 56.0 -93.0 curveto
128.0 -93.0 lineto
128.0 -93.0 lineto
130.66666666666666 -93.0 132.0 -91.33333333333333 132.0 -88.0 curveto
132.0 -72.5999984741211 lineto
132.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
52.0 -72.0 moveto
52.0 -88.0 lineto
52.0 -91.33333333333333 53.333333333333336 -93.0 56.0 -93.0 curveto
128.0 -93.0 lineto
128.0 -93.0 lineto
130.66666666666666 -93.0 132.0 -91.33333333333333 132.0 -88.0 curveto
132.0 -72.5999984741211 lineto
132.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
164.0 -27.0 moveto
164.0 -69.0 lineto
244.0 -69.0 lineto
244.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
164.0 -27.0 moveto
164.0 -69.0 lineto
244.0 -69.0 lineto
244.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
164.0 -72.0 moveto
164.0 -88.0 lineto
164.0 -91.33333333333333 165.33333333333334 -93.0 168.0 -93.0 curveto
240.0 -93.0 lineto
240.0 -93.0 lineto
242.66666666666666 -93.0 244.0 -91.33333333333333 244.0 -88.0 curveto
244.0 -72.5999984741211 lineto
244.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
164.0 -72.0 moveto
164.0 -88.0 lineto
164.0 -91.33333333333333 165.33333333333334 -93.0 168.0 -93.0 curveto
240.0 -93.0 lineto
240.0 -93.0 lineto
242.66666666666666 -93.0 244.0 -91.33333333333333 244.0 -88.0 curveto
244.0 -72.5999984741211 lineto
244.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -27.0 moveto
276.0 -69.0 lineto
356.0 -69.0 lineto
356.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -27.0 moveto
276.0 -69.0 lineto
356.0 -69.0 lineto
356.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -72.0 moveto
276.0 -88.0 lineto
276.0 -91.33333333333333 277.3333333333333 -93.0 280.0 -93.0 curveto
352.0 -93.0 lineto
352.0 -93.0 lineto
354.6666666666667 -93.0 356.0 -91.33333333333333 356.0 -88.0 curveto
356.0 -72.5999984741211 lineto
356.0 -72.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -72.0 moveto
276.0 -88.0 lineto
276.0 -91.33333333333333 277.3333333333333 -93.0 280.0 -93.0 curveto
352.0 -93.0 lineto
352.0 -93.0 lineto
354.6666666666667 -93.0 356.0 -91.33333333333333 356.0 -88.0 curveto
356.0 -72.5999984741211 lineto
356.0 -72.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -192.0 moveto
157.33333333333334 -192.0 156.0 -194.0 156.0 -198.0 curveto
156.0 -212.0 lineto
252.0 -212.0 lineto
252.0 -198.0 lineto
252.0 -194.0 250.66666666666666 -192.0 248.0 -192.0 curveto
160.0 -192.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -192.0 moveto
157.33333333333334 -192.0 156.0 -194.0 156.0 -198.0 curveto
156.0 -212.0 lineto
252.0 -212.0 lineto
252.0 -198.0 lineto
252.0 -194.0 250.66666666666666 -192.0 248.0 -192.0 curveto
160.0 -192.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -215.0 moveto
156.0 -256.0 lineto
252.0 -256.0 lineto
252.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -215.0 moveto
156.0 -256.0 lineto
252.0 -256.0 lineto
252.0 -215.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
156.0 -259.0 moveto
156.0 -275.0 lineto
156.0 -278.3333333333333 157.33333333333334 -280.0 160.0 -280.0 curveto
248.0 -280.0 lineto
248.0 -280.0 lineto
250.66666666666666 -280.0 252.0 -278.3333333333333 252.0 -275.0 curveto
252.0 -259.6000061035156 lineto
252.0 -259.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
156.0 -259.0 moveto
156.0 -275.0 lineto
156.0 -278.3333333333333 157.33333333333334 -280.0 160.0 -280.0 curveto
248.0 -280.0 lineto
248.0 -280.0 lineto
250.66666666666666 -280.0 252.0 -278.3333333333333 252.0 -275.0 curveto
252.0 -259.6000061035156 lineto
252.0 -259.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
56.0 -357.0 moveto
53.333333333333336 -357.0 52.0 -359.0 52.0 -363.0 curveto
52.0 -377.0 lineto
132.0 -377.0 lineto
132.0 -363.0 lineto
132.0 -359.0 130.66666666666666 -357.0 128.0 -357.0 curveto
56.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
56.0 -357.0 moveto
53.333333333333336 -357.0 52.0 -359.0 52.0 -363.0 curveto
52.0 -377.0 lineto
132.0 -377.0 lineto
132.0 -363.0 lineto
132.0 -359.0 130.66666666666666 -357.0 128.0 -357.0 curveto
56.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
52.0 -380.0 moveto
52.0 -423.0 lineto
132.0 -423.0 lineto
132.0 -380.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
52.0 -380.0 moveto
52.0 -423.0 lineto
132.0 -423.0 lineto
132.0 -380.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
168.0 -357.0 moveto
165.33333333333334 -357.0 164.0 -359.0 164.0 -363.0 curveto
164.0 -377.0 lineto
244.0 -377.0 lineto
244.0 -363.0 lineto
244.0 -359.0 242.66666666666666 -357.0 240.0 -357.0 curveto
168.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
168.0 -357.0 moveto
165.33333333333334 -357.0 164.0 -359.0 164.0 -363.0 curveto
164.0 -377.0 lineto
244.0 -377.0 lineto
244.0 -363.0 lineto
244.0 -359.0 242.66666666666666 -357.0 240.0 -357.0 curveto
168.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
164.0 -380.0 moveto
164.0 -423.0 lineto
244.0 -423.0 lineto
244.0 -380.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
164.0 -380.0 moveto
164.0 -423.0 lineto
244.0 -423.0 lineto
244.0 -380.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -357.0 moveto
277.3333333333333 -357.0 276.0 -359.0 276.0 -363.0 curveto
276.0 -377.0 lineto
356.0 -377.0 lineto
356.0 -363.0 lineto
356.0 -359.0 354.6666666666667 -357.0 352.0 -357.0 curveto
280.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -357.0 moveto
277.3333333333333 -357.0 276.0 -359.0 276.0 -363.0 curveto
276.0 -377.0 lineto
356.0 -377.0 lineto
356.0 -363.0 lineto
356.0 -359.0 354.6666666666667 -357.0 352.0 -357.0 curveto
280.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -380.0 moveto
276.0 -423.0 lineto
356.0 -423.0 lineto
356.0 -380.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -380.0 moveto
276.0 -423.0 lineto
356.0 -423.0 lineto
356.0 -380.0 lineto
closepath
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
200.0 -159.0 moveto
24.0 -159.0 lineto
21.333333333333332 -159.0 20.0 -161.0 20.0 -165.0 curveto
20.0 -440.0 lineto
20.0 -440.0 lineto
20.0 -443.3333333333333 21.333333333333332 -445.0 24.0 -445.0 curveto
384.0 -445.0 lineto
384.0 -445.0 lineto
386.6666666666667 -445.0 388.0 -443.3333333333333 388.0 -440.0 curveto
388.0 -165.0 lineto
388.0 -165.0 lineto
388.0 -161.0 386.6666666666667 -159.0 384.0 -159.0 curveto
208.0 -159.0 lineto
208.0 -159.0 lineto
stroke
newpath
200.0 -165.0 moveto
204.0 -176.0 lineto
208.0 -165.0 lineto
closepath
fill
newpath
88.0 -330.0 moveto
92.0 -341.0 lineto
96.0 -330.0 lineto
closepath
fill
newpath
200.0 -330.0 moveto
204.0 -341.0 lineto
208.0 -330.0 lineto
closepath
fill
newpath
312.0 -330.0 moveto
316.0 -341.0 lineto
320.0 -330.0 lineto
closepath
fill
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
92.0 -115.0 moveto
92.0 -137.0 lineto
204.0 -137.0 lineto
stroke
newpath
204.0 -115.0 moveto
204.0 -137.0 lineto
stroke
newpath
316.0 -115.0 moveto
316.0 -137.0 lineto
204.0 -137.0 lineto
stroke
newpath
204.0 -170.0 moveto
204.0 -137.0 lineto
stroke
newpath
204.0 -302.0 moveto
204.0 -313.0 lineto
stroke
newpath
92.0 -335.0 moveto
92.0 -313.0 lineto
204.0 -313.0 lineto
stroke
newpath
204.0 -335.0 moveto
204.0 -313.0 lineto
stroke
newpath
316.0 -335.0 moveto
316.0 -313.0 lineto
204.0 -313.0 lineto
stroke
/Helvetica findfont
11 scalefont setfont
69.0 -54.0 moveto
(Client) show
181.0 -54.0 moveto
(Client) show
293.0 -54.0 moveto
(Client) show
64.0 -87.0 moveto
(DEALER) show
176.0 -87.0 moveto
(DEALER) show
288.0 -87.0 moveto
(DEALER) show
67.0 -109.0 moveto
(connect) show
179.0 -109.0 moveto
(connect) show
291.0 -109.0 moveto
(connect) show
186.0 -186.0 moveto
(bind) show
178.0 -208.0 moveto
(ROUTER) show
180.0 -241.0 moveto
(Server) show
176.0 -274.0 moveto
(DEALER) show
186.0 -296.0 moveto
(bind) show
67.0 -351.0 moveto
(connect) show
179.0 -351.0 moveto
(connect) show
291.0 -351.0 moveto
(connect) show
64.0 -373.0 moveto
(DEALER) show
176.0 -373.0 moveto
(DEALER) show
288.0 -373.0 moveto
(DEALER) show
65.0 -406.0 moveto
(Worker) show
177.0 -406.0 moveto
(Worker) show
289.0 -406.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4156 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4156 a -2 4322 a
SDict begin H.S end
 -2 4322
a -2 4322 a
SDict begin 13 H.A end
 -2 4322 a -2 4322 a
SDict begin [/View [/XYZ H.V]/Dest (0:1666) cvn /DEST pdfmark end
 -2 4322 a 396 4430 a
Fj(Note)g(that)h(we')l(re)e(doing)g(a)i(DEALER-to-R)m(OUTER)e(dialog)g
(between)g(client)i(and)e(serv)o(er)m(,)g(b)n(ut)h(internally)f
(between)396 4537 y(the)h(serv)o(er)g(main)g(thread)f(and)g(w)o(ork)o
(ers)h(we')l(re)g(doing)e(DEALER-to-DEALER.)h(If)h(the)g(w)o(ork)o(ers)
f(were)i(strictly)396 4645 y(synchronous,)c(we')l(d)j(use)g(REP)-9
b(.)21 b(But)g(since)f(we)h(w)o(ant)f(to)g(send)g(multiple)g(replies)g
(we)g(need)g(an)g(async)g(sock)o(et.)g(W)-7 b(e)21 b(do)396
4753 y
SDict begin H.S end
 396 4753 a 396 4753 a
SDict begin 13 H.A end
 396 4753 a 396 4753 a
SDict begin [/View [/XYZ H.V]/Dest (0:1667) cvn /DEST pdfmark end
 396
4753 a Fi(not)h Fj(w)o(ant)e(to)g(route)g(replies,)f(the)o(y)h(al)o(w)o
(ays)h(go)e(to)i(the)f(single)g(serv)o(er)f(thread)h(that)g(sent)g(us)h
(the)f(request.)-2 4937 y
SDict begin H.S end
 -2 4937 a -2 4937 a
SDict begin 13 H.A end
 -2 4937
a -2 4937 a
SDict begin [/View [/XYZ H.V]/Dest (0:1668) cvn /DEST pdfmark end
 -2 4937 a 396 5027 a Fj(Let')-5 b(s)21 b(think)f(about)f
(the)h(routing)f(en)m(v)o(elope.)e(The)j(client)g(sends)h(a)f(simple)g
(message.)g(The)g(serv)o(er)f(thread)g(recei)n(v)o(es)h(a)396
5135 y(tw)o(o-part)f(message)h(\(real)g(message)g(pre\002x)o(ed)f(by)h
(client)g(identity\).)f(W)-7 b(e)21 b(ha)n(v)o(e)f(tw)o(o)g(possible)g
(designs)g(for)f(the)p Black 3759 5569 a Fi(118)p Black
eop end
%%Page: 119 133
TeXDict begin 119 132 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.119) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fj(serv)o(er)n(-to-w)o(ork)o(er)17
b(interf)o(ace:)-2 73 y
SDict begin H.S end
 -2 73 a -2 73 a
SDict begin 13 H.A end
 -2 73 a -2 73
a
SDict begin [/View [/XYZ H.V]/Dest (0:1669) cvn /DEST pdfmark end
 -2 73 a -2 83 a
SDict begin H.S end
 -2 83 a -2 83 a
SDict begin 13 H.A end
 -2 83 a -2 83 a
SDict begin [/View [/XYZ H.V]/Dest (0:1670) cvn /DEST pdfmark end
 -2
83 a Black 396 243 a Fe(\225)p Black 479 243 a
SDict begin H.S end
 479 243
a 479 243 a
SDict begin 13 H.A end
 479 243 a 479 243 a
SDict begin [/View [/XYZ H.V]/Dest (0:1671) cvn /DEST pdfmark end
 479 243 a Fj(W)-7 b(ork)o(ers)20
b(get)h(unaddressed)d(messages,)i(and)f(we)i(manage)e(the)h
(connections)f(from)g(serv)o(er)g(thread)g(to)i(w)o(ork)o(er)479
351 y(threads)f(e)o(xplicitly)f(using)h(a)g(R)m(OUTER)h(sock)o(et)f(as)
h(back)o(end.)d(This)i(w)o(ould)g(require)f(that)h(w)o(ork)o(ers)g
(start)g(by)g(telling)479 459 y(the)g(serv)o(er)g(the)o(y)f(e)o(xist,)h
(which)g(can)g(then)g(route)f(requests)h(to)g(w)o(ork)o(ers)g(and)f
(track)h(which)g(client)g(is)h('connected')d(to)479 566
y(which)i(w)o(ork)o(er)-5 b(.)19 b(This)i(is)g(the)f(LR)m(U)h(pattern)e
(we)h(already)f(co)o(v)o(ered.)-2 584 y
SDict begin H.S end
 -2 584 a -2 584
a
SDict begin 13 H.A end
 -2 584 a -2 584 a
SDict begin [/View [/XYZ H.V]/Dest (0:1672) cvn /DEST pdfmark end
 -2 584 a Black 396 716 a Fe(\225)p
Black 479 716 a
SDict begin H.S end
 479 716 a 479 716 a
SDict begin 13 H.A end
 479 716 a 479 716
a
SDict begin [/View [/XYZ H.V]/Dest (0:1673) cvn /DEST pdfmark end
 479 716 a Fj(W)-7 b(ork)o(ers)20 b(get)h(addressed)e(messages,)h(and)
f(the)o(y)h(return)f(addressed)g(replies.)h(This)g(requires)f(that)i(w)
o(ork)o(ers)e(can)479 824 y(properly)f(decode)h(and)h(recode)f(en)m(v)o
(elopes)f(b)n(ut)i(it)h(doesn')o(t)e(need)g(an)o(y)h(other)f
(mechanisms.)-2 1008 y
SDict begin H.S end
 -2 1008 a -2 1008 a
SDict begin 13 H.A end
 -2 1008 a
-2 1008 a
SDict begin [/View [/XYZ H.V]/Dest (0:1674) cvn /DEST pdfmark end
 -2 1008 a 396 1098 a Fj(The)h(second)f(design)h(is)h(much)e
(simpler)m(,)h(so)g(that')-5 b(s)21 b(what)f(we)g(use:)-2
1199 y
SDict begin H.S end
 -2 1199 a -2 1199 a
SDict begin 11.7 H.A end
 -2 1199 a -2 1199 a
SDict begin [/View [/XYZ H.V]/Dest (0:1675) cvn /DEST pdfmark end
 -2 1199
a 620 1278 a Fg(client)448 b(server)313 b(frontend)f(worker)531
1375 y([)44 b(DEALER)g(]<---->[)g(ROUTER)g(<---->)f(DEALER)h(<---->)g
(DEALER)g(])979 1472 y(1)h(part)403 b(2)44 b(parts)313
b(2)45 b(parts)-2 1650 y
SDict begin H.S end
 -2 1650 a -2 1650 a
SDict begin 13 H.A end
 -2 1650
a -2 1650 a
SDict begin [/View [/XYZ H.V]/Dest (0:1676) cvn /DEST pdfmark end
 -2 1650 a 396 1746 a Fj(When)20 b(you)g(b)n(uild)f(serv)o
(ers)h(that)g(maintain)g(stateful)g(con)m(v)o(ersations)d(with)k
(clients,)f(you)f(will)i(run)f(into)g(a)g(classic)396
1854 y(problem.)e(If)j(the)f(serv)o(er)f(k)o(eeps)h(some)g(state)h(per)
f(client,)g(and)f(clients)i(k)o(eep)f(coming)e(and)i(going,)f(e)n(v)o
(entually)f(it)j(will)396 1962 y(run)f(out)g(of)f(resources.)g(Ev)o(en)
h(if)g(the)g(same)h(clients)f(k)o(eep)g(connecting,)e(if)i(you')l(re)e
(using)i(def)o(ault)g(identities,)f(each)396 2070 y(connection)f(will)j
(look)f(lik)o(e)g(a)h(ne)n(w)f(one.)-2 2237 y
SDict begin H.S end
 -2 2237
a -2 2237 a
SDict begin 13 H.A end
 -2 2237 a -2 2237 a
SDict begin [/View [/XYZ H.V]/Dest (0:1677) cvn /DEST pdfmark end
 -2 2237 a 396 2344 a
Fj(W)-7 b(e)22 b(cheat)e(in)g(the)g(abo)o(v)o(e)f(e)o(xample)f(by)i(k)o
(eeping)f(state)i(only)e(for)h(a)g(v)o(ery)f(short)h(time)h(\(the)e
(time)i(it)g(tak)o(es)f(a)h(w)o(ork)o(er)e(to)396 2452
y(process)h(a)h(request\))e(and)g(then)h(thro)n(wing)f(a)o(w)o(ay)g
(the)i(state.)f(But)h(that')-5 b(s)21 b(not)f(practical)f(for)h(man)o
(y)f(cases.)h(T)-7 b(o)21 b(properly)396 2560 y(manage)e(client)h
(state)h(in)g(a)f(stateful)h(asynchronous)c(serv)o(er)i(you)g(ha)n(v)o
(e)h(to:)-2 2578 y
SDict begin H.S end
 -2 2578 a -2 2578 a
SDict begin 13 H.A end
 -2 2578 a -2 2578
a
SDict begin [/View [/XYZ H.V]/Dest (0:1678) cvn /DEST pdfmark end
 -2 2578 a -2 2588 a
SDict begin H.S end
 -2 2588 a -2 2588 a
SDict begin 13 H.A end
 -2 2588 a -2
2588 a
SDict begin [/View [/XYZ H.V]/Dest (0:1679) cvn /DEST pdfmark end
 -2 2588 a Black 396 2730 a Fe(\225)p Black 479
2730 a
SDict begin H.S end
 479 2730 a 479 2730 a
SDict begin 13 H.A end
 479 2730 a 479 2730 a
SDict begin [/View [/XYZ H.V]/Dest (0:1680) cvn /DEST pdfmark end
 479
2730 a Fj(Do)g(heartbeating)f(from)g(client)h(to)g(serv)o(er)-5
b(.)20 b(In)g(our)f(e)o(xample)g(we)i(send)e(a)i(request)f(once)f(per)h
(second,)f(which)h(can)479 2838 y(reliably)g(be)g(used)g(as)h(a)f
(heartbeat.)-2 2856 y
SDict begin H.S end
 -2 2856 a -2 2856 a
SDict begin 13 H.A end
 -2 2856 a -2
2856 a
SDict begin [/View [/XYZ H.V]/Dest (0:1681) cvn /DEST pdfmark end
 -2 2856 a Black 396 2987 a Fe(\225)p Black 479
2987 a
SDict begin H.S end
 479 2987 a 479 2987 a
SDict begin 13 H.A end
 479 2987 a 479 2987 a
SDict begin [/View [/XYZ H.V]/Dest (0:1682) cvn /DEST pdfmark end
 479
2987 a Fj(Store)g(state)h(using)f(the)g(client)g(identity)g(\(whether)f
(generated)f(or)i(e)o(xplicit\))f(as)i(k)o(e)o(y)-5 b(.)-2
3005 y
SDict begin H.S end
 -2 3005 a -2 3005 a
SDict begin 13 H.A end
 -2 3005 a -2 3005 a
SDict begin [/View [/XYZ H.V]/Dest (0:1683) cvn /DEST pdfmark end
 -2 3005
a Black 396 3137 a Fe(\225)p Black 479 3137 a
SDict begin H.S end
 479 3137
a 479 3137 a
SDict begin 13 H.A end
 479 3137 a 479 3137 a
SDict begin [/View [/XYZ H.V]/Dest (0:1684) cvn /DEST pdfmark end
 479 3137 a Fj(Detect)21
b(a)f(stopped)f(heartbeat.)g(If)h(there')-5 b(s)20 b(no)g(request)g
(from)f(a)h(client)h(within,)e(say)-5 b(,)20 b(tw)o(o)h(seconds,)e(the)
h(serv)o(er)f(can)479 3245 y(detect)h(this)h(and)f(destro)o(y)f(an)o(y)
g(state)i(it')-5 b(s)22 b(holding)c(for)i(that)g(client.)-2
3304 y
SDict begin H.S end
 -2 3304 a -2 3304 a
SDict begin 13 H.A end
 -2 3304 a -2 3304 a
SDict begin [/View [/XYZ H.V]/Dest (0:1685) cvn /DEST pdfmark end
 -2 3304
a 359 x Fh(3.9.)39 b(W)-9 b(orked)39 b(Example:)f(Inter)m(-Br)m(oker)f
(Routing)2911 3663 y
SDict begin H.S end
 2911 3663 a 2911 3663 a
SDict begin 22.464 H.A end
 2911 3663
a 2911 3663 a
SDict begin [/View [/XYZ H.V]/Dest (8.39.1) cvn /DEST pdfmark end
 2911 3663 a -2 3861 a
SDict begin H.S end
 -2 3861 a -2 3861
a
SDict begin 13 H.A end
 -2 3861 a -2 3861 a
SDict begin [/View [/XYZ H.V]/Dest (0:1687) cvn /DEST pdfmark end
 -2 3861 a 396 3937 a Fj(Let')-5
b(s)21 b(tak)o(e)f(e)n(v)o(erything)e(we')l(v)o(e)h(seen)h(so)h(f)o(ar)
m(,)e(and)h(scale)h(things)e(up.)h(Our)g(best)g(client)h(calls)f(us)h
(ur)o(gently)d(and)i(asks)g(for)396 4045 y(a)h(design)e(of)h(a)h(lar)o
(ge)e(cloud)g(computing)f(f)o(acility)-5 b(.)20 b(He)g(has)h(this)f
(vision)g(of)g(a)h(cloud)e(that)h(spans)g(man)o(y)f(data)i(centers,)396
4153 y(each)f(a)h(cluster)f(of)g(clients)g(and)g(w)o(ork)o(ers,)f(and)h
(that)g(w)o(orks)g(together)f(as)i(a)f(whole.)-2 4337
y
SDict begin H.S end
 -2 4337 a -2 4337 a
SDict begin 13 H.A end
 -2 4337 a -2 4337 a
SDict begin [/View [/XYZ H.V]/Dest (0:1688) cvn /DEST pdfmark end
 -2 4337 a 396
4427 a Fj(Because)h(we')l(re)e(smart)h(enough)f(to)h(kno)n(w)f(that)h
(practice)g(al)o(w)o(ays)h(beats)f(theory)-5 b(,)18 b(we)j(propose)d
(to)j(mak)o(e)e(a)i(w)o(orking)396 4535 y(simulation)f(using)f(\330MQ.)
h(Our)g(client,)g(eager)g(to)g(lock)g(do)n(wn)f(the)h(b)n(udget)f
(before)g(his)i(o)n(wn)e(boss)i(changes)e(his)i(mind,)396
4643 y(and)f(ha)n(ving)f(read)h(great)f(things)h(about)f(\330MQ)i(on)f
(T)-7 b(witter)m(,)19 b(agrees.)-2 4661 y
SDict begin H.S end
 -2 4661 a -2
4661 a
SDict begin 13 H.A end
 -2 4661 a -2 4661 a
SDict begin [/View [/XYZ H.V]/Dest (0:1689) cvn /DEST pdfmark end
 -2 4661 a Black 3759 5569
a Fi(119)p Black eop end
%%Page: 120 134
TeXDict begin 120 133 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.120) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 77 a Fd(3.9.1.)36 b(Estab)o(lishing)e(the)g
(Details)2074 77 y
SDict begin H.S end
 2074 77 a 2074 77 a
SDict begin 18.72 H.A end
 2074 77 a 2074
77 a
SDict begin [/View [/XYZ H.V]/Dest (8.39.17.2) cvn /DEST pdfmark end
 2074 77 a -2 269 a
SDict begin H.S end
 -2 269 a -2 269 a
SDict begin 13 H.A end
 -2 269 a -2
269 a
SDict begin [/View [/XYZ H.V]/Dest (0:1691) cvn /DEST pdfmark end
 -2 269 a 396 351 a Fj(Se)n(v)o(eral)20 b(espressos)g(later)m(,)g
(we)g(w)o(ant)h(to)f(jump)f(into)h(writing)g(code)f(b)n(ut)i(a)f
(little)h(v)n(oice)f(tells)h(us)g(to)f(get)g(more)g(details)396
459 y(before)f(making)g(a)h(sensational)g(solution)g(to)g(entirely)f
(the)h(wrong)f(problem.)g("What)h(kind)f(of)h(w)o(ork)g(is)h(the)f
(cloud)396 566 y(doing?",)f(we)h(ask.)g(The)g(client)g(e)o(xplains:)-2
584 y
SDict begin H.S end
 -2 584 a -2 584 a
SDict begin 13 H.A end
 -2 584 a -2 584 a
SDict begin [/View [/XYZ H.V]/Dest (0:1692) cvn /DEST pdfmark end
 -2 584 a -2
594 a
SDict begin H.S end
 -2 594 a -2 594 a
SDict begin 13 H.A end
 -2 594 a -2 594 a
SDict begin [/View [/XYZ H.V]/Dest (0:1693) cvn /DEST pdfmark end
 -2 594 a Black
396 737 a Fe(\225)p Black 479 737 a
SDict begin H.S end
 479 737 a 479 737
a
SDict begin 13 H.A end
 479 737 a 479 737 a
SDict begin [/View [/XYZ H.V]/Dest (0:1694) cvn /DEST pdfmark end
 479 737 a Fj(W)-7 b(ork)o(ers)20
b(run)g(on)g(v)n(arious)f(kinds)g(of)h(hardw)o(are,)f(b)n(ut)h(the)o(y)
f(are)i(all)f(able)g(to)h(handle)e(an)o(y)g(task.)i(There)e(are)h(se)n
(v)o(eral)479 845 y(hundred)e(w)o(ork)o(ers)i(per)f(cluster)m(,)h(and)g
(as)g(man)o(y)f(as)i(a)g(dozen)e(clusters)h(in)h(total.)-2
863 y
SDict begin H.S end
 -2 863 a -2 863 a
SDict begin 13 H.A end
 -2 863 a -2 863 a
SDict begin [/View [/XYZ H.V]/Dest (0:1695) cvn /DEST pdfmark end
 -2 863 a Black
396 994 a Fe(\225)p Black 479 994 a
SDict begin H.S end
 479 994 a 479 994
a
SDict begin 13 H.A end
 479 994 a 479 994 a
SDict begin [/View [/XYZ H.V]/Dest (0:1696) cvn /DEST pdfmark end
 479 994 a Fj(Clients)g(create)f(tasks)h(for)f(w)o
(ork)o(ers.)f(Each)h(task)g(is)h(an)f(independent)e(unit)i(of)g(w)o
(ork)f(and)h(all)h(the)f(client)g(w)o(ants)h(is)g(to)479
1102 y(\002nd)f(an)g(a)n(v)n(ailable)g(w)o(ork)o(er)m(,)f(and)g(send)h
(it)h(the)f(task,)h(as)g(soon)e(as)i(possible.)f(There)f(will)i(be)f(a)
h(lot)f(of)g(clients)h(and)479 1210 y(the)o(y')o(ll)f(come)f(and)h(go)g
(arbitrarily)-5 b(.)-2 1228 y
SDict begin H.S end
 -2 1228 a -2 1228 a
SDict begin 13 H.A end
 -2
1228 a -2 1228 a
SDict begin [/View [/XYZ H.V]/Dest (0:1697) cvn /DEST pdfmark end
 -2 1228 a Black 396 1359 a Fe(\225)p
Black 479 1359 a
SDict begin H.S end
 479 1359 a 479 1359 a
SDict begin 13 H.A end
 479 1359 a 479
1359 a
SDict begin [/View [/XYZ H.V]/Dest (0:1698) cvn /DEST pdfmark end
 479 1359 a Fj(The)20 b(real)g(dif)n(\002culty)f(is)j(to)e(be)g
(able)g(to)g(add)g(and)g(remo)o(v)o(e)e(clusters)i(at)h(an)o(y)e(time.)
i(A)f(cluster)g(can)g(lea)n(v)o(e)g(or)g(join)g(the)479
1467 y(cloud)g(instantly)-5 b(,)19 b(bringing)f(all)j(its)g(w)o(ork)o
(ers)e(and)h(clients)g(with)h(it.)-2 1485 y
SDict begin H.S end
 -2 1485 a
-2 1485 a
SDict begin 13 H.A end
 -2 1485 a -2 1485 a
SDict begin [/View [/XYZ H.V]/Dest (0:1699) cvn /DEST pdfmark end
 -2 1485 a Black 396 1617
a Fe(\225)p Black 479 1617 a
SDict begin H.S end
 479 1617 a 479 1617 a
SDict begin 13 H.A end
 479
1617 a 479 1617 a
SDict begin [/View [/XYZ H.V]/Dest (0:1700) cvn /DEST pdfmark end
 479 1617 a Fj(If)f(there)g(are)g(no)g(w)o(ork)o(ers)f
(in)i(their)f(o)n(wn)f(cluster)m(,)h(clients')g(tasks)h(will)g(go)f(of)
n(f)f(to)h(other)g(a)n(v)n(ailable)f(w)o(ork)o(ers)h(in)g(the)479
1725 y(cloud.)-2 1726 y
SDict begin H.S end
 -2 1726 a -2 1726 a
SDict begin 13 H.A end
 -2 1726 a
-2 1726 a
SDict begin [/View [/XYZ H.V]/Dest (0:1701) cvn /DEST pdfmark end
 -2 1726 a Black 396 1874 a Fe(\225)p Black
479 1874 a
SDict begin H.S end
 479 1874 a 479 1874 a
SDict begin 13 H.A end
 479 1874 a 479 1874
a
SDict begin [/View [/XYZ H.V]/Dest (0:1702) cvn /DEST pdfmark end
 479 1874 a Fj(Clients)h(send)f(out)g(one)g(task)g(at)h(a)g(time,)f(w)
o(aiting)g(for)f(a)i(reply)-5 b(.)19 b(If)h(the)o(y)f(don')o(t)g(get)h
(an)g(answer)g(within)g(X)g(seconds)479 1982 y(the)o(y')o(ll)g(just)g
(send)g(out)g(the)g(task)h(again.)e(This)h(ain')o(t)g(our)f(concern,)f
(the)j(client)f(API)g(does)g(it)h(already)-5 b(.)-2 2000
y
SDict begin H.S end
 -2 2000 a -2 2000 a
SDict begin 13 H.A end
 -2 2000 a -2 2000 a
SDict begin [/View [/XYZ H.V]/Dest (0:1703) cvn /DEST pdfmark end
 -2 2000 a Black
396 2131 a Fe(\225)p Black 479 2131 a
SDict begin H.S end
 479 2131 a 479
2131 a
SDict begin 13 H.A end
 479 2131 a 479 2131 a
SDict begin [/View [/XYZ H.V]/Dest (0:1704) cvn /DEST pdfmark end
 479 2131 a Fj(W)e(ork)o(ers)20
b(process)g(one)g(task)g(at)h(a)g(time,)f(the)o(y)f(are)h(v)o(ery)f
(simple)i(beasts.)f(If)g(the)o(y)f(crash,)h(the)o(y)g(get)g(restarted)f
(by)479 2239 y(whate)n(v)o(er)g(script)h(started)g(them.)-2
2423 y
SDict begin H.S end
 -2 2423 a -2 2423 a
SDict begin 13 H.A end
 -2 2423 a -2 2423 a
SDict begin [/View [/XYZ H.V]/Dest (0:1705) cvn /DEST pdfmark end
 -2 2423
a 396 2513 a Fj(So)h(we)f(double)f(check)g(to)i(mak)o(e)e(sure)i(that)f
(we)g(understood)e(this)j(correctly:)-2 2531 y
SDict begin H.S end
 -2 2531
a -2 2531 a
SDict begin 13 H.A end
 -2 2531 a -2 2531 a
SDict begin [/View [/XYZ H.V]/Dest (0:1706) cvn /DEST pdfmark end
 -2 2531 a -2 2541 a
SDict begin H.S end
 -2
2541 a -2 2541 a
SDict begin 13 H.A end
 -2 2541 a -2 2541 a
SDict begin [/View [/XYZ H.V]/Dest (0:1707) cvn /DEST pdfmark end
 -2 2541 a Black
396 2684 a Fe(\225)p Black 479 2684 a
SDict begin H.S end
 479 2684 a 479
2684 a
SDict begin 13 H.A end
 479 2684 a 479 2684 a
SDict begin [/View [/XYZ H.V]/Dest (0:1708) cvn /DEST pdfmark end
 479 2684 a Fj("There)f(will)g(be)h(some)f
(kind)f(of)h(super)n(-duper)d(netw)o(ork)i(interconnect)g(between)g
(clusters,)h(right?",)f(we)i(ask.)f(The)479 2791 y(client)h(says,)f("Y)
-8 b(es,)20 b(of)g(course,)f(we')l(re)h(not)g(idiots.")-2
2809 y
SDict begin H.S end
 -2 2809 a -2 2809 a
SDict begin 13 H.A end
 -2 2809 a -2 2809 a
SDict begin [/View [/XYZ H.V]/Dest (0:1709) cvn /DEST pdfmark end
 -2 2809
a Black 396 2941 a Fe(\225)p Black 479 2941 a
SDict begin H.S end
 479 2941
a 479 2941 a
SDict begin 13 H.A end
 479 2941 a 479 2941 a
SDict begin [/View [/XYZ H.V]/Dest (0:1710) cvn /DEST pdfmark end
 479 2941 a Fj("What)h(kind)e(of)h(v)
n(olumes)f(are)i(we)f(talking)g(about?",)e(we)j(ask.)f(The)g(client)g
(replies,)g("Up)g(to)g(a)h(thousand)e(clients)479 3049
y(per)h(cluster)m(,)g(each)f(doing)g(max.)h(ten)g(requests)g(per)g
(second.)f(Requests)h(are)g(small,)h(and)e(replies)h(are)h(also)f
(small,)g(no)479 3157 y(more)g(than)f(1K)i(bytes)f(each.")-2
3341 y
SDict begin H.S end
 -2 3341 a -2 3341 a
SDict begin 13 H.A end
 -2 3341 a -2 3341 a
SDict begin [/View [/XYZ H.V]/Dest (0:1711) cvn /DEST pdfmark end
 -2 3341
a 396 3431 a Fj(So)h(we)f(do)g(a)h(little)g(calculation)e(and)g(see)i
(that)f(this)h(will)g(w)o(ork)f(nicely)f(o)o(v)o(er)g(plain)h(TCP)-9
b(.)20 b(2,500)f(clients)h(x)h(10/second)396 3539 y(x)g(1,000)d(bytes)i
(x)g(2)h(directions)e(=)h(50MB/sec)g(or)g(400Mb/sec,)f(not)h(a)g
(problem)f(for)g(a)i(1Gb)f(netw)o(ork.)-2 3723 y
SDict begin H.S end
 -2 3723
a -2 3723 a
SDict begin 13 H.A end
 -2 3723 a -2 3723 a
SDict begin [/View [/XYZ H.V]/Dest (0:1712) cvn /DEST pdfmark end
 -2 3723 a 396 3813 a
Fj(It')-5 b(s)21 b(a)g(straight-forw)o(ard)c(problem)i(that)h(requires)
f(no)h(e)o(xotic)f(hardw)o(are)g(or)h(protocols,)e(just)j(some)f(cle)n
(v)o(er)f(routing)396 3921 y(algorithms)g(and)h(careful)f(design.)g(W)
-7 b(e)22 b(start)e(by)g(designing)f(one)g(cluster)i(\(one)e(data)h
(center\))f(and)h(then)f(we)i(\002gure)e(out)396 4029
y(ho)n(w)h(to)g(connect)f(clusters)i(together)-5 b(.)-2
4057 y
SDict begin H.S end
 -2 4057 a -2 4057 a
SDict begin 13 H.A end
 -2 4057 a -2 4057 a
SDict begin [/View [/XYZ H.V]/Dest (0:1713) cvn /DEST pdfmark end
 -2 4057
a 396 4367 a Fd(3.9.2.)36 b(Ar)n(c)o(hitecture)d(of)g(a)h(Single)g
(Cluster)2511 4367 y
SDict begin H.S end
 2511 4367 a 2511 4367 a
SDict begin 18.72 H.A end
 2511 4367
a 2511 4367 a
SDict begin [/View [/XYZ H.V]/Dest (8.39.18.2) cvn /DEST pdfmark end
 2511 4367 a -2 4560 a
SDict begin H.S end
 -2 4560 a -2 4560
a
SDict begin 13 H.A end
 -2 4560 a -2 4560 a
SDict begin [/View [/XYZ H.V]/Dest (0:1715) cvn /DEST pdfmark end
 -2 4560 a 396 4641 a Fj(W)-7 b(ork)o(ers)20
b(and)g(clients)h(are)f(synchronous.)d(W)-7 b(e)21 b(w)o(ant)g(to)f
(use)g(the)h(LR)m(U)f(pattern)f(to)i(route)e(tasks)i(to)f(w)o(ork)o
(ers.)f(W)-7 b(ork)o(ers)396 4749 y(are)20 b(all)h(identical,)f(our)f
(f)o(acility)h(has)h(no)e(notion)g(of)h(dif)n(ferent)f(services.)h(W)-7
b(ork)o(ers)20 b(are)g(anon)o(ymous,)d(clients)k(ne)n(v)o(er)396
4857 y(address)f(them)g(directly)-5 b(.)19 b(W)-7 b(e)21
b(mak)o(e)f(no)f(attempt)h(here)g(to)g(pro)o(vide)e(guaranteed)g(deli)n
(v)o(ery)-5 b(,)18 b(retry)-5 b(,)19 b(etc.)p Black 3759
5569 a Fi(120)p Black eop end
%%Page: 121 135
TeXDict begin 121 134 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.121) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1716) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(F)o(or)20 b(reasons)g(we)g(already)f
(look)o(ed)g(at,)i(clients)f(and)g(w)o(ork)o(ers)g(w)o(on')o(t)f(speak)
g(to)i(each)f(other)f(directly)-5 b(.)19 b(It)h(mak)o(es)g(it)396
180 y(impossible)g(to)g(add)g(or)g(remo)o(v)o(e)e(nodes)h(dynamically)
-5 b(.)18 b(So)i(our)g(basic)g(model)g(consists)g(of)g(the)g
(request-reply)396 288 y(message)g(brok)o(er)f(we)h(sa)o(w)h(earlier\()
p 0 TeXcolorgray 1442 288 a
SDict begin H.S end
 1442 288 a Fj(Figure)d(3-20)1832
288 y
SDict begin 13 H.L end
 1832 288 a 1832 288 a
SDict begin [/Subtype /Link/Dest (0:figure-45) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1832 288 a Black -2 w Fj(\).)-2
306 y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2 306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-45) cvn /DEST pdfmark
end
 -2 306 a 396
490 a Fk(Figur)o(e)i(3-20.)e(Cluster)j(Ar)o(chitectur)o(e)-2
590 y
SDict begin H.S end
 -2 590 a -2 590 a
SDict begin 13 H.A end
 -2 590 a -2 590 a
SDict begin [/View [/XYZ H.V]/Dest (0:1720) cvn /DEST pdfmark end
 -2 590 a 396
4364 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4364 a @beginspecial 0 @llx -448 @lly 380
@urx 0 @ury 3800 @rwi @setspecial
%%BeginDocument: images/fig45.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -448 380 0
%%HiResBoundingBox: 0.0 -448.0 380.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -64.00029754638672 lineto
118.00029754638672 -64.00029754638672 lineto
118.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -38.000301361083984 moveto
148.00030517578125 -64.00029754638672 lineto
238.00030517578125 -64.00029754638672 lineto
238.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -38.000301361083984 moveto
268.00030517578125 -64.00029754638672 lineto
358.00030517578125 -64.00029754638672 lineto
358.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -68.00029754638672 moveto
28.00029945373535 -94.00029754638672 lineto
118.00029754638672 -94.00029754638672 lineto
118.00029754638672 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -68.00029754638672 moveto
148.00030517578125 -94.00029754638672 lineto
238.00030517578125 -94.00029754638672 lineto
238.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -68.00029754638672 moveto
268.00030517578125 -94.00029754638672 lineto
358.00030517578125 -94.00029754638672 lineto
358.00030517578125 -68.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
128.00030517578125 -178.00030517578125 moveto
128.00030517578125 -204.00030517578125 lineto
258.00030517578125 -204.00030517578125 lineto
258.00030517578125 -178.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
128.00030517578125 -208.00030517578125 moveto
128.00030517578125 -232.00030517578125 lineto
258.00030517578125 -232.00030517578125 lineto
258.00030517578125 -208.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
128.00030517578125 -236.00030517578125 moveto
128.00030517578125 -262.00030517578125 lineto
258.00030517578125 -262.00030517578125 lineto
258.00030517578125 -236.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -360.00030517578125 moveto
28.00029945373535 -386.00030517578125 lineto
118.00029754638672 -386.00030517578125 lineto
118.00029754638672 -360.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -360.00030517578125 moveto
148.00030517578125 -386.00030517578125 lineto
238.00030517578125 -386.00030517578125 lineto
238.00030517578125 -360.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -360.00030517578125 moveto
268.00030517578125 -386.00030517578125 lineto
358.00030517578125 -386.00030517578125 lineto
358.00030517578125 -360.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -390.00030517578125 moveto
28.00029945373535 -416.00030517578125 lineto
118.00029754638672 -416.00030517578125 lineto
118.00029754638672 -390.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -390.00030517578125 moveto
148.00030517578125 -416.00030517578125 lineto
238.00030517578125 -416.00030517578125 lineto
238.00030517578125 -390.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
268.00030517578125 -390.00030517578125 moveto
268.00030517578125 -416.00030517578125 lineto
358.00030517578125 -416.00030517578125 lineto
358.00030517578125 -390.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -61.0 lineto
115.0 -61.0 lineto
115.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -61.0 lineto
115.0 -61.0 lineto
115.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -61.0 lineto
235.0 -61.0 lineto
235.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -35.0 moveto
265.0 -61.0 lineto
355.0 -61.0 lineto
355.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -35.0 moveto
265.0 -61.0 lineto
355.0 -61.0 lineto
355.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -65.0 moveto
25.0 -91.0 lineto
115.0 -91.0 lineto
115.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -65.0 moveto
25.0 -91.0 lineto
115.0 -91.0 lineto
115.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -65.0 moveto
145.0 -91.0 lineto
235.0 -91.0 lineto
235.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -65.0 moveto
265.0 -91.0 lineto
355.0 -91.0 lineto
355.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -65.0 moveto
265.0 -91.0 lineto
355.0 -91.0 lineto
355.0 -65.0 lineto
closepath
stroke
1.0 setlinewidth
0 setlinecap
[5.0] 0.0 setdash
newpath
25.0 -147.0 moveto
25.0 -287.0 lineto
355.0 -287.0 lineto
355.0 -147.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
125.0 -175.0 moveto
125.0 -201.0 lineto
255.0 -201.0 lineto
255.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
125.0 -175.0 moveto
125.0 -201.0 lineto
255.0 -201.0 lineto
255.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
125.0 -205.0 moveto
125.0 -229.0 lineto
255.0 -229.0 lineto
255.0 -205.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
125.0 -205.0 moveto
125.0 -229.0 lineto
255.0 -229.0 lineto
255.0 -205.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
125.0 -233.0 moveto
125.0 -259.0 lineto
255.0 -259.0 lineto
255.0 -233.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
125.0 -233.0 moveto
125.0 -259.0 lineto
255.0 -259.0 lineto
255.0 -233.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -357.0 moveto
25.0 -383.0 lineto
115.0 -383.0 lineto
115.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -357.0 moveto
25.0 -383.0 lineto
115.0 -383.0 lineto
115.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -357.0 moveto
145.0 -383.0 lineto
235.0 -383.0 lineto
235.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -357.0 moveto
145.0 -383.0 lineto
235.0 -383.0 lineto
235.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -357.0 moveto
265.0 -383.0 lineto
355.0 -383.0 lineto
355.0 -357.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -357.0 moveto
265.0 -383.0 lineto
355.0 -383.0 lineto
355.0 -357.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -387.0 moveto
25.0 -413.0 lineto
115.0 -413.0 lineto
115.0 -387.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -387.0 moveto
25.0 -413.0 lineto
115.0 -413.0 lineto
115.0 -387.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -387.0 moveto
145.0 -413.0 lineto
235.0 -413.0 lineto
235.0 -387.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -387.0 moveto
145.0 -413.0 lineto
235.0 -413.0 lineto
235.0 -387.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
265.0 -387.0 moveto
265.0 -413.0 lineto
355.0 -413.0 lineto
355.0 -387.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
265.0 -387.0 moveto
265.0 -413.0 lineto
355.0 -413.0 lineto
355.0 -387.0 lineto
closepath
stroke
newpath
185.0 -154.0 moveto
185.0 -175.0 lineto
stroke
newpath
185.0 -259.0 moveto
185.0 -279.0 lineto
stroke
newpath
65.0 -91.0 moveto
65.0 -119.0 lineto
185.0 -119.0 lineto
stroke
newpath
185.0 -91.0 moveto
185.0 -119.0 lineto
stroke
newpath
305.0 -91.0 moveto
305.0 -119.0 lineto
185.0 -119.0 lineto
stroke
newpath
185.0 -133.0 moveto
185.0 -119.0 lineto
stroke
newpath
185.0 -301.0 moveto
185.0 -329.0 lineto
stroke
newpath
65.0 -357.0 moveto
65.0 -329.0 lineto
185.0 -329.0 lineto
stroke
newpath
185.0 -357.0 moveto
185.0 -329.0 lineto
stroke
newpath
305.0 -357.0 moveto
305.0 -329.0 lineto
185.0 -329.0 lineto
stroke
/Helvetica findfont
15 scalefont setfont
47.0 -54.0 moveto
(Client) show
167.0 -54.0 moveto
(Client) show
287.0 -54.0 moveto
(Client) show
50.0 -82.0 moveto
(REQ) show
170.0 -82.0 moveto
(REQ) show
290.0 -82.0 moveto
(REQ) show
161.0 -194.0 moveto
(ROUTER) show
142.0 -222.0 moveto
(LRU Queue) show
161.0 -250.0 moveto
(ROUTER) show
283.0 -278.0 moveto
(Broker) show
50.0 -376.0 moveto
(REQ) show
170.0 -376.0 moveto
(REQ) show
290.0 -376.0 moveto
(REQ) show
41.0 -404.0 moveto
(Worker) show
161.0 -404.0 moveto
(Worker) show
281.0 -404.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4364 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4364 a -2 4447 a
SDict begin H.S end
 -2 4447
a -2 4447 a
SDict begin 13 H.A end
 -2 4447 a -2 4447 a
SDict begin [/View [/XYZ H.V]/Dest (0:1723) cvn /DEST pdfmark end
 -2 4447 a 396 4776 a
Fd(3.9.3.)36 b(Scaling)e(to)f(Multiple)h(Cluster)n(s)2293
4776 y
SDict begin H.S end
 2293 4776 a 2293 4776 a
SDict begin 18.72 H.A end
 2293 4776 a 2293 4776
a
SDict begin [/View [/XYZ H.V]/Dest (8.39.19.2) cvn /DEST pdfmark end
 2293 4776 a -2 4968 a
SDict begin H.S end
 -2 4968 a -2 4968 a
SDict begin 13 H.A end
 -2 4968 a
-2 4968 a
SDict begin [/View [/XYZ H.V]/Dest (0:1725) cvn /DEST pdfmark end
 -2 4968 a 396 5049 a Fj(No)n(w)20 b(we)h(scale)g(this)f(out)g
(to)h(more)e(than)h(one)f(cluster)-5 b(.)21 b(Each)e(cluster)h(has)h(a)
f(set)h(of)f(clients)h(and)e(w)o(ork)o(ers,)h(and)f(a)396
5157 y(brok)o(er)g(that)h(joins)g(these)h(together:)-2
5175 y
SDict begin H.S end
 -2 5175 a -2 5175 a
SDict begin 13 H.A end
 -2 5175 a -2 5175 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-46) cvn /DEST pdfmark
end
 -2 5175
a Black 3759 5569 a Fi(121)p Black eop end
%%Page: 122 136
TeXDict begin 122 135 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.122) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1746) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-21.)e(Multiple)k
(Clusters)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172
a
SDict begin [/View [/XYZ H.V]/Dest (0:1728) cvn /DEST pdfmark end
 -2 172 a 396 2139 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2139 a @beginspecial 0 @llx
-231 @lly 424 @urx 0 @ury 4240 @rwi @setspecial
%%BeginDocument: images/fig46.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -231 424 0
%%HiResBoundingBox: 0.0 -231.0 424.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -62.40024185180664 moveto
22.400239944458008 -84.40023803710938 lineto
54.40024185180664 -84.40023803710938 lineto
54.40024185180664 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -62.40024185180664 moveto
78.40023803710938 -84.40023803710938 lineto
110.40023803710938 -84.40023803710938 lineto
110.40023803710938 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
134.40023803710938 -62.40024185180664 moveto
134.40023803710938 -84.40023803710938 lineto
166.40023803710938 -84.40023803710938 lineto
166.40023803710938 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -117.40023803710938 moveto
22.400239944458008 -139.40023803710938 lineto
166.40023803710938 -139.40023803710938 lineto
166.40023803710938 -117.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -172.40023803710938 moveto
22.400239944458008 -194.40023803710938 lineto
54.40024185180664 -194.40023803710938 lineto
54.40024185180664 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -172.40023803710938 moveto
78.40023803710938 -194.40023803710938 lineto
110.40023803710938 -194.40023803710938 lineto
110.40023803710938 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
134.40023803710938 -172.40023803710938 moveto
134.40023803710938 -194.40023803710938 lineto
166.40023803710938 -194.40023803710938 lineto
166.40023803710938 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
262.4002380371094 -62.40024185180664 moveto
262.4002380371094 -84.40023803710938 lineto
294.4002380371094 -84.40023803710938 lineto
294.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
318.4002380371094 -62.40024185180664 moveto
318.4002380371094 -84.40023803710938 lineto
350.4002380371094 -84.40023803710938 lineto
350.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
374.4002380371094 -62.40024185180664 moveto
374.4002380371094 -84.40023803710938 lineto
406.4002380371094 -84.40023803710938 lineto
406.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
262.4002380371094 -117.40023803710938 moveto
262.4002380371094 -139.40023803710938 lineto
406.4002380371094 -139.40023803710938 lineto
406.4002380371094 -117.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
262.4002380371094 -172.40023803710938 moveto
262.4002380371094 -194.40023803710938 lineto
294.4002380371094 -194.40023803710938 lineto
294.4002380371094 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
318.4002380371094 -172.40023803710938 moveto
318.4002380371094 -194.40023803710938 lineto
350.4002380371094 -194.40023803710938 lineto
350.4002380371094 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
374.4002380371094 -172.40023803710938 moveto
374.4002380371094 -194.40023803710938 lineto
406.4002380371094 -194.40023803710938 lineto
406.4002380371094 -172.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -60.0 moveto
20.0 -82.0 lineto
52.0 -82.0 lineto
52.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -60.0 moveto
20.0 -82.0 lineto
52.0 -82.0 lineto
52.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -60.0 moveto
76.0 -82.0 lineto
108.0 -82.0 lineto
108.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -60.0 moveto
76.0 -82.0 lineto
108.0 -82.0 lineto
108.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
132.0 -60.0 moveto
132.0 -82.0 lineto
164.0 -82.0 lineto
164.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
132.0 -60.0 moveto
132.0 -82.0 lineto
164.0 -82.0 lineto
164.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -115.0 moveto
20.0 -137.0 lineto
164.0 -137.0 lineto
164.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -115.0 moveto
20.0 -137.0 lineto
164.0 -137.0 lineto
164.0 -115.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -170.0 moveto
20.0 -192.0 lineto
52.0 -192.0 lineto
52.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -170.0 moveto
20.0 -192.0 lineto
52.0 -192.0 lineto
52.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -170.0 moveto
76.0 -192.0 lineto
108.0 -192.0 lineto
108.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -170.0 moveto
76.0 -192.0 lineto
108.0 -192.0 lineto
108.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
132.0 -170.0 moveto
132.0 -192.0 lineto
164.0 -192.0 lineto
164.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
132.0 -170.0 moveto
132.0 -192.0 lineto
164.0 -192.0 lineto
164.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
260.0 -60.0 moveto
260.0 -82.0 lineto
292.0 -82.0 lineto
292.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
260.0 -60.0 moveto
260.0 -82.0 lineto
292.0 -82.0 lineto
292.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
316.0 -60.0 moveto
316.0 -82.0 lineto
348.0 -82.0 lineto
348.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
316.0 -60.0 moveto
316.0 -82.0 lineto
348.0 -82.0 lineto
348.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
372.0 -60.0 moveto
372.0 -82.0 lineto
404.0 -82.0 lineto
404.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
372.0 -60.0 moveto
372.0 -82.0 lineto
404.0 -82.0 lineto
404.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
260.0 -115.0 moveto
260.0 -137.0 lineto
404.0 -137.0 lineto
404.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
260.0 -115.0 moveto
260.0 -137.0 lineto
404.0 -137.0 lineto
404.0 -115.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
260.0 -170.0 moveto
260.0 -192.0 lineto
292.0 -192.0 lineto
292.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
260.0 -170.0 moveto
260.0 -192.0 lineto
292.0 -192.0 lineto
292.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
316.0 -170.0 moveto
316.0 -192.0 lineto
348.0 -192.0 lineto
348.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
316.0 -170.0 moveto
316.0 -192.0 lineto
348.0 -192.0 lineto
348.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
372.0 -170.0 moveto
372.0 -192.0 lineto
404.0 -192.0 lineto
404.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
372.0 -170.0 moveto
372.0 -192.0 lineto
404.0 -192.0 lineto
404.0 -170.0 lineto
closepath
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
212.0 -22.0 moveto
212.0 -209.0 lineto
stroke
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
36.0 -82.0 moveto
36.0 -115.0 lineto
stroke
newpath
92.0 -82.0 moveto
92.0 -115.0 lineto
stroke
newpath
148.0 -82.0 moveto
148.0 -115.0 lineto
stroke
newpath
36.0 -137.0 moveto
36.0 -170.0 lineto
stroke
newpath
92.0 -137.0 moveto
92.0 -170.0 lineto
stroke
newpath
148.0 -137.0 moveto
148.0 -170.0 lineto
stroke
newpath
276.0 -82.0 moveto
276.0 -115.0 lineto
stroke
newpath
332.0 -82.0 moveto
332.0 -115.0 lineto
stroke
newpath
388.0 -82.0 moveto
388.0 -115.0 lineto
stroke
newpath
276.0 -137.0 moveto
276.0 -170.0 lineto
stroke
newpath
332.0 -137.0 moveto
332.0 -170.0 lineto
stroke
newpath
388.0 -137.0 moveto
388.0 -170.0 lineto
stroke
/Helvetica findfont
11 scalefont setfont
63.0 -32.0 moveto
(Cluster 1) show
303.0 -32.0 moveto
(Cluster 2) show
34.0 -76.0 moveto
(C ) show
90.0 -76.0 moveto
(C ) show
146.0 -76.0 moveto
(C ) show
274.0 -76.0 moveto
(C ) show
330.0 -76.0 moveto
(C ) show
386.0 -76.0 moveto
(C ) show
67.0 -131.0 moveto
(Broker) show
307.0 -131.0 moveto
(Broker) show
33.0 -186.0 moveto
(W ) show
89.0 -186.0 moveto
(W ) show
145.0 -186.0 moveto
(W ) show
273.0 -186.0 moveto
(W ) show
329.0 -186.0 moveto
(W ) show
385.0 -186.0 moveto
(W ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2139 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2139 a -2 2305 a
SDict begin H.S end
 -2 2305
a -2 2305 a
SDict begin 13 H.A end
 -2 2305 a -2 2305 a
SDict begin [/View [/XYZ H.V]/Dest (0:1731) cvn /DEST pdfmark end
 -2 2305 a 396 2413 a
Fj(The)e(question)f(is:)i(ho)n(w)f(do)g(we)g(get)h(the)f(clients)g(of)g
(each)g(cluster)g(talking)g(to)g(the)g(w)o(ork)o(ers)g(of)g(the)g
(other)f(cluster?)396 2521 y(There)h(are)g(a)g(fe)n(w)g(possibilities,)
h(each)f(with)g(pros)g(and)f(cons:)-2 2539 y
SDict begin H.S end
 -2 2539
a -2 2539 a
SDict begin 13 H.A end
 -2 2539 a -2 2539 a
SDict begin [/View [/XYZ H.V]/Dest (0:1732) cvn /DEST pdfmark end
 -2 2539 a -2 2549 a
SDict begin H.S end
 -2
2549 a -2 2549 a
SDict begin 13 H.A end
 -2 2549 a -2 2549 a
SDict begin [/View [/XYZ H.V]/Dest (0:1733) cvn /DEST pdfmark end
 -2 2549 a Black
396 2691 a Fe(\225)p Black 479 2691 a
SDict begin H.S end
 479 2691 a 479
2691 a
SDict begin 13 H.A end
 479 2691 a 479 2691 a
SDict begin [/View [/XYZ H.V]/Dest (0:1734) cvn /DEST pdfmark end
 479 2691 a Fj(Clients)i(could)f(connect)f
(directly)g(to)h(both)g(brok)o(ers.)e(The)i(adv)n(antage)e(is)j(that)g
(we)f(don')o(t)f(need)g(to)i(modify)d(brok)o(ers)479
2799 y(or)i(w)o(ork)o(ers.)f(But)i(clients)g(get)f(more)f(comple)o(x,)f
(and)i(become)f(a)o(w)o(are)h(of)g(the)g(o)o(v)o(erall)f(topology)-5
b(.)17 b(If)j(we)h(w)o(ant)f(to)479 2907 y(add,)g(e.g.)f(a)i(third)f
(or)f(forth)h(cluster)m(,)f(all)i(the)f(clients)h(are)f(af)n(fected.)e
(In)i(ef)n(fect)g(we)h(ha)n(v)o(e)e(to)i(mo)o(v)o(e)d(routing)h(and)479
3015 y(f)o(ail-o)o(v)o(er)g(logic)g(into)h(the)h(clients)f(and)g(that')
-5 b(s)20 b(not)g(nice.)-2 3033 y
SDict begin H.S end
 -2 3033 a -2 3033 a
SDict begin 13 H.A end

-2 3033 a -2 3033 a
SDict begin [/View [/XYZ H.V]/Dest (0:1735) cvn /DEST pdfmark end
 -2 3033 a Black 396 3164 a Fe(\225)p
Black 479 3164 a
SDict begin H.S end
 479 3164 a 479 3164 a
SDict begin 13 H.A end
 479 3164 a 479
3164 a
SDict begin [/View [/XYZ H.V]/Dest (0:1736) cvn /DEST pdfmark end
 479 3164 a Fj(W)-7 b(ork)o(ers)20 b(might)g(connect)f(directly)g
(to)i(both)e(brok)o(ers.)g(But)h(REQ)h(w)o(ork)o(ers)f(can')o(t)f(do)h
(that,)g(the)o(y)f(can)h(only)g(reply)f(to)479 3272 y(one)h(brok)o(er)
-5 b(.)19 b(W)-7 b(e)21 b(might)f(use)g(REPs)h(b)n(ut)g(REPs)g(don')o
(t)d(gi)n(v)o(e)i(us)g(customizable)f(brok)o(er)n(-to-w)o(ork)o(er)d
(routing)j(lik)o(e)479 3380 y(LR)m(U,)i(only)e(the)h(b)n(uilt-in)g
(load)f(balancing.)g(That')-5 b(s)20 b(a)h(f)o(ail,)f(if)g(we)h(w)o
(ant)f(to)h(distrib)n(ute)e(w)o(ork)h(to)g(idle)h(w)o(ork)o(ers:)e(we)
479 3488 y(precisely)h(need)f(LR)m(U.)h(One)h(solution)e(w)o(ould)g(be)
h(to)h(use)f(R)m(OUTER)h(sock)o(ets)f(for)g(the)g(w)o(ork)o(er)f
(nodes.)g(Let')-5 b(s)21 b(label)479 3596 y(this)g("Idea)f(#1".)-2
3597 y
SDict begin H.S end
 -2 3597 a -2 3597 a
SDict begin 13 H.A end
 -2 3597 a -2 3597 a
SDict begin [/View [/XYZ H.V]/Dest (0:1737) cvn /DEST pdfmark end
 -2 3597
a Black 396 3745 a Fe(\225)p Black 479 3745 a
SDict begin H.S end
 479 3745
a 479 3745 a
SDict begin 13 H.A end
 479 3745 a 479 3745 a
SDict begin [/View [/XYZ H.V]/Dest (0:1738) cvn /DEST pdfmark end
 479 3745 a Fj(Brok)o(ers)g(could)f
(connect)g(to)i(each)e(other)-5 b(.)20 b(This)g(looks)g(neatest)g
(because)g(it)h(creates)f(the)g(fe)n(west)h(additional)479
3853 y(connections.)d(W)-7 b(e)22 b(can')o(t)d(add)h(clusters)g(on)g
(the)g(\003y)g(b)n(ut)h(that)f(is)h(probably)d(out)i(of)g(scope.)f(No)n
(w)h(clients)h(and)479 3961 y(w)o(ork)o(ers)f(remain)f(ignorant)g(of)g
(the)i(real)f(netw)o(ork)f(topology)-5 b(,)17 b(and)j(brok)o(ers)f
(tell)i(each)e(other)h(when)f(the)o(y)h(ha)n(v)o(e)479
4069 y(spare)g(capacity)-5 b(.)19 b(Let')-5 b(s)21 b(label)f(this)h
("Idea)e(#2".)-2 4253 y
SDict begin H.S end
 -2 4253 a -2 4253 a
SDict begin 13 H.A end
 -2 4253 a
-2 4253 a
SDict begin [/View [/XYZ H.V]/Dest (0:1739) cvn /DEST pdfmark end
 -2 4253 a 396 4343 a Fj(Let')-5 b(s)21 b(e)o(xplore)d(Idea)i
(#1.)f(In)h(this)h(model)e(we)h(ha)n(v)o(e)g(w)o(ork)o(ers)f
(connecting)f(to)i(both)g(brok)o(ers)e(and)i(accepting)f(jobs)h(from)
396 4451 y(either\()p 0 TeXcolorgray 614 4451 a
SDict begin H.S end
 614 4451
a Fj(Figure)e(3-22)1004 4451 y
SDict begin 13 H.L end
 1004 4451 a 1004 4451
a
SDict begin [/Subtype /Link/Dest (0:figure-47) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1004 4451 a Black -1 w Fj(\).)-2 4469 y
SDict begin H.S end
 -2 4469 a -2
4469 a
SDict begin 13 H.A end
 -2 4469 a -2 4469 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-47) cvn /DEST pdfmark
end
 -2 4469 a Black 3759 5569
a Fi(122)p Black eop end
%%Page: 123 137
TeXDict begin 123 136 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.123) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1754) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-22.)e(Idea)j(1)f
(-)h(Cr)o(oss-connected)e(W)-6 b(ork)o(ers)-2 172 y
SDict begin H.S end
 -2
172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1743) cvn /DEST pdfmark end
 -2 172 a 396 2047 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate

396 2047 a @beginspecial 0 @llx -220 @lly 399 @urx 0
@ury 3990 @rwi @setspecial
%%BeginDocument: images/fig47.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -220 399 0
%%HiResBoundingBox: 0.0 -220.0 399.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
89.10021209716797 -67.10021209716797 moveto
89.10021209716797 -87.10021209716797 lineto
180.10020446777344 -87.10021209716797 lineto
180.10020446777344 -67.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
292.1002197265625 -67.10021209716797 moveto
292.1002197265625 -87.10021209716797 lineto
383.1002197265625 -87.10021209716797 lineto
383.1002197265625 -67.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.100210189819336 -157.10020446777344 moveto
19.100210189819336 -175.10020446777344 lineto
82.10021209716797 -175.10020446777344 lineto
82.10021209716797 -157.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
103.10021209716797 -157.10020446777344 moveto
103.10021209716797 -175.10020446777344 lineto
166.10020446777344 -175.10020446777344 lineto
166.10020446777344 -157.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
187.10020446777344 -157.10020446777344 moveto
187.10020446777344 -175.10020446777344 lineto
250.10020446777344 -175.10020446777344 lineto
250.10020446777344 -157.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.100210189819336 -178.10020446777344 moveto
19.100210189819336 -197.10020446777344 lineto
82.10021209716797 -197.10020446777344 lineto
82.10021209716797 -178.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
103.10021209716797 -178.10020446777344 moveto
103.10021209716797 -197.10020446777344 lineto
166.10020446777344 -197.10020446777344 lineto
166.10020446777344 -178.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
187.10020446777344 -178.10020446777344 moveto
187.10020446777344 -197.10020446777344 lineto
250.10020446777344 -197.10020446777344 lineto
250.10020446777344 -178.10020446777344 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
87.0 -65.0 moveto
87.0 -85.0 lineto
178.0 -85.0 lineto
178.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -65.0 moveto
87.0 -85.0 lineto
178.0 -85.0 lineto
178.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
290.0 -65.0 moveto
290.0 -85.0 lineto
381.0 -85.0 lineto
381.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
290.0 -65.0 moveto
290.0 -85.0 lineto
381.0 -85.0 lineto
381.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
17.0 -155.0 moveto
17.0 -173.0 lineto
80.0 -173.0 lineto
80.0 -155.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
17.0 -155.0 moveto
17.0 -173.0 lineto
80.0 -173.0 lineto
80.0 -155.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
101.0 -155.0 moveto
101.0 -173.0 lineto
164.0 -173.0 lineto
164.0 -155.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
101.0 -155.0 moveto
101.0 -173.0 lineto
164.0 -173.0 lineto
164.0 -155.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -155.0 moveto
185.0 -173.0 lineto
248.0 -173.0 lineto
248.0 -155.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -155.0 moveto
185.0 -173.0 lineto
248.0 -173.0 lineto
248.0 -155.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
17.0 -176.0 moveto
17.0 -195.0 lineto
80.0 -195.0 lineto
80.0 -176.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
17.0 -176.0 moveto
17.0 -195.0 lineto
80.0 -195.0 lineto
80.0 -176.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
101.0 -176.0 moveto
101.0 -195.0 lineto
164.0 -195.0 lineto
164.0 -176.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
101.0 -176.0 moveto
101.0 -195.0 lineto
164.0 -195.0 lineto
164.0 -176.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
185.0 -176.0 moveto
185.0 -195.0 lineto
248.0 -195.0 lineto
248.0 -176.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
185.0 -176.0 moveto
185.0 -195.0 lineto
248.0 -195.0 lineto
248.0 -176.0 lineto
closepath
stroke
0.7 setlinewidth
0 setlinecap
[3.0] 0.0 setdash
newpath
234.0 -20.0 moveto
234.0 -50.0 lineto
stroke
newpath
126.0 -105.0 moveto
59.0 -105.0 lineto
59.0 -120.0 lineto
stroke
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
87.0 -50.0 moveto
87.0 -65.0 lineto
stroke
newpath
178.0 -50.0 moveto
178.0 -65.0 lineto
stroke
newpath
290.0 -50.0 moveto
290.0 -65.0 lineto
stroke
newpath
381.0 -50.0 moveto
381.0 -65.0 lineto
stroke
0.7 setlinewidth
0 setlinecap
[3.0] 0.0 setdash
newpath
59.0 -130.0 moveto
59.0 -155.0 lineto
stroke
newpath
143.0 -130.0 moveto
143.0 -155.0 lineto
stroke
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
129.0 -85.0 moveto
129.0 -125.0 lineto
stroke
newpath
45.0 -155.0 moveto
45.0 -125.0 lineto
129.0 -125.0 lineto
stroke
newpath
129.0 -155.0 moveto
129.0 -125.0 lineto
stroke
newpath
213.0 -155.0 moveto
213.0 -125.0 lineto
129.0 -125.0 lineto
stroke
newpath
332.0 -85.0 moveto
332.0 -105.0 lineto
227.0 -105.0 lineto
stroke
newpath
136.0 -105.0 moveto
143.0 -105.0 lineto
stroke
0.7 setlinewidth
0 setlinecap
[3.0] 0.0 setdash
newpath
143.0 -115.0 moveto
143.0 -105.0 lineto
stroke
newpath
227.0 -155.0 moveto
227.0 -105.0 lineto
stroke
/Helvetica findfont
10 scalefont setfont
104.0 -29.0 moveto
(Cluster 1) show
307.0 -29.0 moveto
(Cluster 2) show
113.0 -78.0 moveto
(ROUTER) show
316.0 -78.0 moveto
(ROUTER) show
29.0 -168.0 moveto
(ROUTER) show
113.0 -168.0 moveto
(ROUTER) show
197.0 -168.0 moveto
(ROUTER) show
28.0 -189.0 moveto
(Worker) show
112.0 -189.0 moveto
(Worker) show
196.0 -189.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2047 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2047 a 274 x Fj(It)21 b(looks)e(feasible.)h
(Ho)n(we)n(v)o(er)f(it)i(doesn')o(t)d(pro)o(vide)g(what)j(we)f(w)o
(anted,)g(which)f(w)o(as)i(that)g(clients)f(get)g(local)g(w)o(ork)o
(ers)g(if)396 2429 y(possible)g(and)g(remote)f(w)o(ork)o(ers)h(only)f
(if)h(it')-5 b(s)22 b(better)e(than)f(w)o(aiting.)h(Also)h(w)o(ork)o
(ers)e(will)i(signal)f("ready")f(to)h(both)396 2537 y(brok)o(ers)f(and)
h(can)g(get)g(tw)o(o)g(jobs)h(at)f(once,)g(while)g(other)f(w)o(ork)o
(ers)h(remain)f(idle.)h(It)g(seems)h(this)g(design)e(f)o(ails)i
(because)396 2645 y(again)e(we')l(re)h(putting)f(routing)g(logic)g(at)i
(the)f(edges.)-2 2829 y
SDict begin H.S end
 -2 2829 a -2 2829 a
SDict begin 13 H.A end
 -2 2829 a
-2 2829 a
SDict begin [/View [/XYZ H.V]/Dest (0:1747) cvn /DEST pdfmark end
 -2 2829 a 396 2919 a Fj(So)g(idea)g(#2)f(then.)h(W)-7
b(e)21 b(interconnect)c(the)j(brok)o(ers)f(and)g(don')o(t)f(touch)h
(the)h(clients)g(or)g(w)o(ork)o(ers,)f(which)g(are)h(REQs)g(lik)o(e)396
3027 y(we')l(re)g(used)g(to\()p 0 TeXcolorgray 868 3027
a
SDict begin H.S end
 868 3027 a Fj(Figure)f(3-23)1259 3027 y
SDict begin 13 H.L end
 1259 3027 a
1259 3027 a
SDict begin [/Subtype /Link/Dest (0:figure-48) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1259 3027 a Black -2 w Fj(\).)-2 3045 y
SDict begin H.S end
 -2
3045 a -2 3045 a
SDict begin 13 H.A end
 -2 3045 a -2 3045 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-48) cvn /DEST pdfmark
end
 -2 3045 a Black
3759 5569 a Fi(123)p Black eop end
%%Page: 124 138
TeXDict begin 124 137 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.124) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1772) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-23.)e(Idea)j(2)f
(-)h(Br)o(ok)o(ers)f(T)-8 b(alking)21 b(to)f(Each)h(Other)-2
172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1751) cvn /DEST pdfmark end
 -2 172 a 396
2139 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2139 a @beginspecial 0 @llx -231 @lly 424
@urx 0 @ury 4240 @rwi @setspecial
%%BeginDocument: images/fig48.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -231 424 0
%%HiResBoundingBox: 0.0 -231.0 424.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -62.40024185180664 moveto
22.400239944458008 -84.40023803710938 lineto
54.40024185180664 -84.40023803710938 lineto
54.40024185180664 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -62.40024185180664 moveto
78.40023803710938 -84.40023803710938 lineto
110.40023803710938 -84.40023803710938 lineto
110.40023803710938 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
134.40023803710938 -62.40024185180664 moveto
134.40023803710938 -84.40023803710938 lineto
166.40023803710938 -84.40023803710938 lineto
166.40023803710938 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -117.40023803710938 moveto
22.400239944458008 -139.40023803710938 lineto
166.40023803710938 -139.40023803710938 lineto
166.40023803710938 -117.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -172.40023803710938 moveto
22.400239944458008 -194.40023803710938 lineto
54.40024185180664 -194.40023803710938 lineto
54.40024185180664 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -172.40023803710938 moveto
78.40023803710938 -194.40023803710938 lineto
110.40023803710938 -194.40023803710938 lineto
110.40023803710938 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
134.40023803710938 -172.40023803710938 moveto
134.40023803710938 -194.40023803710938 lineto
166.40023803710938 -194.40023803710938 lineto
166.40023803710938 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
262.4002380371094 -62.40024185180664 moveto
262.4002380371094 -84.40023803710938 lineto
294.4002380371094 -84.40023803710938 lineto
294.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
318.4002380371094 -62.40024185180664 moveto
318.4002380371094 -84.40023803710938 lineto
350.4002380371094 -84.40023803710938 lineto
350.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
374.4002380371094 -62.40024185180664 moveto
374.4002380371094 -84.40023803710938 lineto
406.4002380371094 -84.40023803710938 lineto
406.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
262.4002380371094 -117.40023803710938 moveto
262.4002380371094 -139.40023803710938 lineto
406.4002380371094 -139.40023803710938 lineto
406.4002380371094 -117.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
262.4002380371094 -172.40023803710938 moveto
262.4002380371094 -194.40023803710938 lineto
294.4002380371094 -194.40023803710938 lineto
294.4002380371094 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
318.4002380371094 -172.40023803710938 moveto
318.4002380371094 -194.40023803710938 lineto
350.4002380371094 -194.40023803710938 lineto
350.4002380371094 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
374.4002380371094 -172.40023803710938 moveto
374.4002380371094 -194.40023803710938 lineto
406.4002380371094 -194.40023803710938 lineto
406.4002380371094 -172.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -60.0 moveto
20.0 -82.0 lineto
52.0 -82.0 lineto
52.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -60.0 moveto
20.0 -82.0 lineto
52.0 -82.0 lineto
52.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -60.0 moveto
76.0 -82.0 lineto
108.0 -82.0 lineto
108.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -60.0 moveto
76.0 -82.0 lineto
108.0 -82.0 lineto
108.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
132.0 -60.0 moveto
132.0 -82.0 lineto
164.0 -82.0 lineto
164.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
132.0 -60.0 moveto
132.0 -82.0 lineto
164.0 -82.0 lineto
164.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -115.0 moveto
20.0 -137.0 lineto
164.0 -137.0 lineto
164.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -115.0 moveto
20.0 -137.0 lineto
164.0 -137.0 lineto
164.0 -115.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -170.0 moveto
20.0 -192.0 lineto
52.0 -192.0 lineto
52.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -170.0 moveto
20.0 -192.0 lineto
52.0 -192.0 lineto
52.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -170.0 moveto
76.0 -192.0 lineto
108.0 -192.0 lineto
108.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -170.0 moveto
76.0 -192.0 lineto
108.0 -192.0 lineto
108.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
132.0 -170.0 moveto
132.0 -192.0 lineto
164.0 -192.0 lineto
164.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
132.0 -170.0 moveto
132.0 -192.0 lineto
164.0 -192.0 lineto
164.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
260.0 -60.0 moveto
260.0 -82.0 lineto
292.0 -82.0 lineto
292.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
260.0 -60.0 moveto
260.0 -82.0 lineto
292.0 -82.0 lineto
292.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
316.0 -60.0 moveto
316.0 -82.0 lineto
348.0 -82.0 lineto
348.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
316.0 -60.0 moveto
316.0 -82.0 lineto
348.0 -82.0 lineto
348.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
372.0 -60.0 moveto
372.0 -82.0 lineto
404.0 -82.0 lineto
404.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
372.0 -60.0 moveto
372.0 -82.0 lineto
404.0 -82.0 lineto
404.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
260.0 -115.0 moveto
260.0 -137.0 lineto
404.0 -137.0 lineto
404.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
260.0 -115.0 moveto
260.0 -137.0 lineto
404.0 -137.0 lineto
404.0 -115.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
260.0 -170.0 moveto
260.0 -192.0 lineto
292.0 -192.0 lineto
292.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
260.0 -170.0 moveto
260.0 -192.0 lineto
292.0 -192.0 lineto
292.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
316.0 -170.0 moveto
316.0 -192.0 lineto
348.0 -192.0 lineto
348.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
316.0 -170.0 moveto
316.0 -192.0 lineto
348.0 -192.0 lineto
348.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
372.0 -170.0 moveto
372.0 -192.0 lineto
404.0 -192.0 lineto
404.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
372.0 -170.0 moveto
372.0 -192.0 lineto
404.0 -192.0 lineto
404.0 -170.0 lineto
closepath
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
212.0 -22.0 moveto
212.0 -121.0 lineto
stroke
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
172.0 -126.0 moveto
252.0 -126.0 lineto
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
212.0 -132.0 moveto
212.0 -209.0 lineto
stroke
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
36.0 -82.0 moveto
36.0 -115.0 lineto
stroke
newpath
92.0 -82.0 moveto
92.0 -115.0 lineto
stroke
newpath
148.0 -82.0 moveto
148.0 -115.0 lineto
stroke
newpath
36.0 -137.0 moveto
36.0 -170.0 lineto
stroke
newpath
92.0 -137.0 moveto
92.0 -170.0 lineto
stroke
newpath
148.0 -137.0 moveto
148.0 -170.0 lineto
stroke
newpath
276.0 -82.0 moveto
276.0 -115.0 lineto
stroke
newpath
332.0 -82.0 moveto
332.0 -115.0 lineto
stroke
newpath
388.0 -82.0 moveto
388.0 -115.0 lineto
stroke
newpath
276.0 -137.0 moveto
276.0 -170.0 lineto
stroke
newpath
332.0 -137.0 moveto
332.0 -170.0 lineto
stroke
newpath
388.0 -137.0 moveto
388.0 -170.0 lineto
stroke
newpath
176.0 -121.0 moveto
168.0 -126.0 lineto
176.0 -132.0 lineto
closepath
fill
newpath
248.0 -121.0 moveto
256.0 -126.0 lineto
248.0 -132.0 lineto
closepath
fill
/Helvetica findfont
11 scalefont setfont
63.0 -32.0 moveto
(Cluster 1) show
303.0 -32.0 moveto
(Cluster 2) show
34.0 -76.0 moveto
(C ) show
90.0 -76.0 moveto
(C ) show
146.0 -76.0 moveto
(C ) show
274.0 -76.0 moveto
(C ) show
330.0 -76.0 moveto
(C ) show
386.0 -76.0 moveto
(C ) show
67.0 -131.0 moveto
(Broker) show
307.0 -131.0 moveto
(Broker) show
33.0 -186.0 moveto
(W ) show
89.0 -186.0 moveto
(W ) show
145.0 -186.0 moveto
(W ) show
273.0 -186.0 moveto
(W ) show
329.0 -186.0 moveto
(W ) show
385.0 -186.0 moveto
(W ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2139 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2139 a 274 x Fj(This)g(design)e(is)i
(appealing)e(because)g(the)i(problem)d(is)j(solv)o(ed)e(in)i(one)e
(place,)h(in)m(visible)g(to)g(the)g(rest)h(of)f(the)g(w)o(orld.)396
2521 y(Basically)-5 b(,)20 b(brok)o(ers)f(open)g(secret)i(channels)e
(to)h(each)g(other)g(and)f(whisper)m(,)g(lik)o(e)i(camel)f(traders,)f
("He)o(y)-5 b(,)19 b(I')l(v)o(e)g(got)396 2629 y(some)h(spare)g
(capacity)-5 b(,)19 b(if)h(you)g(ha)n(v)o(e)f(too)h(man)o(y)f(clients)i
(gi)n(v)o(e)e(me)h(a)h(shout)f(and)f(we')o(ll)i(deal".)-2
2813 y
SDict begin H.S end
 -2 2813 a -2 2813 a
SDict begin 13 H.A end
 -2 2813 a -2 2813 a
SDict begin [/View [/XYZ H.V]/Dest (0:1755) cvn /DEST pdfmark end
 -2 2813
a 396 2903 a Fj(It)g(is)g(in)f(ef)n(fect)g(just)h(a)f(more)g
(sophisticated)f(routing)f(algorithm:)h(brok)o(ers)g(become)g
(subcontractors)f(for)i(each)f(other)-5 b(.)396 3011
y(Other)20 b(things)g(to)g(lik)o(e)h(about)e(this)i(design,)e(e)n(v)o
(en)g(before)g(we)h(play)g(with)g(real)h(code:)-2 3029
y
SDict begin H.S end
 -2 3029 a -2 3029 a
SDict begin 13 H.A end
 -2 3029 a -2 3029 a
SDict begin [/View [/XYZ H.V]/Dest (0:1756) cvn /DEST pdfmark end
 -2 3029 a -2
3039 a
SDict begin H.S end
 -2 3039 a -2 3039 a
SDict begin 13 H.A end
 -2 3039 a -2 3039 a
SDict begin [/View [/XYZ H.V]/Dest (0:1757) cvn /DEST pdfmark end
 -2 3039
a Black 396 3181 a Fe(\225)p Black 479 3181 a
SDict begin H.S end
 479 3181
a 479 3181 a
SDict begin 13 H.A end
 479 3181 a 479 3181 a
SDict begin [/View [/XYZ H.V]/Dest (0:1758) cvn /DEST pdfmark end
 479 3181 a Fj(It)g(treats)f(the)h
(common)d(case)j(\(clients)f(and)f(w)o(ork)o(ers)h(on)g(the)g(same)g
(cluster\))g(as)h(def)o(ault)e(and)h(does)g(e)o(xtra)f(w)o(ork)h(for)
479 3289 y(the)g(e)o(xceptional)f(case)h(\(shuf)n(\003ing)f(jobs)h
(between)f(clusters\).)-2 3307 y
SDict begin H.S end
 -2 3307 a -2 3307 a
SDict begin 13 H.A end

-2 3307 a -2 3307 a
SDict begin [/View [/XYZ H.V]/Dest (0:1759) cvn /DEST pdfmark end
 -2 3307 a Black 396 3438 a Fe(\225)p
Black 479 3438 a
SDict begin H.S end
 479 3438 a 479 3438 a
SDict begin 13 H.A end
 479 3438 a 479
3438 a
SDict begin [/View [/XYZ H.V]/Dest (0:1760) cvn /DEST pdfmark end
 479 3438 a Fj(It)i(lets)g(us)f(use)h(dif)n(ferent)d(message)i
(\003o)n(ws)h(for)f(the)g(dif)n(ferent)e(types)i(of)g(w)o(ork.)f(That)h
(means)g(we)h(can)f(handle)f(them)479 3546 y(dif)n(ferently)-5
b(,)18 b(e.g.)h(using)h(dif)n(ferent)f(types)h(of)g(netw)o(ork)e
(connection.)-2 3564 y
SDict begin H.S end
 -2 3564 a -2 3564 a
SDict begin 13 H.A end
 -2 3564 a
-2 3564 a
SDict begin [/View [/XYZ H.V]/Dest (0:1761) cvn /DEST pdfmark end
 -2 3564 a Black 396 3696 a Fe(\225)p Black
479 3696 a
SDict begin H.S end
 479 3696 a 479 3696 a
SDict begin 13 H.A end
 479 3696 a 479 3696
a
SDict begin [/View [/XYZ H.V]/Dest (0:1762) cvn /DEST pdfmark end
 479 3696 a Fj(It)j(feels)f(lik)o(e)h(it)g(w)o(ould)e(scale)i
(smoothly)-5 b(.)18 b(Interconnecting)f(three,)i(or)h(more)g(brok)o
(ers)e(doesn')o(t)h(get)h(o)o(v)o(er)n(-comple)o(x.)479
3803 y(If)g(we)h(\002nd)f(this)h(to)f(be)g(a)h(problem,)d(it')-5
b(s)21 b(easy)f(to)h(solv)o(e)f(by)f(adding)g(a)i(super)n(-brok)o(er)-5
b(.)-2 3987 y
SDict begin H.S end
 -2 3987 a -2 3987 a
SDict begin 13 H.A end
 -2 3987 a -2 3987 a
SDict begin [/View [/XYZ H.V]/Dest (0:1763) cvn /DEST pdfmark end

-2 3987 a 396 4077 a Fj(W)e(e')o(ll)22 b(no)n(w)d(mak)o(e)h(a)h(w)o
(ork)o(ed)e(e)o(xample.)f(W)-7 b(e')o(ll)22 b(pack)d(an)h(entire)g
(cluster)g(into)g(one)g(process.)f(That)h(is)h(ob)o(viously)d(not)396
4185 y(realistic)j(b)n(ut)f(it)h(mak)o(es)f(it)h(simple)f(to)g
(simulate,)g(and)g(the)g(simulation)g(can)f(accurately)g(scale)i(to)f
(real)h(processes.)e(This)396 4293 y(is)i(the)g(beauty)e(of)h(\330MQ,)g
(you)f(can)h(design)g(at)g(the)h(microle)n(v)o(el)d(and)i(scale)g(that)
h(up)e(to)i(the)f(macro)f(le)n(v)o(el.)h(Threads)396
4401 y(become)f(processes,)h(become)f(box)o(es)g(and)h(the)g(patterns)f
(and)h(logic)g(remain)f(the)h(same.)h(Each)e(of)h(our)g('cluster')396
4509 y(processes)g(contains)g(client)g(threads,)f(w)o(ork)o(er)g
(threads,)h(and)f(a)i(brok)o(er)d(thread.)-2 4693 y
SDict begin H.S end
 -2
4693 a -2 4693 a
SDict begin 13 H.A end
 -2 4693 a -2 4693 a
SDict begin [/View [/XYZ H.V]/Dest (0:1764) cvn /DEST pdfmark end
 -2 4693 a 396 4783
a Fj(W)-7 b(e)22 b(kno)n(w)d(the)h(basic)g(model)g(well)g(by)g(no)n(w:)
-2 4801 y
SDict begin H.S end
 -2 4801 a -2 4801 a
SDict begin 13 H.A end
 -2 4801 a -2 4801 a
SDict begin [/View [/XYZ H.V]/Dest (0:1765) cvn /DEST pdfmark end
 -2
4801 a -2 4811 a
SDict begin H.S end
 -2 4811 a -2 4811 a
SDict begin 13 H.A end
 -2 4811 a -2 4811
a
SDict begin [/View [/XYZ H.V]/Dest (0:1766) cvn /DEST pdfmark end
 -2 4811 a Black 396 4953 a Fe(\225)p Black 479 4953
a
SDict begin H.S end
 479 4953 a 479 4953 a
SDict begin 13 H.A end
 479 4953 a 479 4953 a
SDict begin [/View [/XYZ H.V]/Dest (0:1767) cvn /DEST pdfmark end
 479 4953
a Fj(The)g(REQ)h(client)f(\(REQ\))g(threads)g(create)g(w)o(orkloads)e
(and)i(pass)h(them)f(to)g(the)g(brok)o(er)f(\(R)m(OUTER\).)-2
4971 y
SDict begin H.S end
 -2 4971 a -2 4971 a
SDict begin 13 H.A end
 -2 4971 a -2 4971 a
SDict begin [/View [/XYZ H.V]/Dest (0:1768) cvn /DEST pdfmark end
 -2 4971
a Black 396 5103 a Fe(\225)p Black 479 5103 a
SDict begin H.S end
 479 5103
a 479 5103 a
SDict begin 13 H.A end
 479 5103 a 479 5103 a
SDict begin [/View [/XYZ H.V]/Dest (0:1769) cvn /DEST pdfmark end
 479 5103 a Fj(The)h(REQ)h(w)o(ork)o
(er)e(\(REQ\))h(threads)g(process)f(w)o(orkloads)g(and)h(return)f(the)h
(results)h(to)f(the)g(brok)o(er)f(\(R)m(OUTER\).)-2 5121
y
SDict begin H.S end
 -2 5121 a -2 5121 a
SDict begin 13 H.A end
 -2 5121 a -2 5121 a
SDict begin [/View [/XYZ H.V]/Dest (0:1770) cvn /DEST pdfmark end
 -2 5121 a Black
3759 5569 a Fi(124)p Black eop end
%%Page: 125 139
TeXDict begin 125 138 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.125) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1771) cvn /DEST pdfmark end
 479 72 a Fj(The)20
b(brok)o(er)f(queues)g(and)h(distrib)n(utes)g(w)o(orkloads)f(using)g
(the)h(LR)m(U)h(routing)d(model.)-2 132 y
SDict begin H.S end
 -2 132 a -2
132 a
SDict begin 13 H.A end
 -2 132 a -2 132 a
SDict begin [/View [/XYZ H.V]/Dest (0:1772) cvn /DEST pdfmark end
 -2 132 a 396 442 a Fd(3.9.4.)36
b(Federation)e(vs.)g(P)l(eering)2006 442 y
SDict begin H.S end
 2006 442 a
2006 442 a
SDict begin 18.72 H.A end
 2006 442 a 2006 442 a
SDict begin [/View [/XYZ H.V]/Dest (8.39.20.2) cvn /DEST pdfmark end
 2006 442 a -2 635 a
SDict begin H.S end

-2 635 a -2 635 a
SDict begin 13 H.A end
 -2 635 a -2 635 a
SDict begin [/View [/XYZ H.V]/Dest (0:1774) cvn /DEST pdfmark end
 -2 635 a 396 716
a Fj(There)20 b(are)g(se)n(v)o(eral)f(possible)h(w)o(ays)h(to)f
(interconnect)e(brok)o(ers.)h(What)h(we)2593 716 y
SDict begin H.S end
 2593
716 a 2593 716 a
SDict begin 13 H.A end
 2593 716 a 2593 716 a
SDict begin [/View [/XYZ H.V]/Dest (0:1775) cvn /DEST pdfmark end
 2593 716 a Fi(want)i
Fj(is)f(to)f(be)g(able)g(to)h(tell)g(other)e(brok)o(ers,)396
824 y("we)i(ha)n(v)o(e)e(capacity",)g(and)h(then)g(recei)n(v)o(e)f
(multiple)g(tasks.)i(W)-7 b(e)21 b(also)g(need)e(to)i(be)f(able)g(to)g
(tell)h(other)e(brok)o(ers)g("stop,)396 932 y(we')l(re)h(full".)g(It)g
(doesn')o(t)f(need)g(to)i(be)f(perfect:)f(sometimes)h(we)g(may)g
(accept)g(jobs)g(we)h(can')o(t)e(process)h(immediately)-5
b(,)396 1040 y(then)20 b(we')o(ll)h(do)e(them)h(as)h(soon)f(as)g
(possible.)-2 1224 y
SDict begin H.S end
 -2 1224 a -2 1224 a
SDict begin 13 H.A end
 -2 1224 a -2
1224 a
SDict begin [/View [/XYZ H.V]/Dest (0:1776) cvn /DEST pdfmark end
 -2 1224 a 396 1314 a Fj(The)g(simplest)h(interconnect)d(is)1351
1314 y
SDict begin H.S end
 1351 1314 a 1351 1314 a
SDict begin 13 H.A end
 1351 1314 a 1351 1314
a
SDict begin [/View [/XYZ H.V]/Dest (0:1777) cvn /DEST pdfmark end
 1351 1314 a Fi(feder)o(ation)h Fj(in)h(which)g(brok)o(ers)f(simulate)
h(clients)g(and)g(w)o(ork)o(ers)f(for)h(each)g(other)-5
b(.)19 b(W)-7 b(e)396 1422 y(w)o(ould)20 b(do)g(this)g(by)g(connecting)
e(our)h(frontend)g(to)h(the)g(other)f(brok)o(er')-5 b(s)19
b(back)o(end)g(sock)o(et\()p 0 TeXcolorgray 3018 1422
a
SDict begin H.S end
 3018 1422 a Fj(Figure)f(3-24)3408 1422 y
SDict begin 13 H.L end
 3408 1422
a 3408 1422 a
SDict begin [/Subtype /Link/Dest (0:figure-49) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3408 1422 a Black -1 w Fj(\).)i(Note)g(that)g(it)396
1530 y(is)h(le)o(gal)f(to)g(both)g(bind)f(a)i(sock)o(et)f(to)g(an)g
(endpoint)e(and)i(connect)f(it)i(to)f(other)g(endpoints.)-2
1548 y
SDict begin H.S end
 -2 1548 a -2 1548 a
SDict begin 13 H.A end
 -2 1548 a -2 1548 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-49) cvn /DEST pdfmark
end
 -2 1548
a 396 1731 a Fk(Figur)o(e)g(3-24.)e(Cr)o(oss-connected)h(Br)o(ok)o(ers)
i(in)g(F)n(ederation)e(Model)-2 1831 y
SDict begin H.S end
 -2 1831 a -2 1831
a
SDict begin 13 H.A end
 -2 1831 a -2 1831 a
SDict begin [/View [/XYZ H.V]/Dest (0:1781) cvn /DEST pdfmark end
 -2 1831 a 396 3797 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3797 a
@beginspecial 0 @llx -231 @lly 432 @urx 0 @ury 4320 @rwi
@setspecial
%%BeginDocument: images/fig49.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -231 432 0
%%HiResBoundingBox: 0.0 -231.0 432.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -62.40024185180664 moveto
22.400239944458008 -84.40023803710938 lineto
54.40024185180664 -84.40023803710938 lineto
54.40024185180664 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -62.40024185180664 moveto
78.40023803710938 -84.40023803710938 lineto
110.40023803710938 -84.40023803710938 lineto
110.40023803710938 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -117.40023803710938 moveto
22.400239944458008 -139.40023803710938 lineto
166.40023803710938 -139.40023803710938 lineto
166.40023803710938 -117.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -172.40023803710938 moveto
22.400239944458008 -194.40023803710938 lineto
54.40024185180664 -194.40023803710938 lineto
54.40024185180664 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
78.40023803710938 -172.40023803710938 moveto
78.40023803710938 -194.40023803710938 lineto
110.40023803710938 -194.40023803710938 lineto
110.40023803710938 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
326.4002380371094 -62.40024185180664 moveto
326.4002380371094 -84.40023803710938 lineto
358.4002380371094 -84.40023803710938 lineto
358.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
382.4002380371094 -62.40024185180664 moveto
382.4002380371094 -84.40023803710938 lineto
414.4002380371094 -84.40023803710938 lineto
414.4002380371094 -62.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
270.4002380371094 -117.40023803710938 moveto
270.4002380371094 -139.40023803710938 lineto
414.4002380371094 -139.40023803710938 lineto
414.4002380371094 -117.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
326.4002380371094 -172.40023803710938 moveto
326.4002380371094 -194.40023803710938 lineto
358.4002380371094 -194.40023803710938 lineto
358.4002380371094 -172.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
382.4002380371094 -172.40023803710938 moveto
382.4002380371094 -194.40023803710938 lineto
414.4002380371094 -194.40023803710938 lineto
414.4002380371094 -172.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -60.0 moveto
20.0 -82.0 lineto
52.0 -82.0 lineto
52.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -60.0 moveto
20.0 -82.0 lineto
52.0 -82.0 lineto
52.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -60.0 moveto
76.0 -82.0 lineto
108.0 -82.0 lineto
108.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -60.0 moveto
76.0 -82.0 lineto
108.0 -82.0 lineto
108.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -115.0 moveto
20.0 -137.0 lineto
164.0 -137.0 lineto
164.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -115.0 moveto
20.0 -137.0 lineto
164.0 -137.0 lineto
164.0 -115.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -170.0 moveto
20.0 -192.0 lineto
52.0 -192.0 lineto
52.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -170.0 moveto
20.0 -192.0 lineto
52.0 -192.0 lineto
52.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
76.0 -170.0 moveto
76.0 -192.0 lineto
108.0 -192.0 lineto
108.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
76.0 -170.0 moveto
76.0 -192.0 lineto
108.0 -192.0 lineto
108.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
324.0 -60.0 moveto
324.0 -82.0 lineto
356.0 -82.0 lineto
356.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
324.0 -60.0 moveto
324.0 -82.0 lineto
356.0 -82.0 lineto
356.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
380.0 -60.0 moveto
380.0 -82.0 lineto
412.0 -82.0 lineto
412.0 -60.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
380.0 -60.0 moveto
380.0 -82.0 lineto
412.0 -82.0 lineto
412.0 -60.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
268.0 -115.0 moveto
268.0 -137.0 lineto
412.0 -137.0 lineto
412.0 -115.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
268.0 -115.0 moveto
268.0 -137.0 lineto
412.0 -137.0 lineto
412.0 -115.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
324.0 -170.0 moveto
324.0 -192.0 lineto
356.0 -192.0 lineto
356.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
324.0 -170.0 moveto
324.0 -192.0 lineto
356.0 -192.0 lineto
356.0 -170.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
380.0 -170.0 moveto
380.0 -192.0 lineto
412.0 -192.0 lineto
412.0 -170.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
380.0 -170.0 moveto
380.0 -192.0 lineto
412.0 -192.0 lineto
412.0 -170.0 lineto
closepath
stroke
0.8 setlinewidth
0 setlinecap
[4.0] 0.0 setdash
newpath
212.0 -22.0 moveto
212.0 -165.0 lineto
stroke
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
148.0 -148.0 moveto
148.0 -192.0 lineto
236.0 -192.0 lineto
236.0 -176.0 lineto
stroke
newpath
148.0 -115.0 moveto
148.0 -82.0 lineto
188.0 -82.0 lineto
188.0 -170.0 lineto
284.0 -170.0 lineto
284.0 -148.0 lineto
stroke
newpath
36.0 -82.0 moveto
36.0 -115.0 lineto
stroke
newpath
92.0 -82.0 moveto
92.0 -115.0 lineto
stroke
newpath
36.0 -137.0 moveto
36.0 -170.0 lineto
stroke
newpath
92.0 -137.0 moveto
92.0 -170.0 lineto
stroke
newpath
284.0 -115.0 moveto
284.0 -82.0 lineto
236.0 -82.0 lineto
236.0 -165.0 lineto
stroke
newpath
340.0 -82.0 moveto
340.0 -115.0 lineto
stroke
newpath
396.0 -82.0 moveto
396.0 -115.0 lineto
stroke
newpath
340.0 -137.0 moveto
340.0 -170.0 lineto
stroke
newpath
396.0 -137.0 moveto
396.0 -170.0 lineto
stroke
newpath
148.0 -143.0 moveto
144.0 -154.0 lineto
152.0 -154.0 lineto
closepath
fill
newpath
284.0 -143.0 moveto
280.0 -154.0 lineto
288.0 -154.0 lineto
closepath
fill
/Helvetica findfont
11 scalefont setfont
63.0 -32.0 moveto
(Cluster 1) show
303.0 -32.0 moveto
(Cluster 2) show
34.0 -76.0 moveto
(C ) show
90.0 -76.0 moveto
(C ) show
338.0 -76.0 moveto
(C ) show
394.0 -76.0 moveto
(C ) show
67.0 -131.0 moveto
(Broker) show
315.0 -131.0 moveto
(Broker) show
33.0 -186.0 moveto
(W ) show
89.0 -186.0 moveto
(W ) show
337.0 -186.0 moveto
(W ) show
393.0 -186.0 moveto
(W ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3797 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3797 a -2 3963 a
SDict begin H.S end
 -2 3963
a -2 3963 a
SDict begin 13 H.A end
 -2 3963 a -2 3963 a
SDict begin [/View [/XYZ H.V]/Dest (0:1784) cvn /DEST pdfmark end
 -2 3963 a 396 4071 a
Fj(This)i(w)o(ould)e(gi)n(v)o(e)h(us)g(simple)g(logic)g(in)g(both)g
(brok)o(ers)f(and)g(a)i(reasonably)d(good)h(mechanism:)g(when)h(there)f
(are)i(no)396 4179 y(clients,)g(tell)f(the)h(other)e(brok)o(er)g(')l
(ready',)f(and)h(accept)h(one)g(job)g(from)f(it.)h(The)g(problem)f(is)i
(also)f(that)h(it)g(is)g(too)f(simple)396 4287 y(for)g(this)h(problem.)
d(A)i(federated)f(brok)o(er)g(w)o(ould)g(be)h(able)g(to)h(handle)e
(only)g(one)h(task)g(at)h(once.)e(If)h(the)g(brok)o(er)396
4395 y(emulates)g(a)h(lock-step)e(client)h(and)g(w)o(ork)o(er)m(,)e(it)
j(is)g(by)f(de\002nition)f(also)i(going)e(to)h(be)g(lock-step)f(and)h
(if)g(it)h(has)g(lots)f(of)396 4503 y(a)n(v)n(ailable)g(w)o(ork)o(ers)f
(the)o(y)h(w)o(on')o(t)f(be)h(used.)g(Our)g(brok)o(ers)f(need)g(to)i
(be)f(connected)e(in)i(a)h(fully)f(asynchronous)d(f)o(ashion.)-2
4687 y
SDict begin H.S end
 -2 4687 a -2 4687 a
SDict begin 13 H.A end
 -2 4687 a -2 4687 a
SDict begin [/View [/XYZ H.V]/Dest (0:1785) cvn /DEST pdfmark end
 -2 4687
a 396 4777 a Fj(The)j(federation)e(model)i(is)h(perfect)e(for)h(other)f
(kinds)h(of)g(routing,)e(especially)i(service-oriented)d(architectures)
i(or)396 4885 y(SO)m(As)i(\(which)f(route)f(by)h(service)g(name)f(and)h
(proximity)e(rather)i(than)f(LR)m(U)i(or)f(round-robin)c(or)k(random)e
(scatter\).)396 4993 y(So)j(don')o(t)d(dismiss)j(it)g(as)g(useless,)g
(it')-5 b(s)21 b(just)g(not)f(right)f(for)h(least-recently)f(used)h
(and)f(cluster)h(load-balancing.)p Black 3759 5569 a
Fi(125)p Black eop end
%%Page: 126 140
TeXDict begin 126 139 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.126) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1786) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(So)21 b(instead)f(of)g(federation,)e
(let')-5 b(s)21 b(look)e(at)i(a)1694 72 y
SDict begin H.S end
 1694 72 a 1694
72 a
SDict begin 13 H.A end
 1694 72 a 1694 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1787) cvn /DEST pdfmark end
 1694 72 a Fi(peering)f Fj(approach)e(in)i
(which)g(brok)o(ers)f(are)h(e)o(xplicitly)f(a)o(w)o(are)h(of)g(each)396
180 y(other)g(and)f(talk)i(o)o(v)o(er)d(pri)n(vile)o(ged)g(channels.)h
(Let')-5 b(s)21 b(break)e(this)i(do)n(wn,)e(assuming)g(we)i(w)o(ant)f
(to)h(interconnect)d(N)396 288 y(brok)o(ers.)h(Each)h(brok)o(er)e(has)j
(\(N)f(-)g(1\))g(peers,)g(and)g(all)g(brok)o(ers)f(are)h(using)g(e)o
(xactly)f(the)i(same)f(code)f(and)h(logic.)g(There)396
396 y(are)g(tw)o(o)h(distinct)f(\003o)n(ws)h(of)f(information)d
(between)j(brok)o(ers:)-2 397 y
SDict begin H.S end
 -2 397 a -2 397 a
SDict begin 13 H.A end
 -2
397 a -2 397 a
SDict begin [/View [/XYZ H.V]/Dest (0:1788) cvn /DEST pdfmark end
 -2 397 a -2 407 a
SDict begin H.S end
 -2 407 a -2 407 a
SDict begin 13 H.A end
 -2
407 a -2 407 a
SDict begin [/View [/XYZ H.V]/Dest (0:1789) cvn /DEST pdfmark end
 -2 407 a Black 396 566 a Fe(\225)p Black
479 566 a
SDict begin H.S end
 479 566 a 479 566 a
SDict begin 13 H.A end
 479 566 a 479 566 a
SDict begin [/View [/XYZ H.V]/Dest (0:1790) cvn /DEST pdfmark end
 479
566 a Fj(Each)g(brok)o(er)f(needs)g(to)i(tell)g(its)g(peers)f(ho)n(w)f
(man)o(y)g(w)o(ork)o(ers)h(it)h(has)f(a)n(v)n(ailable)g(at)h(an)o(y)e
(time.)h(This)h(can)f(be)g(f)o(airly)479 674 y(simple)g(information,)e
(just)j(a)f(quantity)f(that)i(is)g(updated)d(re)o(gularly)-5
b(.)18 b(The)i(ob)o(vious)e(\(and)h(correct\))g(sock)o(et)h(pattern)479
782 y(for)g(this)h(is)g(publish-subscribe.)c(So)j(e)n(v)o(ery)f(brok)o
(er)g(opens)g(a)i(PUB)g(sock)o(et)f(and)g(publishes)f(state)i
(information)d(on)479 890 y(that,)i(and)g(e)n(v)o(ery)f(brok)o(er)f
(also)j(opens)e(a)i(SUB)g(sock)o(et)f(and)g(connects)f(that)h(to)h(the)
f(PUB)h(sock)o(et)f(of)g(e)n(v)o(ery)f(other)479 998
y(brok)o(er)m(,)f(to)j(get)f(state)h(information)d(from)h(its)i(peers.)
-2 1016 y
SDict begin H.S end
 -2 1016 a -2 1016 a
SDict begin 13 H.A end
 -2 1016 a -2 1016 a
SDict begin [/View [/XYZ H.V]/Dest (0:1791) cvn /DEST pdfmark end
 -2
1016 a Black 396 1148 a Fe(\225)p Black 479 1148 a
SDict begin H.S end
 479
1148 a 479 1148 a
SDict begin 13 H.A end
 479 1148 a 479 1148 a
SDict begin [/View [/XYZ H.V]/Dest (0:1792) cvn /DEST pdfmark end
 479 1148 a Fj(Each)f(brok)o(er)
e(needs)h(a)i(w)o(ay)f(to)g(dele)o(gate)e(tasks)i(to)g(a)h(peer)e(and)g
(get)h(replies)g(back,)f(asynchronously)-5 b(.)16 b(W)-7
b(e')o(ll)21 b(do)e(this)479 1256 y(using)h(R)m(OUTER/R)m(OUTER)g(\(R)m
(OUTER/R)m(OUTER\))g(sock)o(ets,)g(no)g(other)f(combination)f(w)o
(orks.)i(Each)f(brok)o(er)479 1363 y(has)h(tw)o(o)g(such)f(sock)o(ets:)
h(one)f(for)g(tasks)h(it)g(recei)n(v)o(es,)f(one)g(for)g(tasks)h(it)g
(dele)o(gates.)e(If)i(we)g(didn')o(t)e(use)i(tw)o(o)f(sock)o(ets)h(it)
479 1471 y(w)o(ould)g(be)g(more)f(w)o(ork)h(to)g(kno)n(w)f(whether)g
(we)i(were)f(reading)f(a)h(request)g(or)g(a)g(reply)g(each)g(time.)g
(That)g(w)o(ould)479 1579 y(mean)g(adding)f(more)g(information)f(to)i
(the)g(message)g(en)m(v)o(elope.)-2 1763 y
SDict begin H.S end
 -2 1763 a
-2 1763 a
SDict begin 13 H.A end
 -2 1763 a -2 1763 a
SDict begin [/View [/XYZ H.V]/Dest (0:1793) cvn /DEST pdfmark end
 -2 1763 a 396 1853 a Fj(And)g(there)g(is)
h(also)f(the)h(\003o)n(w)f(of)g(information)e(between)h(a)i(brok)o(er)d
(and)i(its)h(local)f(clients)h(and)e(w)o(ork)o(ers.)-2
1864 y
SDict begin H.S end
 -2 1864 a -2 1864 a
SDict begin 13 H.A end
 -2 1864 a -2 1864 a
SDict begin [/View [/XYZ H.V]/Dest (0:1794) cvn /DEST pdfmark end
 -2 1864
a 396 2192 a Fd(3.9.5.)36 b(The)d(Naming)i(Ceremon)n(y)2027
2192 y
SDict begin H.S end
 2027 2192 a 2027 2192 a
SDict begin 18.72 H.A end
 2027 2192 a 2027 2192
a
SDict begin [/View [/XYZ H.V]/Dest (8.39.21.2) cvn /DEST pdfmark end
 2027 2192 a -2 2384 a
SDict begin H.S end
 -2 2384 a -2 2384 a
SDict begin 13 H.A end
 -2 2384 a
-2 2384 a
SDict begin [/View [/XYZ H.V]/Dest (0:1796) cvn /DEST pdfmark end
 -2 2384 a 396 2466 a Fj(Three)20 b(\003o)n(ws)g(x)g(tw)o(o)h
(sock)o(ets)f(for)g(each)g(\003o)n(w)g(=)h(six)f(sock)o(ets)h(that)f
(we)g(ha)n(v)o(e)g(to)g(manage)f(in)i(the)f(brok)o(er)-5
b(.)19 b(Choosing)396 2574 y(good)g(names)h(is)h(vital)f(to)h(k)o
(eeping)e(a)h(multi-sock)o(et)f(juggling)g(act)h(reasonably)f(coherent)
f(in)j(our)e(minds.)h(Sock)o(ets)3763 2574 y
SDict begin H.S end
 3763 2574
a 3763 2574 a
SDict begin 13 H.A end
 3763 2574 a 3763 2574 a
SDict begin [/View [/XYZ H.V]/Dest (0:1797) cvn /DEST pdfmark end
 3763 2574 a Fi(do)396
2682 y Fj(something)f(and)h(what)g(the)o(y)f(do)h(should)f(form)g(the)i
(basis)f(for)g(their)g(names.)f(It')-5 b(s)21 b(about)f(being)f(able)h
(to)g(read)g(the)g(code)396 2790 y(se)n(v)o(eral)g(weeks)g(later)g(on)g
(a)h(cold)e(Monday)g(morning)f(before)h(cof)n(fee,)g(and)g(not)h
(feeling)f(pain.)-2 2974 y
SDict begin H.S end
 -2 2974 a -2 2974 a
SDict begin 13 H.A end
 -2 2974
a -2 2974 a
SDict begin [/View [/XYZ H.V]/Dest (0:1798) cvn /DEST pdfmark end
 -2 2974 a 396 3064 a Fj(Let')-5 b(s)21 b(do)f(a)g
(shamanistic)g(naming)f(ceremon)o(y)f(for)h(the)i(sock)o(ets.)f(The)g
(three)f(\003o)n(ws)i(are:)-2 3081 y
SDict begin H.S end
 -2 3081 a -2 3081
a
SDict begin 13 H.A end
 -2 3081 a -2 3081 a
SDict begin [/View [/XYZ H.V]/Dest (0:1799) cvn /DEST pdfmark end
 -2 3081 a -2 3091 a
SDict begin H.S end
 -2 3091 a -2
3091 a
SDict begin 13 H.A end
 -2 3091 a -2 3091 a
SDict begin [/View [/XYZ H.V]/Dest (0:1800) cvn /DEST pdfmark end
 -2 3091 a Black 396 3234 a
Fe(\225)p Black 479 3234 a
SDict begin H.S end
 479 3234 a 479 3234 a
SDict begin 13 H.A end
 479
3234 a 479 3234 a
SDict begin [/View [/XYZ H.V]/Dest (0:1801) cvn /DEST pdfmark end
 479 3234 a Fj(A)560 3234 y
SDict begin H.S end
 560 3234
a 560 3234 a
SDict begin 13 H.A end
 560 3234 a 560 3234 a
SDict begin [/View [/XYZ H.V]/Dest (0:1802) cvn /DEST pdfmark end
 560 3234 a Fi(local)f
Fj(request-reply)e(\003o)n(w)i(between)f(the)i(brok)o(er)d(and)i(its)h
(clients)f(and)g(w)o(ork)o(ers.)-2 3252 y
SDict begin H.S end
 -2 3252 a -2
3252 a
SDict begin 13 H.A end
 -2 3252 a -2 3252 a
SDict begin [/View [/XYZ H.V]/Dest (0:1803) cvn /DEST pdfmark end
 -2 3252 a Black 396 3383 a
Fe(\225)p Black 479 3383 a
SDict begin H.S end
 479 3383 a 479 3383 a
SDict begin 13 H.A end
 479
3383 a 479 3383 a
SDict begin [/View [/XYZ H.V]/Dest (0:1804) cvn /DEST pdfmark end
 479 3383 a Fj(A)560 3383 y
SDict begin H.S end
 560 3383
a 560 3383 a
SDict begin 13 H.A end
 560 3383 a 560 3383 a
SDict begin [/View [/XYZ H.V]/Dest (0:1805) cvn /DEST pdfmark end
 560 3383 a Fi(cloud)h
Fj(request-reply)d(\003o)n(w)j(between)e(the)h(brok)o(er)f(and)g(its)j
(peer)d(brok)o(ers.)-2 3401 y
SDict begin H.S end
 -2 3401 a -2 3401 a
SDict begin 13 H.A end
 -2
3401 a -2 3401 a
SDict begin [/View [/XYZ H.V]/Dest (0:1806) cvn /DEST pdfmark end
 -2 3401 a Black 396 3533 a Fe(\225)p
Black 479 3533 a
SDict begin H.S end
 479 3533 a 479 3533 a
SDict begin 13 H.A end
 479 3533 a 479
3533 a
SDict begin [/View [/XYZ H.V]/Dest (0:1807) cvn /DEST pdfmark end
 479 3533 a Fj(A)560 3533 y
SDict begin H.S end
 560 3533 a 560 3533
a
SDict begin 13 H.A end
 560 3533 a 560 3533 a
SDict begin [/View [/XYZ H.V]/Dest (0:1808) cvn /DEST pdfmark end
 560 3533 a Fi(state)i Fj(\003o)n(w)f(between)f
(the)h(brok)o(er)f(and)h(its)h(peer)f(brok)o(ers.)-2
3717 y
SDict begin H.S end
 -2 3717 a -2 3717 a
SDict begin 13 H.A end
 -2 3717 a -2 3717 a
SDict begin [/View [/XYZ H.V]/Dest (0:1809) cvn /DEST pdfmark end
 -2 3717
a 396 3807 a Fj(Finding)f(meaningful)f(names)i(that)g(are)h(all)f(the)h
(same)f(length)f(means)h(our)g(code)f(will)i(align)f(nicely)-5
b(.)19 b(It')-5 b(s)21 b(not)e(a)i(big)396 3914 y(thing,)e(b)n(ut)i
(attention)e(to)h(details)h(helps.)f(F)o(or)f(each)h(\003o)n(w)h(the)f
(brok)o(er)e(has)j(tw)o(o)f(sock)o(ets)h(that)f(we)g(can)g
(orthogonally)396 4022 y(call)h(the)f("frontend")e(and)i("back)o(end".)
e(W)-7 b(e')l(v)o(e)20 b(used)f(these)i(names)f(quite)g(often.)f(A)h
(frontend)e(recei)n(v)o(es)i(information)396 4130 y(or)g(tasks.)h(A)f
(back)o(end)f(sends)h(those)g(out)g(to)g(other)g(peers.)f(The)h
(conceptual)f(\003o)n(w)h(is)h(from)e(front)g(to)i(back)e(\(with)396
4238 y(replies)h(going)f(in)i(the)f(opposite)f(direction)g(from)g(back)
g(to)i(front\).)-2 4422 y
SDict begin H.S end
 -2 4422 a -2 4422 a
SDict begin 13 H.A end
 -2 4422
a -2 4422 a
SDict begin [/View [/XYZ H.V]/Dest (0:1810) cvn /DEST pdfmark end
 -2 4422 a 396 4512 a Fj(So)g(in)f(all)h(the)f(code)g(we)g
(write)g(for)g(this)h(tutorial)e(will)i(use)g(these)f(sock)o(et)g
(names:)-2 4513 y
SDict begin H.S end
 -2 4513 a -2 4513 a
SDict begin 13 H.A end
 -2 4513 a -2 4513
a
SDict begin [/View [/XYZ H.V]/Dest (0:1811) cvn /DEST pdfmark end
 -2 4513 a -2 4523 a
SDict begin H.S end
 -2 4523 a -2 4523 a
SDict begin 13 H.A end
 -2 4523 a -2
4523 a
SDict begin [/View [/XYZ H.V]/Dest (0:1812) cvn /DEST pdfmark end
 -2 4523 a Black 396 4682 a Fe(\225)p Black 479
4682 a
SDict begin H.S end
 479 4682 a 479 4682 a
SDict begin 13 H.A end
 479 4682 a 479 4682 a
SDict begin [/View [/XYZ H.V]/Dest (0:1813) cvn /DEST pdfmark end
 479
4682 a 479 4682 a
SDict begin H.S end
 479 4682 a 479 4682 a
SDict begin 13 H.A end
 479 4682 a 479
4682 a
SDict begin [/View [/XYZ H.V]/Dest (0:1814) cvn /DEST pdfmark end
 479 4682 a Fi(localfe)g Fj(and)867 4682 y
SDict begin H.S end
 867
4682 a 867 4682 a
SDict begin 13 H.A end
 867 4682 a 867 4682 a
SDict begin [/View [/XYZ H.V]/Dest (0:1815) cvn /DEST pdfmark end
 867 4682 a Fi(localbe)f
Fj(for)g(the)i(local)f(\003o)n(w)-5 b(.)-2 4699 y
SDict begin H.S end
 -2
4699 a -2 4699 a
SDict begin 13 H.A end
 -2 4699 a -2 4699 a
SDict begin [/View [/XYZ H.V]/Dest (0:1816) cvn /DEST pdfmark end
 -2 4699 a Black
396 4832 a Fe(\225)p Black 479 4832 a
SDict begin H.S end
 479 4832 a 479
4832 a
SDict begin 13 H.A end
 479 4832 a 479 4832 a
SDict begin [/View [/XYZ H.V]/Dest (0:1817) cvn /DEST pdfmark end
 479 4832 a 479 4832 a
SDict begin H.S end
 479
4832 a 479 4832 a
SDict begin 13 H.A end
 479 4832 a 479 4832 a
SDict begin [/View [/XYZ H.V]/Dest (0:1818) cvn /DEST pdfmark end
 479 4832 a Fi(cloudfe)19
b Fj(and)885 4832 y
SDict begin H.S end
 885 4832 a 885 4832 a
SDict begin 13 H.A end
 885 4832 a
885 4832 a
SDict begin [/View [/XYZ H.V]/Dest (0:1819) cvn /DEST pdfmark end
 885 4832 a Fi(cloudbe)g Fj(for)g(the)h(cloud)g(\003o)n(w)-5
b(.)-2 4849 y
SDict begin H.S end
 -2 4849 a -2 4849 a
SDict begin 13 H.A end
 -2 4849 a -2 4849 a
SDict begin [/View [/XYZ H.V]/Dest (0:1820) cvn /DEST pdfmark end

-2 4849 a Black 396 4981 a Fe(\225)p Black 479 4981 a
SDict begin H.S end

479 4981 a 479 4981 a
SDict begin 13 H.A end
 479 4981 a 479 4981 a
SDict begin [/View [/XYZ H.V]/Dest (0:1821) cvn /DEST pdfmark end
 479 4981
a 479 4981 a
SDict begin H.S end
 479 4981 a 479 4981 a
SDict begin 13 H.A end
 479 4981 a 479 4981
a
SDict begin [/View [/XYZ H.V]/Dest (0:1822) cvn /DEST pdfmark end
 479 4981 a Fi(statefe)21 b Fj(and)857 4981 y
SDict begin H.S end
 857 4981
a 857 4981 a
SDict begin 13 H.A end
 857 4981 a 857 4981 a
SDict begin [/View [/XYZ H.V]/Dest (0:1823) cvn /DEST pdfmark end
 857 4981 a Fi(statebe)f
Fj(for)g(the)g(state)h(\003o)n(w)-5 b(.)p Black 3757
5569 a Fi(126)p Black eop end
%%Page: 127 141
TeXDict begin 127 140 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.127) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1843) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1824) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(F)o(or)19 b(our)g(transport)f(and)h
(because)g(we')l(re)g(simulating)g(the)g(whole)g(thing)g(on)g(one)g
(box,)g(we')o(ll)g(use)3239 72 y
SDict begin H.S end
 3239 72 a 3239 72 a
SDict begin 13 H.A end

3239 72 a 3239 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1825) cvn /DEST pdfmark end
 3239 72 a Fg(ipc)h Fj(for)f(e)n(v)o(erything.)396
180 y(This)i(has)f(the)g(adv)n(antage)f(of)g(w)o(orking)g(lik)o(e)1705
180 y
SDict begin H.S end
 1705 180 a 1705 180 a
SDict begin 13 H.A end
 1705 180 a 1705 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:1826) cvn /DEST pdfmark end
 1705
180 a Fg(tcp)h Fj(in)g(terms)g(of)g(connecti)n(vity)e(\(i.e.)i(it')-5
b(s)22 b(a)e(disconnected)e(transport,)396 288 y(unlik)o(e)624
288 y
SDict begin H.S end
 624 288 a 624 288 a
SDict begin 13 H.A end
 624 288 a 624 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:1827) cvn /DEST pdfmark end
 624 288
a Fg(inproc)p Fj(\),)h(yet)h(we)h(don')o(t)d(need)i(IP)g(addresses)g
(or)g(DNS)h(names,)e(which)h(w)o(ould)g(be)g(a)g(pain)g(here.)f
(Instead,)h(we)396 396 y(will)h(use)678 396 y
SDict begin H.S end
 678 396
a 678 396 a
SDict begin 13 H.A end
 678 396 a 678 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1828) cvn /DEST pdfmark end
 678 396 a Fg(ipc)f Fj(endpoints)e
(called)1396 396 y
SDict begin H.S end
 1396 396 a 1396 396 a
SDict begin 13 H.A end
 1396 396 a 1396
396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1829) cvn /DEST pdfmark end
 1396 396 a Fi(something)p Fj(-)1767 396 y
SDict begin H.S end
 1767
396 a 1767 396 a
SDict begin 13 H.A end
 1767 396 a 1767 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1830) cvn /DEST pdfmark end
 1767 396 a Fg(local)p
Fj(,)2030 396 y
SDict begin H.S end
 2030 396 a 2030 396 a
SDict begin 13 H.A end
 2030 396 a 2030
396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1831) cvn /DEST pdfmark end
 2030 396 a Fi(something)p Fj(-)2401 396 y
SDict begin H.S end
 2401
396 a 2401 396 a
SDict begin 13 H.A end
 2401 396 a 2401 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1832) cvn /DEST pdfmark end
 2401 396 a Fg(cloud)p
Fj(,)g(and)2805 396 y
SDict begin H.S end
 2805 396 a 2805 396 a
SDict begin 13 H.A end
 2805 396
a 2805 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1833) cvn /DEST pdfmark end
 2805 396 a Fi(something)p Fj(-)3176 396
y
SDict begin H.S end
 3176 396 a 3176 396 a
SDict begin 13 H.A end
 3176 396 a 3176 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:1834) cvn /DEST pdfmark end
 3176 396
a Fg(state)p Fj(,)g(where)396 504 y
SDict begin H.S end
 396 504 a 396 504
a
SDict begin 13 H.A end
 396 504 a 396 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:1835) cvn /DEST pdfmark end
 396 504 a Fi(something)h Fj(is)i(the)g(name)e(of)
h(our)g(simulated)f(cluster)-5 b(.)-2 687 y
SDict begin H.S end
 -2 687 a
-2 687 a
SDict begin 13 H.A end
 -2 687 a -2 687 a
SDict begin [/View [/XYZ H.V]/Dest (0:1836) cvn /DEST pdfmark end
 -2 687 a 396 778 a Fj(Y)c(ou)20
b(may)f(be)h(thinking)e(that)i(this)h(is)g(a)f(lot)g(of)g(w)o(ork)f
(for)h(some)f(names.)h(Why)f(not)h(call)g(them)g(s1,)g(s2,)g(s3,)g(s4,)
g(etc.?)g(The)396 886 y(answer)g(is)h(that)g(if)f(your)f(brain)g(is)i
(not)f(a)h(perfect)e(machine,)g(you)g(need)h(a)g(lot)h(of)f(help)f
(when)h(reading)f(code,)g(and)h(we')o(ll)396 994 y(see)h(that)f(these)h
(names)f(do)f(help.)h(It')-5 b(s)21 b(easier)f(to)g(remember)f("three)g
(\003o)n(ws,)i(tw)o(o)f(directions")f(than)h("six)g(dif)n(ferent)396
1102 y(sock)o(ets"\()p 0 TeXcolorgray 702 1102 a
SDict begin H.S end
 702
1102 a Fj(Figure)f(3-25)1093 1102 y
SDict begin 13 H.L end
 1093 1102 a 1093
1102 a
SDict begin [/Subtype /Link/Dest (0:figure-50) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1093 1102 a Black -2 w Fj(\).)-2 1120 y
SDict begin H.S end
 -2 1120
a -2 1120 a
SDict begin 13 H.A end
 -2 1120 a -2 1120 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-50) cvn /DEST pdfmark
end
 -2 1120 a Black 3756
5569 a Fi(127)p Black eop end
%%Page: 128 142
TeXDict begin 128 141 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.128) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-25.)e(Br)o(ok)o(er)i
(Sock)o(et)h(Arrangement)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2
172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1840) cvn /DEST pdfmark end
 -2 172 a 396 3972 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3972 a @beginspecial
0 @llx -451 @lly 416 @urx 0 @ury 4160 @rwi @setspecial
%%BeginDocument: images/fig50.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -451 416 0
%%HiResBoundingBox: 0.0 -451.0 416.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -29.400239944458008 moveto
22.400239944458008 -60.40024185180664 lineto
102.40023803710938 -60.40024185180664 lineto
102.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -63.40024185180664 moveto
22.400239944458008 -84.40023803710938 lineto
102.40023803710938 -84.40023803710938 lineto
102.40023803710938 -63.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
118.40023803710938 -29.400239944458008 moveto
118.40023803710938 -60.40024185180664 lineto
198.40023803710938 -60.40024185180664 lineto
198.40023803710938 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
118.40023803710938 -63.40024185180664 moveto
118.40023803710938 -84.40023803710938 lineto
198.40023803710938 -84.40023803710938 lineto
198.40023803710938 -63.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
214.40023803710938 -29.400239944458008 moveto
214.40023803710938 -60.40024185180664 lineto
294.4002380371094 -60.40024185180664 lineto
294.4002380371094 -29.400239944458008 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
214.40023803710938 -63.40024185180664 moveto
214.40023803710938 -84.40023803710938 lineto
294.4002380371094 -84.40023803710938 lineto
294.4002380371094 -63.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.40024185180664 -150.40023803710938 moveto
38.40024185180664 -170.40023803710938 lineto
116.40023803710938 -170.40023803710938 lineto
116.40023803710938 -150.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
119.40023803710938 -150.40023803710938 moveto
119.40023803710938 -170.40023803710938 lineto
196.40023803710938 -170.40023803710938 lineto
196.40023803710938 -150.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
199.40023803710938 -150.40023803710938 moveto
199.40023803710938 -170.40023803710938 lineto
278.4002380371094 -170.40023803710938 lineto
278.4002380371094 -150.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.40024185180664 -173.40023803710938 moveto
38.40024185180664 -205.40023803710938 lineto
116.40023803710938 -205.40023803710938 lineto
116.40023803710938 -173.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
119.40023803710938 -173.40023803710938 moveto
119.40023803710938 -205.40023803710938 lineto
196.40023803710938 -205.40023803710938 lineto
196.40023803710938 -173.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
199.40023803710938 -173.40023803710938 moveto
199.40023803710938 -205.40023803710938 lineto
278.4002380371094 -205.40023803710938 lineto
278.4002380371094 -173.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.40024185180664 -205.40023803710938 moveto
38.40024185180664 -249.40023803710938 lineto
278.4002380371094 -249.40023803710938 lineto
278.4002380371094 -205.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.40024185180664 -249.40023803710938 moveto
38.40024185180664 -280.4002380371094 lineto
116.40023803710938 -280.4002380371094 lineto
116.40023803710938 -249.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
119.40023803710938 -249.40023803710938 moveto
119.40023803710938 -280.4002380371094 lineto
196.40023803710938 -280.4002380371094 lineto
196.40023803710938 -249.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
199.40023803710938 -249.40023803710938 moveto
199.40023803710938 -280.4002380371094 lineto
278.4002380371094 -280.4002380371094 lineto
278.4002380371094 -249.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.40024185180664 -283.4002380371094 moveto
38.40024185180664 -304.4002380371094 lineto
116.40023803710938 -304.4002380371094 lineto
116.40023803710938 -283.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
119.40023803710938 -283.4002380371094 moveto
119.40023803710938 -304.4002380371094 lineto
196.40023803710938 -304.4002380371094 lineto
196.40023803710938 -283.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
199.40023803710938 -283.4002380371094 moveto
199.40023803710938 -304.4002380371094 lineto
278.4002380371094 -304.4002380371094 lineto
278.4002380371094 -283.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -370.4002380371094 moveto
22.400239944458008 -390.4002380371094 lineto
102.40023803710938 -390.4002380371094 lineto
102.40023803710938 -370.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -393.4002380371094 moveto
22.400239944458008 -425.4002380371094 lineto
102.40023803710938 -425.4002380371094 lineto
102.40023803710938 -393.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
118.40023803710938 -370.4002380371094 moveto
118.40023803710938 -390.4002380371094 lineto
198.40023803710938 -390.4002380371094 lineto
198.40023803710938 -370.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
118.40023803710938 -393.4002380371094 moveto
118.40023803710938 -425.4002380371094 lineto
198.40023803710938 -425.4002380371094 lineto
198.40023803710938 -393.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
214.40023803710938 -370.4002380371094 moveto
214.40023803710938 -390.4002380371094 lineto
294.4002380371094 -390.4002380371094 lineto
294.4002380371094 -370.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
214.40023803710938 -393.4002380371094 moveto
214.40023803710938 -425.4002380371094 lineto
294.4002380371094 -425.4002380371094 lineto
294.4002380371094 -393.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -27.0 moveto
20.0 -58.0 lineto
100.0 -58.0 lineto
100.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -27.0 moveto
20.0 -58.0 lineto
100.0 -58.0 lineto
100.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -61.0 moveto
20.0 -82.0 lineto
100.0 -82.0 lineto
100.0 -61.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -61.0 moveto
20.0 -82.0 lineto
100.0 -82.0 lineto
100.0 -61.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
116.0 -27.0 moveto
116.0 -58.0 lineto
196.0 -58.0 lineto
196.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
116.0 -27.0 moveto
116.0 -58.0 lineto
196.0 -58.0 lineto
196.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
116.0 -61.0 moveto
116.0 -82.0 lineto
196.0 -82.0 lineto
196.0 -61.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
116.0 -61.0 moveto
116.0 -82.0 lineto
196.0 -82.0 lineto
196.0 -61.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
212.0 -27.0 moveto
212.0 -58.0 lineto
292.0 -58.0 lineto
292.0 -27.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
212.0 -27.0 moveto
212.0 -58.0 lineto
292.0 -58.0 lineto
292.0 -27.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
212.0 -61.0 moveto
212.0 -82.0 lineto
292.0 -82.0 lineto
292.0 -61.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
212.0 -61.0 moveto
212.0 -82.0 lineto
292.0 -82.0 lineto
292.0 -61.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
36.0 -148.0 moveto
36.0 -168.0 lineto
114.0 -168.0 lineto
114.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
36.0 -148.0 moveto
36.0 -168.0 lineto
114.0 -168.0 lineto
114.0 -148.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
117.0 -148.0 moveto
117.0 -168.0 lineto
194.0 -168.0 lineto
194.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
117.0 -148.0 moveto
117.0 -168.0 lineto
194.0 -168.0 lineto
194.0 -148.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
197.0 -148.0 moveto
197.0 -168.0 lineto
276.0 -168.0 lineto
276.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
197.0 -148.0 moveto
197.0 -168.0 lineto
276.0 -168.0 lineto
276.0 -148.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
36.0 -171.0 moveto
36.0 -203.0 lineto
114.0 -203.0 lineto
114.0 -171.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
36.0 -171.0 moveto
36.0 -203.0 lineto
114.0 -203.0 lineto
114.0 -171.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
117.0 -171.0 moveto
117.0 -203.0 lineto
194.0 -203.0 lineto
194.0 -171.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
117.0 -171.0 moveto
117.0 -203.0 lineto
194.0 -203.0 lineto
194.0 -171.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
197.0 -171.0 moveto
197.0 -203.0 lineto
276.0 -203.0 lineto
276.0 -171.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
197.0 -171.0 moveto
197.0 -203.0 lineto
276.0 -203.0 lineto
276.0 -171.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
36.0 -203.0 moveto
36.0 -247.0 lineto
276.0 -247.0 lineto
276.0 -203.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
36.0 -203.0 moveto
36.0 -247.0 lineto
276.0 -247.0 lineto
276.0 -203.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
36.0 -247.0 moveto
36.0 -278.0 lineto
114.0 -278.0 lineto
114.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
36.0 -247.0 moveto
36.0 -278.0 lineto
114.0 -278.0 lineto
114.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
117.0 -247.0 moveto
117.0 -278.0 lineto
194.0 -278.0 lineto
194.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
117.0 -247.0 moveto
117.0 -278.0 lineto
194.0 -278.0 lineto
194.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
197.0 -247.0 moveto
197.0 -278.0 lineto
276.0 -278.0 lineto
276.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
197.0 -247.0 moveto
197.0 -278.0 lineto
276.0 -278.0 lineto
276.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
36.0 -281.0 moveto
36.0 -302.0 lineto
114.0 -302.0 lineto
114.0 -281.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
36.0 -281.0 moveto
36.0 -302.0 lineto
114.0 -302.0 lineto
114.0 -281.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
117.0 -281.0 moveto
117.0 -302.0 lineto
194.0 -302.0 lineto
194.0 -281.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
117.0 -281.0 moveto
117.0 -302.0 lineto
194.0 -302.0 lineto
194.0 -281.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
197.0 -281.0 moveto
197.0 -302.0 lineto
276.0 -302.0 lineto
276.0 -281.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
197.0 -281.0 moveto
197.0 -302.0 lineto
276.0 -302.0 lineto
276.0 -281.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -368.0 moveto
20.0 -388.0 lineto
100.0 -388.0 lineto
100.0 -368.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -368.0 moveto
20.0 -388.0 lineto
100.0 -388.0 lineto
100.0 -368.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -391.0 moveto
20.0 -423.0 lineto
100.0 -423.0 lineto
100.0 -391.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -391.0 moveto
20.0 -423.0 lineto
100.0 -423.0 lineto
100.0 -391.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
116.0 -368.0 moveto
116.0 -388.0 lineto
196.0 -388.0 lineto
196.0 -368.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
116.0 -368.0 moveto
116.0 -388.0 lineto
196.0 -388.0 lineto
196.0 -368.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
116.0 -391.0 moveto
116.0 -423.0 lineto
196.0 -423.0 lineto
196.0 -391.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
116.0 -391.0 moveto
116.0 -423.0 lineto
196.0 -423.0 lineto
196.0 -391.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
212.0 -368.0 moveto
212.0 -388.0 lineto
292.0 -388.0 lineto
292.0 -368.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
212.0 -368.0 moveto
212.0 -388.0 lineto
292.0 -388.0 lineto
292.0 -368.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
212.0 -391.0 moveto
212.0 -423.0 lineto
292.0 -423.0 lineto
292.0 -391.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
212.0 -391.0 moveto
212.0 -423.0 lineto
292.0 -423.0 lineto
292.0 -391.0 lineto
closepath
stroke
newpath
60.0 -99.0 moveto
60.0 -115.0 lineto
76.0 -115.0 lineto
76.0 -137.0 lineto
stroke
newpath
156.0 -99.0 moveto
156.0 -137.0 lineto
stroke
newpath
252.0 -99.0 moveto
252.0 -115.0 lineto
236.0 -115.0 lineto
236.0 -137.0 lineto
stroke
newpath
76.0 -319.0 moveto
76.0 -335.0 lineto
60.0 -335.0 lineto
60.0 -357.0 lineto
stroke
newpath
156.0 -319.0 moveto
156.0 -357.0 lineto
stroke
newpath
236.0 -319.0 moveto
236.0 -335.0 lineto
252.0 -335.0 lineto
252.0 -357.0 lineto
stroke
newpath
72.0 -132.0 moveto
76.0 -143.0 lineto
80.0 -132.0 lineto
closepath
fill
newpath
152.0 -132.0 moveto
156.0 -143.0 lineto
160.0 -132.0 lineto
closepath
fill
newpath
232.0 -132.0 moveto
236.0 -143.0 lineto
240.0 -132.0 lineto
closepath
fill
newpath
56.0 -352.0 moveto
60.0 -363.0 lineto
64.0 -352.0 lineto
closepath
fill
newpath
152.0 -352.0 moveto
156.0 -363.0 lineto
160.0 -352.0 lineto
closepath
fill
newpath
248.0 -352.0 moveto
252.0 -363.0 lineto
256.0 -352.0 lineto
closepath
fill
/Helvetica findfont
11 scalefont setfont
37.0 -43.0 moveto
(Client) show
128.0 -43.0 moveto
(Broker) show
128.0 -54.0 moveto
(cloudbe) show
224.0 -43.0 moveto
(Broker) show
224.0 -54.0 moveto
(statebe) show
35.0 -76.0 moveto
(connect) show
131.0 -76.0 moveto
(connect) show
234.0 -76.0 moveto
(bind) show
36.0 -98.0 moveto
(request) show
132.0 -98.0 moveto
(request) show
236.0 -98.0 moveto
(state) show
58.0 -164.0 moveto
(bind) show
138.0 -164.0 moveto
(bind) show
211.0 -164.0 moveto
(connect) show
48.0 -186.0 moveto
(localfe) show
48.0 -197.0 moveto
(ROUTER) show
128.0 -186.0 moveto
(cloudfe) show
128.0 -197.0 moveto
(ROUTER) show
213.0 -186.0 moveto
(statefe) show
225.0 -197.0 moveto
(SUB) show
320.0 -186.0 moveto
(Frontends) show
320.0 -197.0 moveto
(\(incoming\)) show
131.0 -230.0 moveto
(Broker) show
48.0 -263.0 moveto
(ROUTER) show
48.0 -274.0 moveto
(localbe) show
128.0 -263.0 moveto
(ROUTER) show
128.0 -274.0 moveto
(cloudbe) show
225.0 -263.0 moveto
(PUB) show
212.0 -274.0 moveto
(statebe) show
320.0 -263.0 moveto
(Backends) show
320.0 -274.0 moveto
(\(outgoing\)) show
58.0 -296.0 moveto
(bind) show
131.0 -296.0 moveto
(connect) show
218.0 -296.0 moveto
(bind) show
52.0 -318.0 moveto
(request) show
132.0 -318.0 moveto
(request) show
220.0 -318.0 moveto
(state) show
35.0 -384.0 moveto
(connect) show
138.0 -384.0 moveto
(bind) show
227.0 -384.0 moveto
(connect) show
33.0 -406.0 moveto
(Worker) show
128.0 -406.0 moveto
(Broker) show
128.0 -417.0 moveto
(cloudfe) show
224.0 -406.0 moveto
(Broker) show
224.0 -417.0 moveto
(statefe) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3972 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3972 a 274 x Fj(Note)f(that)h(we)f(connect)
f(the)h(cloudbe)f(in)h(each)g(brok)o(er)f(to)h(the)g(cloudfe)f(in)h(e)n
(v)o(ery)f(other)h(brok)o(er)m(,)e(and)h(lik)o(e)n(wise)i(we)396
4354 y(connect)e(the)h(statebe)h(in)f(each)g(brok)o(er)f(to)h(the)g
(statefe)h(in)f(e)n(v)o(ery)f(other)g(brok)o(er)-5 b(.)-2
4382 y
SDict begin H.S end
 -2 4382 a -2 4382 a
SDict begin 13 H.A end
 -2 4382 a -2 4382 a
SDict begin [/View [/XYZ H.V]/Dest (0:1844) cvn /DEST pdfmark end
 -2 4382
a 396 4693 a Fd(3.9.6.)36 b(Pr)n(ototyping)c(the)i(State)f(Flo)n(w)2238
4693 y
SDict begin H.S end
 2238 4693 a 2238 4693 a
SDict begin 18.72 H.A end
 2238 4693 a 2238 4693
a
SDict begin [/View [/XYZ H.V]/Dest (8.39.22.2) cvn /DEST pdfmark end
 2238 4693 a -2 4885 a
SDict begin H.S end
 -2 4885 a -2 4885 a
SDict begin 13 H.A end
 -2 4885 a
-2 4885 a
SDict begin [/View [/XYZ H.V]/Dest (0:1846) cvn /DEST pdfmark end
 -2 4885 a 396 4967 a Fj(Since)20 b(each)g(sock)o(et)g(\003o)n
(w)h(has)f(its)h(o)n(wn)f(little)h(traps)f(for)g(the)g(unw)o(ary)-5
b(,)18 b(we)j(will)g(test)g(them)f(in)g(real)g(code)g(one)f(by)h(one,)
396 5074 y(rather)g(than)f(try)h(to)h(thro)n(w)e(the)h(whole)g(lot)g
(into)g(code)g(in)g(one)g(go.)f(When)h(we')l(re)g(happ)o(y)f(with)h
(each)g(\003o)n(w)-5 b(,)20 b(we)g(can)g(put)p Black
3759 5569 a Fi(128)p Black eop end
%%Page: 129 143
TeXDict begin 129 142 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.129) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1853) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black 396 72 a Fj(them)20 b(together)f(into)h(a)g
(full)h(program.)c(W)-7 b(e')o(ll)22 b(start)e(with)h(the)f(state)h
(\003o)n(w\()p 0 TeXcolorgray 2546 72 a
SDict begin H.S end
 2546 72 a Fj(Figure)e(3-26)2937
72 y
SDict begin 13 H.L end
 2937 72 a 2937 72 a
SDict begin [/Subtype /Link/Dest (0:figure-51) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2937 72 a Black -2 w Fj(\).)-2
90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-51) cvn /DEST pdfmark
end
 -2 90 a Black 3759
5569 a Fi(129)p Black eop end
%%Page: 130 144
TeXDict begin 130 143 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.130) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-26.)e(The)k(State)d(Flo)
o(w)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1850) cvn /DEST pdfmark end
 -2 172
a 396 4997 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4997 a @beginspecial 0 @llx -574 @lly
370 @urx 0 @ury 3700 @rwi @setspecial
%%BeginDocument: images/fig51.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -574 370 0
%%HiResBoundingBox: 0.0 -574.0 370.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
248.00030517578125 -38.000301361083984 moveto
248.00030517578125 -78.00029754638672 lineto
348.00030517578125 -78.00029754638672 lineto
348.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
248.00030517578125 -82.00029754638672 moveto
248.00030517578125 -108.00029754638672 lineto
348.00030517578125 -108.00029754638672 lineto
348.00030517578125 -82.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -192.00030517578125 moveto
28.00029945373535 -218.00030517578125 lineto
126.00029754638672 -218.00030517578125 lineto
126.00029754638672 -192.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
130.00030517578125 -192.00030517578125 moveto
130.00030517578125 -218.00030517578125 lineto
226.00030517578125 -218.00030517578125 lineto
226.00030517578125 -192.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
230.00030517578125 -192.00030517578125 moveto
230.00030517578125 -218.00030517578125 lineto
328.00030517578125 -218.00030517578125 lineto
328.00030517578125 -192.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -222.00030517578125 moveto
28.00029945373535 -262.00030517578125 lineto
126.00029754638672 -262.00030517578125 lineto
126.00029754638672 -222.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
130.00030517578125 -222.00030517578125 moveto
130.00030517578125 -262.00030517578125 lineto
226.00030517578125 -262.00030517578125 lineto
226.00030517578125 -222.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
230.00030517578125 -222.00030517578125 moveto
230.00030517578125 -262.00030517578125 lineto
328.00030517578125 -262.00030517578125 lineto
328.00030517578125 -222.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -262.00030517578125 moveto
28.00029945373535 -318.00030517578125 lineto
328.00030517578125 -318.00030517578125 lineto
328.00030517578125 -262.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -318.00030517578125 moveto
28.00029945373535 -358.00030517578125 lineto
126.00029754638672 -358.00030517578125 lineto
126.00029754638672 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
130.00030517578125 -318.00030517578125 moveto
130.00030517578125 -358.00030517578125 lineto
226.00030517578125 -358.00030517578125 lineto
226.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
230.00030517578125 -318.00030517578125 moveto
230.00030517578125 -358.00030517578125 lineto
328.00030517578125 -358.00030517578125 lineto
328.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -362.00030517578125 moveto
28.00029945373535 -388.00030517578125 lineto
126.00029754638672 -388.00030517578125 lineto
126.00029754638672 -362.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
130.00030517578125 -362.00030517578125 moveto
130.00030517578125 -388.00030517578125 lineto
226.00030517578125 -388.00030517578125 lineto
226.00030517578125 -362.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
230.00030517578125 -362.00030517578125 moveto
230.00030517578125 -388.00030517578125 lineto
328.00030517578125 -388.00030517578125 lineto
328.00030517578125 -362.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
248.00030517578125 -472.00030517578125 moveto
248.00030517578125 -498.00030517578125 lineto
348.00030517578125 -498.00030517578125 lineto
348.00030517578125 -472.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
248.00030517578125 -502.00030517578125 moveto
248.00030517578125 -542.0003051757812 lineto
348.00030517578125 -542.0003051757812 lineto
348.00030517578125 -502.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
245.0 -35.0 moveto
245.0 -75.0 lineto
345.0 -75.0 lineto
345.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
245.0 -35.0 moveto
245.0 -75.0 lineto
345.0 -75.0 lineto
345.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
245.0 -79.0 moveto
245.0 -105.0 lineto
345.0 -105.0 lineto
345.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
245.0 -79.0 moveto
245.0 -105.0 lineto
345.0 -105.0 lineto
345.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -189.0 moveto
25.0 -215.0 lineto
123.0 -215.0 lineto
123.0 -189.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -189.0 moveto
25.0 -215.0 lineto
123.0 -215.0 lineto
123.0 -189.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
127.0 -189.0 moveto
127.0 -215.0 lineto
223.0 -215.0 lineto
223.0 -189.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
127.0 -189.0 moveto
127.0 -215.0 lineto
223.0 -215.0 lineto
223.0 -189.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
227.0 -189.0 moveto
227.0 -215.0 lineto
325.0 -215.0 lineto
325.0 -189.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
227.0 -189.0 moveto
227.0 -215.0 lineto
325.0 -215.0 lineto
325.0 -189.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -219.0 moveto
25.0 -259.0 lineto
123.0 -259.0 lineto
123.0 -219.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -219.0 moveto
25.0 -259.0 lineto
123.0 -259.0 lineto
123.0 -219.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
127.0 -219.0 moveto
127.0 -259.0 lineto
223.0 -259.0 lineto
223.0 -219.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
127.0 -219.0 moveto
127.0 -259.0 lineto
223.0 -259.0 lineto
223.0 -219.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
227.0 -219.0 moveto
227.0 -259.0 lineto
325.0 -259.0 lineto
325.0 -219.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
227.0 -219.0 moveto
227.0 -259.0 lineto
325.0 -259.0 lineto
325.0 -219.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -259.0 moveto
25.0 -315.0 lineto
325.0 -315.0 lineto
325.0 -259.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -259.0 moveto
25.0 -315.0 lineto
325.0 -315.0 lineto
325.0 -259.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -315.0 moveto
25.0 -355.0 lineto
123.0 -355.0 lineto
123.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -315.0 moveto
25.0 -355.0 lineto
123.0 -355.0 lineto
123.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
127.0 -315.0 moveto
127.0 -355.0 lineto
223.0 -355.0 lineto
223.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
127.0 -315.0 moveto
127.0 -355.0 lineto
223.0 -355.0 lineto
223.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
227.0 -315.0 moveto
227.0 -355.0 lineto
325.0 -355.0 lineto
325.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
227.0 -315.0 moveto
227.0 -355.0 lineto
325.0 -355.0 lineto
325.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -359.0 moveto
25.0 -385.0 lineto
123.0 -385.0 lineto
123.0 -359.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -359.0 moveto
25.0 -385.0 lineto
123.0 -385.0 lineto
123.0 -359.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
127.0 -359.0 moveto
127.0 -385.0 lineto
223.0 -385.0 lineto
223.0 -359.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
127.0 -359.0 moveto
127.0 -385.0 lineto
223.0 -385.0 lineto
223.0 -359.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
227.0 -359.0 moveto
227.0 -385.0 lineto
325.0 -385.0 lineto
325.0 -359.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
227.0 -359.0 moveto
227.0 -385.0 lineto
325.0 -385.0 lineto
325.0 -359.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
245.0 -469.0 moveto
245.0 -495.0 lineto
345.0 -495.0 lineto
345.0 -469.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
245.0 -469.0 moveto
245.0 -495.0 lineto
345.0 -495.0 lineto
345.0 -469.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
245.0 -499.0 moveto
245.0 -539.0 lineto
345.0 -539.0 lineto
345.0 -499.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
245.0 -499.0 moveto
245.0 -539.0 lineto
345.0 -539.0 lineto
345.0 -499.0 lineto
closepath
stroke
newpath
295.0 -126.0 moveto
295.0 -147.0 lineto
275.0 -147.0 lineto
275.0 -175.0 lineto
stroke
newpath
275.0 -406.0 moveto
275.0 -427.0 lineto
295.0 -427.0 lineto
295.0 -455.0 lineto
stroke
newpath
270.0 -168.0 moveto
275.0 -182.0 lineto
280.0 -168.0 lineto
closepath
fill
newpath
290.0 -448.0 moveto
295.0 -462.0 lineto
300.0 -448.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
260.0 -54.0 moveto
(Broker) show
260.0 -68.0 moveto
(statebe) show
273.0 -96.0 moveto
(bind) show
274.0 -124.0 moveto
(state) show
243.0 -208.0 moveto
(connect) show
245.0 -236.0 moveto
(statefe) show
261.0 -250.0 moveto
(SUB) show
143.0 -292.0 moveto
(Broker) show
260.0 -334.0 moveto
(PUB) show
244.0 -348.0 moveto
(statebe) show
253.0 -376.0 moveto
(bind) show
254.0 -404.0 moveto
(state) show
263.0 -488.0 moveto
(connect) show
260.0 -516.0 moveto
(statefe) show
260.0 -530.0 moveto
(Broker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4997 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4997 a Black 3759 5569 a
Fi(130)p Black eop end
%%Page: 131 145
TeXDict begin 131 144 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.131) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fj(Here)20 b(is)h(ho)n(w)f(this)h(w)o(orks)f
(in)g(code:)-2 73 y
SDict begin H.S end
 -2 73 a -2 73 a
SDict begin 13 H.A end
 -2 73 a -2 73 a
SDict begin [/View [/XYZ H.V]/Dest (0:peering1-php) cvn /DEST pdfmark
end
 -2
73 a 396 274 a Fk(Example)h(3-9.)e(Pr)o(ototype)f(state)h(\003o)o(w)i
(\(peering1.php\))-2 374 y
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 11.7 H.A end
 -2 374 a
-2 374 a
SDict begin [/View [/XYZ H.V]/Dest (0:1856) cvn /DEST pdfmark end
 -2 374 a 396 454 a Fg(<?php)396 551 y(/)441
564 y(*)441 661 y(*)576 648 y(Broker)43 b(peering)h(simulation)f
(\(part)h(1\))441 758 y(*)576 745 y(Prototypes)f(the)h(state)g(flow)441
856 y(*)486 843 y(/)396 1037 y(//)90 b(First)44 b(argument)f(is)i(this)
f(broker's)f(name)396 1134 y(//)90 b(Other)44 b(arguments)f(are)h(our)h
(peers')e(names)396 1231 y(if\($_SERVER['argc'])f(<)j(2\))f({)441
1328 y(echo)g("syntax:)g(peering1)f(me)i({you}...",)e(PHP_EOL;)576
1425 y(exit\(\);)396 1522 y(})396 1620 y($self)h(=)h
($_SERVER['argv'][1];)396 1717 y(printf)f(\("I:)g(preparing)g(broker)f
(at)i(\045s...)f(\045s",)g($self,)g(PHP_EOL\);)396 1911
y(//)90 b(Prepare)43 b(our)i(context)e(and)i(sockets)396
2008 y($context)f(=)g(new)h(ZMQContext\(\);)396 2202
y(//)90 b(Bind)44 b(statebe)f(to)i(endpoint)396 2300
y($statebe)f(=)g($context->getSocket\(ZMQ::SOCKET_PUB\);)396
2397 y($endpoint)g(=)g(sprintf\("ipc://\045s-state.ipc",)c($self\);)396
2494 y($statebe->bind\($endpoint\);)396 2688 y(//)90
b(Connect)43 b(statefe)h(to)g(all)h(peers)396 2785 y($statefe)f(=)g
($context->getSocket\(ZMQ::SOCKET_SUB\);)396 2882 y
($statefe->setSockOpt\(ZMQ::SOCKOPT_SUBSCRI)o(BE,)39
b(""\);)396 3077 y(for)45 b(\($argn)e(=)i(2;)g($argn)f(<)g
($_SERVER['argc'];)e($argn++\))i({)441 3174 y($peer)g(=)h
($_SERVER['argv'][$argn];)441 3271 y(printf)f(\("I:)g(connecting)f(to)i
(state)f(backend)f(at)i('\045s'\045s",)e($peer,)h(PHP_EOL\);)441
3368 y($endpoint)f(=)i(sprintf\("ipc://\045s-state.ipc",)40
b($peer\);)441 3465 y($statefe->connect\($endpoint\);)396
3562 y(})396 3757 y($readable)k(=)g($writeable)f(=)i(array\(\);)396
3951 y(//)90 b(Send)44 b(out)g(status)g(messages)f(to)i(peers,)f(and)g
(collect)g(from)g(peers)396 4048 y(//)90 b(The)44 b(zmq_poll)f(timeout)
h(defines)g(our)g(own)g(heartbeating)396 4145 y(while)g(\(true\))g({)
441 4242 y(//)89 b(Initialize)44 b(poll)g(set)441 4339
y($poll)g(=)h(new)f(ZMQPoll\(\);)441 4437 y($poll->add\($statefe,)e
(ZMQ::POLL_IN\);)441 4534 y(//)89 b(Poll)45 b(for)f(activity,)f(or)i(1)
f(second)g(timeout)441 4631 y($events)g(=)g($poll->poll\($readable,)e
($writeable,)h(1000\);)441 4825 y(if\($events)g(>)i(0\))f({)486
4922 y(//)89 b(Handle)44 b(incoming)g(status)f(message)486
5019 y(foreach\($readable)f(as)i($socket\))g({)531 5116
y($address)f(=)i($socket->recv\(\);)p Black 3759 5569
a Fi(131)p Black eop end
%%Page: 132 146
TeXDict begin 132 145 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.132) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 531 72 a Fg($body)44 b(=)g($socket->recv\(\);)531
170 y(printf)g(\("\045s)g(-)g(\045s)h(workers)f(free\045s",)f
($address,)g($body,)h(PHP_EOL\);)486 267 y(})441 364
y(})441 461 y(else)g({)486 558 y(//)89 b(We)45 b(stick)f(our)g(own)g
(address)g(onto)g(the)h(envelope)486 655 y($statebe->send\($self,)c
(ZMQ::MODE_SNDMORE\);)486 752 y(//)89 b(Send)44 b(random)g(value)g(for)
h(worker)e(availability)486 850 y($statebe->send\(mt_rand\(1,)e
(10\)\);)441 1044 y(})396 1141 y(})396 1238 y(//)90 b(We)44
b(never)g(get)g(here)-2 1416 y
SDict begin H.S end
 -2 1416 a -2 1416 a
SDict begin 13 H.A end
 -2
1416 a -2 1416 a
SDict begin [/View [/XYZ H.V]/Dest (0:1857) cvn /DEST pdfmark end
 -2 1416 a 396 1512 a Fj(Notes)21 b(about)e(this)i
(code:)-2 1513 y
SDict begin H.S end
 -2 1513 a -2 1513 a
SDict begin 13 H.A end
 -2 1513 a -2 1513
a
SDict begin [/View [/XYZ H.V]/Dest (0:1858) cvn /DEST pdfmark end
 -2 1513 a -2 1523 a
SDict begin H.S end
 -2 1523 a -2 1523 a
SDict begin 13 H.A end
 -2 1523 a -2
1523 a
SDict begin [/View [/XYZ H.V]/Dest (0:1859) cvn /DEST pdfmark end
 -2 1523 a Black 396 1682 a Fe(\225)p Black 479
1682 a
SDict begin H.S end
 479 1682 a 479 1682 a
SDict begin 13 H.A end
 479 1682 a 479 1682 a
SDict begin [/View [/XYZ H.V]/Dest (0:1860) cvn /DEST pdfmark end
 479
1682 a Fj(Each)f(brok)o(er)f(has)h(an)g(identity)g(that)g(we)g(use)h
(to)f(construct)2212 1682 y
SDict begin H.S end
 2212 1682 a 2212 1682 a
SDict begin 13 H.A end
 2212
1682 a 2212 1682 a
SDict begin [/View [/XYZ H.V]/Dest (0:1861) cvn /DEST pdfmark end
 2212 1682 a Fg(ipc)h Fj(endpoint)d(names.)i(A)g
(real)g(brok)o(er)f(w)o(ould)h(need)f(to)479 1790 y(w)o(ork)h(with)g
(TCP)h(and)f(a)g(more)g(sophisticated)f(con\002guration)f(scheme.)h(W)
-7 b(e')o(ll)21 b(look)f(at)g(such)g(schemes)g(later)h(in)479
1898 y(this)g(book)e(b)n(ut)h(for)g(no)n(w)-5 b(,)19
b(using)g(generated)1771 1898 y
SDict begin H.S end
 1771 1898 a 1771 1898
a
SDict begin 13 H.A end
 1771 1898 a 1771 1898 a
SDict begin [/View [/XYZ H.V]/Dest (0:1862) cvn /DEST pdfmark end
 1771 1898 a Fg(ipc)h Fj(names)g(lets)h(us)f
(ignore)f(the)i(problem)d(of)i(where)f(to)i(get)f(TCP/IP)479
2006 y(addresses)g(or)g(names)g(from.)-2 2007 y
SDict begin H.S end
 -2 2007
a -2 2007 a
SDict begin 13 H.A end
 -2 2007 a -2 2007 a
SDict begin [/View [/XYZ H.V]/Dest (0:1863) cvn /DEST pdfmark end
 -2 2007 a Black 396 2155
a Fe(\225)p Black 479 2155 a
SDict begin H.S end
 479 2155 a 479 2155 a
SDict begin 13 H.A end
 479
2155 a 479 2155 a
SDict begin [/View [/XYZ H.V]/Dest (0:1864) cvn /DEST pdfmark end
 479 2155 a Fj(W)-7 b(e)22 b(use)e(a)798
2155 y
SDict begin H.S end
 798 2155 a 798 2155 a
SDict begin 13 H.A end
 798 2155 a 798 2155 a
SDict begin [/View [/XYZ H.V]/Dest (0:1865) cvn /DEST pdfmark end
 798
2155 a Fg(zmq_poll\(\))f Fj(loop)g(as)i(the)f(core)g(of)g(the)g
(program.)e(This)i(processes)g(incoming)e(messages)j(and)e(sends)479
2263 y(out)h(state)h(messages.)f(W)-7 b(e)22 b(send)d(a)i(state)g
(message)1969 2263 y
SDict begin H.S end
 1969 2263 a 1969 2263 a
SDict begin 13 H.A end
 1969 2263
a 1969 2263 a
SDict begin [/View [/XYZ H.V]/Dest (0:1866) cvn /DEST pdfmark end
 1969 2263 a Fi(only)f Fj(if)g(we)h(did)f(not)f(get)i(an)o
(y)e(incoming)f(messages)3506 2263 y
SDict begin H.S end
 3506 2263 a 3506
2263 a
SDict begin 13 H.A end
 3506 2263 a 3506 2263 a
SDict begin [/View [/XYZ H.V]/Dest (0:1867) cvn /DEST pdfmark end
 3506 2263 a Fi(and)j Fj(we)479
2371 y(w)o(aited)g(for)e(a)i(second.)e(If)h(we)g(send)g(out)g(a)h
(state)g(message)f(each)g(time)g(we)h(get)f(one)f(in,)h(we')o(ll)h(get)
f(message)g(storms.)-2 2389 y
SDict begin H.S end
 -2 2389 a -2 2389 a
SDict begin 13 H.A end
 -2
2389 a -2 2389 a
SDict begin [/View [/XYZ H.V]/Dest (0:1868) cvn /DEST pdfmark end
 -2 2389 a Black 396 2521 a Fe(\225)p
Black 479 2521 a
SDict begin H.S end
 479 2521 a 479 2521 a
SDict begin 13 H.A end
 479 2521 a 479
2521 a
SDict begin [/View [/XYZ H.V]/Dest (0:1869) cvn /DEST pdfmark end
 479 2521 a Fj(W)-7 b(e)22 b(use)e(a)h(tw)o(o-part)e(pubsub)f
(message)j(consisting)e(of)h(sender)f(address)h(and)g(data.)g(Note)g
(that)g(we)h(will)f(need)g(to)479 2629 y(kno)n(w)f(the)g(address)g(of)h
(the)f(publisher)f(in)i(order)e(to)i(send)f(it)h(tasks,)g(and)f(the)h
(only)f(w)o(ay)g(is)i(to)e(send)g(this)i(e)o(xplicitly)d(as)479
2737 y(a)j(part)f(of)g(the)g(message.)-2 2755 y
SDict begin H.S end
 -2 2755
a -2 2755 a
SDict begin 13 H.A end
 -2 2755 a -2 2755 a
SDict begin [/View [/XYZ H.V]/Dest (0:1870) cvn /DEST pdfmark end
 -2 2755 a Black 396 2886
a Fe(\225)p Black 479 2886 a
SDict begin H.S end
 479 2886 a 479 2886 a
SDict begin 13 H.A end
 479
2886 a 479 2886 a
SDict begin [/View [/XYZ H.V]/Dest (0:1871) cvn /DEST pdfmark end
 479 2886 a Fj(W)-7 b(e)22 b(don')o(t)c(set)j
(identities)f(on)g(subscribers,)f(because)h(if)g(we)h(did)f(then)f(we')
l(d)h(get)g(out)g(of)g(date)g(state)h(information)479
2994 y(when)f(connecting)e(to)i(running)e(brok)o(ers.)-2
3012 y
SDict begin H.S end
 -2 3012 a -2 3012 a
SDict begin 13 H.A end
 -2 3012 a -2 3012 a
SDict begin [/View [/XYZ H.V]/Dest (0:1872) cvn /DEST pdfmark end
 -2 3012
a Black 396 3143 a Fe(\225)p Black 479 3143 a
SDict begin H.S end
 479 3143
a 479 3143 a
SDict begin 13 H.A end
 479 3143 a 479 3143 a
SDict begin [/View [/XYZ H.V]/Dest (0:1873) cvn /DEST pdfmark end
 479 3143 a Fj(W)-7
b(e)22 b(don')o(t)c(set)j(a)g(HWM)g(on)e(the)i(publisher)m(,)d(b)n(ut)i
(if)g(we)h(were)f(using)g(\330MQ/2.x)f(that)h(w)o(ould)g(be)g(a)h(wise)
g(idea.)-2 3327 y
SDict begin H.S end
 -2 3327 a -2 3327 a
SDict begin 13 H.A end
 -2 3327 a -2 3327
a
SDict begin [/View [/XYZ H.V]/Dest (0:1874) cvn /DEST pdfmark end
 -2 3327 a 396 3417 a Fj(W)-7 b(e)22 b(can)e(b)n(uild)f(this)i(little)
g(program)d(and)i(run)f(it)i(three)f(times)h(to)f(simulate)g(three)g
(clusters.)g(Let')-5 b(s)21 b(call)f(them)g(DC1,)396
3525 y(DC2,)h(and)e(DC3)i(\(the)f(names)g(are)g(arbitrary\).)e(W)-7
b(e)21 b(run)e(these)i(three)f(commands,)e(each)i(in)g(a)h(separate)e
(windo)n(w:)-2 3626 y
SDict begin H.S end
 -2 3626 a -2 3626 a
SDict begin 11.7 H.A end
 -2 3626 a -2
3626 a
SDict begin [/View [/XYZ H.V]/Dest (0:1875) cvn /DEST pdfmark end
 -2 3626 a 396 3706 a Fg(peering1)44 b(DC1)g(DC2)g(DC3)90
b(#)f(Start)44 b(DC1)g(and)h(connect)e(to)i(DC2)f(and)h(DC3)396
3803 y(peering1)f(DC2)g(DC1)g(DC3)90 b(#)f(Start)44 b(DC2)g(and)h
(connect)e(to)i(DC1)f(and)h(DC3)396 3900 y(peering1)f(DC3)g(DC1)g(DC2)
90 b(#)f(Start)44 b(DC3)g(and)h(connect)e(to)i(DC1)f(and)h(DC2)-2
4077 y
SDict begin H.S end
 -2 4077 a -2 4077 a
SDict begin 13 H.A end
 -2 4077 a -2 4077 a
SDict begin [/View [/XYZ H.V]/Dest (0:1876) cvn /DEST pdfmark end
 -2 4077
a 396 4174 a Fj(Y)-9 b(ou')o(ll)20 b(see)h(each)e(cluster)i(report)e
(the)h(state)h(of)f(its)h(peers,)e(and)h(after)g(a)h(fe)n(w)f(seconds)f
(the)o(y)h(will)h(all)g(happily)d(be)396 4282 y(printing)h(random)f
(numbers)h(once)h(per)f(second.)g(T)m(ry)h(this)h(and)e(satisfy)i
(yourself)e(that)h(the)g(three)g(brok)o(ers)f(all)i(match)396
4390 y(up)f(and)g(synchronize)e(to)i(per)n(-second)e(state)j(updates.)
-2 4574 y
SDict begin H.S end
 -2 4574 a -2 4574 a
SDict begin 13 H.A end
 -2 4574 a -2 4574 a
SDict begin [/View [/XYZ H.V]/Dest (0:1877) cvn /DEST pdfmark end
 -2
4574 a 396 4664 a Fj(In)f(real)g(life)h(we')l(d)e(not)h(send)g(out)g
(state)h(messages)f(at)h(re)o(gular)e(interv)n(als)g(b)n(ut)h(rather)g
(whene)n(v)o(er)e(we)i(had)g(a)h(state)396 4772 y(change,)e(i.e.)h
(whene)n(v)o(er)e(a)j(w)o(ork)o(er)e(becomes)g(a)n(v)n(ailable)h(or)g
(una)n(v)n(ailable.)e(That)i(may)g(seem)g(lik)o(e)h(a)g(lot)f(of)g
(traf)n(\002c)g(b)n(ut)396 4879 y(state)h(messages)g(are)f(small)g(and)
g(we')l(v)o(e)f(established)h(that)g(the)g(inter)n(-cluster)g
(connections)e(are)i(super)n(-f)o(ast.)p Black 3759 5569
a Fi(132)p Black eop end
%%Page: 133 147
TeXDict begin 133 146 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.133) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:1888) cvn /DEST pdfmark end
 -2 -201 a 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1878) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(If)20 b(we)h(w)o(anted)f(to)g(send)
g(state)h(messages)f(at)h(precise)f(interv)n(als)f(we')l(d)h(create)g
(a)g(child)g(thread)f(and)h(open)f(the)h(statebe)396
180 y(sock)o(et)g(in)h(that)f(thread.)f(W)-7 b(e')l(d)20
b(then)g(send)g(irre)o(gular)e(state)j(updates)f(to)g(that)g(child)g
(thread)f(from)g(our)h(main)g(thread,)396 288 y(and)g(allo)n(w)g(the)g
(child)g(thread)f(to)i(con\003ate)e(them)h(into)g(re)o(gular)f
(outgoing)f(messages.)i(This)g(is)h(more)f(w)o(ork)f(than)h(we)396
396 y(need)g(here.)-2 407 y
SDict begin H.S end
 -2 407 a -2 407 a
SDict begin 13 H.A end
 -2 407
a -2 407 a
SDict begin [/View [/XYZ H.V]/Dest (0:1879) cvn /DEST pdfmark end
 -2 407 a 396 735 a Fd(3.9.7.)36 b(Pr)n(ototyping)c(the)i
(Local)g(and)g(Cloud)g(Flo)n(ws)2942 735 y
SDict begin H.S end
 2942 735 a
2942 735 a
SDict begin 18.72 H.A end
 2942 735 a 2942 735 a
SDict begin [/View [/XYZ H.V]/Dest (8.39.23.2) cvn /DEST pdfmark end
 2942 735 a -2 927 a
SDict begin H.S end

-2 927 a -2 927 a
SDict begin 13 H.A end
 -2 927 a -2 927 a
SDict begin [/View [/XYZ H.V]/Dest (0:1881) cvn /DEST pdfmark end
 -2 927 a 396 1009
a Fj(Let')-5 b(s)21 b(no)n(w)f(prototype)e(at)i(the)h(\003o)n(w)f(of)g
(tasks)h(via)f(the)g(local)g(and)g(cloud)f(sock)o(ets\()p
0 TeXcolorgray 2774 1009 a
SDict begin H.S end
 2774 1009 a Fj(Figure)g(3-27)3165
1009 y
SDict begin 13 H.L end
 3165 1009 a 3165 1009 a
SDict begin [/Subtype /Link/Dest (0:figure-52) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3165 1009 a Black -2 w
Fj(\).)h(This)g(code)g(pulls)396 1117 y(requests)g(from)f(clients)i
(and)e(then)h(distrib)n(utes)g(them)g(to)g(local)g(w)o(ork)o(ers)g(and)
g(cloud)f(peers)h(on)g(a)g(random)f(basis.)-2 1135 y
SDict begin H.S end

-2 1135 a -2 1135 a
SDict begin 13 H.A end
 -2 1135 a -2 1135 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-52) cvn /DEST pdfmark
end
 -2 1135 a Black
3759 5569 a Fi(133)p Black eop end
%%Page: 134 148
TeXDict begin 134 147 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.134) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(3-27.)e(The)k(Flo)o(w)e
(of)g(T)-8 b(asks)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:1885) cvn /DEST pdfmark end
 -2 172 a 396 4997 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4997 a @beginspecial
0 @llx -574 @lly 370 @urx 0 @ury 3700 @rwi @setspecial
%%BeginDocument: images/fig52.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -574 370 0
%%HiResBoundingBox: 0.0 -574.0 370.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -78.00029754638672 lineto
128.00030517578125 -78.00029754638672 lineto
128.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -82.00029754638672 moveto
28.00029945373535 -108.00029754638672 lineto
128.00030517578125 -108.00029754638672 lineto
128.00030517578125 -82.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -38.000301361083984 moveto
148.00030517578125 -78.00029754638672 lineto
248.00030517578125 -78.00029754638672 lineto
248.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -82.00029754638672 moveto
148.00030517578125 -108.00029754638672 lineto
248.00030517578125 -108.00029754638672 lineto
248.00030517578125 -82.00029754638672 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
48.000301361083984 -192.00030517578125 moveto
48.000301361083984 -218.00030517578125 lineto
146.00030517578125 -218.00030517578125 lineto
146.00030517578125 -192.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.00030517578125 -192.00030517578125 moveto
150.00030517578125 -218.00030517578125 lineto
246.00030517578125 -218.00030517578125 lineto
246.00030517578125 -192.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.00030517578125 -192.00030517578125 moveto
250.00030517578125 -218.00030517578125 lineto
348.00030517578125 -218.00030517578125 lineto
348.00030517578125 -192.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
48.000301361083984 -222.00030517578125 moveto
48.000301361083984 -262.00030517578125 lineto
146.00030517578125 -262.00030517578125 lineto
146.00030517578125 -222.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.00030517578125 -222.00030517578125 moveto
150.00030517578125 -262.00030517578125 lineto
246.00030517578125 -262.00030517578125 lineto
246.00030517578125 -222.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.00030517578125 -222.00030517578125 moveto
250.00030517578125 -262.00030517578125 lineto
348.00030517578125 -262.00030517578125 lineto
348.00030517578125 -222.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
48.000301361083984 -262.00030517578125 moveto
48.000301361083984 -318.00030517578125 lineto
348.00030517578125 -318.00030517578125 lineto
348.00030517578125 -262.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
48.000301361083984 -318.00030517578125 moveto
48.000301361083984 -358.00030517578125 lineto
146.00030517578125 -358.00030517578125 lineto
146.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.00030517578125 -318.00030517578125 moveto
150.00030517578125 -358.00030517578125 lineto
246.00030517578125 -358.00030517578125 lineto
246.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.00030517578125 -318.00030517578125 moveto
250.00030517578125 -358.00030517578125 lineto
348.00030517578125 -358.00030517578125 lineto
348.00030517578125 -318.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
48.000301361083984 -362.00030517578125 moveto
48.000301361083984 -388.00030517578125 lineto
146.00030517578125 -388.00030517578125 lineto
146.00030517578125 -362.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.00030517578125 -362.00030517578125 moveto
150.00030517578125 -388.00030517578125 lineto
246.00030517578125 -388.00030517578125 lineto
246.00030517578125 -362.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.00030517578125 -362.00030517578125 moveto
250.00030517578125 -388.00030517578125 lineto
348.00030517578125 -388.00030517578125 lineto
348.00030517578125 -362.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -472.00030517578125 moveto
28.00029945373535 -498.00030517578125 lineto
128.00030517578125 -498.00030517578125 lineto
128.00030517578125 -472.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -502.00030517578125 moveto
28.00029945373535 -542.0003051757812 lineto
128.00030517578125 -542.0003051757812 lineto
128.00030517578125 -502.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -472.00030517578125 moveto
148.00030517578125 -498.00030517578125 lineto
248.00030517578125 -498.00030517578125 lineto
248.00030517578125 -472.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
148.00030517578125 -502.00030517578125 moveto
148.00030517578125 -542.0003051757812 lineto
248.00030517578125 -542.0003051757812 lineto
248.00030517578125 -502.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -75.0 lineto
125.0 -75.0 lineto
125.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -75.0 lineto
125.0 -75.0 lineto
125.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -79.0 moveto
25.0 -105.0 lineto
125.0 -105.0 lineto
125.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -79.0 moveto
25.0 -105.0 lineto
125.0 -105.0 lineto
125.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -75.0 lineto
245.0 -75.0 lineto
245.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -35.0 moveto
145.0 -75.0 lineto
245.0 -75.0 lineto
245.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -79.0 moveto
145.0 -105.0 lineto
245.0 -105.0 lineto
245.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -79.0 moveto
145.0 -105.0 lineto
245.0 -105.0 lineto
245.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
45.0 -189.0 moveto
45.0 -215.0 lineto
143.0 -215.0 lineto
143.0 -189.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
45.0 -189.0 moveto
45.0 -215.0 lineto
143.0 -215.0 lineto
143.0 -189.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -189.0 moveto
147.0 -215.0 lineto
243.0 -215.0 lineto
243.0 -189.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -189.0 moveto
147.0 -215.0 lineto
243.0 -215.0 lineto
243.0 -189.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
247.0 -189.0 moveto
247.0 -215.0 lineto
345.0 -215.0 lineto
345.0 -189.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
247.0 -189.0 moveto
247.0 -215.0 lineto
345.0 -215.0 lineto
345.0 -189.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
45.0 -219.0 moveto
45.0 -259.0 lineto
143.0 -259.0 lineto
143.0 -219.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
45.0 -219.0 moveto
45.0 -259.0 lineto
143.0 -259.0 lineto
143.0 -219.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -219.0 moveto
147.0 -259.0 lineto
243.0 -259.0 lineto
243.0 -219.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -219.0 moveto
147.0 -259.0 lineto
243.0 -259.0 lineto
243.0 -219.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
247.0 -219.0 moveto
247.0 -259.0 lineto
345.0 -259.0 lineto
345.0 -219.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
247.0 -219.0 moveto
247.0 -259.0 lineto
345.0 -259.0 lineto
345.0 -219.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
45.0 -259.0 moveto
45.0 -315.0 lineto
345.0 -315.0 lineto
345.0 -259.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
45.0 -259.0 moveto
45.0 -315.0 lineto
345.0 -315.0 lineto
345.0 -259.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
45.0 -315.0 moveto
45.0 -355.0 lineto
143.0 -355.0 lineto
143.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
45.0 -315.0 moveto
45.0 -355.0 lineto
143.0 -355.0 lineto
143.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -315.0 moveto
147.0 -355.0 lineto
243.0 -355.0 lineto
243.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -315.0 moveto
147.0 -355.0 lineto
243.0 -355.0 lineto
243.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
247.0 -315.0 moveto
247.0 -355.0 lineto
345.0 -355.0 lineto
345.0 -315.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
247.0 -315.0 moveto
247.0 -355.0 lineto
345.0 -355.0 lineto
345.0 -315.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
45.0 -359.0 moveto
45.0 -385.0 lineto
143.0 -385.0 lineto
143.0 -359.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
45.0 -359.0 moveto
45.0 -385.0 lineto
143.0 -385.0 lineto
143.0 -359.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -359.0 moveto
147.0 -385.0 lineto
243.0 -385.0 lineto
243.0 -359.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -359.0 moveto
147.0 -385.0 lineto
243.0 -385.0 lineto
243.0 -359.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
247.0 -359.0 moveto
247.0 -385.0 lineto
345.0 -385.0 lineto
345.0 -359.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
247.0 -359.0 moveto
247.0 -385.0 lineto
345.0 -385.0 lineto
345.0 -359.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -469.0 moveto
25.0 -495.0 lineto
125.0 -495.0 lineto
125.0 -469.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -469.0 moveto
25.0 -495.0 lineto
125.0 -495.0 lineto
125.0 -469.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -499.0 moveto
25.0 -539.0 lineto
125.0 -539.0 lineto
125.0 -499.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
25.0 -499.0 moveto
25.0 -539.0 lineto
125.0 -539.0 lineto
125.0 -499.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -469.0 moveto
145.0 -495.0 lineto
245.0 -495.0 lineto
245.0 -469.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -469.0 moveto
145.0 -495.0 lineto
245.0 -495.0 lineto
245.0 -469.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
145.0 -499.0 moveto
145.0 -539.0 lineto
245.0 -539.0 lineto
245.0 -499.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
145.0 -499.0 moveto
145.0 -539.0 lineto
245.0 -539.0 lineto
245.0 -499.0 lineto
closepath
stroke
newpath
75.0 -126.0 moveto
75.0 -147.0 lineto
95.0 -147.0 lineto
95.0 -175.0 lineto
stroke
newpath
195.0 -126.0 moveto
195.0 -175.0 lineto
stroke
newpath
95.0 -406.0 moveto
95.0 -427.0 lineto
75.0 -427.0 lineto
75.0 -455.0 lineto
stroke
newpath
195.0 -406.0 moveto
195.0 -455.0 lineto
stroke
newpath
90.0 -168.0 moveto
95.0 -182.0 lineto
100.0 -168.0 lineto
closepath
fill
newpath
190.0 -168.0 moveto
195.0 -182.0 lineto
200.0 -168.0 lineto
closepath
fill
newpath
70.0 -448.0 moveto
75.0 -462.0 lineto
80.0 -448.0 lineto
closepath
fill
newpath
190.0 -448.0 moveto
195.0 -462.0 lineto
200.0 -448.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
47.0 -54.0 moveto
(Client) show
160.0 -54.0 moveto
(Broker) show
160.0 -68.0 moveto
(cloudbe) show
43.0 -96.0 moveto
(connect) show
163.0 -96.0 moveto
(connect) show
44.0 -124.0 moveto
(request) show
164.0 -124.0 moveto
(request) show
73.0 -208.0 moveto
(bind) show
173.0 -208.0 moveto
(bind) show
60.0 -236.0 moveto
(localfe) show
60.0 -250.0 moveto
(ROUTER) show
160.0 -236.0 moveto
(cloudfe) show
160.0 -250.0 moveto
(ROUTER) show
163.0 -292.0 moveto
(Broker) show
60.0 -334.0 moveto
(ROUTER) show
60.0 -348.0 moveto
(localbe) show
160.0 -334.0 moveto
(ROUTER) show
160.0 -348.0 moveto
(cloudbe) show
73.0 -376.0 moveto
(bind) show
163.0 -376.0 moveto
(connect) show
64.0 -404.0 moveto
(request) show
164.0 -404.0 moveto
(request) show
43.0 -488.0 moveto
(connect) show
173.0 -488.0 moveto
(bind) show
160.0 -516.0 moveto
(cloudfe) show
160.0 -530.0 moveto
(Broker) show
41.0 -530.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4997 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4997 a Black 3759 5569 a
Fi(134)p Black eop end
%%Page: 135 149
TeXDict begin 135 148 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.135) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fj(Before)20 b(we)g(jump)g(into)g(the)g
(code,)f(which)h(is)h(getting)f(a)g(little)h(comple)o(x,)d(let')-5
b(s)21 b(sk)o(etch)g(the)f(core)f(routing)g(logic)h(and)396
180 y(break)f(it)i(do)n(wn)e(into)h(a)h(simple)f(b)n(ut)g(rob)n(ust)g
(design.)-2 364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:1889) cvn /DEST pdfmark end

-2 364 a 396 454 a Fj(W)-7 b(e)22 b(need)d(tw)o(o)i(queues,)e(one)g
(for)h(requests)g(from)f(local)h(clients)g(and)g(one)g(for)f(requests)h
(from)f(cloud)g(clients.)i(One)396 562 y(option)e(w)o(ould)h(be)g(to)g
(pull)g(messages)g(of)n(f)g(the)g(local)g(and)g(cloud)f(frontends,)f
(and)i(pump)f(these)h(onto)f(their)h(respecti)n(v)o(e)396
670 y(queues.)f(But)i(this)g(is)g(kind)e(of)h(pointless)g(because)g
(\330MQ)g(sock)o(ets)2362 670 y
SDict begin H.S end
 2362 670 a 2362 670 a
SDict begin 13 H.A end

2362 670 a 2362 670 a
SDict begin [/View [/XYZ H.V]/Dest (0:1890) cvn /DEST pdfmark end
 2362 670 a Fi(ar)m(e)h Fj(queues)e(already)-5
b(.)19 b(So)h(let')-5 b(s)21 b(use)g(the)f(\330MQ)396
778 y(sock)o(et)g(b)n(uf)n(fers)f(as)i(queues.)-2 962
y
SDict begin H.S end
 -2 962 a -2 962 a
SDict begin 13 H.A end
 -2 962 a -2 962 a
SDict begin [/View [/XYZ H.V]/Dest (0:1891) cvn /DEST pdfmark end
 -2 962 a 396 1052
a Fj(This)g(w)o(as)g(the)f(technique)e(we)j(used)f(in)g(the)g(LR)m(U)h
(queue)e(brok)o(er)m(,)f(and)i(it)h(w)o(ork)o(ed)e(nicely)-5
b(.)19 b(W)-7 b(e)21 b(only)e(read)h(from)f(the)396 1160
y(tw)o(o)i(frontends)d(when)i(there)f(is)i(some)n(where)e(to)i(send)f
(the)g(requests.)f(W)-7 b(e)22 b(can)e(al)o(w)o(ays)g(read)g(from)f
(the)h(back)o(ends,)396 1268 y(since)h(the)o(y)e(gi)n(v)o(e)g(us)i
(replies)f(to)g(route)g(back.)f(As)i(long)e(as)i(the)g(back)o(ends)d
(aren')o(t)h(talking)h(to)g(us,)g(there')-5 b(s)20 b(no)g(point)g(in)
396 1376 y(e)n(v)o(en)f(looking)g(at)i(the)f(frontends.)-2
1560 y
SDict begin H.S end
 -2 1560 a -2 1560 a
SDict begin 13 H.A end
 -2 1560 a -2 1560 a
SDict begin [/View [/XYZ H.V]/Dest (0:1892) cvn /DEST pdfmark end
 -2 1560
a 396 1650 a Fj(So)h(our)e(main)h(loop)f(becomes:)-2
1668 y
SDict begin H.S end
 -2 1668 a -2 1668 a
SDict begin 13 H.A end
 -2 1668 a -2 1668 a
SDict begin [/View [/XYZ H.V]/Dest (0:1893) cvn /DEST pdfmark end
 -2 1668
a -2 1678 a
SDict begin H.S end
 -2 1678 a -2 1678 a
SDict begin 13 H.A end
 -2 1678 a -2 1678 a
SDict begin [/View [/XYZ H.V]/Dest (0:1894) cvn /DEST pdfmark end
 -2
1678 a Black 396 1820 a Fe(\225)p Black 479 1820 a
SDict begin H.S end
 479
1820 a 479 1820 a
SDict begin 13 H.A end
 479 1820 a 479 1820 a
SDict begin [/View [/XYZ H.V]/Dest (0:1895) cvn /DEST pdfmark end
 479 1820 a Fj(Poll)i(the)f
(back)o(ends)f(for)g(acti)n(vity)-5 b(.)20 b(When)g(we)g(get)g(a)h
(message,)f(it)h(may)e(be)i("READ)-5 b(Y")20 b(from)g(a)g(w)o(ork)o(er)
f(or)h(it)h(may)479 1928 y(be)f(a)h(reply)-5 b(.)19 b(If)h(it')-5
b(s)21 b(a)g(reply)-5 b(,)18 b(route)i(back)f(via)i(the)f(local)g(or)g
(cloud)f(frontend.)-2 1946 y
SDict begin H.S end
 -2 1946 a -2 1946 a
SDict begin 13 H.A end
 -2 1946
a -2 1946 a
SDict begin [/View [/XYZ H.V]/Dest (0:1896) cvn /DEST pdfmark end
 -2 1946 a Black 396 2077 a Fe(\225)p Black
479 2077 a
SDict begin H.S end
 479 2077 a 479 2077 a
SDict begin 13 H.A end
 479 2077 a 479 2077
a
SDict begin [/View [/XYZ H.V]/Dest (0:1897) cvn /DEST pdfmark end
 479 2077 a Fj(If)h(a)h(w)o(ork)o(er)e(replied,)g(it)i(became)e(a)n(v)
n(ailable,)h(so)g(we)h(queue)e(it)i(and)f(count)f(it.)-2
2095 y
SDict begin H.S end
 -2 2095 a -2 2095 a
SDict begin 13 H.A end
 -2 2095 a -2 2095 a
SDict begin [/View [/XYZ H.V]/Dest (0:1898) cvn /DEST pdfmark end
 -2 2095
a Black 396 2227 a Fe(\225)p Black 479 2227 a
SDict begin H.S end
 479 2227
a 479 2227 a
SDict begin 13 H.A end
 479 2227 a 479 2227 a
SDict begin [/View [/XYZ H.V]/Dest (0:1899) cvn /DEST pdfmark end
 479 2227 a Fj(While)i(there)f(are)g
(w)o(ork)o(ers)f(a)n(v)n(ailable,)h(tak)o(e)g(a)h(request,)e(if)h(an)o
(y)-5 b(,)19 b(from)g(either)h(frontend)e(and)i(route)f(to)h(a)h(local)
479 2335 y(w)o(ork)o(er)m(,)e(or)h(randomly)-5 b(,)17
b(a)k(cloud)e(peer)-5 b(.)-2 2519 y
SDict begin H.S end
 -2 2519 a -2 2519
a
SDict begin 13 H.A end
 -2 2519 a -2 2519 a
SDict begin [/View [/XYZ H.V]/Dest (0:1900) cvn /DEST pdfmark end
 -2 2519 a 396 2609 a Fj(Randomly)19
b(sending)g(tasks)i(to)f(a)h(peer)e(brok)o(er)g(rather)g(than)h(a)h(w)o
(ork)o(er)e(simulates)h(w)o(ork)g(distrib)n(ution)f(across)h(the)396
2717 y(cluster)-5 b(.)21 b(It')-5 b(s)20 b(dumb)f(b)n(ut)h(that)h(is)g
(\002ne)f(for)g(this)g(stage.)-2 2901 y
SDict begin H.S end
 -2 2901 a -2
2901 a
SDict begin 13 H.A end
 -2 2901 a -2 2901 a
SDict begin [/View [/XYZ H.V]/Dest (0:1901) cvn /DEST pdfmark end
 -2 2901 a 396 2991 a Fj(W)-7
b(e)22 b(use)e(brok)o(er)f(identities)h(to)g(route)g(messages)g
(between)f(brok)o(ers.)g(Each)h(brok)o(er)e(has)j(a)f(name,)g(which)f
(we)i(pro)o(vide)396 3099 y(on)f(the)g(command)e(line)j(in)f(this)h
(simple)f(prototype.)e(As)j(long)e(as)i(these)f(names)g(don')o(t)f(o)o
(v)o(erlap)f(with)i(the)396 3207 y(\330MQ-generated)e(UUIDs)j(used)f
(for)f(client)h(nodes,)f(we)i(can)f(\002gure)f(out)h(whether)g(to)g
(route)f(a)i(reply)e(back)h(to)g(a)h(client)396 3314
y(or)f(to)h(a)f(brok)o(er)-5 b(.)-2 3481 y
SDict begin H.S end
 -2 3481 a
-2 3481 a
SDict begin 13 H.A end
 -2 3481 a -2 3481 a
SDict begin [/View [/XYZ H.V]/Dest (0:1902) cvn /DEST pdfmark end
 -2 3481 a 396 3588 a Fj(Here)20
b(is)h(ho)n(w)f(this)h(w)o(orks)f(in)g(code.)f(The)h(interesting)f
(part)h(starts)h(around)e(the)h(comment)f("Interesting)f(part".)-2
3606 y
SDict begin H.S end
 -2 3606 a -2 3606 a
SDict begin 13 H.A end
 -2 3606 a -2 3606 a
SDict begin [/View [/XYZ H.V]/Dest (0:peering2-php) cvn /DEST pdfmark
end
 -2 3606
a 396 3790 a Fk(Example)j(3-10.)d(Pr)o(ototype)g(local)i(and)g(cloud)h
(\003o)o(w)g(\(peering2.php\))-2 3890 y
SDict begin H.S end
 -2 3890 a -2
3890 a
SDict begin 11.7 H.A end
 -2 3890 a -2 3890 a
SDict begin [/View [/XYZ H.V]/Dest (0:1905) cvn /DEST pdfmark end
 -2 3890 a 396 3970 a Fg(<?php)396
4067 y(/)441 4080 y(*)441 4177 y(*)531 4164 y(Broker)44
b(peering)f(simulation)g(\(part)h(2\))441 4274 y(*)531
4261 y(Prototypes)f(the)h(request-reply)f(flow)441 4371
y(*)531 4358 y(@author)g(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4469 y(*)486
4456 y(/)396 4553 y(include)g("zmsg.php";)396 4747 y
(define\("NBR_CLIENTS",)e(10\);)396 4844 y(define\("NBR_WORKERS",)g
(3\);)396 5038 y(//)j(Request-reply)d(client)i(using)g(REQ)h(socket)396
5136 y(function)f(client_thread\($self\))d({)p Black
3759 5569 a Fi(135)p Black eop end
%%Page: 136 150
TeXDict begin 136 149 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.136) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 441 72 a Fg($context)44 b(=)g(new)h(ZMQContext\(\);)
441 170 y($client)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_REQ\);)441 267 y($endpoint)i(=)i
(sprintf\("ipc://\045s-localfe.ipc",)40 b($self\);)441
364 y($client->connect\($endpoint\);)441 558 y(while\(true\))j({)486
655 y(//)89 b(Send)44 b(request,)g(get)g(reply)486 752
y($client->send\("HELLO"\);)486 850 y($reply)g(=)g($client->recv\(\);)
486 947 y(printf\("I:)f(client)h(status:)g(\045s\045s",)f($reply,)h
(PHP_EOL\);)441 1044 y(})396 1141 y(})396 1335 y(//)90
b(Worker)43 b(using)h(REQ)h(socket)f(to)g(do)h(LRU)f(routing)396
1432 y(function)g(worker_thread)e(\($self\))i({)441 1530
y($context)g(=)g(new)h(ZMQContext\(\);)441 1627 y($worker)f(=)g
($context->getSocket\(ZMQ::SOCKET_REQ\);)441 1724 y($endpoint)f(=)i
(sprintf\("ipc://\045s-localbe.ipc",)40 b($self\);)441
1821 y($worker->connect\($endpoint\);)576 2015 y(//)89
b(Tell)44 b(broker)g(we're)g(ready)g(for)g(work)441 2112
y($worker->send\("READY"\);)441 2307 y(while\(true\))f({)486
2404 y($zmsg)h(=)h(new)f(Zmsg\($worker\);)486 2501 y($zmsg->recv\(\);)
486 2695 y(sleep\(1\);)486 2792 y($zmsg->body_fmt\("OK)e(-)i(\04504x",)
g(mt_rand\(0,)f(0x10000\)\);)486 2889 y($zmsg->send\(\);)576
2987 y(})396 3084 y(})396 3278 y(//)90 b(First)44 b(argument)f(is)i
(this)f(broker's)f(name)396 3375 y(//)90 b(Other)44 b(arguments)f(are)h
(our)h(peers')e(names)396 3472 y(if\($_SERVER['argc'])f(<)j(2\))f({)441
3569 y(echo)g("syntax:)g(peering2)f(me)i({you}...",)e(PHP_EOL;)576
3666 y(exit\(\);)396 3764 y(})396 3958 y($self)h(=)h
($_SERVER['argv'][1];)396 4152 y(for\($client_nbr)e(=)h(0;)h
($client_nbr)e(<)h(NBR_CLIENTS;)f($client_nbr++\))g({)441
4249 y($pid)h(=)h(pcntl_fork\(\);)441 4346 y(if\($pid)f(==)g(0\))h({)
486 4444 y(client_thread\($self\);)486 4541 y(return;)441
4638 y(})396 4735 y(})396 4929 y(for\($worker_nbr)e(=)h(0;)h
($worker_nbr)e(<)h(NBR_WORKERS;)f($worker_nbr++\))g({)441
5026 y($pid)h(=)h(pcntl_fork\(\);)441 5124 y(if\($pid)f(==)g(0\))h({)p
Black 3757 5569 a Fi(136)p Black eop end
%%Page: 137 151
TeXDict begin 137 150 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.137) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 486 72 a Fg(worker_thread\($self\);)486
170 y(return;)441 267 y(})396 364 y(})396 558 y(printf)44
b(\("I:)g(preparing)g(broker)f(at)i(\045s...)f(\045s",)g($self,)g
(PHP_EOL\);)396 752 y(//)90 b(Prepare)43 b(our)i(context)e(and)i
(sockets)396 850 y($context)f(=)g(new)h(ZMQContext\(\);)396
1044 y(//)90 b(Bind)44 b(cloud)g(frontend)f(to)i(endpoint)396
1141 y($cloudfe)f(=)g($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396
1238 y($endpoint)g(=)g(sprintf\("ipc://\045s-cloud.ipc",)c($self\);)396
1335 y($cloudfe->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)f($self\);)396
1432 y($cloudfe->bind\($endpoint\);)396 1627 y(//)90
b(Connect)43 b(cloud)h(backend)g(to)g(all)h(peers)396
1724 y($cloudbe)f(=)g($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396
1821 y($cloudbe->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)39
b($self\);)396 2015 y(for)45 b(\($argn)e(=)i(2;)g($argn)f(<)g
($_SERVER['argc'];)e($argn++\))i({)441 2112 y($peer)g(=)h
($_SERVER['argv'][$argn];)441 2209 y(printf)f(\("I:)g(connecting)f(to)i
(cloud)f(backend)f(at)i('\045s'\045s",)e($peer,)h(PHP_EOL\);)441
2307 y($endpoint)f(=)i(sprintf\("ipc://\045s-cloud.ipc",)40
b($peer\);)441 2404 y($cloudbe->connect\($endpoint\);)396
2501 y(})396 2695 y(//)90 b(Prepare)43 b(local)h(frontend)g(and)g
(backend)396 2792 y($localfe)g(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_ROUTER\);)396 2889 y($endpoint)j(=)g
(sprintf\("ipc://\045s-localfe.ipc",)c($self\);)396 2987
y($localfe->bind\($endpoint\);)396 3084 y($localbe)k(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)396 3181
y($endpoint)j(=)g(sprintf\("ipc://\045s-localbe.ipc",)c($self\);)396
3278 y($localbe->bind\($endpoint\);)396 3472 y(//)90
b(Get)44 b(user)g(to)h(tell)f(us)g(when)g(we)h(can)f(start...)396
3569 y(printf)g(\("Press)g(Enter)g(when)g(all)g(brokers)g(are)g
(started:)g("\);)396 3666 y($fp)h(=)f(fopen\('php://stdin',)e('r'\);)
396 3764 y($line)i(=)h(fgets\($fp,)e(512\);)396 3861
y(fclose\($fp\);)396 4152 y(//)90 b(Interesting)43 b(part)396
4249 y(//)90 b(-------------------------------------)o(------)o(------)
o(------)o(------)396 4346 y(//)g(Request-reply)42 b(flow)396
4444 y(//)90 b(-)44 b(Poll)g(backends)g(and)g(process)g(local/cloud)f
(replies)396 4541 y(//)90 b(-)44 b(While)g(worker)g(available,)f(route)
h(localfe)g(to)g(local)g(or)h(cloud)396 4735 y(//)90
b(Queue)44 b(of)g(available)f(workers)396 4832 y($capacity)h(=)g(0;)396
4929 y($worker_queue)f(=)i(array\(\);)396 5026 y($readable)f(=)g
($writeable)f(=)i(array\(\);)p Black 3756 5569 a Fi(137)p
Black eop end
%%Page: 138 152
TeXDict begin 138 151 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.138) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fg(while\(true\))43 b({)441
170 y($poll)h(=)h(new)f(ZMQPoll\(\);)441 267 y($poll->add\($localbe,)e
(ZMQ::POLL_IN\);)441 364 y($poll->add\($cloudbe,)g(ZMQ::POLL_IN\);)441
461 y($events)i(=)g(0;)441 655 y(//)89 b(If)45 b(we)f(have)h(no)f
(workers)g(anyhow,)f(wait)i(indefinitely)441 752 y(try)f({)486
850 y($events)g(=)g($poll->poll\($readable,)d($writeable,)i($capacity)h
(?)g(1000000)g(:)h(-1\);)441 947 y(})g(catch\(ZMQPollException)c($e\))j
({)486 1044 y(break;)441 1141 y(})441 1335 y(if\($events)f(>)i(0\))f({)
486 1432 y(foreach\($readable)e(as)i($socket\))g({)531
1530 y($zmsg)g(=)g(new)h(Zmsg\($socket\);)531 1627 y(//)89
b(Handle)44 b(reply)g(from)g(local)g(worker)531 1724
y(if\($socket)f(===)h($localbe\))g({)576 1821 y($zmsg->recv\(\);)576
1918 y(//)89 b(Use)44 b(worker)g(address)g(for)g(LRU)g(routing)576
2015 y($worker_queue[])e(=)j($zmsg->unwrap\(\);)576 2112
y($capacity++;)576 2209 y(if\($zmsg->address\(\))c(==)k("READY"\))e({)
620 2307 y(continue;)576 2404 y(})531 2501 y(})531 2598
y(//)89 b(Or)45 b(handle)e(reply)h(from)h(peer)f(broker)531
2695 y(else)g(if\($socket)f(===)h($cloudbe\))g({)576
2792 y(//)89 b(We)44 b(don't)g(use)h(peer)f(broker)g(address)f(for)i
(anything)576 2889 y($zmsg->recv\(\)->unwrap\(\);)531
2987 y(})531 3181 y(//)89 b(Route)44 b(reply)g(to)h(cloud)f(if)g(it's)g
(addressed)g(to)g(a)h(broker)531 3278 y(for\($argn)e(=)i(2;)f($argn)g
(<)h($_SERVER['argc'];)d($argn++\))h({)576 3375 y
(if\($zmsg->address\(\))e(==)k($_SERVER['argv'][$argn]\))c({)620
3472 y($zmsg->set_socket\($cloudfe\)->send\(\);)620 3569
y($zmsg)j(=)h(null;)576 3666 y(})531 3764 y(})531 3958
y(//)89 b(Route)44 b(reply)g(to)h(client)e(if)i(we)f(still)g(need)h(to)
531 4055 y(if\($zmsg\))e({)576 4152 y
($zmsg->set_socket\($localfe\)->send\(\);)531 4249 y(})486
4346 y(})441 4444 y(})441 4638 y(//)89 b(Now)45 b(route)f(as)g(many)g
(clients)g(requests)g(as)g(we)h(can)f(handle)441 4735
y(while\($capacity\))e({)486 4832 y($poll)i(=)h(new)f(ZMQPoll\(\);)486
4929 y($poll->add\($localfe,)d(ZMQ::POLL_IN\);)486 5026
y($poll->add\($cloudfe,)g(ZMQ::POLL_IN\);)486 5124 y($reroutable)i(=)i
(false;)p Black 3759 5569 a Fi(138)p Black eop end
%%Page: 139 153
TeXDict begin 139 152 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.139) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 486 72 a Fg($events)44 b(=)g($poll->poll\($readable,)
d($writeable,)i(0\);)486 170 y(if\($events)g(>)i(0\))f({)531
267 y(foreach\($readable)e(as)i($socket\))g({)576 364
y($zmsg)g(=)g(new)h(Zmsg\($socket\);)576 461 y($zmsg->recv\(\);)576
558 y(//)89 b(We'll)44 b(do)g(peer)h(brokers)e(first,)h(to)h(prevent)e
(starvation)576 655 y(if\($socket)g(===)h($cloudfe\))f({)620
752 y($reroutable)g(=)i(false;)576 850 y(})576 947 y(else)f
(if\($socket)f(===)h($localfe\))g({)620 1044 y($reroutable)f(=)i(true;)
576 1141 y(})576 1335 y(//)89 b(If)44 b(reroutable,)f(send)i(to)f
(cloud)g(20\045)g(of)h(the)f(time)576 1432 y(//)89 b(Here)44
b(we'd)g(normally)g(use)g(cloud)g(status)g(information)576
1530 y(if\($reroutable)e(&&)j($_SERVER['argc'])d(>)i(2)h(&&)g
(mt_rand\(0,)e(4\))h(==)h(0\))f({)620 1627 y
($zmsg->wrap\($_SERVER['argv'][mt_rand\(2,)39 b
(\($_SERVER['argc']-1\)\)]\);)620 1724 y
($zmsg->set_socket\($cloudbe\)->send\(\);)576 1821 y(})576
1918 y(else)44 b({)620 2015 y
($zmsg->wrap\(array_shift\($worker_queue\),)39 b(""\);)620
2112 y($zmsg->set_socket\($localbe\)->send\(\);)620 2209
y($capacity--;)576 2307 y(})531 2404 y(})486 2501 y(})45
b(else)f({)531 2598 y(break;)g(//)89 b(No)44 b(work,)g(go)h(back)f(to)h
(backends)486 2695 y(})441 2792 y(})-2 2967 y
SDict begin H.S end
 -2 2967
a -2 2967 a
SDict begin 13 H.A end
 -2 2967 a -2 2967 a
SDict begin [/View [/XYZ H.V]/Dest (0:1906) cvn /DEST pdfmark end
 -2 2967 a 396 3066 a
Fj(Run)20 b(this)h(by)-5 b(,)19 b(for)h(instance,)f(starting)h(tw)o(o)h
(instance)e(of)h(the)h(brok)o(er)d(in)j(tw)o(o)f(windo)n(ws:)-2
3167 y
SDict begin H.S end
 -2 3167 a -2 3167 a
SDict begin 11.7 H.A end
 -2 3167 a -2 3167 a
SDict begin [/View [/XYZ H.V]/Dest (0:1907) cvn /DEST pdfmark end
 -2 3167
a 396 3246 a Fg(peering2)44 b(me)g(you)396 3344 y(peering2)g(you)g(me)
-2 3521 y
SDict begin H.S end
 -2 3521 a -2 3521 a
SDict begin 13 H.A end
 -2 3521 a -2 3521 a
SDict begin [/View [/XYZ H.V]/Dest (0:1908) cvn /DEST pdfmark end
 -2
3521 a 396 3618 a Fj(Some)20 b(comments)f(on)h(this)h(code:)-2
3619 y
SDict begin H.S end
 -2 3619 a -2 3619 a
SDict begin 13 H.A end
 -2 3619 a -2 3619 a
SDict begin [/View [/XYZ H.V]/Dest (0:1909) cvn /DEST pdfmark end
 -2 3619
a -2 3629 a
SDict begin H.S end
 -2 3629 a -2 3629 a
SDict begin 13 H.A end
 -2 3629 a -2 3629 a
SDict begin [/View [/XYZ H.V]/Dest (0:1910) cvn /DEST pdfmark end
 -2
3629 a Black 396 3788 a Fe(\225)p Black 479 3788 a
SDict begin H.S end
 479
3788 a 479 3788 a
SDict begin 13 H.A end
 479 3788 a 479 3788 a
SDict begin [/View [/XYZ H.V]/Dest (0:1911) cvn /DEST pdfmark end
 479 3788 a Fj(Using)f(the)h
(zmsg)f(class)h(mak)o(es)f(life)g(much)f(easier)m(,)h(and)g(our)f(code)
h(much)f(shorter)-5 b(.)20 b(It')-5 b(s)20 b(ob)o(viously)e(an)j
(abstraction)479 3896 y(that)g(w)o(orks.)e(If)h(you)f(b)n(uild)h
(\330MQ)h(applications)e(in)h(C,)h(you)e(should)g(use)i(CZMQ.)-2
3914 y
SDict begin H.S end
 -2 3914 a -2 3914 a
SDict begin 13 H.A end
 -2 3914 a -2 3914 a
SDict begin [/View [/XYZ H.V]/Dest (0:1912) cvn /DEST pdfmark end
 -2 3914
a Black 396 4045 a Fe(\225)p Black 479 4045 a
SDict begin H.S end
 479 4045
a 479 4045 a
SDict begin 13 H.A end
 479 4045 a 479 4045 a
SDict begin [/View [/XYZ H.V]/Dest (0:1913) cvn /DEST pdfmark end
 479 4045 a Fj(Since)g(we')l(re)e
(not)h(getting)f(an)o(y)h(state)h(information)c(from)j(peers,)f(we)i
(nai)n(v)o(ely)e(assume)h(the)o(y)f(are)h(running.)e(The)479
4153 y(code)i(prompts)f(you)g(to)h(con\002rm)f(when)h(you')l(v)o(e)e
(started)i(all)h(the)f(brok)o(ers.)f(In)g(the)i(real)f(case)h(we')l(d)e
(not)h(send)479 4261 y(an)o(ything)e(to)j(brok)o(ers)e(who)g(had)h(not)
g(told)g(us)g(the)o(y)g(e)o(xist.)-2 4445 y
SDict begin H.S end
 -2 4445 a
-2 4445 a
SDict begin 13 H.A end
 -2 4445 a -2 4445 a
SDict begin [/View [/XYZ H.V]/Dest (0:1914) cvn /DEST pdfmark end
 -2 4445 a 396 4535 a Fj(Y)-9
b(ou)20 b(can)g(satisfy)g(yourself)f(that)h(the)h(code)e(w)o(orks)h(by)
g(w)o(atching)f(it)i(run)e(fore)n(v)o(er)-5 b(.)19 b(If)h(there)f(were)
i(an)o(y)e(misrouted)396 4643 y(messages,)h(clients)h(w)o(ould)e(end)h
(up)g(blocking,)e(and)h(the)i(brok)o(ers)e(w)o(ould)g(stop)h(printing)f
(trace)h(information.)e(Y)-9 b(ou)19 b(can)396 4751 y(pro)o(v)o(e)f
(that)i(by)f(killing)g(either)h(of)f(the)h(brok)o(ers.)e(The)i(other)e
(brok)o(er)h(tries)h(to)g(send)f(requests)h(to)g(the)f(cloud,)g(and)g
(one)g(by)396 4859 y(one)h(its)h(clients)g(block,)e(w)o(aiting)h(for)f
(an)h(answer)-5 b(.)-2 4887 y
SDict begin H.S end
 -2 4887 a -2 4887 a
SDict begin 13 H.A end
 -2
4887 a -2 4887 a
SDict begin [/View [/XYZ H.V]/Dest (0:1915) cvn /DEST pdfmark end
 -2 4887 a Black 3759 5569 a Fi(139)p
Black eop end
%%Page: 140 154
TeXDict begin 140 153 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.140) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 77 a Fd(3.9.8.)36 b(Putting)d(it)g(All)h(T)-10
b(og)q(ether)1968 77 y
SDict begin H.S end
 1968 77 a 1968 77 a
SDict begin 18.72 H.A end
 1968 77 a
1968 77 a
SDict begin [/View [/XYZ H.V]/Dest (8.39.24.2) cvn /DEST pdfmark end
 1968 77 a -2 269 a
SDict begin H.S end
 -2 269 a -2 269 a
SDict begin 13 H.A end
 -2 269
a -2 269 a
SDict begin [/View [/XYZ H.V]/Dest (0:1917) cvn /DEST pdfmark end
 -2 269 a 396 351 a Fj(Let')-5 b(s)21 b(put)f(this)h
(together)d(into)i(a)h(single)f(package.)f(As)i(before,)d(we')o(ll)j
(run)e(an)h(entire)g(cluster)g(as)h(one)f(process.)f(W)-7
b(e')l(re)396 459 y(going)19 b(to)h(tak)o(e)h(the)f(tw)o(o)g(pre)n
(vious)f(e)o(xamples)g(and)h(mer)o(ge)e(them)i(into)g(one)g(properly)e
(w)o(orking)g(design)i(that)g(lets)h(you)396 566 y(simulate)f(an)o(y)g
(number)e(of)i(clusters.)-2 751 y
SDict begin H.S end
 -2 751 a -2 751 a
SDict begin 13 H.A end
 -2
751 a -2 751 a
SDict begin [/View [/XYZ H.V]/Dest (0:1918) cvn /DEST pdfmark end
 -2 751 a 396 840 a Fj(This)f(code)g(is)h(the)f(size)g
(of)g(both)f(pre)n(vious)f(prototypes)g(together)m(,)h(at)h(270)f(LoC.)
h(That')-5 b(s)19 b(pretty)f(good)g(for)g(a)i(simulation)396
948 y(of)g(a)h(cluster)f(that)g(includes)g(clients)g(and)g(w)o(ork)o
(ers)f(and)h(cloud)f(w)o(orkload)g(distrib)n(ution.)f(Here)i(is)i(the)e
(code:)-2 949 y
SDict begin H.S end
 -2 949 a -2 949 a
SDict begin 13 H.A end
 -2 949 a -2 949 a
SDict begin [/View [/XYZ H.V]/Dest (0:peering3-php) cvn /DEST pdfmark
end
 -2
949 a 396 1150 a Fk(Example)h(3-11.)d(Full)j(cluster)g(simulation)f
(\(peering3.php\))-2 1250 y
SDict begin H.S end
 -2 1250 a -2 1250 a
SDict begin 11.7 H.A end
 -2 1250
a -2 1250 a
SDict begin [/View [/XYZ H.V]/Dest (0:1921) cvn /DEST pdfmark end
 -2 1250 a 396 1330 a Fg(<?php)396 1427 y(/)441
1440 y(*)441 1537 y(*)531 1524 y(Broker)44 b(peering)f(simulation)g
(\(part)h(3\))441 1634 y(*)531 1621 y(Prototypes)f(the)h(full)g(flow)h
(of)f(status)g(and)g(tasks)441 1731 y(*)531 1718 y(@author)f(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
1829 y(*)486 1816 y(/)396 1913 y(include)g("zmsg.php";)396
2107 y(define\("NBR_CLIENTS",)e(10\);)396 2204 y
(define\("NBR_WORKERS",)g(3\);)396 2398 y(/)441 2411
y(*)441 2509 y(*)531 2496 y(Request-reply)g(client)i(using)g(REQ)h
(socket)441 2606 y(*)531 2593 y(To)f(simulate)g(load,)g(clients)f
(issue)h(a)h(burst)f(of)h(requests)e(and)h(then)441 2703
y(*)531 2690 y(sleep)g(for)g(a)h(random)f(period.)441
2800 y(*)486 2787 y(/)396 2884 y(function)g(client_thread\($self\))d({)
441 2981 y($context)j(=)g(new)h(ZMQContext\(\);)441 3078
y($client)f(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_REQ\);)441
3175 y($endpoint)i(=)i(sprintf\("ipc://\045s-localfe.ipc",)40
b($self\);)441 3273 y($client->connect\($endpoint\);)441
3467 y($monitor)k(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_PUSH\);)
441 3564 y($endpoint)i(=)i(sprintf\("ipc://\045s-monitor.ipc",)40
b($self\);)441 3661 y($monitor->connect\($endpoint\);)441
3758 y($readable)j(=)i($writeable)e(=)i(array\(\);)441
3953 y(while\(true\))e({)486 4050 y(sleep\(mt_rand\(0,)f(4\)\);)486
4147 y($burst)i(=)g(mt_rand\(1,)g(14\);)486 4244 y(while\($burst--\))e
({)531 4341 y(//)89 b(Send)44 b(request)g(with)g(random)g(hex)g(ID)531
4438 y($task_id)f(=)i(sprintf\("\04504X",)d(mt_rand\(0,)h(10000\)\);)
531 4535 y($client->send\($task_id\);)531 4730 y(//)89
b(Wait)44 b(max)h(ten)f(seconds)g(for)g(a)h(reply,)e(then)i(complain)
531 4827 y($poll)f(=)g(new)h(ZMQPoll\(\);)531 4924 y
($poll->add\($client,)c(ZMQ::POLL_IN\);)531 5021 y($events)i(=)i
($poll->poll\($readable,)c($writeable,)i(10)2683 5034
y(*)2772 5021 y(1000000\);)531 5118 y(if\($events)g(>)i(0\))f({)p
Black 3759 5569 a Fi(140)p Black eop end
%%Page: 141 155
TeXDict begin 141 154 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.141) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 576 72 a Fg(foreach\($readable)42 b(as)i($socket\))g
({)620 170 y($zmsg)g(=)h(new)f(Zmsg\($socket\);)620 267
y($zmsg->recv\(\);)620 364 y(//)90 b(Worker)44 b(is)g(supposed)g(to)g
(answer)g(us)g(with)h(our)f(task)g(id)620 461 y
(assert\($zmsg->body\(\))e(==)i($task_id\);)576 558 y(})531
655 y(})g(else)h({)576 752 y($monitor->send\(sprintf\("E:)40
b(CLIENT)k(EXIT)g(-)h(lost)f(task)g(\045s",)g($task_id\)\);)576
850 y(exit\(\);)531 947 y(})486 1044 y(})441 1141 y(})396
1238 y(})396 1432 y(//)90 b(Worker)43 b(using)h(REQ)h(socket)f(to)g(do)
h(LRU)f(routing)396 1530 y(function)g(worker_thread)e(\($self\))i({)441
1627 y($context)g(=)g(new)h(ZMQContext\(\);)441 1724
y($worker)f(=)g($context->getSocket\(ZMQ::SOCKET_REQ\);)441
1821 y($endpoint)f(=)i(sprintf\("ipc://\045s-localbe.ipc",)40
b($self\);)441 1918 y($worker->connect\($endpoint\);)576
2112 y(//)89 b(Tell)44 b(broker)g(we're)g(ready)g(for)g(work)441
2209 y($worker->send\("READY"\);)441 2404 y(while\(true\))f({)486
2501 y($zmsg)h(=)h(new)f(Zmsg\($worker\);)486 2598 y($zmsg->recv\(\);)
486 2792 y(sleep\(mt_rand\(0,2\)\);)486 2889 y($zmsg->send\(\);)576
2987 y(})396 3084 y(})396 3278 y(//)90 b(First)44 b(argument)f(is)i
(this)f(broker's)f(name)396 3375 y(//)90 b(Other)44 b(arguments)f(are)h
(our)h(peers')e(names)396 3472 y(if\($_SERVER['argc'])f(<)j(2\))f({)441
3569 y(echo)g("syntax:)g(peering2)f(me)i({you}...",)e(PHP_EOL;)576
3666 y(exit\(\);)396 3764 y(})396 3958 y($self)h(=)h
($_SERVER['argv'][1];)396 4152 y(for\($client_nbr)e(=)h(0;)h
($client_nbr)e(<)h(NBR_CLIENTS;)f($client_nbr++\))g({)441
4249 y($pid)h(=)h(pcntl_fork\(\);)441 4346 y(if\($pid)f(==)g(0\))h({)
486 4444 y(client_thread\($self\);)486 4541 y(return;)441
4638 y(})396 4735 y(})396 4929 y(for\($worker_nbr)e(=)h(0;)h
($worker_nbr)e(<)h(NBR_WORKERS;)f($worker_nbr++\))g({)441
5026 y($pid)h(=)h(pcntl_fork\(\);)441 5124 y(if\($pid)f(==)g(0\))h({)p
Black 3759 5569 a Fi(141)p Black eop end
%%Page: 142 156
TeXDict begin 142 155 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.142) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 486 72 a Fg(worker_thread\($self\);)486
170 y(return;)441 267 y(})396 364 y(})396 558 y(printf)44
b(\("I:)g(preparing)g(broker)f(at)i(\045s...)f(\045s",)g($self,)g
(PHP_EOL\);)396 752 y(//)90 b(Prepare)43 b(our)i(context)e(and)i
(sockets)396 850 y($context)f(=)g(new)h(ZMQContext\(\);)396
1044 y(//)90 b(Bind)44 b(cloud)g(frontend)f(to)i(endpoint)396
1141 y($cloudfe)f(=)g($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396
1238 y($endpoint)g(=)g(sprintf\("ipc://\045s-cloud.ipc",)c($self\);)396
1335 y($cloudfe->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)f($self\);)396
1432 y($cloudfe->bind\($endpoint\);)396 1627 y(//)90
b(Connect)43 b(cloud)h(backend)g(to)g(all)h(peers)396
1724 y($cloudbe)f(=)g($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396
1821 y($cloudbe->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)39
b($self\);)396 2015 y(for)45 b(\($argn)e(=)i(2;)g($argn)f(<)g
($_SERVER['argc'];)e($argn++\))i({)441 2112 y($peer)g(=)h
($_SERVER['argv'][$argn];)441 2209 y(printf)f(\("I:)g(connecting)f(to)i
(cloud)f(backend)f(at)i('\045s'\045s",)e($peer,)h(PHP_EOL\);)441
2307 y($endpoint)f(=)i(sprintf\("ipc://\045s-cloud.ipc",)40
b($peer\);)441 2404 y($cloudbe->connect\($endpoint\);)396
2501 y(})396 2695 y(//)90 b(Bind)44 b(state)g(backend)f(/)i(publisher)e
(to)i(endpoint)396 2792 y($statebe)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_PUB\);)396 2889 y($endpoint)j(=)g
(sprintf\("ipc://\045s-state.ipc",)c($self\);)396 2987
y($statebe->bind\($endpoint\);)396 3181 y(//)90 b(Connect)43
b(statefe)h(to)g(all)h(peers)396 3278 y($statefe)f(=)g
($context->getSocket\(ZMQ::SOCKET_SUB\);)396 3375 y
($statefe->setSockOpt\(ZMQ::SOCKOPT_SUBSCRI)o(BE,)39
b(""\);)396 3569 y(for)45 b(\($argn)e(=)i(2;)g($argn)f(<)g
($_SERVER['argc'];)e($argn++\))i({)441 3666 y($peer)g(=)h
($_SERVER['argv'][$argn];)441 3764 y(printf)f(\("I:)g(connecting)f(to)i
(state)f(backend)f(at)i('\045s'\045s",)e($peer,)h(PHP_EOL\);)441
3861 y($endpoint)f(=)i(sprintf\("ipc://\045s-state.ipc",)40
b($peer\);)441 3958 y($statefe->connect\($endpoint\);)396
4055 y(})396 4249 y(//)90 b(Prepare)43 b(monitor)h(socket)396
4346 y($monitor)g(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_PULL\);)
396 4444 y($endpoint)j(=)g(sprintf\("ipc://\045s-monitor.ipc",)c
($self\);)396 4541 y($monitor->bind\($endpoint\);)396
4735 y(//)90 b(Prepare)43 b(local)h(frontend)g(and)g(backend)396
4832 y($localfe)g(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_ROUTER\);)396 4929 y($endpoint)j(=)g
(sprintf\("ipc://\045s-localfe.ipc",)c($self\);)396 5026
y($localfe->bind\($endpoint\);)396 5124 y($localbe)k(=)g(new)h
(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)p Black
3759 5569 a Fi(142)p Black eop end
%%Page: 143 157
TeXDict begin 143 156 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.143) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fg($endpoint)44 b(=)g
(sprintf\("ipc://\045s-localbe.ipc",)c($self\);)396 170
y($localbe->bind\($endpoint\);)396 461 y(//)90 b(Interesting)43
b(part)396 558 y(//)90 b(-------------------------------------)o
(------)o(------)o(------)o(------)396 655 y(//)g(Publish-subscribe)42
b(flow)396 752 y(//)90 b(-)44 b(Poll)g(statefe)g(and)g(process)g
(capacity)g(updates)396 850 y(//)90 b(-)44 b(Each)g(time)h(capacity)e
(changes,)h(broadcast)f(new)h(value)396 947 y(//)90 b(Request-reply)42
b(flow)396 1044 y(//)90 b(-)44 b(Poll)g(primary)g(and)g(process)g
(local/cloud)f(replies)396 1141 y(//)90 b(-)44 b(While)g(worker)g
(available,)f(route)h(localfe)g(to)g(local)g(or)h(cloud)396
1335 y(//)90 b(Queue)44 b(of)g(available)f(workers)396
1432 y($local_capacity)g(=)h(0;)396 1530 y($cloud_capacity)f(=)h(0;)396
1627 y($worker_queue)f(=)i(array\(\);)396 1724 y($readable)f(=)g
($writeable)f(=)i(array\(\);)396 1918 y(while\(true\))e({)441
2015 y($poll)h(=)h(new)f(ZMQPoll\(\);)441 2112 y($poll->add\($localbe,)
e(ZMQ::POLL_IN\);)441 2209 y($poll->add\($cloudbe,)g(ZMQ::POLL_IN\);)
441 2307 y($poll->add\($statefe,)g(ZMQ::POLL_IN\);)441
2404 y($poll->add\($monitor,)g(ZMQ::POLL_IN\);)441 2501
y($events)i(=)g(0;)441 2695 y(//)89 b(If)45 b(we)f(have)h(no)f(workers)
g(anyhow,)f(wait)i(indefinitely)441 2792 y(try)f({)486
2889 y($events)g(=)g($poll->poll\($readable,)d($writeable,)i
($local_capacity)g(?)h(1000000)g(:)h(-1\);)441 2987 y(})g
(catch\(ZMQPollException)c($e\))j({)486 3084 y(break;)441
3181 y(})441 3375 y(//)89 b(Track)44 b(if)h(capacity)e(changes)h
(during)g(this)g(iteration)441 3472 y($previous)f(=)i($local_capacity;)
576 3666 y(foreach\($readable)d(as)i($socket\))g({)486
3764 y($zmsg)g(=)h(new)f(Zmsg\($socket\);)486 3958 y(//)89
b(Handle)44 b(reply)g(from)g(local)g(worker)486 4055
y(if\($socket)f(===)h($localbe\))g({)531 4152 y(//)89
b(Use)44 b(worker)g(address)g(for)g(LRU)h(routing)531
4249 y($zmsg->recv\(\);)531 4346 y($worker_queue[])d(=)j
($zmsg->unwrap\(\);)531 4444 y($local_capacity++;)531
4541 y(if\($zmsg->body\(\))d(==)i("READY"\))g({)576 4638
y($zmsg)g(=)g(null;)g(//)90 b(Don't)44 b(route)g(it)531
4735 y(})486 4832 y(})486 4929 y(//)89 b(Or)45 b(handle)f(reply)g(from)
g(peer)g(broker)486 5026 y(else)g(if\($socket)f(===)i($cloudbe\))e({)
531 5124 y(//)89 b(We)45 b(don't)f(use)g(peer)g(broker)g(address)g(for)
g(anything)p Black 3759 5569 a Fi(143)p Black eop end
%%Page: 144 158
TeXDict begin 144 157 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.144) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 531 72 a Fg($zmsg->recv\(\)->unwrap\(\);)486
170 y(})486 267 y(//)89 b(Handle)44 b(capacity)g(updates)486
364 y(else)g(if\($socket)f(===)i($statefe\))e({)531 461
y($zmsg->recv\(\);)531 558 y($cloud_capacity)f(=)j($zmsg->body\(\);)531
655 y($zmsg)f(=)g(null;)486 752 y(})486 850 y(//)89 b(Handle)44
b(monitor)g(message)486 947 y(else)g(if\($socket)f(===)i($monitor\))e
({)531 1044 y($zmsg->recv\(\);)531 1141 y(echo)h($zmsg->body\(\),)e
(PHP_EOL;)531 1238 y($zmsg)i(=)g(null;)486 1335 y(})486
1530 y(if\($zmsg\))f({)531 1627 y(//)89 b(Route)44 b(reply)g(to)h
(cloud)f(if)g(it's)g(addressed)g(to)g(a)h(broker)531
1724 y(for\($argn)e(=)i(2;)f($argn)g(<)h($_SERVER['argc'];)d($argn++\))
h({)576 1821 y(if\($zmsg->address\(\))e(==)k($_SERVER['argv'][$argn]\))
c({)620 1918 y($zmsg->set_socket\($cloudfe\)->send\(\);)620
2015 y($zmsg)j(=)h(null;)576 2112 y(})531 2209 y(})486
2307 y(})486 2501 y(//)89 b(Route)44 b(reply)g(to)h(client)f(if)g(we)h
(still)f(need)g(to)486 2598 y(if\($zmsg\))f({)531 2695
y($zmsg->set_socket\($localfe\)->send\(\);)486 2792 y(})441
2889 y(})441 3084 y(//)89 b(Now)45 b(route)f(as)g(many)g(clients)g
(requests)g(as)g(we)h(can)f(handle)441 3181 y(//)89 b(-)45
b(If)g(we)f(have)g(local)g(capacity)g(we)g(poll)g(both)h(localfe)e(and)
i(cloudfe)441 3278 y(//)89 b(-)45 b(If)g(we)f(have)g(cloud)g(capacity)g
(only,)g(we)g(poll)g(just)h(localfe)441 3375 y(//)89
b(-)45 b(Route)f(any)g(request)g(locally)g(if)g(we)h(can,)f(else)g(to)h
(cloud)441 3472 y(while\($local_capacity)c(+)k($cloud_capacity\))d({)
486 3569 y($poll)i(=)h(new)f(ZMQPoll\(\);)486 3666 y
($poll->add\($localfe,)d(ZMQ::POLL_IN\);)486 3764 y
(if\($local_capacity\))h({)531 3861 y($poll->add\($cloudfe,)f
(ZMQ::POLL_IN\);)486 3958 y(})486 4055 y($reroutable)i(=)i(false;)486
4152 y($events)f(=)g($poll->poll\($readable,)d($writeable,)i(0\);)486
4249 y(if\($events)g(>)i(0\))f({)531 4346 y(foreach\($readable)e(as)i
($socket\))g({)576 4444 y($zmsg)g(=)g(new)h(Zmsg\($socket\);)576
4541 y($zmsg->recv\(\);)576 4735 y(if\($local_capacity\))c({)620
4832 y($zmsg->wrap\(array_shift\($worker_queue\),)e(""\);)620
4929 y($zmsg->set_socket\($localbe\)->send\(\);)620 5026
y($local_capacity--;)576 5124 y(})p Black 3759 5569 a
Fi(144)p Black eop end
%%Page: 145 159
TeXDict begin 145 158 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.145) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 576 72 a Fg(else)44 b({)620 170 y(//)90
b(Route)44 b(to)g(random)g(broker)g(peer)620 267 y(printf)g(\("I:)g
(route)g(request)g(\045s)h(to)f(cloud...\045s",)f($zmsg->body\(\),)f
(PHP_EOL\);)620 364 y($zmsg->wrap\($_SERVER['argv'][mt_rand\(2,)d
(\($_SERVER['argc']-1\)\)]\);)620 461 y
($zmsg->set_socket\($cloudbe\)->send\(\);)576 558 y(})531
655 y(})486 752 y(})45 b(else)f({)531 850 y(break;)g(//)89
b(No)44 b(work,)g(go)h(back)f(to)h(backends)486 947 y(})441
1044 y(})441 1238 y(if)g(\($local_capacity)d(!=)i($previous\))f({)755
1335 y(//)89 b(Broadcast)44 b(new)g(capacity)755 1432
y($zmsg)g(=)h(new)f(Zmsg\($statebe\);)486 1530 y
($zmsg->body_set\($local_capacity\);)486 1627 y(//)89
b(We)45 b(stick)f(our)g(own)g(address)g(onto)g(the)h(envelope)486
1724 y($zmsg->wrap\($self\)->send\(\);)576 1821 y(})396
1918 y(})-2 2092 y
SDict begin H.S end
 -2 2092 a -2 2092 a
SDict begin 13 H.A end
 -2 2092 a -2 2092
a
SDict begin [/View [/XYZ H.V]/Dest (0:1922) cvn /DEST pdfmark end
 -2 2092 a 396 2192 a Fj(It')-5 b(s)21 b(a)g(non-tri)n(vial)d(program)
g(and)i(took)f(about)g(a)i(day)e(to)i(get)f(w)o(orking.)e(These)i(are)h
(the)f(highlights:)-2 2210 y
SDict begin H.S end
 -2 2210 a -2 2210 a
SDict begin 13 H.A end
 -2 2210
a -2 2210 a
SDict begin [/View [/XYZ H.V]/Dest (0:1923) cvn /DEST pdfmark end
 -2 2210 a -2 2220 a
SDict begin H.S end
 -2 2220 a -2 2220 a
SDict begin 13 H.A end
 -2
2220 a -2 2220 a
SDict begin [/View [/XYZ H.V]/Dest (0:1924) cvn /DEST pdfmark end
 -2 2220 a Black 396 2362 a Fe(\225)p
Black 479 2362 a
SDict begin H.S end
 479 2362 a 479 2362 a
SDict begin 13 H.A end
 479 2362 a 479
2362 a
SDict begin [/View [/XYZ H.V]/Dest (0:1925) cvn /DEST pdfmark end
 479 2362 a Fj(The)g(client)g(threads)g(detect)g(and)g(report)f
(a)h(f)o(ailed)g(request.)f(The)o(y)h(do)f(this)i(by)f(polling)f(for)g
(a)i(response)e(and)h(if)g(none)479 2470 y(arri)n(v)o(es)g(after)f(a)i
(while)f(\(10)g(seconds\),)f(printing)f(an)j(error)e(message.)-2
2488 y
SDict begin H.S end
 -2 2488 a -2 2488 a
SDict begin 13 H.A end
 -2 2488 a -2 2488 a
SDict begin [/View [/XYZ H.V]/Dest (0:1926) cvn /DEST pdfmark end
 -2 2488
a Black 396 2620 a Fe(\225)p Black 479 2620 a
SDict begin H.S end
 479 2620
a 479 2620 a
SDict begin 13 H.A end
 479 2620 a 479 2620 a
SDict begin [/View [/XYZ H.V]/Dest (0:1927) cvn /DEST pdfmark end
 479 2620 a Fj(Client)i(threads)f
(don')o(t)e(print)i(directly)-5 b(,)18 b(b)n(ut)j(instead)f(send)f(a)i
(message)f(to)g(a)h('monitor')d(sock)o(et)i(\(PUSH\))g(that)h(the)479
2728 y(main)f(loop)f(collects)i(\(PULL\))e(and)h(prints)g(of)n(f.)f
(This)i(is)g(the)f(\002rst)h(case)f(we')l(v)o(e)g(seen)g(of)g(using)g
(\330MQ)g(sock)o(ets)g(for)479 2835 y(monitoring)e(and)i(logging;)e
(this)j(is)g(a)g(big)f(use)g(case)h(we')o(ll)f(come)g(back)f(to)i
(later)-5 b(.)-2 2853 y
SDict begin H.S end
 -2 2853 a -2 2853 a
SDict begin 13 H.A end
 -2 2853 a
-2 2853 a
SDict begin [/View [/XYZ H.V]/Dest (0:1928) cvn /DEST pdfmark end
 -2 2853 a Black 396 2985 a Fe(\225)p Black
479 2985 a
SDict begin H.S end
 479 2985 a 479 2985 a
SDict begin 13 H.A end
 479 2985 a 479 2985
a
SDict begin [/View [/XYZ H.V]/Dest (0:1929) cvn /DEST pdfmark end
 479 2985 a Fj(Clients)21 b(simulate)f(v)n(arying)f(loads)h(to)g(get)g
(the)h(cluster)f(100\045)f(at)i(random)d(moments,)h(so)i(that)f(tasks)h
(are)f(shifted)479 3093 y(o)o(v)o(er)f(to)h(the)h(cloud.)e(The)g
(number)g(of)h(clients)g(and)g(w)o(ork)o(ers,)f(and)h(delays)g(in)g
(the)g(client)g(and)g(w)o(ork)o(er)f(threads)479 3201
y(control)g(this.)i(Feel)f(free)g(to)h(play)e(with)i(them)e(to)i(see)g
(if)f(you)f(can)h(mak)o(e)g(a)h(more)e(realistic)i(simulation.)-2
3219 y
SDict begin H.S end
 -2 3219 a -2 3219 a
SDict begin 13 H.A end
 -2 3219 a -2 3219 a
SDict begin [/View [/XYZ H.V]/Dest (0:1930) cvn /DEST pdfmark end
 -2 3219
a Black 396 3350 a Fe(\225)p Black 479 3350 a
SDict begin H.S end
 479 3350
a 479 3350 a
SDict begin 13 H.A end
 479 3350 a 479 3350 a
SDict begin [/View [/XYZ H.V]/Dest (0:1931) cvn /DEST pdfmark end
 479 3350 a Fj(The)f(main)f(loop)g
(uses)h(tw)o(o)g(pollsets.)g(It)g(could)e(in)i(f)o(act)g(use)g(three:)f
(information,)e(back)o(ends,)h(and)i(frontends.)d(As)k(in)479
3458 y(the)f(earlier)g(prototype,)e(there)i(is)h(no)f(point)f(in)h
(taking)g(a)g(frontend)e(message)i(if)h(there)f(is)h(no)f(back)o(end)e
(capacity)-5 b(.)-2 3642 y
SDict begin H.S end
 -2 3642 a -2 3642 a
SDict begin 13 H.A end
 -2 3642
a -2 3642 a
SDict begin [/View [/XYZ H.V]/Dest (0:1932) cvn /DEST pdfmark end
 -2 3642 a 396 3732 a Fj(These)20 b(are)g(some)g(of)g(the)h
(problems)d(that)j(hit)f(during)f(de)n(v)o(elopment)e(of)j(this)g
(program:)-2 3750 y
SDict begin H.S end
 -2 3750 a -2 3750 a
SDict begin 13 H.A end
 -2 3750 a -2
3750 a
SDict begin [/View [/XYZ H.V]/Dest (0:1933) cvn /DEST pdfmark end
 -2 3750 a -2 3760 a
SDict begin H.S end
 -2 3760 a -2 3760 a
SDict begin 13 H.A end
 -2 3760
a -2 3760 a
SDict begin [/View [/XYZ H.V]/Dest (0:1934) cvn /DEST pdfmark end
 -2 3760 a Black 396 3902 a Fe(\225)p Black
479 3902 a
SDict begin H.S end
 479 3902 a 479 3902 a
SDict begin 13 H.A end
 479 3902 a 479 3902
a
SDict begin [/View [/XYZ H.V]/Dest (0:1935) cvn /DEST pdfmark end
 479 3902 a Fj(Clients)h(w)o(ould)f(freeze,)f(due)h(to)g(requests)g
(or)g(replies)g(getting)f(lost)i(some)n(where.)d(Recall)j(that)g(the)f
(\330MQ)479 4010 y(R)m(OUTER/R)m(OUTER)h(sock)o(et)f(drops)f(messages)h
(it)h(can')o(t)e(route.)h(The)f(\002rst)i(tactic)g(here)f(w)o(as)h(to)f
(modify)e(the)j(client)479 4118 y(thread)f(to)g(detect)g(and)g(report)f
(such)g(problems.)g(Secondly)-5 b(,)18 b(I)i(put)g(zmsg_dump\(\))d
(calls)k(after)f(e)n(v)o(ery)f(recv\(\))g(and)479 4226
y(before)g(e)n(v)o(ery)g(send\(\))g(in)h(the)h(main)e(loop,)h(until)g
(it)h(w)o(as)g(clear)f(what)g(the)g(problems)f(were.)-2
4244 y
SDict begin H.S end
 -2 4244 a -2 4244 a
SDict begin 13 H.A end
 -2 4244 a -2 4244 a
SDict begin [/View [/XYZ H.V]/Dest (0:1936) cvn /DEST pdfmark end
 -2 4244
a Black 396 4376 a Fe(\225)p Black 479 4376 a
SDict begin H.S end
 479 4376
a 479 4376 a
SDict begin 13 H.A end
 479 4376 a 479 4376 a
SDict begin [/View [/XYZ H.V]/Dest (0:1937) cvn /DEST pdfmark end
 479 4376 a Fj(The)h(main)f(loop)g(w)
o(as)h(mistak)o(enly)f(reading)f(from)h(more)g(than)g(one)g(ready)g
(sock)o(et.)g(This)h(caused)f(the)h(\002rst)g(message)479
4483 y(to)h(be)f(lost.)g(Fix)o(ed)g(that)g(by)g(reading)f(only)g(from)g
(the)h(\002rst)h(ready)e(sock)o(et.)-2 4501 y
SDict begin H.S end
 -2 4501
a -2 4501 a
SDict begin 13 H.A end
 -2 4501 a -2 4501 a
SDict begin [/View [/XYZ H.V]/Dest (0:1938) cvn /DEST pdfmark end
 -2 4501 a Black 396 4633
a Fe(\225)p Black 479 4633 a
SDict begin H.S end
 479 4633 a 479 4633 a
SDict begin 13 H.A end
 479
4633 a 479 4633 a
SDict begin [/View [/XYZ H.V]/Dest (0:1939) cvn /DEST pdfmark end
 479 4633 a Fj(The)h(zmsg)g(class)h(w)o(as)g(not)f
(properly)e(encoding)g(UUIDs)j(as)g(C)g(strings.)f(This)g(caused)g
(UUIDs)g(that)h(contain)e(0)479 4741 y(bytes)h(to)h(be)f(corrupted.)d
(Fix)o(ed)j(by)g(modifying)e(zmsg)i(to)g(encode)f(UUIDs)h(as)h
(printable)e(he)o(x)g(strings.)-2 4925 y
SDict begin H.S end
 -2 4925 a -2
4925 a
SDict begin 13 H.A end
 -2 4925 a -2 4925 a
SDict begin [/View [/XYZ H.V]/Dest (0:1940) cvn /DEST pdfmark end
 -2 4925 a 396 5015 a Fj(This)h(simulation)f
(does)g(not)h(detect)f(disappearance)f(of)h(a)h(cloud)f(peer)-5
b(.)19 b(If)g(you)g(start)h(se)n(v)o(eral)f(peers)h(and)f(stop)g(one,)g
(and)396 5123 y(it)i(w)o(as)f(broadcasting)d(capacity)i(to)h(the)g
(others,)e(the)o(y)h(will)i(continue)d(to)h(send)h(it)g(w)o(ork)f(e)n
(v)o(en)g(if)h(it')-5 b(s)20 b(gone.)f(Y)-9 b(ou)19 b(can)g(try)p
Black 3759 5569 a Fi(145)p Black eop end
%%Page: 146 160
TeXDict begin 146 159 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.146) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2384 -132 a Fi(Chapter)20 b(3.)g(Advanced)e(Request-Reply)g(P)-7
b(atterns)p Black 396 72 a Fj(this,)21 b(and)e(you)h(will)h(get)f
(clients)g(that)h(complain)d(of)i(lost)h(requests.)f(The)f(solution)h
(is)h(tw)o(ofold:)e(\002rst,)i(only)e(k)o(eep)h(the)396
180 y(capacity)g(information)d(for)j(a)h(short)e(time)i(so)f(that)h(if)
f(a)h(peer)e(does)h(disappear)m(,)f(its)i(capacity)e(is)i(quickly)e
(set)i(to)f('zero'.)396 288 y(Second,)f(add)h(reliability)f(to)i(the)f
(request-reply)e(chain.)h(W)-7 b(e')o(ll)21 b(look)f(at)g(reliability)g
(in)g(the)h(ne)o(xt)e(chapter)-5 b(.)p Black 3757 5569
a Fi(146)p Black eop end
%%Page: 147 161
TeXDict begin 147 160 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.147) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:reliable-request-reply) cvn /DEST
pdfmark end
 -2 -11 a 126 x Fl(Chapter)48 b(4.)f(Reliab)n(le)h(Request-Repl)m(y)g
(P)-5 b(atterns)3528 115 y
SDict begin H.S end
 3528 115 a 3528 115 a
SDict begin 26.957 H.A end
 3528
115 a 3528 115 a
SDict begin [/View [/XYZ H.V]/Dest (9.0) cvn /DEST pdfmark end
 3528 115 a -2 371 a
SDict begin H.S end
 -2 371 a -2 371
a
SDict begin 13 H.A end
 -2 371 a -2 371 a
SDict begin [/View [/XYZ H.V]/Dest (0:1943) cvn /DEST pdfmark end
 -2 371 a 396 443 a Fj(In)20 b(Adv)n(anced)e
(Request-Reply)i(P)o(atterns)p 0 TeXcolorgray 1623 443
a
SDict begin H.S end
 1623 443 a Fj(Chapter)f(3)1948 443 y
SDict begin 13 H.L end
 1948 443 a 1948
443 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1948 443 a Black 20 w Fj(we)h(look)o(ed)f(at)i(adv)n(anced)d(use)
j(of)e(\330MQ')-5 b(s)21 b(request-reply)396 551 y(pattern)f(with)g(w)o
(ork)o(ed)f(e)o(xamples.)g(In)h(this)g(chapter)g(we')o(ll)g(look)f(at)i
(the)f(general)f(question)h(of)f(reliability)h(and)g(b)n(uild)g(a)396
659 y(set)h(of)f(reliable)g(messaging)f(patterns)h(on)g(top)f(of)h
(\330MQ')-5 b(s)21 b(core)f(request-reply)e(pattern.)-2
843 y
SDict begin H.S end
 -2 843 a -2 843 a
SDict begin 13 H.A end
 -2 843 a -2 843 a
SDict begin [/View [/XYZ H.V]/Dest (0:1945) cvn /DEST pdfmark end
 -2 843 a 396
933 a Fj(In)i(this)h(chapter)e(we)i(focus)e(hea)n(vily)h(on)f(user)n
(-space)h(request-reply)e('patterns',)g(reusable)i(models)f(that)i
(help)e(you)396 1041 y(design)h(your)f(o)n(wn)g(\330MQ)i
(architectures:)-2 1059 y
SDict begin H.S end
 -2 1059 a -2 1059 a
SDict begin 13 H.A end
 -2 1059
a -2 1059 a
SDict begin [/View [/XYZ H.V]/Dest (0:1946) cvn /DEST pdfmark end
 -2 1059 a -2 1069 a
SDict begin H.S end
 -2 1069 a -2 1069 a
SDict begin 13 H.A end
 -2
1069 a -2 1069 a
SDict begin [/View [/XYZ H.V]/Dest (0:1947) cvn /DEST pdfmark end
 -2 1069 a Black 396 1211 a Fe(\225)p
Black 479 1211 a
SDict begin H.S end
 479 1211 a 479 1211 a
SDict begin 13 H.A end
 479 1211 a 479
1211 a
SDict begin [/View [/XYZ H.V]/Dest (0:1948) cvn /DEST pdfmark end
 479 1211 a Fj(The)629 1211 y
SDict begin H.S end
 629 1211 a 629 1211
a
SDict begin 13 H.A end
 629 1211 a 629 1211 a
SDict begin [/View [/XYZ H.V]/Dest (0:1949) cvn /DEST pdfmark end
 629 1211 a Fi(Lazy)g(Pir)o(ate)f
Fj(pattern:)f(reliable)h(request)f(reply)h(from)f(the)h(client)g(side.)
-2 1229 y
SDict begin H.S end
 -2 1229 a -2 1229 a
SDict begin 13 H.A end
 -2 1229 a -2 1229 a
SDict begin [/View [/XYZ H.V]/Dest (0:1950) cvn /DEST pdfmark end
 -2
1229 a Black 396 1360 a Fe(\225)p Black 479 1360 a
SDict begin H.S end
 479
1360 a 479 1360 a
SDict begin 13 H.A end
 479 1360 a 479 1360 a
SDict begin [/View [/XYZ H.V]/Dest (0:1951) cvn /DEST pdfmark end
 479 1360 a Fj(The)629
1360 y
SDict begin H.S end
 629 1360 a 629 1360 a
SDict begin 13 H.A end
 629 1360 a 629 1360 a
SDict begin [/View [/XYZ H.V]/Dest (0:1952) cvn /DEST pdfmark end
 629
1360 a Fi(Simple)g(Pir)o(ate)g Fj(pattern:)f(reliable)h(request-reply)e
(using)h(a)i(LR)m(U)g(queue.)-2 1378 y
SDict begin H.S end
 -2 1378 a -2 1378
a
SDict begin 13 H.A end
 -2 1378 a -2 1378 a
SDict begin [/View [/XYZ H.V]/Dest (0:1953) cvn /DEST pdfmark end
 -2 1378 a Black 396 1510 a Fe(\225)p
Black 479 1510 a
SDict begin H.S end
 479 1510 a 479 1510 a
SDict begin 13 H.A end
 479 1510 a 479
1510 a
SDict begin [/View [/XYZ H.V]/Dest (0:1954) cvn /DEST pdfmark end
 479 1510 a Fj(The)629 1510 y
SDict begin H.S end
 629 1510 a 629 1510
a
SDict begin 13 H.A end
 629 1510 a 629 1510 a
SDict begin [/View [/XYZ H.V]/Dest (0:1955) cvn /DEST pdfmark end
 629 1510 a Fi(P)-7 b(ar)o(anoid)19
b(Pir)o(ate)h Fj(pattern:)f(reliable)h(request-reply)e(with)i
(heartbeating.)-2 1528 y
SDict begin H.S end
 -2 1528 a -2 1528 a
SDict begin 13 H.A end
 -2 1528
a -2 1528 a
SDict begin [/View [/XYZ H.V]/Dest (0:1956) cvn /DEST pdfmark end
 -2 1528 a Black 396 1659 a Fe(\225)p Black
479 1659 a
SDict begin H.S end
 479 1659 a 479 1659 a
SDict begin 13 H.A end
 479 1659 a 479 1659
a
SDict begin [/View [/XYZ H.V]/Dest (0:1957) cvn /DEST pdfmark end
 479 1659 a Fj(The)629 1659 y
SDict begin H.S end
 629 1659 a 629 1659 a
SDict begin 13 H.A end

629 1659 a 629 1659 a
SDict begin [/View [/XYZ H.V]/Dest (0:1958) cvn /DEST pdfmark end
 629 1659 a Fi(Major)m(domo)f Fj(pattern:)g
(service-oriented)f(reliable)i(queuing.)-2 1677 y
SDict begin H.S end
 -2
1677 a -2 1677 a
SDict begin 13 H.A end
 -2 1677 a -2 1677 a
SDict begin [/View [/XYZ H.V]/Dest (0:1959) cvn /DEST pdfmark end
 -2 1677 a Black
396 1809 a Fe(\225)p Black 479 1809 a
SDict begin H.S end
 479 1809 a 479
1809 a
SDict begin 13 H.A end
 479 1809 a 479 1809 a
SDict begin [/View [/XYZ H.V]/Dest (0:1960) cvn /DEST pdfmark end
 479 1809 a Fj(The)629 1809
y
SDict begin H.S end
 629 1809 a 629 1809 a
SDict begin 13 H.A end
 629 1809 a 629 1809 a
SDict begin [/View [/XYZ H.V]/Dest (0:1961) cvn /DEST pdfmark end
 629 1809
a Fi(T)-5 b(itanic)21 b Fj(pattern:)e(disk-based)g(/)i(disconnected)d
(reliable)i(queuing.)-2 1826 y
SDict begin H.S end
 -2 1826 a -2 1826 a
SDict begin 13 H.A end
 -2
1826 a -2 1826 a
SDict begin [/View [/XYZ H.V]/Dest (0:1962) cvn /DEST pdfmark end
 -2 1826 a Black 396 1958 a Fe(\225)p
Black 479 1958 a
SDict begin H.S end
 479 1958 a 479 1958 a
SDict begin 13 H.A end
 479 1958 a 479
1958 a
SDict begin [/View [/XYZ H.V]/Dest (0:1963) cvn /DEST pdfmark end
 479 1958 a Fj(The)629 1958 y
SDict begin H.S end
 629 1958 a 629 1958
a
SDict begin 13 H.A end
 629 1958 a 629 1958 a
SDict begin [/View [/XYZ H.V]/Dest (0:1964) cvn /DEST pdfmark end
 629 1958 a Fi(Binary)g(Star)i
Fj(pattern:)d(primary-backup)d(serv)o(er)k(f)o(ail-o)o(v)o(er)-5
b(.)-2 1976 y
SDict begin H.S end
 -2 1976 a -2 1976 a
SDict begin 13 H.A end
 -2 1976 a -2 1976 a
SDict begin [/View [/XYZ H.V]/Dest (0:1965) cvn /DEST pdfmark end

-2 1976 a Black 396 2107 a Fe(\225)p Black 479 2107 a
SDict begin H.S end

479 2107 a 479 2107 a
SDict begin 13 H.A end
 479 2107 a 479 2107 a
SDict begin [/View [/XYZ H.V]/Dest (0:1966) cvn /DEST pdfmark end
 479 2107
a Fj(The)629 2107 y
SDict begin H.S end
 629 2107 a 629 2107 a
SDict begin 13 H.A end
 629 2107 a
629 2107 a
SDict begin [/View [/XYZ H.V]/Dest (0:1967) cvn /DEST pdfmark end
 629 2107 a Fi(F)g(r)m(eelance)20 b Fj(pattern:)f(brok)o
(erless)g(reliable)h(request-reply)-5 b(.)-2 2125 y
SDict begin H.S end
 -2
2125 a -2 2125 a
SDict begin 13 H.A end
 -2 2125 a -2 2125 a
SDict begin [/View [/XYZ H.V]/Dest (0:1968) cvn /DEST pdfmark end
 -2 2125 a 360 x
Fh(4.1.)39 b(What)g(is)h("Reliability"?)1731 2485 y
SDict begin H.S end
 1731
2485 a 1731 2485 a
SDict begin 22.464 H.A end
 1731 2485 a 1731 2485 a
SDict begin [/View [/XYZ H.V]/Dest (9.40.1) cvn /DEST pdfmark end
 1731 2485
a -2 2680 a
SDict begin H.S end
 -2 2680 a -2 2680 a
SDict begin 13 H.A end
 -2 2680 a -2 2680 a
SDict begin [/View [/XYZ H.V]/Dest (0:1970) cvn /DEST pdfmark end
 -2
2680 a 396 2758 a Fj(Most)21 b(people)e(who)h(speak)f(of)h(')l
(reliability')f(don')o(t)g(really)g(kno)n(w)g(what)i(the)o(y)e(mean.)g
(W)-7 b(e)22 b(can)e(only)f(de\002ne)h(reliability)396
2866 y(in)h(terms)f(of)g(f)o(ailure.)f(That)h(is,)h(if)f(we)h(can)f
(handle)f(a)i(certain)e(set)i(of)f(well-de\002ned)f(and)h(understood)d
(f)o(ailures,)j(we)h(are)396 2974 y(reliable)f(with)g(respect)g(to)h
(those)f(f)o(ailures.)f(No)h(more,)g(no)f(less.)i(So)g(let')-5
b(s)21 b(look)e(at)i(the)f(possible)g(causes)g(of)g(f)o(ailure)g(in)g
(a)396 3082 y(distrib)n(uted)g(\330MQ)g(application,)e(in)j(roughly)d
(descending)g(order)h(of)h(probability:)-2 3100 y
SDict begin H.S end
 -2
3100 a -2 3100 a
SDict begin 13 H.A end
 -2 3100 a -2 3100 a
SDict begin [/View [/XYZ H.V]/Dest (0:1971) cvn /DEST pdfmark end
 -2 3100 a -2 3110
a
SDict begin H.S end
 -2 3110 a -2 3110 a
SDict begin 13 H.A end
 -2 3110 a -2 3110 a
SDict begin [/View [/XYZ H.V]/Dest (0:1972) cvn /DEST pdfmark end
 -2 3110 a Black
396 3252 a Fe(\225)p Black 479 3252 a
SDict begin H.S end
 479 3252 a 479
3252 a
SDict begin 13 H.A end
 479 3252 a 479 3252 a
SDict begin [/View [/XYZ H.V]/Dest (0:1973) cvn /DEST pdfmark end
 479 3252 a Fj(Application)f(code)h(is)h
(the)f(w)o(orst)g(of)n(fender)-5 b(.)18 b(It)j(can)f(crash)g(and)f(e)o
(xit,)h(freeze)g(and)f(stop)h(responding)e(to)j(input,)e(run)479
3360 y(too)h(slo)n(wly)g(for)g(its)h(input,)e(e)o(xhaust)g(all)i
(memory)-5 b(,)18 b(etc.)-2 3378 y
SDict begin H.S end
 -2 3378 a -2 3378
a
SDict begin 13 H.A end
 -2 3378 a -2 3378 a
SDict begin [/View [/XYZ H.V]/Dest (0:1974) cvn /DEST pdfmark end
 -2 3378 a Black 396 3510 a Fe(\225)p
Black 479 3510 a
SDict begin H.S end
 479 3510 a 479 3510 a
SDict begin 13 H.A end
 479 3510 a 479
3510 a
SDict begin [/View [/XYZ H.V]/Dest (0:1975) cvn /DEST pdfmark end
 479 3510 a Fj(System)j(code)e(-)h(lik)o(e)h(brok)o(ers)e(we)h
(write)h(using)e(\330MQ)i(-)f(can)g(die)g(for)g(the)g(same)h(reasons)e
(as)i(application)e(code.)479 3618 y(System)i(code)922
3618 y
SDict begin H.S end
 922 3618 a 922 3618 a
SDict begin 13 H.A end
 922 3618 a 922 3618 a
SDict begin [/View [/XYZ H.V]/Dest (0:1976) cvn /DEST pdfmark end
 922
3618 a Fi(should)g Fj(be)g(more)e(reliable)h(than)f(application)g(code)
h(b)n(ut)g(it)h(can)f(still)h(crash)f(and)g(b)n(urn,)f(and)479
3726 y(especially)h(run)f(out)h(of)g(memory)f(if)h(it)h(tries)g(to)f
(queue)f(messages)h(for)g(slo)n(w)h(clients.)-2 3744
y
SDict begin H.S end
 -2 3744 a -2 3744 a
SDict begin 13 H.A end
 -2 3744 a -2 3744 a
SDict begin [/View [/XYZ H.V]/Dest (0:1977) cvn /DEST pdfmark end
 -2 3744 a Black
396 3875 a Fe(\225)p Black 479 3875 a
SDict begin H.S end
 479 3875 a 479
3875 a
SDict begin 13 H.A end
 479 3875 a 479 3875 a
SDict begin [/View [/XYZ H.V]/Dest (0:1978) cvn /DEST pdfmark end
 479 3875 a Fj(Message)g(queues)e(can)h(o)o
(v)o(er\003o)n(w)-5 b(,)18 b(typically)h(in)h(system)h(code)e(that)h
(has)h(learned)e(to)h(deal)g(brutally)f(with)i(slo)n(w)479
3983 y(clients.)g(When)f(a)g(queue)f(o)o(v)o(er\003o)n(ws,)g(it)h
(starts)i(to)e(discard)f(messages.)h(So)h(we)f(get)h("lost")f
(messages.)-2 4001 y
SDict begin H.S end
 -2 4001 a -2 4001 a
SDict begin 13 H.A end
 -2 4001 a -2
4001 a
SDict begin [/View [/XYZ H.V]/Dest (0:1979) cvn /DEST pdfmark end
 -2 4001 a Black 396 4133 a Fe(\225)p Black 479
4133 a
SDict begin H.S end
 479 4133 a 479 4133 a
SDict begin 13 H.A end
 479 4133 a 479 4133 a
SDict begin [/View [/XYZ H.V]/Dest (0:1980) cvn /DEST pdfmark end
 479
4133 a Fj(Netw)o(orks)g(can)g(f)o(ail)g(\(e.g.)f(wi\002)i(gets)f
(switched)g(of)n(f)f(or)h(goes)g(out)g(of)f(range\).)g(\330MQ)h(will)h
(automatically)d(reconnect)479 4240 y(in)j(such)f(cases)g(b)n(ut)h(in)f
(the)g(meantime,)f(messages)i(may)e(get)h(lost.)-2 4258
y
SDict begin H.S end
 -2 4258 a -2 4258 a
SDict begin 13 H.A end
 -2 4258 a -2 4258 a
SDict begin [/View [/XYZ H.V]/Dest (0:1981) cvn /DEST pdfmark end
 -2 4258 a Black
396 4390 a Fe(\225)p Black 479 4390 a
SDict begin H.S end
 479 4390 a 479
4390 a
SDict begin 13 H.A end
 479 4390 a 479 4390 a
SDict begin [/View [/XYZ H.V]/Dest (0:1982) cvn /DEST pdfmark end
 479 4390 a Fj(Hardw)o(are)f(can)h(f)o(ail)
h(and)f(tak)o(e)g(with)g(it)h(all)g(the)f(processes)g(running)e(on)i
(that)g(box.)-2 4408 y
SDict begin H.S end
 -2 4408 a -2 4408 a
SDict begin 13 H.A end
 -2 4408 a
-2 4408 a
SDict begin [/View [/XYZ H.V]/Dest (0:1983) cvn /DEST pdfmark end
 -2 4408 a Black 396 4539 a Fe(\225)p Black
479 4539 a
SDict begin H.S end
 479 4539 a 479 4539 a
SDict begin 13 H.A end
 479 4539 a 479 4539
a
SDict begin [/View [/XYZ H.V]/Dest (0:1984) cvn /DEST pdfmark end
 479 4539 a Fj(Netw)o(orks)g(can)g(f)o(ail)h(in)f(e)o(xotic)f(w)o
(ays,)i(e.g.)e(some)h(ports)g(on)g(a)g(switch)h(may)f(die)g(and)g
(those)g(parts)g(of)g(the)g(netw)o(ork)479 4647 y(become)f
(inaccessible.)-2 4648 y
SDict begin H.S end
 -2 4648 a -2 4648 a
SDict begin 13 H.A end
 -2 4648
a -2 4648 a
SDict begin [/View [/XYZ H.V]/Dest (0:1985) cvn /DEST pdfmark end
 -2 4648 a Black 396 4797 a Fe(\225)p Black
479 4797 a
SDict begin H.S end
 479 4797 a 479 4797 a
SDict begin 13 H.A end
 479 4797 a 479 4797
a
SDict begin [/View [/XYZ H.V]/Dest (0:1986) cvn /DEST pdfmark end
 479 4797 a Fj(Entire)h(data)g(centers)g(can)g(be)g(struck)g(by)f
(lightning,)g(earthquak)o(es,)f(\002re,)i(or)g(more)f(mundane)g(po)n
(wer)g(or)h(cooling)479 4905 y(f)o(ailures.)p Black 3756
5569 a Fi(147)p Black eop end
%%Page: 148 162
TeXDict begin 148 161 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.148) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2004) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:1987) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(T)g(o)21 b(mak)o(e)e(a)i(softw)o
(are)f(system)g(fully)g(reliable)f(against)2020 72 y
SDict begin H.S end

2020 72 a 2020 72 a
SDict begin 13 H.A end
 2020 72 a 2020 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:1988) cvn /DEST pdfmark end
 2020 72 a Fi(all)h
Fj(of)g(these)h(possible)f(f)o(ailures)g(is)h(an)f(enormously)e(dif)n
(\002cult)396 180 y(and)i(e)o(xpensi)n(v)o(e)e(job)i(and)g(goes)g(be)o
(yond)d(the)k(scope)e(of)h(this)h(modest)f(guide.)-2
364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:1989) cvn /DEST pdfmark end
 -2 364 a 396
454 a Fj(Since)g(the)h(\002rst)g(\002)n(v)o(e)f(cases)h(co)o(v)o(er)d
(99.9\045)h(of)h(real)h(w)o(orld)e(requirements)f(outside)i(lar)o(ge)f
(companies)g(\(according)f(to)i(a)396 562 y(highly)f(scienti\002c)h
(study)f(I)h(just)g(ran,)f(which)h(also)g(told)f(me)h(that)g(78\045)f
(of)h(statistics)h(are)f(made)f(up)g(on)g(the)h(spot\),)f(that')-5
b(s)396 670 y(what)20 b(we')o(ll)h(look)e(at.)i(If)f(you')l(re)e(a)j
(lar)o(ge)e(compan)o(y)f(with)i(mone)o(y)f(to)h(spend)f(on)h(the)g
(last)i(tw)o(o)e(cases,)h(contact)e(my)396 778 y(compan)o(y)f
(immediately!)h(There')-5 b(s)19 b(a)i(lar)o(ge)e(hole)h(behind)f(my)h
(beach)f(house)g(w)o(aiting)h(to)h(be)f(con)m(v)o(erted)d(into)j(an)396
886 y(e)o(x)o(ecuti)n(v)o(e)e(pool.)-2 914 y
SDict begin H.S end
 -2 914 a
-2 914 a
SDict begin 13 H.A end
 -2 914 a -2 914 a
SDict begin [/View [/XYZ H.V]/Dest (0:1990) cvn /DEST pdfmark end
 -2 914 a 360 x Fh(4.2.)39
b(Designing)e(Reliability)1690 1274 y
SDict begin H.S end
 1690 1274 a 1690
1274 a
SDict begin 22.464 H.A end
 1690 1274 a 1690 1274 a
SDict begin [/View [/XYZ H.V]/Dest (9.41.1) cvn /DEST pdfmark end
 1690 1274 a -2 1472 a
SDict begin H.S end

-2 1472 a -2 1472 a
SDict begin 13 H.A end
 -2 1472 a -2 1472 a
SDict begin [/View [/XYZ H.V]/Dest (0:1992) cvn /DEST pdfmark end
 -2 1472 a 396
1548 a Fj(So)21 b(to)f(mak)o(e)g(things)g(brutally)f(simple,)g
(reliability)h(is)h("k)o(eeping)e(things)h(w)o(orking)e(properly)g
(when)i(code)f(freezes)h(or)396 1655 y(crashes",)g(a)h(situation)e(we')
o(ll)i(shorten)e(to)h("dies".)g(Ho)n(we)n(v)o(er)f(the)h(things)g(we)h
(w)o(ant)f(to)g(k)o(eep)g(w)o(orking)f(properly)f(are)396
1763 y(more)i(comple)o(x)e(than)i(just)h(messages.)f(W)-7
b(e)21 b(need)e(to)i(tak)o(e)f(each)g(core)f(\330MQ)i(messaging)e
(pattern)h(and)f(see)i(ho)n(w)f(to)396 1871 y(mak)o(e)g(it)h(w)o(ork)e
(\(if)i(we)f(can\))g(e)n(v)o(en)f(when)h(code)f(dies.)-2
2052 y
SDict begin H.S end
 -2 2052 a -2 2052 a
SDict begin 13 H.A end
 -2 2052 a -2 2052 a
SDict begin [/View [/XYZ H.V]/Dest (0:1993) cvn /DEST pdfmark end
 -2 2052
a 396 2145 a Fj(Let')-5 b(s)21 b(tak)o(e)f(them)g(one)g(by)g(one:)-2
2163 y
SDict begin H.S end
 -2 2163 a -2 2163 a
SDict begin 13 H.A end
 -2 2163 a -2 2163 a
SDict begin [/View [/XYZ H.V]/Dest (0:1994) cvn /DEST pdfmark end
 -2 2163
a -2 2173 a
SDict begin H.S end
 -2 2173 a -2 2173 a
SDict begin 13 H.A end
 -2 2173 a -2 2173 a
SDict begin [/View [/XYZ H.V]/Dest (0:1995) cvn /DEST pdfmark end
 -2
2173 a Black 396 2316 a Fe(\225)p Black 479 2316 a
SDict begin H.S end
 479
2316 a 479 2316 a
SDict begin 13 H.A end
 479 2316 a 479 2316 a
SDict begin [/View [/XYZ H.V]/Dest (0:1996) cvn /DEST pdfmark end
 479 2316 a Fj(Request-reply:)f
(if)h(the)h(serv)o(er)e(dies)h(\(while)g(processing)f(a)i(request\),)e
(the)h(client)g(can)g(\002gure)g(that)g(out)g(since)g(it)479
2423 y(w)o(on')o(t)f(get)i(an)f(answer)g(back.)f(Then)g(it)i(can)f(gi)n
(v)o(e)g(up)f(in)i(a)f(huf)n(f,)f(w)o(ait)i(and)f(try)g(again)f(later)m
(,)g(\002nd)h(another)f(serv)o(er)m(,)479 2531 y(etc.)i(As)g(for)e(the)
h(client)h(dying,)d(we)j(can)f(brush)f(that)h(of)n(f)g(as)h("someone)d
(else')-5 b(s)22 b(problem")c(for)i(no)n(w)-5 b(.)-2
2549 y
SDict begin H.S end
 -2 2549 a -2 2549 a
SDict begin 13 H.A end
 -2 2549 a -2 2549 a
SDict begin [/View [/XYZ H.V]/Dest (0:1997) cvn /DEST pdfmark end
 -2 2549
a Black 396 2681 a Fe(\225)p Black 479 2681 a
SDict begin H.S end
 479 2681
a 479 2681 a
SDict begin 13 H.A end
 479 2681 a 479 2681 a
SDict begin [/View [/XYZ H.V]/Dest (0:1998) cvn /DEST pdfmark end
 479 2681 a Fj(Publish-subscribe:)18
b(if)j(the)f(client)g(dies)h(\(ha)n(ving)e(gotten)g(some)h(data\),)f
(the)i(serv)o(er)e(doesn')o(t)g(kno)n(w)g(about)g(it.)479
2789 y(Pubsub)h(doesn')o(t)e(send)i(an)o(y)g(information)d(back)j(from)
f(client)h(to)h(serv)o(er)-5 b(.)19 b(But)i(the)f(client)g(can)g
(contact)g(the)g(serv)o(er)479 2897 y(out-of-band,)d(e.g.)i(via)i
(request-reply)-5 b(,)17 b(and)i(ask,)i("please)f(resend)f(e)n(v)o
(erything)f(I)i(missed".)g(As)h(for)f(the)g(serv)o(er)479
3005 y(dying,)f(that')-5 b(s)21 b(out)e(of)h(scope)g(for)g(here.)f
(Subscribers)g(can)h(also)h(self-v)o(erify)d(that)i(the)o(y')l(re)f
(not)h(running)e(too)i(slo)n(wly)-5 b(,)479 3113 y(and)20
b(tak)o(e)g(action)g(\(e.g.)f(w)o(arn)h(the)g(operator)m(,)e(and)i
(die\))g(if)g(the)o(y)f(are.)-2 3131 y
SDict begin H.S end
 -2 3131 a -2 3131
a
SDict begin 13 H.A end
 -2 3131 a -2 3131 a
SDict begin [/View [/XYZ H.V]/Dest (0:1999) cvn /DEST pdfmark end
 -2 3131 a Black 396 3262 a Fe(\225)p
Black 479 3262 a
SDict begin H.S end
 479 3262 a 479 3262 a
SDict begin 13 H.A end
 479 3262 a 479
3262 a
SDict begin [/View [/XYZ H.V]/Dest (0:2000) cvn /DEST pdfmark end
 479 3262 a Fj(Pipeline:)h(if)h(a)f(w)o(ork)o(er)g(dies)g
(\(while)g(w)o(orking\),)e(the)i(v)o(entilator)f(doesn')o(t)g(kno)n(w)g
(about)g(it.)i(Pipelines,)f(lik)o(e)g(pubsub,)479 3370
y(and)g(the)g(grinding)e(gears)i(of)g(time,)g(only)g(w)o(ork)f(in)h
(one)g(direction.)f(But)h(the)h(do)n(wnstream)d(collector)h(can)h
(detect)479 3478 y(that)h(one)e(task)i(didn')o(t)d(get)i(done,)f(and)h
(send)g(a)h(message)f(back)f(to)h(the)h(v)o(entilator)d(saying,)i("he)o
(y)-5 b(,)18 b(resend)i(task)g(324!")479 3586 y(If)g(the)h(v)o
(entilator)d(or)i(collector)f(dies,)i(then)e(whate)n(v)o(er)g(upstream)
g(client)h(originally)f(sent)i(the)f(w)o(ork)f(batch)h(can)g(get)479
3694 y(tired)g(of)g(w)o(aiting)g(and)g(resend)f(the)h(whole)g(lot.)g
(It')-5 b(s)21 b(not)f(ele)o(gant)f(b)n(ut)h(system)g(code)g(should)f
(really)h(not)g(die)g(often)479 3802 y(enough)e(to)j(matter)-5
b(.)-2 3986 y
SDict begin H.S end
 -2 3986 a -2 3986 a
SDict begin 13 H.A end
 -2 3986 a -2 3986 a
SDict begin [/View [/XYZ H.V]/Dest (0:2001) cvn /DEST pdfmark end

-2 3986 a 396 4076 a Fj(In)20 b(this)h(chapter)e(we')o(ll)i(focus)e(on)
h(just)h(on)e(request-reply)-5 b(,)18 b(which)h(is)i(the)f(lo)n
(w-hanging)e(Durian)h(fruit)h(of)g(reliable)396 4184
y(messaging.)f(W)-7 b(e')o(ll)22 b(co)o(v)o(er)c(reliable)i(pub-sub)e
(and)i(pipeline)f(in)h(later)h(follo)n(wing)d(chapters.)-2
4368 y
SDict begin H.S end
 -2 4368 a -2 4368 a
SDict begin 13 H.A end
 -2 4368 a -2 4368 a
SDict begin [/View [/XYZ H.V]/Dest (0:2002) cvn /DEST pdfmark end
 -2 4368
a 396 4457 a Fj(The)i(basic)g(request-reply)e(pattern)i(\(a)g(REQ)h
(client)f(sock)o(et)g(doing)f(a)h(blocking)f(send/recv)g(to)h(a)h(REP)g
(serv)o(er)e(sock)o(et\))396 4565 y(scores)h(lo)n(w)h(on)e(handling)g
(the)h(most)g(common)f(types)h(of)g(f)o(ailure.)f(If)h(the)g(serv)o(er)
f(crashes)i(while)f(processing)f(the)396 4673 y(request,)f(the)h
(client)g(just)h(hangs)e(fore)n(v)o(er)-5 b(.)17 b(If)h(the)h(netw)o
(ork)f(loses)i(the)e(request)h(or)f(the)h(reply)-5 b(,)18
b(the)h(client)f(hangs)h(fore)n(v)o(er)-5 b(.)-2 4857
y
SDict begin H.S end
 -2 4857 a -2 4857 a
SDict begin 13 H.A end
 -2 4857 a -2 4857 a
SDict begin [/View [/XYZ H.V]/Dest (0:2003) cvn /DEST pdfmark end
 -2 4857 a 396
4947 a Fj(It)21 b(is)g(much)e(better)h(than)g(TCP)-9
b(,)20 b(thanks)g(to)g(\330MQ')-5 b(s)21 b(ability)f(to)g(reconnect)f
(peers)h(silently)-5 b(,)19 b(to)i(load-balance)396 5055
y(messages,)f(and)g(so)h(on.)e(But)i(it')-5 b(s)21 b(still)g(not)f
(good)f(enough)f(for)i(real)g(w)o(ork.)f(The)h(only)g(case)g(where)g
(you)f(can)h(really)p Black 3759 5569 a Fi(148)p Black
eop end
%%Page: 149 163
TeXDict begin 149 162 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.149) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2030) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 396 72 a Fj(trust)21 b(the)f(basic)g
(request-reply)e(pattern)h(is)i(between)f(tw)o(o)g(threads)g(in)g(the)g
(same)h(process)e(where)h(there')-5 b(s)20 b(no)g(netw)o(ork)396
180 y(or)g(separate)g(serv)o(er)f(process)h(to)g(die.)396
454 y(Ho)n(we)n(v)o(er)m(,)e(with)j(a)f(little)h(e)o(xtra)f(w)o(ork)f
(this)i(humble)e(pattern)g(becomes)g(a)i(good)e(basis)i(for)e(real)h(w)
o(ork)g(across)g(a)396 562 y(distrib)n(uted)g(netw)o(ork,)e(and)i(we)g
(get)h(a)f(set)h(of)f(reliable)g(request-reply)e(\(RRR\))j(patterns)e
(I)i(lik)o(e)f(to)h(call)f(the)h("Pirate")396 670 y(patterns)f(\(you')o
(ll)f(get)h(the)g(jok)o(e,)g(e)n(v)o(entually\).)-2 854
y
SDict begin H.S end
 -2 854 a -2 854 a
SDict begin 13 H.A end
 -2 854 a -2 854 a
SDict begin [/View [/XYZ H.V]/Dest (0:2005) cvn /DEST pdfmark end
 -2 854 a 396 944
a Fj(There)g(are)g(in)g(my)g(e)o(xperience,)e(roughly)g(three)i(w)o
(ays)g(to)g(connect)f(clients)i(to)f(serv)o(ers.)g(Each)f(needs)h(a)h
(speci\002c)396 1052 y(approach)d(to)j(reliability:)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:2006) cvn /DEST pdfmark end
 -2 1070
a -2 1080 a
SDict begin H.S end
 -2 1080 a -2 1080 a
SDict begin 13 H.A end
 -2 1080 a -2 1080 a
SDict begin [/View [/XYZ H.V]/Dest (0:2007) cvn /DEST pdfmark end
 -2
1080 a Black 396 1222 a Fe(\225)p Black 479 1222 a
SDict begin H.S end
 479
1222 a 479 1222 a
SDict begin 13 H.A end
 479 1222 a 479 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:2008) cvn /DEST pdfmark end
 479 1222 a Fj(Multiple)f
(clients)h(talking)e(directly)g(to)i(a)f(single)g(serv)o(er)-5
b(.)20 b(Use)h(case:)f(single)h(well-kno)n(wn)d(serv)o(er)h(that)h
(clients)h(need)479 1330 y(to)g(talk)f(to.)g(T)-7 b(ypes)20
b(of)g(f)o(ailure)g(we)g(aim)g(to)h(handle:)e(serv)o(er)g(crashes)h
(and)g(restarts,)g(netw)o(ork)f(disconnects.)-2 1348
y
SDict begin H.S end
 -2 1348 a -2 1348 a
SDict begin 13 H.A end
 -2 1348 a -2 1348 a
SDict begin [/View [/XYZ H.V]/Dest (0:2009) cvn /DEST pdfmark end
 -2 1348 a Black
396 1480 a Fe(\225)p Black 479 1480 a
SDict begin H.S end
 479 1480 a 479
1480 a
SDict begin 13 H.A end
 479 1480 a 479 1480 a
SDict begin [/View [/XYZ H.V]/Dest (0:2010) cvn /DEST pdfmark end
 479 1480 a Fj(Multiple)h(clients)h
(talking)e(to)h(a)h(single)f(queue)f(de)n(vice)g(that)i(distrib)n(utes)
f(w)o(ork)f(to)i(multiple)e(serv)o(ers.)h(Use)g(case:)479
1588 y(w)o(orkload)f(distrib)n(ution)g(to)h(w)o(ork)o(ers.)f(T)-7
b(ypes)20 b(of)g(f)o(ailure)g(we)g(aim)h(to)f(handle:)f(w)o(ork)o(er)g
(crashes)i(and)e(restarts,)479 1696 y(w)o(ork)o(er)g(b)n(usy)h
(looping,)f(w)o(ork)o(er)g(o)o(v)o(erload,)e(queue)i(crashes)h(and)g
(restarts,)g(netw)o(ork)f(disconnects.)-2 1714 y
SDict begin H.S end
 -2 1714
a -2 1714 a
SDict begin 13 H.A end
 -2 1714 a -2 1714 a
SDict begin [/View [/XYZ H.V]/Dest (0:2011) cvn /DEST pdfmark end
 -2 1714 a Black 396 1845
a Fe(\225)p Black 479 1845 a
SDict begin H.S end
 479 1845 a 479 1845 a
SDict begin 13 H.A end
 479
1845 a 479 1845 a
SDict begin [/View [/XYZ H.V]/Dest (0:2012) cvn /DEST pdfmark end
 479 1845 a Fj(Multiple)h(clients)h(talking)e(to)h
(multiple)g(serv)o(ers)f(with)i(no)f(intermediary)e(de)n(vices.)h(Use)i
(case:)g(distrib)n(uted)479 1953 y(services)f(such)g(as)h(name)f
(resolution.)e(T)-7 b(ypes)20 b(of)g(f)o(ailure)g(we)h(aim)f(to)g
(handle:)f(service)h(crashes)g(and)g(restarts,)479 2061
y(service)g(b)n(usy)g(looping,)e(service)i(o)o(v)o(erload,)e(netw)o
(ork)h(disconnects.)-2 2245 y
SDict begin H.S end
 -2 2245 a -2 2245 a
SDict begin 13 H.A end
 -2
2245 a -2 2245 a
SDict begin [/View [/XYZ H.V]/Dest (0:2013) cvn /DEST pdfmark end
 -2 2245 a 396 2335 a Fj(Each)h(of)g(these)g(has)h
(their)f(trade-of)n(fs)e(and)i(often)f(you')o(ll)g(mix)h(them.)g(W)-7
b(e')o(ll)21 b(look)e(at)i(all)g(three)f(of)g(these)g(in)g(detail.)-2
2363 y
SDict begin H.S end
 -2 2363 a -2 2363 a
SDict begin 13 H.A end
 -2 2363 a -2 2363 a
SDict begin [/View [/XYZ H.V]/Dest (0:2014) cvn /DEST pdfmark end
 -2 2363
a 359 x Fh(4.3.)39 b(Client-side)e(Reliability)h(\(Lazy)g(Pirate)h(P)l
(attern\))3153 2722 y
SDict begin H.S end
 3153 2722 a 3153 2722 a
SDict begin 22.464 H.A end
 3153 2722
a 3153 2722 a
SDict begin [/View [/XYZ H.V]/Dest (9.42.1) cvn /DEST pdfmark end
 3153 2722 a -2 2918 a
SDict begin H.S end
 -2 2918 a -2 2918
a
SDict begin 13 H.A end
 -2 2918 a -2 2918 a
SDict begin [/View [/XYZ H.V]/Dest (0:2016) cvn /DEST pdfmark end
 -2 2918 a 396 2996 a Fj(W)-7 b(e)22
b(can)e(get)g(v)o(ery)f(simple)h(reliable)g(request-reply)e(with)i
(only)f(some)h(changes)f(in)i(the)f(client.)g(W)-7 b(e)21
b(call)g(this)g(the)f(Lazy)396 3104 y(Pirate)h(pattern\()p
0 TeXcolorgray 871 3104 a
SDict begin H.S end
 871 3104 a Fj(Figure)c(4-1)1218
3104 y
SDict begin 13 H.L end
 1218 3104 a 1218 3104 a
SDict begin [/Subtype /Link/Dest (0:figure-53) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1218 3104 a Black -1 w
Fj(\).)j(Rather)g(than)g(doing)f(a)i(blocking)d(recei)n(v)o(e,)h(we:)-2
3122 y
SDict begin H.S end
 -2 3122 a -2 3122 a
SDict begin 13 H.A end
 -2 3122 a -2 3122 a
SDict begin [/View [/XYZ H.V]/Dest (0:2018) cvn /DEST pdfmark end
 -2 3122
a -2 3132 a
SDict begin H.S end
 -2 3132 a -2 3132 a
SDict begin 13 H.A end
 -2 3132 a -2 3132 a
SDict begin [/View [/XYZ H.V]/Dest (0:2019) cvn /DEST pdfmark end
 -2
3132 a Black 396 3274 a Fe(\225)p Black 479 3274 a
SDict begin H.S end
 479
3274 a 479 3274 a
SDict begin 13 H.A end
 479 3274 a 479 3274 a
SDict begin [/View [/XYZ H.V]/Dest (0:2020) cvn /DEST pdfmark end
 479 3274 a Fj(Poll)i(the)f(REQ)
h(sock)o(et)f(and)g(only)f(recei)n(v)o(e)g(from)g(it)i(when)f(it')-5
b(s)21 b(sure)f(a)h(reply)e(has)h(arri)n(v)o(ed.)-2 3292
y
SDict begin H.S end
 -2 3292 a -2 3292 a
SDict begin 13 H.A end
 -2 3292 a -2 3292 a
SDict begin [/View [/XYZ H.V]/Dest (0:2021) cvn /DEST pdfmark end
 -2 3292 a Black
396 3424 a Fe(\225)p Black 479 3424 a
SDict begin H.S end
 479 3424 a 479
3424 a
SDict begin 13 H.A end
 479 3424 a 479 3424 a
SDict begin [/View [/XYZ H.V]/Dest (0:2022) cvn /DEST pdfmark end
 479 3424 a Fj(Resend)g(a)h(request)f(se)n
(v)o(eral)f(times,)i(if)f(no)g(reply)f(arri)n(v)o(ed)g(within)h(a)g
(timeout)g(period.)-2 3442 y
SDict begin H.S end
 -2 3442 a -2 3442 a
SDict begin 13 H.A end
 -2 3442
a -2 3442 a
SDict begin [/View [/XYZ H.V]/Dest (0:2023) cvn /DEST pdfmark end
 -2 3442 a Black 396 3573 a Fe(\225)p Black
479 3573 a
SDict begin H.S end
 479 3573 a 479 3573 a
SDict begin 13 H.A end
 479 3573 a 479 3573
a
SDict begin [/View [/XYZ H.V]/Dest (0:2024) cvn /DEST pdfmark end
 479 3573 a Fj(Abandon)e(the)j(transaction)e(if)h(after)g(se)n(v)o
(eral)g(requests,)f(there)h(is)h(still)g(no)f(reply)-5
b(.)-2 3591 y
SDict begin H.S end
 -2 3591 a -2 3591 a
SDict begin 13 H.A end
 -2 3591 a -2 3591 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-53) cvn /DEST pdfmark
end

-2 3591 a Black 3759 5569 a Fi(149)p Black eop end
%%Page: 150 164
TeXDict begin 150 163 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.150) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-1.)f(The)i(Lazy)f
(Pirate)g(P)o(atter)o(n)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2
172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2027) cvn /DEST pdfmark end
 -2 172 a 396 2514 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2514 a @beginspecial
0 @llx -276 @lly 392 @urx 0 @ury 3920 @rwi @setspecial
%%BeginDocument: images/fig53.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -276 392 0
%%HiResBoundingBox: 0.0 -276.0 392.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -32.40024185180664 moveto
22.400239944458008 -54.40024185180664 lineto
118.40023803710938 -54.40024185180664 lineto
118.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -57.40024185180664 moveto
22.400239944458008 -78.40023803710938 lineto
118.40023803710938 -78.40023803710938 lineto
118.40023803710938 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -81.40023803710938 moveto
22.400239944458008 -98.40023803710938 lineto
22.400239944458008 -102.40023803710938 23.73357327779134 -104.40023803710938 26.400239944458008 -104.40023803710938 curveto
114.40023803710938 -104.40023803710938 lineto
114.40023803710938 -104.40023803710938 lineto
117.06690470377605 -104.40023803710938 118.40023803710938 -102.40023803710938 118.40023803710938 -98.40023803710938 curveto
118.40023803710938 -82.00023651123047 lineto
118.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -32.40024185180664 moveto
150.40023803710938 -54.40024185180664 lineto
246.40023803710938 -54.40024185180664 lineto
246.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -57.40024185180664 moveto
150.40023803710938 -78.40023803710938 lineto
246.40023803710938 -78.40023803710938 lineto
246.40023803710938 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -81.40023803710938 moveto
150.40023803710938 -98.40023803710938 lineto
150.40023803710938 -102.40023803710938 151.73357137044272 -104.40023803710938 154.40023803710938 -104.40023803710938 curveto
242.40023803710938 -104.40023803710938 lineto
242.40023803710938 -104.40023803710938 lineto
245.06690470377603 -104.40023803710938 246.40023803710938 -102.40023803710938 246.40023803710938 -98.40023803710938 curveto
246.40023803710938 -82.00023651123047 lineto
246.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -32.40024185180664 moveto
278.4002380371094 -54.40024185180664 lineto
374.4002380371094 -54.40024185180664 lineto
374.4002380371094 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -57.40024185180664 moveto
278.4002380371094 -78.40023803710938 lineto
374.4002380371094 -78.40023803710938 lineto
374.4002380371094 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -81.40023803710938 moveto
278.4002380371094 -98.40023803710938 lineto
278.4002380371094 -102.40023803710938 279.7335713704427 -104.40023803710938 282.4002380371094 -104.40023803710938 curveto
370.4002380371094 -104.40023803710938 lineto
370.4002380371094 -104.40023803710938 lineto
373.06690470377606 -104.40023803710938 374.4002380371094 -102.40023803710938 374.4002380371094 -98.40023803710938 curveto
374.4002380371094 -82.00023651123047 lineto
374.4002380371094 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
146.40023803710938 -176.40023803710938 moveto
143.73357137044272 -176.40023803710938 142.40023803710938 -178.40023803710938 142.40023803710938 -182.40023803710938 curveto
142.40023803710938 -198.40023803710938 lineto
254.40023803710938 -198.40023803710938 lineto
254.40023803710938 -182.40023803710938 lineto
254.40023803710938 -178.40023803710938 253.06690470377603 -176.40023803710938 250.40023803710938 -176.40023803710938 curveto
146.40023803710938 -176.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -201.40023803710938 moveto
142.40023803710938 -248.40023803710938 lineto
254.40023803710938 -248.40023803710938 lineto
254.40023803710938 -201.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -30.0 moveto
20.0 -52.0 lineto
116.0 -52.0 lineto
116.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -30.0 moveto
20.0 -52.0 lineto
116.0 -52.0 lineto
116.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -55.0 moveto
20.0 -76.0 lineto
116.0 -76.0 lineto
116.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -55.0 moveto
20.0 -76.0 lineto
116.0 -76.0 lineto
116.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -79.0 moveto
20.0 -96.0 lineto
20.0 -100.0 21.333333333333332 -102.0 24.0 -102.0 curveto
112.0 -102.0 lineto
112.0 -102.0 lineto
114.66666666666667 -102.0 116.0 -100.0 116.0 -96.0 curveto
116.0 -79.5999984741211 lineto
116.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -79.0 moveto
20.0 -96.0 lineto
20.0 -100.0 21.333333333333332 -102.0 24.0 -102.0 curveto
112.0 -102.0 lineto
112.0 -102.0 lineto
114.66666666666667 -102.0 116.0 -100.0 116.0 -96.0 curveto
116.0 -79.5999984741211 lineto
116.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -52.0 lineto
244.0 -52.0 lineto
244.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -52.0 lineto
244.0 -52.0 lineto
244.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -55.0 moveto
148.0 -76.0 lineto
244.0 -76.0 lineto
244.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -55.0 moveto
148.0 -76.0 lineto
244.0 -76.0 lineto
244.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -79.0 moveto
148.0 -96.0 lineto
148.0 -100.0 149.33333333333334 -102.0 152.0 -102.0 curveto
240.0 -102.0 lineto
240.0 -102.0 lineto
242.66666666666666 -102.0 244.0 -100.0 244.0 -96.0 curveto
244.0 -79.5999984741211 lineto
244.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -79.0 moveto
148.0 -96.0 lineto
148.0 -100.0 149.33333333333334 -102.0 152.0 -102.0 curveto
240.0 -102.0 lineto
240.0 -102.0 lineto
242.66666666666666 -102.0 244.0 -100.0 244.0 -96.0 curveto
244.0 -79.5999984741211 lineto
244.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -52.0 lineto
372.0 -52.0 lineto
372.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -52.0 lineto
372.0 -52.0 lineto
372.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -55.0 moveto
276.0 -76.0 lineto
372.0 -76.0 lineto
372.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -55.0 moveto
276.0 -76.0 lineto
372.0 -76.0 lineto
372.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -79.0 moveto
276.0 -96.0 lineto
276.0 -100.0 277.3333333333333 -102.0 280.0 -102.0 curveto
368.0 -102.0 lineto
368.0 -102.0 lineto
370.6666666666667 -102.0 372.0 -100.0 372.0 -96.0 curveto
372.0 -79.5999984741211 lineto
372.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -79.0 moveto
276.0 -96.0 lineto
276.0 -100.0 277.3333333333333 -102.0 280.0 -102.0 curveto
368.0 -102.0 lineto
368.0 -102.0 lineto
370.6666666666667 -102.0 372.0 -100.0 372.0 -96.0 curveto
372.0 -79.5999984741211 lineto
372.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
144.0 -174.0 moveto
141.33333333333334 -174.0 140.0 -176.0 140.0 -180.0 curveto
140.0 -196.0 lineto
252.0 -196.0 lineto
252.0 -180.0 lineto
252.0 -176.0 250.66666666666666 -174.0 248.0 -174.0 curveto
144.0 -174.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
144.0 -174.0 moveto
141.33333333333334 -174.0 140.0 -176.0 140.0 -180.0 curveto
140.0 -196.0 lineto
252.0 -196.0 lineto
252.0 -180.0 lineto
252.0 -176.0 250.66666666666666 -174.0 248.0 -174.0 curveto
144.0 -174.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -199.0 moveto
140.0 -246.0 lineto
252.0 -246.0 lineto
252.0 -199.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -199.0 moveto
140.0 -246.0 lineto
252.0 -246.0 lineto
252.0 -199.0 lineto
closepath
stroke
newpath
68.0 -108.0 moveto
64.0 -120.0 lineto
72.0 -120.0 lineto
closepath
fill
newpath
196.0 -108.0 moveto
192.0 -120.0 lineto
200.0 -120.0 lineto
closepath
fill
newpath
324.0 -108.0 moveto
320.0 -120.0 lineto
328.0 -120.0 lineto
closepath
fill
newpath
192.0 -156.0 moveto
196.0 -168.0 lineto
200.0 -156.0 lineto
closepath
fill
newpath
68.0 -114.0 moveto
68.0 -132.0 lineto
68.0 -136.0 69.33333333333333 -138.0 72.0 -138.0 curveto
196.0 -138.0 lineto
196.0 -138.0 lineto
stroke
newpath
196.0 -114.0 moveto
196.0 -138.0 lineto
stroke
newpath
324.0 -114.0 moveto
324.0 -132.0 lineto
324.0 -136.0 322.6666666666667 -138.0 320.0 -138.0 curveto
196.0 -138.0 lineto
196.0 -138.0 lineto
stroke
newpath
196.0 -162.0 moveto
196.0 -138.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
43.0 -47.0 moveto
(Client) show
171.0 -47.0 moveto
(Client) show
299.0 -47.0 moveto
(Client) show
49.0 -71.0 moveto
(Retry) show
177.0 -71.0 moveto
(Retry) show
305.0 -71.0 moveto
(Retry) show
57.0 -94.0 moveto
(REQ) show
185.0 -94.0 moveto
(REQ) show
313.0 -94.0 moveto
(REQ) show
186.0 -190.0 moveto
(REP) show
177.0 -227.0 moveto
(Server) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2514 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2514 a 274 x Fj(If)g(you)f(try)h(to)h(use)f
(a)g(REQ)h(sock)o(et)f(in)g(an)o(ything)e(than)i(a)h(strict)f
(send-recv)f(f)o(ashion,)g(you')o(ll)g(get)h(an)g(error)f
(\(technically)-5 b(,)396 2896 y(the)20 b(REQ)h(sock)o(et)f(implements)
g(a)g(small)h(\002nite-state)f(machine)f(to)h(enforce)f(the)h
(send-recv)f(ping-pong,)e(and)i(so)i(the)396 3004 y(error)e(code)h(is)h
(called)f("EFSM"\).)g(This)g(is)h(slightly)f(anno)o(ying)e(when)i(we)g
(w)o(ant)h(to)f(use)g(REQ)h(in)f(a)h(pirate)f(pattern,)396
3112 y(because)g(we)g(may)g(send)g(se)n(v)o(eral)g(requests)f(before)g
(getting)h(a)g(reply)-5 b(.)19 b(The)h(pretty)f(good)g(brute-force)f
(solution)h(is)i(to)396 3220 y(close)g(and)e(reopen)g(the)h(REQ)h(sock)
o(et)f(after)g(an)g(error:)-2 3238 y
SDict begin H.S end
 -2 3238 a -2 3238
a
SDict begin 13 H.A end
 -2 3238 a -2 3238 a
SDict begin [/View [/XYZ H.V]/Dest (0:lpclient-php) cvn /DEST pdfmark
end
 -2 3238 a 396 3421 a Fk(Example)h(4-1.)e(Lazy)h
(Pirate)f(client)i(\(lpclient.php\))-2 3521 y
SDict begin H.S end
 -2 3521
a -2 3521 a
SDict begin 11.7 H.A end
 -2 3521 a -2 3521 a
SDict begin [/View [/XYZ H.V]/Dest (0:2033) cvn /DEST pdfmark end
 -2 3521 a 396 3601 a
Fg(<?php)396 3698 y(/)441 3711 y(*)441 3808 y(*)531 3795
y(Lazy)44 b(Pirate)g(client)441 3905 y(*)531 3892 y(Use)g(zmq_poll)g
(to)g(do)h(a)f(safe)g(request-reply)441 4003 y(*)531
3990 y(To)g(run,)g(start)g(lpserver)g(and)g(then)g(randomly)g
(kill/restart)f(it)441 4100 y(*)441 4197 y(*)531 4184
y(@author)g(Ian)i(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
4294 y(*)486 4281 y(/)396 4475 y(define\("REQUEST_TIMEOUT",)d(2500\);)j
(//)89 b(msecs,)44 b(\(>)g(1000!\))396 4572 y
(define\("REQUEST_RETRIES",)d(3\);)j(//)90 b(Before)43
b(we)i(abandon)396 4767 y(/)441 4780 y(*)441 4877 y(*)531
4864 y(Helper)f(function)f(that)h(returns)g(a)h(new)f(configured)f
(socket)441 4974 y(*)531 4961 y(connected)g(to)i(the)f(Hello)g(World)g
(server)441 5071 y(*)486 5058 y(/)396 5155 y(function)g
(client_socket\(ZMQContext)d($context\))i({)p Black 3759
5569 a Fi(150)p Black eop end
%%Page: 151 165
TeXDict begin 151 164 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.151) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 72 a Fg(echo)44 b("I:)h(connecting)e(to)h
(server...",)f(PHP_EOL;)441 170 y($client)h(=)g(new)h
(ZMQSocket\($context,ZMQ::SOCKET_REQ\);)441 267 y
($client->connect\("tcp://localhost:5555"\))o(;)576 461
y(//)89 b(Configure)43 b(socket)h(to)h(not)f(wait)g(at)h(close)f(time)
441 558 y($client->setSockOpt\(ZMQ::SOCKOPT_LINGER,)38
b(0\);)576 655 y(return)43 b($client;)396 752 y(})396
947 y($context)h(=)g(new)h(ZMQContext\(\);)396 1044 y($client)f(=)h
(client_socket\($context\);)396 1238 y($sequence)f(=)g(0;)396
1335 y($retries_left)f(=)i(REQUEST_RETRIES;)396 1432
y($read)f(=)h($write)f(=)g(array\(\);)396 1627 y
(while\($retries_left\))e({)441 1724 y(//)89 b(We)45
b(send)f(a)h(request,)e(then)h(we)h(work)f(to)h(get)f(a)h(reply)441
1821 y($client->send\(++$sequence\);)441 2015 y($expect_reply)e(=)h
(true;)441 2112 y(while\($expect_reply\))e({)486 2209
y(//)89 b(Poll)44 b(socket)g(for)h(a)f(reply,)g(with)g(timeout)486
2307 y($poll)g(=)h(new)f(ZMQPoll\(\);)486 2404 y($poll->add\($client,)e
(ZMQ::POLL_IN\);)486 2501 y($events)i(=)g($poll->poll\($read,)e
($write,)i(REQUEST_TIMEOUT\);)486 2695 y(//)89 b(If)45
b(we)f(got)h(a)f(reply,)g(process)g(it)486 2792 y(if\($events)f(>)i
(0\))f({)531 2889 y(//)89 b(We)45 b(got)f(a)h(reply)f(from)g(the)g
(server,)g(must)g(match)g(sequence)531 2987 y($reply)g(=)g
($client->recv\(\);)531 3084 y(if\(intval\($reply\))e(==)i($sequence\))
f({)576 3181 y(printf)g(\("I:)i(server)e(replied)h(OK)h
(\(\045s\)\045s",)e($reply,)h(PHP_EOL\);)576 3278 y($retries_left)e(=)j
(REQUEST_RETRIES;)576 3375 y($expect_reply)d(=)j(false;)531
3472 y(})f(else)h({)576 3569 y(printf)e(\("E:)i(malformed)e(reply)h
(from)g(server:)g(\045s\045s",)g($reply,)f(PHP_EOL\);)531
3666 y(})486 3764 y(})i(else)f(if\(--$retries_left)e(==)i(0\))h({)531
3861 y(echo)f("E:)g(server)g(seems)g(to)h(be)f(offline,)g(abandoning",)
e(PHP_EOL;)531 3958 y(break;)486 4055 y(})j(else)f({)531
4152 y(echo)g("W:)g(no)h(response)e(from)h(server,)g(retrying...",)f
(PHP_EOL;)531 4249 y(//)89 b(Old)44 b(socket)g(will)g(be)h(confused;)e
(close)h(it)h(and)f(open)g(a)h(new)f(one)531 4346 y($client)f(=)i
(client_socket\($context\);)531 4444 y(//)89 b(Send)44
b(request)g(again,)g(on)g(new)h(socket)531 4541 y
($client->send\($sequence\);)486 4638 y(})441 4735 y(})-2
4909 y
SDict begin H.S end
 -2 4909 a -2 4909 a
SDict begin 13 H.A end
 -2 4909 a -2 4909 a
SDict begin [/View [/XYZ H.V]/Dest (0:2034) cvn /DEST pdfmark end
 -2 4909
a 396 5009 a Fj(Run)20 b(this)h(together)e(with)h(the)h(matching)d
(serv)o(er:)-2 5027 y
SDict begin H.S end
 -2 5027 a -2 5027 a
SDict begin 13 H.A end
 -2 5027 a -2
5027 a
SDict begin [/View [/XYZ H.V]/Dest (0:lpserver-php) cvn /DEST pdfmark
end
 -2 5027 a Black 3759 5569 a Fi(151)p Black eop
end
%%Page: 152 166
TeXDict begin 152 165 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.152) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Example)21 b(4-2.)e(Lazy)h(Pirate)f(ser)o
(v)o(er)i(\(lpser)o(v)o(er)-8 b(.php\))-2 172 y
SDict begin H.S end
 -2 172
a -2 172 a
SDict begin 11.7 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2037) cvn /DEST pdfmark end
 -2 172 a 396 253 a Fg(<?php)396
350 y(/)441 363 y(*)441 460 y(*)531 447 y(Lazy)44 b(Pirate)g(server)441
557 y(*)531 544 y(Binds)g(REQ)g(socket)g(to)g(tcp://)1697
557 y(*)1742 544 y(:5555)441 654 y(*)531 641 y(Like)g(hwserver)f
(except:)441 751 y(*)531 738 y(-)h(echoes)g(request)g(as-is)441
848 y(*)531 835 y(-)g(randomly)g(runs)g(slowly,)g(or)g(exits)g(to)h
(simulate)e(a)i(crash.)441 946 y(*)441 1043 y(*)531 1030
y(@author)e(Ian)i(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
1140 y(*)486 1127 y(/)396 1321 y($context)g(=)g(new)h(ZMQContext\(\);)
396 1418 y($server)f(=)h(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_REP\);)396 1515 y($server->bind\("tcp://)1341
1528 y(*)1386 1515 y(:5555"\);)396 1710 y($cycles)i(=)h(0;)396
1807 y(while\(true\))e({)441 1904 y($request)h(=)g($server->recv\(\);)
441 2001 y($cycles++;)441 2195 y(//)89 b(Simulate)44
b(various)g(problems,)f(after)h(a)h(few)f(cycles)441
2292 y(if\($cycles)f(>)i(3)g(&&)f(rand\(0,)g(3\))g(==)h(0\))f({)486
2390 y(echo)g("I:)g(simulating)g(a)g(crash",)g(PHP_EOL;)486
2487 y(break;)441 2584 y(})h(else)f(if\($cycles)f(>)i(3)f(&&)h
(rand\(0,)f(3\))g(==)h(0\))f({)486 2681 y(echo)g("I:)g(simulating)g
(CPU)g(overload",)f(PHP_EOL;)486 2778 y(sleep\(5\);)441
2875 y(})441 2972 y(printf)h(\("I:)g(normal)g(request)g
(\(\045s\)\045s",)f($request,)g(PHP_EOL\);)576 3070 y(sleep\(1\);)g(//)
h(Do)h(some)f(heavy)g(work)441 3167 y($server->send\($request\);)-2
3344 y
SDict begin H.S end
 -2 3344 a -2 3344 a
SDict begin 13 H.A end
 -2 3344 a -2 3344 a
SDict begin [/View [/XYZ H.V]/Dest (0:2038) cvn /DEST pdfmark end
 -2 3344
a 396 3441 a Fj(T)-7 b(o)21 b(run)e(this)i(testcase,)f(start)h(the)f
(client)h(and)e(the)h(serv)o(er)g(in)g(tw)o(o)h(console)e(windo)n(ws.)g
(The)h(serv)o(er)f(will)i(randomly)396 3549 y(misbeha)n(v)o(e)e(after)h
(a)h(fe)n(w)f(messages.)g(Y)-9 b(ou)19 b(can)h(check)g(the)g(client')-5
b(s)21 b(response.)e(Here)h(is)h(a)f(typical)g(output)f(from)g(the)396
3657 y(serv)o(er:)-2 3740 y
SDict begin H.S end
 -2 3740 a -2 3740 a
SDict begin 11.7 H.A end
 -2 3740
a -2 3740 a
SDict begin [/View [/XYZ H.V]/Dest (0:2039) cvn /DEST pdfmark end
 -2 3740 a 396 3837 a Fg(I:)45 b(normal)f(request)f(\(1\))
396 3934 y(I:)i(normal)f(request)f(\(2\))396 4031 y(I:)i(normal)f
(request)f(\(3\))396 4128 y(I:)i(simulating)e(CPU)h(overload)396
4225 y(I:)h(normal)f(request)f(\(4\))396 4322 y(I:)i(simulating)e(a)i
(crash)-2 4500 y
SDict begin H.S end
 -2 4500 a -2 4500 a
SDict begin 13 H.A end
 -2 4500 a -2 4500
a
SDict begin [/View [/XYZ H.V]/Dest (0:2040) cvn /DEST pdfmark end
 -2 4500 a 396 4596 a Fj(And)20 b(here)g(is)h(the)f(client')-5
b(s)21 b(response:)-2 4697 y
SDict begin H.S end
 -2 4697 a -2 4697 a
SDict begin 11.7 H.A end
 -2 4697
a -2 4697 a
SDict begin [/View [/XYZ H.V]/Dest (0:2041) cvn /DEST pdfmark end
 -2 4697 a 396 4777 a Fg(I:)45 b(connecting)e(to)h
(server...)396 4874 y(I:)h(server)f(replied)f(OK)i(\(1\))396
4971 y(I:)g(server)f(replied)f(OK)i(\(2\))396 5068 y(I:)g(server)f
(replied)f(OK)i(\(3\))396 5165 y(W:)g(no)f(response)g(from)g(server,)g
(retrying...)p Black 3759 5569 a Fi(152)p Black eop end
%%Page: 153 167
TeXDict begin 153 166 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.153) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fg(I:)45 b(connecting)e(to)h(server...)396
170 y(W:)h(no)f(response)g(from)g(server,)g(retrying...)396
267 y(I:)h(connecting)e(to)h(server...)396 364 y(E:)h(server)f(seems)g
(to)g(be)h(offline,)e(abandoning)-2 541 y
SDict begin H.S end
 -2 541 a -2
541 a
SDict begin 13 H.A end
 -2 541 a -2 541 a
SDict begin [/View [/XYZ H.V]/Dest (0:2042) cvn /DEST pdfmark end
 -2 541 a 396 638 a Fj(The)20
b(client)g(sequences)g(each)g(message,)f(and)h(checks)g(that)g(replies)
g(come)g(back)f(e)o(xactly)g(in)i(order:)e(that)h(no)g(requests)396
746 y(or)g(replies)g(are)g(lost,)h(and)f(no)f(replies)h(come)g(back)f
(more)h(than)g(once,)f(or)h(out)g(of)f(order)-5 b(.)20
b(Run)g(the)g(test)h(a)g(fe)n(w)f(times)396 854 y(until)g(you')l(re)f
(con)m(vinced)e(this)k(mechanism)e(actually)g(w)o(orks.)h(Y)-9
b(ou)20 b(don')o(t)e(need)i(sequence)f(numbers)f(in)j(reality)-5
b(,)19 b(the)o(y)396 962 y(just)i(help)f(us)g(trust)h(our)e(design.)-2
1146 y
SDict begin H.S end
 -2 1146 a -2 1146 a
SDict begin 13 H.A end
 -2 1146 a -2 1146 a
SDict begin [/View [/XYZ H.V]/Dest (0:2043) cvn /DEST pdfmark end
 -2 1146
a 396 1236 a Fj(The)h(client)g(uses)h(a)g(REQ)f(sock)o(et,)g(and)g
(does)g(the)g(brute-force)e(close/reopen)g(because)h(REQ)i(sock)o(ets)g
(impose)e(that)396 1344 y(strict)i(send/recei)n(v)o(e)d(c)o(ycle.)i(Y)
-9 b(ou)19 b(might)h(be)g(tempted)f(to)i(use)f(a)h(DEALER)f(instead,)g
(b)n(ut)g(it)h(w)o(ould)e(not)h(be)g(a)h(good)396 1451
y(decision.)e(First,)i(it)g(w)o(ould)f(mean)f(emulating)g(the)h(secret)
h(sauce)f(that)g(REQ)h(does)f(with)g(en)m(v)o(elopes)e(\(if)i(you')l(v)
o(e)396 1559 y(for)o(gotten)d(what)j(that)g(is,)h(it')-5
b(s)20 b(a)h(good)d(sign)i(you)f(don')o(t)f(w)o(ant)i(to)f(ha)n(v)o(e)h
(to)g(do)f(it\).)h(Second,)e(it)j(w)o(ould)e(mean)g(potentially)396
1667 y(getting)h(back)f(replies)h(that)h(you)e(didn')o(t)f(e)o(xpect.)
-2 1851 y
SDict begin H.S end
 -2 1851 a -2 1851 a
SDict begin 13 H.A end
 -2 1851 a -2 1851 a
SDict begin [/View [/XYZ H.V]/Dest (0:2044) cvn /DEST pdfmark end
 -2
1851 a 396 1941 a Fj(Handling)h(f)o(ailures)h(only)f(at)i(the)f(client)
g(w)o(orks)g(when)g(we)g(ha)n(v)o(e)g(a)h(set)g(of)f(clients)g(talking)
f(to)i(a)f(single)g(serv)o(er)-5 b(.)20 b(It)g(can)396
2049 y(handle)f(a)i(serv)o(er)e(crash,)h(b)n(ut)g(only)g(if)g(reco)o(v)
o(ery)e(means)i(restarting)f(that)h(same)h(serv)o(er)-5
b(.)19 b(If)h(there')-5 b(s)20 b(a)h(permanent)d(error)396
2157 y(-)j(e.g.)e(a)i(dead)e(po)n(wer)h(supply)f(on)h(the)g(serv)o(er)f
(hardw)o(are)g(-)h(this)h(approach)d(w)o(on')o(t)h(w)o(ork.)g(Since)i
(the)f(application)f(code)396 2265 y(in)i(serv)o(ers)e(is)i(usually)f
(the)g(biggest)g(source)f(of)h(f)o(ailures)g(in)g(an)o(y)g
(architecture,)e(depending)g(on)i(a)g(single)g(serv)o(er)g(is)h(not)396
2373 y(a)g(great)f(idea.)-2 2557 y
SDict begin H.S end
 -2 2557 a -2 2557
a
SDict begin 13 H.A end
 -2 2557 a -2 2557 a
SDict begin [/View [/XYZ H.V]/Dest (0:2045) cvn /DEST pdfmark end
 -2 2557 a 396 2647 a Fj(So,)g(pros)g(and)g(cons:)
-2 2665 y
SDict begin H.S end
 -2 2665 a -2 2665 a
SDict begin 13 H.A end
 -2 2665 a -2 2665 a
SDict begin [/View [/XYZ H.V]/Dest (0:2046) cvn /DEST pdfmark end
 -2
2665 a -2 2675 a
SDict begin H.S end
 -2 2675 a -2 2675 a
SDict begin 13 H.A end
 -2 2675 a -2 2675
a
SDict begin [/View [/XYZ H.V]/Dest (0:2047) cvn /DEST pdfmark end
 -2 2675 a Black 396 2817 a Fe(\225)p Black 479 2817
a
SDict begin H.S end
 479 2817 a 479 2817 a
SDict begin 13 H.A end
 479 2817 a 479 2817 a
SDict begin [/View [/XYZ H.V]/Dest (0:2048) cvn /DEST pdfmark end
 479 2817
a Fj(Pro:)g(simple)h(to)f(understand)e(and)i(implement.)-2
2835 y
SDict begin H.S end
 -2 2835 a -2 2835 a
SDict begin 13 H.A end
 -2 2835 a -2 2835 a
SDict begin [/View [/XYZ H.V]/Dest (0:2049) cvn /DEST pdfmark end
 -2 2835
a Black 396 2967 a Fe(\225)p Black 479 2967 a
SDict begin H.S end
 479 2967
a 479 2967 a
SDict begin 13 H.A end
 479 2967 a 479 2967 a
SDict begin [/View [/XYZ H.V]/Dest (0:2050) cvn /DEST pdfmark end
 479 2967 a Fj(Pro:)g(w)o(orks)g
(easily)h(with)f(e)o(xisting)g(client)g(and)f(serv)o(er)h(application)e
(code.)-2 2985 y
SDict begin H.S end
 -2 2985 a -2 2985 a
SDict begin 13 H.A end
 -2 2985 a -2 2985
a
SDict begin [/View [/XYZ H.V]/Dest (0:2051) cvn /DEST pdfmark end
 -2 2985 a Black 396 3116 a Fe(\225)p Black 479 3116
a
SDict begin H.S end
 479 3116 a 479 3116 a
SDict begin 13 H.A end
 479 3116 a 479 3116 a
SDict begin [/View [/XYZ H.V]/Dest (0:2052) cvn /DEST pdfmark end
 479 3116
a Fj(Pro:)i(\330MQ)h(automatically)e(retries)h(the)g(actual)g
(reconnection)e(until)i(it)h(w)o(orks.)-2 3134 y
SDict begin H.S end
 -2 3134
a -2 3134 a
SDict begin 13 H.A end
 -2 3134 a -2 3134 a
SDict begin [/View [/XYZ H.V]/Dest (0:2053) cvn /DEST pdfmark end
 -2 3134 a Black 396 3266
a Fe(\225)p Black 479 3266 a
SDict begin H.S end
 479 3266 a 479 3266 a
SDict begin 13 H.A end
 479
3266 a 479 3266 a
SDict begin [/View [/XYZ H.V]/Dest (0:2054) cvn /DEST pdfmark end
 479 3266 a Fj(Con:)g(doesn')o(t)d(do)i(f)o(ail-o)o(v)
o(er)e(to)j(backup)d(/)j(alternate)f(serv)o(ers.)-2 3325
y
SDict begin H.S end
 -2 3325 a -2 3325 a
SDict begin 13 H.A end
 -2 3325 a -2 3325 a
SDict begin [/View [/XYZ H.V]/Dest (0:2055) cvn /DEST pdfmark end
 -2 3325 a 359
x Fh(4.4.)39 b(Basic)g(Reliab)o(le)e(Queuing)h(\(Simple)g(Pirate)h(P)l
(attern\))3447 3684 y
SDict begin H.S end
 3447 3684 a 3447 3684 a
SDict begin 22.464 H.A end
 3447 3684
a 3447 3684 a
SDict begin [/View [/XYZ H.V]/Dest (9.43.1) cvn /DEST pdfmark end
 3447 3684 a -2 3882 a
SDict begin H.S end
 -2 3882 a -2 3882
a
SDict begin 13 H.A end
 -2 3882 a -2 3882 a
SDict begin [/View [/XYZ H.V]/Dest (0:2057) cvn /DEST pdfmark end
 -2 3882 a 396 3958 a Fj(Our)20
b(second)f(approach)f(tak)o(es)j(Lazy)f(Pirate)g(pattern)f(and)h(e)o
(xtends)f(it)i(with)g(a)f(queue)f(de)n(vice)h(that)g(lets)h(us)f(talk,)
396 4066 y(transparently)-5 b(,)18 b(to)i(multiple)g(serv)o(ers,)f
(which)h(we)g(can)g(more)g(accurately)f(call)h('w)o(ork)o(ers'.)f(W)-7
b(e')o(ll)21 b(de)n(v)o(elop)d(this)j(in)396 4174 y(stages,)g(starting)
e(with)i(a)f(minimal)g(w)o(orking)f(model,)g(the)h(Simple)g(Pirate)g
(pattern.)-2 4358 y
SDict begin H.S end
 -2 4358 a -2 4358 a
SDict begin 13 H.A end
 -2 4358 a -2
4358 a
SDict begin [/View [/XYZ H.V]/Dest (0:2058) cvn /DEST pdfmark end
 -2 4358 a 396 4448 a Fj(In)g(all)h(these)f(Pirate)h(patterns,)e
(w)o(ork)o(ers)h(are)g(stateless,)h(or)f(ha)n(v)o(e)f(some)h(shared)g
(state)h(we)f(don')o(t)f(kno)n(w)g(about,)g(e.g.)h(a)396
4556 y(shared)g(database.)f(Ha)n(ving)h(a)g(queue)f(de)n(vice)h(means)f
(w)o(ork)o(ers)h(can)g(come)g(and)f(go)h(without)f(clients)i(kno)n
(wing)396 4664 y(an)o(ything)d(about)i(it.)g(If)g(one)g(w)o(ork)o(er)f
(dies,)h(another)f(tak)o(es)i(o)o(v)o(er)-5 b(.)19 b(This)h(is)h(a)g
(nice)f(simple)g(topology)e(with)i(only)g(one)396 4772
y(real)g(weakness,)g(namely)f(the)h(central)g(queue)f(itself,)i(which)e
(can)h(become)f(a)i(problem)d(to)j(manage,)d(and)i(a)h(single)396
4880 y(point)f(of)g(f)o(ailure.)p Black 3759 5569 a Fi(153)p
Black eop end
%%Page: 154 168
TeXDict begin 154 167 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.154) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2059) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(The)20 b(basis)h(for)e(the)i(queue)e(de)n
(vice)g(is)i(the)f(least-recently-used)e(\(LR)m(U\))i(routing)f(queue)g
(from)g(Adv)n(anced)396 180 y(Request-Reply)g(P)o(atterns)p
0 TeXcolorgray 1177 180 a
SDict begin H.S end
 1177 180 a Fj(Chapter)g(3)1502
180 y
SDict begin 13 H.L end
 1502 180 a 1502 180 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1502 180 a Black Fj(.)h(What)h(is)g(the)f
(v)o(ery)2109 180 y
SDict begin H.S end
 2109 180 a 2109 180 a
SDict begin 13 H.A end
 2109 180 a
2109 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:2061) cvn /DEST pdfmark end
 2109 180 a Fi(minimum)g Fj(we)h(need)e(to)h(do)g(to)h
(handle)e(dead)g(or)h(block)o(ed)396 288 y(w)o(ork)o(ers?)g(T)l(urns)f
(out,)h(it')-5 b(s)21 b(surprisingly)e(little.)h(W)-7
b(e)22 b(already)d(ha)n(v)o(e)g(a)i(retry)f(mechanism)f(in)h(the)g
(client.)g(So)g(using)g(the)396 396 y(standard)f(LR)m(U)i(queue)e(will)
i(w)o(ork)e(pretty)h(well.)g(This)h(\002ts)g(with)f(\330MQ')-5
b(s)21 b(philosophy)c(that)k(we)f(can)g(e)o(xtend)f(a)396
504 y(peer)n(-to-peer)f(pattern)h(lik)o(e)i(request-reply)d(by)h
(plugging)f(nai)n(v)o(e)i(de)n(vices)f(in)i(the)f(middle\()p
0 TeXcolorgray 3028 504 a
SDict begin H.S end
 3028 504 a Fj(Figure)e(4-2)3376
504 y
SDict begin 13 H.L end
 3376 504 a 3376 504 a
SDict begin [/Subtype /Link/Dest (0:figure-54) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3376 504 a Black -2 w Fj(\).)-2
522 y
SDict begin H.S end
 -2 522 a -2 522 a
SDict begin 13 H.A end
 -2 522 a -2 522 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-54) cvn /DEST pdfmark
end
 -2 522 a 396
706 a Fk(Figur)o(e)i(4-2.)f(The)i(Simple)g(Pirate)f(P)o(atter)o(n)-2
805 y
SDict begin H.S end
 -2 805 a -2 805 a
SDict begin 13 H.A end
 -2 805 a -2 805 a
SDict begin [/View [/XYZ H.V]/Dest (0:2065) cvn /DEST pdfmark end
 -2 805 a 396
4347 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4347 a @beginspecial 0 @llx -420 @lly 392
@urx 0 @ury 3920 @rwi @setspecial
%%BeginDocument: images/fig54.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -420 392 0
%%HiResBoundingBox: 0.0 -420.0 392.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -32.40024185180664 moveto
22.400239944458008 -54.40024185180664 lineto
118.40023803710938 -54.40024185180664 lineto
118.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -57.40024185180664 moveto
22.400239944458008 -78.40023803710938 lineto
118.40023803710938 -78.40023803710938 lineto
118.40023803710938 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -81.40023803710938 moveto
22.400239944458008 -98.40023803710938 lineto
22.400239944458008 -102.40023803710938 23.73357327779134 -104.40023803710938 26.400239944458008 -104.40023803710938 curveto
114.40023803710938 -104.40023803710938 lineto
114.40023803710938 -104.40023803710938 lineto
117.06690470377605 -104.40023803710938 118.40023803710938 -102.40023803710938 118.40023803710938 -98.40023803710938 curveto
118.40023803710938 -82.00023651123047 lineto
118.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -32.40024185180664 moveto
150.40023803710938 -54.40024185180664 lineto
246.40023803710938 -54.40024185180664 lineto
246.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -57.40024185180664 moveto
150.40023803710938 -78.40023803710938 lineto
246.40023803710938 -78.40023803710938 lineto
246.40023803710938 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -81.40023803710938 moveto
150.40023803710938 -98.40023803710938 lineto
150.40023803710938 -102.40023803710938 151.73357137044272 -104.40023803710938 154.40023803710938 -104.40023803710938 curveto
242.40023803710938 -104.40023803710938 lineto
242.40023803710938 -104.40023803710938 lineto
245.06690470377603 -104.40023803710938 246.40023803710938 -102.40023803710938 246.40023803710938 -98.40023803710938 curveto
246.40023803710938 -82.00023651123047 lineto
246.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -32.40024185180664 moveto
278.4002380371094 -54.40024185180664 lineto
374.4002380371094 -54.40024185180664 lineto
374.4002380371094 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -57.40024185180664 moveto
278.4002380371094 -78.40023803710938 lineto
374.4002380371094 -78.40023803710938 lineto
374.4002380371094 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -81.40023803710938 moveto
278.4002380371094 -98.40023803710938 lineto
278.4002380371094 -102.40023803710938 279.7335713704427 -104.40023803710938 282.4002380371094 -104.40023803710938 curveto
370.4002380371094 -104.40023803710938 lineto
370.4002380371094 -104.40023803710938 lineto
373.06690470377606 -104.40023803710938 374.4002380371094 -102.40023803710938 374.4002380371094 -98.40023803710938 curveto
374.4002380371094 -82.00023651123047 lineto
374.4002380371094 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -176.40023803710938 moveto
151.73357137044272 -176.40023803710938 150.40023803710938 -178.40023803710938 150.40023803710938 -182.40023803710938 curveto
150.40023803710938 -198.40023803710938 lineto
246.40023803710938 -198.40023803710938 lineto
246.40023803710938 -182.40023803710938 lineto
246.40023803710938 -178.40023803710938 245.06690470377603 -176.40023803710938 242.40023803710938 -176.40023803710938 curveto
154.40023803710938 -176.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -201.40023803710938 moveto
150.40023803710938 -234.40023803710938 lineto
246.40023803710938 -234.40023803710938 lineto
246.40023803710938 -201.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -237.40023803710938 moveto
150.40023803710938 -254.40023803710938 lineto
150.40023803710938 -258.4002380371094 151.73357137044272 -260.4002380371094 154.40023803710938 -260.4002380371094 curveto
242.40023803710938 -260.4002380371094 lineto
242.40023803710938 -260.4002380371094 lineto
245.06690470377603 -260.4002380371094 246.40023803710938 -258.4002380371094 246.40023803710938 -254.40023803710938 curveto
246.40023803710938 -238.000244140625 lineto
246.40023803710938 -237.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -332.4002380371094 moveto
23.73357327779134 -332.4002380371094 22.400239944458008 -334.4002380371094 22.400239944458008 -338.4002380371094 curveto
22.400239944458008 -354.4002380371094 lineto
118.40023803710938 -354.4002380371094 lineto
118.40023803710938 -338.4002380371094 lineto
118.40023803710938 -334.4002380371094 117.06690470377605 -332.4002380371094 114.40023803710938 -332.4002380371094 curveto
26.400239944458008 -332.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -357.4002380371094 moveto
22.400239944458008 -392.4002380371094 lineto
118.40023803710938 -392.4002380371094 lineto
118.40023803710938 -357.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -332.4002380371094 moveto
151.73357137044272 -332.4002380371094 150.40023803710938 -334.4002380371094 150.40023803710938 -338.4002380371094 curveto
150.40023803710938 -354.4002380371094 lineto
246.40023803710938 -354.4002380371094 lineto
246.40023803710938 -338.4002380371094 lineto
246.40023803710938 -334.4002380371094 245.06690470377603 -332.4002380371094 242.40023803710938 -332.4002380371094 curveto
154.40023803710938 -332.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -357.4002380371094 moveto
150.40023803710938 -392.4002380371094 lineto
246.40023803710938 -392.4002380371094 lineto
246.40023803710938 -357.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -332.4002380371094 moveto
279.7335713704427 -332.4002380371094 278.4002380371094 -334.4002380371094 278.4002380371094 -338.4002380371094 curveto
278.4002380371094 -354.4002380371094 lineto
374.4002380371094 -354.4002380371094 lineto
374.4002380371094 -338.4002380371094 lineto
374.4002380371094 -334.4002380371094 373.06690470377606 -332.4002380371094 370.4002380371094 -332.4002380371094 curveto
282.4002380371094 -332.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -357.4002380371094 moveto
278.4002380371094 -392.4002380371094 lineto
374.4002380371094 -392.4002380371094 lineto
374.4002380371094 -357.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -30.0 moveto
20.0 -52.0 lineto
116.0 -52.0 lineto
116.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -30.0 moveto
20.0 -52.0 lineto
116.0 -52.0 lineto
116.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -55.0 moveto
20.0 -76.0 lineto
116.0 -76.0 lineto
116.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -55.0 moveto
20.0 -76.0 lineto
116.0 -76.0 lineto
116.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -79.0 moveto
20.0 -96.0 lineto
20.0 -100.0 21.333333333333332 -102.0 24.0 -102.0 curveto
112.0 -102.0 lineto
112.0 -102.0 lineto
114.66666666666667 -102.0 116.0 -100.0 116.0 -96.0 curveto
116.0 -79.5999984741211 lineto
116.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -79.0 moveto
20.0 -96.0 lineto
20.0 -100.0 21.333333333333332 -102.0 24.0 -102.0 curveto
112.0 -102.0 lineto
112.0 -102.0 lineto
114.66666666666667 -102.0 116.0 -100.0 116.0 -96.0 curveto
116.0 -79.5999984741211 lineto
116.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -52.0 lineto
244.0 -52.0 lineto
244.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -52.0 lineto
244.0 -52.0 lineto
244.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -55.0 moveto
148.0 -76.0 lineto
244.0 -76.0 lineto
244.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -55.0 moveto
148.0 -76.0 lineto
244.0 -76.0 lineto
244.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -79.0 moveto
148.0 -96.0 lineto
148.0 -100.0 149.33333333333334 -102.0 152.0 -102.0 curveto
240.0 -102.0 lineto
240.0 -102.0 lineto
242.66666666666666 -102.0 244.0 -100.0 244.0 -96.0 curveto
244.0 -79.5999984741211 lineto
244.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -79.0 moveto
148.0 -96.0 lineto
148.0 -100.0 149.33333333333334 -102.0 152.0 -102.0 curveto
240.0 -102.0 lineto
240.0 -102.0 lineto
242.66666666666666 -102.0 244.0 -100.0 244.0 -96.0 curveto
244.0 -79.5999984741211 lineto
244.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -52.0 lineto
372.0 -52.0 lineto
372.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -52.0 lineto
372.0 -52.0 lineto
372.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -55.0 moveto
276.0 -76.0 lineto
372.0 -76.0 lineto
372.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -55.0 moveto
276.0 -76.0 lineto
372.0 -76.0 lineto
372.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -79.0 moveto
276.0 -96.0 lineto
276.0 -100.0 277.3333333333333 -102.0 280.0 -102.0 curveto
368.0 -102.0 lineto
368.0 -102.0 lineto
370.6666666666667 -102.0 372.0 -100.0 372.0 -96.0 curveto
372.0 -79.5999984741211 lineto
372.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -79.0 moveto
276.0 -96.0 lineto
276.0 -100.0 277.3333333333333 -102.0 280.0 -102.0 curveto
368.0 -102.0 lineto
368.0 -102.0 lineto
370.6666666666667 -102.0 372.0 -100.0 372.0 -96.0 curveto
372.0 -79.5999984741211 lineto
372.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -174.0 moveto
149.33333333333334 -174.0 148.0 -176.0 148.0 -180.0 curveto
148.0 -196.0 lineto
244.0 -196.0 lineto
244.0 -180.0 lineto
244.0 -176.0 242.66666666666666 -174.0 240.0 -174.0 curveto
152.0 -174.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -174.0 moveto
149.33333333333334 -174.0 148.0 -176.0 148.0 -180.0 curveto
148.0 -196.0 lineto
244.0 -196.0 lineto
244.0 -180.0 lineto
244.0 -176.0 242.66666666666666 -174.0 240.0 -174.0 curveto
152.0 -174.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -199.0 moveto
148.0 -232.0 lineto
244.0 -232.0 lineto
244.0 -199.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -199.0 moveto
148.0 -232.0 lineto
244.0 -232.0 lineto
244.0 -199.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -235.0 moveto
148.0 -252.0 lineto
148.0 -256.0 149.33333333333334 -258.0 152.0 -258.0 curveto
240.0 -258.0 lineto
240.0 -258.0 lineto
242.66666666666666 -258.0 244.0 -256.0 244.0 -252.0 curveto
244.0 -235.60000610351562 lineto
244.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -235.0 moveto
148.0 -252.0 lineto
148.0 -256.0 149.33333333333334 -258.0 152.0 -258.0 curveto
240.0 -258.0 lineto
240.0 -258.0 lineto
242.66666666666666 -258.0 244.0 -256.0 244.0 -252.0 curveto
244.0 -235.60000610351562 lineto
244.0 -235.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -330.0 moveto
21.333333333333332 -330.0 20.0 -332.0 20.0 -336.0 curveto
20.0 -352.0 lineto
116.0 -352.0 lineto
116.0 -336.0 lineto
116.0 -332.0 114.66666666666667 -330.0 112.0 -330.0 curveto
24.0 -330.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -330.0 moveto
21.333333333333332 -330.0 20.0 -332.0 20.0 -336.0 curveto
20.0 -352.0 lineto
116.0 -352.0 lineto
116.0 -336.0 lineto
116.0 -332.0 114.66666666666667 -330.0 112.0 -330.0 curveto
24.0 -330.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -355.0 moveto
20.0 -390.0 lineto
116.0 -390.0 lineto
116.0 -355.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -355.0 moveto
20.0 -390.0 lineto
116.0 -390.0 lineto
116.0 -355.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -330.0 moveto
149.33333333333334 -330.0 148.0 -332.0 148.0 -336.0 curveto
148.0 -352.0 lineto
244.0 -352.0 lineto
244.0 -336.0 lineto
244.0 -332.0 242.66666666666666 -330.0 240.0 -330.0 curveto
152.0 -330.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -330.0 moveto
149.33333333333334 -330.0 148.0 -332.0 148.0 -336.0 curveto
148.0 -352.0 lineto
244.0 -352.0 lineto
244.0 -336.0 lineto
244.0 -332.0 242.66666666666666 -330.0 240.0 -330.0 curveto
152.0 -330.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -355.0 moveto
148.0 -390.0 lineto
244.0 -390.0 lineto
244.0 -355.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -355.0 moveto
148.0 -390.0 lineto
244.0 -390.0 lineto
244.0 -355.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -330.0 moveto
277.3333333333333 -330.0 276.0 -332.0 276.0 -336.0 curveto
276.0 -352.0 lineto
372.0 -352.0 lineto
372.0 -336.0 lineto
372.0 -332.0 370.6666666666667 -330.0 368.0 -330.0 curveto
280.0 -330.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -330.0 moveto
277.3333333333333 -330.0 276.0 -332.0 276.0 -336.0 curveto
276.0 -352.0 lineto
372.0 -352.0 lineto
372.0 -336.0 lineto
372.0 -332.0 370.6666666666667 -330.0 368.0 -330.0 curveto
280.0 -330.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -355.0 moveto
276.0 -390.0 lineto
372.0 -390.0 lineto
372.0 -355.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -355.0 moveto
276.0 -390.0 lineto
372.0 -390.0 lineto
372.0 -355.0 lineto
closepath
stroke
newpath
68.0 -108.0 moveto
64.0 -120.0 lineto
72.0 -120.0 lineto
closepath
fill
newpath
196.0 -108.0 moveto
192.0 -120.0 lineto
200.0 -120.0 lineto
closepath
fill
newpath
324.0 -108.0 moveto
320.0 -120.0 lineto
328.0 -120.0 lineto
closepath
fill
newpath
192.0 -156.0 moveto
196.0 -168.0 lineto
200.0 -156.0 lineto
closepath
fill
newpath
196.0 -264.0 moveto
192.0 -276.0 lineto
200.0 -276.0 lineto
closepath
fill
newpath
64.0 -312.0 moveto
68.0 -324.0 lineto
72.0 -312.0 lineto
closepath
fill
newpath
192.0 -312.0 moveto
196.0 -324.0 lineto
200.0 -312.0 lineto
closepath
fill
newpath
320.0 -312.0 moveto
324.0 -324.0 lineto
328.0 -312.0 lineto
closepath
fill
newpath
68.0 -114.0 moveto
68.0 -132.0 lineto
68.0 -136.0 69.33333333333333 -138.0 72.0 -138.0 curveto
196.0 -138.0 lineto
196.0 -138.0 lineto
stroke
newpath
196.0 -114.0 moveto
196.0 -138.0 lineto
stroke
newpath
324.0 -114.0 moveto
324.0 -132.0 lineto
324.0 -136.0 322.6666666666667 -138.0 320.0 -138.0 curveto
196.0 -138.0 lineto
196.0 -138.0 lineto
stroke
newpath
196.0 -162.0 moveto
196.0 -138.0 lineto
stroke
newpath
196.0 -270.0 moveto
196.0 -294.0 lineto
stroke
newpath
68.0 -318.0 moveto
68.0 -300.0 lineto
68.0 -296.0 69.33333333333333 -294.0 72.0 -294.0 curveto
196.0 -294.0 lineto
196.0 -294.0 lineto
stroke
newpath
196.0 -318.0 moveto
196.0 -294.0 lineto
stroke
newpath
324.0 -318.0 moveto
324.0 -300.0 lineto
324.0 -296.0 322.6666666666667 -294.0 320.0 -294.0 curveto
196.0 -294.0 lineto
196.0 -294.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
43.0 -47.0 moveto
(Client) show
171.0 -47.0 moveto
(Client) show
299.0 -47.0 moveto
(Client) show
49.0 -71.0 moveto
(Retry) show
177.0 -71.0 moveto
(Retry) show
305.0 -71.0 moveto
(Retry) show
57.0 -94.0 moveto
(REQ) show
185.0 -94.0 moveto
(REQ) show
313.0 -94.0 moveto
(REQ) show
170.0 -190.0 moveto
(ROUTER) show
185.0 -214.0 moveto
(LRU) show
178.0 -226.0 moveto
(Queue) show
170.0 -250.0 moveto
(ROUTER) show
57.0 -346.0 moveto
(REQ) show
185.0 -346.0 moveto
(REQ) show
313.0 -346.0 moveto
(REQ) show
57.0 -370.0 moveto
(LRU) show
49.0 -382.0 moveto
(Worker) show
185.0 -370.0 moveto
(LRU) show
177.0 -382.0 moveto
(Worker) show
313.0 -370.0 moveto
(LRU) show
305.0 -382.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4347 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4347 a -2 4513 a
SDict begin H.S end
 -2 4513
a -2 4513 a
SDict begin 13 H.A end
 -2 4513 a -2 4513 a
SDict begin [/View [/XYZ H.V]/Dest (0:2068) cvn /DEST pdfmark end
 -2 4513 a 396 4621 a
Fj(W)-7 b(e)21 b(don')o(t)d(need)h(a)h(special)g(client,)g(we')l(re)f
(still)i(using)e(the)h(Lazy)f(Pirate)h(client.)f(Here)h(is)h(the)e
(queue,)g(which)g(is)i(e)o(xactly)396 4729 y(a)g(LR)m(U)f(queue,)f(no)h
(more)f(or)h(less:)-2 4747 y
SDict begin H.S end
 -2 4747 a -2 4747 a
SDict begin 13 H.A end
 -2 4747
a -2 4747 a
SDict begin [/View [/XYZ H.V]/Dest (0:spqueue-php) cvn /DEST pdfmark
end
 -2 4747 a 396 4930 a Fk(Example)h(4-3.)e(Simple)i(Pirate)f
(queue)h(\(spqueue.php\))-2 5030 y
SDict begin H.S end
 -2 5030 a -2 5030
a
SDict begin 11.7 H.A end
 -2 5030 a -2 5030 a
SDict begin [/View [/XYZ H.V]/Dest (0:2071) cvn /DEST pdfmark end
 -2 5030 a 396 5110 a Fg(<?php)p
Black 3759 5569 a Fi(154)p Black eop end
%%Page: 155 169
TeXDict begin 155 168 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.155) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fg(/)441 85 y(*)441 183 y(*)531
170 y(Simple)44 b(Pirate)f(queue)441 280 y(*)531 267
y(This)h(is)g(identical)g(to)g(the)h(LRU)f(pattern,)f(with)i(no)f
(reliability)f(mechanisms)441 377 y(*)531 364 y(at)h(all.)g(It)h
(depends)f(on)g(the)g(client)g(for)h(recovery.)e(Runs)h(forever.)441
474 y(*)441 571 y(*)531 558 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 668 y(*)486
655 y(/)396 752 y(include\("zmsg.php"\);)396 947 y
(define\("MAX_WORKERS",)e(100\);)396 1238 y(//)90 b(Prepare)43
b(our)i(context)e(and)i(sockets)396 1335 y($context)89
b(=)44 b(new)h(ZMQContext\(\);)396 1432 y($frontend)f(=)g
($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396 1530
y($backend)g(=)g($context->getSocket\(ZMQ::SOCKET_ROUTER\);)396
1627 y($frontend->bind\("tcp://)1431 1640 y(*)1476 1627
y(:5555"\);)174 b(//)90 b(For)44 b(clients)396 1724 y
($backend->bind\("tcp://)1386 1737 y(*)1431 1724 y(:5556"\);)174
b(//)90 b(For)44 b(workers)396 1918 y(//)90 b(Queue)44
b(of)g(available)f(workers)396 2015 y($available_workers)f(=)j(0;)396
2112 y($worker_queue)e(=)i(array\(\);)396 2209 y($read)f(=)h($write)f
(=)g(array\(\);)396 2404 y(while\(true\))f({)441 2501
y($poll)h(=)h(new)f(ZMQPoll\(\);)441 2598 y($poll->add\($backend,)e
(ZMQ::POLL_IN\);)441 2889 y(//)89 b(Poll)45 b(frontend)e(only)h(if)h
(we)f(have)g(available)g(workers)441 2987 y(if\($available_workers\))d
({)486 3084 y($poll->add\($frontend,)g(ZMQ::POLL_IN\);)441
3181 y(})441 3375 y($events)j(=)g($poll->poll\($read,)e($write\);)441
3569 y(foreach\($read)h(as)h($socket\))g({)486 3666 y($zmsg)g(=)h(new)f
(Zmsg\($socket\);)486 3764 y($zmsg->recv\(\);)486 3958
y(//)89 b(Handle)44 b(worker)g(activity)f(on)i(backend)486
4055 y(if\($socket)e(===)h($backend\))g({)531 4152 y(//)89
b(Use)44 b(worker)g(address)g(for)g(LRU)h(routing)531
4249 y(assert\($available_workers)40 b(<)45 b(MAX_WORKERS\);)531
4346 y(array_push\($worker_queue,)40 b($zmsg->unwrap\(\)\);)531
4444 y($available_workers++;)531 4638 y(//)89 b(Return)44
b(reply)g(to)g(client)g(if)h(it's)f(not)g(a)h(READY)531
4735 y(if\($zmsg->address\(\))c(!=)k("READY"\))e({)576
4832 y($zmsg->set_socket\($frontend\)->send\(\);)531
4929 y(})486 5026 y(})i(else)f(if\($socket)f(===)h($frontend\))f({)531
5124 y(//)89 b(Now)44 b(get)h(next)f(client)g(request,)f(route)h(to)h
(next)f(worker)p Black 3759 5569 a Fi(155)p Black eop
end
%%Page: 156 170
TeXDict begin 156 169 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.156) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 531 72 a Fg(//)89 b(REQ)44 b(socket)g(in)h(worker)f
(needs)g(an)g(envelope)g(delimiter)531 170 y(//)89 b(Dequeue)44
b(and)g(drop)g(the)h(next)f(worker)g(address)531 267
y($zmsg->wrap\(array_shift\($worker_queue\))o(,)39 b(""\);)531
364 y($zmsg->set_socket\($backend\)->send\(\);)531 461
y($available_workers--;)486 558 y(})441 655 y(})441 752
y(//)89 b(We)45 b(never)f(exit)g(the)g(main)h(loop)396
850 y(})-2 1024 y
SDict begin H.S end
 -2 1024 a -2 1024 a
SDict begin 13 H.A end
 -2 1024 a -2 1024
a
SDict begin [/View [/XYZ H.V]/Dest (0:2072) cvn /DEST pdfmark end
 -2 1024 a 396 1124 a Fj(Here)20 b(is)h(the)g(w)o(ork)o(er)m(,)d
(which)i(tak)o(es)h(the)f(Lazy)f(Pirate)i(serv)o(er)e(and)h(adapts)g
(it)h(for)e(the)h(LR)m(U)h(pattern)e(\(using)g(the)i(REQ)396
1231 y(')l(ready')e(signaling\):)-2 1249 y
SDict begin H.S end
 -2 1249 a
-2 1249 a
SDict begin 13 H.A end
 -2 1249 a -2 1249 a
SDict begin [/View [/XYZ H.V]/Dest (0:spworker-php) cvn /DEST pdfmark
end
 -2 1249 a 396 1433 a Fk(Example)i(4-4.)e
(Simple)i(Pirate)f(w)o(ork)o(er)g(\(spw)o(ork)o(er)-8
b(.php\))-2 1533 y
SDict begin H.S end
 -2 1533 a -2 1533 a
SDict begin 11.7 H.A end
 -2 1533 a -2 1533
a
SDict begin [/View [/XYZ H.V]/Dest (0:2075) cvn /DEST pdfmark end
 -2 1533 a 396 1613 a Fg(<?php)396 1710 y(/)441 1723
y(*)441 1820 y(*)531 1807 y(Simple)44 b(Pirate)f(worker)441
1917 y(*)531 1904 y(Connects)g(REQ)i(socket)e(to)i(tcp://)1832
1917 y(*)1877 1904 y(:5556)441 2014 y(*)531 2001 y(Implements)e(worker)
h(part)g(of)g(LRU)h(queueing)441 2112 y(*)441 2209 y(*)531
2196 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 2306 y(*)486
2293 y(/)396 2390 y(include)g("zmsg.php";)396 2584 y($context)g(=)g
(new)h(ZMQContext\(\);)396 2681 y($worker)f(=)h(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_REQ\);)396 2876 y(//)90
b(Set)44 b(random)g(identity)f(to)i(make)f(tracing)g(easier)396
2973 y($identity)g(=)g(sprintf)g(\("\04504X-\04504X",)f(rand\(0,)g
(0x10000\),)h(rand\(0,)f(0x10000\)\);)396 3070 y
($worker->setSockOpt\(ZMQ::SOCKOPT_IDENTITY)o(,)c($identity\);)396
3167 y($worker->connect\("tcp://localhost:5556"\);)396
3361 y(//)90 b(Tell)44 b(queue)g(we're)g(ready)g(for)g(work)396
3459 y(printf)g(\("I:)g(\(\045s\))g(worker)g(ready\045s",)g($identity,)
f(PHP_EOL\);)396 3556 y($worker->send\("READY"\);)396
3750 y($cycles)h(=)h(0;)396 3847 y(while\(true\))e({)441
3944 y($zmsg)h(=)h(new)f(Zmsg\($worker\);)441 4041 y($zmsg->recv\(\);)
441 4138 y($cycles++;)441 4333 y(//)89 b(Simulate)44
b(various)g(problems,)f(after)h(a)h(few)f(cycles)441
4430 y(if\($cycles)f(>)i(3)g(&&)f(rand\(0,)g(3\))g(==)h(0\))f({)486
4527 y(echo)g("I:)g(\(\045s\))h(simulating)e(a)h(crash",)g($identity,)f
(PHP_EOL;)486 4624 y(break;)441 4721 y(})i(else)f(if\($cycles)f(>)i(3)f
(&&)h(rand\(0,)f(3\))g(==)h(0\))f({)486 4818 y(echo)g("I:)g(\(\045s\))h
(simulating)e(CPU)h(overload",)f($identity,)g(PHP_EOL;)486
4916 y(sleep\(5\);)441 5013 y(})441 5110 y(printf)h(\("I:)g(\(\045s\))g
(normal)g(reply)g(-)h(\045s\045s",)f($identity,)f($zmsg->body\(\),)f
(PHP_EOL\);)p Black 3757 5569 a Fi(156)p Black eop end
%%Page: 157 171
TeXDict begin 157 170 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.157) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2094) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 441 72 a Fg(sleep\(1\);)43 b(//)i(Do)f(some)h
(heavy)f(work)441 170 y($zmsg->send\(\);)-2 347 y
SDict begin H.S end
 -2
347 a -2 347 a
SDict begin 13 H.A end
 -2 347 a -2 347 a
SDict begin [/View [/XYZ H.V]/Dest (0:2076) cvn /DEST pdfmark end
 -2 347 a 396 444 a Fj(T)-7
b(o)21 b(test)g(this,)f(start)h(a)f(handful)f(of)h(w)o(ork)o(ers,)f(a)i
(client,)f(and)f(the)h(queue,)f(in)i(an)o(y)e(order)-5
b(.)19 b(Y)-9 b(ou')o(ll)20 b(see)g(that)h(the)f(w)o(ork)o(ers)396
552 y(e)n(v)o(entually)e(all)i(crash)g(and)f(b)n(urn,)f(and)h(the)h
(client)g(retries)f(and)g(then)g(gi)n(v)o(es)h(up.)f(The)g(queue)f(ne)n
(v)o(er)h(stops,)g(and)g(you)g(can)396 659 y(restart)h(w)o(ork)o(ers)g
(and)g(clients)g(ad-nauseam.)e(This)j(model)e(w)o(orks)h(with)g(an)o(y)
f(number)g(of)h(clients)g(and)g(w)o(ork)o(ers.)-2 688
y
SDict begin H.S end
 -2 688 a -2 688 a
SDict begin 13 H.A end
 -2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:2077) cvn /DEST pdfmark end
 -2 688 a 359 x
Fh(4.5.)39 b(Rob)m(ust)f(Reliab)o(le)g(Queuing)f(\(P)l(aranoid)h
(Pirate)g(P)l(attern\))3694 1047 y
SDict begin H.S end
 3694 1047 a 3694 1047
a
SDict begin 22.464 H.A end
 3694 1047 a 3694 1047 a
SDict begin [/View [/XYZ H.V]/Dest (9.44.1) cvn /DEST pdfmark end
 3694 1047 a -2 1245 a
SDict begin H.S end
 -2 1245
a -2 1245 a
SDict begin 13 H.A end
 -2 1245 a -2 1245 a
SDict begin [/View [/XYZ H.V]/Dest (0:2079) cvn /DEST pdfmark end
 -2 1245 a 396 1321 a
Fj(The)20 b(Simple)g(Pirate)h(Queue)e(pattern)g(w)o(orks)h(pretty)g
(well,)g(especially)g(since)g(it')-5 b(s)21 b(just)g(a)g(combination)d
(of)i(tw)o(o)396 1429 y(e)o(xisting)g(patterns,)f(b)n(ut)h(it)h(has)g
(some)f(weaknesses:)-2 1447 y
SDict begin H.S end
 -2 1447 a -2 1447 a
SDict begin 13 H.A end
 -2
1447 a -2 1447 a
SDict begin [/View [/XYZ H.V]/Dest (0:2080) cvn /DEST pdfmark end
 -2 1447 a -2 1457 a
SDict begin H.S end
 -2 1457 a -2 1457
a
SDict begin 13 H.A end
 -2 1457 a -2 1457 a
SDict begin [/View [/XYZ H.V]/Dest (0:2081) cvn /DEST pdfmark end
 -2 1457 a Black 396 1599 a Fe(\225)p
Black 479 1599 a
SDict begin H.S end
 479 1599 a 479 1599 a
SDict begin 13 H.A end
 479 1599 a 479
1599 a
SDict begin [/View [/XYZ H.V]/Dest (0:2082) cvn /DEST pdfmark end
 479 1599 a Fj(It')-5 b(s)21 b(not)f(rob)n(ust)g(against)f(a)i
(queue)e(crash)h(and)f(restart.)h(The)g(client)g(will)h(reco)o(v)o(er)m
(,)d(b)n(ut)i(the)g(w)o(ork)o(ers)g(w)o(on')o(t.)f(While)479
1707 y(\330MQ)i(will)g(reconnect)d(w)o(ork)o(ers')h(sock)o(ets)i
(automatically)-5 b(,)18 b(as)j(f)o(ar)f(as)h(the)f(ne)n(wly)f(started)
h(queue)f(is)j(concerned,)479 1815 y(the)e(w)o(ork)o(ers)g(ha)n(v)o
(en')o(t)e(signaled)i("READ)-5 b(Y",)20 b(so)h(don')o(t)d(e)o(xist.)j
(T)-7 b(o)20 b(\002x)g(this)h(we)g(ha)n(v)o(e)e(to)i(do)e(heartbeating)
f(from)479 1923 y(queue)h(to)i(w)o(ork)o(er)m(,)d(so)j(that)f(the)g(w)o
(ork)o(er)g(can)g(detect)g(when)f(the)h(queue)f(has)i(gone)e(a)o(w)o
(ay)-5 b(.)-2 1941 y
SDict begin H.S end
 -2 1941 a -2 1941 a
SDict begin 13 H.A end
 -2 1941 a -2
1941 a
SDict begin [/View [/XYZ H.V]/Dest (0:2083) cvn /DEST pdfmark end
 -2 1941 a Black 396 2072 a Fe(\225)p Black 479
2072 a
SDict begin H.S end
 479 2072 a 479 2072 a
SDict begin 13 H.A end
 479 2072 a 479 2072 a
SDict begin [/View [/XYZ H.V]/Dest (0:2084) cvn /DEST pdfmark end
 479
2072 a Fj(The)20 b(queue)f(does)h(not)g(detect)g(w)o(ork)o(er)f(f)o
(ailure,)h(so)g(if)h(a)f(w)o(ork)o(er)f(dies)i(while)f(idle,)g(the)g
(queue)f(can)h(only)g(remo)o(v)o(e)e(it)479 2180 y(from)h(its)j(w)o
(ork)o(er)d(queue)g(by)h(\002rst)h(sending)e(it)i(a)f(request.)f(The)h
(client)h(w)o(aits)g(and)e(retries)i(for)e(nothing.)f(It')-5
b(s)21 b(not)f(a)479 2288 y(critical)h(problem)d(b)n(ut)i(it')-5
b(s)22 b(not)d(nice.)h(T)-7 b(o)21 b(mak)o(e)e(this)i(w)o(ork)f
(properly)e(we)i(do)g(heartbeating)e(from)h(w)o(ork)o(er)g(to)479
2396 y(queue,)g(so)i(that)f(the)g(queue)f(can)h(detect)g(a)h(lost)f(w)o
(ork)o(er)g(at)g(an)o(y)g(stage.)-2 2580 y
SDict begin H.S end
 -2 2580 a
-2 2580 a
SDict begin 13 H.A end
 -2 2580 a -2 2580 a
SDict begin [/View [/XYZ H.V]/Dest (0:2085) cvn /DEST pdfmark end
 -2 2580 a 396 2670 a Fj(W)-7
b(e')o(ll)22 b(\002x)e(these)g(in)h(a)f(properly)e(pedantic)h(P)o
(aranoid)g(Pirate)h(P)o(attern.)-2 2854 y
SDict begin H.S end
 -2 2854 a -2
2854 a
SDict begin 13 H.A end
 -2 2854 a -2 2854 a
SDict begin [/View [/XYZ H.V]/Dest (0:2086) cvn /DEST pdfmark end
 -2 2854 a 396 2944 a Fj(W)-7
b(e)22 b(pre)n(viously)c(used)i(a)g(REQ)h(sock)o(et)f(for)g(the)g(w)o
(ork)o(er)-5 b(.)19 b(F)o(or)h(the)g(P)o(aranoid)f(Pirate)h(w)o(ork)o
(er)g(we')o(ll)g(switch)h(to)f(a)396 3052 y(DEALER)g(sock)o(et\()p
0 TeXcolorgray 984 3052 a
SDict begin H.S end
 984 3052 a Fj(Figure)f(4-3)1333
3052 y
SDict begin 13 H.L end
 1333 3052 a 1333 3052 a
SDict begin [/Subtype /Link/Dest (0:figure-55) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1333 3052 a Black -2 w
Fj(\).)h(This)g(has)g(the)g(adv)n(antage)e(of)h(letting)h(us)g(send)g
(and)f(recei)n(v)o(e)g(messages)g(at)i(an)o(y)e(time,)396
3160 y(rather)h(than)f(the)i(lock-step)e(send/recei)n(v)o(e)f(that)i
(REQ)h(imposes.)f(The)g(do)n(wnside)f(of)g(DEALER)i(is)g(that)f(we)h
(ha)n(v)o(e)e(to)396 3268 y(do)h(our)f(o)n(wn)h(en)m(v)o(elope)e
(management.)g(If)i(you)f(don')o(t)g(kno)n(w)g(what)h(I)g(mean,)g
(please)g(re-read)f(Adv)n(anced)396 3376 y(Request-Reply)g(P)o(atterns)
p 0 TeXcolorgray 1177 3376 a
SDict begin H.S end
 1177 3376 a Fj(Chapter)g(3)1502
3376 y
SDict begin 13 H.L end
 1502 3376 a 1502 3376 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1502 3376 a Black Fj(.)-2
3394 y
SDict begin H.S end
 -2 3394 a -2 3394 a
SDict begin 13 H.A end
 -2 3394 a -2 3394 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-55) cvn /DEST pdfmark
end
 -2 3394
a Black 3756 5569 a Fi(157)p Black eop end
%%Page: 158 172
TeXDict begin 158 171 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.158) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-3.)f(The)i(P)o(aranoid)e
(Pirate)h(P)o(atter)o(n)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2
172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2091) cvn /DEST pdfmark end
 -2 172 a 396 3914 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3914 a @beginspecial
0 @llx -444 @lly 392 @urx 0 @ury 3920 @rwi @setspecial
%%BeginDocument: images/fig55.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -444 392 0
%%HiResBoundingBox: 0.0 -444.0 392.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -32.40024185180664 moveto
22.400239944458008 -54.40024185180664 lineto
118.40023803710938 -54.40024185180664 lineto
118.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -57.40024185180664 moveto
22.400239944458008 -78.40023803710938 lineto
118.40023803710938 -78.40023803710938 lineto
118.40023803710938 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -81.40023803710938 moveto
22.400239944458008 -98.40023803710938 lineto
22.400239944458008 -102.40023803710938 23.73357327779134 -104.40023803710938 26.400239944458008 -104.40023803710938 curveto
114.40023803710938 -104.40023803710938 lineto
114.40023803710938 -104.40023803710938 lineto
117.06690470377605 -104.40023803710938 118.40023803710938 -102.40023803710938 118.40023803710938 -98.40023803710938 curveto
118.40023803710938 -82.00023651123047 lineto
118.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -32.40024185180664 moveto
150.40023803710938 -54.40024185180664 lineto
246.40023803710938 -54.40024185180664 lineto
246.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -57.40024185180664 moveto
150.40023803710938 -78.40023803710938 lineto
246.40023803710938 -78.40023803710938 lineto
246.40023803710938 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -81.40023803710938 moveto
150.40023803710938 -98.40023803710938 lineto
150.40023803710938 -102.40023803710938 151.73357137044272 -104.40023803710938 154.40023803710938 -104.40023803710938 curveto
242.40023803710938 -104.40023803710938 lineto
242.40023803710938 -104.40023803710938 lineto
245.06690470377603 -104.40023803710938 246.40023803710938 -102.40023803710938 246.40023803710938 -98.40023803710938 curveto
246.40023803710938 -82.00023651123047 lineto
246.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -32.40024185180664 moveto
278.4002380371094 -54.40024185180664 lineto
374.4002380371094 -54.40024185180664 lineto
374.4002380371094 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -57.40024185180664 moveto
278.4002380371094 -78.40023803710938 lineto
374.4002380371094 -78.40023803710938 lineto
374.4002380371094 -57.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -81.40023803710938 moveto
278.4002380371094 -98.40023803710938 lineto
278.4002380371094 -102.40023803710938 279.7335713704427 -104.40023803710938 282.4002380371094 -104.40023803710938 curveto
370.4002380371094 -104.40023803710938 lineto
370.4002380371094 -104.40023803710938 lineto
373.06690470377606 -104.40023803710938 374.4002380371094 -102.40023803710938 374.4002380371094 -98.40023803710938 curveto
374.4002380371094 -82.00023651123047 lineto
374.4002380371094 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -176.40023803710938 moveto
151.73357137044272 -176.40023803710938 150.40023803710938 -178.40023803710938 150.40023803710938 -182.40023803710938 curveto
150.40023803710938 -198.40023803710938 lineto
246.40023803710938 -198.40023803710938 lineto
246.40023803710938 -182.40023803710938 lineto
246.40023803710938 -178.40023803710938 245.06690470377603 -176.40023803710938 242.40023803710938 -176.40023803710938 curveto
154.40023803710938 -176.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -201.40023803710938 moveto
150.40023803710938 -222.40023803710938 lineto
246.40023803710938 -222.40023803710938 lineto
246.40023803710938 -201.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -225.40023803710938 moveto
150.40023803710938 -246.40023803710938 lineto
246.40023803710938 -246.40023803710938 lineto
246.40023803710938 -225.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -249.40023803710938 moveto
150.40023803710938 -266.4002380371094 lineto
150.40023803710938 -270.4002380371094 151.73357137044272 -272.4002380371094 154.40023803710938 -272.4002380371094 curveto
242.40023803710938 -272.4002380371094 lineto
242.40023803710938 -272.4002380371094 lineto
245.06690470377603 -272.4002380371094 246.40023803710938 -270.4002380371094 246.40023803710938 -266.4002380371094 curveto
246.40023803710938 -250.000244140625 lineto
246.40023803710938 -249.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -344.4002380371094 moveto
23.73357327779134 -344.4002380371094 22.400239944458008 -346.4002380371094 22.400239944458008 -350.4002380371094 curveto
22.400239944458008 -366.4002380371094 lineto
118.40023803710938 -366.4002380371094 lineto
118.40023803710938 -350.4002380371094 lineto
118.40023803710938 -346.4002380371094 117.06690470377605 -344.4002380371094 114.40023803710938 -344.4002380371094 curveto
26.400239944458008 -344.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -369.4002380371094 moveto
22.400239944458008 -390.4002380371094 lineto
118.40023803710938 -390.4002380371094 lineto
118.40023803710938 -369.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -393.4002380371094 moveto
22.400239944458008 -416.4002380371094 lineto
118.40023803710938 -416.4002380371094 lineto
118.40023803710938 -393.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -344.4002380371094 moveto
151.73357137044272 -344.4002380371094 150.40023803710938 -346.4002380371094 150.40023803710938 -350.4002380371094 curveto
150.40023803710938 -366.4002380371094 lineto
246.40023803710938 -366.4002380371094 lineto
246.40023803710938 -350.4002380371094 lineto
246.40023803710938 -346.4002380371094 245.06690470377603 -344.4002380371094 242.40023803710938 -344.4002380371094 curveto
154.40023803710938 -344.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -369.4002380371094 moveto
150.40023803710938 -390.4002380371094 lineto
246.40023803710938 -390.4002380371094 lineto
246.40023803710938 -369.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -393.4002380371094 moveto
150.40023803710938 -416.4002380371094 lineto
246.40023803710938 -416.4002380371094 lineto
246.40023803710938 -393.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -344.4002380371094 moveto
279.7335713704427 -344.4002380371094 278.4002380371094 -346.4002380371094 278.4002380371094 -350.4002380371094 curveto
278.4002380371094 -366.4002380371094 lineto
374.4002380371094 -366.4002380371094 lineto
374.4002380371094 -350.4002380371094 lineto
374.4002380371094 -346.4002380371094 373.06690470377606 -344.4002380371094 370.4002380371094 -344.4002380371094 curveto
282.4002380371094 -344.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -369.4002380371094 moveto
278.4002380371094 -390.4002380371094 lineto
374.4002380371094 -390.4002380371094 lineto
374.4002380371094 -369.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -393.4002380371094 moveto
278.4002380371094 -416.4002380371094 lineto
374.4002380371094 -416.4002380371094 lineto
374.4002380371094 -393.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -30.0 moveto
20.0 -52.0 lineto
116.0 -52.0 lineto
116.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -30.0 moveto
20.0 -52.0 lineto
116.0 -52.0 lineto
116.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -55.0 moveto
20.0 -76.0 lineto
116.0 -76.0 lineto
116.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -55.0 moveto
20.0 -76.0 lineto
116.0 -76.0 lineto
116.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -79.0 moveto
20.0 -96.0 lineto
20.0 -100.0 21.333333333333332 -102.0 24.0 -102.0 curveto
112.0 -102.0 lineto
112.0 -102.0 lineto
114.66666666666667 -102.0 116.0 -100.0 116.0 -96.0 curveto
116.0 -79.5999984741211 lineto
116.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -79.0 moveto
20.0 -96.0 lineto
20.0 -100.0 21.333333333333332 -102.0 24.0 -102.0 curveto
112.0 -102.0 lineto
112.0 -102.0 lineto
114.66666666666667 -102.0 116.0 -100.0 116.0 -96.0 curveto
116.0 -79.5999984741211 lineto
116.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -52.0 lineto
244.0 -52.0 lineto
244.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -52.0 lineto
244.0 -52.0 lineto
244.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -55.0 moveto
148.0 -76.0 lineto
244.0 -76.0 lineto
244.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -55.0 moveto
148.0 -76.0 lineto
244.0 -76.0 lineto
244.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -79.0 moveto
148.0 -96.0 lineto
148.0 -100.0 149.33333333333334 -102.0 152.0 -102.0 curveto
240.0 -102.0 lineto
240.0 -102.0 lineto
242.66666666666666 -102.0 244.0 -100.0 244.0 -96.0 curveto
244.0 -79.5999984741211 lineto
244.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -79.0 moveto
148.0 -96.0 lineto
148.0 -100.0 149.33333333333334 -102.0 152.0 -102.0 curveto
240.0 -102.0 lineto
240.0 -102.0 lineto
242.66666666666666 -102.0 244.0 -100.0 244.0 -96.0 curveto
244.0 -79.5999984741211 lineto
244.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -52.0 lineto
372.0 -52.0 lineto
372.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -52.0 lineto
372.0 -52.0 lineto
372.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -55.0 moveto
276.0 -76.0 lineto
372.0 -76.0 lineto
372.0 -55.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -55.0 moveto
276.0 -76.0 lineto
372.0 -76.0 lineto
372.0 -55.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -79.0 moveto
276.0 -96.0 lineto
276.0 -100.0 277.3333333333333 -102.0 280.0 -102.0 curveto
368.0 -102.0 lineto
368.0 -102.0 lineto
370.6666666666667 -102.0 372.0 -100.0 372.0 -96.0 curveto
372.0 -79.5999984741211 lineto
372.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -79.0 moveto
276.0 -96.0 lineto
276.0 -100.0 277.3333333333333 -102.0 280.0 -102.0 curveto
368.0 -102.0 lineto
368.0 -102.0 lineto
370.6666666666667 -102.0 372.0 -100.0 372.0 -96.0 curveto
372.0 -79.5999984741211 lineto
372.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -174.0 moveto
149.33333333333334 -174.0 148.0 -176.0 148.0 -180.0 curveto
148.0 -196.0 lineto
244.0 -196.0 lineto
244.0 -180.0 lineto
244.0 -176.0 242.66666666666666 -174.0 240.0 -174.0 curveto
152.0 -174.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -174.0 moveto
149.33333333333334 -174.0 148.0 -176.0 148.0 -180.0 curveto
148.0 -196.0 lineto
244.0 -196.0 lineto
244.0 -180.0 lineto
244.0 -176.0 242.66666666666666 -174.0 240.0 -174.0 curveto
152.0 -174.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -199.0 moveto
148.0 -220.0 lineto
244.0 -220.0 lineto
244.0 -199.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -199.0 moveto
148.0 -220.0 lineto
244.0 -220.0 lineto
244.0 -199.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -223.0 moveto
148.0 -244.0 lineto
244.0 -244.0 lineto
244.0 -223.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -223.0 moveto
148.0 -244.0 lineto
244.0 -244.0 lineto
244.0 -223.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -247.0 moveto
148.0 -264.0 lineto
148.0 -268.0 149.33333333333334 -270.0 152.0 -270.0 curveto
240.0 -270.0 lineto
240.0 -270.0 lineto
242.66666666666666 -270.0 244.0 -268.0 244.0 -264.0 curveto
244.0 -247.60000610351562 lineto
244.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -247.0 moveto
148.0 -264.0 lineto
148.0 -268.0 149.33333333333334 -270.0 152.0 -270.0 curveto
240.0 -270.0 lineto
240.0 -270.0 lineto
242.66666666666666 -270.0 244.0 -268.0 244.0 -264.0 curveto
244.0 -247.60000610351562 lineto
244.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -342.0 moveto
21.333333333333332 -342.0 20.0 -344.0 20.0 -348.0 curveto
20.0 -364.0 lineto
116.0 -364.0 lineto
116.0 -348.0 lineto
116.0 -344.0 114.66666666666667 -342.0 112.0 -342.0 curveto
24.0 -342.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -342.0 moveto
21.333333333333332 -342.0 20.0 -344.0 20.0 -348.0 curveto
20.0 -364.0 lineto
116.0 -364.0 lineto
116.0 -348.0 lineto
116.0 -344.0 114.66666666666667 -342.0 112.0 -342.0 curveto
24.0 -342.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -367.0 moveto
20.0 -388.0 lineto
116.0 -388.0 lineto
116.0 -367.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -367.0 moveto
20.0 -388.0 lineto
116.0 -388.0 lineto
116.0 -367.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -391.0 moveto
20.0 -414.0 lineto
116.0 -414.0 lineto
116.0 -391.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -391.0 moveto
20.0 -414.0 lineto
116.0 -414.0 lineto
116.0 -391.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -342.0 moveto
149.33333333333334 -342.0 148.0 -344.0 148.0 -348.0 curveto
148.0 -364.0 lineto
244.0 -364.0 lineto
244.0 -348.0 lineto
244.0 -344.0 242.66666666666666 -342.0 240.0 -342.0 curveto
152.0 -342.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -342.0 moveto
149.33333333333334 -342.0 148.0 -344.0 148.0 -348.0 curveto
148.0 -364.0 lineto
244.0 -364.0 lineto
244.0 -348.0 lineto
244.0 -344.0 242.66666666666666 -342.0 240.0 -342.0 curveto
152.0 -342.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -367.0 moveto
148.0 -388.0 lineto
244.0 -388.0 lineto
244.0 -367.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -367.0 moveto
148.0 -388.0 lineto
244.0 -388.0 lineto
244.0 -367.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -391.0 moveto
148.0 -414.0 lineto
244.0 -414.0 lineto
244.0 -391.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -391.0 moveto
148.0 -414.0 lineto
244.0 -414.0 lineto
244.0 -391.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -342.0 moveto
277.3333333333333 -342.0 276.0 -344.0 276.0 -348.0 curveto
276.0 -364.0 lineto
372.0 -364.0 lineto
372.0 -348.0 lineto
372.0 -344.0 370.6666666666667 -342.0 368.0 -342.0 curveto
280.0 -342.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -342.0 moveto
277.3333333333333 -342.0 276.0 -344.0 276.0 -348.0 curveto
276.0 -364.0 lineto
372.0 -364.0 lineto
372.0 -348.0 lineto
372.0 -344.0 370.6666666666667 -342.0 368.0 -342.0 curveto
280.0 -342.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -367.0 moveto
276.0 -388.0 lineto
372.0 -388.0 lineto
372.0 -367.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -367.0 moveto
276.0 -388.0 lineto
372.0 -388.0 lineto
372.0 -367.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -391.0 moveto
276.0 -414.0 lineto
372.0 -414.0 lineto
372.0 -391.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -391.0 moveto
276.0 -414.0 lineto
372.0 -414.0 lineto
372.0 -391.0 lineto
closepath
stroke
newpath
68.0 -108.0 moveto
64.0 -120.0 lineto
72.0 -120.0 lineto
closepath
fill
newpath
196.0 -108.0 moveto
192.0 -120.0 lineto
200.0 -120.0 lineto
closepath
fill
newpath
324.0 -108.0 moveto
320.0 -120.0 lineto
328.0 -120.0 lineto
closepath
fill
newpath
192.0 -156.0 moveto
196.0 -168.0 lineto
200.0 -156.0 lineto
closepath
fill
newpath
196.0 -276.0 moveto
192.0 -288.0 lineto
200.0 -288.0 lineto
closepath
fill
newpath
64.0 -324.0 moveto
68.0 -336.0 lineto
72.0 -324.0 lineto
closepath
fill
newpath
192.0 -324.0 moveto
196.0 -336.0 lineto
200.0 -324.0 lineto
closepath
fill
newpath
320.0 -324.0 moveto
324.0 -336.0 lineto
328.0 -324.0 lineto
closepath
fill
newpath
68.0 -114.0 moveto
68.0 -132.0 lineto
68.0 -136.0 69.33333333333333 -138.0 72.0 -138.0 curveto
196.0 -138.0 lineto
196.0 -138.0 lineto
stroke
newpath
196.0 -114.0 moveto
196.0 -138.0 lineto
stroke
newpath
324.0 -114.0 moveto
324.0 -132.0 lineto
324.0 -136.0 322.6666666666667 -138.0 320.0 -138.0 curveto
196.0 -138.0 lineto
196.0 -138.0 lineto
stroke
newpath
196.0 -162.0 moveto
196.0 -138.0 lineto
stroke
newpath
196.0 -282.0 moveto
196.0 -306.0 lineto
stroke
newpath
68.0 -330.0 moveto
68.0 -312.0 lineto
68.0 -308.0 69.33333333333333 -306.0 72.0 -306.0 curveto
196.0 -306.0 lineto
196.0 -306.0 lineto
stroke
newpath
196.0 -330.0 moveto
196.0 -306.0 lineto
stroke
newpath
324.0 -330.0 moveto
324.0 -312.0 lineto
324.0 -308.0 322.6666666666667 -306.0 320.0 -306.0 curveto
196.0 -306.0 lineto
196.0 -306.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
43.0 -47.0 moveto
(Client) show
171.0 -47.0 moveto
(Client) show
299.0 -47.0 moveto
(Client) show
49.0 -71.0 moveto
(Retry) show
177.0 -71.0 moveto
(Retry) show
305.0 -71.0 moveto
(Retry) show
57.0 -94.0 moveto
(REQ) show
185.0 -94.0 moveto
(REQ) show
313.0 -94.0 moveto
(REQ) show
170.0 -190.0 moveto
(ROUTER) show
178.0 -214.0 moveto
(Queue) show
164.0 -238.0 moveto
(Heartbeat) show
170.0 -262.0 moveto
(ROUTER) show
43.0 -358.0 moveto
(DEALER) show
171.0 -358.0 moveto
(DEALER) show
299.0 -358.0 moveto
(DEALER) show
36.0 -382.0 moveto
(Heartbeat) show
164.0 -382.0 moveto
(Heartbeat) show
292.0 -382.0 moveto
(Heartbeat) show
49.0 -406.0 moveto
(Worker) show
177.0 -406.0 moveto
(Worker) show
305.0 -406.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3914 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3914 a 274 x Fj(W)-7 b(e')l(re)21
b(still)g(using)f(the)g(Lazy)g(Pirate)g(client.)g(Here)g(is)h(the)f(P)o
(aranoid)f(Pirate)h(queue)f(de)n(vice:)-2 4206 y
SDict begin H.S end
 -2 4206
a -2 4206 a
SDict begin 13 H.A end
 -2 4206 a -2 4206 a
SDict begin [/View [/XYZ H.V]/Dest (0:ppqueue-php) cvn /DEST pdfmark
end
 -2 4206 a 396 4389 a
Fk(Example)i(4-5.)e(P)o(aranoid)g(Pirate)h(queue)h(\(ppqueue.php\))-2
4489 y
SDict begin H.S end
 -2 4489 a -2 4489 a
SDict begin 11.7 H.A end
 -2 4489 a -2 4489 a
SDict begin [/View [/XYZ H.V]/Dest (0:2097) cvn /DEST pdfmark end
 -2 4489
a 396 4569 a Fg(<?php)396 4666 y(/)441 4679 y(*)441 4777
y(*)531 4764 y(Paranoid)43 b(Pirate)h(queue)441 4874
y(*)441 4971 y(*)531 4958 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 5068 y(*)486
5055 y(/)396 5152 y(include)g("zmsg.php";)p Black 3759
5569 a Fi(158)p Black eop end
%%Page: 159 173
TeXDict begin 159 172 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.159) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 170 a Fg(define\("MAX_WORKERS",)42
b(100\);)396 267 y(define\("HEARTBEAT_LIVENESS",)e(3\);)45
b(//)89 b(3-5)44 b(is)h(reasonable)396 364 y
(define\("HEARTBEAT_INTERVAL",)40 b(1\);)45 b(//)89 b(secs)396
655 y(class)44 b(Queue_T)g(implements)f(Iterator{)441
752 y(private)h($queue)g(=)g(array\(\);)441 947 y(/)486
960 y(*)576 947 y(Iterator)f(functions)1427 960 y(*)1472
947 y(/)441 1044 y(public)h(function)f(rewind\(\))h({)h(return)e
(reset\($this->queue\);)f(})441 1141 y(public)i(function)f(valid\(\))h
({)h(return)f(current\($this->queue\);)d(})441 1238 y(public)j
(function)f(key\(\))h({)h(return)f(key\($this->queue\);)e(})441
1335 y(public)i(function)f(next\(\))h({)h(return)f
(next\($this->queue\);)d(})441 1432 y(public)j(function)f(current\(\))h
({)g(return)g(current\($this->queue\);)d(})441 1627 y(/)486
1640 y(*)486 1737 y(*)576 1724 y(Insert)i(worker)h(at)h(end)f(of)h
(queue,)e(reset)h(expiry)486 1834 y(*)576 1821 y(Worker)f(must)i(not)f
(already)g(be)g(in)h(queue)486 1931 y(*)531 1918 y(/)441
2015 y(public)f(function)f(s_worker_append\($identity\))e({)486
2112 y(if\(isset\($this->queue[$identity]\)\))e({)531
2209 y(printf)44 b(\("E:)g(duplicate)f(worker)h(identity)f(\045s",)i
($identity\);)486 2307 y(})g(else)f({)531 2404 y
($this->queue[$identity])d(=)j(microtime\(true\))f(+)h
(HEARTBEAT_INTERVAL)3355 2417 y(*)3445 2404 y(HEARTBEAT_LIVENESS;)486
2501 y(})441 2598 y(})441 2792 y(/)486 2805 y(*)486 2902
y(*)576 2889 y(Remove)f(worker)h(from)g(queue,)g(if)h(present)486
3000 y(*)531 2987 y(/)441 3084 y(public)f(function)f
(s_worker_delete\($identity\))e({)486 3181 y
(unset\($this->queue[$identity]\);)441 3278 y(})441 3472
y(/)486 3485 y(*)486 3582 y(*)576 3569 y(Reset)j(worker)f(expiry,)h
(worker)g(must)g(be)h(present)486 3679 y(*)531 3666 y(/)441
3764 y(function)f(s_worker_refresh\($identity\))c({)486
3861 y(if\(!isset\($this->queue[$identity]\)\))f({)531
3958 y(printf)44 b(\("E:)g(worker)g(\045s)g(not)g(ready\\n",)g
($identity\);)486 4055 y(})h(else)f({)531 4152 y
($this->queue[$identity])d(=)j(microtime\(true\))f(+)h
(HEARTBEAT_INTERVAL)3355 4165 y(*)3445 4152 y(HEARTBEAT_LIVENESS;)486
4249 y(})441 4346 y(})441 4541 y(/)486 4554 y(*)486 4651
y(*)576 4638 y(Pop)g(next)g(available)f(worker)h(off)h(queue,)e(return)
h(identity)486 4748 y(*)531 4735 y(/)441 4832 y(public)g(function)f
(s_worker_dequeue\(\))f({)486 4929 y(reset\($this->queue\);)486
5026 y($identity)h(=)i(key\($this->queue\);)486 5124
y(unset\($this->queue[$identity]\);)p Black 3759 5569
a Fi(159)p Black eop end
%%Page: 160 174
TeXDict begin 160 173 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.160) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 486 72 a Fg(return)44 b($identity;)441
170 y(})441 364 y(/)486 377 y(*)486 474 y(*)576 461 y(Look)g(for)g(&)h
(kill)f(expired)g(workers)486 571 y(*)531 558 y(/)441
655 y(public)g(function)f(s_queue_purge\(\))g({)486 752
y(foreach\($this->queue)e(as)k($id)f(=>)h($expiry\))e({)531
850 y(if\(microtime\(true\))f(>)i($expiry\))g({)576 947
y(unset\($this->queue[$id]\);)531 1044 y(})486 1141 y(})441
1238 y(})441 1432 y(/)486 1445 y(*)486 1543 y(*)576 1530
y(Return)f(the)i(size)f(of)g(the)h(queue)486 1640 y(*)531
1627 y(/)441 1724 y(public)f(function)f(size\(\))h({)486
1821 y(return)g(count\($this->queue\);)441 1918 y(})396
2015 y(})396 2209 y(//)90 b(Prepare)43 b(our)i(context)e(and)i(sockets)
396 2307 y($context)f(=)g(new)h(ZMQContext\(\);)396 2404
y($frontend)f(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_ROUTER\);)
396 2501 y($backend)j(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_ROUTER\);)396 2598 y($frontend->bind\("tcp://)1431
2611 y(*)1476 2598 y(:5555"\);)174 b(//)90 b(For)44 b(clients)396
2695 y($backend->bind\("tcp://)1386 2708 y(*)1431 2695
y(:5556"\);)174 b(//)90 b(For)44 b(workers)396 2792 y($read)g(=)h
($write)f(=)g(array\(\);)396 2987 y(//)90 b(Queue)44
b(of)g(available)f(workers)396 3084 y($queue)h(=)h(new)f(Queue_T\(\);)
396 3278 y(//)90 b(Send)44 b(out)g(heartbeats)f(at)i(regular)e
(intervals)396 3375 y($heartbeat_at)g(=)i(microtime\(true\))d(+)89
b(HEARTBEAT_INTERVAL;)396 3569 y(while\(true\))43 b({)441
3666 y($poll)h(=)h(new)f(ZMQPoll\(\);)441 3764 y($poll->add\($backend,)
e(ZMQ::POLL_IN\);)441 3958 y(//)89 b(Poll)45 b(frontend)e(only)h(if)h
(we)f(have)g(available)g(workers)441 4055 y(if\($queue->size\(\)\))e({)
486 4152 y($poll->add\($frontend,)f(ZMQ::POLL_IN\);)441
4249 y(})441 4444 y($events)j(=)g($poll->poll\($read,)e($write,)i
(HEARTBEAT_INTERVAL)2952 4457 y(*)3041 4444 y(1000)h(\);)f(//)g
(milliseconds)441 4638 y(if\($events)f(>)i(0\))f({)486
4735 y(foreach\($read)f(as)h($socket\))g({)531 4832 y($zmsg)g(=)g(new)h
(Zmsg\($socket\);)531 4929 y($zmsg->recv\(\);)531 5124
y(//)89 b(Handle)44 b(worker)g(activity)f(on)i(backend)p
Black 3759 5569 a Fi(160)p Black eop end
%%Page: 161 175
TeXDict begin 161 174 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.161) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 531 72 a Fg(if\($socket)43 b(===)h($backend\))g({)576
170 y($identity)f(=)i($zmsg->unwrap\(\);)576 364 y(//)89
b(Return)44 b(reply)g(to)g(client)g(if)h(it's)f(not)g(a)h(control)e
(message)576 461 y(if\($zmsg->parts\(\))f(==)i(1\))h({)620
558 y(if\($zmsg->address\(\))d(==)j("READY"\))e({)665
655 y($queue->s_worker_delete\($identity\);)665 752 y
($queue->s_worker_append\($identity\);)665 850 y(})i(else)f
(if\($zmsg->address\(\))e(==)i('HEARTBEAT'\))f({)665
947 y($queue->s_worker_refresh\($identity\);)620 1044
y(})i(else)f({)665 1141 y(printf)g(\("E:)g(invalid)g(message)g(from)g
(\045s\045s\045s",)f($identity,)g(PHP_EOL,)h($zmsg->__toString\(\)\);)
620 1238 y(})576 1335 y(})g(else)g({)620 1432 y
($zmsg->set_socket\($frontend\)->send\(\);)620 1530 y
($queue->s_worker_append\($identity\);)576 1627 y(})531
1724 y(})g(else)h({)576 1821 y(//)89 b(Now)44 b(get)h(next)f(client)g
(request,)f(route)h(to)h(next)f(worker)576 1918 y($identity)f(=)i
($queue->s_worker_dequeue\(\);)576 2015 y($zmsg->wrap\($identity\);)576
2112 y($zmsg->set_socket\($backend\)->send\(\);)531 2209
y(})486 2307 y(})486 2501 y(if\(microtime\(true\))d(>)i
($heartbeat_at\))f({)531 2598 y(foreach\($queue)f(as)j($id)f(=>)h
($expiry\))e({)576 2695 y($zmsg)h(=)g(new)h(Zmsg\($backend\);)576
2792 y($zmsg->body_set\("HEARTBEAT"\);)576 2889 y
($zmsg->wrap\($identity,)c(NULL\);)576 2987 y($zmsg->send\(\);)531
3084 y(})531 3181 y($heartbeat_at)h(=)j(microtime\(true\))d(+)j
(HEARTBEAT_INTERVAL;)486 3278 y(})486 3375 y
($queue->s_queue_purge\(\);)441 3472 y(})-2 3646 y
SDict begin H.S end
 -2
3646 a -2 3646 a
SDict begin 13 H.A end
 -2 3646 a -2 3646 a
SDict begin [/View [/XYZ H.V]/Dest (0:2098) cvn /DEST pdfmark end
 -2 3646 a 396 3746
a Fj(The)20 b(queue)f(e)o(xtends)g(the)h(LR)m(U)h(pattern)e(with)i
(heartbeating)d(of)i(w)o(ork)o(ers.)f(Heartbeating)f(is)k(one)d(of)h
(those)g(')-5 b(simple')396 3854 y(things)20 b(that)g(can)g(be)g
(subtle)h(to)f(get)g(right.)f(I')o(ll)i(e)o(xplain)e(more)g(about)g
(that)i(in)f(a)h(second.)-2 4038 y
SDict begin H.S end
 -2 4038 a -2 4038
a
SDict begin 13 H.A end
 -2 4038 a -2 4038 a
SDict begin [/View [/XYZ H.V]/Dest (0:2099) cvn /DEST pdfmark end
 -2 4038 a 396 4128 a Fj(Here)f(is)h(the)g(P)o
(aranoid)d(Pirate)j(w)o(ork)o(er:)-2 4129 y
SDict begin H.S end
 -2 4129 a
-2 4129 a
SDict begin 13 H.A end
 -2 4129 a -2 4129 a
SDict begin [/View [/XYZ H.V]/Dest (0:ppworker-php) cvn /DEST pdfmark
end
 -2 4129 a 396 4329 a Fk(Example)g(4-6.)e
(P)o(aranoid)g(Pirate)h(w)o(ork)o(er)g(\(ppw)o(ork)o(er)-8
b(.php\))-2 4429 y
SDict begin H.S end
 -2 4429 a -2 4429 a
SDict begin 11.7 H.A end
 -2 4429 a -2 4429
a
SDict begin [/View [/XYZ H.V]/Dest (0:2102) cvn /DEST pdfmark end
 -2 4429 a 396 4510 a Fg(<?php)396 4607 y(/)441 4620
y(*)441 4717 y(*)531 4704 y(Paranoid)43 b(Pirate)h(worker)441
4814 y(*)441 4911 y(*)531 4898 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 5008 y(*)486
4995 y(/)396 5092 y(include)g("zmsg.php";)p Black 3759
5569 a Fi(161)p Black eop end
%%Page: 162 176
TeXDict begin 162 175 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.162) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 170 a Fg(define\("HEARTBEAT_LIVENESS",)40
b(3\);)45 b(//)89 b(3-5)44 b(is)h(reasonable)396 267
y(define\("HEARTBEAT_INTERVAL",)40 b(1\);)45 b(//)89
b(secs)396 364 y(define\("INTERVAL_INIT",)41 b(1000\);)j(//)89
b(Initial)44 b(reconnect)396 461 y(define\("INTERVAL_MAX",)d(32000\);)j
(//)89 b(After)44 b(exponential)f(backoff)396 655 y(/)441
668 y(*)441 765 y(*)531 752 y(Helper)h(function)f(that)h(returns)g(a)h
(new)f(configured)f(socket)441 863 y(*)531 850 y(connected)g(to)i(the)f
(Hello)g(World)g(server)441 960 y(*)486 947 y(/)396 1044
y(function)g(s_worker_socket\($context\))c({)441 1141
y($worker)k(=)g(new)h(ZMQSocket\($context,)c(ZMQ::SOCKET_DEALER\);)441
1335 y(//)89 b(Set)45 b(random)f(identity)f(to)i(make)f(tracing)f
(easier)441 1432 y($identity)g(=)i(sprintf)f(\("\04504X-\04504X",)e
(rand\(0,)i(0x10000\),)f(rand\(0,)h(0x10000\)\);)441
1530 y($worker->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)39
b($identity\);)441 1627 y($worker->connect\("tcp://localhost:5556"\))o
(;)441 1821 y(//)89 b(Configure)44 b(socket)g(to)g(not)g(wait)h(at)f
(close)g(time)441 1918 y($worker->setSockOpt\(ZMQ::SOCKOPT_LINGER,)38
b(0\);)576 2112 y(//)89 b(Tell)44 b(queue)g(we're)g(ready)g(for)g(work)
576 2209 y(printf)f(\("I:)i(\(\045s\))f(worker)g(ready\045s",)f
($identity,)g(PHP_EOL\);)441 2307 y($worker->send\("READY"\);)441
2501 y(return)h(array\($worker,)e($identity\);)396 2598
y(})396 2792 y($context)i(=)g(new)h(ZMQContext\(\);)396
2889 y(list\($worker,)e($identity\))g(=)i(s_worker_socket\($context\);)
396 3084 y(//)90 b(If)44 b(liveness)g(hits)g(zero,)g(queue)g(is)g
(considered)f(disconnected)396 3181 y($liveness)h(=)g
(HEARTBEAT_LIVENESS;)396 3278 y($interval)g(=)g(INTERVAL_INIT;)396
3569 y(//)90 b(Send)44 b(out)g(heartbeats)f(at)i(regular)e(intervals)
396 3666 y($heartbeat_at)g(=)i(microtime\(true\))d(+)j
(HEARTBEAT_INTERVAL;)396 3764 y($read)f(=)h($write)f(=)g(array\(\);)396
3861 y($poll)g(=)h(new)f(ZMQPoll\(\);)396 3958 y($poll->add\($worker,)e
(ZMQ::POLL_IN\);)396 4152 y($cycles)i(=)h(0;)396 4249
y(while\(true\))e({)441 4346 y($events)h(=)g($poll->poll\($read,)e
($write,)i(HEARTBEAT_INTERVAL)2952 4359 y(*)3041 4346
y(1000\);)441 4541 y(if\($events\))f({)486 4638 y(//)89
b(Get)45 b(message)486 4735 y(//)89 b(-)45 b(3-part)f(envelope)f(+)i
(content)f(->)g(request)486 4832 y(//)89 b(-)45 b(1-part)f("HEARTBEAT")
f(->)h(heartbeat)486 4929 y($zmsg)g(=)h(new)f(Zmsg\($worker\);)486
5026 y($zmsg->recv\(\);)p Black 3759 5569 a Fi(162)p
Black eop end
%%Page: 163 177
TeXDict begin 163 176 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.163) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 486 72 a Fg(if\($zmsg->parts\(\))42
b(==)i(3\))h({)531 170 y(//)89 b(Simulate)44 b(various)f(problems,)h
(after)g(a)g(few)h(cycles)531 267 y($cycles++;)531 364
y(if\($cycles)e(>)i(3)f(&&)h(rand\(0,)e(5\))i(==)f(0\))h({)576
461 y(printf)e(\("I:)i(\(\045s\))f(simulating)f(a)i(crash\045s",)e
($identity,)g(PHP_EOL\);)576 558 y(break;)531 655 y(})h(else)h
(if\($cycles)e(>)h(3)h(&&)g(rand\(0,)e(5\))i(==)f(0\))h({)576
752 y(printf)e(\("I:)i(\(\045s\))f(simulating)f(CPU)h(overload\045s",)f
($identity,)g(PHP_EOL\);)576 850 y(sleep\(5\);)531 947
y(})531 1044 y(printf)h(\("I:)g(\(\045s\))g(normal)g(reply)g(-)g
(\045s\045s",)g($identity,)f($zmsg->body\(\),)g(PHP_EOL\);)531
1141 y($zmsg->send\(\);)531 1238 y($liveness)g(=)i(HEARTBEAT_LIVENESS;)
531 1335 y(sleep\(1\);)e(//)i(Do)f(some)g(heavy)g(work)486
1432 y(})h(else)f(if\($zmsg->parts\(\))e(==)i(1)h(&&)f($zmsg->body\(\))
f(==)i('HEARTBEAT'\){)531 1530 y($liveness)e(=)i(HEARTBEAT_LIVENESS;)
486 1627 y(})g(else)f({)531 1724 y(printf)g(\("E:)g(\(\045s\))g
(invalid)g(message\045s\045s",)e($identity,)h(PHP_EOL,)h
($zmsg->__toString\(\)\);)486 1821 y(})486 1918 y($interval)f(=)i
(INTERVAL_INIT;)441 2015 y(})g(else)f(if\(--$liveness)e(==)j(0\))f({)
486 2112 y(printf)g(\("W:)g(\(\045s\))g(heartbeat)f(failure,)h(can't)g
(reach)g(queue\045s",)f($identity,)g(PHP_EOL\);)486 2209
y(printf)h(\("W:)g(\(\045s\))g(reconnecting)f(in)h(\045d)h
(msec...\045s",)e($identity,)g($interval,)g(PHP_EOL\);)486
2307 y(usleep)h(\($interval)1293 2320 y(*)1383 2307 y(1000)1607
2320 y(*)1696 2307 y(1000\);)486 2501 y(if)g(\($interval)g(<)g
(INTERVAL_MAX\))f({)531 2598 y($interval)979 2611 y(*)1024
2598 y(=)i(2;)486 2695 y(})486 2792 y(list\($worker,)e($identity\))g(=)
h(s_worker_socket)f(\($context\);)755 2889 y($liveness)g(=)i
(HEARTBEAT_LIVENESS;)441 2987 y(})441 3181 y(//)89 b(Send)45
b(heartbeat)e(to)h(queue)g(if)h(it's)f(time)441 3278
y(if\(microtime\(true\))e(>)j($heartbeat_at\))d({)486
3375 y($heartbeat_at)h(=)h(microtime\(true\))f(+)h(HEARTBEAT_INTERVAL;)
486 3472 y(printf)g(\("I:)g(\(\045s\))g(worker)g(heartbeat\045s",)f
($identity,)g(PHP_EOL\);)486 3569 y($worker->send\("HEARTBEAT"\);)441
3666 y(})396 3764 y(})-2 3938 y
SDict begin H.S end
 -2 3938 a -2 3938 a
SDict begin 13 H.A end
 -2
3938 a -2 3938 a
SDict begin [/View [/XYZ H.V]/Dest (0:2103) cvn /DEST pdfmark end
 -2 3938 a 396 4038 a Fj(Some)20 b(comments)f(about)g
(this)i(e)o(xample:)-2 4056 y
SDict begin H.S end
 -2 4056 a -2 4056 a
SDict begin 13 H.A end
 -2
4056 a -2 4056 a
SDict begin [/View [/XYZ H.V]/Dest (0:2104) cvn /DEST pdfmark end
 -2 4056 a -2 4066 a
SDict begin H.S end
 -2 4066 a -2 4066
a
SDict begin 13 H.A end
 -2 4066 a -2 4066 a
SDict begin [/View [/XYZ H.V]/Dest (0:2105) cvn /DEST pdfmark end
 -2 4066 a Black 396 4208 a Fe(\225)p
Black 479 4208 a
SDict begin H.S end
 479 4208 a 479 4208 a
SDict begin 13 H.A end
 479 4208 a 479
4208 a
SDict begin [/View [/XYZ H.V]/Dest (0:2106) cvn /DEST pdfmark end
 479 4208 a Fj(The)f(code)g(includes)f(simulation)g(of)h(f)o
(ailures,)g(as)h(before.)d(This)j(mak)o(es)f(it)h(\(a\))f(v)o(ery)f
(hard)g(to)h(deb)n(ug,)f(and)h(\(b\))479 4316 y(dangerous)e(to)j
(reuse.)e(When)h(you)g(w)o(ant)g(to)g(deb)n(ug)f(this,)i(disable)f(the)
g(f)o(ailure)f(simulation.)-2 4334 y
SDict begin H.S end
 -2 4334 a -2 4334
a
SDict begin 13 H.A end
 -2 4334 a -2 4334 a
SDict begin [/View [/XYZ H.V]/Dest (0:2107) cvn /DEST pdfmark end
 -2 4334 a Black 396 4465 a Fe(\225)p
Black 479 4465 a
SDict begin H.S end
 479 4465 a 479 4465 a
SDict begin 13 H.A end
 479 4465 a 479
4465 a
SDict begin [/View [/XYZ H.V]/Dest (0:2108) cvn /DEST pdfmark end
 479 4465 a Fj(The)h(w)o(ork)o(er)f(uses)i(a)g(reconnect)d
(strate)o(gy)h(similar)i(to)f(the)g(one)g(we)h(designed)e(for)g(the)h
(Lazy)g(Pirate)g(client.)g(W)m(ith)479 4573 y(tw)o(o)h(major)e(dif)n
(ferences:)g(\(a\))h(it)h(does)e(an)i(e)o(xponential)c(back-of)n(f,)h
(and)i(\(b\))f(it)i(ne)n(v)o(er)e(abandons.)-2 4757 y
SDict begin H.S end

-2 4757 a -2 4757 a
SDict begin 13 H.A end
 -2 4757 a -2 4757 a
SDict begin [/View [/XYZ H.V]/Dest (0:2109) cvn /DEST pdfmark end
 -2 4757 a 396
4847 a Fj(T)m(ry)h(the)g(client,)g(queue,)f(and)h(w)o(ork)o(ers,)f
(e.g.)g(using)h(a)h(script)f(lik)o(e)g(this:)-2 4948
y
SDict begin H.S end
 -2 4948 a -2 4948 a
SDict begin 11.7 H.A end
 -2 4948 a -2 4948 a
SDict begin [/View [/XYZ H.V]/Dest (0:2110) cvn /DEST pdfmark end
 -2 4948 a 396
5027 a Fg(ppqueue)44 b(&)396 5124 y(for)h(i)f(in)h(1)f(2)h(3)g(4;)f(do)
p Black 3759 5569 a Fi(163)p Black eop end
%%Page: 164 178
TeXDict begin 164 177 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.164) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 72 a Fg(ppworker)43 b(&)576 170
y(sleep)h(1)396 267 y(done)396 364 y(lpclient)g(&)-2
541 y
SDict begin H.S end
 -2 541 a -2 541 a
SDict begin 13 H.A end
 -2 541 a -2 541 a
SDict begin [/View [/XYZ H.V]/Dest (0:2111) cvn /DEST pdfmark end
 -2 541 a 396
638 a Fj(Y)-9 b(ou)20 b(should)f(see)i(the)f(w)o(ork)o(ers)g(die,)f
(one)h(by)g(one,)f(as)i(the)o(y)f(simulate)g(a)g(crash,)g(and)g(the)g
(client)g(e)n(v)o(entually)e(gi)n(v)o(e)i(up.)396 746
y(Y)-9 b(ou)20 b(can)g(stop)g(and)g(restart)g(the)g(queue)f(and)h(both)
f(client)h(and)g(w)o(ork)o(ers)f(will)i(reconnect)e(and)g(carry)h(on.)f
(And)h(no)396 854 y(matter)g(what)g(you)g(do)f(to)i(queues)e(and)h(w)o
(ork)o(ers,)f(the)h(client)g(will)h(ne)n(v)o(er)e(get)h(an)g
(out-of-order)d(reply:)i(the)i(whole)396 962 y(chain)f(either)g(w)o
(orks,)f(or)h(the)g(client)h(abandons.)-2 984 y
SDict begin H.S end
 -2 984
a -2 984 a
SDict begin 13 H.A end
 -2 984 a -2 984 a
SDict begin [/View [/XYZ H.V]/Dest (0:2112) cvn /DEST pdfmark end
 -2 984 a 365 x Fh(4.6.)39
b(Hear)s(tbeating)1160 1349 y
SDict begin H.S end
 1160 1349 a 1160 1349 a
SDict begin 22.464 H.A end

1160 1349 a 1160 1349 a
SDict begin [/View [/XYZ H.V]/Dest (9.45.1) cvn /DEST pdfmark end
 1160 1349 a -2 1547 a
SDict begin H.S end
 -2 1547
a -2 1547 a
SDict begin 13 H.A end
 -2 1547 a -2 1547 a
SDict begin [/View [/XYZ H.V]/Dest (0:2114) cvn /DEST pdfmark end
 -2 1547 a 396 1623 a
Fj(When)20 b(writing)g(the)g(P)o(aranoid)f(Pirate)h(e)o(xamples,)f(it)i
(took)e(about)h(\002)n(v)o(e)f(hours)h(to)g(get)g(the)g(queue-to-w)o
(ork)o(er)396 1731 y(heartbeating)d(w)o(orking)f(properly)-5
b(.)16 b(The)i(rest)h(of)f(the)h(request-reply)d(chain)h(took)h
(perhaps)f(ten)i(minutes.)e(Heartbeating)396 1839 y(is)k(one)f(of)g
(those)g(reliability)f(layers)h(that)g(often)g(causes)g(more)f(trouble)
g(than)h(it)h(sa)n(v)o(es.)f(It)h(is)g(especially)e(easy)i(to)f(create)
396 1947 y('f)o(alse)h(f)o(ailures',)e(i.e.)h(peers)g(decide)f(that)i
(the)o(y)e(are)h(disconnected)f(because)g(the)h(heartbeats)g(aren')o(t)
e(sent)j(properly)-5 b(.)-2 2131 y
SDict begin H.S end
 -2 2131 a -2 2131
a
SDict begin 13 H.A end
 -2 2131 a -2 2131 a
SDict begin [/View [/XYZ H.V]/Dest (0:2115) cvn /DEST pdfmark end
 -2 2131 a 396 2221 a Fj(Some)20
b(points)g(to)g(consider)f(when)h(understanding)d(and)j(implementing)e
(heartbeating:)-2 2239 y
SDict begin H.S end
 -2 2239 a -2 2239 a
SDict begin 13 H.A end
 -2 2239
a -2 2239 a
SDict begin [/View [/XYZ H.V]/Dest (0:2116) cvn /DEST pdfmark end
 -2 2239 a -2 2249 a
SDict begin H.S end
 -2 2249 a -2 2249 a
SDict begin 13 H.A end
 -2
2249 a -2 2249 a
SDict begin [/View [/XYZ H.V]/Dest (0:2117) cvn /DEST pdfmark end
 -2 2249 a Black 396 2391 a Fe(\225)p
Black 479 2391 a
SDict begin H.S end
 479 2391 a 479 2391 a
SDict begin 13 H.A end
 479 2391 a 479
2391 a
SDict begin [/View [/XYZ H.V]/Dest (0:2118) cvn /DEST pdfmark end
 479 2391 a Fj(Note)i(that)h(heartbeats)e(are)h(not)g
(request-reply)-5 b(.)17 b(The)o(y)i(\003o)n(w)i(asynchronously)16
b(in)21 b(both)e(directions.)g(Either)h(peer)479 2499
y(can)g(decide)g(the)g(other)f(is)i(')l(dead')e(and)h(stop)g(talking)f
(to)i(it.)-2 2517 y
SDict begin H.S end
 -2 2517 a -2 2517 a
SDict begin 13 H.A end
 -2 2517 a -2
2517 a
SDict begin [/View [/XYZ H.V]/Dest (0:2119) cvn /DEST pdfmark end
 -2 2517 a Black 396 2648 a Fe(\225)p Black 479
2648 a
SDict begin H.S end
 479 2648 a 479 2648 a
SDict begin 13 H.A end
 479 2648 a 479 2648 a
SDict begin [/View [/XYZ H.V]/Dest (0:2120) cvn /DEST pdfmark end
 479
2648 a Fj(First,)g(get)f(the)g(heartbeating)f(w)o(orking,)f(and)i(only)
1975 2648 y
SDict begin H.S end
 1975 2648 a 1975 2648 a
SDict begin 13 H.A end
 1975 2648 a 1975
2648 a
SDict begin [/View [/XYZ H.V]/Dest (0:2121) cvn /DEST pdfmark end
 1975 2648 a Fi(then)g Fj(add)f(in)i(the)f(rest)h(of)e(the)i
(message)f(\003o)n(w)-5 b(.)19 b(Y)-9 b(ou)20 b(should)f(be)479
2756 y(able)h(to)h(pro)o(v)o(e)d(the)i(heartbeating)e(w)o(orks)i(by)g
(starting)g(peers)g(in)g(an)o(y)f(order)m(,)g(stopping)g(and)g
(restarting)h(them,)479 2864 y(simulating)g(freezes,)f(and)h(so)g(on.)
-2 2882 y
SDict begin H.S end
 -2 2882 a -2 2882 a
SDict begin 13 H.A end
 -2 2882 a -2 2882 a
SDict begin [/View [/XYZ H.V]/Dest (0:2122) cvn /DEST pdfmark end
 -2
2882 a Black 396 3014 a Fe(\225)p Black 479 3014 a
SDict begin H.S end
 479
3014 a 479 3014 a
SDict begin 13 H.A end
 479 3014 a 479 3014 a
SDict begin [/View [/XYZ H.V]/Dest (0:2123) cvn /DEST pdfmark end
 479 3014 a Fj(When)g(your)f
(main)h(loop)f(is)j(based)d(on)1616 3014 y
SDict begin H.S end
 1616 3014
a 1616 3014 a
SDict begin 13 H.A end
 1616 3014 a 1616 3014 a
SDict begin [/View [/XYZ H.V]/Dest (0:2124) cvn /DEST pdfmark end
 1616 3014 a Fg(zmq_poll\(\))p
Fj(,)g(use)h(a)h(secondary)d(timer)i(to)h(trigger)e(heartbeats.)g(Do)
3676 3014 y
SDict begin H.S end
 3676 3014 a 3676 3014 a
SDict begin 13 H.A end
 3676 3014 a 3676
3014 a
SDict begin [/View [/XYZ H.V]/Dest (0:2125) cvn /DEST pdfmark end
 3676 3014 a Fi(not)479 3122 y Fj(use)i(the)f(poll)g(loop)f(for)h
(this,)g(because)g(you')o(ll)f(enter)h(the)g(loop)f(e)n(v)o(ery)g(time)
i(you)e(recei)n(v)o(e)g(an)o(y)g(message)h(\(fun,)f(when)479
3230 y(you)h(ha)n(v)o(e)f(tw)o(o)i(peers)f(sending)f(each)g(other)h
(heartbeats\))f(\(think)g(about)g(it\).)-2 3414 y
SDict begin H.S end
 -2
3414 a -2 3414 a
SDict begin 13 H.A end
 -2 3414 a -2 3414 a
SDict begin [/View [/XYZ H.V]/Dest (0:2126) cvn /DEST pdfmark end
 -2 3414 a 396 3504
a Fj(Y)-9 b(our)19 b(language)g(or)h(binding)e(should)i(pro)o(vide)e(a)
i(method)f(that)h(returns)g(the)g(current)f(system)h(clock)g(in)g
(milliseconds.)396 3611 y(It')-5 b(s)21 b(easy)f(to)h(use)f(this)h(to)f
(calculate)g(when)g(to)g(send)g(the)g(ne)o(xt)g(heartbeats.)f(Thus,)g
(in)i(C:)-2 3712 y
SDict begin H.S end
 -2 3712 a -2 3712 a
SDict begin 11.7 H.A end
 -2 3712 a -2 3712
a
SDict begin [/View [/XYZ H.V]/Dest (0:2127) cvn /DEST pdfmark end
 -2 3712 a 396 3792 a Fg(//)90 b(Send)44 b(out)g(heartbeats)f(at)i
(regular)e(intervals)396 3889 y(uint64_t)h(heartbeat_at)f(=)h
(zclock_time)f(\(\))i(+)f(HEARTBEAT_INTERVAL;)396 4083
y(while)g(\(true\))g({)576 4180 y(...)576 4277 y(int)g(rc)g(=)h
(zmq_poll)f(\(items,)f(1,)i(HEARTBEAT_INTERVAL)2728 4290
y(*)2817 4277 y(ZMQ_POLL_MSEC\);)576 4374 y(...)576 4472
y(//)89 b(Send)44 b(heartbeat)f(to)i(queue)f(if)g(it's)h(time)576
4569 y(if)f(\(zclock_time)f(\(\))h(>)h(heartbeat_at\))e({)755
4666 y(...)h(Send)g(heartbeats)g(to)g(all)g(peers)g(that)h(expect)e
(them)755 4763 y(//)89 b(Set)45 b(timer)f(for)g(next)g(heartbeat)755
4860 y(heartbeat_at)f(=)h(zclock_time)f(\(\))i(+)g(HEARTBEAT_INTERVAL;)
576 4957 y(})396 5054 y(})-2 5062 y
SDict begin H.S end
 -2 5062 a -2 5062
a
SDict begin 13 H.A end
 -2 5062 a -2 5062 a
SDict begin [/View [/XYZ H.V]/Dest (0:2128) cvn /DEST pdfmark end
 -2 5062 a -2 5146 a
SDict begin H.S end
 -2 5146 a -2
5146 a
SDict begin 13 H.A end
 -2 5146 a -2 5146 a
SDict begin [/View [/XYZ H.V]/Dest (0:2129) cvn /DEST pdfmark end
 -2 5146 a Black 3759 5569
a Fi(164)p Black eop end
%%Page: 165 179
TeXDict begin 165 178 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.165) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2154) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2130) cvn /DEST pdfmark end
 479 72 a
Fj(Y)e(our)20 b(main)f(poll)h(loop)g(should)f(use)h(the)g(heartbeat)f
(interv)n(al)h(as)h(its)g(timeout.)e(Ob)o(viously)-5
b(,)18 b(don')o(t)g(use)j(in\002nity)-5 b(.)479 180 y(An)o(ything)18
b(less)k(will)f(just)f(w)o(aste)h(c)o(ycles.)-2 198 y
SDict begin H.S end

-2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:2131) cvn /DEST pdfmark end
 -2 198 a Black 396
330 a Fe(\225)p Black 479 330 a
SDict begin H.S end
 479 330 a 479 330 a
SDict begin 13 H.A end
 479
330 a 479 330 a
SDict begin [/View [/XYZ H.V]/Dest (0:2132) cvn /DEST pdfmark end
 479 330 a Fj(Use)g(simple)f(tracing,)f(i.e.)i(print)e
(to)i(console,)e(to)h(get)g(this)h(w)o(orking.)d(Some)i(tricks)g(to)h
(help)e(you)h(trace)g(the)g(\003o)n(w)g(of)479 438 y(messages)h
(between)e(peers:)h(a)h(dump)d(method)h(such)h(as)h(zmsg)f(of)n(fers;)g
(number)e(messages)i(incrementally)f(so)h(you)479 546
y(can)g(see)h(if)g(there)e(are)h(gaps.)-2 564 y
SDict begin H.S end
 -2 564
a -2 564 a
SDict begin 13 H.A end
 -2 564 a -2 564 a
SDict begin [/View [/XYZ H.V]/Dest (0:2133) cvn /DEST pdfmark end
 -2 564 a Black 396 695 a
Fe(\225)p Black 479 695 a
SDict begin H.S end
 479 695 a 479 695 a
SDict begin 13 H.A end
 479 695
a 479 695 a
SDict begin [/View [/XYZ H.V]/Dest (0:2134) cvn /DEST pdfmark end
 479 695 a Fj(In)g(a)h(real)f(application,)e(heartbeating)h
(must)h(be)g(con\002gurable)e(and)h(usually)h(ne)o(gotiated)e(with)j
(the)f(peer)-5 b(.)20 b(Some)479 803 y(peers)g(will)h(w)o(ant)f
(aggressi)n(v)o(e)f(heartbeating,)f(as)j(lo)n(w)f(as)h(10)f(msecs.)g
(Other)g(peers)g(will)h(be)f(f)o(ar)g(a)o(w)o(ay)g(and)g(w)o(ant)479
911 y(heartbeating)e(as)j(high)f(as)h(30)e(seconds.)-2
929 y
SDict begin H.S end
 -2 929 a -2 929 a
SDict begin 13 H.A end
 -2 929 a -2 929 a
SDict begin [/View [/XYZ H.V]/Dest (0:2135) cvn /DEST pdfmark end
 -2 929 a Black
396 1060 a Fe(\225)p Black 479 1060 a
SDict begin H.S end
 479 1060 a 479
1060 a
SDict begin 13 H.A end
 479 1060 a 479 1060 a
SDict begin [/View [/XYZ H.V]/Dest (0:2136) cvn /DEST pdfmark end
 479 1060 a Fj(If)h(you)g(ha)n(v)o(e)f(dif)
n(ferent)g(heartbeat)g(interv)n(als)g(for)h(dif)n(ferent)e(peers,)i
(your)f(poll)h(timeout)f(should)h(be)g(the)g(lo)n(west)479
1168 y(\(shortest)g(time\))g(of)g(these.)-2 1183 y
SDict begin H.S end
 -2
1183 a -2 1183 a
SDict begin 13 H.A end
 -2 1183 a -2 1183 a
SDict begin [/View [/XYZ H.V]/Dest (0:2137) cvn /DEST pdfmark end
 -2 1183 a Black
396 1318 a Fe(\225)p Black 479 1318 a
SDict begin H.S end
 479 1318 a 479
1318 a
SDict begin 13 H.A end
 479 1318 a 479 1318 a
SDict begin [/View [/XYZ H.V]/Dest (0:2138) cvn /DEST pdfmark end
 479 1318 a Fj(Y)-9 b(ou)20
b(might)f(be)i(tempted)e(to)h(open)f(a)i(separate)f(sock)o(et)g(dialog)
f(for)h(heartbeats.)f(This)h(is)h(super\002cially)e(nice)479
1426 y(because)h(you)f(can)h(separate)g(dif)n(ferent)e(dialogs,)i(e.g.)
f(the)i(synchronous)c(request-reply)h(from)h(the)h(asynchronous)479
1534 y(heartbeating.)e(Ho)n(we)n(v)o(er)h(it')-5 b(s)21
b(a)g(bad)e(idea)h(for)g(se)n(v)o(eral)g(reasons.)f(First,)i(if)f(you')
l(re)f(sending)g(data)h(you)f(don')o(t)f(need)479 1642
y(to)j(send)f(heartbeats.)f(Second,)g(sock)o(ets)h(may)-5
b(,)19 b(due)h(to)g(netw)o(ork)f(v)n(agaries,)g(become)g(jammed.)g(Y)-9
b(ou)19 b(need)h(to)g(kno)n(w)479 1750 y(when)g(your)f(main)h(data)g
(sock)o(et)g(is)h(silent)f(because)g(it')-5 b(s)21 b(dead,)f(rather)f
(than)h(just)g(not)g(b)n(usy)-5 b(,)19 b(so)i(you)e(need)479
1857 y(heartbeats)h(on)f(that)i(sock)o(et.)e(Lastly)-5
b(,)20 b(tw)o(o)h(sock)o(ets)f(is)h(more)e(comple)o(x)g(than)h(one.)-2
1875 y
SDict begin H.S end
 -2 1875 a -2 1875 a
SDict begin 13 H.A end
 -2 1875 a -2 1875 a
SDict begin [/View [/XYZ H.V]/Dest (0:2139) cvn /DEST pdfmark end
 -2 1875
a Black 396 2007 a Fe(\225)p Black 479 2007 a
SDict begin H.S end
 479 2007
a 479 2007 a
SDict begin 13 H.A end
 479 2007 a 479 2007 a
SDict begin [/View [/XYZ H.V]/Dest (0:2140) cvn /DEST pdfmark end
 479 2007 a Fj(W)-7
b(e')l(re)21 b(not)e(doing)g(heartbeating)f(from)i(client)g(to)g
(queue.)f(It)h(does)g(mak)o(e)g(things)g(more)f(comple)o(x,)f(b)n(ut)j
(we)f(do)g(that)479 2115 y(in)h(real)f(applications)f(so)h(that)h
(clients)f(can)g(detect)g(when)g(brok)o(ers)f(die,)h(and)f(do)h(cle)n
(v)o(er)f(things)h(lik)o(e)h(switch)f(to)479 2223 y(alternate)g(brok)o
(ers.)-2 2265 y
SDict begin H.S end
 -2 2265 a -2 2265 a
SDict begin 13 H.A end
 -2 2265 a -2 2265
a
SDict begin [/View [/XYZ H.V]/Dest (0:2141) cvn /DEST pdfmark end
 -2 2265 a 376 x Fh(4.7.)39 b(Contracts)e(and)i(Pr)m(otocols)1942
2641 y
SDict begin H.S end
 1942 2641 a 1942 2641 a
SDict begin 22.464 H.A end
 1942 2641 a 1942 2641
a
SDict begin [/View [/XYZ H.V]/Dest (9.46.1) cvn /DEST pdfmark end
 1942 2641 a -2 2809 a
SDict begin H.S end
 -2 2809 a -2 2809 a
SDict begin 13 H.A end
 -2 2809 a
-2 2809 a
SDict begin [/View [/XYZ H.V]/Dest (0:2143) cvn /DEST pdfmark end
 -2 2809 a 396 2915 a Fj(If)20 b(you')l(re)f(paying)f
(attention)i(you')o(ll)f(realize)h(that)g(P)o(aranoid)f(Pirate)h(is)h
(not)f(interoperable)e(with)i(Simple)g(Pirate,)396 3023
y(because)f(of)g(the)h(heartbeats.)e(But)i(ho)n(w)f(do)g(we)g(de\002ne)
g("interoperable"?)e(T)-7 b(o)19 b(guarantee)f(interoperability)f(we)j
(need)e(a)396 3131 y(kind)i(of)g(contract,)e(an)j(agreement)d(that)i
(lets)h(dif)n(ferent)e(teams,)h(in)h(dif)n(ferent)d(times)j(and)e
(places,)h(write)h(code)e(that)i(is)396 3239 y(guaranteed)d(to)j(w)o
(ork)e(together)-5 b(.)19 b(W)-7 b(e)21 b(call)g(this)g(a)f
("protocol".)-2 3423 y
SDict begin H.S end
 -2 3423 a -2 3423 a
SDict begin 13 H.A end
 -2 3423 a
-2 3423 a
SDict begin [/View [/XYZ H.V]/Dest (0:2144) cvn /DEST pdfmark end
 -2 3423 a 396 3513 a Fj(It')-5 b(s)21 b(fun)f(to)g(e)o
(xperiment)e(without)h(speci\002cations,)h(b)n(ut)g(that')-5
b(s)21 b(not)f(a)g(sensible)g(basis)h(for)f(real)g(applications.)f
(What)396 3621 y(happens)g(if)i(we)f(w)o(ant)g(to)h(write)f(a)h(w)o
(ork)o(er)e(in)h(another)f(language?)f(Do)j(we)f(ha)n(v)o(e)g(to)g
(read)g(code)f(to)i(see)f(ho)n(w)g(things)396 3729 y(w)o(ork?)g(What)g
(if)h(we)f(w)o(ant)h(to)f(change)f(the)h(protocol)e(for)i(some)g
(reason?)f(The)h(protocol)f(may)g(be)i(simple)f(b)n(ut)g(it')-5
b(s)21 b(not)396 3837 y(ob)o(vious,)d(and)i(if)h(it')-5
b(s)21 b(successful)f(it')o(ll)h(become)e(more)g(comple)o(x.)-2
4021 y
SDict begin H.S end
 -2 4021 a -2 4021 a
SDict begin 13 H.A end
 -2 4021 a -2 4021 a
SDict begin [/View [/XYZ H.V]/Dest (0:2145) cvn /DEST pdfmark end
 -2 4021
a 396 4111 a Fj(Lack)h(of)g(contracts)f(is)i(a)g(sure)f(sign)g(of)g(a)h
(disposable)e(application.)g(So,)h(let')-5 b(s)21 b(write)f(a)h
(contract)e(for)h(this)g(protocol.)396 4219 y(Ho)n(w)g(do)g(we)h(do)e
(that?)-2 4220 y
SDict begin H.S end
 -2 4220 a -2 4220 a
SDict begin 13 H.A end
 -2 4220 a -2 4220
a
SDict begin [/View [/XYZ H.V]/Dest (0:2146) cvn /DEST pdfmark end
 -2 4220 a -2 4230 a
SDict begin H.S end
 -2 4230 a -2 4230 a
SDict begin 13 H.A end
 -2 4230 a -2
4230 a
SDict begin [/View [/XYZ H.V]/Dest (0:2147) cvn /DEST pdfmark end
 -2 4230 a Black 396 4389 a Fe(\225)p Black 479
4389 a
SDict begin H.S end
 479 4389 a 479 4389 a
SDict begin 13 H.A end
 479 4389 a 479 4389 a
SDict begin [/View [/XYZ H.V]/Dest (0:2148) cvn /DEST pdfmark end
 479
4389 a Fj(There')-5 b(s)20 b(a)h(wiki,)f(at)1076 4389
y
SDict begin H.S end
 1076 4389 a 1076 4389 a
SDict begin 13 H.A end
 1076 4389 a 1076 4389 a
SDict begin [/View [/XYZ H.V]/Dest (0:2149) cvn /DEST pdfmark end
 1076
4389 a Fj(rfc.zeromq.or)o(g)c(\(http://rfc.zeromq.or)o(g\),)e(that)20
b(we)h(made)e(especially)h(as)h(a)g(home)e(for)h(public)479
4497 y(\330MQ)h(contracts.)-2 4512 y
SDict begin H.S end
 -2 4512 a -2 4512
a
SDict begin 13 H.A end
 -2 4512 a -2 4512 a
SDict begin [/View [/XYZ H.V]/Dest (0:2150) cvn /DEST pdfmark end
 -2 4512 a Black 396 4646 a Fe(\225)p
Black 479 4646 a
SDict begin H.S end
 479 4646 a 479 4646 a
SDict begin 13 H.A end
 479 4646 a 479
4646 a
SDict begin [/View [/XYZ H.V]/Dest (0:2151) cvn /DEST pdfmark end
 479 4646 a Fj(T)-7 b(o)21 b(create)f(a)g(ne)n(w)g
(speci\002cation,)f(re)o(gister)m(,)g(and)h(follo)n(w)f(the)i
(instructions.)e(It')-5 b(s)20 b(straight-forw)o(ard,)e(though)479
4754 y(technical)i(writing)f(is)i(not)f(for)g(e)n(v)o(eryone.)-2
4938 y
SDict begin H.S end
 -2 4938 a -2 4938 a
SDict begin 13 H.A end
 -2 4938 a -2 4938 a
SDict begin [/View [/XYZ H.V]/Dest (0:2152) cvn /DEST pdfmark end
 -2 4938
a 396 5028 a Fj(It)h(took)e(me)h(about)g(\002fteen)f(minutes)h(to)g
(draft)g(the)g(ne)n(w)2022 5028 y
SDict begin H.S end
 2022 5028 a 2022 5028
a
SDict begin 13 H.A end
 2022 5028 a 2022 5028 a
SDict begin [/View [/XYZ H.V]/Dest (0:2153) cvn /DEST pdfmark end
 2022 5028 a Fj(Pirate)h(P)o(attern)e
(Protocol)g(\(http://rfc.zeromq.or)o(g/spec:6)o(\).)396
5136 y(It')-5 b(s)21 b(not)f(a)h(big)e(speci\002cation)h(b)n(ut)g(it)h
(does)f(capture)f(enough)f(to)j(act)f(as)h(the)f(basis)h(for)f(ar)o
(guments)e(\("your)g(queue)h(isn')o(t)p Black 3759 5569
a Fi(165)p Black eop end
%%Page: 166 180
TeXDict begin 166 179 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.166) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2176) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 396 72 a Fj(PPP)21 b(compatible,)e(please)h
(\002x)h(it!"\).)396 346 y(T)l(urning)e(PPP)i(into)f(a)h(real)f
(protocol)e(w)o(ould)i(tak)o(e)g(more)f(w)o(ork:)-2 364
y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:2155) cvn /DEST pdfmark end
 -2 364 a -2 374
a
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 13 H.A end
 -2 374 a -2 374 a
SDict begin [/View [/XYZ H.V]/Dest (0:2156) cvn /DEST pdfmark end
 -2 374 a Black
396 517 a Fe(\225)p Black 479 517 a
SDict begin H.S end
 479 517 a 479 517
a
SDict begin 13 H.A end
 479 517 a 479 517 a
SDict begin [/View [/XYZ H.V]/Dest (0:2157) cvn /DEST pdfmark end
 479 517 a Fj(There)h(should)f(be)h(a)h(protocol)d
(v)o(ersion)h(number)f(in)j(the)f(READ)-5 b(Y)21 b(command)d(so)j(that)
f(it')-5 b(s)21 b(possible)f(to)h(create)f(ne)n(w)479
625 y(v)o(ersions)g(of)f(PPP)j(safely)-5 b(.)-2 643 y
SDict begin H.S end

-2 643 a -2 643 a
SDict begin 13 H.A end
 -2 643 a -2 643 a
SDict begin [/View [/XYZ H.V]/Dest (0:2158) cvn /DEST pdfmark end
 -2 643 a Black 396
774 a Fe(\225)p Black 479 774 a
SDict begin H.S end
 479 774 a 479 774 a
SDict begin 13 H.A end
 479
774 a 479 774 a
SDict begin [/View [/XYZ H.V]/Dest (0:2159) cvn /DEST pdfmark end
 479 774 a Fj(Right)21 b(no)n(w)-5 b(,)19
b(READ)-5 b(Y)21 b(and)e(HEAR)-5 b(TBEA)c(T)20 b(are)h(not)e(entirely)h
(distinct)g(from)f(requests)h(and)g(replies.)f(T)-7 b(o)21
b(mak)o(e)479 882 y(them)f(distinct,)g(we)h(w)o(ould)e(w)o(ant)h(a)h
(message)f(structure)f(that)i(includes)e(a)i("message)f(type")f(part.)
-2 941 y
SDict begin H.S end
 -2 941 a -2 941 a
SDict begin 13 H.A end
 -2 941 a -2 941 a
SDict begin [/View [/XYZ H.V]/Dest (0:2160) cvn /DEST pdfmark end
 -2 941 a
360 x Fh(4.8.)39 b(Ser)q(vice-Oriented)d(Reliab)o(le)i(Queuing)g
(\(Major)m(domo)-2 1487 y(P)l(attern\))538 1487 y
SDict begin H.S end
 538
1487 a 538 1487 a
SDict begin 22.464 H.A end
 538 1487 a 538 1487 a
SDict begin [/View [/XYZ H.V]/Dest (9.47.1) cvn /DEST pdfmark end
 538 1487 a -2
1683 a
SDict begin H.S end
 -2 1683 a -2 1683 a
SDict begin 13 H.A end
 -2 1683 a -2 1683 a
SDict begin [/View [/XYZ H.V]/Dest (0:2162) cvn /DEST pdfmark end
 -2 1683
a 396 1761 a Fj(The)20 b(nice)f(thing)h(about)e(progress)h(is)i(ho)n(w)
e(f)o(ast)i(it)f(happens)f(when)g(la)o(wyers)g(and)h(committees)f
(aren')o(t)f(in)m(v)n(olv)o(ed.)g(Just)i(a)396 1869 y(fe)n(w)g
(sentences)g(ago)g(we)g(were)h(dreaming)d(of)i(a)g(better)g(protocol)f
(that)h(w)o(ould)f(\002x)i(the)f(w)o(orld.)f(And)h(here)g(we)g(ha)n(v)o
(e)g(it:)-2 1887 y
SDict begin H.S end
 -2 1887 a -2 1887 a
SDict begin 13 H.A end
 -2 1887 a -2 1887
a
SDict begin [/View [/XYZ H.V]/Dest (0:2163) cvn /DEST pdfmark end
 -2 1887 a -2 1897 a
SDict begin H.S end
 -2 1897 a -2 1897 a
SDict begin 13 H.A end
 -2 1897 a -2
1897 a
SDict begin [/View [/XYZ H.V]/Dest (0:2164) cvn /DEST pdfmark end
 -2 1897 a Black 396 2039 a Fe(\225)p Black 479
2039 a
SDict begin H.S end
 479 2039 a 479 2039 a
SDict begin 13 H.A end
 479 2039 a 479 2039 a
SDict begin [/View [/XYZ H.V]/Dest (0:2165) cvn /DEST pdfmark end
 479
2039 a Fj(http://rfc.zeromq.or)o(g/spec:7)-2 2223 y
SDict begin H.S end
 -2
2223 a -2 2223 a
SDict begin 13 H.A end
 -2 2223 a -2 2223 a
SDict begin [/View [/XYZ H.V]/Dest (0:2166) cvn /DEST pdfmark end
 -2 2223 a 396 2313
a Fj(This)g(one-page)e(speci\002cation)g(tak)o(es)i(PPP)h(and)e(turns)g
(it)i(into)e(something)f(more)h(solid\()p 0 TeXcolorgray
2966 2313 a
SDict begin H.S end
 2966 2313 a Fj(Figure)g(4-4)3315 2313 y
SDict begin 13 H.L end
 3315
2313 a 3315 2313 a
SDict begin [/Subtype /Link/Dest (0:figure-56) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3315 2313 a Black -2 w Fj(\).)h(This)g(is)g(ho)n(w)f
(we)396 2421 y(should)g(design)h(comple)o(x)e(architectures:)h(start)i
(by)f(writing)f(do)n(wn)h(the)g(contracts,)f(and)h(only)3153
2421 y
SDict begin H.S end
 3153 2421 a 3153 2421 a
SDict begin 13 H.A end
 3153 2421 a 3153 2421
a
SDict begin [/View [/XYZ H.V]/Dest (0:2168) cvn /DEST pdfmark end
 3153 2421 a Fi(then)g Fj(write)g(softw)o(are)g(to)396
2529 y(implement)f(them.)-2 2713 y
SDict begin H.S end
 -2 2713 a -2 2713
a
SDict begin 13 H.A end
 -2 2713 a -2 2713 a
SDict begin [/View [/XYZ H.V]/Dest (0:2169) cvn /DEST pdfmark end
 -2 2713 a 396 2803 a Fj(The)h(Majordomo)e
(Protocol)h(\(MDP\))h(e)o(xtends)f(and)h(impro)o(v)o(es)e(PPP)j(in)g
(one)e(interesting)h(w)o(ay)g(apart)f(from)h(the)g(tw)o(o)396
2911 y(points)g(abo)o(v)o(e.)e(It)j(adds)f(a)g("service)g(name")g(to)g
(requests)g(that)g(the)g(client)g(sends,)g(and)g(asks)h(w)o(ork)o(ers)e
(to)i(re)o(gister)e(for)396 3019 y(speci\002c)i(services.)f(The)f(nice)
h(thing)g(about)f(MDP)i(is)g(that)f(it)h(came)f(from)f(w)o(orking)g
(code,)g(a)i(simpler)f(protocol,)e(and)h(a)396 3127 y(precise)h(set)h
(of)f(impro)o(v)o(ements.)d(This)j(made)g(it)h(easy)f(to)h(draft.)-2
3311 y
SDict begin H.S end
 -2 3311 a -2 3311 a
SDict begin 13 H.A end
 -2 3311 a -2 3311 a
SDict begin [/View [/XYZ H.V]/Dest (0:2170) cvn /DEST pdfmark end
 -2 3311
a 396 3401 a Fj(Adding)e(service)h(names)g(is)h(a)g(small)f(b)n(ut)g
(signi\002cant)g(change)f(that)h(turns)g(our)g(P)o(aranoid)e(Pirate)j
(queue)e(into)h(a)396 3509 y(service-oriented)e(brok)o(er)-5
b(.)-2 3510 y
SDict begin H.S end
 -2 3510 a -2 3510 a
SDict begin 13 H.A end
 -2 3510 a -2 3510 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-56) cvn /DEST pdfmark
end

-2 3510 a Black 3757 5569 a Fi(166)p Black eop end
%%Page: 167 181
TeXDict begin 167 180 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.167) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-4.)f(The)i(Majordomo)e
(P)o(atter)o(n)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2173) cvn /DEST pdfmark end
 -2 172 a 396 3314 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3314 a @beginspecial 0
@llx -372 @lly 392 @urx 0 @ury 3920 @rwi @setspecial
%%BeginDocument: images/fig56.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -372 392 0
%%HiResBoundingBox: 0.0 -372.0 392.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -32.40024185180664 moveto
22.400239944458008 -74.40023803710938 lineto
22.400239944458008 -78.40023803710938 23.73357327779134 -80.40023803710938 26.400239944458008 -80.40023803710938 curveto
114.40023803710938 -80.40023803710938 lineto
114.40023803710938 -80.40023803710938 lineto
117.06690470377605 -80.40023803710938 118.40023803710938 -78.40023803710938 118.40023803710938 -74.40023803710938 curveto
118.40023803710938 -32.40024185180664 lineto
118.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -32.40024185180664 moveto
150.40023803710938 -74.40023803710938 lineto
150.40023803710938 -78.40023803710938 151.73357137044272 -80.40023803710938 154.40023803710938 -80.40023803710938 curveto
242.40023803710938 -80.40023803710938 lineto
242.40023803710938 -80.40023803710938 lineto
245.06690470377603 -80.40023803710938 246.40023803710938 -78.40023803710938 246.40023803710938 -74.40023803710938 curveto
246.40023803710938 -32.40024185180664 lineto
246.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -32.40024185180664 moveto
278.4002380371094 -74.40023803710938 lineto
278.4002380371094 -78.40023803710938 279.7335713704427 -80.40023803710938 282.4002380371094 -80.40023803710938 curveto
370.4002380371094 -80.40023803710938 lineto
370.4002380371094 -80.40023803710938 lineto
373.06690470377606 -80.40023803710938 374.4002380371094 -78.40023803710938 374.4002380371094 -74.40023803710938 curveto
374.4002380371094 -32.40024185180664 lineto
374.4002380371094 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -152.40023803710938 moveto
151.73357137044272 -152.40023803710938 150.40023803710938 -154.40023803710938 150.40023803710938 -158.40023803710938 curveto
150.40023803710938 -194.40023803710938 lineto
150.40023803710938 -198.40023803710938 151.73357137044272 -200.40023803710938 154.40023803710938 -200.40023803710938 curveto
242.40023803710938 -200.40023803710938 lineto
242.40023803710938 -200.40023803710938 lineto
245.06690470377603 -200.40023803710938 246.40023803710938 -198.40023803710938 246.40023803710938 -194.40023803710938 curveto
246.40023803710938 -158.40023803710938 lineto
246.40023803710938 -158.40023803710938 lineto
246.40023803710938 -154.40023803710938 245.06690470377603 -152.40023803710938 242.40023803710938 -152.40023803710938 curveto
154.40023803710938 -152.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -272.4002380371094 moveto
23.73357327779134 -272.4002380371094 22.400239944458008 -274.4002380371094 22.400239944458008 -278.4002380371094 curveto
22.400239944458008 -294.4002380371094 lineto
118.40023803710938 -294.4002380371094 lineto
118.40023803710938 -278.4002380371094 lineto
118.40023803710938 -274.4002380371094 117.06690470377605 -272.4002380371094 114.40023803710938 -272.4002380371094 curveto
26.400239944458008 -272.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -297.4002380371094 moveto
22.400239944458008 -344.4002380371094 lineto
118.40023803710938 -344.4002380371094 lineto
118.40023803710938 -297.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -272.4002380371094 moveto
151.73357137044272 -272.4002380371094 150.40023803710938 -274.4002380371094 150.40023803710938 -278.4002380371094 curveto
150.40023803710938 -294.4002380371094 lineto
246.40023803710938 -294.4002380371094 lineto
246.40023803710938 -278.4002380371094 lineto
246.40023803710938 -274.4002380371094 245.06690470377603 -272.4002380371094 242.40023803710938 -272.4002380371094 curveto
154.40023803710938 -272.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -297.4002380371094 moveto
150.40023803710938 -344.4002380371094 lineto
246.40023803710938 -344.4002380371094 lineto
246.40023803710938 -297.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -272.4002380371094 moveto
279.7335713704427 -272.4002380371094 278.4002380371094 -274.4002380371094 278.4002380371094 -278.4002380371094 curveto
278.4002380371094 -294.4002380371094 lineto
374.4002380371094 -294.4002380371094 lineto
374.4002380371094 -278.4002380371094 lineto
374.4002380371094 -274.4002380371094 373.06690470377606 -272.4002380371094 370.4002380371094 -272.4002380371094 curveto
282.4002380371094 -272.4002380371094 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -297.4002380371094 moveto
278.4002380371094 -344.4002380371094 lineto
374.4002380371094 -344.4002380371094 lineto
374.4002380371094 -297.4002380371094 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -30.0 moveto
20.0 -72.0 lineto
20.0 -76.0 21.333333333333332 -78.0 24.0 -78.0 curveto
112.0 -78.0 lineto
112.0 -78.0 lineto
114.66666666666667 -78.0 116.0 -76.0 116.0 -72.0 curveto
116.0 -30.0 lineto
116.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -30.0 moveto
20.0 -72.0 lineto
20.0 -76.0 21.333333333333332 -78.0 24.0 -78.0 curveto
112.0 -78.0 lineto
112.0 -78.0 lineto
114.66666666666667 -78.0 116.0 -76.0 116.0 -72.0 curveto
116.0 -30.0 lineto
116.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -72.0 lineto
148.0 -76.0 149.33333333333334 -78.0 152.0 -78.0 curveto
240.0 -78.0 lineto
240.0 -78.0 lineto
242.66666666666666 -78.0 244.0 -76.0 244.0 -72.0 curveto
244.0 -30.0 lineto
244.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -72.0 lineto
148.0 -76.0 149.33333333333334 -78.0 152.0 -78.0 curveto
240.0 -78.0 lineto
240.0 -78.0 lineto
242.66666666666666 -78.0 244.0 -76.0 244.0 -72.0 curveto
244.0 -30.0 lineto
244.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -72.0 lineto
276.0 -76.0 277.3333333333333 -78.0 280.0 -78.0 curveto
368.0 -78.0 lineto
368.0 -78.0 lineto
370.6666666666667 -78.0 372.0 -76.0 372.0 -72.0 curveto
372.0 -30.0 lineto
372.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -72.0 lineto
276.0 -76.0 277.3333333333333 -78.0 280.0 -78.0 curveto
368.0 -78.0 lineto
368.0 -78.0 lineto
370.6666666666667 -78.0 372.0 -76.0 372.0 -72.0 curveto
372.0 -30.0 lineto
372.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -150.0 moveto
149.33333333333334 -150.0 148.0 -152.0 148.0 -156.0 curveto
148.0 -192.0 lineto
148.0 -196.0 149.33333333333334 -198.0 152.0 -198.0 curveto
240.0 -198.0 lineto
240.0 -198.0 lineto
242.66666666666666 -198.0 244.0 -196.0 244.0 -192.0 curveto
244.0 -156.0 lineto
244.0 -156.0 lineto
244.0 -152.0 242.66666666666666 -150.0 240.0 -150.0 curveto
152.0 -150.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -150.0 moveto
149.33333333333334 -150.0 148.0 -152.0 148.0 -156.0 curveto
148.0 -192.0 lineto
148.0 -196.0 149.33333333333334 -198.0 152.0 -198.0 curveto
240.0 -198.0 lineto
240.0 -198.0 lineto
242.66666666666666 -198.0 244.0 -196.0 244.0 -192.0 curveto
244.0 -156.0 lineto
244.0 -156.0 lineto
244.0 -152.0 242.66666666666666 -150.0 240.0 -150.0 curveto
152.0 -150.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -270.0 moveto
21.333333333333332 -270.0 20.0 -272.0 20.0 -276.0 curveto
20.0 -292.0 lineto
116.0 -292.0 lineto
116.0 -276.0 lineto
116.0 -272.0 114.66666666666667 -270.0 112.0 -270.0 curveto
24.0 -270.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -270.0 moveto
21.333333333333332 -270.0 20.0 -272.0 20.0 -276.0 curveto
20.0 -292.0 lineto
116.0 -292.0 lineto
116.0 -276.0 lineto
116.0 -272.0 114.66666666666667 -270.0 112.0 -270.0 curveto
24.0 -270.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -295.0 moveto
20.0 -342.0 lineto
116.0 -342.0 lineto
116.0 -295.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -295.0 moveto
20.0 -342.0 lineto
116.0 -342.0 lineto
116.0 -295.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -270.0 moveto
149.33333333333334 -270.0 148.0 -272.0 148.0 -276.0 curveto
148.0 -292.0 lineto
244.0 -292.0 lineto
244.0 -276.0 lineto
244.0 -272.0 242.66666666666666 -270.0 240.0 -270.0 curveto
152.0 -270.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -270.0 moveto
149.33333333333334 -270.0 148.0 -272.0 148.0 -276.0 curveto
148.0 -292.0 lineto
244.0 -292.0 lineto
244.0 -276.0 lineto
244.0 -272.0 242.66666666666666 -270.0 240.0 -270.0 curveto
152.0 -270.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -295.0 moveto
148.0 -342.0 lineto
244.0 -342.0 lineto
244.0 -295.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -295.0 moveto
148.0 -342.0 lineto
244.0 -342.0 lineto
244.0 -295.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -270.0 moveto
277.3333333333333 -270.0 276.0 -272.0 276.0 -276.0 curveto
276.0 -292.0 lineto
372.0 -292.0 lineto
372.0 -276.0 lineto
372.0 -272.0 370.6666666666667 -270.0 368.0 -270.0 curveto
280.0 -270.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -270.0 moveto
277.3333333333333 -270.0 276.0 -272.0 276.0 -276.0 curveto
276.0 -292.0 lineto
372.0 -292.0 lineto
372.0 -276.0 lineto
372.0 -272.0 370.6666666666667 -270.0 368.0 -270.0 curveto
280.0 -270.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -295.0 moveto
276.0 -342.0 lineto
372.0 -342.0 lineto
372.0 -295.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -295.0 moveto
276.0 -342.0 lineto
372.0 -342.0 lineto
372.0 -295.0 lineto
closepath
stroke
newpath
68.0 -84.0 moveto
64.0 -96.0 lineto
72.0 -96.0 lineto
closepath
fill
newpath
196.0 -84.0 moveto
192.0 -96.0 lineto
200.0 -96.0 lineto
closepath
fill
newpath
324.0 -84.0 moveto
320.0 -96.0 lineto
328.0 -96.0 lineto
closepath
fill
newpath
192.0 -132.0 moveto
196.0 -144.0 lineto
200.0 -132.0 lineto
closepath
fill
newpath
196.0 -204.0 moveto
192.0 -216.0 lineto
200.0 -216.0 lineto
closepath
fill
newpath
64.0 -252.0 moveto
68.0 -264.0 lineto
72.0 -252.0 lineto
closepath
fill
newpath
192.0 -252.0 moveto
196.0 -264.0 lineto
200.0 -252.0 lineto
closepath
fill
newpath
320.0 -252.0 moveto
324.0 -264.0 lineto
328.0 -252.0 lineto
closepath
fill
newpath
68.0 -90.0 moveto
68.0 -108.0 lineto
68.0 -112.0 69.33333333333333 -114.0 72.0 -114.0 curveto
196.0 -114.0 lineto
196.0 -114.0 lineto
stroke
newpath
196.0 -90.0 moveto
196.0 -114.0 lineto
stroke
newpath
324.0 -90.0 moveto
324.0 -108.0 lineto
324.0 -112.0 322.6666666666667 -114.0 320.0 -114.0 curveto
196.0 -114.0 lineto
196.0 -114.0 lineto
stroke
newpath
196.0 -138.0 moveto
196.0 -114.0 lineto
stroke
newpath
196.0 -210.0 moveto
196.0 -234.0 lineto
stroke
newpath
68.0 -258.0 moveto
68.0 -240.0 lineto
68.0 -236.0 69.33333333333333 -234.0 72.0 -234.0 curveto
196.0 -234.0 lineto
196.0 -234.0 lineto
stroke
newpath
196.0 -258.0 moveto
196.0 -234.0 lineto
stroke
newpath
324.0 -258.0 moveto
324.0 -240.0 lineto
324.0 -236.0 322.6666666666667 -234.0 320.0 -234.0 curveto
196.0 -234.0 lineto
196.0 -234.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
43.0 -59.0 moveto
(Client) show
171.0 -59.0 moveto
(Client) show
299.0 -59.0 moveto
(Client) show
17.0 -131.0 moveto
("Give me coffee") show
273.0 -131.0 moveto
("Give me tea") show
169.0 -178.0 moveto
(Broker) show
40.0 -286.0 moveto
("Water") show
176.0 -287.0 moveto
("Tea") show
289.0 -287.0 moveto
("Coffee") show
41.0 -322.0 moveto
(Worker) show
169.0 -322.0 moveto
(Worker) show
297.0 -322.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3314 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3314 a 274 x Fj(T)-7 b(o)21
b(implement)e(Majordomo)e(we)k(need)e(to)i(write)f(a)h(frame)n(w)o(ork)
d(for)h(clients)i(and)e(w)o(ork)o(ers.)h(It')-5 b(s)21
b(really)e(not)h(sane)h(to)396 3696 y(ask)g(e)n(v)o(ery)e(application)f
(de)n(v)o(eloper)g(to)i(read)g(the)g(spec)g(and)g(mak)o(e)g(it)h(w)o
(ork,)e(when)h(the)o(y)f(could)g(be)h(using)g(a)h(simpler)396
3804 y(API)g(b)n(uilt)f(and)g(tested)g(just)h(once.)-2
3988 y
SDict begin H.S end
 -2 3988 a -2 3988 a
SDict begin 13 H.A end
 -2 3988 a -2 3988 a
SDict begin [/View [/XYZ H.V]/Dest (0:2177) cvn /DEST pdfmark end
 -2 3988
a 396 4078 a Fj(So,)f(while)h(our)e(\002rst)i(contract)e(\(MDP)i
(itself\))f(de\002nes)g(ho)n(w)g(the)g(pieces)g(of)g(our)f(distrib)n
(uted)h(architecture)e(talk)i(to)396 4186 y(each)g(other)m(,)f(our)g
(second)h(contract)f(de\002nes)h(ho)n(w)f(user)h(applications)f(talk)i
(to)f(the)g(technical)g(frame)n(w)o(ork)e(we')l(re)396
4294 y(going)h(to)h(design.)-2 4478 y
SDict begin H.S end
 -2 4478 a -2 4478
a
SDict begin 13 H.A end
 -2 4478 a -2 4478 a
SDict begin [/View [/XYZ H.V]/Dest (0:2178) cvn /DEST pdfmark end
 -2 4478 a 396 4567 a Fj(Majordomo)e(has)i(tw)o(o)
h(halv)o(es,)e(a)i(client)f(side)h(and)e(a)i(w)o(ork)o(er)e(side.)h
(Since)h(we')o(ll)f(write)h(both)e(client)h(and)g(w)o(ork)o(er)396
4675 y(applications,)f(we)i(will)g(need)e(tw)o(o)h(APIs.)h(Here)f(is)h
(a)g(sk)o(etch)f(for)f(the)i(client)f(API,)g(using)g(a)g(simple)h
(object-oriented)396 4783 y(approach:)-2 4884 y
SDict begin H.S end
 -2 4884
a -2 4884 a
SDict begin 11.7 H.A end
 -2 4884 a -2 4884 a
SDict begin [/View [/XYZ H.V]/Dest (0:2179) cvn /DEST pdfmark end
 -2 4884 a 396 4964 a
Fg(mdcli_t)755 4977 y(*)800 4964 y(mdcli_new)222 b(\(char)1696
4977 y(*)1741 4964 y(broker\);)396 5061 y(void)i(mdcli_destroy)42
b(\(mdcli_t)1831 5074 y(**)1921 5061 y(self_p\);)396
5158 y(zmsg_t)755 5171 y(*)800 5158 y(mdcli_send)177
b(\(mdcli_t)1831 5171 y(*)1876 5158 y(self,)44 b(char)2369
5171 y(*)2414 5158 y(service,)f(zmsg_t)3131 5171 y(**)3221
5158 y(request_p\);)p Black 3756 5569 a Fi(167)p Black
eop end
%%Page: 168 182
TeXDict begin 168 181 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.168) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2180) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(That')i(s)21 b(it.)f(W)-7
b(e)22 b(open)d(a)h(session)h(to)f(the)h(brok)o(er)m(,)d(we)i(send)g(a)
h(request)e(message)h(and)g(get)g(a)h(reply)e(message)h(back,)f(and)396
180 y(we)i(e)n(v)o(entually)d(close)i(the)h(connection.)d(Here')-5
b(s)20 b(a)h(sk)o(etch)f(for)f(the)h(w)o(ork)o(er)g(API:)-2
281 y
SDict begin H.S end
 -2 281 a -2 281 a
SDict begin 11.7 H.A end
 -2 281 a -2 281 a
SDict begin [/View [/XYZ H.V]/Dest (0:2181) cvn /DEST pdfmark end
 -2 281 a 396
361 a Fg(mdwrk_t)755 374 y(*)800 361 y(mdwrk_new)222
b(\(char)1696 374 y(*)1741 361 y(broker,char)2279 374
y(*)2324 361 y(service\);)396 458 y(void)i(mdwrk_destroy)42
b(\(mdwrk_t)1831 471 y(**)1921 458 y(self_p\);)396 555
y(zmsg_t)755 568 y(*)800 555 y(mdwrk_recv)177 b(\(mdwrk_t)1831
568 y(*)1876 555 y(self,)44 b(zmsg_t)2459 568 y(*)2504
555 y(reply\);)-2 732 y
SDict begin H.S end
 -2 732 a -2 732 a
SDict begin 13 H.A end
 -2 732 a -2
732 a
SDict begin [/View [/XYZ H.V]/Dest (0:2182) cvn /DEST pdfmark end
 -2 732 a 396 829 a Fj(It')-5 b(s)21 b(more)e(or)h(less)i
(symmetrical)d(b)n(ut)h(the)g(w)o(ork)o(er)g(dialog)f(is)i(a)g(little)g
(dif)n(ferent.)d(The)i(\002rst)h(time)f(a)h(w)o(ork)o(er)e(does)h(a)396
937 y(recv\(\),)f(it)i(passes)g(a)f(null)g(reply)-5 b(,)19
b(thereafter)g(it)i(passes)g(the)f(current)f(reply)-5
b(,)18 b(and)i(gets)h(a)f(ne)n(w)g(request.)-2 1121 y
SDict begin H.S end

-2 1121 a -2 1121 a
SDict begin 13 H.A end
 -2 1121 a -2 1121 a
SDict begin [/View [/XYZ H.V]/Dest (0:2183) cvn /DEST pdfmark end
 -2 1121 a 396
1211 a Fj(The)g(client)g(and)g(w)o(ork)o(er)f(APIs)i(were)f(f)o(airly)g
(simple)g(to)g(construct,)f(since)i(the)o(y')l(re)d(hea)n(vily)i(based)
f(on)h(the)g(P)o(aranoid)396 1319 y(Pirate)h(code)e(we)i(already)e(de)n
(v)o(eloped.)e(Here)j(is)h(the)g(client)f(API:)-2 1337
y
SDict begin H.S end
 -2 1337 a -2 1337 a
SDict begin 13 H.A end
 -2 1337 a -2 1337 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdcliapi-php) cvn /DEST pdfmark
end
 -2 1337 a 396
1520 a Fk(Example)h(4-7.)e(Majordomo)g(client)h(API)h(\(mdcliapi.php\))
-2 1620 y
SDict begin H.S end
 -2 1620 a -2 1620 a
SDict begin 11.7 H.A end
 -2 1620 a -2 1620 a
SDict begin [/View [/XYZ H.V]/Dest (0:2186) cvn /DEST pdfmark end
 -2
1620 a 396 1700 a Fg(<?php)396 1797 y(/)441 1810 y(*)531
1797 y(======================================)o(======)o(======)o
(======)o(======)o(=====)o(==)441 1907 y(*)531 1894 y(mdcliapi.h)441
2005 y(*)441 2102 y(*)531 2089 y(Majordomo)43 b(Protocol)h(Client)f
(API)441 2199 y(*)531 2186 y(Implements)g(the)h(MDP/Worker)f(spec)i(at)
f(http://rfc.zeromq.org/spec:7.)441 2393 y(*)531 2380
y(--------------------------------------)o(------)o(------)o(------)o
(------)o(-----)o(--)441 2490 y(*)531 2477 y(Copyright)f(\(c\))h
(1991-2011)g(iMatix)g(Corporation)f(<www.imatix.com>)441
2587 y(*)531 2574 y(Copyright)g(other)h(contributors)f(as)h(noted)g(in)
h(the)f(AUTHORS)g(file.)441 2684 y(*)441 2782 y(*)531
2769 y(This)g(file)g(is)h(part)f(of)g(the)h(ZeroMQ)e(Guide:)h
(http://zguide.zeromq.org)441 2879 y(*)441 2976 y(*)531
2963 y(This)g(is)g(free)h(software;)e(you)h(can)h(redistribute)d(it)j
(and/or)f(modify)g(it)g(under)441 3073 y(*)531 3060 y(the)g(terms)g(of)
h(the)f(GNU)g(Lesser)g(General)g(Public)g(License)f(as)i(published)e
(by)441 3170 y(*)531 3157 y(the)h(Free)g(Software)g(Foundation;)f
(either)h(version)f(3)i(of)f(the)h(License,)e(or)i(\(at)441
3267 y(*)531 3254 y(your)f(option\))g(any)g(later)g(version.)441
3364 y(*)441 3462 y(*)531 3449 y(This)g(software)f(is)i(distributed)e
(in)h(the)h(hope)f(that)g(it)h(will)f(be)g(useful,)g(but)441
3559 y(*)531 3546 y(WITHOUT)f(ANY)i(WARRANTY;)e(without)h(even)g(the)g
(implied)g(warranty)f(of)441 3656 y(*)531 3643 y(MERCHANTABILITY)f(or)j
(FITNESS)e(FOR)i(A)f(PARTICULAR)f(PURPOSE.)h(See)g(the)h(GNU)441
3753 y(*)531 3740 y(Lesser)f(General)f(Public)h(License)g(for)g(more)g
(details.)441 3850 y(*)441 3947 y(*)531 3934 y(You)g(should)g(have)g
(received)g(a)g(copy)g(of)h(the)f(GNU)h(Lesser)e(General)h(Public)441
4044 y(*)531 4031 y(License)f(along)h(with)h(this)f(program.)f(If)i
(not,)f(see)441 4142 y(*)531 4129 y(<http://www.gnu.org/licenses/>.)441
4239 y(*)531 4226 y(======================================)o(======)o
(======)o(======)o(======)o(=====)o(==)441 4336 y(*)441
4433 y(*)531 4420 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4530 y(*)486
4517 y(/)396 4614 y(include_once)f("zmsg.php";)396 4711
y(include_once)g("mdp.php";)396 4906 y(class)h(MDCli)g({)441
5003 y(//)89 b(Structure)44 b(of)g(our)h(class)441 5100
y(//)89 b(We)45 b(access)f(these)g(properties)f(only)h(via)g(class)g
(methods)p Black 3759 5569 a Fi(168)p Black eop end
%%Page: 169 183
TeXDict begin 169 182 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.169) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 72 a Fg(private)44 b($broker;)441
170 y(private)g($context;)441 267 y(private)g($client;)f(//)90
b(Socket)43 b(to)i(broker)441 364 y(private)f($verbose;)f(//)89
b(Print)44 b(activity)g(to)g(stdout)441 461 y(private)g($timeout;)f(//)
89 b(Request)44 b(timeout)441 558 y(private)g($retries;)f(//)89
b(Request)44 b(retries)441 752 y(/)486 765 y(**)486 863
y(*)576 850 y(Constructor)486 960 y(*)486 1057 y(*)576
1044 y(@param)f(string)h($broker)486 1154 y(*)576 1141
y(@param)f(boolean)h($verbose)486 1251 y(*)531 1238 y(/)441
1335 y(public)g(function)f(__construct\($broker,)f($verbose)h(=)i
(false\))f({)486 1432 y($this->broker)f(=)h($broker;)486
1530 y($this->context)e(=)j(new)f(ZMQContext\(\);)486
1627 y($this->verbose)e(=)j($verbose;)486 1724 y($this->timeout)d(=)j
(2500;)492 b(//)90 b(msecs)486 1821 y($this->retries)42
b(=)j(3;)627 b(//)90 b(Before)44 b(we)g(abandon)486 1918
y($this->connect_to_broker\(\);)441 2015 y(})441 2209
y(/)486 2222 y(**)486 2320 y(*)576 2307 y(Connect)f(or)i(reconnect)e
(to)i(broker)486 2417 y(*)531 2404 y(/)441 2501 y(protected)e(function)
h(connect_to_broker\(\))e({)486 2598 y(if\($this->client\))g({)531
2695 y(unset\($this->client\);)486 2792 y(})486 2889
y($this->client)h(=)h(new)h(ZMQSocket\($this->context,)40
b(ZMQ::SOCKET_REQ\);)486 2987 y
($this->client->setSockOpt\(ZMQ::SOCKOPT_)o(LINGER)o(,)f(0\);)486
3084 y($this->client->connect\($this->broker\);)486 3181
y(if\($this->verbose\))j({)531 3278 y(printf\("I:)h(connecting)g(to)i
(broker)e(at)i(\045s...",)f($this->broker\);)486 3375
y(})441 3472 y(})441 3666 y(/)486 3679 y(**)486 3777
y(*)576 3764 y(Set)g(request)g(timeout)486 3874 y(*)486
3971 y(*)576 3958 y(@param)f(int)i($timeout)e(\(msecs\))486
4068 y(*)531 4055 y(/)441 4152 y(public)h(function)f
(set_timeout\($timeout\))f({)486 4249 y($this->timeout)g(=)j($timeout;)
441 4346 y(})441 4541 y(/)486 4554 y(**)486 4651 y(*)576
4638 y(Set)f(request)g(retries)486 4748 y(*)486 4845
y(*)576 4832 y(@param)f(int)i($retries)486 4942 y(*)531
4929 y(/)441 5026 y(public)f(function)f(set_retries\($retries\))f({)486
5124 y($this->retries)g(=)j($retries;)p Black 3759 5569
a Fi(169)p Black eop end
%%Page: 170 184
TeXDict begin 170 183 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.170) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 72 a Fg(})441 267 y(/)486 280 y(**)486
377 y(*)576 364 y(Send)44 b(request)f(to)i(broker)f(and)g(get)g(reply)g
(by)h(hook)f(or)h(crook)486 474 y(*)576 461 y(Takes)f(ownership)f(of)h
(request)g(message)g(and)g(destroys)g(it)g(when)g(sent.)486
571 y(*)576 558 y(Returns)f(the)i(reply)f(message)f(or)i(NULL)f(if)g
(there)g(was)h(no)f(reply.)486 668 y(*)486 765 y(*)576
752 y(@param)f(string)h($service)486 863 y(*)576 850
y(@param)f(Zmsg)i($request)486 960 y(*)576 947 y(@param)e(string)h
($client)486 1057 y(*)576 1044 y(@return)f(Zmsg)486 1154
y(*)531 1141 y(/)441 1238 y(public)h(function)f(send\($service,)g(Zmsg)
h($request\))f({)486 1335 y(//)89 b(Prefix)44 b(request)g(with)g
(protocol)f(frames)486 1432 y(//)89 b(Frame)44 b(1:)h("MDPCxy")e(\(six)
h(bytes,)g(MDP/Client)486 1530 y(//)89 b(Frame)44 b(2:)h(Service)e
(name)i(\(printable)e(string\))486 1627 y($request->push\($service\);)
486 1724 y($request->push\(MDPC_CLIENT\);)486 1821 y(if)h
(\($this->verbose\))f({)531 1918 y(printf)h(\("I:)g(send)g(request)g
(to)g('\045s')g(service:",)f($service\);)531 2015 y(echo)h
($request->__toString\(\);)486 2112 y(})486 2307 y($retries_left)f(=)h
($this->retries;)486 2404 y($read)g(=)h($write)e(=)i(array\(\);)486
2501 y(while\($retries_left\))c({)531 2598 y
($request->set_socket\($this->client\)->s)o(end\(\);)576
2792 y(//)89 b(Poll)44 b(socket)g(for)g(a)h(reply,)f(with)g(timeout)531
2889 y($poll)g(=)g(new)h(ZMQPoll\(\);)531 2987 y
($poll->add\($this->client,)40 b(ZMQ::POLL_IN\);)531
3084 y($events)j(=)i($poll->poll\($read,)d($write,)i($this->timeout\);)
531 3278 y(//)89 b(If)45 b(we)f(got)g(a)h(reply,)f(process)g(it)531
3375 y(if\($events\))f({)576 3472 y($request->recv\(\);)576
3569 y(if)h(\($this->verbose\))e({)620 3666 y(echo)j("I:)f(received)f
(reply:",)h($request->__toString\(\),)d(PHP_EOL;)576
3764 y(})576 3861 y(//)89 b(Don't)44 b(try)g(to)h(handle)f(errors,)f
(just)h(assert)g(noisily)576 3958 y(assert)f(\($request->parts\(\))f
(>=)j(3\);)576 4152 y($header)e(=)i($request->pop\(\);)576
4249 y(assert\($header)d(==)j(MDPC_CLIENT\);)576 4444
y($reply_service)d(=)j($request->pop\(\);)576 4541 y
(assert\($reply_service)c(==)j($service\);)576 4735 y(return)f
($request;)h(//)89 b(Success)531 4832 y(})44 b(else)h
(if\($retries_left--\))c({)576 4929 y(if\($this->verbose\))g({)620
5026 y(echo)k("W:)f(no)g(reply,)g(reconnecting...",)e(PHP_EOL;)576
5124 y(})p Black 3759 5569 a Fi(170)p Black eop end
%%Page: 171 185
TeXDict begin 171 184 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.171) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 72 a Fg(//)89 b(Reconnect,)43 b(and)h(resend)g
(message)576 170 y($this->connect_to_broker\(\);)576
267 y($request->send\(\);)531 364 y(})g(else)h({)576
461 y(echo)f("W:)g(permanent)f(error,)h(abandoning)f(request",)h
(PHP_EOL;)576 558 y(break;)f(//)90 b(Give)44 b(up)531
655 y(})486 752 y(})441 850 y(})-2 1024 y
SDict begin H.S end
 -2 1024 a -2
1024 a
SDict begin 13 H.A end
 -2 1024 a -2 1024 a
SDict begin [/View [/XYZ H.V]/Dest (0:2187) cvn /DEST pdfmark end
 -2 1024 a 396 1124 a Fj(W)m(ith)21
b(an)f(e)o(xample)f(test)i(program)d(that)i(does)g(100K)f
(request-reply)f(c)o(ycles:)-2 1142 y
SDict begin H.S end
 -2 1142 a -2 1142
a
SDict begin 13 H.A end
 -2 1142 a -2 1142 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdclient-php) cvn /DEST pdfmark
end
 -2 1142 a 396 1325 a Fk(Example)j(4-8.)e
(Majordomo)g(client)h(application)g(\(mdclient.php\))-2
1425 y
SDict begin H.S end
 -2 1425 a -2 1425 a
SDict begin 11.7 H.A end
 -2 1425 a -2 1425 a
SDict begin [/View [/XYZ H.V]/Dest (0:2190) cvn /DEST pdfmark end
 -2 1425
a 396 1505 a Fg(<?php)396 1602 y(/)441 1615 y(*)441 1712
y(*)531 1699 y(Majordomo)43 b(Protocol)h(client)f(example)441
1809 y(*)531 1796 y(Uses)h(the)g(mdcli)g(API)h(to)f(hide)g(all)h(MDP)f
(aspects)441 1907 y(*)441 2004 y(*)531 1991 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 2101 y(*)486
2088 y(/)396 2185 y(include_once)f("mdcliapi.php";)396
2379 y($verbose)h(=)g($_SERVER['argc'])f(>)h(1)h(&&)f
($_SERVER['argv'][1])e(==)j('-v';)396 2476 y($session)f(=)g(new)h
(MDCli\("tcp://localhost:5555",)40 b($verbose\);)396
2574 y(for\($count)j(=)i(0;)g($count)e(<)i(100000;)f($count++\))f({)441
2671 y($request)h(=)g(new)h(Zmsg\(\);)441 2768 y
($request->body_set\("Hello)c(world"\);)441 2865 y($reply)j(=)h
($session->send\("echo",)c($request\);)441 2962 y(if\(!$reply\))i({)486
3059 y(break;)h(//)g(Interrupt)g(or)g(failure)441 3156
y(})396 3253 y(})396 3351 y(printf)g(\("\045d)g(requests/replies)e
(processed",)h($count\);)396 3448 y(echo)h(PHP_EOL;)-2
3624 y
SDict begin H.S end
 -2 3624 a -2 3624 a
SDict begin 13 H.A end
 -2 3624 a -2 3624 a
SDict begin [/View [/XYZ H.V]/Dest (0:2191) cvn /DEST pdfmark end
 -2 3624
a 396 3722 a Fj(And)20 b(here)g(is)h(the)f(w)o(ork)o(er)f(API:)-2
3723 y
SDict begin H.S end
 -2 3723 a -2 3723 a
SDict begin 13 H.A end
 -2 3723 a -2 3723 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdwrkapi-php) cvn /DEST pdfmark
end
 -2 3723
a 396 3923 a Fk(Example)i(4-9.)e(Majordomo)g(w)o(ork)o(er)h(API)h(\(md)
o(wrkapi.php\))-2 4023 y
SDict begin H.S end
 -2 4023 a -2 4023 a
SDict begin 11.7 H.A end
 -2 4023
a -2 4023 a
SDict begin [/View [/XYZ H.V]/Dest (0:2194) cvn /DEST pdfmark end
 -2 4023 a 396 4103 a Fg(<?php)396 4200 y(/)441
4213 y(*)531 4200 y(======================================)o(======)o
(======)o(======)o(======)o(=====)o(==)441 4310 y(*)531
4297 y(mdwrkapi.php)441 4408 y(*)441 4505 y(*)531 4492
y(Majordomo)43 b(Protocol)h(Worker)f(API)441 4602 y(*)531
4589 y(Implements)g(the)h(MDP/Worker)f(spec)i(at)f
(http://rfc.zeromq.org/spec:7.)441 4699 y(*)441 4796
y(*)531 4783 y(--------------------------------------)o(------)o
(------)o(------)o(------)o(-----)o(--)441 4893 y(*)531
4880 y(Copyright)f(\(c\))h(1991-2011)g(iMatix)g(Corporation)f
(<www.imatix.com>)441 4990 y(*)531 4977 y(Copyright)g(other)h
(contributors)f(as)h(noted)g(in)h(the)f(AUTHORS)g(file.)441
5088 y(*)p Black 3759 5569 a Fi(171)p Black eop end
%%Page: 172 186
TeXDict begin 172 185 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.172) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 85 a Fg(*)531 72 y(This)44 b(file)g(is)h(part)f
(of)g(the)h(ZeroMQ)e(Guide:)h(http://zguide.zeromq.org)441
183 y(*)441 280 y(*)531 267 y(This)g(is)g(free)h(software;)e(you)h(can)
h(redistribute)d(it)j(and/or)f(modify)g(it)g(under)441
377 y(*)531 364 y(the)g(terms)g(of)h(the)f(GNU)g(Lesser)g(General)g
(Public)g(License)f(as)i(published)e(by)441 474 y(*)531
461 y(the)h(Free)g(Software)g(Foundation;)f(either)h(version)f(3)i(of)f
(the)h(License,)e(or)i(\(at)441 571 y(*)531 558 y(your)f(option\))g
(any)g(later)g(version.)441 668 y(*)441 765 y(*)531 752
y(This)g(software)f(is)i(distributed)e(in)h(the)h(hope)f(that)g(it)h
(will)f(be)g(useful,)g(but)441 863 y(*)531 850 y(WITHOUT)f(ANY)i
(WARRANTY;)e(without)h(even)g(the)g(implied)g(warranty)f(of)441
960 y(*)531 947 y(MERCHANTABILITY)f(or)j(FITNESS)e(FOR)i(A)f
(PARTICULAR)f(PURPOSE.)h(See)g(the)h(GNU)441 1057 y(*)531
1044 y(Lesser)f(General)f(Public)h(License)g(for)g(more)g(details.)441
1154 y(*)441 1251 y(*)531 1238 y(You)g(should)g(have)g(received)g(a)g
(copy)g(of)h(the)f(GNU)h(Lesser)e(General)h(Public)441
1348 y(*)531 1335 y(License)f(along)h(with)h(this)f(program.)f(If)i
(not,)f(see)441 1445 y(*)531 1432 y(<http://www.gnu.org/licenses/>.)441
1543 y(*)531 1530 y(======================================)o(======)o
(======)o(======)o(======)o(=====)o(==)441 1640 y(*)531
1627 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1737 y(*)486
1724 y(/)396 1918 y(include_once)f("zmsg.php";)396 2015
y(include_once)g("mdp.php";)396 2209 y(//)90 b(Reliability)43
b(parameters)396 2307 y(define\("HEARTBEAT_LIVENESS",)d(3\);)45
b(//)89 b(3-5)44 b(is)h(reasonable)396 2695 y(//)90 b(Structure)43
b(of)h(our)h(class)396 2792 y(//)90 b(We)44 b(access)g(these)g
(properties)f(only)h(via)h(class)f(methods)396 2889 y(class)g(MDWrk)g
({)576 2987 y(private)f($ctx;)493 b(//)89 b(Our)44 b(context)576
3084 y(private)f($broker;)576 3181 y(private)g($service;)576
3278 y(private)g($worker;)358 b(//)89 b(Socket)44 b(to)g(broker)576
3375 y(private)f($verbose)h(=)g(false;)313 b(//)90 b(Print)44
b(activity)f(to)i(stdout)576 3569 y(//)89 b(Heartbeat)43
b(management)576 3666 y(private)g($heartbeat_at;)88 b(//)h(When)44
b(to)h(send)f(HEARTBEAT)576 3764 y(private)f($liveness;)268
b(//)89 b(How)44 b(many)g(attempts)g(left)576 3861 y(private)f
($heartbeat;)223 b(//)89 b(Heartbeat)43 b(delay,)h(msecs)576
3958 y(private)f($reconnect;)223 b(//)89 b(Reconnect)43
b(delay,)h(msecs)576 4152 y(//)89 b(Internal)43 b(state)576
4249 y(private)g($expect_reply)g(=)i(0;)576 4444 y(//)89
b(Return)44 b(address,)f(if)i(any)576 4541 y(private)e($reply_to;)441
4735 y(/)486 4748 y(**)486 4845 y(*)576 4832 y(Constructor)486
4942 y(*)486 5039 y(*)576 5026 y(@param)g(string)h($broker)486
5137 y(*)576 5124 y(@param)f(string)h($service)p Black
3759 5569 a Fi(172)p Black eop end
%%Page: 173 187
TeXDict begin 173 186 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.173) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 486 85 a Fg(*)576 72 y(@param)43 b(boolean)h
($verbose)486 183 y(*)531 170 y(/)576 267 y(public)f(function)h
(__construct\($broker,)d($service,)j($verbose)f(=)i(false\))f({)755
364 y($this->ctx)f(=)i(new)f(ZMQContext\(\);)755 461
y($this->broker)f(=)h($broker;)755 558 y($this->service)e(=)j
($service;)755 655 y($this->verbose)d(=)j($verbose;)755
752 y($this->heartbeat)d(=)j(2500;)f(//)g(msecs)755 850
y($this->reconnect)e(=)j(2500;)f(//)g(msecs)755 1044
y($this->connect_to_broker\(\);)576 1141 y(})576 1335
y(/)621 1348 y(**)486 1445 y(*)576 1432 y(Send)g(message)f(to)i(broker)
620 1543 y(*)710 1530 y(If)g(no)f(msg)g(is)h(provided,)e(creates)h(one)
g(internally)486 1640 y(*)486 1737 y(*)576 1724 y(@param)f(string)h
($command)486 1834 y(*)576 1821 y(@param)f(string)h($option)486
1931 y(*)576 1918 y(@param)f(Zmsg)i($msg)486 2028 y(*)531
2015 y(/)576 2112 y(public)e(function)h(send_to_broker\($command,)d
($option,)i($msg)h(=)h(null\))f({)755 2209 y($msg)g(=)h($msg)f(?)h
($msg)f(:)g(new)h(Zmsg\(\);)755 2404 y(if\($option\))e({)934
2501 y($msg->push\($option\);)755 2598 y(})755 2695 y
($msg->push\($command\);)755 2792 y($msg->push\(MDPW_WORKER\);)755
2889 y($msg->push\(""\);)755 3084 y(if\($this->verbose\))f({)934
3181 y(printf\("I:)h(sending)h(\045s)h(to)f(broker)g(\045s",)g
($command,)f(PHP_EOL\);)934 3278 y(echo)h($msg->__toString\(\);)755
3375 y(})755 3569 y($msg->set_socket\($this->worker\)->send\(\))o(;)576
3666 y(})576 3861 y(/)621 3874 y(**)620 3971 y(*)710
3958 y(Connect)g(or)g(reconnect)g(to)g(broker)620 4068
y(*)665 4055 y(/)576 4152 y(public)f(function)h(connect_to_broker\(\))e
({)755 4249 y($this->worker)h(=)h(new)h(ZMQSocket\($this->ctx,)c
(ZMQ::SOCKET_DEALER\);)755 4346 y
($this->worker->connect\($this->broker\);)755 4444 y
(if\($this->verbose\))h({)934 4541 y(printf\("I:)h(connecting)h(to)g
(broker)g(at)g(\045s...)g(\045s",)h($this->broker,)d(PHP_EOL\);)755
4638 y(})755 4832 y(//)89 b(Register)44 b(service)f(with)i(broker)755
4929 y($this->send_to_broker\(MDPW_READY,)39 b($this->service,)k
(NULL\);)755 5124 y(//)89 b(If)45 b(liveness)e(hits)h(zero,)g(queue)g
(is)h(considered)e(disconnected)p Black 3759 5569 a Fi(173)p
Black eop end
%%Page: 174 188
TeXDict begin 174 187 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.174) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 755 72 a Fg($this->liveness)42 b(=)j
(HEARTBEAT_LIVENESS;)755 170 y($this->heartbeat_at)d(=)i
(microtime\(true\))f(+)h(\($this->heartbeat)e(/)j(1000\);)576
267 y(})576 461 y(/)621 474 y(**)486 571 y(*)576 558
y(Set)f(heartbeat)f(delay)486 668 y(*)486 765 y(*)576
752 y(@param)g(int)i($heartbeat)486 863 y(*)531 850 y(/)576
947 y(public)e(function)h(set_heartbeat\($heartbeat\))d({)755
1044 y($this->heartbeat)h(=)j($heartbeat;)576 1141 y(})576
1335 y(/)621 1348 y(**)620 1445 y(*)710 1432 y(Set)f(reconnect)g(delay)
486 1543 y(*)486 1640 y(*)576 1627 y(@param)f(int)i($reconnect)620
1737 y(*)665 1724 y(/)576 1821 y(public)e(function)h
(set_reconnect\($reconnect\))d({)755 1918 y($this->reconnect)h(=)j
($reconnect;)576 2015 y(})576 2209 y(/)621 2222 y(**)620
2320 y(*)710 2307 y(Send)f(reply,)g(if)h(any,)f(to)g(broker)g(and)g
(wait)h(for)f(next)g(request.)486 2417 y(*)486 2514 y(*)576
2501 y(@param)f(Zmsg)i($reply)486 2611 y(*)576 2598 y(@return)e(Zmsg)h
(Returns)g(if)h(there)f(is)g(a)h(request)e(to)i(process)620
2708 y(*)665 2695 y(/)576 2792 y(public)e(function)h(recv\($reply)f(=)i
(null\))f({)755 2889 y(//)89 b(Format)44 b(and)g(send)h(the)f(reply)g
(if)g(we)h(were)f(provided)g(one)755 2987 y(assert)g(\($reply)f(||)i
(!$this->expect_reply\);)755 3084 y(if\($reply\))e({)934
3181 y($reply->wrap\($this->reply_to\);)934 3278 y
($this->send_to_broker\(MDPW_REPLY,)d(NULL,)k($reply\);)755
3375 y(})755 3472 y($this->expect_reply)e(=)i(true;)755
3666 y($read)g(=)h($write)e(=)i(array\(\);)755 3764 y(while\(true\))e
({)934 3861 y($poll)h(=)h(new)f(ZMQPoll\(\);)934 3958
y($poll->add\($this->worker,)d(ZMQ::POLL_IN\);)934 4055
y($events)j(=)h($poll->poll\($read,)c($write,)j($this->heartbeat\);)934
4249 y(if\($events\))f({)1114 4346 y($zmsg)h(=)g(new)h
(Zmsg\($this->worker\);)1114 4444 y($zmsg->recv\(\);)1114
4638 y(if\($this->verbose\))c({)1293 4735 y(echo)j("I:)g(received)g
(message)g(from)g(broker:",)f(PHP_EOL;)1293 4832 y(echo)h
($zmsg->__toString\(\);)1114 4929 y(})1114 5124 y($this->liveness)e(=)j
(HEARTBEAT_LIVENESS;)p Black 3759 5569 a Fi(174)p Black
eop end
%%Page: 175 189
TeXDict begin 175 188 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.175) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 1114 170 a Fg(//)89 b(Don't)44 b(try)g(to)h(handle)f
(errors,)f(just)h(assert)g(noisily)1114 267 y(assert)f
(\($zmsg->parts\(\))g(>=)h(3\);)1114 461 y($zmsg->pop\(\);)1114
558 y($header)f(=)i($zmsg->pop\(\);)1114 655 y(assert\($header)d(==)j
(MDPW_WORKER\);)1114 850 y($command)e(=)i($zmsg->pop\(\);)1114
947 y(if\($command)e(==)h(MDPW_REQUEST\))f({)1293 1044
y(//)89 b(We)45 b(should)f(pop)g(and)g(save)g(as)h(many)f(addresses)f
(as)i(there)f(are)1293 1141 y(//)89 b(up)45 b(to)f(a)h(null)f(part,)g
(but)g(for)h(now,)f(just)g(save)g(one...)1293 1238 y($this->reply_to)e
(=)j($zmsg->unwrap\(\);)1293 1335 y(return)f($zmsg;//)88
b(We)45 b(have)f(a)g(request)g(to)h(process)1114 1432
y(})f(else)g(if\($command)f(==)i(MDPW_HEARTBEAT\))d({)1293
1530 y(//)i(Do)h(nothing)f(for)g(heartbeats)1114 1627
y(})g(else)g(if\($command)f(==)i(MDPW_DISCONNECT\))d({)1293
1724 y($this->connect_to_broker\(\);)1114 1821 y(})i(else)g({)1293
1918 y(echo)g("E:)g(invalid)g(input)g(message",)f(PHP_EOL;)1293
2015 y(echo)h($zmsg->__toString\(\);)1114 2112 y(})934
2209 y(})h(else)f(if\(--$this->liveness)e(==)i(0\))h({)f(//)h(poll)f
(ended)g(on)g(timeout,)g($event)g(being)g(false)1114
2307 y(if\($this->verbose\))d({)1293 2404 y(echo)j("W:)g(disconnected)f
(from)h(broker)g(-)h(retrying...",)d(PHP_EOL;)1114 2501
y(})1114 2598 y(usleep\($this->reconnect)2149 2611 y(*)2194
2598 y(1000\);)1114 2695 y($this->connect_to_broker\(\);)934
2792 y(})934 2987 y(//)j(Send)f(HEARTBEAT)f(if)i(it's)f(time)934
3084 y(if\(microtime\(true\))e(>)j($this->heartbeat_at\))c({)1114
3181 y($this->send_to_broker\(MDPW_HEARTBEAT,)d(NULL,)44
b(NULL\);)1114 3278 y($this->heartbeat_at)d(=)k(microtime\(true\))d(+)j
(\($this->heartbeat/1000\);)934 3375 y(})755 3472 y(})576
3569 y(})-2 3744 y
SDict begin H.S end
 -2 3744 a -2 3744 a
SDict begin 13 H.A end
 -2 3744 a -2 3744
a
SDict begin [/View [/XYZ H.V]/Dest (0:2195) cvn /DEST pdfmark end
 -2 3744 a 396 3843 a Fj(W)m(ith)21 b(an)f(e)o(xample)f(test)i
(program)d(that)i(implements)f(an)h('echo')f(service:)-2
3861 y
SDict begin H.S end
 -2 3861 a -2 3861 a
SDict begin 13 H.A end
 -2 3861 a -2 3861 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdworker-php) cvn /DEST pdfmark
end
 -2 3861
a 396 4045 a Fk(Example)i(4-10.)d(Majordomo)h(w)o(ork)o(er)i
(application)e(\(md)o(w)o(ork)o(er)-8 b(.php\))-2 4145
y
SDict begin H.S end
 -2 4145 a -2 4145 a
SDict begin 11.7 H.A end
 -2 4145 a -2 4145 a
SDict begin [/View [/XYZ H.V]/Dest (0:2198) cvn /DEST pdfmark end
 -2 4145 a 396
4225 a Fg(<?php)396 4322 y(/)441 4335 y(*)441 4432 y(*)531
4419 y(Majordomo)43 b(Protocol)h(worker)f(example)441
4529 y(*)531 4516 y(Uses)h(the)g(mdwrk)g(API)h(to)f(hide)g(all)h(MDP)f
(aspects)441 4626 y(*)441 4724 y(*)531 4711 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4821 y(*)486
4808 y(/)396 5002 y(include_once)f("mdwrkapi.php";)p
Black 3759 5569 a Fi(175)p Black eop end
%%Page: 176 190
TeXDict begin 176 189 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.176) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fg($verbose)44 b(=)g($_SERVER['argc'])f(>)h
(1)h(&&)f($_SERVER['argv'][1])e(==)j("-v";)396 267 y($mdwrk)f(=)h(new)f
(Mdwrk\("tcp://localhost:5555",)c("echo",)k($verbose\);)396
461 y($reply)g(=)h(NULL;)396 558 y(while\(true\))e({)576
655 y($request)g(=)i($mdwrk->recv\($reply\);)576 752
y($reply)e(=)i($request;)268 b(//)89 b(Echo)44 b(is)h(complex...)e
(:-\))-2 930 y
SDict begin H.S end
 -2 930 a -2 930 a
SDict begin 13 H.A end
 -2 930 a -2 930 a
SDict begin [/View [/XYZ H.V]/Dest (0:2199) cvn /DEST pdfmark end
 -2
930 a 396 1026 a Fj(Notes)21 b(on)e(this)i(code:)-2 1027
y
SDict begin H.S end
 -2 1027 a -2 1027 a
SDict begin 13 H.A end
 -2 1027 a -2 1027 a
SDict begin [/View [/XYZ H.V]/Dest (0:2200) cvn /DEST pdfmark end
 -2 1027 a -2
1037 a
SDict begin H.S end
 -2 1037 a -2 1037 a
SDict begin 13 H.A end
 -2 1037 a -2 1037 a
SDict begin [/View [/XYZ H.V]/Dest (0:2201) cvn /DEST pdfmark end
 -2 1037
a Black 396 1197 a Fe(\225)p Black 479 1197 a
SDict begin H.S end
 479 1197
a 479 1197 a
SDict begin 13 H.A end
 479 1197 a 479 1197 a
SDict begin [/View [/XYZ H.V]/Dest (0:2202) cvn /DEST pdfmark end
 479 1197 a Fj(The)f(APIs)h(are)f
(single)g(threaded.)f(This)h(means,)g(for)f(e)o(xample,)g(that)h(the)g
(w)o(ork)o(er)f(w)o(on')o(t)g(send)h(heartbeats)g(in)g(the)479
1305 y(background.)c(Happily)-5 b(,)18 b(this)i(is)h(e)o(xactly)e(what)
g(we)h(w)o(ant:)g(if)g(the)f(w)o(ork)o(er)g(application)f(gets)i
(stuck,)f(heartbeats)g(will)479 1412 y(stop)h(and)g(the)g(brok)o(er)f
(will)i(stop)f(sending)f(requests)h(to)g(the)g(w)o(ork)o(er)-5
b(.)-2 1430 y
SDict begin H.S end
 -2 1430 a -2 1430 a
SDict begin 13 H.A end
 -2 1430 a -2 1430 a
SDict begin [/View [/XYZ H.V]/Dest (0:2203) cvn /DEST pdfmark end

-2 1430 a Black 396 1562 a Fe(\225)p Black 479 1562 a
SDict begin H.S end

479 1562 a 479 1562 a
SDict begin 13 H.A end
 479 1562 a 479 1562 a
SDict begin [/View [/XYZ H.V]/Dest (0:2204) cvn /DEST pdfmark end
 479 1562
a Fj(The)20 b(w)o(ork)o(er)f(API)i(doesn')o(t)e(do)g(an)h(e)o
(xponential)e(back-of)n(f,)g(it')-5 b(s)21 b(not)f(w)o(orth)g(the)g(e)o
(xtra)f(comple)o(xity)-5 b(.)-2 1580 y
SDict begin H.S end
 -2 1580 a -2 1580
a
SDict begin 13 H.A end
 -2 1580 a -2 1580 a
SDict begin [/View [/XYZ H.V]/Dest (0:2205) cvn /DEST pdfmark end
 -2 1580 a Black 396 1711 a Fe(\225)p
Black 479 1711 a
SDict begin H.S end
 479 1711 a 479 1711 a
SDict begin 13 H.A end
 479 1711 a 479
1711 a
SDict begin [/View [/XYZ H.V]/Dest (0:2206) cvn /DEST pdfmark end
 479 1711 a Fj(The)20 b(APIs)h(don')o(t)d(do)i(an)o(y)g(error)f
(reporting.)f(If)i(something)e(isn')o(t)i(as)h(e)o(xpected,)d(the)o(y)i
(raise)g(an)h(assertion)e(\(or)479 1819 y(e)o(xception)g(depending)e
(on)j(the)g(language\).)e(This)i(is)i(ideal)e(for)f(a)i(reference)d
(implementation,)g(so)j(an)o(y)e(protocol)479 1927 y(errors)h(sho)n(w)g
(immediately)-5 b(.)18 b(F)o(or)i(real)g(applications)f(the)h(API)h
(should)e(be)h(rob)n(ust)f(against)h(in)m(v)n(alid)f(messages.)-2
2111 y
SDict begin H.S end
 -2 2111 a -2 2111 a
SDict begin 13 H.A end
 -2 2111 a -2 2111 a
SDict begin [/View [/XYZ H.V]/Dest (0:2207) cvn /DEST pdfmark end
 -2 2111
a 396 2201 a Fj(Y)-9 b(ou)20 b(might)f(w)o(onder)g(why)h(the)g(w)o(ork)
o(er)f(API)i(is)g(manually)d(closing)i(its)h(sock)o(et)f(and)g(opening)
e(a)j(ne)n(w)f(one,)f(when)396 2309 y(\330MQ)i(will)g(automatically)d
(reconnect)h(a)h(sock)o(et)g(if)h(the)f(peer)g(disappears)f(and)h
(comes)g(back.)f(Look)g(back)g(at)i(the)396 2417 y(Simple)f(Pirate)h(w)
o(ork)o(er)m(,)d(and)i(the)g(P)o(aranoid)f(Pirate)h(w)o(ork)o(er)g(to)g
(understand.)e(While)i(\330MQ)h(will)g(automatically)396
2525 y(reconnect)e(w)o(ork)o(ers,)g(if)h(the)h(brok)o(er)d(dies)j(and)e
(comes)h(back)g(up,)f(this)i(isn')o(t)f(suf)n(\002cient)g(to)g(re-re)o
(gister)f(the)h(w)o(ork)o(ers)396 2633 y(with)h(the)f(brok)o(er)-5
b(.)19 b(There)g(are)h(at)h(least)g(tw)o(o)f(solutions)g(I)g(kno)n(w)f
(of.)h(The)g(simplest,)g(which)g(we)g(use)h(here,)e(is)i(that)g(the)396
2741 y(w)o(ork)o(er)d(monitors)f(the)i(connection)e(using)h
(heartbeats,)f(and)h(if)h(it)h(decides)e(the)h(brok)o(er)e(is)i(dead,)f
(closes)h(its)h(sock)o(et)e(and)396 2849 y(starts)j(afresh)f(with)g(a)h
(ne)n(w)f(sock)o(et.)g(The)f(alternati)n(v)o(e)g(is)i(for)f(the)g(brok)
o(er)f(to)h(challenge)f(unkno)n(wn)f(w)o(ork)o(ers)h(--)h(when)g(it)396
2957 y(gets)h(a)f(heartbeat)f(from)h(the)g(w)o(ork)o(er)f(--)h(and)g
(ask)g(them)g(to)g(re-re)o(gister)-5 b(.)19 b(That)h(w)o(ould)f
(require)g(protocol)g(support.)-2 3141 y
SDict begin H.S end
 -2 3141 a -2
3141 a
SDict begin 13 H.A end
 -2 3141 a -2 3141 a
SDict begin [/View [/XYZ H.V]/Dest (0:2208) cvn /DEST pdfmark end
 -2 3141 a 396 3231 a Fj(Let')-5
b(s)21 b(design)f(the)g(Majordomo)e(brok)o(er)-5 b(.)18
b(Its)j(core)f(structure)f(is)i(a)g(set)g(of)f(queues,)f(one)g(per)h
(service.)g(W)-7 b(e)21 b(will)g(create)396 3339 y(these)g(queues)e(as)
i(w)o(ork)o(ers)e(appear)g(\(we)i(could)e(delete)h(them)g(as)h(w)o(ork)
o(ers)e(disappear)g(b)n(ut)h(for)o(get)f(that)h(for)f(no)n(w)-5
b(,)19 b(it)396 3446 y(gets)i(comple)o(x\).)d(Additionally)-5
b(,)17 b(we)k(k)o(eep)f(a)g(queue)f(of)h(w)o(ork)o(ers)g(per)g
(service.)-2 3631 y
SDict begin H.S end
 -2 3631 a -2 3631 a
SDict begin 13 H.A end
 -2 3631 a -2
3631 a
SDict begin [/View [/XYZ H.V]/Dest (0:2209) cvn /DEST pdfmark end
 -2 3631 a 396 3720 a Fj(And)g(here)g(is)h(the)f(brok)o(er:)-2
3721 y
SDict begin H.S end
 -2 3721 a -2 3721 a
SDict begin 13 H.A end
 -2 3721 a -2 3721 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdbroker-php) cvn /DEST pdfmark
end
 -2 3721
a 396 3922 a Fk(Example)h(4-11.)d(Majordomo)h(br)o(ok)o(er)h(\(mdbr)o
(ok)o(er)-8 b(.php\))-2 4022 y
SDict begin H.S end
 -2 4022 a -2 4022 a
SDict begin 11.7 H.A end
 -2
4022 a -2 4022 a
SDict begin [/View [/XYZ H.V]/Dest (0:2212) cvn /DEST pdfmark end
 -2 4022 a 396 4102 a Fg(<?php)396 4296
y(/)441 4309 y(*)441 4503 y(*)531 4490 y(Majordomo)43
b(Protocol)h(broker)441 4698 y(*)531 4685 y(A)g(minimal)g
(implementation)f(of)h(http://rfc.zeromq.org/spec:7)c(and)45
b(spec:8)441 4892 y(*)531 4879 y(@author)e(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 5086 y(*)486
5073 y(/)p Black 3757 5569 a Fi(176)p Black eop end
%%Page: 177 191
TeXDict begin 177 190 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.177) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 170 a Fg(include_once)43 b("zmsg.php";)396
364 y(include_once)g("mdp.php";)396 752 y(//)90 b(We'd)44
b(normally)f(pull)h(these)g(from)h(config)e(data)396
947 y(define\("HEARTBEAT_LIVENESS",)d(3\);)179 b(//)90
b(3-5)44 b(is)g(reasonable)396 1141 y(define\("HEARTBEAT_INTERVAL",)c
(2500\);)k(//)90 b(msecs)396 1335 y(define\("HEARTBEAT_EXPIRY",)41
b(HEARTBEAT_INTERVAL)2459 1348 y(*)2548 1335 y(HEARTBEAT_LIVENESS\);)
396 1724 y(/)441 1737 y(*)531 1724 y(Main)j(broker)g(work)g(happens)g
(here)1876 1737 y(*)1921 1724 y(/)396 1918 y($verbose)g(=)g
($_SERVER['argc'])f(>)h(1)h(&&)f($_SERVER['argv'][1])e(==)j('-v';)396
2112 y($broker)f(=)h(new)f(Mdbroker\($verbose\);)396
2307 y($broker->bind\("tcp://)1341 2320 y(*)1386 2307
y(:5555"\);)396 2501 y($broker->listen\(\);)396 2889
y(class)g(Mdbroker)g({)576 3084 y(private)f($ctx;)672
b(//)89 b(Our)45 b(context)576 3278 y(private)e($socket;)537
b(//)89 b(Socket)44 b(for)g(clients)g(&)h(workers)576
3472 y(private)e($endpoint;)447 b(//)89 b(Broker)44 b(binds)g(to)h
(this)f(endpoint)576 3861 y(private)f($services)h(=)g(array\(\);)447
b(//)90 b(Hash)44 b(of)g(known)g(services)576 4055 y(private)f
($workers)h(=)g(array\(\);)492 b(//)90 b(Hash)44 b(of)g(known)g
(workers)576 4249 y(private)f($waiting)h(=)g(array\(\);)492
b(//)90 b(List)44 b(of)g(waiting)g(workers)576 4638 y(private)f
($verbose)h(=)g(false;)134 b(//)89 b(Print)44 b(activity)g(to)g(stdout)
576 5026 y(//)89 b(Heartbeat)43 b(management)p Black
3756 5569 a Fi(177)p Black eop end
%%Page: 178 192
TeXDict begin 178 191 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.178) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 72 a Fg(private)43 b($heartbeat_at;)88
b(//)h(When)44 b(to)h(send)f(HEARTBEAT)576 461 y(/)621
474 y(**)620 668 y(*)710 655 y(Constructor)620 863 y(*)620
1057 y(*)710 1044 y(@param)g(boolean)g($verbose)620 1251
y(*)665 1238 y(/)576 1432 y(public)f(function)h(__construct\($verbose)d
(=)k(false\))f({)755 1627 y($this->ctx)f(=)i(new)f(ZMQContext\(\);)755
1821 y($this->socket)f(=)h(new)h(ZMQSocket\($this->ctx,)c
(ZMQ::SOCKET_ROUTER\);)755 2015 y($this->verbose)h(=)j($verbose;)755
2209 y($this->heartbeat_at)d(=)i(microtime\(true\))f(+)h
(\(HEARTBEAT_INTERVAL/1000\);)576 2404 y(})576 2792 y(/)621
2805 y(**)620 3000 y(*)710 2987 y(Bind)g(broker)g(to)h(endpoint,)e(can)
h(call)g(this)h(multiple)e(time)620 3194 y(*)710 3181
y(We)i(use)f(a)h(single)e(socket)h(for)h(both)f(clients)f(and)i
(workers.)620 3388 y(*)620 3582 y(*)710 3569 y(@param)f(string)g
($endpoint)620 3777 y(*)665 3764 y(/)576 3958 y(public)f(function)h
(bind\($endpoint\))e({)755 4152 y($this->socket->bind\($endpoint\);)755
4346 y(if\($this->verbose\))g({)934 4541 y(printf\("I:)h(MDP)i
(broker/0.1.1)e(is)h(active)g(at)g(\045s)h(\045s",)f($endpoint,)f
(PHP_EOL\);)755 4735 y(})576 4929 y(})p Black 3759 5569
a Fi(178)p Black eop end
%%Page: 179 193
TeXDict begin 179 192 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.179) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 170 a Fg(/)621 183 y(**)620 377
y(*)710 364 y(This)44 b(is)h(the)f(main)g(listen)g(and)g(process)g
(loop)620 571 y(*)665 558 y(/)576 752 y(public)f(function)h(listen\(\))
f({)755 947 y($read)h(=)h($write)e(=)i(array\(\);)755
1335 y(//)89 b(Get)45 b(and)f(process)g(messages)f(forever)h(or)g
(until)g(interrupted)755 1530 y(while\(true\))f({)934
1724 y($poll)h(=)h(new)f(ZMQPoll\(\);)934 1918 y
($poll->add\($this->socket,)d(ZMQ::POLL_IN\);)934 2307
y($events)j(=)h($poll->poll\($read,)c($write,)j(HEARTBEAT_INTERVAL\);)
934 2695 y(//)90 b(Process)43 b(next)h(input)g(message,)g(if)g(any)934
2889 y(if\($events\))f({)1114 3084 y($zmsg)h(=)g(new)h
(Zmsg\($this->socket\);)1114 3278 y($zmsg->recv\(\);)1114
3472 y(if\($this->verbose\))c({)1293 3666 y(echo)j("I:)g(received)g
(message:",)f(PHP_EOL,)h($zmsg->__toString\(\);)1114
3861 y(})1114 4249 y($sender)f(=)i($zmsg->pop\(\);)1114
4444 y($empty)e(=)i($zmsg->pop\(\);)1114 4638 y($header)e(=)i
($zmsg->pop\(\);)1114 5026 y(if\($header)e(==)h(MDPC_CLIENT\))f({)p
Black 3759 5569 a Fi(179)p Black eop end
%%Page: 180 194
TeXDict begin 180 193 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.180) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 1293 72 a Fg($this->client_process\($sender,)40
b($zmsg\);)1114 267 y(})k(else)g(if\($header)g(==)g(MDPW_WORKER\))f({)
1293 461 y($this->worker_process\($sender,)d($zmsg\);)1114
655 y(})k(else)g({)1293 850 y(echo)g("E:)g(invalid)g(message",)f
(PHP_EOL,)h($zmsg->__toString\(\);)1114 1044 y(})934
1238 y(})934 1627 y(//)90 b(Disconnect)43 b(and)h(delete)g(any)g
(expired)g(workers)934 1821 y(//)90 b(Send)44 b(heartbeats)f(to)h(idle)
h(workers)e(if)i(needed)934 2015 y(if\(microtime\(true\))d(>)j
($this->heartbeat_at\))c({)1114 2209 y($this->purge_workers\(\);)1114
2404 y(foreach\($this->workers)g(as)j($worker\))g({)1293
2598 y($this->worker_send\($worker,)c(MDPW_HEARTBEAT,)j(NULL,)g
(NULL\);)1114 2792 y(})1114 2987 y($this->heartbeat_at)e(=)k
(microtime\(true\))d(+)j(\(HEARTBEAT_INTERVAL/1000\);)934
3181 y(})755 3375 y(})576 3569 y(})576 3958 y(/)621 3971
y(**)620 4165 y(*)710 4152 y(Delete)f(any)g(idle)g(workers)g(that)g
(haven't)g(pinged)g(us)g(in)h(a)f(while.)620 4359 y(*)710
4346 y(We)h(know)f(that)g(workers)g(are)g(ordered)g(from)g(oldest)g(to)
g(most)g(recent.)620 4554 y(*)665 4541 y(/)576 4735 y(public)f
(function)h(purge_workers\(\))e({)755 4929 y(foreach\($this->waiting)f
(as)k($id)f(=>)g($worker\))g({)934 5124 y(if\(microtime\(true\))e(<)j
($worker->expiry\))d({)p Black 3759 5569 a Fi(180)p Black
eop end
%%Page: 181 195
TeXDict begin 181 194 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.181) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 1114 170 a Fg(break;)268 b(//)89 b(Worker)44
b(is)g(alive,)g(we're)g(done)g(here)934 364 y(})934 558
y(if\($this->verbose\))e({)1114 752 y(printf\("I:)h(deleting)g(expired)
h(worker:)g(\045s)g(\045s",)1293 947 y($worker->identity,)e(PHP_EOL\);)
934 1141 y(})934 1335 y($this->worker_delete\($worker\);)755
1530 y(})576 1724 y(})576 2112 y(/)621 2125 y(**)620
2320 y(*)710 2307 y(Locate)i(or)g(create)g(new)h(service)e(entry)620
2514 y(*)620 2708 y(*)710 2695 y(@param)h(string)g($name)620
2902 y(*)710 2889 y(@return)g(stdClass)620 3097 y(*)665
3084 y(/)576 3278 y(public)f(function)h(service_require\($name\))d({)
755 3472 y($service)i(=)i(isset\($this->services[$name]\))40
b(?)45 b($this->services[$name])c(:)j(NULL;)755 3666
y(if\($service)f(==)h(NULL\))g({)934 3861 y($service)g(=)g(new)h
(stdClass\(\);)934 4055 y($service->name)e(=)h($name;)934
4249 y($service->requests)e(=)j(array\(\);)934 4444 y
($service->waiting)d(=)j(array\(\);)934 4638 y($this->services[$name])c
(=)k($service;)755 4832 y(})p Black 3759 5569 a Fi(181)p
Black eop end
%%Page: 182 196
TeXDict begin 182 195 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.182) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 755 72 a Fg(return)44 b($service;)576
267 y(})576 655 y(/)621 668 y(**)620 863 y(*)710 850
y(Dispatch)g(requests)f(to)i(waiting)e(workers)h(as)g(possible)620
1057 y(*)620 1251 y(*)710 1238 y(@param)g(type)g($service)620
1445 y(*)710 1432 y(@param)g(type)g($msg)620 1640 y(*)665
1627 y(/)576 1821 y(public)f(function)h(service_dispatch\($service,)c
($msg\))k({)755 2015 y(if\($msg\))f({)934 2209 y($service->requests[])f
(=)i($msg;)755 2404 y(})755 2792 y($this->purge_workers\(\);)755
3181 y(while\(count\($service->waiting\))c(&&)k
(count\($service->requests\)\))d({)934 3375 y($worker)j(=)h
(array_shift\($service->waiting\);)934 3569 y($msg)f(=)h
(array_shift\($service->requests\);)934 3764 y
($this->worker_send\($worker,)c(MDPW_REQUEST,)h(NULL,)i($msg\);)755
3958 y(})576 4152 y(})576 4541 y(/)621 4554 y(**)620
4748 y(*)710 4735 y(Handle)g(internal)f(service)h(according)f(to)i
(8/MMI)f(specification)620 4942 y(*)620 5137 y(*)710
5124 y(@param)g(string)g($frame)p Black 3759 5569 a Fi(182)p
Black eop end
%%Page: 183 197
TeXDict begin 183 196 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.183) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 620 183 a Fg(*)710 170 y(@param)44
b(Zmsg)g($msg)620 377 y(*)665 364 y(/)576 558 y(public)f(function)h
(service_internal\($frame,)d($msg\))j({)755 752 y(if\($frame)f(==)i
("mmi.service"\))d({)934 947 y($name)i(=)h($msg->last\(\);)934
1141 y($service)f(=)g($this->services[$name];)934 1335
y($return_code)f(=)i($service)e(&&)i($service->workers)d(?)i("200")g(:)
h("404";)755 1530 y(})g(else)f({)934 1724 y($return_code)f(=)i("501";)
755 1918 y(})755 2307 y($msg->set_last\($return_code\);)755
2695 y(//)89 b(Remove)44 b(&)h(save)f(client)g(return)g(envelope)f(and)
h(insert)g(the)755 2889 y(//)89 b(protocol)44 b(header)g(and)g(service)
g(name,)g(then)g(rewrap)g(envelope)755 3084 y($client)g(=)g
($msg->unwrap\(\);)755 3278 y($msg->push\($frame\);)755
3472 y($msg->push\(MDPC_CLIENT\);)755 3666 y($msg->wrap\($client,)e
(""\);)755 3861 y($msg->set_socket\($this->socket\)->send\(\))o(;)576
4055 y(})576 4444 y(/)621 4457 y(**)620 4651 y(*)710
4638 y(Creates)i(worker)g(if)g(necessary)620 4845 y(*)620
5039 y(*)710 5026 y(@param)g(string)g($address)p Black
3759 5569 a Fi(183)p Black eop end
%%Page: 184 198
TeXDict begin 184 197 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.184) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 620 85 a Fg(*)710 72 y(@return)44 b(stdClass)620
280 y(*)665 267 y(/)576 461 y(public)f(function)h
(worker_require\($address\))d({)755 655 y($worker)j(=)g
(isset\($this->workers[$address]\))c(?)45 b($this->workers[$address])40
b(:)45 b(NULL;)755 850 y(if\($worker)e(==)i(NULL\))f({)934
1044 y($worker)g(=)h(new)f(stdClass\(\);)934 1238 y($worker->identity)e
(=)j($address;)934 1432 y($worker->address)d(=)j($address;)934
1627 y(if\($this->verbose\))d({)1114 1821 y(printf\("I:)h(registering)g
(new)h(worker:)g(\045s)g(\045s",)g($address,)g(PHP_EOL\);)934
2015 y(})934 2209 y($this->workers[$address])d(=)k($worker;)755
2404 y(})755 2598 y(return)f($worker;)576 2792 y(})576
3181 y(/)621 3194 y(**)620 3388 y(*)710 3375 y(Remove)g(a)h(worker)620
3582 y(*)620 3777 y(*)710 3764 y(@param)f(stdClass)f($worker)620
3971 y(*)710 3958 y(@param)h(boolean)g($disconnect)620
4165 y(*)665 4152 y(/)576 4346 y(public)f(function)h
(worker_delete\($worker,)d($disconnect)i(=)i(false\))f({)755
4541 y(if\($disconnect\))e({)934 4735 y($this->worker_send\($worker,)f
(MDPW_DISCONNECT,)h(NULL,)i(NULL\);)755 4929 y(})p Black
3759 5569 a Fi(184)p Black eop end
%%Page: 185 199
TeXDict begin 185 198 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.185) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 755 170 a Fg(if\(isset\($worker->service\)\))40
b({)934 364 y(worker_remove_from_array\($worker,)g
($worker->service->waiting\);)934 558 y($worker->service->workers--;)
755 752 y(})755 947 y(worker_remove_from_array\($worker,)f
($this->waiting\);)755 1141 y(unset\($this->workers[$worker->identity])
o(\);)576 1335 y(})576 1724 y(private)k(function)h
(worker_remove_from_array\($worker,)39 b(&$array\))44
b({)755 1918 y($index)g(=)g(array_search\($worker,)e($array\);)755
2112 y(if)i(\($index)g(!==)g(false\))g({)934 2307 y
(unset\($array[$index]\);)755 2501 y(})576 2695 y(})576
3084 y(/)621 3097 y(**)620 3291 y(*)710 3278 y(Process)g(message)f
(sent)i(to)f(us)h(by)f(a)h(worker)620 3485 y(*)620 3679
y(*)710 3666 y(@param)f(string)g($sender)620 3874 y(*)710
3861 y(@param)g(Zmsg)g($msg)620 4068 y(*)665 4055 y(/)576
4249 y(public)f(function)h(worker_process\($sender,)d($msg\))j({)755
4444 y($command)f(=)i($msg->pop\(\);)755 4638 y($worker_ready)e(=)h
(isset\($this->workers[$sender]\);)755 4832 y($worker)g(=)g
($this->worker_require\($sender\);)755 5026 y(if\($command)f(==)h
(MDPW_READY\))f({)p Black 3759 5569 a Fi(185)p Black
eop end
%%Page: 186 200
TeXDict begin 186 199 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.186) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 934 72 a Fg(if\($worker_ready\))42
b({)1114 267 y($this->worker_delete\($worker,)e(true\);)j(//)90
b(Not)44 b(first)g(command)g(in)g(session)934 461 y(})h(else)f
(if\(strlen\($sender\))e(>=)i(4)269 b(//)45 b(Reserved)e(service)h
(name)1293 655 y(&&)g(substr\($sender,)f(0,)h(4\))h(==)f('mmi.'\))g({)
1114 850 y($this->worker_delete\($worker,)c(true\);)934
1044 y(})45 b(else)f({)1114 1238 y(//)89 b(Attach)44
b(worker)g(to)g(service)g(and)g(mark)g(as)h(idle)1114
1432 y($service_frame)d(=)j($msg->pop\(\);)1114 1627
y($worker->service)d(=)i($this->service_require\($service_frame\);)1114
1821 y($worker->service->workers++;)1114 2015 y
($this->worker_waiting\($worker\);)934 2209 y(})755 2404
y(})h(else)f(if\($command)f(==)h(MDPW_REPLY\))f({)934
2598 y(if\($worker_ready\))f({)1114 2792 y(//)89 b(Remove)44
b(&)g(save)h(client)e(return)h(envelope)g(and)g(insert)g(the)1114
2987 y(//)89 b(protocol)43 b(header)h(and)h(service)e(name,)h(then)g
(rewrap)g(envelope.)1114 3181 y($client)f(=)i($msg->unwrap\(\);)1114
3375 y($msg->push\($worker->service->name\);)1114 3569
y($msg->push\(MDPC_CLIENT\);)1114 3764 y($msg->wrap\($client,)c(""\);)
1114 3958 y($msg->set_socket\($this->socket\)->send)o(\(\);)1114
4152 y($this->worker_waiting\($worker\);)934 4346 y(})k(else)f({)1114
4541 y($this->worker_delete\($worker,)c(true\);)934 4735
y(})755 4929 y(})45 b(else)f(if\($command)f(==)h(MDPW_HEARTBEAT\))f({)
934 5124 y(if\($worker_ready\))f({)p Black 3757 5569
a Fi(186)p Black eop end
%%Page: 187 201
TeXDict begin 187 200 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.187) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 1114 170 a Fg($worker->expiry)42 b(=)j
(microtime\(true\))d(+)j(\(HEARTBEAT_EXPIRY/1000\);)934
364 y(})g(else)f({)1114 558 y($this->worker_delete\($worker,)c(true\);)
934 752 y(})755 947 y(})45 b(else)f(if\($command)f(==)h
(MDPW_DISCONNECT\))e({)934 1141 y($this->worker_delete\($worker,)e
(true\);)755 1335 y(})45 b(else)f({)934 1530 y(echo)g("E:)h(invalid)e
(input)h(message",)g(PHP_EOL,)f($msg->__toString\(\);)755
1724 y(})576 1918 y(})576 2307 y(/)621 2320 y(**)620
2514 y(*)710 2501 y(Send)h(message)g(to)g(worker)620
2708 y(*)620 2902 y(*)710 2889 y(@param)g(stdClass)f($worker)620
3097 y(*)710 3084 y(@param)h(string)g($command)620 3291
y(*)710 3278 y(@param)g(mixed)g($option)620 3485 y(*)710
3472 y(@param)g(Zmsg)g($msg)620 3679 y(*)665 3666 y(/)576
3861 y(public)f(function)h(worker_send\($worker,)d($command,)j
($option,)f($msg\))h({)755 4055 y($msg)g(=)h($msg)f(?)h($msg)f(:)g(new)
h(Zmsg\(\);)755 4249 y(//)89 b(Stack)44 b(protocol)g(envelope)f(to)i
(start)f(of)g(message)755 4444 y(if\($option\))f({)934
4638 y($msg->push\($option\);)755 4832 y(})755 5026 y
($msg->push\($command\);)p Black 3756 5569 a Fi(187)p
Black eop end
%%Page: 188 202
TeXDict begin 188 201 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.188) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 755 72 a Fg($msg->push\(MDPW_WORKER\);)755
461 y(//)89 b(Stack)44 b(routing)g(envelope)f(to)i(start)f(of)g
(message)755 655 y($msg->wrap\($worker->address,)c(""\);)755
1044 y(if\($this->verbose\))i({)934 1238 y(printf\("I:)h(sending)h
(\045s)h(to)f(worker)g(\045s",)1069 1432 y($command,)f(PHP_EOL\);)934
1627 y(echo)h($msg->__toString\(\);)755 1821 y(})755
2209 y($msg->set_socket\($this->socket\)->send\(\))o(;)576
2404 y(})576 2792 y(/)621 2805 y(**)620 3000 y(*)710
2987 y(This)g(worker)g(is)h(now)f(waiting)g(for)g(work)620
3194 y(*)620 3388 y(*)710 3375 y(@param)g(stdClass)f($worker)620
3582 y(*)665 3569 y(/)576 3764 y(public)g(function)h
(worker_waiting\($worker\))d({)755 3958 y(//)89 b(Queue)44
b(to)h(broker)f(and)g(service)g(waiting)f(lists)755 4152
y($this->waiting[])f(=)j($worker;)755 4346 y
($worker->service->waiting[])40 b(=)45 b($worker;)755
4541 y($worker->expiry)d(=)j(microtime\(true\))d(+)j
(\(HEARTBEAT_EXPIRY/1000\);)755 4735 y
($this->service_dispatch\($worker->servic)o(e,)39 b(NULL\);)576
4929 y(})p Black 3759 5569 a Fi(188)p Black eop end
%%Page: 189 203
TeXDict begin 189 202 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.189) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 170 a Fg(/)621 183 y(**)620 377
y(*)710 364 y(Process)44 b(a)g(request)g(coming)g(from)g(a)h(client)620
571 y(*)620 765 y(*)710 752 y(@param)f(string)g($sender)620
960 y(*)710 947 y(@param)g(Zmsg)g($msg)620 1154 y(*)665
1141 y(/)576 1335 y(public)f(function)h(client_process\($sender,)d
($msg\))j({)755 1530 y($service_frame)e(=)j($msg->pop\(\);)755
1724 y($service)e(=)i($this->service_require\($service_frame\);)755
2112 y(//)89 b(Set)45 b(reply)f(return)f(address)h(to)h(client)e
(sender)755 2307 y($msg->wrap\($sender,)f(""\);)755 2501
y(if\(substr\($service_frame,)f(0,)j(4\))h(==)f('mmi.'\))g({)934
2695 y($this->service_internal\($service_frame,)39 b($msg\);)755
2889 y(})45 b(else)f({)934 3084 y($this->service_dispatch\($service,)c
($msg\);)755 3278 y(})576 3472 y(})-2 3735 y
SDict begin H.S end
 -2 3735
a -2 3735 a
SDict begin 13 H.A end
 -2 3735 a -2 3735 a
SDict begin [/View [/XYZ H.V]/Dest (0:2213) cvn /DEST pdfmark end
 -2 3735 a 396 3843 a
Fj(This)21 b(is)g(by)f(f)o(ar)g(the)g(most)g(comple)o(x)e(e)o(xample)h
(we')l(v)o(e)g(seen.)h(It')-5 b(s)21 b(almost)g(500)e(lines)h(of)g
(code.)g(T)-7 b(o)20 b(write)g(this,)h(and)396 3951 y(mak)o(e)f(it)h
(some)n(what)e(rob)n(ust)h(took)f(tw)o(o)i(days.)e(Ho)n(we)n(v)o(er)g
(this)i(is)g(still)g(a)g(short)f(piece)g(of)g(code)f(for)h(a)g(full)396
4059 y(service-oriented)e(brok)o(er)-5 b(.)-2 4226 y
SDict begin H.S end

-2 4226 a -2 4226 a
SDict begin 13 H.A end
 -2 4226 a -2 4226 a
SDict begin [/View [/XYZ H.V]/Dest (0:2214) cvn /DEST pdfmark end
 -2 4226 a 396
4333 a Fj(Notes)21 b(on)e(this)i(code:)-2 4334 y
SDict begin H.S end
 -2 4334
a -2 4334 a
SDict begin 13 H.A end
 -2 4334 a -2 4334 a
SDict begin [/View [/XYZ H.V]/Dest (0:2215) cvn /DEST pdfmark end
 -2 4334 a -2 4344 a
SDict begin H.S end
 -2
4344 a -2 4344 a
SDict begin 13 H.A end
 -2 4344 a -2 4344 a
SDict begin [/View [/XYZ H.V]/Dest (0:2216) cvn /DEST pdfmark end
 -2 4344 a Black
396 4503 a Fe(\225)p Black 479 4503 a
SDict begin H.S end
 479 4503 a 479
4503 a
SDict begin 13 H.A end
 479 4503 a 479 4503 a
SDict begin [/View [/XYZ H.V]/Dest (0:2217) cvn /DEST pdfmark end
 479 4503 a Fj(The)f(Majordomo)e(Protocol)h
(lets)i(us)g(handle)e(both)g(clients)i(and)e(w)o(ork)o(ers)h(on)g(a)g
(single)g(sock)o(et.)g(This)g(is)i(nicer)d(for)479 4611
y(those)h(deplo)o(ying)e(and)i(managing)e(the)i(brok)o(er:)f(it)i(just)
g(sits)g(on)f(one)g(\330MQ)g(endpoint)e(rather)i(than)f(the)i(tw)o(o)f
(that)479 4719 y(most)h(de)n(vices)e(need.)-2 4720 y
SDict begin H.S end

-2 4720 a -2 4720 a
SDict begin 13 H.A end
 -2 4720 a -2 4720 a
SDict begin [/View [/XYZ H.V]/Dest (0:2218) cvn /DEST pdfmark end
 -2 4720 a Black
396 4869 a Fe(\225)p Black 479 4869 a
SDict begin H.S end
 479 4869 a 479
4869 a
SDict begin 13 H.A end
 479 4869 a 479 4869 a
SDict begin [/View [/XYZ H.V]/Dest (0:2219) cvn /DEST pdfmark end
 479 4869 a Fj(The)h(brok)o(er)f
(implements)g(all)i(of)f(MDP/0.1)f(properly)f(\(as)j(f)o(ar)f(as)h(I)f
(kno)n(w\),)f(including)f(disconnection)g(if)j(the)479
4977 y(brok)o(er)e(sends)h(in)m(v)n(alid)f(commands,)f(heartbeating,)g
(and)i(the)g(rest.)-2 4995 y
SDict begin H.S end
 -2 4995 a -2 4995 a
SDict begin 13 H.A end
 -2 4995
a -2 4995 a
SDict begin [/View [/XYZ H.V]/Dest (0:2220) cvn /DEST pdfmark end
 -2 4995 a Black 3759 5569 a Fi(189)p Black
eop end
%%Page: 190 204
TeXDict begin 190 203 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.190) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2221) cvn /DEST pdfmark end
 479 72 a Fj(It)21
b(can)f(be)g(e)o(xtended)e(to)i(run)g(multiple)f(threads,)h(each)g
(managing)e(one)h(sock)o(et)h(and)g(one)g(set)h(of)f(clients)g(and)479
180 y(w)o(ork)o(ers.)g(This)g(could)f(be)h(interesting)g(for)f(se)o
(gmenting)f(lar)o(ge)i(architectures.)e(The)i(C)h(code)f(is)h(already)e
(or)o(ganized)479 288 y(around)g(a)h(brok)o(er)f(class)i(to)f(mak)o(e)g
(this)h(tri)n(vial.)-2 289 y
SDict begin H.S end
 -2 289 a -2 289 a
SDict begin 13 H.A end
 -2 289
a -2 289 a
SDict begin [/View [/XYZ H.V]/Dest (0:2222) cvn /DEST pdfmark end
 -2 289 a Black 396 438 a Fe(\225)p Black 479
438 a
SDict begin H.S end
 479 438 a 479 438 a
SDict begin 13 H.A end
 479 438 a 479 438 a
SDict begin [/View [/XYZ H.V]/Dest (0:2223) cvn /DEST pdfmark end
 479 438
a Fj(A)g(primary-f)o(ail-o)o(v)o(er)16 b(or)k(li)n(v)o(e-li)n(v)o(e)e
(brok)o(er)h(reliability)h(model)f(is)i(easy)-5 b(,)20
b(since)g(the)g(brok)o(er)f(essentially)h(has)h(no)479
546 y(state)g(e)o(xcept)e(service)h(presence.)f(It')-5
b(s)21 b(up)f(to)g(clients)h(and)e(w)o(ork)o(ers)h(to)g(choose)f
(another)g(brok)o(er)g(if)h(their)g(\002rst)479 654 y(choice)g(isn')o
(t)g(up)f(and)h(running.)-2 672 y
SDict begin H.S end
 -2 672 a -2 672 a
SDict begin 13 H.A end
 -2
672 a -2 672 a
SDict begin [/View [/XYZ H.V]/Dest (0:2224) cvn /DEST pdfmark end
 -2 672 a Black 396 803 a Fe(\225)p Black
479 803 a
SDict begin H.S end
 479 803 a 479 803 a
SDict begin 13 H.A end
 479 803 a 479 803 a
SDict begin [/View [/XYZ H.V]/Dest (0:2225) cvn /DEST pdfmark end
 479
803 a Fj(The)g(e)o(xamples)f(use)i(5-second)d(heartbeats,)h(mainly)h
(to)g(reduce)f(the)h(amount)f(of)h(output)f(when)g(you)h(enable)479
911 y(tracing.)f(Realistic)i(v)n(alues)f(w)o(ould)f(be)h(lo)n(wer)g
(for)f(most)h(LAN)g(applications.)f(Ho)n(we)n(v)o(er)m(,)f(an)o(y)h
(retry)g(has)h(to)h(be)e(slo)n(w)479 1019 y(enough)f(to)j(allo)n(w)f
(for)g(a)g(service)g(to)g(restart,)g(say)h(10)f(seconds)f(at)i(least.)
-2 1037 y
SDict begin H.S end
 -2 1037 a -2 1037 a
SDict begin 13 H.A end
 -2 1037 a -2 1037 a
SDict begin [/View [/XYZ H.V]/Dest (0:2226) cvn /DEST pdfmark end
 -2
1037 a Black 396 1168 a Fe(\225)p Black 479 1168 a
SDict begin H.S end
 479
1168 a 479 1168 a
SDict begin 13 H.A end
 479 1168 a 479 1168 a
SDict begin [/View [/XYZ H.V]/Dest (0:2227) cvn /DEST pdfmark end
 479 1168 a Fj(W)-7
b(e)22 b(later)e(impro)o(v)o(ed)d(and)j(e)o(xtended)e(the)i(protocol)f
(and)h(the)g(Majordomo)e(implementation,)f(which)j(no)n(w)g(sits)h(in)
479 1276 y(its)g(o)n(wn)f(Github)g(project.)f(If)h(you)f(w)o(ant)h(a)h
(properly)d(usable)i(Majordomo)e(stack,)i(use)g(the)g(github)f
(project.)-2 1336 y
SDict begin H.S end
 -2 1336 a -2 1336 a
SDict begin 13 H.A end
 -2 1336 a -2
1336 a
SDict begin [/View [/XYZ H.V]/Dest (0:2228) cvn /DEST pdfmark end
 -2 1336 a 359 x Fh(4.9.)39 b(Async)o(hr)m(onous)d(Major)m(domo)h
(P)l(attern)2619 1695 y
SDict begin H.S end
 2619 1695 a 2619 1695 a
SDict begin 22.464 H.A end
 2619
1695 a 2619 1695 a
SDict begin [/View [/XYZ H.V]/Dest (9.48.1) cvn /DEST pdfmark end
 2619 1695 a -2 1891 a
SDict begin H.S end
 -2 1891 a -2
1891 a
SDict begin 13 H.A end
 -2 1891 a -2 1891 a
SDict begin [/View [/XYZ H.V]/Dest (0:2230) cvn /DEST pdfmark end
 -2 1891 a 396 1969 a Fj(The)20
b(w)o(ay)g(we)h(implemented)d(Majordomo,)g(abo)o(v)o(e,)g(is)j(simple)f
(and)g(stupid.)f(The)h(client)h(is)g(just)f(the)h(original)e(Simple)396
2077 y(Pirate,)h(wrapped)f(up)h(in)g(a)h(se)o(xy)e(API.)i(When)f(I)g
(\002re)h(up)e(a)i(client,)f(brok)o(er)m(,)e(and)i(w)o(ork)o(er)f(on)h
(a)g(test)h(box,)e(it)i(can)f(process)396 2185 y(100,000)e(requests)i
(in)g(about)f(14)h(seconds.)f(That)h(is)h(partly)f(due)g(to)g(the)g
(code,)f(which)h(cheerfully)e(copies)i(message)396 2293
y(frames)g(around)e(as)j(if)g(CPU)g(c)o(ycles)f(were)g(free.)f(But)i
(the)f(real)h(problem)d(is)j(that)f(we')l(re)g(doing)f(netw)o(ork)g
(round-trips.)396 2401 y(\330MQ)i(disables)899 2401 y
SDict begin H.S end

899 2401 a 899 2401 a
SDict begin 13 H.A end
 899 2401 a 899 2401 a
SDict begin [/View [/XYZ H.V]/Dest (0:2231) cvn /DEST pdfmark end
 899 2401
a Fj(Nagle')-5 b(s)20 b(algorithm)f(\(http://en.wikipedia.or)o
(g/wiki/Nagles_)o(algo)o(rithm)o(\),)14 b(b)n(ut)21 b(round-tripping)16
b(is)396 2509 y(still)22 b(slo)n(w)-5 b(.)-2 2675 y
SDict begin H.S end
 -2
2675 a -2 2675 a
SDict begin 13 H.A end
 -2 2675 a -2 2675 a
SDict begin [/View [/XYZ H.V]/Dest (0:2232) cvn /DEST pdfmark end
 -2 2675 a 396 2783
a Fj(Theory)19 b(is)i(great)f(in)g(theory)-5 b(,)18 b(b)n(ut)i(in)h
(practice,)e(practice)h(is)h(better)-5 b(.)20 b(Let')-5
b(s)20 b(measure)g(the)g(actual)g(cost)h(of)396 2890
y(round-tripping)16 b(with)21 b(a)f(simple)g(test)i(program.)17
b(This)k(sends)f(a)h(b)n(unch)e(of)g(messages,)h(\002rst)h(w)o(aiting)f
(for)g(a)h(reply)e(to)396 2998 y(each)h(message,)g(and)g(second)f(as)i
(a)f(batch,)g(reading)e(all)j(the)f(replies)h(back)e(as)i(a)g(batch.)e
(Both)h(approaches)e(do)i(the)396 3106 y(same)h(w)o(ork,)e(b)n(ut)h
(the)o(y)g(gi)n(v)o(e)f(v)o(ery)g(dif)n(ferent)g(results.)h(W)-7
b(e)21 b(mock-up)d(a)j(client,)f(brok)o(er)m(,)e(and)h(w)o(ork)o(er:)-2
3124 y
SDict begin H.S end
 -2 3124 a -2 3124 a
SDict begin 13 H.A end
 -2 3124 a -2 3124 a
SDict begin [/View [/XYZ H.V]/Dest (0:tripping-php) cvn /DEST pdfmark
end
 -2 3124
a 396 3308 a Fk(Example)i(4-12.)d(Round-trip)i(demonstrator)f
(\(tripping)o(.php\))-2 3408 y
SDict begin H.S end
 -2 3408 a -2 3408 a
SDict begin 11.7 H.A end
 -2
3408 a -2 3408 a
SDict begin [/View [/XYZ H.V]/Dest (0:2235) cvn /DEST pdfmark end
 -2 3408 a 396 3488 a Fg(<?php)396 3682
y(/)441 3695 y(*)441 3792 y(*)531 3779 y(Round-trip)43
b(demonstrator)441 3889 y(*)441 3986 y(*)531 3973 y(While)h(this)g
(example)g(runs)g(in)g(a)h(single)f(process,)f(that)h(is)h(just)f(to)h
(make)441 4084 y(*)531 4071 y(it)f(easier)g(to)h(start)f(and)g(stop)g
(the)g(example.)g(Each)g(thread)g(has)g(its)h(own)441
4181 y(*)531 4168 y(context)e(and)i(conceptually)e(acts)h(as)g(a)h
(separate)e(process.)441 4278 y(*)441 4375 y(*)531 4362
y(@author)g(Ian)i(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
4472 y(*)486 4459 y(/)396 4556 y(include)g("zmsg.php";)396
4751 y(function)g(client_task\(\))e({)441 4848 y($context)i(=)g(new)h
(ZMQContext\(\);)441 4945 y($client)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_DEALER\);)441 5042 y
($client->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)e("C"\);)441
5139 y($client->connect\("tcp://localhost:5555"\))o(;)p
Black 3759 5569 a Fi(190)p Black eop end
%%Page: 191 205
TeXDict begin 191 204 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.191) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 170 a Fg(echo)44 b("Setting)g(up)g(test...",)g
(PHP_EOL;)441 267 y(usleep\(10000\);)441 461 y(echo)g("Synchronous)f
(round-trip)g(test...",)h(PHP_EOL;)441 558 y($start)g(=)h
(microtime\(true\);)441 655 y($text)f(=)h("HELLO";)441
752 y(for\($requests)e(=)h(0;)h($requests)e(<)i(10000;)f($requests++\))
f({)486 850 y($client->send\($text\);)620 947 y($msg)i(=)f
($client->recv\(\);)441 1044 y(})441 1141 y(printf)g(\(")g(\045d)h
(calls/second\045s",)486 1238 y(\(1000)755 1251 y(*)845
1238 y(10000\))e(/)i(\(int\))f(\(\(microtime\(true\))e(-)j($start\))
2772 1251 y(*)2862 1238 y(1000\),)486 1335 y(PHP_EOL\);)441
1530 y(echo)f("Asynchronous)f(round-trip)g(test...",)g(PHP_EOL;)441
1627 y($start)h(=)h(microtime\(true\);)441 1724 y(for\($requests)e(=)h
(0;)h($requests)e(<)i(100000;)f($requests++\))e({)486
1821 y($client->send\($text\);)441 1918 y(})441 2112
y(for\($requests)h(=)h(0;)h($requests)e(<)i(100000;)f($requests++\))e
({)486 2209 y($client->recv\(\);)441 2307 y(})441 2501
y(printf)i(\(")g(\045d)h(calls/second\045s",)486 2598
y(\(1000)755 2611 y(*)845 2598 y(100000\))e(/)i(\(int\))f
(\(\(microtime\(true\))e(-)j($start\))2817 2611 y(*)2907
2598 y(1000\),)486 2695 y(PHP_EOL\);)396 2792 y(})396
3084 y(function)f(worker_task\(\))e({)441 3181 y($context)i(=)g(new)h
(ZMQContext\(\);)441 3278 y($worker)f(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_DEALER\);)441 3375 y
($worker->setSockOpt\(ZMQ::SOCKOPT_IDENTIT)o(Y,)e("W"\);)441
3472 y($worker->connect\("tcp://localhost:5556"\))o(;)441
3569 y(while\(true\))k({)486 3666 y($zmsg)h(=)h(new)f(Zmsg\($worker\);)
486 3764 y($zmsg->recv\(\);)486 3861 y($zmsg->send\(\);)441
3958 y(})396 4055 y(})396 4249 y(function)g(broker_task\(\))e({)441
4346 y(//)89 b(Prepare)44 b(our)g(context)g(and)g(sockets)441
4444 y($context)g(=)g(new)h(ZMQContext\(\);)441 4541
y($frontend)e(=)i(new)f(ZMQSocket\($context,)e(ZMQ::SOCKET_ROUTER\);)
441 4638 y($backend)i(=)g(new)h(ZMQSocket\($context,)c
(ZMQ::SOCKET_ROUTER\);)441 4735 y($frontend->bind\("tcp://)1476
4748 y(*)1521 4735 y(:5555"\);)441 4832 y($backend->bind\("tcp://)1431
4845 y(*)1476 4832 y(:5556"\);)441 5026 y(//)89 b(Initialize)44
b(poll)g(set)441 5124 y($poll)g(=)h(new)f(ZMQPoll\(\);)p
Black 3759 5569 a Fi(191)p Black eop end
%%Page: 192 206
TeXDict begin 192 205 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.192) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2240) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 441 72 a Fg($poll->add\($frontend,)41
b(ZMQ::POLL_IN\);)441 170 y($poll->add\($backend,)h(ZMQ::POLL_IN\);)441
267 y($read)i(=)h($write)f(=)g(array\(\);)441 364 y(while\(true\))f({)
486 461 y($events)h(=)g($poll->poll\($read,)e($write\);)486
558 y(foreach\($read)h(as)h($socket\))g({)531 655 y($zmsg)g(=)g(new)h
(Zmsg\($socket\);)531 752 y($zmsg->recv\(\);)531 850
y(if\($socket)e(===)h($frontend\))f({)576 947 y($zmsg->push\("W"\);)576
1044 y($zmsg->set_socket\($backend\)->send\(\);)531 1141
y(})h(else)h(if\($socket)e(===)h($backend\))f({)576 1238
y($zmsg->pop\(\);)576 1335 y($zmsg->push\("C"\);)576
1432 y($zmsg->set_socket\($frontend\)->send\(\);)531
1530 y(})486 1724 y(})441 1821 y(})396 1918 y(})396 2112
y($wpid)h(=)h(pcntl_fork\(\);)396 2209 y(if\($wpid)f(==)g(0\))h({)441
2307 y(worker_task\(\);)441 2404 y(exit;)396 2501 y(})396
2598 y($bpid)f(=)h(pcntl_fork\(\);)396 2695 y(if\($bpid)f(==)g(0\))h({)
441 2792 y(broker_task\(\);)441 2889 y(exit;)396 2987
y(})396 3084 y(sleep\(1\);)396 3181 y(client_task\(\);)396
3278 y(posix_kill\($wpid,)d(SIGKILL\);)396 3375 y(posix_kill\($bpid,)g
(SIGKILL\))-2 3553 y
SDict begin H.S end
 -2 3553 a -2 3553 a
SDict begin 13 H.A end
 -2 3553 a -2
3553 a
SDict begin [/View [/XYZ H.V]/Dest (0:2236) cvn /DEST pdfmark end
 -2 3553 a 396 3649 a Fj(On)20 b(my)g(de)n(v)o(elopment)e(box,)h
(this)h(program)e(says:)-2 3750 y
SDict begin H.S end
 -2 3750 a -2 3750 a
SDict begin 11.7 H.A end

-2 3750 a -2 3750 a
SDict begin [/View [/XYZ H.V]/Dest (0:2237) cvn /DEST pdfmark end
 -2 3750 a 396 3829 a Fg(Setting)44
b(up)g(test...)396 3926 y(Synchronous)f(round-trip)g(test...)441
4023 y(9057)h(calls/second)396 4121 y(Asynchronous)f(round-trip)g
(test...)441 4218 y(173010)h(calls/second)-2 4390 y
SDict begin H.S end
 -2
4390 a -2 4390 a
SDict begin 13 H.A end
 -2 4390 a -2 4390 a
SDict begin [/View [/XYZ H.V]/Dest (0:2238) cvn /DEST pdfmark end
 -2 4390 a 396 4492
a Fj(Note)20 b(that)h(the)f(client)g(thread)f(does)h(a)h(small)g(pause)
e(before)g(starting.)h(This)g(is)h(to)g(get)f(around)e(one)i(of)g(the)g
('features')396 4600 y(of)g(the)g(router)f(sock)o(et:)i(if)f(you)f
(send)h(a)h(message)f(with)g(the)g(address)g(of)g(a)h(peer)e(that')-5
b(s)21 b(not)f(yet)g(connected,)e(the)396 4708 y(message)i(gets)h
(discarded.)d(In)i(this)h(e)o(xample)e(we)h(don')o(t)f(use)h(the)h(LR)m
(U)f(mechanism,)f(so)h(without)g(the)g(sleep,)g(if)h(the)396
4816 y(w)o(ork)o(er)e(thread)h(is)h(too)f(slo)n(w)g(to)h(connect,)d
(it')o(ll)j(lose)g(messages,)f(making)f(a)h(mess)h(of)f(our)f(test.)p
Black 3759 5569 a Fi(192)p Black eop end
%%Page: 193 207
TeXDict begin 193 206 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.193) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2239) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(As)21 b(we)g(see,)f(round-tripping)c(in)
21 b(the)f(simplest)g(case)h(is)g(20)f(times)h(slo)n(wer)f(than)f("sho)
o(v)o(e)g(it)i(do)n(wn)e(the)h(pipe)g(as)h(f)o(ast)g(as)396
180 y(it')o(ll)g(go")f(asynchronous)d(approach.)h(Let')-5
b(s)21 b(see)f(if)h(we)f(can)g(apply)g(this)g(to)h(Majordomo)d(to)i
(mak)o(e)g(it)h(f)o(aster)-5 b(.)396 454 y(First,)21
b(we)g(modify)d(the)i(client)h(API)f(to)g(ha)n(v)o(e)g(separate)g(send)
g(and)f(recv)h(methods:)-2 555 y
SDict begin H.S end
 -2 555 a -2 555 a
SDict begin 11.7 H.A end
 -2
555 a -2 555 a
SDict begin [/View [/XYZ H.V]/Dest (0:2241) cvn /DEST pdfmark end
 -2 555 a 396 635 a Fg(mdcli_t)755 648
y(*)800 635 y(mdcli_new)222 b(\(char)1696 648 y(*)1741
635 y(broker\);)396 732 y(void)i(mdcli_destroy)42 b(\(mdcli_t)1831
745 y(**)1921 732 y(self_p\);)396 829 y(int)269 b(mdcli_send)177
b(\(mdcli_t)1831 842 y(*)1876 829 y(self,)44 b(char)2369
842 y(*)2414 829 y(service,)f(zmsg_t)3131 842 y(**)3221
829 y(request_p\);)396 926 y(zmsg_t)755 939 y(*)800 926
y(mdcli_recv)177 b(\(mdcli_t)1831 939 y(*)1876 926 y(self\);)-2
1103 y
SDict begin H.S end
 -2 1103 a -2 1103 a
SDict begin 13 H.A end
 -2 1103 a -2 1103 a
SDict begin [/View [/XYZ H.V]/Dest (0:2242) cvn /DEST pdfmark end
 -2 1103
a 396 1200 a Fj(It')-5 b(s)21 b(literally)f(a)h(fe)n(w)f(minutes')f(w)o
(ork)h(to)g(ref)o(actor)f(the)h(synchronous)e(client)i(API)h(to)f
(become)f(asynchronous:)-2 1218 y
SDict begin H.S end
 -2 1218 a -2 1218 a
SDict begin 13 H.A end

-2 1218 a -2 1218 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdcliapi2-php) cvn /DEST pdfmark
end
 -2 1218 a 396 1401 a Fk(Example)i(4-13.)d
(Majordomo)h(asynchr)o(onous)h(client)g(API)h(\(mdcliapi2.php\))-2
1501 y
SDict begin H.S end
 -2 1501 a -2 1501 a
SDict begin 11.7 H.A end
 -2 1501 a -2 1501 a
SDict begin [/View [/XYZ H.V]/Dest (0:2245) cvn /DEST pdfmark end
 -2 1501
a 396 1581 a Fg(<?php)396 1679 y(/)441 1692 y(*)576 1679
y(=====================================)o(======)o(======)o(======)o
(======)o(=====)o(===)441 1789 y(*)531 1776 y(mdcliapi2.c)441
1886 y(*)441 1983 y(*)531 1970 y(Majordomo)43 b(Protocol)h(Client)f
(API)i(\(async)f(version\))441 2080 y(*)531 2067 y(Implements)f(the)h
(MDP/Worker)f(spec)i(at)f(http://rfc.zeromq.org/spec:7.)441
2177 y(*)441 2274 y(*)531 2261 y
(--------------------------------------)o(------)o(------)o(------)o
(------)o(-----)o(--)441 2371 y(*)531 2358 y(Copyright)f(\(c\))h
(1991-2011)g(iMatix)g(Corporation)f(<www.imatix.com>)441
2469 y(*)531 2456 y(Copyright)g(other)h(contributors)f(as)h(noted)g(in)
h(the)f(AUTHORS)g(file.)441 2566 y(*)441 2663 y(*)531
2650 y(This)g(file)g(is)h(part)f(of)g(the)h(ZeroMQ)e(Guide:)h
(http://zguide.zeromq.org)441 2760 y(*)441 2857 y(*)531
2844 y(This)g(is)g(free)h(software;)e(you)h(can)h(redistribute)d(it)j
(and/or)f(modify)g(it)g(under)441 2954 y(*)531 2941 y(the)g(terms)g(of)
h(the)f(GNU)g(Lesser)g(General)g(Public)g(License)f(as)i(published)e
(by)441 3051 y(*)531 3038 y(the)h(Free)g(Software)g(Foundation;)f
(either)h(version)f(3)i(of)f(the)h(License,)e(or)i(\(at)441
3149 y(*)531 3136 y(your)f(option\))g(any)g(later)g(version.)441
3246 y(*)441 3343 y(*)531 3330 y(This)g(software)f(is)i(distributed)e
(in)h(the)h(hope)f(that)g(it)h(will)f(be)g(useful,)g(but)441
3440 y(*)531 3427 y(WITHOUT)f(ANY)i(WARRANTY;)e(without)h(even)g(the)g
(implied)g(warranty)f(of)441 3537 y(*)531 3524 y(MERCHANTABILITY)f(or)j
(FITNESS)e(FOR)i(A)f(PARTICULAR)f(PURPOSE.)h(See)g(the)h(GNU)441
3634 y(*)531 3621 y(Lesser)f(General)f(Public)h(License)g(for)g(more)g
(details.)441 3731 y(*)441 3829 y(*)531 3816 y(You)g(should)g(have)g
(received)g(a)g(copy)g(of)h(the)f(GNU)h(Lesser)e(General)h(Public)441
3926 y(*)531 3913 y(License)f(along)h(with)h(this)f(program.)f(If)i
(not,)f(see)441 4023 y(*)531 4010 y(<http://www.gnu.org/licenses/>.)441
4120 y(*)531 4107 y(======================================)o(======)o
(======)o(======)o(======)o(=====)o(==)441 4217 y(*)531
4204 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 4314 y(*)486
4301 y(/)396 4495 y(include_once)f("zmsg.php";)396 4593
y(include_once)g("mdp.php";)396 4787 y(class)h(MDCli)g({)441
4884 y(//)89 b(Structure)44 b(of)g(our)h(class)441 4981
y(//)89 b(We)45 b(access)f(these)g(properties)f(only)h(via)g(class)g
(methods)441 5078 y(private)g($broker;)p Black 3759 5569
a Fi(193)p Black eop end
%%Page: 194 208
TeXDict begin 194 207 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.194) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 72 a Fg(private)44 b($context;)441
170 y(private)g($client;)f(//)90 b(Socket)43 b(to)i(broker)441
267 y(private)f($verbose;)f(//)89 b(Print)44 b(activity)g(to)g(stdout)
441 364 y(private)g($timeout;)f(//)89 b(Request)44 b(timeout)441
461 y(private)g($retries;)f(//)89 b(Request)44 b(retries)441
655 y(/)486 668 y(**)486 765 y(*)576 752 y(Constructor)486
863 y(*)486 960 y(*)576 947 y(@param)f(string)h($broker)486
1057 y(*)576 1044 y(@param)f(boolean)h($verbose)486 1154
y(*)531 1141 y(/)441 1238 y(public)g(function)f(__construct\($broker,)f
($verbose)h(=)i(false\))f({)486 1335 y($this->broker)f(=)h($broker;)486
1432 y($this->context)e(=)j(new)f(ZMQContext\(\);)486
1530 y($this->verbose)e(=)j($verbose;)486 1627 y($this->timeout)d(=)j
(2500;)492 b(//)90 b(msecs)486 1724 y($this->connect_to_broker\(\);)441
1821 y(})441 2015 y(/)486 2028 y(**)486 2125 y(*)576
2112 y(Connect)43 b(or)i(reconnect)e(to)i(broker)486
2222 y(*)531 2209 y(/)441 2307 y(protected)e(function)h
(connect_to_broker\(\))e({)486 2404 y(if\($this->client\))g({)531
2501 y(unset\($this->client\);)486 2598 y(})486 2695
y($this->client)h(=)h(new)h(ZMQSocket\($this->context,)40
b(ZMQ::SOCKET_DEALER\);)486 2792 y
($this->client->setSockOpt\(ZMQ::SOCKOPT_)o(LINGER)o(,)f(0\);)486
2889 y($this->client->connect\($this->broker\);)486 2987
y(if\($this->verbose\))j({)531 3084 y(printf\("I:)h(connecting)g(to)i
(broker)e(at)i(\045s...",)f($this->broker\);)486 3181
y(})441 3278 y(})441 3472 y(/)486 3485 y(**)486 3582
y(*)576 3569 y(Set)g(request)g(timeout)486 3679 y(*)486
3777 y(*)576 3764 y(@param)f(int)i($timeout)e(\(msecs\))486
3874 y(*)531 3861 y(/)441 3958 y(public)h(function)f
(set_timeout\($timeout\))f({)486 4055 y($this->timeout)g(=)j($timeout;)
441 4152 y(})441 4346 y(/)486 4359 y(**)486 4457 y(*)576
4444 y(Send)f(request)f(to)i(broker)486 4554 y(*)576
4541 y(Takes)f(ownership)f(of)h(request)g(message)g(and)g(destroys)g
(it)g(when)g(sent.)486 4651 y(*)486 4748 y(*)576 4735
y(@param)f(string)h($service)486 4845 y(*)576 4832 y(@param)f(Zmsg)i
($request)486 4942 y(*)531 4929 y(/)441 5026 y(public)f(function)f
(send\($service,)g(Zmsg)h($request\))f({)620 5124 y(//)90
b(Prefix)44 b(request)f(with)h(protocol)g(frames)p Black
3759 5569 a Fi(194)p Black eop end
%%Page: 195 209
TeXDict begin 195 208 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.195) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 755 72 a Fg(//)89 b(Frame)44 b(0:)h(empty)f(\(REQ)g
(emulation\))755 170 y(//)89 b(Frame)44 b(1:)h("MDPCxy")e(\(six)h
(bytes,)g(MDP/Client)f(x.y\))755 267 y(//)89 b(Frame)44
b(2:)h(Service)e(name)i(\(printable)e(string\))755 364
y($request->push\($service\);)755 461 y($request->push\(MDPC_CLIENT\);)
755 558 y($request->push\(""\);)755 655 y(if\($this->verbose\))f({)934
752 y(printf)i(\("I:)g(send)g(request)g(to)h('\045s')f(service:)f
(\045s",)h($service,)g(PHP_EOL\);)934 850 y(echo)g
($request->__toString\(\);)755 947 y(})755 1044 y
($request->set_socket\($this->client\)->se)o(nd\(\);)441
1141 y(})441 1335 y(/)486 1348 y(**)486 1445 y(*)576
1432 y(Returns)f(the)i(reply)f(message)f(or)i(NULL)f(if)g(there)g(was)h
(no)f(reply.)g(Does)g(not)486 1543 y(*)576 1530 y(attempt)f(to)i
(recover)e(from)i(a)f(broker)g(failure,)g(this)g(is)g(not)h(possible)
486 1640 y(*)576 1627 y(without)e(storing)h(all)g(unanswered)f
(requests)h(and)g(resending)g(them)g(all...)486 1737
y(*)486 1834 y(*)531 1821 y(/)441 1918 y(public)g(function)f(recv\(\))h
({)620 2015 y($read)g(=)h($write)f(=)h(array\(\);)620
2209 y(//)90 b(Poll)44 b(socket)g(for)g(a)h(reply,)f(with)g(timeout)486
2307 y($poll)g(=)h(new)f(ZMQPoll\(\);)486 2404 y
($poll->add\($this->client,)d(ZMQ::POLL_IN\);)486 2501
y($events)j(=)g($poll->poll\($read,)e($write,)i($this->timeout\);)486
2695 y(//)89 b(If)45 b(we)f(got)h(a)f(reply,)g(process)g(it)486
2792 y(if\($events\))f({)531 2889 y($msg)h(=)h(new)f
(Zmsg\($this->client\);)531 2987 y($msg->recv\(\);)531
3084 y(if)g(\($this->verbose\))e({)576 3181 y(echo)i("I:)g(received)g
(reply:",)f($request->__toString\(\),)e(PHP_EOL;)531
3278 y(})531 3375 y(//)89 b(Don't)44 b(try)g(to)h(handle)f(errors,)f
(just)i(assert)e(noisily)531 3472 y(assert)h(\($msg->parts\(\))e(>=)j
(4\);)531 3666 y($msg->pop\(\);)e(//)h(empty)531 3861
y($header)f(=)i($msg->pop\(\);)531 3958 y(assert\($header)d(==)j
(MDPC_CLIENT\);)531 4152 y($reply_service)d(=)j($msg->pop\(\);)531
4346 y(return)f($msg;)g(//)89 b(Success)486 4444 y(})45
b(else)f({)531 4541 y(echo)g("W:)g(permanent)g(error,)f(abandoning)h
(request",)f(PHP_EOL;)531 4638 y(return;)g(//)90 b(Give)44
b(up)486 4735 y(})441 4832 y(})-2 5006 y
SDict begin H.S end
 -2 5006 a -2
5006 a
SDict begin 13 H.A end
 -2 5006 a -2 5006 a
SDict begin [/View [/XYZ H.V]/Dest (0:2246) cvn /DEST pdfmark end
 -2 5006 a 396 5106 a Fj(And)20
b(here')-5 b(s)20 b(the)g(corresponding)d(client)j(test)h(program:)-2
5124 y
SDict begin H.S end
 -2 5124 a -2 5124 a
SDict begin 13 H.A end
 -2 5124 a -2 5124 a
SDict begin [/View [/XYZ H.V]/Dest (0:mdclient2-php) cvn /DEST pdfmark
end
 -2 5124
a Black 3759 5569 a Fi(195)p Black eop end
%%Page: 196 210
TeXDict begin 196 209 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.196) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Example)21 b(4-14.)d(Majordomo)h(client)i
(application)e(\(mdclient2.php\))-2 172 y
SDict begin H.S end
 -2 172 a -2
172 a
SDict begin 11.7 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2249) cvn /DEST pdfmark end
 -2 172 a 396 253 a Fg(<?php)396
350 y(/)441 363 y(*)441 460 y(*)531 447 y(Majordomo)43
b(Protocol)h(client)f(example)h(-)h(asynchronous)441
557 y(*)531 544 y(Uses)f(the)g(mdcli)g(API)h(to)f(hide)g(all)h(MDP)f
(aspects)441 654 y(*)441 751 y(*)531 738 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 848 y(*)486
835 y(/)396 933 y(include_once)f("mdcliapi2.php";)396
1127 y($verbose)h(=)g($_SERVER['argc'])f(>)h(1)h(&&)f
($_SERVER['argv'][1])e(==)j('-v';)396 1224 y($session)f(=)g(new)h
(MDCli\("tcp://localhost:5555",)40 b($verbose\);)396
1321 y(for\($count)j(=)i(0;)g($count)e(<)i(10000;)f($count++\))f({)441
1418 y($request)h(=)g(new)h(Zmsg\(\);)441 1515 y
($request->body_set\("Hello)c(world"\);)441 1613 y
($session->send\("echo",)g($request\);)396 1710 y(})396
1904 y(for\($count)i(=)i(0;)g($count)e(<)i(10000;)f($count++\))f({)576
2001 y($reply)g(=)i($session->recv\(\);)441 2098 y(if\(!$reply\))e({)
486 2195 y(break;)h(//)g(Interrupt)g(or)g(failure)441
2292 y(})396 2390 y(})396 2487 y(printf)g(\("\045d)g(replies)g
(received",)f($count\);)396 2584 y(echo)h(PHP_EOL;)-2
2760 y
SDict begin H.S end
 -2 2760 a -2 2760 a
SDict begin 13 H.A end
 -2 2760 a -2 2760 a
SDict begin [/View [/XYZ H.V]/Dest (0:2250) cvn /DEST pdfmark end
 -2 2760
a 396 2858 a Fj(The)20 b(brok)o(er)f(and)g(w)o(ork)o(er)g(are)h
(unchanged,)e(since)i(we')l(v)o(e)f(not)h(modi\002ed)f(the)h(protocol)e
(at)j(all.)g(W)-7 b(e)21 b(see)g(an)f(immediate)396 2966
y(impro)o(v)o(ement)d(in)k(performance.)c(Here')-5 b(s)20
b(the)g(synchronous)e(client)i(chugging)e(through)g(100K)h
(request-reply)396 3074 y(c)o(ycles:)-2 3175 y
SDict begin H.S end
 -2 3175
a -2 3175 a
SDict begin 11.7 H.A end
 -2 3175 a -2 3175 a
SDict begin [/View [/XYZ H.V]/Dest (0:2251) cvn /DEST pdfmark end
 -2 3175 a 396 3254 a
Fg($)45 b(time)f(mdclient)396 3351 y(100000)g(requests/replies)e
(processed)396 3545 y(real)179 b(0m14.088s)396 3642 y(user)g(0m1.310s)
396 3740 y(sys)224 b(0m2.670s)-2 3917 y
SDict begin H.S end
 -2 3917 a -2
3917 a
SDict begin 13 H.A end
 -2 3917 a -2 3917 a
SDict begin [/View [/XYZ H.V]/Dest (0:2252) cvn /DEST pdfmark end
 -2 3917 a 396 4014 a Fj(And)20
b(here')-5 b(s)20 b(the)g(asynchronous)d(client,)j(with)h(a)f(single)h
(w)o(ork)o(er:)-2 4115 y
SDict begin H.S end
 -2 4115 a -2 4115 a
SDict begin 11.7 H.A end
 -2 4115
a -2 4115 a
SDict begin [/View [/XYZ H.V]/Dest (0:2253) cvn /DEST pdfmark end
 -2 4115 a 396 4194 a Fg($)45 b(time)f(mdclient2)396
4291 y(100000)g(replies)g(received)396 4485 y(real)179
b(0m8.730s)396 4582 y(user)g(0m0.920s)396 4679 y(sys)224
b(0m1.550s)-2 4857 y
SDict begin H.S end
 -2 4857 a -2 4857 a
SDict begin 13 H.A end
 -2 4857 a -2
4857 a
SDict begin [/View [/XYZ H.V]/Dest (0:2254) cvn /DEST pdfmark end
 -2 4857 a 396 4953 a Fj(T)-7 b(wice)21 b(as)g(f)o(ast.)f(Not)h
(bad,)e(b)n(ut)h(let')-5 b(s)21 b(\002re)g(up)f(10)f(w)o(ork)o(ers,)h
(and)f(see)i(ho)n(w)f(it)h(handles:)-2 5054 y
SDict begin H.S end
 -2 5054
a -2 5054 a
SDict begin 11.7 H.A end
 -2 5054 a -2 5054 a
SDict begin [/View [/XYZ H.V]/Dest (0:2255) cvn /DEST pdfmark end
 -2 5054 a 396 5133 a
Fg($)45 b(time)f(mdclient2)p Black 3757 5569 a Fi(196)p
Black eop end
%%Page: 197 211
TeXDict begin 197 210 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.197) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fg(100000)44 b(replies)g(received)396
267 y(real)179 b(0m3.863s)396 364 y(user)g(0m0.730s)396
461 y(sys)224 b(0m0.470s)-2 639 y
SDict begin H.S end
 -2 639 a -2 639 a
SDict begin 13 H.A end
 -2
639 a -2 639 a
SDict begin [/View [/XYZ H.V]/Dest (0:2256) cvn /DEST pdfmark end
 -2 639 a 396 735 a Fj(It)21 b(isn')o(t)f(fully)f
(asynchronous)e(since)k(w)o(ork)o(ers)e(get)i(their)e(messages)i(on)f
(a)g(strict)h(LR)m(U)f(basis.)h(But)g(it)g(will)g(scale)f(better)396
843 y(with)h(more)e(w)o(ork)o(ers.)g(On)h(my)g(PC,)h(after)f(eight)g
(or)g(so)g(w)o(ork)o(ers)g(it)h(doesn')o(t)e(get)h(an)o(y)f(f)o(aster)
-5 b(.)21 b(F)o(our)e(cores)h(only)396 951 y(stretches)h(so)f(f)o(ar)-5
b(.)20 b(But)h(we)g(got)e(a)i(4x)f(impro)o(v)o(ement)d(in)j(throughput)
d(with)k(just)f(a)h(fe)n(w)f(minutes')g(w)o(ork.)f(The)h(brok)o(er)e
(is)396 1059 y(still)k(unoptimized.)17 b(It)k(spends)e(most)i(of)f(its)
h(time)f(cop)o(ying)f(message)h(frames)f(around,)f(instead)i(of)g
(doing)f(zero)h(cop)o(y)-5 b(,)396 1167 y(which)20 b(it)h(could.)e(But)
i(we')l(re)e(getting)g(25K)h(reliable)g(request/reply)e(calls)j(a)g
(second,)e(with)h(pretty)g(lo)n(w)g(ef)n(fort.)-2 1351
y
SDict begin H.S end
 -2 1351 a -2 1351 a
SDict begin 13 H.A end
 -2 1351 a -2 1351 a
SDict begin [/View [/XYZ H.V]/Dest (0:2257) cvn /DEST pdfmark end
 -2 1351 a 396
1441 a Fj(Ho)n(we)n(v)o(er)f(the)h(asynchronous)d(Majordomo)h(pattern)h
(isn')o(t)h(all)h(roses.)f(It)h(has)f(a)h(fundamental)d(weakness,)h
(namely)396 1549 y(that)i(it)f(cannot)g(survi)n(v)o(e)e(a)j(brok)o(er)e
(crash)h(without)f(more)g(w)o(ork.)h(If)g(you)f(look)g(at)i(the)f
(mdcliapi2)f(code)h(you')o(ll)f(see)i(it)396 1657 y(does)f(not)g
(attempt)g(to)g(reconnect)f(after)h(a)g(f)o(ailure.)g(A)g(proper)f
(reconnect)f(w)o(ould)i(require:)-2 1675 y
SDict begin H.S end
 -2 1675 a
-2 1675 a
SDict begin 13 H.A end
 -2 1675 a -2 1675 a
SDict begin [/View [/XYZ H.V]/Dest (0:2258) cvn /DEST pdfmark end
 -2 1675 a -2 1685 a
SDict begin H.S end
 -2
1685 a -2 1685 a
SDict begin 13 H.A end
 -2 1685 a -2 1685 a
SDict begin [/View [/XYZ H.V]/Dest (0:2259) cvn /DEST pdfmark end
 -2 1685 a Black
396 1827 a Fe(\225)p Black 479 1827 a
SDict begin H.S end
 479 1827 a 479
1827 a
SDict begin 13 H.A end
 479 1827 a 479 1827 a
SDict begin [/View [/XYZ H.V]/Dest (0:2260) cvn /DEST pdfmark end
 479 1827 a Fj(That)g(e)n(v)o(ery)f
(request)h(is)h(numbered,)c(and)j(e)n(v)o(ery)f(reply)g(has)h(a)h
(matching)e(number)m(,)f(which)h(w)o(ould)h(ideally)g(require)479
1935 y(a)h(change)e(to)h(the)g(protocol)f(to)h(enforce.)-2
1953 y
SDict begin H.S end
 -2 1953 a -2 1953 a
SDict begin 13 H.A end
 -2 1953 a -2 1953 a
SDict begin [/View [/XYZ H.V]/Dest (0:2261) cvn /DEST pdfmark end
 -2 1953
a Black 396 2084 a Fe(\225)p Black 479 2084 a
SDict begin H.S end
 479 2084
a 479 2084 a
SDict begin 13 H.A end
 479 2084 a 479 2084 a
SDict begin [/View [/XYZ H.V]/Dest (0:2262) cvn /DEST pdfmark end
 479 2084 a Fj(That)g(the)g(client)h
(API)f(tracks)g(and)g(holds)f(onto)h(all)h(outstanding)d(requests,)h
(i.e.)i(for)e(which)h(no)g(reply)f(had)h(yet)g(been)479
2192 y(recei)n(v)o(ed.)-2 2193 y
SDict begin H.S end
 -2 2193 a -2 2193 a
SDict begin 13 H.A end

-2 2193 a -2 2193 a
SDict begin [/View [/XYZ H.V]/Dest (0:2263) cvn /DEST pdfmark end
 -2 2193 a Black 396 2341 a Fe(\225)p
Black 479 2341 a
SDict begin H.S end
 479 2341 a 479 2341 a
SDict begin 13 H.A end
 479 2341 a 479
2341 a
SDict begin [/View [/XYZ H.V]/Dest (0:2264) cvn /DEST pdfmark end
 479 2341 a Fj(That)g(in)h(case)f(of)g(f)o(ail-o)o(v)o(er)m(,)e
(the)i(client)g(API)1794 2341 y
SDict begin H.S end
 1794 2341 a 1794 2341
a
SDict begin 13 H.A end
 1794 2341 a 1794 2341 a
SDict begin [/View [/XYZ H.V]/Dest (0:2265) cvn /DEST pdfmark end
 1794 2341 a Fi(r)m(esends)g
Fj(all)h(outstanding)d(requests)i(to)g(the)g(brok)o(er)-5
b(.)-2 2525 y
SDict begin H.S end
 -2 2525 a -2 2525 a
SDict begin 13 H.A end
 -2 2525 a -2 2525 a
SDict begin [/View [/XYZ H.V]/Dest (0:2266) cvn /DEST pdfmark end

-2 2525 a 396 2615 a Fj(It')g(s)21 b(not)f(a)h(deal)f(break)o(er)e(b)n
(ut)j(it)g(does)f(sho)n(w)f(that)i(performance)c(often)i(means)h
(comple)o(xity)-5 b(.)18 b(Is)i(this)h(w)o(orth)f(doing)f(for)396
2723 y(Majordomo?)f(It)i(depends)f(on)h(your)f(use)h(case.)h(F)o(or)f
(a)g(name)g(lookup)e(service)i(you)f(call)i(once)e(per)h(session,)h
(no.)e(F)o(or)h(a)396 2831 y(web)g(front-end)e(serving)h(thousands)g
(of)h(clients,)g(probably)e(yes.)-2 2860 y
SDict begin H.S end
 -2 2860 a
-2 2860 a
SDict begin 13 H.A end
 -2 2860 a -2 2860 a
SDict begin [/View [/XYZ H.V]/Dest (0:2267) cvn /DEST pdfmark end
 -2 2860 a 359 x Fh(4.10.)39
b(Ser)q(vice)f(Disco)m(ver)q(y)1594 3219 y
SDict begin H.S end
 1594 3219
a 1594 3219 a
SDict begin 22.464 H.A end
 1594 3219 a 1594 3219 a
SDict begin [/View [/XYZ H.V]/Dest (9.49.1) cvn /DEST pdfmark end
 1594 3219 a -2
3415 a
SDict begin H.S end
 -2 3415 a -2 3415 a
SDict begin 13 H.A end
 -2 3415 a -2 3415 a
SDict begin [/View [/XYZ H.V]/Dest (0:2269) cvn /DEST pdfmark end
 -2 3415
a 396 3493 a Fj(So,)20 b(we)h(ha)n(v)o(e)f(a)g(nice)g(service-oriented)
e(brok)o(er)m(,)g(b)n(ut)i(we)h(ha)n(v)o(e)e(no)h(w)o(ay)g(of)g(kno)n
(wing)e(whether)i(a)g(particular)f(service)396 3601 y(is)i(a)n(v)n
(ailable)f(or)g(not.)g(W)-7 b(e)21 b(kno)n(w)e(if)i(a)f(request)g(f)o
(ailed,)f(b)n(ut)i(we)f(don')o(t)f(kno)n(w)g(why)-5 b(.)19
b(It)h(is)h(useful)f(to)g(be)g(able)g(to)h(ask)f(the)396
3709 y(brok)o(er)m(,)e("is)j(the)g(echo)e(service)h(running?")e(The)i
(most)g(ob)o(vious)e(w)o(ay)i(w)o(ould)g(be)g(to)g(modify)f(our)g
(MDP/Client)396 3817 y(protocol)e(to)j(add)e(commands)f(to)i(ask)g(the)
g(brok)o(er)m(,)e("is)j(service)e(X)i(running?")c(But)k(MDP/Client)f
(has)g(the)g(great)g(charm)396 3924 y(of)h(being)f(simple.)h(Adding)f
(service)h(disco)o(v)o(ery)e(to)i(it)h(w)o(ould)f(mak)o(e)g(it)g(as)h
(comple)o(x)e(as)i(the)f(MDP/W)-7 b(ork)o(er)20 b(protocol.)-2
4109 y
SDict begin H.S end
 -2 4109 a -2 4109 a
SDict begin 13 H.A end
 -2 4109 a -2 4109 a
SDict begin [/View [/XYZ H.V]/Dest (0:2270) cvn /DEST pdfmark end
 -2 4109
a 396 4198 a Fj(Another)f(option)g(is)i(to)g(do)e(what)h(email)h(does,)
e(and)h(ask)g(that)h(undeli)n(v)o(erable)c(requests)j(be)g(returned.)e
(This)i(can)g(w)o(ork)396 4306 y(well)h(in)f(an)g(asynchronous)e(w)o
(orld)h(b)n(ut)i(it)f(also)h(adds)f(comple)o(xity)-5
b(.)17 b(W)-7 b(e)22 b(need)d(w)o(ays)i(to)f(distinguish)f(returned)396
4414 y(requests)h(from)f(replies,)h(and)g(to)g(handle)f(these)i
(properly)-5 b(.)-2 4598 y
SDict begin H.S end
 -2 4598 a -2 4598 a
SDict begin 13 H.A end
 -2 4598
a -2 4598 a
SDict begin [/View [/XYZ H.V]/Dest (0:2271) cvn /DEST pdfmark end
 -2 4598 a 396 4688 a Fj(Let')g(s)21 b(try)f(to)g(use)h
(what)f(we')l(v)o(e)f(already)g(b)n(uilt,)h(b)n(uilding)f(on)h(top)g
(of)g(MDP)g(instead)g(of)g(modifying)e(it.)j(Service)396
4796 y(disco)o(v)o(ery)d(is,)j(itself,)g(a)f(service.)g(It)g(might)g
(indeed)f(be)h(one)g(of)g(se)n(v)o(eral)f(management)f(services,)i
(such)g(as)h("disable)396 4904 y(service)f(X",)g("pro)o(vide)e
(statistics",)k(and)d(so)i(on.)f(What)g(we)h(w)o(ant)f(is)h(a)g
(general,)e(e)o(xtensible)g(solution)g(that)h(doesn')o(t)396
5012 y(af)n(fect)g(the)g(protocol)f(nor)g(e)o(xisting)g(applications.)p
Black 3756 5569 a Fi(197)p Black eop end
%%Page: 198 212
TeXDict begin 198 211 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.198) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2272) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(So)20 b(here')-5 b(s)19
b(a)h(small)g(RFC)h(-)f(MMI,)f(or)g(the)h(Majordomo)d(Management)h
(Interf)o(ace)g(-)i(that)f(layers)h(this)g(on)f(top)g(of)g(MDP:)396
180 y(http://rfc.zeromq.or)o(g/spec:8.)14 b(W)-7 b(e)22
b(already)d(implemented)f(it)j(in)f(the)g(brok)o(er)m(,)e(though)h
(unless)h(you)f(read)h(the)g(whole)396 288 y(thing)g(you)f(probably)f
(missed)i(that.)g(Here')-5 b(s)21 b(ho)n(w)e(we)i(use)f(the)h(service)e
(disco)o(v)o(ery)g(in)h(an)g(application:)-2 306 y
SDict begin H.S end
 -2
306 a -2 306 a
SDict begin 13 H.A end
 -2 306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:mmiecho-php) cvn /DEST pdfmark
end
 -2 306 a 396 490 a Fk(Example)h(4-15.)
d(Ser)o(vice)i(disco)o(v)o(ery)g(o)o(v)o(er)g(Majordomo)f
(\(mmiecho.php\))-2 590 y
SDict begin H.S end
 -2 590 a -2 590 a
SDict begin 11.7 H.A end
 -2 590 a
-2 590 a
SDict begin [/View [/XYZ H.V]/Dest (0:2275) cvn /DEST pdfmark end
 -2 590 a 396 670 a Fg(<?php)396 767 y(/)441
780 y(*)441 877 y(*)531 864 y(MMI)44 b(echo)g(query)g(example)441
974 y(*)441 1071 y(*)531 1058 y(@author)f(Ian)i(Barber)f
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441 1169 y(*)486
1156 y(/)396 1253 y(include)g("mdcliapi.php";)396 1447
y($verbose)g(=)g($_SERVER['argc'])f(>)h(1)h(&&)f($_SERVER['argv'][1])e
(==)j('-v';)396 1544 y($session)f(=)g(new)h
(MDCli\("tcp://localhost:5555",)40 b($verbose\);)396
1738 y(//)90 b(This)44 b(is)g(the)h(service)e(we)i(want)f(to)g(look)h
(up)396 1835 y($request)f(=)g(new)h(Zmsg\(\);)396 1933
y($request->body_set\("echo"\);)396 2127 y(//)90 b(This)44
b(is)g(the)h(service)e(we)i(send)f(our)g(request)g(to)396
2224 y($reply)g(=)h($session->send\("mmi.service",)40
b($request\);)396 2418 y(if\($reply\))j({)576 2515 y($reply_code)g(=)h
($reply->pop\(\);)576 2613 y(printf)f(\("Lookup)h(echo)g(service:)g
(\045s)g(\045s",)g($reply_code,)f(PHP_EOL\);)-2 2790
y
SDict begin H.S end
 -2 2790 a -2 2790 a
SDict begin 13 H.A end
 -2 2790 a -2 2790 a
SDict begin [/View [/XYZ H.V]/Dest (0:2276) cvn /DEST pdfmark end
 -2 2790 a 396
2887 a Fj(The)20 b(brok)o(er)f(checks)g(the)i(service)e(name,)h(and)f
(handles)h(an)o(y)f(service)h(starting)g(with)g("mmi.")g(itself,)g
(rather)g(than)396 2994 y(passing)g(the)g(request)g(on)g(to)g(a)h(w)o
(ork)o(er)-5 b(.)19 b(T)m(ry)h(this)g(with)h(and)e(without)h(a)g(w)o
(ork)o(er)g(running,)d(and)j(you)f(should)h(see)g(the)396
3102 y(little)h(program)d(report)h('200')g(or)h('404')e(accordingly)-5
b(.)17 b(The)j(implementation)e(of)i(MMI)g(in)h(our)e(e)o(xample)g
(brok)o(er)f(is)396 3210 y(pretty)i(weak.)f(F)o(or)h(e)o(xample)f(if)h
(a)h(w)o(ork)o(er)e(disappears,)g(services)h(remain)g("present".)f(In)h
(practice)f(a)i(brok)o(er)d(should)396 3318 y(remo)o(v)o(e)h(services)h
(that)g(ha)n(v)o(e)g(no)f(w)o(ork)o(ers)h(after)g(some)g
(con\002gurable)d(timeout.)-2 3347 y
SDict begin H.S end
 -2 3347 a -2 3347
a
SDict begin 13 H.A end
 -2 3347 a -2 3347 a
SDict begin [/View [/XYZ H.V]/Dest (0:2277) cvn /DEST pdfmark end
 -2 3347 a 359 x Fh(4.11.)39 b(Idempotent)e(Ser)q
(vices)1763 3706 y
SDict begin H.S end
 1763 3706 a 1763 3706 a
SDict begin 22.464 H.A end
 1763 3706
a 1763 3706 a
SDict begin [/View [/XYZ H.V]/Dest (9.50.1) cvn /DEST pdfmark end
 1763 3706 a -2 3901 a
SDict begin H.S end
 -2 3901 a -2 3901
a
SDict begin 13 H.A end
 -2 3901 a -2 3901 a
SDict begin [/View [/XYZ H.V]/Dest (0:2279) cvn /DEST pdfmark end
 -2 3901 a 396 3980 a Fj(Idempotenc)o(y)17
b(is)k(not)f(something)f(you)g(tak)o(e)h(a)h(pill)g(for)-5
b(.)19 b(What)i(it)g(means)f(is)h(that)f(it')-5 b(s)21
b(safe)g(to)f(repeat)g(an)g(operation.)396 4088 y(Checking)f(the)h
(clock)g(is)h(idempotent.)d(Lending)h(ones)h(credit)f(card)h(to)g(ones)
g(children)f(is)i(not.)f(While)h(man)o(y)396 4196 y(client-to-serv)o
(er)d(use)i(cases)h(are)f(idempotent,)f(some)h(are)g(not.)f(Examples)g
(of)h(idempotent)f(use)h(cases)h(include:)-2 4214 y
SDict begin H.S end
 -2
4214 a -2 4214 a
SDict begin 13 H.A end
 -2 4214 a -2 4214 a
SDict begin [/View [/XYZ H.V]/Dest (0:2280) cvn /DEST pdfmark end
 -2 4214 a -2 4224
a
SDict begin H.S end
 -2 4224 a -2 4224 a
SDict begin 13 H.A end
 -2 4224 a -2 4224 a
SDict begin [/View [/XYZ H.V]/Dest (0:2281) cvn /DEST pdfmark end
 -2 4224 a Black
396 4366 a Fe(\225)p Black 479 4366 a
SDict begin H.S end
 479 4366 a 479
4366 a
SDict begin 13 H.A end
 479 4366 a 479 4366 a
SDict begin [/View [/XYZ H.V]/Dest (0:2282) cvn /DEST pdfmark end
 479 4366 a Fj(Stateless)h(task)e(distrib)n
(ution,)f(i.e.)h(a)h(pipeline)e(where)h(the)g(serv)o(ers)f(are)h
(stateless)i(w)o(ork)o(ers)d(that)i(compute)d(a)j(reply)479
4474 y(based)f(purely)f(on)h(the)g(state)h(pro)o(vided)d(by)h(a)i
(request.)e(In)h(such)g(a)h(case)f(it')-5 b(s)22 b(safe)e(\(though)e
(inef)n(\002cient\))h(to)h(e)o(x)o(ecute)479 4582 y(the)g(same)h
(request)e(man)o(y)g(times.)-2 4600 y
SDict begin H.S end
 -2 4600 a -2 4600
a
SDict begin 13 H.A end
 -2 4600 a -2 4600 a
SDict begin [/View [/XYZ H.V]/Dest (0:2283) cvn /DEST pdfmark end
 -2 4600 a Black 396 4731 a Fe(\225)p
Black 479 4731 a
SDict begin H.S end
 479 4731 a 479 4731 a
SDict begin 13 H.A end
 479 4731 a 479
4731 a
SDict begin [/View [/XYZ H.V]/Dest (0:2284) cvn /DEST pdfmark end
 479 4731 a Fj(A)i(name)e(service)g(that)h(translates)g(logical)g
(addresses)f(into)h(endpoints)e(to)i(bind)f(or)h(connect)e(to.)i(In)g
(such)f(a)h(case)h(it')-5 b(s)479 4839 y(safe)21 b(to)f(mak)o(e)g(the)g
(same)g(lookup)f(request)g(man)o(y)g(times.)-2 5023 y
SDict begin H.S end

-2 5023 a -2 5023 a
SDict begin 13 H.A end
 -2 5023 a -2 5023 a
SDict begin [/View [/XYZ H.V]/Dest (0:2285) cvn /DEST pdfmark end
 -2 5023 a 396
5113 a Fj(And)h(here)g(are)g(e)o(xamples)f(of)h(a)g(non-idempotent)d
(use)j(cases:)-2 5131 y
SDict begin H.S end
 -2 5131 a -2 5131 a
SDict begin 13 H.A end
 -2 5131 a
-2 5131 a
SDict begin [/View [/XYZ H.V]/Dest (0:2286) cvn /DEST pdfmark end
 -2 5131 a -2 5141 a
SDict begin H.S end
 -2 5141 a -2 5141 a
SDict begin 13 H.A end
 -2
5141 a -2 5141 a
SDict begin [/View [/XYZ H.V]/Dest (0:2287) cvn /DEST pdfmark end
 -2 5141 a Black 3759 5569 a Fi(198)p
Black eop end
%%Page: 199 213
TeXDict begin 199 212 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.199) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2288) cvn /DEST pdfmark end
 479 72 a Fj(A)21
b(logging)d(service.)i(One)g(does)g(not)g(w)o(ant)g(the)g(same)h(log)f
(information)d(recorded)i(more)g(than)h(once.)-2 90 y
SDict begin H.S end

-2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:2289) cvn /DEST pdfmark end
 -2 90 a Black 396 222
a Fe(\225)p Black 479 222 a
SDict begin H.S end
 479 222 a 479 222 a
SDict begin 13 H.A end
 479 222
a 479 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:2290) cvn /DEST pdfmark end
 479 222 a Fj(An)o(y)g(service)g(that)g(has)g(impact)g(on)g
(do)n(wnstream)e(nodes,)i(e.g.)f(sends)h(on)g(information)e(to)i(other)
g(nodes.)f(If)h(that)479 330 y(service)g(gets)h(the)f(same)g(request)g
(more)f(than)h(once,)f(do)n(wnstream)g(nodes)g(will)i(get)f(duplicate)f
(information.)-2 348 y
SDict begin H.S end
 -2 348 a -2 348 a
SDict begin 13 H.A end
 -2 348 a -2
348 a
SDict begin [/View [/XYZ H.V]/Dest (0:2291) cvn /DEST pdfmark end
 -2 348 a Black 396 479 a Fe(\225)p Black 479 479
a
SDict begin H.S end
 479 479 a 479 479 a
SDict begin 13 H.A end
 479 479 a 479 479 a
SDict begin [/View [/XYZ H.V]/Dest (0:2292) cvn /DEST pdfmark end
 479 479 a Fj(An)o(y)h
(service)g(that)g(modi\002es)g(shared)f(data)h(in)h(some)f
(non-idempotent)c(w)o(ay)-5 b(.)20 b(E.g.)f(a)i(service)f(that)g
(debits)g(a)h(bank)479 587 y(account)e(is)i(de\002nitely)f(not)g
(idempotent.)-2 771 y
SDict begin H.S end
 -2 771 a -2 771 a
SDict begin 13 H.A end
 -2 771 a -2 771
a
SDict begin [/View [/XYZ H.V]/Dest (0:2293) cvn /DEST pdfmark end
 -2 771 a 396 861 a Fj(When)g(our)g(serv)o(er)f(applications)g(are)h
(not)g(idempotent,)e(we)j(ha)n(v)o(e)e(to)i(think)e(more)g(carefully)g
(about)g(when)h(e)o(xactly)396 969 y(the)o(y)g(might)f(crash.)h(If)g
(an)g(application)f(dies)h(when)g(it')-5 b(s)21 b(idle,)f(or)g(while)g
(it')-5 b(s)22 b(processing)d(a)h(request,)f(that')-5
b(s)21 b(usually)396 1077 y(\002ne.)e(W)-7 b(e)21 b(can)e(use)h
(database)f(transactions)f(to)i(mak)o(e)e(sure)i(a)g(debit)e(and)h(a)h
(credit)f(are)g(al)o(w)o(ays)h(done)e(together)m(,)g(if)i(at)f(all.)396
1185 y(If)h(the)h(serv)o(er)e(dies)h(while)h(sending)e(its)i(reply)-5
b(,)19 b(that')-5 b(s)20 b(a)h(problem,)d(because)i(as)g(f)o(ar)h(as)f
(it')-5 b(s)22 b(concerned,)17 b(it')-5 b(s)22 b(done)d(its)396
1293 y(w)o(ork.)-2 1460 y
SDict begin H.S end
 -2 1460 a -2 1460 a
SDict begin 13 H.A end
 -2 1460
a -2 1460 a
SDict begin [/View [/XYZ H.V]/Dest (0:2294) cvn /DEST pdfmark end
 -2 1460 a 396 1567 a Fj(if)i(the)f(netw)o(ork)f(dies)h
(just)h(as)g(the)f(reply)g(is)h(making)e(its)i(w)o(ay)f(back)g(to)g
(the)g(client,)g(the)g(same)h(problem)d(arises.)j(The)396
1675 y(client)f(will)h(think)f(the)g(serv)o(er)f(died,)h(will)h(resend)
e(the)h(request,)g(and)f(the)i(serv)o(er)e(will)i(do)f(the)g(same)g(w)o
(ork)g(twice.)396 1783 y(Which)g(is)h(not)f(what)g(we)h(w)o(ant.)-2
1950 y
SDict begin H.S end
 -2 1950 a -2 1950 a
SDict begin 13 H.A end
 -2 1950 a -2 1950 a
SDict begin [/View [/XYZ H.V]/Dest (0:2295) cvn /DEST pdfmark end
 -2 1950
a 396 2057 a Fj(W)-7 b(e)22 b(use)e(the)g(f)o(airly)g(standard)f
(solution)g(of)h(detecting)f(and)h(rejecting)f(duplicate)g(requests.)h
(This)g(means:)-2 2075 y
SDict begin H.S end
 -2 2075 a -2 2075 a
SDict begin 13 H.A end
 -2 2075
a -2 2075 a
SDict begin [/View [/XYZ H.V]/Dest (0:2296) cvn /DEST pdfmark end
 -2 2075 a -2 2085 a
SDict begin H.S end
 -2 2085 a -2 2085 a
SDict begin 13 H.A end
 -2
2085 a -2 2085 a
SDict begin [/View [/XYZ H.V]/Dest (0:2297) cvn /DEST pdfmark end
 -2 2085 a Black 396 2227 a Fe(\225)p
Black 479 2227 a
SDict begin H.S end
 479 2227 a 479 2227 a
SDict begin 13 H.A end
 479 2227 a 479
2227 a
SDict begin [/View [/XYZ H.V]/Dest (0:2298) cvn /DEST pdfmark end
 479 2227 a Fj(The)g(client)g(must)h(stamp)f(e)n(v)o(ery)f
(request)g(with)h(a)h(unique)e(client)h(identi\002er)g(and)f(a)i
(unique)e(message)h(number)-5 b(.)-2 2245 y
SDict begin H.S end
 -2 2245 a
-2 2245 a
SDict begin 13 H.A end
 -2 2245 a -2 2245 a
SDict begin [/View [/XYZ H.V]/Dest (0:2299) cvn /DEST pdfmark end
 -2 2245 a Black 396 2376
a Fe(\225)p Black 479 2376 a
SDict begin H.S end
 479 2376 a 479 2376 a
SDict begin 13 H.A end
 479
2376 a 479 2376 a
SDict begin [/View [/XYZ H.V]/Dest (0:2300) cvn /DEST pdfmark end
 479 2376 a Fj(The)20 b(serv)o(er)m(,)f(before)g
(sending)g(back)g(a)i(reply)-5 b(,)19 b(stores)h(it)h(using)f(the)g
(client)g(id)g(+)h(message)f(number)e(as)j(a)g(k)o(e)o(y)-5
b(.)-2 2394 y
SDict begin H.S end
 -2 2394 a -2 2394 a
SDict begin 13 H.A end
 -2 2394 a -2 2394 a
SDict begin [/View [/XYZ H.V]/Dest (0:2301) cvn /DEST pdfmark end

-2 2394 a Black 396 2526 a Fe(\225)p Black 479 2526 a
SDict begin H.S end

479 2526 a 479 2526 a
SDict begin 13 H.A end
 479 2526 a 479 2526 a
SDict begin [/View [/XYZ H.V]/Dest (0:2302) cvn /DEST pdfmark end
 479 2526
a Fj(The)20 b(serv)o(er)m(,)f(when)g(getting)h(a)g(request)g(from)f(a)i
(gi)n(v)o(en)e(client,)h(\002rst)h(checks)e(if)i(it)g(has)f(a)h(reply)e
(for)h(that)g(client)g(id)g(+)479 2634 y(message)g(number)-5
b(.)19 b(If)h(so,)g(it)h(does)f(not)g(process)g(the)g(request)f(b)n(ut)
i(just)f(resends)g(the)g(reply)-5 b(.)-2 2693 y
SDict begin H.S end
 -2 2693
a -2 2693 a
SDict begin 13 H.A end
 -2 2693 a -2 2693 a
SDict begin [/View [/XYZ H.V]/Dest (0:2303) cvn /DEST pdfmark end
 -2 2693 a 359 x Fh(4.12.)39
b(Disconnected)d(Reliability)i(\(Titanic)g(P)l(attern\))3145
3052 y
SDict begin H.S end
 3145 3052 a 3145 3052 a
SDict begin 22.464 H.A end
 3145 3052 a 3145 3052
a
SDict begin [/View [/XYZ H.V]/Dest (9.51.1) cvn /DEST pdfmark end
 3145 3052 a -2 3248 a
SDict begin H.S end
 -2 3248 a -2 3248 a
SDict begin 13 H.A end
 -2 3248 a
-2 3248 a
SDict begin [/View [/XYZ H.V]/Dest (0:2305) cvn /DEST pdfmark end
 -2 3248 a 396 3326 a Fj(Once)20 b(you)f(realize)h(that)h
(Majordomo)d(is)j(a)f(')l(reliable')f(message)h(brok)o(er)m(,)e(you)i
(might)f(be)h(tempted)f(to)i(add)e(some)396 3434 y(spinning)g(rust)h
(\(that)g(is,)h(ferrous-based)d(hard)h(disk)h(platters\).)g(After)g
(all,)g(this)h(w)o(orks)f(for)f(all)i(the)f(enterprise)396
3542 y(messaging)g(systems.)g(It')-5 b(s)21 b(such)f(a)g(tempting)f
(idea)h(that)h(it')-5 b(s)21 b(a)g(little)g(sad)f(to)g(ha)n(v)o(e)g(to)
g(be)g(ne)o(gati)n(v)o(e.)e(But)j(brutal)396 3650 y(c)o(ynicism)f(is)h
(one)e(of)h(my)g(specialties.)g(So,)h(some)f(reasons)f(you)h(don')o(t)e
(w)o(ant)j(rust-based)e(brok)o(ers)f(sitting)j(in)f(the)396
3758 y(center)g(of)g(your)f(architecture)f(are:)-2 3776
y
SDict begin H.S end
 -2 3776 a -2 3776 a
SDict begin 13 H.A end
 -2 3776 a -2 3776 a
SDict begin [/View [/XYZ H.V]/Dest (0:2306) cvn /DEST pdfmark end
 -2 3776 a -2
3786 a
SDict begin H.S end
 -2 3786 a -2 3786 a
SDict begin 13 H.A end
 -2 3786 a -2 3786 a
SDict begin [/View [/XYZ H.V]/Dest (0:2307) cvn /DEST pdfmark end
 -2 3786
a Black 396 3928 a Fe(\225)p Black 479 3928 a
SDict begin H.S end
 479 3928
a 479 3928 a
SDict begin 13 H.A end
 479 3928 a 479 3928 a
SDict begin [/View [/XYZ H.V]/Dest (0:2308) cvn /DEST pdfmark end
 479 3928 a Fj(As)j(you')l(v)o(e)d
(seen,)i(the)g(Lazy)g(Pirate)h(client)f(performs)e(surprisingly)h
(well.)h(It)h(w)o(orks)e(across)i(a)f(whole)g(range)f(of)479
4036 y(architectures,)g(from)g(direct)h(client-to-serv)o(er)e(to)i
(distrib)n(uted)f(queue)g(de)n(vices.)h(It)g(does)g(tend)g(to)g(assume)
g(that)479 4144 y(w)o(ork)o(ers)g(are)f(stateless)j(and)d(idempotent.)f
(But)i(we)h(can)e(w)o(ork)h(around)e(that)i(limitation)f(without)g
(resorting)g(to)h(rust.)-2 4162 y
SDict begin H.S end
 -2 4162 a -2 4162 a
SDict begin 13 H.A end

-2 4162 a -2 4162 a
SDict begin [/View [/XYZ H.V]/Dest (0:2309) cvn /DEST pdfmark end
 -2 4162 a Black 396 4294 a Fe(\225)p
Black 479 4294 a
SDict begin H.S end
 479 4294 a 479 4294 a
SDict begin 13 H.A end
 479 4294 a 479
4294 a
SDict begin [/View [/XYZ H.V]/Dest (0:2310) cvn /DEST pdfmark end
 479 4294 a Fj(Rust)h(brings)f(a)g(whole)g(set)h(of)f(problems,)e
(from)h(slo)n(w)i(performance)c(to)k(additional)d(pieces)j(to)f(ha)n(v)
o(e)g(to)g(manage,)479 4401 y(repair)m(,)f(and)g(create)h(6am)f(panics)
g(as)i(the)o(y)e(ine)n(vitably)g(break)f(at)j(the)f(start)g(of)f(daily)
h(operations.)e(The)h(beauty)g(of)h(the)479 4509 y(Pirate)h(patterns)e
(in)i(general)e(is)i(their)f(simplicity)-5 b(.)19 b(The)o(y)g(w)o(on')o
(t)g(crash.)h(And)g(if)g(you')l(re)f(still)i(w)o(orried)e(about)g(the)
479 4617 y(hardw)o(are,)g(you)g(can)h(mo)o(v)o(e)f(to)h(a)h(peer)n
(-to-peer)d(pattern)h(that)h(has)h(no)e(brok)o(er)g(at)i(all.)f(I')o
(ll)h(e)o(xplain)d(later)j(in)f(this)479 4725 y(chapter)-5
b(.)-2 4909 y
SDict begin H.S end
 -2 4909 a -2 4909 a
SDict begin 13 H.A end
 -2 4909 a -2 4909 a
SDict begin [/View [/XYZ H.V]/Dest (0:2311) cvn /DEST pdfmark end

-2 4909 a 396 4999 a Fj(Ha)n(ving)20 b(said)g(this,)h(ho)n(we)n(v)o(er)
m(,)c(there)j(is)h(one)f(sane)g(use)h(case)f(for)g(rust-based)f
(reliability)-5 b(,)19 b(which)g(is)j(an)e(asynchronous)396
5107 y(disconnected)e(netw)o(ork.)h(It)i(solv)o(es)f(a)g(major)g
(problem)e(with)j(Pirate,)f(namely)f(that)h(a)h(client)f(has)h(to)f(w)o
(ait)h(for)e(an)p Black 3759 5569 a Fi(199)p Black eop
end
%%Page: 200 214
TeXDict begin 200 213 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.200) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2329) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 396 72 a Fj(answer)19 b(in)f(real-time.)g(If)g
(clients)h(and)f(w)o(ork)o(ers)g(are)h(only)f(sporadically)f(connected)
g(\(think)g(of)h(email)h(as)g(an)g(analogy\),)396 180
y(we)i(can')o(t)e(use)h(a)h(stateless)h(netw)o(ork)d(between)g(clients)
h(and)g(w)o(ork)o(ers.)f(W)-7 b(e)22 b(ha)n(v)o(e)d(to)i(put)e(state)i
(in)g(the)f(middle.)-2 364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364
a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:2312) cvn /DEST pdfmark end
 -2 364 a 396 454 a Fj(So,)g(here')-5 b(s)20
b(the)h(T)m(itanic)f(pattern\()p 0 TeXcolorgray 1380
454 a
SDict begin H.S end
 1380 454 a Fj(Figure)d(4-5)1727 454 y
SDict begin 13 H.L end
 1727 454
a 1727 454 a
SDict begin [/Subtype /Link/Dest (0:figure-57) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1727 454 a Black -1 w Fj(\),)j(in)h(which)e(we)i(write)f
(messages)h(to)f(disk)g(to)g(ensure)g(the)o(y)f(ne)n(v)o(er)g(get)396
562 y(lost,)i(no)f(matter)f(ho)n(w)h(sporadically)f(clients)h(and)g(w)o
(ork)o(ers)f(are)h(connected.)e(As)j(we)g(did)f(for)f(service)h(disco)o
(v)o(ery)-5 b(,)396 670 y(we')l(re)20 b(going)f(to)h(layer)g(T)m
(itanic)g(on)g(top)f(of)h(Majordomo)e(rather)h(than)h(e)o(xtend)f(MDP)
-9 b(.)20 b(It')-5 b(s)21 b(w)o(onderfully)d(lazy)i(because)396
778 y(it)h(means)f(we)h(can)f(implement)f(our)g(\002re-and-for)o(get)d
(reliability)k(in)g(a)h(specialized)e(w)o(ork)o(er)m(,)g(rather)h(than)
f(in)i(the)396 886 y(brok)o(er)-5 b(.)19 b(This)h(is)i(e)o(xcellent)d
(for)g(se)n(v)o(eral)h(reasons:)-2 887 y
SDict begin H.S end
 -2 887 a -2
887 a
SDict begin 13 H.A end
 -2 887 a -2 887 a
SDict begin [/View [/XYZ H.V]/Dest (0:2314) cvn /DEST pdfmark end
 -2 887 a -2 897 a
SDict begin H.S end
 -2 897 a -2
897 a
SDict begin 13 H.A end
 -2 897 a -2 897 a
SDict begin [/View [/XYZ H.V]/Dest (0:2315) cvn /DEST pdfmark end
 -2 897 a Black 396 1056 a Fe(\225)p
Black 479 1056 a
SDict begin H.S end
 479 1056 a 479 1056 a
SDict begin 13 H.A end
 479 1056 a 479
1056 a
SDict begin [/View [/XYZ H.V]/Dest (0:2316) cvn /DEST pdfmark end
 479 1056 a Fj(It)h(is)627 1056 y
SDict begin H.S end
 627 1056 a 627
1056 a
SDict begin 13 H.A end
 627 1056 a 627 1056 a
SDict begin [/View [/XYZ H.V]/Dest (0:2317) cvn /DEST pdfmark end
 627 1056 a Fi(muc)o(h)e
Fj(easier)i(because)e(we)i(di)n(vide)e(and)h(conquer:)e(the)i(brok)o
(er)f(handles)g(message)h(routing)f(and)g(the)h(w)o(ork)o(er)479
1164 y(handles)g(reliability)-5 b(.)-2 1182 y
SDict begin H.S end
 -2 1182
a -2 1182 a
SDict begin 13 H.A end
 -2 1182 a -2 1182 a
SDict begin [/View [/XYZ H.V]/Dest (0:2318) cvn /DEST pdfmark end
 -2 1182 a Black 396 1314
a Fe(\225)p Black 479 1314 a
SDict begin H.S end
 479 1314 a 479 1314 a
SDict begin 13 H.A end
 479
1314 a 479 1314 a
SDict begin [/View [/XYZ H.V]/Dest (0:2319) cvn /DEST pdfmark end
 479 1314 a Fj(It)21 b(lets)g(us)f(mix)g(brok)o(ers)f
(written)h(in)h(one)e(language)g(with)h(w)o(ork)o(ers)g(written)f(in)i
(another)-5 b(.)-2 1332 y
SDict begin H.S end
 -2 1332 a -2 1332 a
SDict begin 13 H.A end
 -2 1332
a -2 1332 a
SDict begin [/View [/XYZ H.V]/Dest (0:2320) cvn /DEST pdfmark end
 -2 1332 a Black 396 1463 a Fe(\225)p Black
479 1463 a
SDict begin H.S end
 479 1463 a 479 1463 a
SDict begin 13 H.A end
 479 1463 a 479 1463
a
SDict begin [/View [/XYZ H.V]/Dest (0:2321) cvn /DEST pdfmark end
 479 1463 a Fj(It)21 b(lets)g(us)f(e)n(v)n(olv)o(e)g(the)g
(\002re-and-for)o(get)c(technology)i(independently)-5
b(.)-2 1647 y
SDict begin H.S end
 -2 1647 a -2 1647 a
SDict begin 13 H.A end
 -2 1647 a -2 1647 a
SDict begin [/View [/XYZ H.V]/Dest (0:2322) cvn /DEST pdfmark end

-2 1647 a 396 1737 a Fj(The)20 b(only)f(do)n(wnside)g(is)j(that)e
(there')-5 b(s)20 b(an)g(e)o(xtra)f(netw)o(ork)g(hop)h(between)f(brok)o
(er)g(and)g(hard)h(disk.)g(This)g(is)h(easily)396 1845
y(w)o(orth)f(it.)-2 2012 y
SDict begin H.S end
 -2 2012 a -2 2012 a
SDict begin 13 H.A end
 -2 2012
a -2 2012 a
SDict begin [/View [/XYZ H.V]/Dest (0:2323) cvn /DEST pdfmark end
 -2 2012 a 396 2119 a Fj(There)g(are)g(man)o(y)f(w)o(ays)h
(to)h(mak)o(e)e(a)i(persistent)f(request-reply)e(architecture.)g(W)-7
b(e')o(ll)21 b(aim)g(for)e(simple)h(and)g(painless.)396
2227 y(The)g(simplest)h(design)e(I)i(could)e(come)g(up)h(with,)g(after)
g(playing)f(with)h(this)h(for)f(a)g(fe)n(w)g(hours,)f(is)i(T)m(itanic)g
(as)f(a)h("proxy)396 2335 y(service".)f(That)g(is,)h(it)f(doesn')o(t)f
(af)n(fect)h(w)o(ork)o(ers)f(at)i(all.)g(If)f(a)g(client)g(w)o(ants)h
(a)g(reply)e(immediately)-5 b(,)18 b(it)j(talks)g(directly)e(to)396
2443 y(a)i(service)f(and)f(hopes)h(the)g(service)g(is)h(a)n(v)n
(ailable.)f(If)g(a)g(client)g(is)i(happ)o(y)c(to)j(w)o(ait)g(a)f
(while,)g(it)h(talks)g(to)f(T)m(itanic)g(instead)396
2551 y(and)g(asks,)g("he)o(y)-5 b(,)19 b(b)n(uddy)-5
b(,)18 b(w)o(ould)h(you)h(tak)o(e)g(care)g(of)g(this)h(for)e(me)h
(while)h(I)f(go)g(b)n(uy)f(my)h(groceries?")-2 2569 y
SDict begin H.S end

-2 2569 a -2 2569 a
SDict begin 13 H.A end
 -2 2569 a -2 2569 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-57) cvn /DEST pdfmark
end
 -2 2569 a Black
3759 5569 a Fi(200)p Black eop end
%%Page: 201 215
TeXDict begin 201 214 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.201) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2347) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-5.)f(The)i(T)o
(itanic)f(P)o(atter)o(n)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2
172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2326) cvn /DEST pdfmark end
 -2 172 a 396 2614 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2614 a @beginspecial
0 @llx -288 @lly 378 @urx 0 @ury 3780 @rwi @setspecial
%%BeginDocument: images/fig57.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -288 378 0
%%HiResBoundingBox: 0.0 -288.0 378.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -23.800180435180664 moveto
16.800180435180664 -55.80017852783203 lineto
16.800180435180664 -58.466845194498696 17.800180435180664 -59.80017852783203 19.800180435180664 -59.80017852783203 curveto
85.80017852783203 -59.80017852783203 lineto
85.80017852783203 -59.80017852783203 lineto
87.80017852783203 -59.80017852783203 88.80017852783203 -58.466845194498696 88.80017852783203 -55.80017852783203 curveto
88.80017852783203 -23.800180435180664 lineto
88.80017852783203 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
112.80017852783203 -23.800180435180664 moveto
112.80017852783203 -55.80017852783203 lineto
112.80017852783203 -58.466845194498696 113.80017852783203 -59.80017852783203 115.80017852783203 -59.80017852783203 curveto
181.80018615722656 -59.80017852783203 lineto
181.80018615722656 -59.80017852783203 lineto
183.80018615722656 -59.80017852783203 184.80018615722656 -58.466845194498696 184.80018615722656 -55.80017852783203 curveto
184.80018615722656 -23.800180435180664 lineto
184.80018615722656 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
208.80018615722656 -23.800180435180664 moveto
208.80018615722656 -55.80017852783203 lineto
208.80018615722656 -58.466845194498696 209.80018615722656 -59.80017852783203 211.80018615722656 -59.80017852783203 curveto
277.8001708984375 -59.80017852783203 lineto
277.8001708984375 -59.80017852783203 lineto
279.8001708984375 -59.80017852783203 280.8001708984375 -58.466845194498696 280.8001708984375 -55.80017852783203 curveto
280.8001708984375 -23.800180435180664 lineto
280.8001708984375 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
115.80017852783203 -122.80017852783203 moveto
113.80017852783203 -122.80017852783203 112.80017852783203 -124.4668451944987 112.80017852783203 -127.80017852783203 curveto
112.80017852783203 -154.80018615722656 lineto
112.80017852783203 -157.46685282389322 113.80017852783203 -158.80018615722656 115.80017852783203 -158.80018615722656 curveto
181.80018615722656 -158.80018615722656 lineto
181.80018615722656 -158.80018615722656 lineto
183.80018615722656 -158.80018615722656 184.80018615722656 -157.46685282389322 184.80018615722656 -154.80018615722656 curveto
184.80018615722656 -127.80017852783203 lineto
184.80018615722656 -127.80017852783203 lineto
184.80018615722656 -124.4668451944987 183.80018615722656 -122.80017852783203 181.80018615722656 -122.80017852783203 curveto
115.80017852783203 -122.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
220.80018615722656 -122.80017852783203 moveto
220.80018615722656 -158.80018615722656 lineto
280.8001708984375 -158.80018615722656 lineto
280.8001708984375 -122.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
316.8001708984375 -122.80017852783203 moveto
324.8001708984375 -126.80017852783203 356.8001708984375 -126.80017852783203 364.8001708984375 -122.80017852783203 curveto
356.8001708984375 -118.80017852783203 324.8001708984375 -118.80017852783203 316.8001708984375 -122.80017852783203 curveto
316.8001708984375 -122.80017852783203 moveto
316.8001708984375 -158.80018615722656 lineto
324.8001708984375 -164.80018615722656 356.8001708984375 -164.80018615722656 364.8001708984375 -158.80018615722656 curveto
364.8001708984375 -122.80017852783203 lineto
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -212.80018615722656 moveto
17.800180435180664 -212.80018615722656 16.800180435180664 -214.46685282389322 16.800180435180664 -217.80018615722656 curveto
16.800180435180664 -228.80018615722656 lineto
88.80017852783203 -228.80018615722656 lineto
88.80017852783203 -217.80018615722656 lineto
88.80017852783203 -214.46685282389322 87.80017852783203 -212.80018615722656 85.80017852783203 -212.80018615722656 curveto
19.800180435180664 -212.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -231.80018615722656 moveto
16.800180435180664 -266.8001708984375 lineto
88.80017852783203 -266.8001708984375 lineto
88.80017852783203 -231.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
115.80017852783203 -212.80018615722656 moveto
113.80017852783203 -212.80018615722656 112.80017852783203 -214.46685282389322 112.80017852783203 -217.80018615722656 curveto
112.80017852783203 -228.80018615722656 lineto
184.80018615722656 -228.80018615722656 lineto
184.80018615722656 -217.80018615722656 lineto
184.80018615722656 -214.46685282389322 183.80018615722656 -212.80018615722656 181.80018615722656 -212.80018615722656 curveto
115.80017852783203 -212.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
112.80017852783203 -231.80018615722656 moveto
112.80017852783203 -266.8001708984375 lineto
184.80018615722656 -266.8001708984375 lineto
184.80018615722656 -231.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
211.80018615722656 -212.80018615722656 moveto
209.80018615722656 -212.80018615722656 208.80018615722656 -214.46685282389322 208.80018615722656 -217.80018615722656 curveto
208.80018615722656 -228.80018615722656 lineto
280.8001708984375 -228.80018615722656 lineto
280.8001708984375 -217.80018615722656 lineto
280.8001708984375 -214.46685282389322 279.8001708984375 -212.80018615722656 277.8001708984375 -212.80018615722656 curveto
211.80018615722656 -212.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
208.80018615722656 -231.80018615722656 moveto
208.80018615722656 -266.8001708984375 lineto
280.8001708984375 -266.8001708984375 lineto
280.8001708984375 -231.80018615722656 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
315.0 -121.0 moveto
323.0 -125.0 355.0 -125.0 363.0 -121.0 curveto
355.0 -117.0 323.0 -117.0 315.0 -121.0 curveto
315.0 -121.0 moveto
315.0 -157.0 lineto
323.0 -163.0 355.0 -163.0 363.0 -157.0 curveto
363.0 -121.0 lineto
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
315.0 -121.0 moveto
323.0 -125.0 355.0 -125.0 363.0 -121.0 curveto
355.0 -117.0 323.0 -117.0 315.0 -121.0 curveto
315.0 -121.0 moveto
315.0 -157.0 lineto
323.0 -163.0 355.0 -163.0 363.0 -157.0 curveto
363.0 -121.0 lineto
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -22.0 moveto
15.0 -54.0 lineto
15.0 -56.666666666666664 16.0 -58.0 18.0 -58.0 curveto
84.0 -58.0 lineto
84.0 -58.0 lineto
86.0 -58.0 87.0 -56.666666666666664 87.0 -54.0 curveto
87.0 -22.0 lineto
87.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -22.0 moveto
15.0 -54.0 lineto
15.0 -56.666666666666664 16.0 -58.0 18.0 -58.0 curveto
84.0 -58.0 lineto
84.0 -58.0 lineto
86.0 -58.0 87.0 -56.666666666666664 87.0 -54.0 curveto
87.0 -22.0 lineto
87.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
111.0 -22.0 moveto
111.0 -54.0 lineto
111.0 -56.666666666666664 112.0 -58.0 114.0 -58.0 curveto
180.0 -58.0 lineto
180.0 -58.0 lineto
182.0 -58.0 183.0 -56.666666666666664 183.0 -54.0 curveto
183.0 -22.0 lineto
183.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
111.0 -22.0 moveto
111.0 -54.0 lineto
111.0 -56.666666666666664 112.0 -58.0 114.0 -58.0 curveto
180.0 -58.0 lineto
180.0 -58.0 lineto
182.0 -58.0 183.0 -56.666666666666664 183.0 -54.0 curveto
183.0 -22.0 lineto
183.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -22.0 moveto
207.0 -54.0 lineto
207.0 -56.666666666666664 208.0 -58.0 210.0 -58.0 curveto
276.0 -58.0 lineto
276.0 -58.0 lineto
278.0 -58.0 279.0 -56.666666666666664 279.0 -54.0 curveto
279.0 -22.0 lineto
279.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -22.0 moveto
207.0 -54.0 lineto
207.0 -56.666666666666664 208.0 -58.0 210.0 -58.0 curveto
276.0 -58.0 lineto
276.0 -58.0 lineto
278.0 -58.0 279.0 -56.666666666666664 279.0 -54.0 curveto
279.0 -22.0 lineto
279.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
114.0 -121.0 moveto
112.0 -121.0 111.0 -122.66666666666667 111.0 -126.0 curveto
111.0 -153.0 lineto
111.0 -155.66666666666666 112.0 -157.0 114.0 -157.0 curveto
180.0 -157.0 lineto
180.0 -157.0 lineto
182.0 -157.0 183.0 -155.66666666666666 183.0 -153.0 curveto
183.0 -126.0 lineto
183.0 -126.0 lineto
183.0 -122.66666666666667 182.0 -121.0 180.0 -121.0 curveto
114.0 -121.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
114.0 -121.0 moveto
112.0 -121.0 111.0 -122.66666666666667 111.0 -126.0 curveto
111.0 -153.0 lineto
111.0 -155.66666666666666 112.0 -157.0 114.0 -157.0 curveto
180.0 -157.0 lineto
180.0 -157.0 lineto
182.0 -157.0 183.0 -155.66666666666666 183.0 -153.0 curveto
183.0 -126.0 lineto
183.0 -126.0 lineto
183.0 -122.66666666666667 182.0 -121.0 180.0 -121.0 curveto
114.0 -121.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
219.0 -121.0 moveto
219.0 -157.0 lineto
279.0 -157.0 lineto
279.0 -121.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
219.0 -121.0 moveto
219.0 -157.0 lineto
279.0 -157.0 lineto
279.0 -121.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -211.0 moveto
16.0 -211.0 15.0 -212.66666666666666 15.0 -216.0 curveto
15.0 -227.0 lineto
87.0 -227.0 lineto
87.0 -216.0 lineto
87.0 -212.66666666666666 86.0 -211.0 84.0 -211.0 curveto
18.0 -211.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
18.0 -211.0 moveto
16.0 -211.0 15.0 -212.66666666666666 15.0 -216.0 curveto
15.0 -227.0 lineto
87.0 -227.0 lineto
87.0 -216.0 lineto
87.0 -212.66666666666666 86.0 -211.0 84.0 -211.0 curveto
18.0 -211.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -230.0 moveto
15.0 -265.0 lineto
87.0 -265.0 lineto
87.0 -230.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -230.0 moveto
15.0 -265.0 lineto
87.0 -265.0 lineto
87.0 -230.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
114.0 -211.0 moveto
112.0 -211.0 111.0 -212.66666666666666 111.0 -216.0 curveto
111.0 -227.0 lineto
183.0 -227.0 lineto
183.0 -216.0 lineto
183.0 -212.66666666666666 182.0 -211.0 180.0 -211.0 curveto
114.0 -211.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
114.0 -211.0 moveto
112.0 -211.0 111.0 -212.66666666666666 111.0 -216.0 curveto
111.0 -227.0 lineto
183.0 -227.0 lineto
183.0 -216.0 lineto
183.0 -212.66666666666666 182.0 -211.0 180.0 -211.0 curveto
114.0 -211.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
111.0 -230.0 moveto
111.0 -265.0 lineto
183.0 -265.0 lineto
183.0 -230.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
111.0 -230.0 moveto
111.0 -265.0 lineto
183.0 -265.0 lineto
183.0 -230.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
210.0 -211.0 moveto
208.0 -211.0 207.0 -212.66666666666666 207.0 -216.0 curveto
207.0 -227.0 lineto
279.0 -227.0 lineto
279.0 -216.0 lineto
279.0 -212.66666666666666 278.0 -211.0 276.0 -211.0 curveto
210.0 -211.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
210.0 -211.0 moveto
208.0 -211.0 207.0 -212.66666666666666 207.0 -216.0 curveto
207.0 -227.0 lineto
279.0 -227.0 lineto
279.0 -216.0 lineto
279.0 -212.66666666666666 278.0 -211.0 276.0 -211.0 curveto
210.0 -211.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -230.0 moveto
207.0 -265.0 lineto
279.0 -265.0 lineto
279.0 -230.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -230.0 moveto
207.0 -265.0 lineto
279.0 -265.0 lineto
279.0 -230.0 lineto
closepath
stroke
newpath
189.0 -139.0 moveto
213.0 -139.0 lineto
stroke
newpath
285.0 -139.0 moveto
309.0 -139.0 lineto
stroke
newpath
51.0 -63.0 moveto
48.0 -72.0 lineto
54.0 -72.0 lineto
closepath
fill
newpath
147.0 -63.0 moveto
144.0 -72.0 lineto
150.0 -72.0 lineto
closepath
fill
newpath
243.0 -63.0 moveto
240.0 -72.0 lineto
246.0 -72.0 lineto
closepath
fill
newpath
144.0 -108.0 moveto
147.0 -117.0 lineto
150.0 -108.0 lineto
closepath
fill
newpath
192.0 -135.0 moveto
186.0 -139.0 lineto
192.0 -144.0 lineto
closepath
fill
newpath
210.0 -135.0 moveto
216.0 -139.0 lineto
210.0 -144.0 lineto
closepath
fill
newpath
288.0 -135.0 moveto
282.0 -139.0 lineto
288.0 -144.0 lineto
closepath
fill
newpath
306.0 -135.0 moveto
312.0 -139.0 lineto
306.0 -144.0 lineto
closepath
fill
newpath
147.0 -162.0 moveto
144.0 -171.0 lineto
150.0 -171.0 lineto
closepath
fill
newpath
48.0 -198.0 moveto
51.0 -207.0 lineto
54.0 -198.0 lineto
closepath
fill
newpath
144.0 -198.0 moveto
147.0 -207.0 lineto
150.0 -198.0 lineto
closepath
fill
newpath
240.0 -198.0 moveto
243.0 -207.0 lineto
246.0 -198.0 lineto
closepath
fill
newpath
51.0 -67.0 moveto
51.0 -81.0 lineto
51.0 -83.66666666666667 52.0 -85.0 54.0 -85.0 curveto
147.0 -85.0 lineto
147.0 -85.0 lineto
stroke
newpath
147.0 -67.0 moveto
147.0 -85.0 lineto
stroke
newpath
243.0 -67.0 moveto
243.0 -81.0 lineto
243.0 -83.66666666666667 242.0 -85.0 240.0 -85.0 curveto
147.0 -85.0 lineto
147.0 -85.0 lineto
stroke
newpath
147.0 -112.0 moveto
147.0 -85.0 lineto
stroke
newpath
147.0 -166.0 moveto
147.0 -184.0 lineto
stroke
newpath
51.0 -202.0 moveto
51.0 -189.0 lineto
51.0 -185.66666666666666 52.0 -184.0 54.0 -184.0 curveto
147.0 -184.0 lineto
147.0 -184.0 lineto
stroke
newpath
147.0 -202.0 moveto
147.0 -184.0 lineto
stroke
newpath
243.0 -202.0 moveto
243.0 -189.0 lineto
243.0 -185.66666666666666 242.0 -184.0 240.0 -184.0 curveto
147.0 -184.0 lineto
147.0 -184.0 lineto
stroke
/Helvetica findfont
9 scalefont setfont
34.0 -44.0 moveto
(Client) show
130.0 -44.0 moveto
(Client) show
226.0 -44.0 moveto
(Client) show
12.0 -98.0 moveto
(Titanic,) show
12.0 -107.0 moveto
(give me coffee") show
211.0 -98.0 moveto
("Titanic,) show
215.0 -107.0 moveto
(give me tea") show
320.0 -116.0 moveto
(Disk) show
128.0 -143.0 moveto
(Broker) show
233.0 -143.0 moveto
(Titanic) show
31.0 -224.0 moveto
("Water") show
133.0 -224.0 moveto
("Tea") show
219.0 -224.0 moveto
("Coffee") show
30.0 -251.0 moveto
(Worker) show
126.0 -251.0 moveto
(Worker) show
222.0 -251.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2614 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2614 a 274 x Fj(T)m(itanic)g(is)h(thus)g
(both)e(a)i(w)o(ork)o(er)m(,)d(and)i(a)g(client.)g(The)g(dialog)g
(between)f(client)h(and)g(T)m(itanic)g(goes)g(along)f(these)h(lines:)-2
2906 y
SDict begin H.S end
 -2 2906 a -2 2906 a
SDict begin 13 H.A end
 -2 2906 a -2 2906 a
SDict begin [/View [/XYZ H.V]/Dest (0:2330) cvn /DEST pdfmark end
 -2 2906
a -2 2916 a
SDict begin H.S end
 -2 2916 a -2 2916 a
SDict begin 13 H.A end
 -2 2916 a -2 2916 a
SDict begin [/View [/XYZ H.V]/Dest (0:2331) cvn /DEST pdfmark end
 -2
2916 a Black 396 3058 a Fe(\225)p Black 479 3058 a
SDict begin H.S end
 479
3058 a 479 3058 a
SDict begin 13 H.A end
 479 3058 a 479 3058 a
SDict begin [/View [/XYZ H.V]/Dest (0:2332) cvn /DEST pdfmark end
 479 3058 a Fj(Client:)h(please)
f(accept)g(this)h(request)e(for)h(me.)g(T)m(itanic:)g(OK,)g(done.)-2
3076 y
SDict begin H.S end
 -2 3076 a -2 3076 a
SDict begin 13 H.A end
 -2 3076 a -2 3076 a
SDict begin [/View [/XYZ H.V]/Dest (0:2333) cvn /DEST pdfmark end
 -2 3076
a Black 396 3207 a Fe(\225)p Black 479 3207 a
SDict begin H.S end
 479 3207
a 479 3207 a
SDict begin 13 H.A end
 479 3207 a 479 3207 a
SDict begin [/View [/XYZ H.V]/Dest (0:2334) cvn /DEST pdfmark end
 479 3207 a Fj(Client:)h(do)f(you)f
(ha)n(v)o(e)h(a)g(reply)g(for)f(me?)h(T)m(itanic:)h(Y)-8
b(es,)20 b(here)f(it)i(is.)g(Or)m(,)f(no,)g(not)f(yet.)-2
3225 y
SDict begin H.S end
 -2 3225 a -2 3225 a
SDict begin 13 H.A end
 -2 3225 a -2 3225 a
SDict begin [/View [/XYZ H.V]/Dest (0:2335) cvn /DEST pdfmark end
 -2 3225
a Black 396 3357 a Fe(\225)p Black 479 3357 a
SDict begin H.S end
 479 3357
a 479 3357 a
SDict begin 13 H.A end
 479 3357 a 479 3357 a
SDict begin [/View [/XYZ H.V]/Dest (0:2336) cvn /DEST pdfmark end
 479 3357 a Fj(Client:)i(ok,)f(you)f
(can)h(wipe)g(that)g(request)g(no)n(w)-5 b(,)19 b(it')-5
b(s)21 b(all)g(happ)o(y)-5 b(.)18 b(T)m(itanic:)i(OK,)h(done.)-2
3541 y
SDict begin H.S end
 -2 3541 a -2 3541 a
SDict begin 13 H.A end
 -2 3541 a -2 3541 a
SDict begin [/View [/XYZ H.V]/Dest (0:2337) cvn /DEST pdfmark end
 -2 3541
a 396 3631 a Fj(Whereas)f(the)h(dialog)e(between)g(T)m(itanic)h(and)g
(brok)o(er)f(and)g(w)o(ork)o(er)g(goes)h(lik)o(e)h(this:)-2
3649 y
SDict begin H.S end
 -2 3649 a -2 3649 a
SDict begin 13 H.A end
 -2 3649 a -2 3649 a
SDict begin [/View [/XYZ H.V]/Dest (0:2338) cvn /DEST pdfmark end
 -2 3649
a -2 3659 a
SDict begin H.S end
 -2 3659 a -2 3659 a
SDict begin 13 H.A end
 -2 3659 a -2 3659 a
SDict begin [/View [/XYZ H.V]/Dest (0:2339) cvn /DEST pdfmark end
 -2
3659 a Black 396 3801 a Fe(\225)p Black 479 3801 a
SDict begin H.S end
 479
3801 a 479 3801 a
SDict begin 13 H.A end
 479 3801 a 479 3801 a
SDict begin [/View [/XYZ H.V]/Dest (0:2340) cvn /DEST pdfmark end
 479 3801 a Fj(T)m(itanic:)f(he)
o(y)-5 b(,)19 b(brok)o(er)m(,)f(is)j(there)f(an)g(echo)g(service?)f
(Brok)o(er:)h(uhm,)f(yeah,)g(seems)i(lik)o(e.)-2 3819
y
SDict begin H.S end
 -2 3819 a -2 3819 a
SDict begin 13 H.A end
 -2 3819 a -2 3819 a
SDict begin [/View [/XYZ H.V]/Dest (0:2341) cvn /DEST pdfmark end
 -2 3819 a Black
396 3951 a Fe(\225)p Black 479 3951 a
SDict begin H.S end
 479 3951 a 479
3951 a
SDict begin 13 H.A end
 479 3951 a 479 3951 a
SDict begin [/View [/XYZ H.V]/Dest (0:2342) cvn /DEST pdfmark end
 479 3951 a Fj(T)m(itanic:)f(he)o(y)-5
b(,)19 b(echo,)g(please)i(handle)e(this)h(for)g(me.)g(Echo:)f(sure,)h
(here)g(you)f(are.)-2 3968 y
SDict begin H.S end
 -2 3968 a -2 3968 a
SDict begin 13 H.A end
 -2 3968
a -2 3968 a
SDict begin [/View [/XYZ H.V]/Dest (0:2343) cvn /DEST pdfmark end
 -2 3968 a Black 396 4100 a Fe(\225)p Black
479 4100 a
SDict begin H.S end
 479 4100 a 479 4100 a
SDict begin 13 H.A end
 479 4100 a 479 4100
a
SDict begin [/View [/XYZ H.V]/Dest (0:2344) cvn /DEST pdfmark end
 479 4100 a Fj(T)m(itanic:)h(sweeeeet!)-2 4267 y
SDict begin H.S end
 -2
4267 a -2 4267 a
SDict begin 13 H.A end
 -2 4267 a -2 4267 a
SDict begin [/View [/XYZ H.V]/Dest (0:2345) cvn /DEST pdfmark end
 -2 4267 a 396 4374
a Fj(Y)-9 b(ou)20 b(can)g(w)o(ork)f(through)f(this,)j(and)f(the)g
(possible)g(f)o(ailure)f(scenarios.)h(If)g(a)g(w)o(ork)o(er)g(crashes)g
(while)g(processing)f(a)396 4482 y(request,)h(T)m(itanic)g(retries,)g
(inde\002nitely)-5 b(.)18 b(If)i(a)h(reply)e(gets)h(lost)h(some)n
(where,)e(T)m(itanic)h(will)h(retry)-5 b(.)19 b(If)h(the)g(request)f
(gets)396 4590 y(processed)g(b)n(ut)i(the)f(client)g(doesn')o(t)f(get)h
(the)g(reply)-5 b(,)19 b(it)i(will)g(ask)f(again.)f(If)h(T)m(itanic)g
(crashes)g(while)g(processing)f(a)396 4698 y(request,)h(or)f(a)i(reply)
-5 b(,)19 b(the)h(client)g(will)h(try)f(again.)f(As)i(long)e(as)i
(requests)f(are)g(fully)g(committed)f(to)h(safe)h(storage,)e(w)o(ork)
396 4806 y(can')o(t)g(get)i(lost.)p Black 3759 5569 a
Fi(201)p Black eop end
%%Page: 202 216
TeXDict begin 202 215 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.202) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2346) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(The)20 b(handshaking)e(is)j(pedantic,)d
(b)n(ut)j(can)f(be)g(pipelined,)e(i.e.)i(clients)h(can)f(use)g(the)h
(asynchronous)c(Majordomo)396 180 y(pattern)j(to)g(do)g(a)g(lot)h(of)f
(w)o(ork)f(and)h(then)g(get)g(the)g(responses)f(later)-5
b(.)396 454 y(W)e(e)22 b(need)d(some)h(w)o(ay)g(for)g(a)h(client)f(to)g
(request)g Fi(its)h Fj(replies.)f(W)-7 b(e')o(ll)21 b(ha)n(v)o(e)f(man)
o(y)f(clients)h(asking)g(for)f(the)h(same)396 562 y(services,)g(and)g
(clients)g(disappear)f(and)h(reappear)e(with)j(dif)n(ferent)d
(identities.)i(So)h(here)e(is)i(a)g(simple,)f(reasonably)396
670 y(secure)g(solution:)-2 671 y
SDict begin H.S end
 -2 671 a -2 671 a
SDict begin 13 H.A end
 -2
671 a -2 671 a
SDict begin [/View [/XYZ H.V]/Dest (0:2349) cvn /DEST pdfmark end
 -2 671 a -2 681 a
SDict begin H.S end
 -2 681 a -2 681 a
SDict begin 13 H.A end
 -2
681 a -2 681 a
SDict begin [/View [/XYZ H.V]/Dest (0:2350) cvn /DEST pdfmark end
 -2 681 a Black 396 840 a Fe(\225)p Black
479 840 a
SDict begin H.S end
 479 840 a 479 840 a
SDict begin 13 H.A end
 479 840 a 479 840 a
SDict begin [/View [/XYZ H.V]/Dest (0:2351) cvn /DEST pdfmark end
 479
840 a Fj(Ev)o(ery)f(request)h(generates)f(a)h(uni)n(v)o(ersally)f
(unique)g(ID)h(\(UUID\),)f(which)h(T)m(itanic)g(returns)f(to)i(the)f
(client)g(when)g(it')-5 b(s)479 948 y(queued)19 b(the)h(request.)-2
966 y
SDict begin H.S end
 -2 966 a -2 966 a
SDict begin 13 H.A end
 -2 966 a -2 966 a
SDict begin [/View [/XYZ H.V]/Dest (0:2352) cvn /DEST pdfmark end
 -2 966 a Black
396 1098 a Fe(\225)p Black 479 1098 a
SDict begin H.S end
 479 1098 a 479
1098 a
SDict begin 13 H.A end
 479 1098 a 479 1098 a
SDict begin [/View [/XYZ H.V]/Dest (0:2353) cvn /DEST pdfmark end
 479 1098 a Fj(When)g(a)h(client)f(asks)h
(for)e(a)i(reply)-5 b(,)19 b(it)i(must)f(specify)f(the)i(UUID)f(for)f
(the)i(original)e(request.)-2 1282 y
SDict begin H.S end
 -2 1282 a -2 1282
a
SDict begin 13 H.A end
 -2 1282 a -2 1282 a
SDict begin [/View [/XYZ H.V]/Dest (0:2354) cvn /DEST pdfmark end
 -2 1282 a 396 1372 a Fj(This)i(puts)f(some)g
(onus)f(on)h(the)g(client)h(to)f(store)g(its)h(request)f(UUIDs)g
(safely)-5 b(,)20 b(b)n(ut)g(it)h(remo)o(v)o(es)d(an)o(y)i(need)f(for)
396 1480 y(authentication.)f(What)j(alternati)n(v)o(es)e(are)h(there?)
-2 1647 y
SDict begin H.S end
 -2 1647 a -2 1647 a
SDict begin 13 H.A end
 -2 1647 a -2 1647 a
SDict begin [/View [/XYZ H.V]/Dest (0:2355) cvn /DEST pdfmark end
 -2
1647 a 396 1754 a Fj(Before)g(we)g(jump)g(of)n(f)f(and)h(write)g(yet)h
(another)d(formal)h(speci\002cation)h(\(fun,)f(fun!\))f(let')-5
b(s)22 b(consider)d(ho)n(w)g(the)h(client)396 1862 y(talks)h(to)f(T)m
(itanic.)g(One)g(w)o(ay)g(is)h(to)g(use)f(a)h(single)f(service)g(and)f
(send)h(it)h(three)f(dif)n(ferent)e(request)i(types.)g(Another)f(w)o
(ay)-5 b(,)396 1970 y(which)20 b(seems)h(simpler)m(,)e(is)i(to)f(use)h
(three)e(services:)-2 1988 y
SDict begin H.S end
 -2 1988 a -2 1988 a
SDict begin 13 H.A end
 -2 1988
a -2 1988 a
SDict begin [/View [/XYZ H.V]/Dest (0:2356) cvn /DEST pdfmark end
 -2 1988 a -2 1998 a
SDict begin H.S end
 -2 1998 a -2 1998 a
SDict begin 13 H.A end
 -2
1998 a -2 1998 a
SDict begin [/View [/XYZ H.V]/Dest (0:2357) cvn /DEST pdfmark end
 -2 1998 a Black 396 2140 a Fe(\225)p
Black 479 2140 a
SDict begin H.S end
 479 2140 a 479 2140 a
SDict begin 13 H.A end
 479 2140 a 479
2140 a
SDict begin [/View [/XYZ H.V]/Dest (0:2358) cvn /DEST pdfmark end
 479 2140 a 479 2140 a
SDict begin H.S end
 479 2140 a 479 2140 a
SDict begin 13 H.A end
 479
2140 a 479 2140 a
SDict begin [/View [/XYZ H.V]/Dest (0:2359) cvn /DEST pdfmark end
 479 2140 a Fk(titanic.r)o(equest)g
Fj(-)i(store)f(a)g(request)g(message,)g(return)f(a)h(UUID)g(for)g(the)g
(request.)-2 2158 y
SDict begin H.S end
 -2 2158 a -2 2158 a
SDict begin 13 H.A end
 -2 2158 a -2
2158 a
SDict begin [/View [/XYZ H.V]/Dest (0:2360) cvn /DEST pdfmark end
 -2 2158 a Black 396 2289 a Fe(\225)p Black 479
2289 a
SDict begin H.S end
 479 2289 a 479 2289 a
SDict begin 13 H.A end
 479 2289 a 479 2289 a
SDict begin [/View [/XYZ H.V]/Dest (0:2361) cvn /DEST pdfmark end
 479
2289 a 479 2289 a
SDict begin H.S end
 479 2289 a 479 2289 a
SDict begin 13 H.A end
 479 2289 a 479
2289 a
SDict begin [/View [/XYZ H.V]/Dest (0:2362) cvn /DEST pdfmark end
 479 2289 a Fk(titanic.r)o(eply)f Fj(-)h(fetch)g(a)g(reply)-5
b(,)19 b(if)i(a)n(v)n(ailable,)e(for)h(a)g(gi)n(v)o(en)f(request)h
(UUID.)-2 2307 y
SDict begin H.S end
 -2 2307 a -2 2307 a
SDict begin 13 H.A end
 -2 2307 a -2 2307
a
SDict begin [/View [/XYZ H.V]/Dest (0:2363) cvn /DEST pdfmark end
 -2 2307 a Black 396 2439 a Fe(\225)p Black 479 2439
a
SDict begin H.S end
 479 2439 a 479 2439 a
SDict begin 13 H.A end
 479 2439 a 479 2439 a
SDict begin [/View [/XYZ H.V]/Dest (0:2364) cvn /DEST pdfmark end
 479 2439
a 479 2439 a
SDict begin H.S end
 479 2439 a 479 2439 a
SDict begin 13 H.A end
 479 2439 a 479 2439
a
SDict begin [/View [/XYZ H.V]/Dest (0:2365) cvn /DEST pdfmark end
 479 2439 a Fk(titanic.close)f Fj(-)i(con\002rm)e(that)h(a)h(reply)e
(has)i(been)e(stored)h(and)f(processed.)-2 2623 y
SDict begin H.S end
 -2
2623 a -2 2623 a
SDict begin 13 H.A end
 -2 2623 a -2 2623 a
SDict begin [/View [/XYZ H.V]/Dest (0:2366) cvn /DEST pdfmark end
 -2 2623 a 396 2713
a Fj(W)-7 b(e')o(ll)22 b(just)e(mak)o(e)g(a)h(multithreaded)d(w)o(ork)o
(er)m(,)g(which)i(as)h(we')l(v)o(e)e(seen)h(from)f(our)h
(multithreading)e(e)o(xperience)g(with)396 2821 y(\330MQ,)i(is)i(tri)n
(vial.)d(Ho)n(we)n(v)o(er)g(before)g(jumping)f(into)i(code)g(let')-5
b(s)21 b(sk)o(etch)f(do)n(wn)f(what)h(T)m(itanic)g(w)o(ould)g(look)f
(lik)o(e)i(in)396 2928 y(terms)f(of)g(\330MQ)h(messages)f(and)g
(frames:)g(http://rfc.zeromq.or)o(g/spec)o(:9.)14 b(This)21
b(is)g(the)f("T)m(itanic)g(Service)g(Protocol",)396 3036
y(or)g(TSP)-9 b(.)-2 3203 y
SDict begin H.S end
 -2 3203 a -2 3203 a
SDict begin 13 H.A end
 -2 3203
a -2 3203 a
SDict begin [/View [/XYZ H.V]/Dest (0:2367) cvn /DEST pdfmark end
 -2 3203 a 396 3310 a Fj(Using)20 b(TSP)h(is)g(clearly)f
(more)f(w)o(ork)h(for)f(client)i(applications)e(than)g(accessing)h(a)h
(service)f(directly)f(via)h(MDP)-9 b(.)21 b(Here')-5
b(s)396 3418 y(the)20 b(shortest)h(rob)n(ust)e('echo')g(client)h(e)o
(xample:)-2 3436 y
SDict begin H.S end
 -2 3436 a -2 3436 a
SDict begin 13 H.A end
 -2 3436 a -2 3436
a
SDict begin [/View [/XYZ H.V]/Dest (0:ticlient-php) cvn /DEST pdfmark
end
 -2 3436 a 396 3620 a Fk(Example)h(4-16.)d(T)o(itanic)i(client)h
(example)f(\(ticlient.php\))-2 3719 y
SDict begin H.S end
 -2 3719 a -2 3719
a
SDict begin 11.7 H.A end
 -2 3719 a -2 3719 a
SDict begin [/View [/XYZ H.V]/Dest (0:2370) cvn /DEST pdfmark end
 -2 3719 a 396 3800 a Fg(<?php)396
3897 y(/)441 3910 y(*)531 3897 y(Titanic)43 b(client)h(example)441
4007 y(*)531 3994 y(Implements)f(client)h(side)g(of)g
(http://rfc.zeromq.org/spec:9)441 4104 y(*)531 4091 y(@author)f(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
4201 y(*)486 4188 y(/)396 4285 y(include_once)f("mdcliapi.php";)396
4480 y(/)441 4493 y(**)441 4590 y(*)531 4577 y(Calls)h(a)g(TSP)h
(service)441 4687 y(*)531 4674 y(Returns)e(response)h(if)g(successful)g
(\(status)f(code)h(200)h(OK\),)f(else)g(NULL)441 4784
y(*)441 4881 y(*)531 4868 y(@param)g(string)f($session)441
4978 y(*)531 4965 y(@param)h(string)f($service)441 5076
y(*)531 5063 y(@param)h(Zmsg)g($request)441 5173 y(*)486
5160 y(/)p Black 3759 5569 a Fi(202)p Black eop end
%%Page: 203 217
TeXDict begin 203 216 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.203) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fg(function)44 b(s_service_call\($session,)d
($service,)i($request\))g({)576 170 y($reply)g(=)i
($session->send\($service,)c($request\);)576 267 y(if\($reply\))i({)755
364 y($status)h(=)g($reply->pop\(\);)755 461 y(if\($status)f(==)i
("200"\))e({)934 558 y(return)h($reply;)755 655 y(})h(else)f
(if\($status)f(==)h("404"\))g({)934 752 y(echo)g("E:)h(client)f(fatal)g
(error,)f(aborting",)h(PHP_EOL;)934 850 y(exit\(1\);)755
947 y(})h(else)f(if\($status)f(==)h("500"\))g({)934 1044
y(echo)g("E:)h(server)f(fatal)g(error,)f(aborting",)h(PHP_EOL;)934
1141 y(exit\(1\);)755 1238 y(})576 1335 y(})g(else)g({)755
1432 y(exit\(0\);)576 1530 y(})576 1724 y(return)f(NULL;)h(//)90
b(Didn't)44 b(succeed,)f(don't)h(care)g(why)h(not)396
1821 y(})396 2015 y($verbose)f(=)g($_SERVER['argc'])f(>)h(1)h(&&)f
($_SERVER['argv'][1])e(==)j('-v';)396 2112 y($session)f(=)g(new)h
(Mdcli\("tcp://localhost:5555",)40 b($verbose\);)396
2307 y(//)90 b(1.)44 b(Send)g('echo')g(request)g(to)g(Titanic)396
2404 y($request)g(=)g(new)h(Zmsg\(\);)396 2501 y
($request->push\("Hello)d(world"\);)396 2598 y
($request->push\("echo"\);)396 2695 y($reply)i(=)h
(s_service_call\($session,)c("titanic.request",)g($request\);)396
2889 y($uuid)j(=)h(null;)396 2987 y(if\($reply\))e({)576
3084 y($uuid)h(=)g($reply->pop\(\);)576 3181 y(printf\("I:)f(request)g
(UUID)i(\045s)f(\045s",)g($uuid,)g(PHP_EOL\);)396 3278
y(})396 3472 y(//)90 b(2.)44 b(Wait)g(until)g(we)h(get)f(a)h(reply)396
3569 y(while\(true\))e({)576 3666 y(usleep\(100000\);)576
3764 y($request)g(=)i(new)f(Zmsg\(\);)576 3861 y
($request->push\($uuid\);)576 3958 y($reply)f(=)i(s_service_call)e
(\($session,)g("titanic.reply",)f($request\);)576 4152
y(if\($reply\))h({)755 4249 y($reply_string)g(=)h($reply->last\(\);)755
4346 y(printf)g(\("Reply:)f(\045s)i(\045s",)f($reply_string,)e
(PHP_EOL\);)755 4541 y(//)89 b(3.)45 b(Close)f(request)755
4638 y($request)f(=)i(new)f(Zmsg\(\);)755 4735 y
($request->push\($uuid\);)755 4832 y($reply)g(=)g(s_service_call)f
(\($session,)g("titanic.close",)f($request\);)755 4929
y(break;)576 5026 y(})i(else)g({)755 5124 y(echo)g("I:)g(no)h(reply)f
(yet,)g(trying)g(again...",)f(PHP_EOL;)p Black 3759 5569
a Fi(203)p Black eop end
%%Page: 204 218
TeXDict begin 204 217 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.204) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 755 72 a Fg(usleep)44 b(\(5000000\);)222
b(//)90 b(Try)44 b(again)g(in)g(5)h(seconds)576 170 y(})396
267 y(})-2 441 y
SDict begin H.S end
 -2 441 a -2 441 a
SDict begin 13 H.A end
 -2 441 a -2 441 a
SDict begin [/View [/XYZ H.V]/Dest (0:2371) cvn /DEST pdfmark end

-2 441 a 396 541 a Fj(Of)21 b(course)e(this)i(can)f(and)f(in)i
(practice)e(w)o(ould)h(be)g(wrapped)e(up)i(in)h(some)f(kind)f(of)h
(frame)n(w)o(ork.)e(Real)j(application)396 649 y(de)n(v)o(elopers)d
(should)i(ne)n(v)o(er)e(see)j(messaging)e(up)h(close,)g(it')-5
b(s)22 b(a)e(tool)g(for)g(more)f(technically-minded)e(e)o(xperts)i(to)h
(b)n(uild)396 757 y(frame)n(w)o(orks)f(and)g(APIs.)i(If)f(we)g(had)g
(in\002nite)g(time)g(to)h(e)o(xplore)d(this,)j(I')l(d)e(mak)o(e)h(a)h
(TSP)f(API)h(e)o(xample,)d(and)i(bring)f(the)396 865
y(client)h(application)f(back)h(do)n(wn)f(to)h(a)h(fe)n(w)f(lines)h(of)
e(code.)h(But)g(it')-5 b(s)22 b(the)e(same)g(principle)f(as)i(we)g(sa)o
(w)f(for)g(MDP)-9 b(,)20 b(no)396 972 y(need)g(to)g(be)g(repetiti)n(v)o
(e.)-2 1156 y
SDict begin H.S end
 -2 1156 a -2 1156 a
SDict begin 13 H.A end
 -2 1156 a -2 1156 a
SDict begin [/View [/XYZ H.V]/Dest (0:2372) cvn /DEST pdfmark end

-2 1156 a 396 1246 a Fj(Here')-5 b(s)21 b(the)f(T)m(itanic)g
(implementation.)e(This)i(serv)o(er)f(handles)h(the)g(three)g(services)
g(using)g(three)f(threads,)g(as)396 1354 y(proposed.)f(It)j(does)f
(full)g(persistence)f(to)i(disk)f(using)f(the)i(most)f(brute-force)d
(approach)h(possible:)i(one)g(\002le)h(per)396 1462 y(message.)f(It')-5
b(s)21 b(so)f(simple)h(it')-5 b(s)21 b(scary)-5 b(,)19
b(the)h(only)g(comple)o(x)e(part)i(is)h(that)f(it)h(k)o(eeps)f(a)h
(separate)f('queue')e(of)i(all)h(requests)396 1570 y(to)g(a)n(v)n(oid)f
(reading)e(the)i(directory)f(o)o(v)o(er)g(and)g(o)o(v)o(er:)-2
1588 y
SDict begin H.S end
 -2 1588 a -2 1588 a
SDict begin 13 H.A end
 -2 1588 a -2 1588 a
SDict begin [/View [/XYZ H.V]/Dest (0:titanic-php) cvn /DEST pdfmark
end
 -2 1588
a 396 1772 a Fk(Example)i(4-17.)d(T)o(itanic)i(br)o(ok)o(er)g(example)g
(\(titanic.php\))-2 1871 y
SDict begin H.S end
 -2 1871 a -2 1871 a
SDict begin 11.7 H.A end
 -2 1871
a -2 1871 a
SDict begin [/View [/XYZ H.V]/Dest (0:2375) cvn /DEST pdfmark end
 -2 1871 a 396 1952 a Fg(<?php)396 2049 y(/)441
2062 y(*)441 2159 y(*)531 2146 y(Titanic)43 b(service)441
2256 y(*)441 2353 y(*)531 2340 y(Implements)g(server)h(side)g(of)g
(http://rfc.zeromq.org/spec:9)441 2450 y(*)531 2437 y(@author)f(Ian)i
(Barber)f(<ian\(dot\)barber\(at\)gmail\(dot\)com>)441
2547 y(*)486 2534 y(/)396 2729 y(include_once)f("mdwrkapi.php";)396
2826 y(include_once)g("mdcliapi.php";)396 3020 y(/)441
3033 y(*)576 3020 y(Return)g(a)i(new)f(UUID)h(as)f(a)h(printable)e
(character)g(string)2817 3033 y(*)2862 3020 y(/)396 3117
y(function)h(s_generate_uuid\(\))e({)576 3214 y($uuid)i(=)g
(sprintf\('\04504x\04504x\04504x\04503x4\04504x\04504x\04504x\04504)o
(x',)755 3312 y(mt_rand\(0,)f(65535\),)h(mt_rand\(0,)f(65535\),)h(//)g
(32)h(bits)f(for)g("time_low")755 3409 y(mt_rand\(0,)f(65535\),)h(//)g
(16)h(bits)f(for)g("time_mid")755 3506 y(mt_rand\(0,)f(4095\),)89
b(//)44 b(12)h(bits)f(before)g(the)g(0100)g(of)h(\(version\))e(4)i(for)
f("time_hi_and_version")755 3603 y
(bindec\(substr_replace\(sprintf\('\045016b',)38 b(mt_rand\(0,)44
b(65535\)\),)f('01',)h(6,)g(2\)\),)934 3700 y(//)h(8)f(bits,)g(the)h
(last)f(two)g(of)h(which)f(\(positions)f(6)i(and)f(7\))g(are)h(01,)f
(for)g("clk_seq_hi_res")934 3797 y(//)h(\(hence,)e(the)i(2nd)f(hex)g
(digit)g(after)g(the)h(3rd)f(hyphen)g(can)g(only)g(be)h(1,)f(5,)h(9)f
(or)h(d\))934 3894 y(//)g(8)f(bits)h(for)f("clk_seq_low")755
3992 y(mt_rand\(0,)f(65535\),)h(mt_rand\(0,)f(65535\),)h(mt_rand\(0,)f
(65535\))h(//)g(48)g(bits)h(for)f("node")576 4089 y(\);)576
4186 y(return)f($uuid;)396 4283 y(})396 4477 y(define\("TITANIC_DIR",)f
(".titanic"\);)396 4671 y(/)441 4684 y(**)441 4782 y(*)531
4769 y(Returns)h(freshly)h(allocated)f(request)h(filename)g(for)g
(given)g(UUID)441 4879 y(*)486 4866 y(/)396 4963 y(function)g
(s_request_filename\($uuid\))c({)576 5060 y(return)j(TITANIC_DIR)g(.)i
("/")f(.)h($uuid)f(.)h(".req";)396 5157 y(})p Black 3759
5569 a Fi(204)p Black eop end
%%Page: 205 219
TeXDict begin 205 218 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.205) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 267 a Fg(/)441 280 y(**)441 377
y(*)531 364 y(Returns)43 b(freshly)h(allocated)f(reply)h(filename)g
(for)g(given)g(UUID)441 474 y(*)486 461 y(/)396 558 y(function)g
(s_reply_filename\($uuid\))d({)576 655 y(return)i(TITANIC_DIR)g(.)i
("/")f(.)h($uuid)f(.)h(".rep";)396 752 y(})396 1044 y(/)441
1057 y(**)441 1154 y(*)531 1141 y(Titanic)e(request)h(service)441
1251 y(*)486 1238 y(/)396 1335 y(function)g(titanic_request\($pipe\))d
({)576 1432 y($worker)i(=)i(new)f(Mdwrk\("tcp://localhost:5555",)c
("titanic.request"\);)576 1530 y($reply)j(=)i(null;)576
1724 y(while\(true\))e({)755 1821 y(//)89 b(Get)45 b(next)f(request)f
(from)i(broker)755 1918 y($request)e(=)i($worker->recv\($reply\);)755
2112 y(//)89 b(Ensure)44 b(message)g(directory)f(exists)755
2209 y(if\(!is_dir\(TITANIC_DIR\)\))e({)934 2307 y
(mkdir\(TITANIC_DIR\);)755 2404 y(})755 2598 y(//)89
b(Generate)44 b(UUID)g(and)g(save)g(message)g(to)h(disk)755
2695 y($uuid)f(=)h(s_generate_uuid\(\);)755 2792 y($filename)e(=)i
(s_request_filename\($uuid\);)755 2987 y($fh)f(=)h(fopen\($filename,)d
("w"\);)755 3084 y($request->save\($fh\);)755 3181 y(fclose\($fh\);)755
3375 y(//)89 b(Send)44 b(UUID)h(through)e(to)i(message)e(queue)755
3472 y($reply)h(=)g(new)h(Zmsg\($pipe\);)755 3569 y
($reply->push\($uuid\);)755 3666 y($reply->send\(\);)755
3861 y(//)89 b(Now)45 b(send)f(UUID)g(back)g(to)h(client)755
3958 y(//)f(-)h(sent)f(in)h(the)f(next)g(loop)g(iteration)755
4055 y($reply)g(=)g(new)h(Zmsg\(\);)755 4152 y($reply->push\($uuid\);)
755 4249 y($reply->push\("200"\);)576 4346 y(})396 4444
y(})396 4638 y(/)441 4651 y(**)441 4748 y(*)531 4735
y(Titanic)e(reply)h(service)441 4845 y(*)486 4832 y(/)396
4929 y(function)g(titanic_reply\(\))e({)576 5026 y($worker)h(=)i(new)f
(Mdwrk\()g("tcp://localhost:5555",)d("titanic.reply",)h(false\);)576
5124 y($reply)h(=)i(null;)p Black 3759 5569 a Fi(205)p
Black eop end
%%Page: 206 220
TeXDict begin 206 219 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.206) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 170 a Fg(while\(true\))43 b({)755
267 y($request)g(=)i($worker->recv\($reply\);)755 461
y($uuid)f(=)h($request->pop\(\);)755 558 y($req_filename)e(=)h
(s_request_filename\($uuid\);)755 655 y($rep_filename)f(=)h
(s_reply_filename\($uuid\);)755 850 y
(if\(file_exists\($rep_filename\)\))c({)934 947 y($fh)45
b(=)f(fopen\($rep_filename,)e("r"\);)934 1044 y(assert\($fh\);)934
1141 y($reply)i(=)h(new)f(Zmsg\(\);)934 1238 y($reply->load\($fh\);)934
1335 y($reply->push\("200"\);)934 1432 y(fclose\($fh\);)755
1530 y(})h(else)f({)934 1627 y($reply)g(=)h(new)f(Zmsg\(\);)934
1724 y(if\(file_exists\($req_filename\)\))c({)1114 1821
y($reply->push\("300"\);)h(//)k(Pending)934 1918 y(})g(else)f({)1114
2015 y($reply->push\("400"\);)d(//)k(Unknown)934 2112
y(})755 2209 y(})576 2307 y(})396 2404 y(})396 2598 y(/)441
2611 y(**)441 2708 y(*)531 2695 y(Titanic)e(close)h(service)441
2805 y(*)486 2792 y(/)396 2889 y(function)g(titanic_close\(\))e({)576
2987 y($worker)h(=)i(new)f(Mdwrk\("tcp://localhost:5555",)c
("titanic.close",)i(false\);)576 3084 y($reply)h(=)i(null;)576
3278 y(while\(true\))e({)755 3375 y($request)g(=)i
($worker->recv\($reply\);)755 3569 y($uuid)f(=)h($request->pop\(\);)755
3666 y($req_filename)e(=)h(s_request_filename\($uuid\);)755
3764 y($rep_filename)f(=)h(s_reply_filename\($uuid\);)755
3958 y(unlink\($req_filename\);)755 4055 y(unlink\($rep_filename\);)755
4249 y($reply)g(=)g(new)h(Zmsg\(\);)755 4346 y($reply->push\("200"\);)
576 4444 y(})396 4541 y(})396 4735 y(/)441 4748 y(**)441
4845 y(*)531 4832 y(Attempt)e(to)i(process)f(a)g(single)g(request,)g
(return)f(1)i(if)g(successful)441 4942 y(*)441 5039 y(*)531
5026 y(@param)f(Mdcli)g($client)441 5137 y(*)531 5124
y(@param)g(string)f($uuid)p Black 3757 5569 a Fi(206)p
Black eop end
%%Page: 207 221
TeXDict begin 207 220 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.207) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 85 a Fg(*)486 72 y(/)396 170 y(function)44
b(s_service_success\($client,)c($uuid\))k({)576 267 y(//)89
b(Load)44 b(request)g(message,)f(service)h(will)g(be)h(first)f(frame)
576 364 y($filename)f(=)i(s_request_filename\($uuid\);)576
461 y($fh)f(=)h(fopen\($filename,)d("r"\);)576 655 y(//)89
b(If)44 b(the)h(client)f(already)f(closed)h(request,)g(treat)g(as)g
(successful)576 752 y(if\(!$fh\))f({)755 850 y(return)h(true;)576
947 y(})576 1141 y($request)f(=)i(new)f(Zmsg\(\);)576
1238 y($request->load\($fh\);)576 1335 y(fclose\($fh\);)576
1432 y($service)f(=)i($request->pop\(\);)576 1627 y(//)89
b(Use)44 b(MMI)h(protocol)e(to)i(check)f(if)g(service)g(is)g(available)
576 1724 y($mmi_request)e(=)j(new)f(Zmsg\(\);)576 1821
y($mmi_request->push\($service\);)576 1918 y($mmi_reply)f(=)h
($client->send\("mmi.service",)d($mmi_request\);)576
2015 y($service_ok)i(=)h($mmi_reply)f(&&)i($mmi_reply->pop\(\))d(==)i
("200";)576 2209 y(if\($service_ok\))e({)755 2307 y($reply)i(=)g
($client->send\($service,)d($request\);)755 2404 y($filename)i(=)i
(s_reply_filename\($uuid\);)755 2501 y($fh)f(=)h(fopen\($filename,)d
("w"\);)755 2598 y(assert\($fh\);)755 2695 y($reply->save\($fh\);)755
2792 y(fclose\($fh\);)755 2889 y(return)i(true;)576 2987
y(})576 3181 y(return)f(false;)396 3278 y(})396 3472
y($verbose)h(=)g($_SERVER['argc'])f(>)h(1)h(&&)f($_SERVER['argv'][1])e
(==)j('-v';)396 3666 y($pid)f(=)h(pcntl_fork\(\);)396
3764 y(if\($pid)f(==)g(0\))h({)576 3861 y(titanic_reply\(\);)576
3958 y(exit\(\);)396 4055 y(})396 4249 y($pid)f(=)h(pcntl_fork\(\);)396
4346 y(if\($pid)f(==)g(0\))h({)576 4444 y(titanic_close\(\);)576
4541 y(exit\(\);)396 4638 y(})396 4832 y($pid)f(=)h(pcntl_fork\(\);)396
4929 y(if\($pid)f(==)g(0\))h({)576 5026 y($pipe)f(=)g(new)h
(ZMQSocket\(new)d(ZMQContext\(\),)h(ZMQ::SOCKET_PAIR\);)576
5124 y($pipe->connect\("ipc://")e(.)j(sys_get_temp_dir\(\))e(.)j
("/titanicpipe"\);)p Black 3756 5569 a Fi(207)p Black
eop end
%%Page: 208 222
TeXDict begin 208 221 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.208) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 576 72 a Fg(titanic_request\($pipe\);)576
170 y(exit\(\);)396 267 y(})396 558 y(//)90 b(Create)43
b(MDP)i(client)f(session)f(with)h(short)g(timeout)396
655 y($client)g(=)h(new)f(Mdcli\("tcp://localhost:5555",)c($verbose\);)
396 752 y($client->set_timeout\(1000\);)h(//)j(1)h(sec)396
850 y($client->set_retries\(1\);)176 b(//)44 b(only)g(1)h(retry)396
1044 y($request_pipe)e(=)i(new)f(ZMQSocket\(new)f(ZMQContext\(\),)f
(ZMQ::SOCKET_PAIR\);)396 1141 y($request_pipe->bind\("ipc://")e(.)45
b(sys_get_temp_dir\(\))d(.)j("/titanicpipe"\);)396 1238
y($read)f(=)h($write)f(=)g(array\(\);)396 1335 y(//)90
b(Main)44 b(dispatcher)f(loop)396 1432 y(while\(true\))g({)576
1530 y(//)89 b(We'll)44 b(dispatch)f(once)i(per)f(second,)g(if)g
(there's)g(no)g(activity)576 1627 y($poll)g(=)g(new)h(ZMQPoll\(\);)576
1724 y($poll->add\($request_pipe,)40 b(ZMQ::POLL_IN\);)576
1821 y($events)j(=)i($poll->poll\($read,)d($write,)h(1000\);)576
2015 y(if\($events\))g({)755 2112 y(//)89 b(Ensure)44
b(message)g(directory)f(exists)755 2209 y(if\(!is_dir\(TITANIC_DIR\)\))
e({)934 2307 y(mkdir\(TITANIC_DIR\);)755 2404 y(})755
2598 y(//)89 b(Append)44 b(UUID)g(to)h(queue,)f(prefixed)f(with)h('-')h
(for)f(pending)755 2695 y($msg)g(=)h(new)f(Zmsg\($request_pipe\);)755
2792 y($msg->recv\(\);)755 2889 y($fh)g(=)h(fopen\(TITANIC_DIR)d(.)j
("/queue",)e("a"\);)755 2987 y($uuid)h(=)h($msg->pop\(\);)755
3084 y(fprintf\($fh,)e("-\045s\\n",)g($uuid\);)755 3181
y(fclose\($fh\);)576 3278 y(})576 3472 y(//)89 b(Brute-force)43
b(dispatcher)576 3569 y(if\(file_exists\(TITANIC_DIR)d(.)45
b("/queue"\)\))e({)755 3666 y($fh)h(=)h(fopen\(TITANIC_DIR)d(.)j
("/queue",)e("r+"\);)755 3764 y(while\($fh)g(&&)i($entry)88
b(=)45 b(fread\($fh,)e(33\)\))h({)934 3861 y(//)90 b(UUID)44
b(is)g(prefixed)g(with)g('-')g(if)h(still)f(waiting)934
3958 y(if\($entry[0])f(==)i("-"\))f({)1114 4055 y(if\($verbose\))e({)
1293 4152 y(printf)i(\("I:)g(processing)f(request)h(\045s\045s",)g
(substr\($entry,)e(1\),)i(PHP_EOL\);)1114 4249 y(})1114
4346 y(if\(s_service_success\($client,)c(substr\($entry,)i(1\)\)\))i({)
1293 4444 y(//)89 b(Mark)44 b(queue)g(entry)g(as)h(processed)1293
4541 y(fseek\($fh,)e(-33,)h(SEEK_CUR\);)1293 4638 y(fwrite)g(\($fh,)g
("+"\);)1293 4735 y(fseek\($fh,)f(32,)h(SEEK_CUR\);)1114
4832 y(})934 4929 y(})934 5026 y(//)90 b(Skip)44 b(end)g(of)h(line,)f
(LF)g(or)h(CRLF)934 5124 y(if\(fgetc\($fh\))e(==)h("\\r"\))g({)p
Black 3759 5569 a Fi(208)p Black eop end
%%Page: 209 223
TeXDict begin 209 222 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.209) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 1114 72 a Fg(fgetc\($fh\);)934 170
y(})755 267 y(})755 364 y(if\($fh\))44 b({)934 461 y(fclose\($fh\);)755
558 y(})576 655 y(})396 752 y(})-2 1016 y
SDict begin H.S end
 -2 1016 a -2
1016 a
SDict begin 13 H.A end
 -2 1016 a -2 1016 a
SDict begin [/View [/XYZ H.V]/Dest (0:2376) cvn /DEST pdfmark end
 -2 1016 a 396 1124 a Fj(T)-7
b(o)20 b(test)h(this,)f(start)962 1124 y
SDict begin H.S end
 962 1124 a 962
1124 a
SDict begin 13 H.A end
 962 1124 a 962 1124 a
SDict begin [/View [/XYZ H.V]/Dest (0:2377) cvn /DEST pdfmark end
 962 1124 a Fg(mdbroker)f
Fj(and)1481 1124 y
SDict begin H.S end
 1481 1124 a 1481 1124 a
SDict begin 13 H.A end
 1481 1124
a 1481 1124 a
SDict begin [/View [/XYZ H.V]/Dest (0:2378) cvn /DEST pdfmark end
 1481 1124 a Fg(titanic)p Fj(,)g(then)g(run)2130
1124 y
SDict begin H.S end
 2130 1124 a 2130 1124 a
SDict begin 13 H.A end
 2130 1124 a 2130 1124
a
SDict begin [/View [/XYZ H.V]/Dest (0:2379) cvn /DEST pdfmark end
 2130 1124 a Fg(ticlient)p Fj(.)f(No)n(w)i(start)2872
1124 y
SDict begin H.S end
 2872 1124 a 2872 1124 a
SDict begin 13 H.A end
 2872 1124 a 2872 1124
a
SDict begin [/View [/XYZ H.V]/Dest (0:2380) cvn /DEST pdfmark end
 2872 1124 a Fg(mdworker)f Fj(arbitrarily)-5 b(,)18
b(and)h(you)396 1231 y(should)g(see)i(the)f(client)h(getting)e(a)i
(response)e(and)h(e)o(xiting)f(happily)-5 b(.)-2 1415
y
SDict begin H.S end
 -2 1415 a -2 1415 a
SDict begin 13 H.A end
 -2 1415 a -2 1415 a
SDict begin [/View [/XYZ H.V]/Dest (0:2381) cvn /DEST pdfmark end
 -2 1415 a 396
1505 a Fj(Some)20 b(notes)g(about)f(this)i(code:)-2 1506
y
SDict begin H.S end
 -2 1506 a -2 1506 a
SDict begin 13 H.A end
 -2 1506 a -2 1506 a
SDict begin [/View [/XYZ H.V]/Dest (0:2382) cvn /DEST pdfmark end
 -2 1506 a -2
1516 a
SDict begin H.S end
 -2 1516 a -2 1516 a
SDict begin 13 H.A end
 -2 1516 a -2 1516 a
SDict begin [/View [/XYZ H.V]/Dest (0:2383) cvn /DEST pdfmark end
 -2 1516
a Black 396 1676 a Fe(\225)p Black 479 1676 a
SDict begin H.S end
 479 1676
a 479 1676 a
SDict begin 13 H.A end
 479 1676 a 479 1676 a
SDict begin [/View [/XYZ H.V]/Dest (0:2384) cvn /DEST pdfmark end
 479 1676 a Fj(W)-7
b(e)22 b(use)e(MMI)g(to)g(only)g(send)g(requests)g(to)g(services)g
(that)g(appear)f(to)i(be)f(running.)e(This)i(w)o(orks)g(as)h(well)f(as)
h(the)479 1784 y(MMI)f(implementation)e(in)j(the)f(brok)o(er)-5
b(.)-2 1802 y
SDict begin H.S end
 -2 1802 a -2 1802 a
SDict begin 13 H.A end
 -2 1802 a -2 1802 a
SDict begin [/View [/XYZ H.V]/Dest (0:2385) cvn /DEST pdfmark end

-2 1802 a Black 396 1933 a Fe(\225)p Black 479 1933 a
SDict begin H.S end

479 1933 a 479 1933 a
SDict begin 13 H.A end
 479 1933 a 479 1933 a
SDict begin [/View [/XYZ H.V]/Dest (0:2386) cvn /DEST pdfmark end
 479 1933
a Fj(W)e(e)22 b(use)e(an)g(inproc)f(connection)f(to)i(send)g(ne)n(w)g
(request)g(data)g(from)f(the)2596 1933 y
SDict begin H.S end
 2596 1933 a
2596 1933 a
SDict begin 13 H.A end
 2596 1933 a 2596 1933 a
SDict begin [/View [/XYZ H.V]/Dest (0:2387) cvn /DEST pdfmark end
 2596 1933 a Fk(titanic.r)o(equest)g
Fj(service)h(through)e(to)i(the)479 2041 y(main)g(dispatcher)-5
b(.)19 b(This)i(sa)n(v)o(es)f(the)g(dispatcher)f(from)h(ha)n(ving)f(to)
h(scan)g(the)h(disk)f(directory)-5 b(,)18 b(load)h(all)i(request)f
(\002les,)479 2149 y(and)g(sort)g(them)g(by)g(date/time.)-2
2333 y
SDict begin H.S end
 -2 2333 a -2 2333 a
SDict begin 13 H.A end
 -2 2333 a -2 2333 a
SDict begin [/View [/XYZ H.V]/Dest (0:2388) cvn /DEST pdfmark end
 -2 2333
a 396 2423 a Fj(The)g(important)f(thing)g(about)g(this)i(e)o(xample)e
(is)i(not)f(performance)d(\(which)i(is)j(surely)d(terrible,)h(I')l(v)o
(e)f(not)g(tested)i(it\),)396 2531 y(b)n(ut)f(ho)n(w)g(well)h(it)g
(implements)e(the)h(reliability)g(contract.)f(T)-7 b(o)20
b(try)g(it,)h(start)f(the)h(mdbrok)o(er)c(and)j(titanic)g(programs.)396
2639 y(Then)g(start)g(the)h(ticlient,)f(and)f(then)h(start)h(the)f(mdw)
o(ork)o(er)e(echo)i(service.)f(Y)-9 b(ou)20 b(can)g(run)f(all)i(four)e
(of)h(these)h(using)e(the)396 2747 y('-v')g(option)g(to)i(do)f(v)o
(erbose)e(tracing)i(of)f(acti)n(vity)-5 b(.)20 b(Y)-9
b(ou)19 b(can)h(stop)g(and)g(restart)g(an)o(y)g(piece)3019
2747 y
SDict begin H.S end
 3019 2747 a 3019 2747 a
SDict begin 13 H.A end
 3019 2747 a 3019 2747
a
SDict begin [/View [/XYZ H.V]/Dest (0:2389) cvn /DEST pdfmark end
 3019 2747 a Fi(e)n(xcept)i Fj(the)e(client)h(and)396
2855 y(nothing)e(will)i(get)f(lost.)-2 3039 y
SDict begin H.S end
 -2 3039
a -2 3039 a
SDict begin 13 H.A end
 -2 3039 a -2 3039 a
SDict begin [/View [/XYZ H.V]/Dest (0:2390) cvn /DEST pdfmark end
 -2 3039 a 396 3129 a
Fj(If)g(you)g(w)o(ant)g(to)g(use)h(T)m(itanic)f(in)g(real)g(cases,)h
(you')o(ll)e(rapidly)g(be)h(asking)g("ho)n(w)f(do)h(we)h(mak)o(e)e
(this)i(f)o(aster?")f(Here')-5 b(s)396 3236 y(what)20
b(I')l(d)g(do,)f(starting)h(with)h(the)f(e)o(xample)f(implementation:)
-2 3254 y
SDict begin H.S end
 -2 3254 a -2 3254 a
SDict begin 13 H.A end
 -2 3254 a -2 3254 a
SDict begin [/View [/XYZ H.V]/Dest (0:2391) cvn /DEST pdfmark end
 -2
3254 a -2 3264 a
SDict begin H.S end
 -2 3264 a -2 3264 a
SDict begin 13 H.A end
 -2 3264 a -2 3264
a
SDict begin [/View [/XYZ H.V]/Dest (0:2392) cvn /DEST pdfmark end
 -2 3264 a Black 396 3407 a Fe(\225)p Black 479 3407
a
SDict begin H.S end
 479 3407 a 479 3407 a
SDict begin 13 H.A end
 479 3407 a 479 3407 a
SDict begin [/View [/XYZ H.V]/Dest (0:2393) cvn /DEST pdfmark end
 479 3407
a Fj(Use)i(a)g(single)f(disk)g(\002le)h(for)e(all)i(data,)f(rather)f
(than)h(multiple)g(\002les.)h(Operating)d(systems)j(are)f(usually)g
(better)g(at)479 3515 y(handling)f(a)h(fe)n(w)g(lar)o(ge)g(\002les)h
(than)e(man)o(y)g(smaller)i(ones.)-2 3533 y
SDict begin H.S end
 -2 3533 a
-2 3533 a
SDict begin 13 H.A end
 -2 3533 a -2 3533 a
SDict begin [/View [/XYZ H.V]/Dest (0:2394) cvn /DEST pdfmark end
 -2 3533 a Black 396 3664
a Fe(\225)p Black 479 3664 a
SDict begin H.S end
 479 3664 a 479 3664 a
SDict begin 13 H.A end
 479
3664 a 479 3664 a
SDict begin [/View [/XYZ H.V]/Dest (0:2395) cvn /DEST pdfmark end
 479 3664 a Fj(Or)o(ganize)d(that)j(disk)f(\002le)h
(as)g(a)f(circular)g(b)n(uf)n(fer)e(so)j(that)f(ne)n(w)g(requests)g
(can)g(be)g(written)g(contiguously)e(\(with)i(v)o(ery)479
3772 y(occasional)f(wraparound\).)e(One)j(thread,)f(writing)h(full)g
(speed)g(to)g(a)h(disk)f(\002le)h(can)f(w)o(ork)f(rapidly)-5
b(.)-2 3790 y
SDict begin H.S end
 -2 3790 a -2 3790 a
SDict begin 13 H.A end
 -2 3790 a -2 3790 a
SDict begin [/View [/XYZ H.V]/Dest (0:2396) cvn /DEST pdfmark end

-2 3790 a Black 396 3921 a Fe(\225)p Black 479 3921 a
SDict begin H.S end

479 3921 a 479 3921 a
SDict begin 13 H.A end
 479 3921 a 479 3921 a
SDict begin [/View [/XYZ H.V]/Dest (0:2397) cvn /DEST pdfmark end
 479 3921
a Fj(K)n(eep)20 b(the)g(inde)o(x)f(in)i(memory)d(and)i(reb)n(uild)f
(the)h(inde)o(x)f(at)i(startup)f(time,)g(from)f(the)h(disk)g(b)n(uf)n
(fer)-5 b(.)19 b(This)i(sa)n(v)o(es)f(the)479 4029 y(e)o(xtra)f(disk)g
(head)g(\003utter)h(needed)e(to)h(k)o(eep)g(the)h(inde)o(x)e(fully)h
(safe)g(on)g(disk.)h(Y)-9 b(ou)18 b(w)o(ould)h(w)o(ant)h(an)f(fsync)g
(after)g(e)n(v)o(ery)479 4137 y(message,)h(or)g(e)n(v)o(ery)f(N)i
(milliseconds)e(if)h(you)g(were)g(prepared)e(to)i(lose)h(the)f(last)h
(M)g(messages)f(in)g(case)h(of)f(a)h(system)479 4245
y(f)o(ailure.)-2 4246 y
SDict begin H.S end
 -2 4246 a -2 4246 a
SDict begin 13 H.A end
 -2 4246 a
-2 4246 a
SDict begin [/View [/XYZ H.V]/Dest (0:2398) cvn /DEST pdfmark end
 -2 4246 a Black 396 4395 a Fe(\225)p Black
479 4395 a
SDict begin H.S end
 479 4395 a 479 4395 a
SDict begin 13 H.A end
 479 4395 a 479 4395
a
SDict begin [/View [/XYZ H.V]/Dest (0:2399) cvn /DEST pdfmark end
 479 4395 a Fj(Use)g(a)g(solid-state)f(dri)n(v)o(e)f(rather)g(than)h
(spinning)f(iron)g(oxide)g(platters.)-2 4413 y
SDict begin H.S end
 -2 4413
a -2 4413 a
SDict begin 13 H.A end
 -2 4413 a -2 4413 a
SDict begin [/View [/XYZ H.V]/Dest (0:2400) cvn /DEST pdfmark end
 -2 4413 a Black 396 4544
a Fe(\225)p Black 479 4544 a
SDict begin H.S end
 479 4544 a 479 4544 a
SDict begin 13 H.A end
 479
4544 a 479 4544 a
SDict begin [/View [/XYZ H.V]/Dest (0:2401) cvn /DEST pdfmark end
 479 4544 a Fj(Preallocate)h(the)g(entire)g(\002le,)h
(or)e(allocate)h(in)h(lar)o(ge)e(chunks)g(allo)n(wing)g(the)h(circular)
g(b)n(uf)n(fer)e(to)j(gro)n(w)e(and)h(shrink)f(as)479
4652 y(needed.)g(This)h(a)n(v)n(oids)g(fragmentation)e(and)i(ensures)f
(most)i(reads)f(and)f(writes)i(are)f(contiguous.)-2 4836
y
SDict begin H.S end
 -2 4836 a -2 4836 a
SDict begin 13 H.A end
 -2 4836 a -2 4836 a
SDict begin [/View [/XYZ H.V]/Dest (0:2402) cvn /DEST pdfmark end
 -2 4836 a 396
4926 a Fj(And)g(so)h(on.)e(What)i(I')l(d)e(not)h(recommend)e(is)j
(storing)e(messages)h(in)h(a)f(database,)g(not)g(e)n(v)o(en)f(a)h('f)o
(ast')h(k)o(e)o(y/v)n(alue)d(store,)396 5034 y(unless)j(you)e(really)h
(lik)o(e)g(a)h(speci\002c)f(database)g(and)f(don')o(t)g(ha)n(v)o(e)g
(performance)f(w)o(orries.)h(Y)-9 b(ou)20 b(will)h(pay)f(a)g(steep)h
(price)396 5142 y(for)f(the)g(abstraction,)f(10)h(to)g(1000x)e(o)o(v)o
(er)h(a)i(ra)o(w)f(disk)g(\002le.)p Black 3759 5569 a
Fi(209)p Black eop end
%%Page: 210 224
TeXDict begin 210 223 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.210) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2427) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2403) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(If)20 b(you)g(w)o(ant)g(to)g(mak)o
(e)g(T)m(itanic)1337 72 y
SDict begin H.S end
 1337 72 a 1337 72 a
SDict begin 13 H.A end
 1337 72
a 1337 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2404) cvn /DEST pdfmark end
 1337 72 a Fi(e)o(ven)g(mor)m(e)g(r)m(eliable)p
Fj(,)g(you)f(can)h(do)g(this)g(by)g(duplicating)f(requests)g(to)i(a)f
(second)396 180 y(serv)o(er)m(,)f(which)h(you')l(d)e(place)i(in)g(a)h
(second)e(location)g(just)i(f)o(ar)f(enough)e(to)j(survi)n(v)o(e)e
(nuclear)g(attack)h(on)f(your)g(primary)396 288 y(location,)g(yet)h
(not)g(so)h(f)o(ar)f(that)g(you)g(get)g(too)g(much)f(latenc)o(y)-5
b(.)-2 472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end
 -2 472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:2405) cvn /DEST pdfmark end
 -2 472
a 396 562 a Fj(If)20 b(you)g(w)o(ant)g(to)g(mak)o(e)g(T)m(itanic)1337
562 y
SDict begin H.S end
 1337 562 a 1337 562 a
SDict begin 13 H.A end
 1337 562 a 1337 562 a
SDict begin [/View [/XYZ H.V]/Dest (0:2406) cvn /DEST pdfmark end
 1337
562 a Fi(muc)o(h)f(faster)i(and)f(less)h(r)m(eliable)p
Fj(,)f(you)f(can)h(store)g(requests)g(and)f(replies)i(purely)d(in)396
670 y(memory)-5 b(.)18 b(This)i(will)h(gi)n(v)o(e)f(you)f(the)h
(functionality)e(of)i(a)h(disconnected)d(netw)o(ork,)h(b)n(ut)h(it)h(w)
o(on')o(t)e(survi)n(v)o(e)g(a)i(crash)e(of)396 778 y(the)h(T)m(itanic)h
(serv)o(er)e(itself.)-2 789 y
SDict begin H.S end
 -2 789 a -2 789 a
SDict begin 13 H.A end
 -2 789
a -2 789 a
SDict begin [/View [/XYZ H.V]/Dest (0:2407) cvn /DEST pdfmark end
 -2 789 a 377 x Fh(4.13.)39 b(High-a)n(v)m(ailability)d(P)l
(air)i(\(Binar)q(y)h(Star)g(P)l(attern\))3193 1166 y
SDict begin H.S end

3193 1166 a 3193 1166 a
SDict begin 22.464 H.A end
 3193 1166 a 3193 1166 a
SDict begin [/View [/XYZ H.V]/Dest (9.52.1) cvn /DEST pdfmark end
 3193
1166 a -2 1198 a
SDict begin H.S end
 -2 1198 a -2 1198 a
SDict begin 13 H.A end
 -2 1198 a -2 1198
a
SDict begin [/View [/XYZ H.V]/Dest (0:2409) cvn /DEST pdfmark end
 -2 1198 a 396 1494 a Fd(4.13.1.)d(Over)q(vie)n(w)1324
1494 y
SDict begin H.S end
 1324 1494 a 1324 1494 a
SDict begin 18.72 H.A end
 1324 1494 a 1324 1494
a
SDict begin [/View [/XYZ H.V]/Dest (9.52.25.2) cvn /DEST pdfmark end
 1324 1494 a -2 1661 a
SDict begin H.S end
 -2 1661 a -2 1661 a
SDict begin 13 H.A end
 -2 1661 a
-2 1661 a
SDict begin [/View [/XYZ H.V]/Dest (0:2411) cvn /DEST pdfmark end
 -2 1661 a 396 1768 a Fj(The)20 b(Binary)g(Star)g(pattern)g
(puts)g(tw)o(o)g(serv)o(ers)g(in)g(a)h(primary-backup)16
b(high-a)n(v)n(ailability)i(pair\()p 0 TeXcolorgray 3175
1768 a
SDict begin H.S end
 3175 1768 a Fj(Figure)g(4-6)3523 1768 y
SDict begin 13 H.L end
 3523 1768
a 3523 1768 a
SDict begin [/Subtype /Link/Dest (0:figure-58) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3523 1768 a Black -1 w Fj(\).)i(At)h(an)o(y)396
1876 y(gi)n(v)o(en)e(time,)g(one)g(of)h(these)g(accepts)f(connections)f
(from)h(client)h(applications)e(\(it)i(is)h(the)e("master"\))g(and)h
(one)f(does)g(not)396 1984 y(\(it)i(is)g(the)f("sla)n(v)o(e"\).)g(Each)
f(serv)o(er)h(monitors)f(the)h(other)-5 b(.)20 b(If)g(the)g(master)g
(disappears)f(from)g(the)h(netw)o(ork,)f(after)h(a)396
2092 y(certain)g(time)g(the)g(sla)n(v)o(e)h(tak)o(es)f(o)o(v)o(er)f(as)
i(master)-5 b(.)-2 2258 y
SDict begin H.S end
 -2 2258 a -2 2258 a
SDict begin 13 H.A end
 -2 2258
a -2 2258 a
SDict begin [/View [/XYZ H.V]/Dest (0:2413) cvn /DEST pdfmark end
 -2 2258 a 396 2365 a Fj(Binary)20 b(Star)h(pattern)e(w)o
(as)i(de)n(v)o(eloped)c(by)j(Pieter)h(Hintjens)f(and)f(Martin)h
(Sustrik)g(for)g(the)g(iMatix)3302 2365 y
SDict begin H.S end
 3302 2365 a
3302 2365 a
SDict begin 13 H.A end
 3302 2365 a 3302 2365 a
SDict begin [/View [/XYZ H.V]/Dest (0:2414) cvn /DEST pdfmark end
 3302 2365 a Fj(OpenAMQ)396
2473 y(serv)o(er)g(\(http://www)-5 b(.openamq.or)o(g)o(\).)14
b(W)-7 b(e)22 b(designed)d(it:)-2 2491 y
SDict begin H.S end
 -2 2491 a -2
2491 a
SDict begin 13 H.A end
 -2 2491 a -2 2491 a
SDict begin [/View [/XYZ H.V]/Dest (0:2415) cvn /DEST pdfmark end
 -2 2491 a -2 2501 a
SDict begin H.S end
 -2 2501
a -2 2501 a
SDict begin 13 H.A end
 -2 2501 a -2 2501 a
SDict begin [/View [/XYZ H.V]/Dest (0:2416) cvn /DEST pdfmark end
 -2 2501 a Black 396 2644
a Fe(\225)p Black 479 2644 a
SDict begin H.S end
 479 2644 a 479 2644 a
SDict begin 13 H.A end
 479
2644 a 479 2644 a
SDict begin [/View [/XYZ H.V]/Dest (0:2417) cvn /DEST pdfmark end
 479 2644 a Fj(T)-7 b(o)21 b(pro)o(vide)d(a)i
(straight-forw)o(ard)e(high-a)n(v)n(ailability)g(solution.)-2
2662 y
SDict begin H.S end
 -2 2662 a -2 2662 a
SDict begin 13 H.A end
 -2 2662 a -2 2662 a
SDict begin [/View [/XYZ H.V]/Dest (0:2418) cvn /DEST pdfmark end
 -2 2662
a Black 396 2793 a Fe(\225)p Black 479 2793 a
SDict begin H.S end
 479 2793
a 479 2793 a
SDict begin 13 H.A end
 479 2793 a 479 2793 a
SDict begin [/View [/XYZ H.V]/Dest (0:2419) cvn /DEST pdfmark end
 479 2793 a Fj(T)-7
b(o)21 b(be)f(simple)g(enough)e(to)i(actually)g(understand)e(and)i
(use.)-2 2811 y
SDict begin H.S end
 -2 2811 a -2 2811 a
SDict begin 13 H.A end
 -2 2811 a -2 2811
a
SDict begin [/View [/XYZ H.V]/Dest (0:2420) cvn /DEST pdfmark end
 -2 2811 a Black 396 2942 a Fe(\225)p Black 479 2942
a
SDict begin H.S end
 479 2942 a 479 2942 a
SDict begin 13 H.A end
 479 2942 a 479 2942 a
SDict begin [/View [/XYZ H.V]/Dest (0:2421) cvn /DEST pdfmark end
 479 2942
a Fj(T)-7 b(o)21 b(f)o(ail-o)o(v)o(er)d(reliably)h(when)h(needed,)f
(and)g(only)h(when)f(needed.)-2 2960 y
SDict begin H.S end
 -2 2960 a -2 2960
a
SDict begin 13 H.A end
 -2 2960 a -2 2960 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-58) cvn /DEST pdfmark
end
 -2 2960 a Black 3759 5569 a Fi(210)p
Black eop end
%%Page: 211 225
TeXDict begin 211 224 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.211) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2441) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-6.)f(High-a)n(v)o
(ailability)e(P)o(air)-8 b(,)21 b(Normal)f(Operation)-2
172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2424) cvn /DEST pdfmark end
 -2 172 a 396
2272 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2272 a @beginspecial 0 @llx -247 @lly 423
@urx 0 @ury 4230 @rwi @setspecial
%%BeginDocument: images/fig58.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -247 423 0
%%HiResBoundingBox: 0.0 -247.0 423.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -34.70027160644531 moveto
24.70026969909668 -99.70027160644531 lineto
141.7002716064453 -99.70027160644531 lineto
141.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
285.70025634765625 -34.70027160644531 moveto
285.70025634765625 -99.70027160644531 lineto
402.70025634765625 -99.70027160644531 lineto
402.70025634765625 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -164.7002716064453 moveto
24.70026969909668 -216.7002716064453 lineto
141.7002716064453 -216.7002716064453 lineto
141.7002716064453 -164.7002716064453 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -32.0 moveto
22.0 -97.0 lineto
139.0 -97.0 lineto
139.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
22.0 -32.0 moveto
22.0 -97.0 lineto
139.0 -97.0 lineto
139.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
283.0 -32.0 moveto
283.0 -97.0 lineto
400.0 -97.0 lineto
400.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
283.0 -32.0 moveto
283.0 -97.0 lineto
400.0 -97.0 lineto
400.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -162.0 moveto
22.0 -214.0 lineto
139.0 -214.0 lineto
139.0 -162.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
22.0 -162.0 moveto
22.0 -214.0 lineto
139.0 -214.0 lineto
139.0 -162.0 lineto
closepath
stroke
newpath
148.0 -58.0 moveto
274.0 -58.0 lineto
stroke
newpath
76.0 -110.0 moveto
76.0 -162.0 lineto
stroke
newpath
153.0 -52.0 moveto
144.0 -58.0 lineto
153.0 -65.0 lineto
closepath
fill
newpath
270.0 -52.0 moveto
279.0 -58.0 lineto
270.0 -65.0 lineto
closepath
fill
newpath
76.0 -104.0 moveto
72.0 -117.0 lineto
81.0 -117.0 lineto
closepath
fill
/Helvetica findfont
14 scalefont setfont
45.0 -64.0 moveto
(Primary) show
45.0 -77.0 moveto
("master") show
315.0 -63.0 moveto
(Backup) show
315.0 -77.0 moveto
("slave") show
59.0 -194.0 moveto
(Client) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2272 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2272 a 274 x Fj(Assuming)g(we)g(ha)n(v)o(e)
g(a)h(Binary)e(Star)i(pair)f(running,)d(here)j(are)g(the)g(dif)n
(ferent)f(scenarios)h(that)g(will)h(result)f(in)g(f)o(ail-o)o(v)o(er)
396 2654 y(happening\()p 0 TeXcolorgray 773 2654 a
SDict begin H.S end
 773
2654 a Fj(Figure)c(4-7)1119 2654 y
SDict begin 13 H.L end
 1119 2654 a 1119 2654
a
SDict begin [/Subtype /Link/Dest (0:figure-59) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1119 2654 a Black -1 w Fj(\):)-2 2672 y
SDict begin H.S end
 -2 2672 a -2
2672 a
SDict begin 13 H.A end
 -2 2672 a -2 2672 a
SDict begin [/View [/XYZ H.V]/Dest (0:2429) cvn /DEST pdfmark end
 -2 2672 a -2 2682 a
SDict begin H.S end
 -2 2682
a -2 2682 a
SDict begin 13 H.A end
 -2 2682 a -2 2682 a
SDict begin [/View [/XYZ H.V]/Dest (0:2430) cvn /DEST pdfmark end
 -2 2682 a Black 463 2824
a Fj(1.)p Black 546 2824 a
SDict begin H.S end
 546 2824 a 546 2824 a
SDict begin 13 H.A end
 546
2824 a 546 2824 a
SDict begin [/View [/XYZ H.V]/Dest (0:2431) cvn /DEST pdfmark end
 546 2824 a Fj(The)k(hardw)o(are)e(running)g(the)j
(primary)d(serv)o(er)h(has)i(a)g(f)o(atal)f(problem)e(\(po)n(wer)h
(supply)g(e)o(xplodes,)g(machine)546 2932 y(catches)h(\002re,)g(or)g
(someone)f(simply)h(unplugs)e(it)j(by)f(mistak)o(e\),)g(and)f
(disappears.)g(Applications)g(see)i(this,)f(and)546 3040
y(reconnect)e(to)j(the)f(backup)e(serv)o(er)-5 b(.)-2
3058 y
SDict begin H.S end
 -2 3058 a -2 3058 a
SDict begin 13 H.A end
 -2 3058 a -2 3058 a
SDict begin [/View [/XYZ H.V]/Dest (0:2432) cvn /DEST pdfmark end
 -2 3058
a Black 463 3190 a Fj(2.)p Black 546 3190 a
SDict begin H.S end
 546 3190
a 546 3190 a
SDict begin 13 H.A end
 546 3190 a 546 3190 a
SDict begin [/View [/XYZ H.V]/Dest (0:2433) cvn /DEST pdfmark end
 546 3190 a Fj(The)20
b(netw)o(ork)f(se)o(gment)g(on)h(which)f(the)h(primary)f(serv)o(er)g
(sits)j(crashes)e(-)g(perhaps)f(a)i(router)e(gets)h(hit)h(by)f(a)g(po)n
(wer)546 3298 y(spik)o(e)g(-)g(and)g(applications)f(start)i(to)f
(reconnect)e(to)j(the)f(backup)f(serv)o(er)-5 b(.)-2
3315 y
SDict begin H.S end
 -2 3315 a -2 3315 a
SDict begin 13 H.A end
 -2 3315 a -2 3315 a
SDict begin [/View [/XYZ H.V]/Dest (0:2434) cvn /DEST pdfmark end
 -2 3315
a Black 463 3447 a Fj(3.)p Black 546 3447 a
SDict begin H.S end
 546 3447
a 546 3447 a
SDict begin 13 H.A end
 546 3447 a 546 3447 a
SDict begin [/View [/XYZ H.V]/Dest (0:2435) cvn /DEST pdfmark end
 546 3447 a Fj(The)20
b(primary)e(serv)o(er)h(crashes)i(or)e(is)j(killed)d(by)h(the)g
(operator)f(and)g(does)h(not)g(restart)h(automatically)-5
b(.)-2 3465 y
SDict begin H.S end
 -2 3465 a -2 3465 a
SDict begin 13 H.A end
 -2 3465 a -2 3465 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-59) cvn /DEST pdfmark
end

-2 3465 a Black 3759 5569 a Fi(211)p Black eop end
%%Page: 212 226
TeXDict begin 212 225 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.212) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-7.)f(High-a)n(v)o
(ailability)e(P)o(air)k(During)f(F)n(ailo)o(v)o(er)-2
172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2438) cvn /DEST pdfmark end
 -2 172 a 396
2272 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2272 a @beginspecial 0 @llx -247 @lly 423
@urx 0 @ury 4230 @rwi @setspecial
%%BeginDocument: images/fig59.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -247 423 0
%%HiResBoundingBox: 0.0 -247.0 423.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -34.70027160644531 moveto
24.70026969909668 -99.70027160644531 lineto
141.7002716064453 -99.70027160644531 lineto
141.7002716064453 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
285.70025634765625 -34.70027160644531 moveto
285.70025634765625 -99.70027160644531 lineto
402.70025634765625 -99.70027160644531 lineto
402.70025634765625 -34.70027160644531 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
24.70026969909668 -164.7002716064453 moveto
24.70026969909668 -216.7002716064453 lineto
141.7002716064453 -216.7002716064453 lineto
141.7002716064453 -164.7002716064453 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -32.0 moveto
22.0 -97.0 lineto
139.0 -97.0 lineto
139.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.9 setlinewidth
1 setlinecap
[] 0 setdash
newpath
22.0 -32.0 moveto
22.0 -97.0 lineto
139.0 -97.0 lineto
139.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
283.0 -32.0 moveto
283.0 -97.0 lineto
400.0 -97.0 lineto
400.0 -32.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
283.0 -32.0 moveto
283.0 -97.0 lineto
400.0 -97.0 lineto
400.0 -32.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
22.0 -162.0 moveto
22.0 -214.0 lineto
139.0 -214.0 lineto
139.0 -162.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
22.0 -162.0 moveto
22.0 -214.0 lineto
139.0 -214.0 lineto
139.0 -162.0 lineto
closepath
stroke
newpath
148.0 -58.0 moveto
274.0 -58.0 lineto
stroke
newpath
346.0 -110.0 moveto
346.0 -136.0 lineto
76.0 -136.0 lineto
76.0 -162.0 lineto
stroke
newpath
153.0 -52.0 moveto
144.0 -58.0 lineto
153.0 -65.0 lineto
closepath
fill
newpath
270.0 -52.0 moveto
279.0 -58.0 lineto
270.0 -65.0 lineto
closepath
fill
newpath
346.0 -104.0 moveto
342.0 -117.0 lineto
351.0 -117.0 lineto
closepath
fill
/Helvetica findfont
14 scalefont setfont
46.0 -64.0 moveto
(Primary) show
49.0 -77.0 moveto
("slave") show
317.0 -63.0 moveto
(Backup) show
308.0 -77.0 moveto
("master") show
59.0 -194.0 moveto
(Client) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2272 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2272 a 274 x Fj(Reco)o(v)o(ery)f(from)g(f)o
(ail-o)o(v)o(er)f(w)o(orks)i(as)h(follo)n(ws:)-2 2564
y
SDict begin H.S end
 -2 2564 a -2 2564 a
SDict begin 13 H.A end
 -2 2564 a -2 2564 a
SDict begin [/View [/XYZ H.V]/Dest (0:2442) cvn /DEST pdfmark end
 -2 2564 a -2
2574 a
SDict begin H.S end
 -2 2574 a -2 2574 a
SDict begin 13 H.A end
 -2 2574 a -2 2574 a
SDict begin [/View [/XYZ H.V]/Dest (0:2443) cvn /DEST pdfmark end
 -2 2574
a Black 463 2716 a Fj(1.)p Black 546 2716 a
SDict begin H.S end
 546 2716
a 546 2716 a
SDict begin 13 H.A end
 546 2716 a 546 2716 a
SDict begin [/View [/XYZ H.V]/Dest (0:2444) cvn /DEST pdfmark end
 546 2716 a Fj(The)e(operators)f
(restart)i(the)g(primary)e(serv)o(er)g(and)i(\002x)f(whate)n(v)o(er)g
(problems)f(were)h(causing)g(it)i(to)e(disappear)g(from)546
2824 y(the)h(netw)o(ork.)-2 2825 y
SDict begin H.S end
 -2 2825 a -2 2825
a
SDict begin 13 H.A end
 -2 2825 a -2 2825 a
SDict begin [/View [/XYZ H.V]/Dest (0:2445) cvn /DEST pdfmark end
 -2 2825 a Black 463 2974 a Fj(2.)p
Black 546 2974 a
SDict begin H.S end
 546 2974 a 546 2974 a
SDict begin 13 H.A end
 546 2974 a 546
2974 a
SDict begin [/View [/XYZ H.V]/Dest (0:2446) cvn /DEST pdfmark end
 546 2974 a Fj(The)e(operators)g(stop)h(the)g(backup)e(serv)o(er)
m(,)h(at)h(a)h(moment)e(that)h(will)g(cause)g(minimal)g(disruption)e
(to)i(applications.)-2 2992 y
SDict begin H.S end
 -2 2992 a -2 2992 a
SDict begin 13 H.A end
 -2
2992 a -2 2992 a
SDict begin [/View [/XYZ H.V]/Dest (0:2447) cvn /DEST pdfmark end
 -2 2992 a Black 463 3123 a Fj(3.)p Black
546 3123 a
SDict begin H.S end
 546 3123 a 546 3123 a
SDict begin 13 H.A end
 546 3123 a 546 3123
a
SDict begin [/View [/XYZ H.V]/Dest (0:2448) cvn /DEST pdfmark end
 546 3123 a Fj(When)h(applications)f(ha)n(v)o(e)g(reconnected)f(to)i
(the)h(primary)d(serv)o(er)m(,)h(the)h(operators)f(restart)h(the)g
(backup)f(serv)o(er)-5 b(.)-2 3307 y
SDict begin H.S end
 -2 3307 a -2 3307
a
SDict begin 13 H.A end
 -2 3307 a -2 3307 a
SDict begin [/View [/XYZ H.V]/Dest (0:2449) cvn /DEST pdfmark end
 -2 3307 a 396 3397 a Fj(Reco)o(v)o(ery)19
b(\(to)h(using)f(the)i(primary)d(serv)o(er)h(as)i(master\))f(is)h(a)g
(manual)e(operation.)f(P)o(ainful)h(e)o(xperience)g(teaches)h(us)396
3505 y(that)h(automatic)e(reco)o(v)o(ery)e(is)22 b(undesirable.)c
(There)h(are)h(se)n(v)o(eral)g(reasons:)-2 3523 y
SDict begin H.S end
 -2
3523 a -2 3523 a
SDict begin 13 H.A end
 -2 3523 a -2 3523 a
SDict begin [/View [/XYZ H.V]/Dest (0:2450) cvn /DEST pdfmark end
 -2 3523 a -2 3533
a
SDict begin H.S end
 -2 3533 a -2 3533 a
SDict begin 13 H.A end
 -2 3533 a -2 3533 a
SDict begin [/View [/XYZ H.V]/Dest (0:2451) cvn /DEST pdfmark end
 -2 3533 a Black
396 3675 a Fe(\225)p Black 479 3675 a
SDict begin H.S end
 479 3675 a 479
3675 a
SDict begin 13 H.A end
 479 3675 a 479 3675 a
SDict begin [/View [/XYZ H.V]/Dest (0:2452) cvn /DEST pdfmark end
 479 3675 a Fj(F)o(ailo)o(v)o(er)f(creates)
h(an)g(interruption)e(of)i(service)g(to)g(applications,)f(possibly)h
(lasting)g(10-30)e(seconds.)i(If)g(there)f(is)i(a)479
3783 y(real)f(emer)o(genc)o(y)-5 b(,)17 b(this)k(is)g(much)e(better)h
(than)g(total)g(outage.)f(But)i(if)f(reco)o(v)o(ery)e(creates)i(a)h
(further)d(10-30)h(second)479 3891 y(outage,)g(it)i(is)g(better)f(that)
g(this)h(happens)e(of)n(f-peak,)e(when)j(users)g(ha)n(v)o(e)g(gone)f
(of)n(f)h(the)g(netw)o(ork.)-2 3909 y
SDict begin H.S end
 -2 3909 a -2 3909
a
SDict begin 13 H.A end
 -2 3909 a -2 3909 a
SDict begin [/View [/XYZ H.V]/Dest (0:2453) cvn /DEST pdfmark end
 -2 3909 a Black 396 4041 a Fe(\225)p
Black 479 4041 a
SDict begin H.S end
 479 4041 a 479 4041 a
SDict begin 13 H.A end
 479 4041 a 479
4041 a
SDict begin [/View [/XYZ H.V]/Dest (0:2454) cvn /DEST pdfmark end
 479 4041 a Fj(When)g(there)g(is)h(an)f(emer)o(genc)o(y)-5
b(,)17 b(it')-5 b(s)21 b(a)g(Good)e(Idea)h(to)g(create)g
(predictability)e(for)i(those)g(trying)f(to)h(\002x)h(things.)479
4148 y(Automatic)f(reco)o(v)o(ery)d(creates)j(uncertainty)f(for)g
(system)i(admins,)e(who)h(can)g(no)g(longer)e(be)j(sure)f(which)f(serv)
o(er)h(is)479 4256 y(in)h(char)o(ge)d(without)i(double-checking.)-2
4274 y
SDict begin H.S end
 -2 4274 a -2 4274 a
SDict begin 13 H.A end
 -2 4274 a -2 4274 a
SDict begin [/View [/XYZ H.V]/Dest (0:2455) cvn /DEST pdfmark end
 -2 4274
a Black 396 4406 a Fe(\225)p Black 479 4406 a
SDict begin H.S end
 479 4406
a 479 4406 a
SDict begin 13 H.A end
 479 4406 a 479 4406 a
SDict begin [/View [/XYZ H.V]/Dest (0:2456) cvn /DEST pdfmark end
 479 4406 a Fj(Last,)h(you)e(can)h
(get)g(situations)g(with)h(automatic)e(reco)o(v)o(ery)f(where)h(netw)o
(orks)g(will)i(f)o(ail)g(o)o(v)o(er)m(,)d(and)i(then)g(reco)o(v)o(er)m
(,)479 4514 y(and)g(operators)f(are)h(then)f(placed)h(in)g(a)h(dif)n
(\002cult)e(position)h(to)g(analyze)f(what)i(happened.)c(There)j(w)o
(as)h(an)479 4622 y(interruption)d(of)i(service,)g(b)n(ut)g(the)g
(cause)g(isn')o(t)g(clear)-5 b(.)-2 4806 y
SDict begin H.S end
 -2 4806 a
-2 4806 a
SDict begin 13 H.A end
 -2 4806 a -2 4806 a
SDict begin [/View [/XYZ H.V]/Dest (0:2457) cvn /DEST pdfmark end
 -2 4806 a 396 4896 a Fj(Ha)n(ving)20
b(said)g(this,)h(the)f(Binary)g(Star)g(pattern)g(will)g(f)o(ail)h(back)
f(to)g(the)g(primary)f(serv)o(er)g(if)h(this)h(is)g(running)d
(\(again\))h(and)396 5004 y(the)h(backup)f(serv)o(er)g(f)o(ails.)i(In)f
(f)o(act)g(this)h(is)g(ho)n(w)f(we)g(pro)o(v)n(ok)o(e)e(reco)o(v)o(ery)
-5 b(.)p Black 3759 5569 a Fi(212)p Black eop end
%%Page: 213 227
TeXDict begin 213 226 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.213) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2458) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(The)20 b(shutdo)n(wn)f(process)g(for)h(a)
h(Binary)e(Star)i(pair)f(is)h(to)f(either:)-2 90 y
SDict begin H.S end
 -2
90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:2459) cvn /DEST pdfmark end
 -2 90 a -2 100 a
SDict begin H.S end
 -2 100
a -2 100 a
SDict begin 13 H.A end
 -2 100 a -2 100 a
SDict begin [/View [/XYZ H.V]/Dest (0:2460) cvn /DEST pdfmark end
 -2 100 a Black 463 243 a
Fj(1.)p Black 546 243 a
SDict begin H.S end
 546 243 a 546 243 a
SDict begin 13 H.A end
 546 243 a
546 243 a
SDict begin [/View [/XYZ H.V]/Dest (0:2461) cvn /DEST pdfmark end
 546 243 a Fj(Stop)g(the)g(passi)n(v)o(e)g(serv)o(er)f(and)h
(then)f(stop)i(the)f(acti)n(v)o(e)g(serv)o(er)f(at)i(an)o(y)e(later)h
(time,)g(or)-2 261 y
SDict begin H.S end
 -2 261 a -2 261 a
SDict begin 13 H.A end
 -2 261 a -2 261
a
SDict begin [/View [/XYZ H.V]/Dest (0:2462) cvn /DEST pdfmark end
 -2 261 a Black 463 392 a Fj(2.)p Black 546 392 a
SDict begin H.S end
 546
392 a 546 392 a
SDict begin 13 H.A end
 546 392 a 546 392 a
SDict begin [/View [/XYZ H.V]/Dest (0:2463) cvn /DEST pdfmark end
 546 392 a Fj(Stop)g(both)f(serv)o
(ers)h(in)g(an)o(y)f(order)g(b)n(ut)i(within)f(a)g(fe)n(w)g(seconds)g
(of)g(each)g(other)-5 b(.)-2 576 y
SDict begin H.S end
 -2 576 a -2 576 a
SDict begin 13 H.A end

-2 576 a -2 576 a
SDict begin [/View [/XYZ H.V]/Dest (0:2464) cvn /DEST pdfmark end
 -2 576 a 396 666 a Fj(Stopping)19 b(the)h(acti)n(v)o
(e)g(and)f(then)h(the)g(passi)n(v)o(e)g(serv)o(er)g(with)g(an)o(y)f
(delay)h(longer)f(than)g(the)i(f)o(ail-o)o(v)o(er)d(timeout)h(will)396
774 y(cause)h(applications)f(to)i(disconnect,)d(then)i(reconnect,)e
(then)i(disconnect)f(again,)g(which)g(may)h(disturb)g(users.)-2
802 y
SDict begin H.S end
 -2 802 a -2 802 a
SDict begin 13 H.A end
 -2 802 a -2 802 a
SDict begin [/View [/XYZ H.V]/Dest (0:2465) cvn /DEST pdfmark end
 -2 802 a 396
1112 a Fd(4.13.2.)36 b(Detailed)f(Requirements)2088 1112
y
SDict begin H.S end
 2088 1112 a 2088 1112 a
SDict begin 18.72 H.A end
 2088 1112 a 2088 1112 a
SDict begin [/View [/XYZ H.V]/Dest (9.52.26.2) cvn /DEST pdfmark end
 2088
1112 a -2 1303 a
SDict begin H.S end
 -2 1303 a -2 1303 a
SDict begin 13 H.A end
 -2 1303 a -2 1303
a
SDict begin [/View [/XYZ H.V]/Dest (0:2467) cvn /DEST pdfmark end
 -2 1303 a 396 1386 a Fj(Binary)20 b(Star)h(is)g(as)g(simple)f(as)h
(it)g(can)f(be,)f(while)i(still)g(w)o(orking)e(accurately)-5
b(.)18 b(In)i(f)o(act)g(the)g(current)f(design)h(is)h(the)f(third)396
1494 y(complete)f(redesign.)g(Each)h(of)g(the)g(pre)n(vious)f(designs)g
(we)i(found)d(to)j(be)f(too)g(comple)o(x,)e(trying)h(to)h(do)g(too)g
(much,)f(and)396 1602 y(we)i(stripped)e(out)h(functionality)e(until)i
(we)h(came)f(to)g(a)g(design)g(that)g(w)o(as)h(understandable)d(and)h
(use,)h(and)g(reliable)396 1710 y(enough)e(to)j(be)f(w)o(orth)g(using.)
-2 1894 y
SDict begin H.S end
 -2 1894 a -2 1894 a
SDict begin 13 H.A end
 -2 1894 a -2 1894 a
SDict begin [/View [/XYZ H.V]/Dest (0:2468) cvn /DEST pdfmark end
 -2
1894 a 396 1984 a Fj(These)g(are)g(our)g(requirements)e(for)i(a)g
(high-a)n(v)n(ailability)e(architecture:)-2 2002 y
SDict begin H.S end
 -2
2002 a -2 2002 a
SDict begin 13 H.A end
 -2 2002 a -2 2002 a
SDict begin [/View [/XYZ H.V]/Dest (0:2469) cvn /DEST pdfmark end
 -2 2002 a -2 2012
a
SDict begin H.S end
 -2 2012 a -2 2012 a
SDict begin 13 H.A end
 -2 2012 a -2 2012 a
SDict begin [/View [/XYZ H.V]/Dest (0:2470) cvn /DEST pdfmark end
 -2 2012 a Black
396 2154 a Fe(\225)p Black 479 2154 a
SDict begin H.S end
 479 2154 a 479
2154 a
SDict begin 13 H.A end
 479 2154 a 479 2154 a
SDict begin [/View [/XYZ H.V]/Dest (0:2471) cvn /DEST pdfmark end
 479 2154 a Fj(The)i(f)o(ail-o)o(v)o(er)e
(is)k(meant)d(to)i(pro)o(vide)d(insurance)h(against)g(catastrophic)g
(system)h(f)o(ailures,)g(such)g(as)h(hardw)o(are)479
2262 y(breakdo)n(wn,)d(\002re,)i(accident,)f(etc.)h(T)-7
b(o)21 b(guard)d(against)i(ordinary)e(serv)o(er)h(crashes)h(there)g
(are)g(simpler)g(w)o(ays)h(to)479 2370 y(reco)o(v)o(er)-5
b(.)-2 2371 y
SDict begin H.S end
 -2 2371 a -2 2371 a
SDict begin 13 H.A end
 -2 2371 a -2 2371 a
SDict begin [/View [/XYZ H.V]/Dest (0:2472) cvn /DEST pdfmark end

-2 2371 a Black 396 2520 a Fe(\225)p Black 479 2520 a
SDict begin H.S end

479 2520 a 479 2520 a
SDict begin 13 H.A end
 479 2520 a 479 2520 a
SDict begin [/View [/XYZ H.V]/Dest (0:2473) cvn /DEST pdfmark end
 479 2520
a Fj(F)o(ailo)o(v)o(er)19 b(time)h(should)g(be)g(under)e(60)i(seconds)g
(and)f(preferably)f(under)h(10)h(seconds.)-2 2538 y
SDict begin H.S end
 -2
2538 a -2 2538 a
SDict begin 13 H.A end
 -2 2538 a -2 2538 a
SDict begin [/View [/XYZ H.V]/Dest (0:2474) cvn /DEST pdfmark end
 -2 2538 a Black
396 2669 a Fe(\225)p Black 479 2669 a
SDict begin H.S end
 479 2669 a 479
2669 a
SDict begin 13 H.A end
 479 2669 a 479 2669 a
SDict begin [/View [/XYZ H.V]/Dest (0:2475) cvn /DEST pdfmark end
 479 2669 a Fj(F)o(ailo)o(v)o(er)f(has)h
(to)h(happen)d(automatically)-5 b(,)18 b(whereas)i(reco)o(v)o(er)e
(must)i(happen)f(manually)-5 b(.)18 b(W)-7 b(e)21 b(w)o(ant)g
(applications)e(to)479 2777 y(switch)i(o)o(v)o(er)e(to)h(the)g(backup)f
(serv)o(er)g(automatically)g(b)n(ut)h(we)g(do)g(not)g(w)o(ant)g(them)g
(to)h(switch)f(back)g(to)g(the)g(primary)479 2885 y(serv)o(er)g(e)o
(xcept)f(when)g(the)i(operators)d(ha)n(v)o(e)i(\002x)o(ed)f(whate)n(v)o
(er)g(problem)g(there)g(w)o(as,)i(and)f(decided)f(that)h(it)h(is)g(a)g
(good)479 2993 y(time)g(to)f(interrupt)f(applications)g(again.)-2
3011 y
SDict begin H.S end
 -2 3011 a -2 3011 a
SDict begin 13 H.A end
 -2 3011 a -2 3011 a
SDict begin [/View [/XYZ H.V]/Dest (0:2476) cvn /DEST pdfmark end
 -2 3011
a Black 396 3142 a Fe(\225)p Black 479 3142 a
SDict begin H.S end
 479 3142
a 479 3142 a
SDict begin 13 H.A end
 479 3142 a 479 3142 a
SDict begin [/View [/XYZ H.V]/Dest (0:2477) cvn /DEST pdfmark end
 479 3142 a Fj(The)h(semantics)g(for)
g(client)g(applications)f(should)g(be)h(simple)h(and)e(easy)i(for)e(de)
n(v)o(elopers)f(to)i(understand.)e(Ideally)479 3250 y(the)o(y)i(should)
f(be)h(hidden)f(in)h(the)g(client)h(API.)-2 3268 y
SDict begin H.S end
 -2
3268 a -2 3268 a
SDict begin 13 H.A end
 -2 3268 a -2 3268 a
SDict begin [/View [/XYZ H.V]/Dest (0:2478) cvn /DEST pdfmark end
 -2 3268 a Black
396 3400 a Fe(\225)p Black 479 3400 a
SDict begin H.S end
 479 3400 a 479
3400 a
SDict begin 13 H.A end
 479 3400 a 479 3400 a
SDict begin [/View [/XYZ H.V]/Dest (0:2479) cvn /DEST pdfmark end
 479 3400 a Fj(There)f(should)f(be)h(clear)
g(instructions)f(for)h(netw)o(ork)f(architects)h(on)f(ho)n(w)h(to)g(a)n
(v)n(oid)g(designs)g(that)g(could)g(lead)g(to)479 3508
y(split)h(brain)e(syndrome)g(in)h(which)g(both)f(serv)o(ers)h(in)g(a)h
(Binary)e(Star)i(pair)f(think)f(the)o(y)h(are)g(the)g(master)g(serv)o
(er)-5 b(.)-2 3526 y
SDict begin H.S end
 -2 3526 a -2 3526 a
SDict begin 13 H.A end
 -2 3526 a -2
3526 a
SDict begin [/View [/XYZ H.V]/Dest (0:2480) cvn /DEST pdfmark end
 -2 3526 a Black 396 3657 a Fe(\225)p Black 479
3657 a
SDict begin H.S end
 479 3657 a 479 3657 a
SDict begin 13 H.A end
 479 3657 a 479 3657 a
SDict begin [/View [/XYZ H.V]/Dest (0:2481) cvn /DEST pdfmark end
 479
3657 a Fj(There)20 b(should)f(be)h(no)g(dependencies)e(on)h(the)i
(order)e(in)h(which)g(the)g(tw)o(o)g(serv)o(ers)g(are)g(started.)-2
3675 y
SDict begin H.S end
 -2 3675 a -2 3675 a
SDict begin 13 H.A end
 -2 3675 a -2 3675 a
SDict begin [/View [/XYZ H.V]/Dest (0:2482) cvn /DEST pdfmark end
 -2 3675
a Black 396 3807 a Fe(\225)p Black 479 3807 a
SDict begin H.S end
 479 3807
a 479 3807 a
SDict begin 13 H.A end
 479 3807 a 479 3807 a
SDict begin [/View [/XYZ H.V]/Dest (0:2483) cvn /DEST pdfmark end
 479 3807 a Fj(It)h(must)f(be)g
(possible)g(to)g(mak)o(e)g(planned)f(stops)h(and)g(restarts)g(of)g
(either)g(serv)o(er)f(without)h(stopping)f(client)479
3914 y(applications)g(\(though)f(the)o(y)i(may)g(be)g(forced)e(to)j
(reconnect\).)-2 3932 y
SDict begin H.S end
 -2 3932 a -2 3932 a
SDict begin 13 H.A end
 -2 3932 a
-2 3932 a
SDict begin [/View [/XYZ H.V]/Dest (0:2484) cvn /DEST pdfmark end
 -2 3932 a Black 396 4064 a Fe(\225)p Black
479 4064 a
SDict begin H.S end
 479 4064 a 479 4064 a
SDict begin 13 H.A end
 479 4064 a 479 4064
a
SDict begin [/View [/XYZ H.V]/Dest (0:2485) cvn /DEST pdfmark end
 479 4064 a Fj(Operators)e(must)i(be)f(able)g(to)g(monitor)f(both)g
(serv)o(ers)h(at)h(all)f(times.)-2 4082 y
SDict begin H.S end
 -2 4082 a -2
4082 a
SDict begin 13 H.A end
 -2 4082 a -2 4082 a
SDict begin [/View [/XYZ H.V]/Dest (0:2486) cvn /DEST pdfmark end
 -2 4082 a Black 396 4213 a
Fe(\225)p Black 479 4213 a
SDict begin H.S end
 479 4213 a 479 4213 a
SDict begin 13 H.A end
 479
4213 a 479 4213 a
SDict begin [/View [/XYZ H.V]/Dest (0:2487) cvn /DEST pdfmark end
 479 4213 a Fj(It)h(must)f(be)g(possible)g(to)g
(connect)f(the)i(tw)o(o)f(serv)o(ers)g(using)f(a)i(high-speed)d
(dedicated)h(netw)o(ork)g(connection.)f(That)479 4321
y(is,)j(f)o(ail-o)o(v)o(er)d(synchronization)g(must)i(be)g(able)g(to)g
(use)h(a)f(speci\002c)h(IP)f(route.)-2 4505 y
SDict begin H.S end
 -2 4505
a -2 4505 a
SDict begin 13 H.A end
 -2 4505 a -2 4505 a
SDict begin [/View [/XYZ H.V]/Dest (0:2488) cvn /DEST pdfmark end
 -2 4505 a 396 4595 a
Fj(W)-7 b(e)22 b(mak)o(e)d(these)i(assumptions:)-2 4613
y
SDict begin H.S end
 -2 4613 a -2 4613 a
SDict begin 13 H.A end
 -2 4613 a -2 4613 a
SDict begin [/View [/XYZ H.V]/Dest (0:2489) cvn /DEST pdfmark end
 -2 4613 a -2
4623 a
SDict begin H.S end
 -2 4623 a -2 4623 a
SDict begin 13 H.A end
 -2 4623 a -2 4623 a
SDict begin [/View [/XYZ H.V]/Dest (0:2490) cvn /DEST pdfmark end
 -2 4623
a Black 396 4765 a Fe(\225)p Black 479 4765 a
SDict begin H.S end
 479 4765
a 479 4765 a
SDict begin 13 H.A end
 479 4765 a 479 4765 a
SDict begin [/View [/XYZ H.V]/Dest (0:2491) cvn /DEST pdfmark end
 479 4765 a Fj(A)g(single)f(backup)f
(serv)o(er)g(pro)o(vides)f(enough)h(insurance,)f(we)j(don')o(t)d(need)i
(multiple)f(le)n(v)o(els)h(of)g(backup.)-2 4783 y
SDict begin H.S end
 -2
4783 a -2 4783 a
SDict begin 13 H.A end
 -2 4783 a -2 4783 a
SDict begin [/View [/XYZ H.V]/Dest (0:2492) cvn /DEST pdfmark end
 -2 4783 a Black
396 4915 a Fe(\225)p Black 479 4915 a
SDict begin H.S end
 479 4915 a 479
4915 a
SDict begin 13 H.A end
 479 4915 a 479 4915 a
SDict begin [/View [/XYZ H.V]/Dest (0:2493) cvn /DEST pdfmark end
 479 4915 a Fj(The)g(primary)f(and)g
(backup)g(serv)o(ers)h(are)g(equally)f(capable)g(of)h(carrying)e(the)j
(application)d(load.)i(W)-7 b(e)21 b(do)f(not)479 5023
y(attempt)g(to)g(balance)g(load)f(across)i(the)f(serv)o(ers.)-2
5041 y
SDict begin H.S end
 -2 5041 a -2 5041 a
SDict begin 13 H.A end
 -2 5041 a -2 5041 a
SDict begin [/View [/XYZ H.V]/Dest (0:2494) cvn /DEST pdfmark end
 -2 5041
a Black 3759 5569 a Fi(213)p Black eop end
%%Page: 214 228
TeXDict begin 214 227 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.214) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black Black 396 72 a Fe(\225)p Black 479
72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2495) cvn /DEST pdfmark end
 479 72 a Fj(There)20
b(is)h(suf)n(\002cient)e(b)n(udget)h(to)g(co)o(v)o(er)f(a)h(fully)g
(redundant)d(backup)i(serv)o(er)g(that)i(does)f(nothing)e(almost)i(all)
h(the)479 180 y(time.)-2 347 y
SDict begin H.S end
 -2 347 a -2 347 a
SDict begin 13 H.A end
 -2 347
a -2 347 a
SDict begin [/View [/XYZ H.V]/Dest (0:2496) cvn /DEST pdfmark end
 -2 347 a 396 454 a Fj(W)-7 b(e)22 b(don')o(t)c(attempt)i(to)
g(co)o(v)o(er:)-2 472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end
 -2 472 a -2
472 a
SDict begin [/View [/XYZ H.V]/Dest (0:2497) cvn /DEST pdfmark end
 -2 472 a -2 482 a
SDict begin H.S end
 -2 482 a -2 482 a
SDict begin 13 H.A end
 -2 482 a -2
482 a
SDict begin [/View [/XYZ H.V]/Dest (0:2498) cvn /DEST pdfmark end
 -2 482 a Black 396 625 a Fe(\225)p Black 479 625
a
SDict begin H.S end
 479 625 a 479 625 a
SDict begin 13 H.A end
 479 625 a 479 625 a
SDict begin [/View [/XYZ H.V]/Dest (0:2499) cvn /DEST pdfmark end
 479 625 a Fj(The)g(use)h(of)e
(an)i(acti)n(v)o(e)e(backup)g(serv)o(er)g(or)h(load)g(balancing.)e(In)i
(a)h(Binary)e(Star)i(pair)m(,)e(the)h(backup)f(serv)o(er)g(is)479
733 y(inacti)n(v)o(e)h(and)f(does)h(no)g(useful)g(w)o(ork)f(until)h
(the)g(primary)f(serv)o(er)g(goes)h(of)n(f-line.)-2 750
y
SDict begin H.S end
 -2 750 a -2 750 a
SDict begin 13 H.A end
 -2 750 a -2 750 a
SDict begin [/View [/XYZ H.V]/Dest (0:2500) cvn /DEST pdfmark end
 -2 750 a Black
396 882 a Fe(\225)p Black 479 882 a
SDict begin H.S end
 479 882 a 479 882
a
SDict begin 13 H.A end
 479 882 a 479 882 a
SDict begin [/View [/XYZ H.V]/Dest (0:2501) cvn /DEST pdfmark end
 479 882 a Fj(The)g(handling)e(of)i(persistent)g
(messages)h(or)f(transactions)f(in)h(an)o(y)g(w)o(ay)-5
b(.)19 b(W)-7 b(e)22 b(assuming)d(a)i(netw)o(ork)e(of)h(unreliable)479
990 y(\(and)g(probably)d(untrusted\))i(serv)o(ers)g(or)h(Binary)g(Star)
h(pairs.)-2 1008 y
SDict begin H.S end
 -2 1008 a -2 1008 a
SDict begin 13 H.A end
 -2 1008 a -2 1008
a
SDict begin [/View [/XYZ H.V]/Dest (0:2502) cvn /DEST pdfmark end
 -2 1008 a Black 396 1139 a Fe(\225)p Black 479 1139
a
SDict begin H.S end
 479 1139 a 479 1139 a
SDict begin 13 H.A end
 479 1139 a 479 1139 a
SDict begin [/View [/XYZ H.V]/Dest (0:2503) cvn /DEST pdfmark end
 479 1139
a Fj(An)o(y)f(automatic)f(e)o(xploration)f(of)i(the)g(netw)o(ork.)e
(The)i(Binary)g(Star)h(pair)e(is)j(manually)c(and)i(e)o(xplicitly)f
(de\002ned)g(in)479 1247 y(the)h(netw)o(ork)f(and)h(is)h(kno)n(wn)e(to)
h(applications)f(\(at)i(least)g(in)f(their)g(con\002guration)d(data\).)
-2 1265 y
SDict begin H.S end
 -2 1265 a -2 1265 a
SDict begin 13 H.A end
 -2 1265 a -2 1265 a
SDict begin [/View [/XYZ H.V]/Dest (0:2504) cvn /DEST pdfmark end
 -2
1265 a Black 396 1397 a Fe(\225)p Black 479 1397 a
SDict begin H.S end
 479
1397 a 479 1397 a
SDict begin 13 H.A end
 479 1397 a 479 1397 a
SDict begin [/View [/XYZ H.V]/Dest (0:2505) cvn /DEST pdfmark end
 479 1397 a Fj(Replication)j(of)
g(state)h(or)f(messages)g(between)f(serv)o(ers.)h(All)h(serv)o(er)n
(-side)e(state)i(much)e(be)h(recreated)f(by)479 1505
y(applications)g(when)h(the)o(y)f(f)o(ail)i(o)o(v)o(er)-5
b(.)-2 1689 y
SDict begin H.S end
 -2 1689 a -2 1689 a
SDict begin 13 H.A end
 -2 1689 a -2 1689 a
SDict begin [/View [/XYZ H.V]/Dest (0:2506) cvn /DEST pdfmark end

-2 1689 a 396 1779 a Fj(Here)20 b(is)h(the)g(k)o(e)o(y)e(terminology)f
(we)i(use)h(in)f(Binary)g(Star:)-2 1797 y
SDict begin H.S end
 -2 1797 a -2
1797 a
SDict begin 13 H.A end
 -2 1797 a -2 1797 a
SDict begin [/View [/XYZ H.V]/Dest (0:2507) cvn /DEST pdfmark end
 -2 1797 a -2 1807 a
SDict begin H.S end
 -2 1807
a -2 1807 a
SDict begin 13 H.A end
 -2 1807 a -2 1807 a
SDict begin [/View [/XYZ H.V]/Dest (0:2508) cvn /DEST pdfmark end
 -2 1807 a Black 396 1949
a Fe(\225)p Black 479 1949 a
SDict begin H.S end
 479 1949 a 479 1949 a
SDict begin 13 H.A end
 479
1949 a 479 1949 a
SDict begin [/View [/XYZ H.V]/Dest (0:2509) cvn /DEST pdfmark end
 479 1949 a 479 1949 a
SDict begin H.S end
 479 1949 a 479
1949 a
SDict begin 13 H.A end
 479 1949 a 479 1949 a
SDict begin [/View [/XYZ H.V]/Dest (0:2510) cvn /DEST pdfmark end
 479 1949 a Fk(Primary)g
Fj(-)g(the)g(primary)f(serv)o(er)g(is)i(the)g(one)e(that)i(is)g
(normally)d('master'.)-2 1967 y
SDict begin H.S end
 -2 1967 a -2 1967 a
SDict begin 13 H.A end
 -2
1967 a -2 1967 a
SDict begin [/View [/XYZ H.V]/Dest (0:2511) cvn /DEST pdfmark end
 -2 1967 a Black 396 2098 a Fe(\225)p
Black 479 2098 a
SDict begin H.S end
 479 2098 a 479 2098 a
SDict begin 13 H.A end
 479 2098 a 479
2098 a
SDict begin [/View [/XYZ H.V]/Dest (0:2512) cvn /DEST pdfmark end
 479 2098 a 479 2098 a
SDict begin H.S end
 479 2098 a 479 2098 a
SDict begin 13 H.A end
 479
2098 a 479 2098 a
SDict begin [/View [/XYZ H.V]/Dest (0:2513) cvn /DEST pdfmark end
 479 2098 a Fk(Backup)j Fj(-)g(the)f(backup)e(serv)o
(er)i(is)h(the)f(one)g(that)g(is)h(normally)e(')-5 b(sla)n(v)o(e',)20
b(it)h(will)f(become)f(master)h(if)h(and)f(when)f(the)479
2206 y(primary)g(serv)o(er)g(disappears)g(from)h(the)g(netw)o(ork,)f
(and)g(when)h(client)g(applications)f(ask)h(the)h(backup)d(serv)o(er)h
(to)479 2314 y(connect.)-2 2315 y
SDict begin H.S end
 -2 2315 a -2 2315 a
SDict begin 13 H.A end

-2 2315 a -2 2315 a
SDict begin [/View [/XYZ H.V]/Dest (0:2514) cvn /DEST pdfmark end
 -2 2315 a Black 396 2464 a Fe(\225)p
Black 479 2464 a
SDict begin H.S end
 479 2464 a 479 2464 a
SDict begin 13 H.A end
 479 2464 a 479
2464 a
SDict begin [/View [/XYZ H.V]/Dest (0:2515) cvn /DEST pdfmark end
 479 2464 a 479 2464 a
SDict begin H.S end
 479 2464 a 479 2464 a
SDict begin 13 H.A end
 479
2464 a 479 2464 a
SDict begin [/View [/XYZ H.V]/Dest (0:2516) cvn /DEST pdfmark end
 479 2464 a Fk(Master)i Fj(-)f(the)g(master)g(serv)o
(er)g(is)h(the)f(one)g(of)g(a)g(Binary)g(Star)g(pair)g(that)h(accepts)f
(client)g(connections.)e(There)h(is)i(at)479 2571 y(most)g(one)e
(master)h(serv)o(er)-5 b(.)-2 2572 y
SDict begin H.S end
 -2 2572 a -2 2572
a
SDict begin 13 H.A end
 -2 2572 a -2 2572 a
SDict begin [/View [/XYZ H.V]/Dest (0:2517) cvn /DEST pdfmark end
 -2 2572 a Black 396 2721 a Fe(\225)p
Black 479 2721 a
SDict begin H.S end
 479 2721 a 479 2721 a
SDict begin 13 H.A end
 479 2721 a 479
2721 a
SDict begin [/View [/XYZ H.V]/Dest (0:2518) cvn /DEST pdfmark end
 479 2721 a 479 2721 a
SDict begin H.S end
 479 2721 a 479 2721 a
SDict begin 13 H.A end
 479
2721 a 479 2721 a
SDict begin [/View [/XYZ H.V]/Dest (0:2519) cvn /DEST pdfmark end
 479 2721 a Fk(Sla)n(v)o(e)20 b Fj(-)h(the)f(sla)n(v)o
(e)g(serv)o(er)g(is)h(the)f(one)g(that)g(tak)o(es)g(o)o(v)o(er)f(if)i
(the)f(master)g(disappears.)f(Note)h(that)g(when)g(a)h(Binary)479
2829 y(Star)g(pair)f(is)h(running)d(normally)-5 b(,)18
b(the)i(primary)f(serv)o(er)g(is)i(master)m(,)f(and)f(the)h(backup)f
(is)i(sla)n(v)o(e.)f(When)g(a)h(f)o(ail-o)o(v)o(er)479
2937 y(has)g(happened,)c(the)k(roles)f(are)g(switched.)-2
3121 y
SDict begin H.S end
 -2 3121 a -2 3121 a
SDict begin 13 H.A end
 -2 3121 a -2 3121 a
SDict begin [/View [/XYZ H.V]/Dest (0:2520) cvn /DEST pdfmark end
 -2 3121
a 396 3211 a Fj(T)-7 b(o)21 b(con\002gure)d(a)j(Binary)e(Star)i(pair)m
(,)e(you)g(need)h(to:)-2 3229 y
SDict begin H.S end
 -2 3229 a -2 3229 a
SDict begin 13 H.A end
 -2
3229 a -2 3229 a
SDict begin [/View [/XYZ H.V]/Dest (0:2521) cvn /DEST pdfmark end
 -2 3229 a -2 3239 a
SDict begin H.S end
 -2 3239 a -2 3239
a
SDict begin 13 H.A end
 -2 3239 a -2 3239 a
SDict begin [/View [/XYZ H.V]/Dest (0:2522) cvn /DEST pdfmark end
 -2 3239 a Black 463 3381 a Fj(1.)p
Black 546 3381 a
SDict begin H.S end
 546 3381 a 546 3381 a
SDict begin 13 H.A end
 546 3381 a 546
3381 a
SDict begin [/View [/XYZ H.V]/Dest (0:2523) cvn /DEST pdfmark end
 546 3381 a Fj(T)-6 b(ell)20 b(the)h(primary)d(serv)o(er)i(where)
f(the)h(backup)f(serv)o(er)g(is.)-2 3399 y
SDict begin H.S end
 -2 3399 a
-2 3399 a
SDict begin 13 H.A end
 -2 3399 a -2 3399 a
SDict begin [/View [/XYZ H.V]/Dest (0:2524) cvn /DEST pdfmark end
 -2 3399 a Black 463 3530
a Fj(2.)p Black 546 3530 a
SDict begin H.S end
 546 3530 a 546 3530 a
SDict begin 13 H.A end
 546
3530 a 546 3530 a
SDict begin [/View [/XYZ H.V]/Dest (0:2525) cvn /DEST pdfmark end
 546 3530 a Fj(T)-6 b(ell)20 b(the)h(backup)d(serv)o
(er)h(where)h(the)g(primary)f(serv)o(er)g(is.)-2 3548
y
SDict begin H.S end
 -2 3548 a -2 3548 a
SDict begin 13 H.A end
 -2 3548 a -2 3548 a
SDict begin [/View [/XYZ H.V]/Dest (0:2526) cvn /DEST pdfmark end
 -2 3548 a Black
463 3680 a Fj(3.)p Black 546 3680 a
SDict begin H.S end
 546 3680 a 546 3680
a
SDict begin 13 H.A end
 546 3680 a 546 3680 a
SDict begin [/View [/XYZ H.V]/Dest (0:2527) cvn /DEST pdfmark end
 546 3680 a Fj(Optionally)-5 b(,)18
b(tune)i(the)g(f)o(ail-o)o(v)o(er)e(response)h(times,)i(which)f(must)g
(be)g(the)g(same)g(for)g(both)f(serv)o(ers.)-2 3864 y
SDict begin H.S end

-2 3864 a -2 3864 a
SDict begin 13 H.A end
 -2 3864 a -2 3864 a
SDict begin [/View [/XYZ H.V]/Dest (0:2528) cvn /DEST pdfmark end
 -2 3864 a 396
3954 a Fj(The)h(main)g(tuning)f(concern)f(is)k(ho)n(w)d(frequently)f
(you)h(w)o(ant)i(the)f(serv)o(ers)g(to)g(check)f(their)h(peering)f
(status,)i(and)e(ho)n(w)396 4062 y(quickly)g(you)g(w)o(ant)i(to)f(acti)
n(v)n(ate)g(f)o(ail-o)o(v)o(er)-5 b(.)18 b(In)i(our)g(e)o(xample,)e
(the)i(f)o(ail-o)o(v)o(er)f(timeout)g(v)n(alue)h(def)o(aults)f(to)i
(2000)e(msec.)396 4170 y(If)h(you)g(reduce)f(this,)h(the)g(backup)f
(serv)o(er)g(will)i(tak)o(e)f(o)o(v)o(er)f(as)i(master)f(more)f
(rapidly)g(b)n(ut)i(may)e(tak)o(e)i(o)o(v)o(er)d(in)j(cases)396
4278 y(where)f(the)g(primary)f(serv)o(er)g(could)g(reco)o(v)o(er)-5
b(.)19 b(Y)-9 b(ou)19 b(may)h(for)f(e)o(xample)g(ha)n(v)o(e)h(wrapped)e
(the)j(primary)d(serv)o(er)i(in)g(a)h(shell)396 4385
y(script)f(that)h(restarts)f(it)h(if)g(it)g(crashes.)e(In)h(that)h
(case)f(the)g(timeout)g(should)f(be)h(higher)f(than)h(the)g(time)g
(needed)f(to)i(restart)396 4493 y(the)f(primary)f(serv)o(er)-5
b(.)-2 4677 y
SDict begin H.S end
 -2 4677 a -2 4677 a
SDict begin 13 H.A end
 -2 4677 a -2 4677 a
SDict begin [/View [/XYZ H.V]/Dest (0:2529) cvn /DEST pdfmark end

-2 4677 a 396 4767 a Fj(F)o(or)20 b(client)g(applications)f(to)i(w)o
(ork)e(properly)f(with)j(a)f(Binary)g(Star)g(pair)m(,)g(the)o(y)f
(must:)-2 4785 y
SDict begin H.S end
 -2 4785 a -2 4785 a
SDict begin 13 H.A end
 -2 4785 a -2 4785
a
SDict begin [/View [/XYZ H.V]/Dest (0:2530) cvn /DEST pdfmark end
 -2 4785 a -2 4795 a
SDict begin H.S end
 -2 4795 a -2 4795 a
SDict begin 13 H.A end
 -2 4795 a -2
4795 a
SDict begin [/View [/XYZ H.V]/Dest (0:2531) cvn /DEST pdfmark end
 -2 4795 a Black 463 4938 a Fj(1.)p Black 546 4938
a
SDict begin H.S end
 546 4938 a 546 4938 a
SDict begin 13 H.A end
 546 4938 a 546 4938 a
SDict begin [/View [/XYZ H.V]/Dest (0:2532) cvn /DEST pdfmark end
 546 4938
a Fj(Kno)n(w)g(both)h(serv)o(er)f(addresses.)-2 4939
y
SDict begin H.S end
 -2 4939 a -2 4939 a
SDict begin 13 H.A end
 -2 4939 a -2 4939 a
SDict begin [/View [/XYZ H.V]/Dest (0:2533) cvn /DEST pdfmark end
 -2 4939 a Black
463 5087 a Fj(2.)p Black 546 5087 a
SDict begin H.S end
 546 5087 a 546 5087
a
SDict begin 13 H.A end
 546 5087 a 546 5087 a
SDict begin [/View [/XYZ H.V]/Dest (0:2534) cvn /DEST pdfmark end
 546 5087 a Fj(T)m(ry)g(to)i(connect)e(to)h(the)
g(primary)f(serv)o(er)m(,)g(and)g(if)i(that)f(f)o(ails,)h(to)f(the)g
(backup)f(serv)o(er)-5 b(.)-2 5105 y
SDict begin H.S end
 -2 5105 a -2 5105
a
SDict begin 13 H.A end
 -2 5105 a -2 5105 a
SDict begin [/View [/XYZ H.V]/Dest (0:2535) cvn /DEST pdfmark end
 -2 5105 a Black 3759 5569 a Fi(214)p
Black eop end
%%Page: 215 229
TeXDict begin 215 228 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.215) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black Black 463 72 a Fj(3.)p Black 546 72
a
SDict begin H.S end
 546 72 a 546 72 a
SDict begin 13 H.A end
 546 72 a 546 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2536) cvn /DEST pdfmark end
 546 72 a Fj(Detect)20
b(a)h(f)o(ailed)f(connection,)e(typically)h(using)h(heartbeating.)-2
90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:2537) cvn /DEST pdfmark end
 -2 90 a Black 463
222 a Fj(4.)p Black 546 222 a
SDict begin H.S end
 546 222 a 546 222 a
SDict begin 13 H.A end
 546
222 a 546 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:2538) cvn /DEST pdfmark end
 546 222 a Fj(T)m(ry)f(to)i(reconnect)d(to)j(primary)-5
b(,)18 b(and)h(then)h(backup,)e(with)j(a)f(delay)g(between)f(retries)h
(that)h(is)g(at)f(least)h(as)g(high)f(as)546 330 y(the)g(serv)o(er)f(f)
o(ail-o)o(v)o(er)g(timeout.)-2 331 y
SDict begin H.S end
 -2 331 a -2 331
a
SDict begin 13 H.A end
 -2 331 a -2 331 a
SDict begin [/View [/XYZ H.V]/Dest (0:2539) cvn /DEST pdfmark end
 -2 331 a Black 463 479 a Fj(5.)p
Black 546 479 a
SDict begin H.S end
 546 479 a 546 479 a
SDict begin 13 H.A end
 546 479 a 546 479
a
SDict begin [/View [/XYZ H.V]/Dest (0:2540) cvn /DEST pdfmark end
 546 479 a Fj(Recreate)h(all)h(of)f(the)g(state)h(the)o(y)e(require)g
(on)h(a)g(serv)o(er)-5 b(.)-2 497 y
SDict begin H.S end
 -2 497 a -2 497 a
SDict begin 13 H.A end

-2 497 a -2 497 a
SDict begin [/View [/XYZ H.V]/Dest (0:2541) cvn /DEST pdfmark end
 -2 497 a Black 463 629 a Fj(6.)p Black
546 629 a
SDict begin H.S end
 546 629 a 546 629 a
SDict begin 13 H.A end
 546 629 a 546 629 a
SDict begin [/View [/XYZ H.V]/Dest (0:2542) cvn /DEST pdfmark end
 546
629 a Fj(Retransmit)20 b(messages)g(lost)h(during)d(a)j(f)o(ail-o)o(v)o
(er)m(,)d(if)i(messages)h(need)e(to)h(be)h(reliable.)-2
813 y
SDict begin H.S end
 -2 813 a -2 813 a
SDict begin 13 H.A end
 -2 813 a -2 813 a
SDict begin [/View [/XYZ H.V]/Dest (0:2543) cvn /DEST pdfmark end
 -2 813 a 396
903 a Fj(It')-5 b(s)21 b(not)f(tri)n(vial)g(w)o(ork,)f(and)h(we')l(d)f
(usually)h(wrap)g(this)h(in)f(an)g(API)g(that)h(hides)f(it)h(from)e
(real)h(end-user)f(applications.)-2 1087 y
SDict begin H.S end
 -2 1087 a
-2 1087 a
SDict begin 13 H.A end
 -2 1087 a -2 1087 a
SDict begin [/View [/XYZ H.V]/Dest (0:2544) cvn /DEST pdfmark end
 -2 1087 a 396 1177 a Fj(These)h(are)g
(the)h(main)e(limitations)h(of)g(the)h(Binary)e(Star)i(pattern:)-2
1195 y
SDict begin H.S end
 -2 1195 a -2 1195 a
SDict begin 13 H.A end
 -2 1195 a -2 1195 a
SDict begin [/View [/XYZ H.V]/Dest (0:2545) cvn /DEST pdfmark end
 -2 1195
a -2 1205 a
SDict begin H.S end
 -2 1205 a -2 1205 a
SDict begin 13 H.A end
 -2 1205 a -2 1205 a
SDict begin [/View [/XYZ H.V]/Dest (0:2546) cvn /DEST pdfmark end
 -2
1205 a Black 396 1347 a Fe(\225)p Black 479 1347 a
SDict begin H.S end
 479
1347 a 479 1347 a
SDict begin 13 H.A end
 479 1347 a 479 1347 a
SDict begin [/View [/XYZ H.V]/Dest (0:2547) cvn /DEST pdfmark end
 479 1347 a Fj(A)g(serv)o(er)e
(process)h(cannot)f(be)h(part)g(of)g(more)f(than)h(one)g(Binary)f(Star)
i(pair)-5 b(.)-2 1365 y
SDict begin H.S end
 -2 1365 a -2 1365 a
SDict begin 13 H.A end
 -2 1365 a
-2 1365 a
SDict begin [/View [/XYZ H.V]/Dest (0:2548) cvn /DEST pdfmark end
 -2 1365 a Black 396 1496 a Fe(\225)p Black
479 1496 a
SDict begin H.S end
 479 1496 a 479 1496 a
SDict begin 13 H.A end
 479 1496 a 479 1496
a
SDict begin [/View [/XYZ H.V]/Dest (0:2549) cvn /DEST pdfmark end
 479 1496 a Fj(A)21 b(primary)e(serv)o(er)g(can)h(ha)n(v)o(e)f(a)i
(single)f(backup)f(serv)o(er)m(,)f(no)i(more.)-2 1514
y
SDict begin H.S end
 -2 1514 a -2 1514 a
SDict begin 13 H.A end
 -2 1514 a -2 1514 a
SDict begin [/View [/XYZ H.V]/Dest (0:2550) cvn /DEST pdfmark end
 -2 1514 a Black
396 1646 a Fe(\225)p Black 479 1646 a
SDict begin H.S end
 479 1646 a 479
1646 a
SDict begin 13 H.A end
 479 1646 a 479 1646 a
SDict begin [/View [/XYZ H.V]/Dest (0:2551) cvn /DEST pdfmark end
 479 1646 a Fj(The)g(backup)f(serv)o(er)g
(cannot)g(do)h(useful)g(w)o(ork)f(while)h(in)h(sla)n(v)o(e)f(mode.)-2
1664 y
SDict begin H.S end
 -2 1664 a -2 1664 a
SDict begin 13 H.A end
 -2 1664 a -2 1664 a
SDict begin [/View [/XYZ H.V]/Dest (0:2552) cvn /DEST pdfmark end
 -2 1664
a Black 396 1795 a Fe(\225)p Black 479 1795 a
SDict begin H.S end
 479 1795
a 479 1795 a
SDict begin 13 H.A end
 479 1795 a 479 1795 a
SDict begin [/View [/XYZ H.V]/Dest (0:2553) cvn /DEST pdfmark end
 479 1795 a Fj(The)g(backup)f(serv)o
(er)g(must)h(be)g(capable)g(of)g(handling)e(full)i(application)f
(loads.)-2 1813 y
SDict begin H.S end
 -2 1813 a -2 1813 a
SDict begin 13 H.A end
 -2 1813 a -2 1813
a
SDict begin [/View [/XYZ H.V]/Dest (0:2554) cvn /DEST pdfmark end
 -2 1813 a Black 396 1945 a Fe(\225)p Black 479 1945
a
SDict begin H.S end
 479 1945 a 479 1945 a
SDict begin 13 H.A end
 479 1945 a 479 1945 a
SDict begin [/View [/XYZ H.V]/Dest (0:2555) cvn /DEST pdfmark end
 479 1945
a Fj(F)o(ailo)o(v)o(er)g(con\002guration)f(cannot)h(be)h(modi\002ed)f
(at)h(runtime.)-2 1963 y
SDict begin H.S end
 -2 1963 a -2 1963 a
SDict begin 13 H.A end
 -2 1963
a -2 1963 a
SDict begin [/View [/XYZ H.V]/Dest (0:2556) cvn /DEST pdfmark end
 -2 1963 a Black 396 2094 a Fe(\225)p Black
479 2094 a
SDict begin H.S end
 479 2094 a 479 2094 a
SDict begin 13 H.A end
 479 2094 a 479 2094
a
SDict begin [/View [/XYZ H.V]/Dest (0:2557) cvn /DEST pdfmark end
 479 2094 a Fj(Client)h(applications)e(must)h(do)g(some)g(w)o(ork)g
(to)g(bene\002t)g(from)f(f)o(ail-o)o(v)o(er)-5 b(.)-2
2154 y
SDict begin H.S end
 -2 2154 a -2 2154 a
SDict begin 13 H.A end
 -2 2154 a -2 2154 a
SDict begin [/View [/XYZ H.V]/Dest (0:2558) cvn /DEST pdfmark end
 -2 2154
a 396 2464 a Fd(4.13.3.)36 b(Pre)n(venting)e(Split-Brain)g(Syndr)n(ome)
2664 2464 y
SDict begin H.S end
 2664 2464 a 2664 2464 a
SDict begin 18.72 H.A end
 2664 2464 a 2664
2464 a
SDict begin [/View [/XYZ H.V]/Dest (9.52.27.2) cvn /DEST pdfmark end
 2664 2464 a -2 2656 a
SDict begin H.S end
 -2 2656 a -2 2656 a
SDict begin 13 H.A end
 -2 2656
a -2 2656 a
SDict begin [/View [/XYZ H.V]/Dest (0:2560) cvn /DEST pdfmark end
 -2 2656 a 396 2738 a Fj("Split-brain)19 b(syndrome")f(is)j
(when)f(dif)n(ferent)e(parts)i(of)g(a)h(cluster)f(think)g(the)o(y)f
(are)h('master')g(at)g(the)g(same)h(time.)f(It)396 2846
y(causes)h(applications)e(to)h(stop)g(seeing)g(each)g(other)-5
b(.)19 b(Binary)h(Star)h(has)f(an)g(algorithm)f(for)g(detecting)h(and)f
(eliminating)396 2954 y(split)i(brain,)e(based)h(on)g(a)g(three-w)o(ay)
f(decision)h(mechanism)f(\(a)h(serv)o(er)f(will)i(not)f(decide)f(to)i
(become)e(master)h(until)g(it)396 3061 y(gets)h(application)d
(connection)h(requests)g(and)h(it)h(cannot)e(see)i(its)g(peer)f(serv)o
(er\).)-2 3245 y
SDict begin H.S end
 -2 3245 a -2 3245 a
SDict begin 13 H.A end
 -2 3245 a -2 3245
a
SDict begin [/View [/XYZ H.V]/Dest (0:2561) cvn /DEST pdfmark end
 -2 3245 a 396 3335 a Fj(Ho)n(we)n(v)o(er)f(it)i(is)g(still)g
(possible)f(to)h(\(mis\)design)d(a)j(netw)o(ork)e(to)h(fool)g(this)h
(algorithm.)d(A)j(typical)e(scenario)h(w)o(ould)f(a)396
3443 y(Binary)h(Star)h(pair)e(distrib)n(uted)h(between)f(tw)o(o)h(b)n
(uildings,)f(where)h(each)g(b)n(uilding)f(also)h(had)g(a)g(set)h(of)f
(applications,)396 3551 y(and)g(there)g(w)o(as)h(a)f(single)g(netw)o
(ork)f(link)h(between)g(both)f(b)n(uildings.)g(Breaking)g(this)i(link)f
(w)o(ould)f(create)h(tw)o(o)h(sets)g(of)396 3659 y(client)f
(applications,)f(each)h(with)g(half)g(of)g(the)g(Binary)g(Star)h(pair)m
(,)e(and)h(each)f(f)o(ail-o)o(v)o(er)g(serv)o(er)g(w)o(ould)h(become)e
(acti)n(v)o(e.)-2 3843 y
SDict begin H.S end
 -2 3843 a -2 3843 a
SDict begin 13 H.A end
 -2 3843
a -2 3843 a
SDict begin [/View [/XYZ H.V]/Dest (0:2562) cvn /DEST pdfmark end
 -2 3843 a 396 3933 a Fj(T)-7 b(o)21 b(pre)n(v)o(ent)d
(split-brain)h(situations,)h(we)1608 3933 y
SDict begin H.S end
 1608 3933
a 1608 3933 a
SDict begin 13 H.A end
 1608 3933 a 1608 3933 a
SDict begin [/View [/XYZ H.V]/Dest (0:2563) cvn /DEST pdfmark end
 1608 3933 a Fi(MUST)27
b Fj(connect)19 b(Binary)h(Star)h(pairs)f(using)f(a)i(dedicated)e(netw)
o(ork)g(link,)396 4041 y(which)h(can)g(be)g(as)h(simple)f(as)h
(plugging)d(them)i(both)f(into)h(the)g(same)h(switch)f(or)g(better)m(,)
f(using)h(a)h(cross-o)o(v)o(er)d(cable)396 4149 y(directly)i(between)f
(tw)o(o)h(machines.)-2 4333 y
SDict begin H.S end
 -2 4333 a -2 4333 a
SDict begin 13 H.A end
 -2
4333 a -2 4333 a
SDict begin [/View [/XYZ H.V]/Dest (0:2564) cvn /DEST pdfmark end
 -2 4333 a 396 4423 a Fj(W)-7 b(e)22
b(must)e(not)g(split)g(a)h(Binary)f(Star)g(architecture)f(into)h(tw)o
(o)g(islands,)h(each)e(with)i(a)f(set)h(of)f(applications.)f(While)i
(this)396 4531 y(may)f(be)g(a)h(common)d(type)i(of)g(netw)o(ork)f
(architecture,)f(we')l(d)i(use)g(federation,)e(not)i(high-a)n(v)n
(ailability)e(f)o(ail-o)o(v)o(er)m(,)g(in)396 4639 y(such)i(cases.)-2
4806 y
SDict begin H.S end
 -2 4806 a -2 4806 a
SDict begin 13 H.A end
 -2 4806 a -2 4806 a
SDict begin [/View [/XYZ H.V]/Dest (0:2565) cvn /DEST pdfmark end
 -2 4806
a 396 4913 a Fj(A)h(suitably)f(paranoid)e(netw)o(ork)h(con\002guration)
e(w)o(ould)j(use)g(tw)o(o)h(pri)n(v)n(ate)e(cluster)h(interconnects,)e
(rather)i(than)f(a)396 5021 y(single)h(one.)g(Further)m(,)e(the)j(netw)
o(ork)e(cards)g(used)h(for)g(the)g(cluster)g(w)o(ould)g(be)g(dif)n
(ferent)e(to)j(those)f(used)g(for)f(message)396 5129
y(in/out,)h(and)f(possibly)h(e)n(v)o(en)f(on)h(dif)n(ferent)e(PCI)j
(paths)f(on)g(the)g(serv)o(er)f(hardw)o(are.)g(The)h(goal)g(being)f(to)
h(separate)p Black 3759 5569 a Fi(215)p Black eop end
%%Page: 216 230
TeXDict begin 216 229 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.216) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2586) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 396 72 a Fj(possible)20 b(f)o(ailures)g(in)g
(the)h(netw)o(ork)e(from)g(possible)h(f)o(ailures)g(in)g(the)g(cluster)
-5 b(.)20 b(Netw)o(ork)g(ports)g(ha)n(v)o(e)f(a)i(relati)n(v)o(ely)e
(high)396 180 y(f)o(ailure)h(rate.)-2 191 y
SDict begin H.S end
 -2 191 a
-2 191 a
SDict begin 13 H.A end
 -2 191 a -2 191 a
SDict begin [/View [/XYZ H.V]/Dest (0:2566) cvn /DEST pdfmark end
 -2 191 a 396 519 a Fd(4.13.4.)36
b(Binar)q(y)f(Star)d(Implementation)2348 519 y
SDict begin H.S end
 2348 519
a 2348 519 a
SDict begin 18.72 H.A end
 2348 519 a 2348 519 a
SDict begin [/View [/XYZ H.V]/Dest (9.52.28.2) cvn /DEST pdfmark end
 2348 519 a -2 710
a
SDict begin H.S end
 -2 710 a -2 710 a
SDict begin 13 H.A end
 -2 710 a -2 710 a
SDict begin [/View [/XYZ H.V]/Dest (0:2568) cvn /DEST pdfmark end
 -2 710 a 396 793
a Fj(W)m(ithout)20 b(further)e(ado,)i(here)g(is)h(a)f(proof-of-concept)
15 b(implementation)j(of)i(the)h(Binary)e(Star)i(serv)o(er:)-2
811 y
SDict begin H.S end
 -2 811 a -2 811 a
SDict begin 13 H.A end
 -2 811 a -2 811 a
SDict begin [/View [/XYZ H.V]/Dest (0:bstarsrv-php) cvn /DEST pdfmark
end
 -2 811 a 396
994 a Fk(Example)g(4-18.)d(Binary)j(Star)f(ser)o(v)o(er)g(\(bstarsr)o
(v)-6 b(.php\))-2 1094 y
SDict begin H.S end
 -2 1094 a -2 1094 a
SDict begin 11.7 H.A end
 -2 1094
a -2 1094 a
SDict begin [/View [/XYZ H.V]/Dest (0:2571) cvn /DEST pdfmark end
 -2 1094 a 396 1174 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 1352 y
SDict begin H.S end
 -2 1352
a -2 1352 a
SDict begin 13 H.A end
 -2 1352 a -2 1352 a
SDict begin [/View [/XYZ H.V]/Dest (0:2572) cvn /DEST pdfmark end
 -2 1352 a 396 1448 a
Fj(And)20 b(here)g(is)h(the)f(client:)-2 1449 y
SDict begin H.S end
 -2 1449
a -2 1449 a
SDict begin 13 H.A end
 -2 1449 a -2 1449 a
SDict begin [/View [/XYZ H.V]/Dest (0:bstarcli-php) cvn /DEST pdfmark
end
 -2 1449 a 396 1650 a
Fk(Example)h(4-19.)d(Binary)j(Star)f(client)g(\(bstar)o(cli.php\))-2
1750 y
SDict begin H.S end
 -2 1750 a -2 1750 a
SDict begin 11.7 H.A end
 -2 1750 a -2 1750 a
SDict begin [/View [/XYZ H.V]/Dest (0:2575) cvn /DEST pdfmark end
 -2 1750
a 396 1830 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 2007 y
SDict begin H.S end
 -2 2007 a -2 2007 a
SDict begin 13 H.A end
 -2 2007 a
-2 2007 a
SDict begin [/View [/XYZ H.V]/Dest (0:2576) cvn /DEST pdfmark end
 -2 2007 a 396 2104 a Fj(T)-7 b(o)21 b(test)g(Binary)e(Star)m
(,)h(start)h(the)f(serv)o(ers)g(and)g(client)g(in)g(an)o(y)g(order:)-2
2205 y
SDict begin H.S end
 -2 2205 a -2 2205 a
SDict begin 11.7 H.A end
 -2 2205 a -2 2205 a
SDict begin [/View [/XYZ H.V]/Dest (0:2577) cvn /DEST pdfmark end
 -2 2205
a 396 2284 a Fg(bstarsrv)44 b(-p)224 b(#)44 b(Start)g(primary)396
2381 y(bstarsrv)g(-b)224 b(#)44 b(Start)g(backup)396
2478 y(bstarcli)-2 2645 y
SDict begin H.S end
 -2 2645 a -2 2645 a
SDict begin 13 H.A end
 -2 2645
a -2 2645 a
SDict begin [/View [/XYZ H.V]/Dest (0:2578) cvn /DEST pdfmark end
 -2 2645 a 396 2752 a Fj(Y)-9 b(ou)20 b(can)g(then)g(pro)o
(v)n(ok)o(e)e(f)o(ail-o)o(v)o(er)g(by)i(killing)f(the)i(primary)d(serv)
o(er)m(,)h(and)h(reco)o(v)o(ery)d(by)j(restarting)f(the)h(primary)f
(and)396 2860 y(killing)h(the)g(backup.)e(Note)j(ho)n(w)e(it')-5
b(s)21 b(the)g(client)f(v)n(ote)g(that)g(triggers)g(f)o(ail-o)o(v)o(er)
m(,)d(and)j(reco)o(v)o(ery)-5 b(.)-2 3044 y
SDict begin H.S end
 -2 3044 a
-2 3044 a
SDict begin 13 H.A end
 -2 3044 a -2 3044 a
SDict begin [/View [/XYZ H.V]/Dest (0:2579) cvn /DEST pdfmark end
 -2 3044 a 396 3134 a Fj(Binary)20
b(star)h(is)g(dri)n(v)o(en)d(by)i(a)h(\002nite)f(state)h(machine\()p
0 TeXcolorgray 1926 3134 a
SDict begin H.S end
 1926 3134 a Fj(Figure)d(4-8)2274
3134 y
SDict begin 13 H.L end
 2274 3134 a 2274 3134 a
SDict begin [/Subtype /Link/Dest (0:figure-60) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2274 3134 a Black -2 w
Fj(\).)i(States)h(in)g(green)e(accept)h(client)g(requests,)g(states)h
(in)396 3242 y(pink)e(refuse)g(them.)g(Ev)o(ents)g(are)g(the)h(peer)f
(state,)h(so)g("Peer)f(Acti)n(v)o(e")g(means)h(the)f(other)g(serv)o(er)
g(has)h(told)f(us)h(it')-5 b(s)20 b(acti)n(v)o(e.)396
3350 y("Client)h(Request")f(means)g(we')l(v)o(e)f(recei)n(v)o(ed)g(a)h
(client)h(request.)e("Client)h(V)-11 b(ote")21 b(means)f(we')l(v)o(e)f
(recei)n(v)o(ed)f(a)j(client)396 3458 y(request)f(AND)g(our)g(peer)f
(is)j(inacti)n(v)o(e)d(for)g(tw)o(o)i(heartbeats.)-2
3476 y
SDict begin H.S end
 -2 3476 a -2 3476 a
SDict begin 13 H.A end
 -2 3476 a -2 3476 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-60) cvn /DEST pdfmark
end
 -2 3476
a Black 3757 5569 a Fi(216)p Black eop end
%%Page: 217 231
TeXDict begin 217 230 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.217) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-8.)f(Binary)h(Star)g
(Finite)g(State)g(Machine)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end

-2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2583) cvn /DEST pdfmark end
 -2 172 a 396 2022 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2022 a @beginspecial
0 @llx -217 @lly 390 @urx 0 @ury 3900 @rwi @setspecial
%%BeginDocument: images/fig60.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -217 390 0
%%HiResBoundingBox: 0.0 -217.0 390.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
13.500149726867676 -39.50014877319336 moveto
13.500149726867676 -74.50015258789062 lineto
73.50015258789062 -74.50015258789062 lineto
73.50015258789062 -39.50014877319336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.50015258789062 -39.50014877319336 moveto
163.50015258789062 -74.50015258789062 lineto
223.50015258789062 -74.50015258789062 lineto
223.50015258789062 -39.50014877319336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
318.5001525878906 -39.50014877319336 moveto
318.5001525878906 -74.50015258789062 lineto
378.5001525878906 -74.50015258789062 lineto
378.5001525878906 -39.50014877319336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.50015258789062 -165.50015258789062 moveto
163.50015258789062 -200.50015258789062 lineto
223.50015258789062 -200.50015258789062 lineto
223.50015258789062 -165.50015258789062 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.50015258789062 -102.50015258789062 moveto
163.50015258789062 -137.50015258789062 lineto
223.50015258789062 -137.50015258789062 lineto
223.50015258789062 -102.50015258789062 lineto
closepath
fill
0.5647058823529412 0.9411764705882353 0.6901960784313725 setrgbcolor
newpath
12.0 -38.0 moveto
12.0 -73.0 lineto
72.0 -73.0 lineto
72.0 -38.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.5 setlinewidth
1 setlinecap
[] 0 setdash
newpath
12.0 -38.0 moveto
12.0 -73.0 lineto
72.0 -73.0 lineto
72.0 -38.0 lineto
closepath
stroke
0.5647058823529412 0.9411764705882353 0.6901960784313725 setrgbcolor
newpath
162.0 -38.0 moveto
162.0 -73.0 lineto
222.0 -73.0 lineto
222.0 -38.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
162.0 -38.0 moveto
162.0 -73.0 lineto
222.0 -73.0 lineto
222.0 -38.0 lineto
closepath
stroke
0.9411764705882353 0.5647058823529412 0.6901960784313725 setrgbcolor
newpath
317.0 -38.0 moveto
317.0 -73.0 lineto
377.0 -73.0 lineto
377.0 -38.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
317.0 -38.0 moveto
317.0 -73.0 lineto
377.0 -73.0 lineto
377.0 -38.0 lineto
closepath
stroke
0.9411764705882353 0.5647058823529412 0.6901960784313725 setrgbcolor
newpath
162.0 -164.0 moveto
162.0 -199.0 lineto
222.0 -199.0 lineto
222.0 -164.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
162.0 -164.0 moveto
162.0 -199.0 lineto
222.0 -199.0 lineto
222.0 -164.0 lineto
closepath
stroke
0.9411764705882353 0.0 0.0 setrgbcolor
newpath
162.0 -101.0 moveto
162.0 -136.0 lineto
222.0 -136.0 lineto
222.0 -101.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
162.0 -101.0 moveto
162.0 -136.0 lineto
222.0 -136.0 lineto
222.0 -101.0 lineto
closepath
stroke
newpath
42.0 -21.0 moveto
42.0 -31.0 lineto
stroke
newpath
347.0 -21.0 moveto
347.0 -31.0 lineto
stroke
newpath
182.0 -31.0 moveto
182.0 -21.0 lineto
182.0 -18.333333333333332 181.33333333333334 -17.0 180.0 -17.0 curveto
65.0 -17.0 lineto
65.0 -17.0 lineto
63.0 -17.0 62.0 -18.333333333333332 62.0 -21.0 curveto
62.0 -38.0 lineto
62.0 -38.0 lineto
stroke
newpath
72.0 -52.0 moveto
157.0 -52.0 lineto
stroke
newpath
42.0 -73.0 moveto
42.0 -182.0 lineto
42.0 -184.0 43.0 -185.0 45.0 -185.0 curveto
157.0 -185.0 lineto
157.0 -185.0 lineto
stroke
newpath
347.0 -73.0 moveto
347.0 -182.0 lineto
347.0 -184.0 346.3333333333333 -185.0 345.0 -185.0 curveto
227.0 -185.0 lineto
227.0 -185.0 lineto
stroke
newpath
227.0 -52.0 moveto
300.0 -52.0 lineto
301.3333333333333 -52.0 302.0 -53.333333333333336 302.0 -56.0 curveto
302.0 -175.0 lineto
302.0 -175.0 lineto
302.0 -177.0 301.3333333333333 -178.0 300.0 -178.0 curveto
222.0 -178.0 lineto
222.0 -178.0 lineto
stroke
newpath
157.0 -59.0 moveto
125.0 -59.0 lineto
123.0 -59.0 122.0 -60.333333333333336 122.0 -63.0 curveto
122.0 -175.0 lineto
122.0 -175.0 lineto
122.0 -177.0 123.0 -178.0 125.0 -178.0 curveto
162.0 -178.0 lineto
162.0 -178.0 lineto
stroke
newpath
227.0 -59.0 moveto
255.0 -59.0 lineto
256.3333333333333 -59.0 257.0 -60.333333333333336 257.0 -63.0 curveto
257.0 -168.0 lineto
257.0 -168.0 lineto
257.0 -170.0 256.3333333333333 -171.0 255.0 -171.0 curveto
222.0 -171.0 lineto
222.0 -171.0 lineto
stroke
newpath
192.0 -143.0 moveto
192.0 -164.0 lineto
stroke
newpath
40.0 -28.0 moveto
42.0 -35.0 lineto
45.0 -28.0 lineto
closepath
fill
newpath
180.0 -28.0 moveto
182.0 -35.0 lineto
185.0 -28.0 lineto
closepath
fill
newpath
200.0 -28.0 moveto
202.0 -35.0 lineto
205.0 -28.0 lineto
closepath
fill
newpath
345.0 -28.0 moveto
347.0 -35.0 lineto
350.0 -28.0 lineto
closepath
fill
newpath
155.0 -49.0 moveto
160.0 -52.0 lineto
155.0 -56.0 lineto
closepath
fill
newpath
230.0 -49.0 moveto
225.0 -52.0 lineto
230.0 -56.0 lineto
closepath
fill
newpath
155.0 -56.0 moveto
160.0 -59.0 lineto
155.0 -63.0 lineto
closepath
fill
newpath
230.0 -56.0 moveto
225.0 -59.0 lineto
230.0 -63.0 lineto
closepath
fill
newpath
190.0 -91.0 moveto
192.0 -98.0 lineto
195.0 -91.0 lineto
closepath
fill
newpath
192.0 -140.0 moveto
190.0 -147.0 lineto
195.0 -147.0 lineto
closepath
fill
newpath
155.0 -182.0 moveto
160.0 -185.0 lineto
155.0 -189.0 lineto
closepath
fill
newpath
230.0 -182.0 moveto
225.0 -185.0 lineto
230.0 -189.0 lineto
closepath
fill
newpath
202.0 -31.0 moveto
202.0 -21.0 lineto
202.0 -18.333333333333332 203.0 -17.0 205.0 -17.0 curveto
255.0 -17.0 lineto
255.0 -17.0 lineto
256.3333333333333 -17.0 257.0 -18.333333333333332 257.0 -21.0 curveto
257.0 -42.0 lineto
257.0 -42.0 lineto
257.0 -44.0 256.3333333333333 -45.0 255.0 -45.0 curveto
222.0 -45.0 lineto
222.0 -45.0 lineto
stroke
newpath
192.0 -94.0 moveto
192.0 -73.0 lineto
stroke
/Helvetica findfont
7 scalefont setfont
33.0 -21.0 moveto
(Start) show
338.0 -21.0 moveto
(Start) show
72.0 -28.0 moveto
(Client Request) show
232.0 -28.0 moveto
(Client Request) show
83.0 -49.0 moveto
(Peer Backup) show
27.0 -56.0 moveto
(Primary) show
178.0 -56.0 moveto
(Active) show
331.0 -56.0 moveto
(Backup) show
25.0 -91.0 moveto
(Peer Active) show
175.0 -91.0 moveto
(Peer Active) show
330.0 -91.0 moveto
(Peer Active) show
103.0 -119.0 moveto
(Peer Backup) show
179.0 -119.0 moveto
(Error!) show
240.0 -119.0 moveto
(Peer Primary) show
175.0 -154.0 moveto
(Peer Passive) show
276.0 -154.0 moveto
(Client Vote) show
177.0 -182.0 moveto
(Passive) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2022 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2022 a 274 x Fj(Note)g(that)h(the)f(serv)o
(ers)g(use)g(PUB-SUB)h(sock)o(ets)g(for)e(state)i(e)o(xchange.)d(No)i
(other)f(sock)o(et)i(combination)c(will)k(w)o(ork)396
2404 y(here.)f(PUSH)h(and)e(DEALER)h(block)g(if)g(there)g(is)h(no)f
(peer)f(ready)h(to)g(recei)n(v)o(e)f(a)i(message.)e(P)-8
b(AIR)22 b(does)e(not)f(reconnect)396 2512 y(if)i(the)f(peer)g
(disappears)f(and)g(comes)h(back.)g(R)m(OUTER)g(needs)g(the)g(address)g
(of)g(the)g(peer)g(before)e(it)j(can)f(send)g(it)h(a)396
2620 y(message.)-2 2804 y
SDict begin H.S end
 -2 2804 a -2 2804 a
SDict begin 13 H.A end
 -2 2804
a -2 2804 a
SDict begin [/View [/XYZ H.V]/Dest (0:2587) cvn /DEST pdfmark end
 -2 2804 a 396 2894 a Fj(These)f(are)g(the)h(main)e
(limitations)h(of)g(the)h(Binary)e(Star)i(pattern:)-2
2912 y
SDict begin H.S end
 -2 2912 a -2 2912 a
SDict begin 13 H.A end
 -2 2912 a -2 2912 a
SDict begin [/View [/XYZ H.V]/Dest (0:2588) cvn /DEST pdfmark end
 -2 2912
a -2 2922 a
SDict begin H.S end
 -2 2922 a -2 2922 a
SDict begin 13 H.A end
 -2 2922 a -2 2922 a
SDict begin [/View [/XYZ H.V]/Dest (0:2589) cvn /DEST pdfmark end
 -2
2922 a Black 396 3064 a Fe(\225)p Black 479 3064 a
SDict begin H.S end
 479
3064 a 479 3064 a
SDict begin 13 H.A end
 479 3064 a 479 3064 a
SDict begin [/View [/XYZ H.V]/Dest (0:2590) cvn /DEST pdfmark end
 479 3064 a Fj(A)g(serv)o(er)e
(process)h(cannot)f(be)h(part)g(of)g(more)f(than)h(one)g(Binary)f(Star)
i(pair)-5 b(.)-2 3082 y
SDict begin H.S end
 -2 3082 a -2 3082 a
SDict begin 13 H.A end
 -2 3082 a
-2 3082 a
SDict begin [/View [/XYZ H.V]/Dest (0:2591) cvn /DEST pdfmark end
 -2 3082 a Black 396 3214 a Fe(\225)p Black
479 3214 a
SDict begin H.S end
 479 3214 a 479 3214 a
SDict begin 13 H.A end
 479 3214 a 479 3214
a
SDict begin [/View [/XYZ H.V]/Dest (0:2592) cvn /DEST pdfmark end
 479 3214 a Fj(A)21 b(primary)e(serv)o(er)g(can)h(ha)n(v)o(e)f(a)i
(single)f(backup)f(serv)o(er)m(,)f(no)i(more.)-2 3232
y
SDict begin H.S end
 -2 3232 a -2 3232 a
SDict begin 13 H.A end
 -2 3232 a -2 3232 a
SDict begin [/View [/XYZ H.V]/Dest (0:2593) cvn /DEST pdfmark end
 -2 3232 a Black
396 3363 a Fe(\225)p Black 479 3363 a
SDict begin H.S end
 479 3363 a 479
3363 a
SDict begin 13 H.A end
 479 3363 a 479 3363 a
SDict begin [/View [/XYZ H.V]/Dest (0:2594) cvn /DEST pdfmark end
 479 3363 a Fj(The)g(backup)f(serv)o(er)g
(cannot)g(do)h(useful)g(w)o(ork)f(while)h(in)h(sla)n(v)o(e)f(mode.)-2
3381 y
SDict begin H.S end
 -2 3381 a -2 3381 a
SDict begin 13 H.A end
 -2 3381 a -2 3381 a
SDict begin [/View [/XYZ H.V]/Dest (0:2595) cvn /DEST pdfmark end
 -2 3381
a Black 396 3512 a Fe(\225)p Black 479 3512 a
SDict begin H.S end
 479 3512
a 479 3512 a
SDict begin 13 H.A end
 479 3512 a 479 3512 a
SDict begin [/View [/XYZ H.V]/Dest (0:2596) cvn /DEST pdfmark end
 479 3512 a Fj(The)g(backup)f(serv)o
(er)g(must)h(be)g(capable)g(of)g(handling)e(full)i(application)f
(loads.)-2 3530 y
SDict begin H.S end
 -2 3530 a -2 3530 a
SDict begin 13 H.A end
 -2 3530 a -2 3530
a
SDict begin [/View [/XYZ H.V]/Dest (0:2597) cvn /DEST pdfmark end
 -2 3530 a Black 396 3662 a Fe(\225)p Black 479 3662
a
SDict begin H.S end
 479 3662 a 479 3662 a
SDict begin 13 H.A end
 479 3662 a 479 3662 a
SDict begin [/View [/XYZ H.V]/Dest (0:2598) cvn /DEST pdfmark end
 479 3662
a Fj(F)o(ailo)o(v)o(er)g(con\002guration)f(cannot)h(be)h(modi\002ed)f
(at)h(runtime.)-2 3680 y
SDict begin H.S end
 -2 3680 a -2 3680 a
SDict begin 13 H.A end
 -2 3680
a -2 3680 a
SDict begin [/View [/XYZ H.V]/Dest (0:2599) cvn /DEST pdfmark end
 -2 3680 a Black 396 3811 a Fe(\225)p Black
479 3811 a
SDict begin H.S end
 479 3811 a 479 3811 a
SDict begin 13 H.A end
 479 3811 a 479 3811
a
SDict begin [/View [/XYZ H.V]/Dest (0:2600) cvn /DEST pdfmark end
 479 3811 a Fj(Client)h(applications)e(must)h(do)g(some)g(w)o(ork)g
(to)g(bene\002t)g(from)f(f)o(ail-o)o(v)o(er)-5 b(.)-2
3871 y
SDict begin H.S end
 -2 3871 a -2 3871 a
SDict begin 13 H.A end
 -2 3871 a -2 3871 a
SDict begin [/View [/XYZ H.V]/Dest (0:2601) cvn /DEST pdfmark end
 -2 3871
a 396 4181 a Fd(4.13.5.)36 b(Binar)q(y)f(Star)d(Reactor)1911
4181 y
SDict begin H.S end
 1911 4181 a 1911 4181 a
SDict begin 18.72 H.A end
 1911 4181 a 1911 4181
a
SDict begin [/View [/XYZ H.V]/Dest (9.52.29.2) cvn /DEST pdfmark end
 1911 4181 a -2 4372 a
SDict begin H.S end
 -2 4372 a -2 4372 a
SDict begin 13 H.A end
 -2 4372 a
-2 4372 a
SDict begin [/View [/XYZ H.V]/Dest (0:2603) cvn /DEST pdfmark end
 -2 4372 a 396 4455 a Fj(Binary)20 b(Star)h(is)g(useful)e(and)
h(generic)f(enough)f(to)j(package)d(up)i(as)h(a)g(reusable)e(reactor)g
(class.)i(The)f(reactor)f(then)h(runs)396 4563 y(and)g(calls)h(our)e
(code)h(whene)n(v)o(er)e(it)j(has)f(a)h(message)f(to)g(process.)g(This)
g(is)h(much)e(nicer)h(than)g(cop)o(ying/pasting)d(the)396
4671 y(Binary)j(Star)h(code)e(into)h(each)g(serv)o(er)f(where)h(we)g(w)
o(ant)h(that)f(capability)-5 b(.)18 b(In)i(C)h(we)g(wrap)f(the)g(CZMQ)
3405 4671 y
SDict begin H.S end
 3405 4671 a 3405 4671 a
SDict begin 13 H.A end
 3405 4671 a 3405
4671 a
SDict begin [/View [/XYZ H.V]/Dest (0:2604) cvn /DEST pdfmark end
 3405 4671 a Fg(zloop)f Fj(class,)396 4779 y(though)g(your)g
(mileage)g(may)h(v)n(ary)f(in)h(other)g(languages.)e(Here)i(is)i(the)
2465 4779 y
SDict begin H.S end
 2465 4779 a 2465 4779 a
SDict begin 13 H.A end
 2465 4779 a 2465
4779 a
SDict begin [/View [/XYZ H.V]/Dest (0:2605) cvn /DEST pdfmark end
 2465 4779 a Fg(bstar)e Fj(API:)-2 4880 y
SDict begin H.S end
 -2 4880
a -2 4880 a
SDict begin 11.7 H.A end
 -2 4880 a -2 4880 a
SDict begin [/View [/XYZ H.V]/Dest (0:2606) cvn /DEST pdfmark end
 -2 4880 a 396 4959 a
Fg(//)90 b(Create)43 b(a)i(new)f(Binary)g(Star)g(instance,)g(using)g
(local)g(\(bind\))g(and)396 5056 y(//)90 b(remote)43
b(\(connect\))h(endpoints)f(to)i(set-up)e(the)i(server)f(peering.)396
5153 y(bstar_t)755 5166 y(*)800 5153 y(bstar_new)f(\(int)h(primary,)g
(char)2100 5166 y(*)2145 5153 y(local,)g(char)2683 5166
y(*)2728 5153 y(remote\);)p Black 3756 5569 a Fi(217)p
Black eop end
%%Page: 218 232
TeXDict begin 218 231 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.218) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 170 a Fg(//)90 b(Destroy)43 b(a)i(Binary)f(Star)g
(instance)396 267 y(void)g(bstar_destroy)f(\(bstar_t)1652
280 y(**)1742 267 y(self_p\);)396 461 y(//)90 b(Return)43
b(underlying)h(zloop)g(reactor,)f(for)h(timer)g(and)h(reader)396
558 y(//)90 b(registration)42 b(and)j(cancelation.)396
655 y(zloop_t)755 668 y(*)800 655 y(bstar_zloop)e(\(bstar_t)1741
668 y(*)1786 655 y(self\);)396 850 y(//)90 b(Register)43
b(voting)h(reader)396 947 y(int)h(bstar_voter)e(\(bstar_t)1517
960 y(*)1562 947 y(self,)h(char)2055 960 y(*)2100 947
y(endpoint,)f(int)i(type,)1158 1044 y(zloop_fn)f(handler,)f(void)2190
1057 y(*)2235 1044 y(arg\);)396 1238 y(//)90 b(Register)43
b(main)h(state)g(change)g(handlers)396 1335 y(void)g(bstar_new_master)f
(\(bstar_t)1786 1348 y(*)1831 1335 y(self,)h(zloop_fn)f(handler,)h
(void)3131 1348 y(*)3176 1335 y(arg\);)396 1432 y(void)g
(bstar_new_slave)f(\(bstar_t)1741 1445 y(*)1786 1432
y(self,)h(zloop_fn)g(handler,)f(void)3086 1445 y(*)3131
1432 y(arg\);)396 1627 y(//)90 b(Start)44 b(the)g(reactor,)f(ends)i(if)
f(a)h(callback)e(function)h(returns)f(-1,)i(or)f(the)396
1724 y(//)90 b(process)43 b(received)h(SIGINT)g(or)g(SIGTERM.)396
1821 y(int)h(bstar_start)e(\(bstar_t)1517 1834 y(*)1562
1821 y(self\);)-2 1997 y
SDict begin H.S end
 -2 1997 a -2 1997 a
SDict begin 13 H.A end
 -2 1997
a -2 1997 a
SDict begin [/View [/XYZ H.V]/Dest (0:2607) cvn /DEST pdfmark end
 -2 1997 a 396 2095 a Fj(And)20 b(here)g(is)h(the)f(class)h
(implementation:)-2 2113 y
SDict begin H.S end
 -2 2113 a -2 2113 a
SDict begin 13 H.A end
 -2 2113
a -2 2113 a
SDict begin [/View [/XYZ H.V]/Dest (0:bstar-php) cvn /DEST pdfmark
end
 -2 2113 a 396 2296 a Fk(Example)g(4-20.)d(Binary)j(Star)f
(cor)o(e)f(class)i(\(bstar)-8 b(.php\))-2 2396 y
SDict begin H.S end
 -2 2396
a -2 2396 a
SDict begin 11.7 H.A end
 -2 2396 a -2 2396 a
SDict begin [/View [/XYZ H.V]/Dest (0:2610) cvn /DEST pdfmark end
 -2 2396 a 396 2476 a
Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
2654 y
SDict begin H.S end
 -2 2654 a -2 2654 a
SDict begin 13 H.A end
 -2 2654 a -2 2654 a
SDict begin [/View [/XYZ H.V]/Dest (0:2611) cvn /DEST pdfmark end
 -2 2654
a 396 2750 a Fj(Which)20 b(gi)n(v)o(es)g(us)h(the)f(follo)n(wing)e
(short)i(main)g(program)e(for)i(the)g(serv)o(er:)-2 2768
y
SDict begin H.S end
 -2 2768 a -2 2768 a
SDict begin 13 H.A end
 -2 2768 a -2 2768 a
SDict begin [/View [/XYZ H.V]/Dest (0:bstarsrv2-php) cvn /DEST pdfmark
end
 -2 2768 a 396
2952 a Fk(Example)h(4-21.)d(Binary)j(Star)f(ser)o(v)o(er)-8
b(,)20 b(using)h(cor)o(e)e(class)i(\(bstarsr)o(v2.php\))-2
3052 y
SDict begin H.S end
 -2 3052 a -2 3052 a
SDict begin 11.7 H.A end
 -2 3052 a -2 3052 a
SDict begin [/View [/XYZ H.V]/Dest (0:2614) cvn /DEST pdfmark end
 -2 3052
a 396 3132 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 3309 y
SDict begin H.S end
 -2 3309 a -2 3309 a
SDict begin 13 H.A end
 -2 3309 a
-2 3309 a
SDict begin [/View [/XYZ H.V]/Dest (0:2615) cvn /DEST pdfmark end
 -2 3309 a 366 x Fh(4.14.)39 b(Br)m(okerless)e(Reliability)h
(\(Freelance)f(P)l(attern\))3150 3675 y
SDict begin H.S end
 3150 3675 a 3150
3675 a
SDict begin 22.464 H.A end
 3150 3675 a 3150 3675 a
SDict begin [/View [/XYZ H.V]/Dest (9.53.1) cvn /DEST pdfmark end
 3150 3675 a -2 3871 a
SDict begin H.S end

-2 3871 a -2 3871 a
SDict begin 13 H.A end
 -2 3871 a -2 3871 a
SDict begin [/View [/XYZ H.V]/Dest (0:2617) cvn /DEST pdfmark end
 -2 3871 a 396
3949 a Fj(It)21 b(might)e(seem)i(ironic)e(to)h(focus)g(so)h(much)e(on)h
(brok)o(er)n(-based)d(reliability)-5 b(,)19 b(when)h(we)g(often)g(e)o
(xplain)f(\330MQ)h(as)396 4057 y("brok)o(erless)f(messaging".)g(Ho)n
(we)n(v)o(er)g(in)h(messaging,)f(as)i(in)f(real)h(life,)f(the)g
(middleman)e(is)k(both)d(a)h(b)n(urden)f(and)h(a)396
4165 y(bene\002t.)g(In)g(practice,)f(most)h(messaging)f(architectures)g
(bene\002t)h(from)f(a)i(mix)f(of)g(distrib)n(uted)f(and)h(brok)o(ered)
396 4273 y(messaging.)f(Y)-9 b(ou)20 b(get)g(the)g(best)h(results)f
(when)g(you)f(can)h(decide)g(freely)f(what)h(tradeof)n(fs)f(you)g(w)o
(ant)h(to)h(mak)o(e.)e(This)i(is)396 4381 y(why)e(I)h(can)f(dri)n(v)o
(e)f(10km)h(to)g(a)h(wholesaler)f(to)h(b)n(uy)f(\002)n(v)o(e)g(cases)h
(of)g(wine)f(for)g(a)h(party)-5 b(,)18 b(b)n(ut)i(I)f(can)h(also)f(w)o
(alk)h(10)f(minutes)396 4489 y(to)i(a)f(corner)f(store)h(to)h(b)n(uy)e
(one)h(bottle)g(for)f(a)i(dinner)-5 b(.)19 b(Our)h(highly)f(conte)o
(xt-sensiti)n(v)o(e)f(relati)n(v)o(e)h(v)n(aluations)g(of)h(time,)396
4597 y(ener)o(gy)-5 b(,)18 b(and)h(cost)i(are)f(essential)h(to)f(the)g
(real)g(w)o(orld)g(economy)-5 b(.)18 b(And)h(the)o(y)h(are)g(essential)
h(to)f(an)g(optimal)396 4704 y(message-based)f(architecture.)-2
4888 y
SDict begin H.S end
 -2 4888 a -2 4888 a
SDict begin 13 H.A end
 -2 4888 a -2 4888 a
SDict begin [/View [/XYZ H.V]/Dest (0:2618) cvn /DEST pdfmark end
 -2 4888
a 396 4978 a Fj(Which)h(is)h(why)f(\330MQ)g(does)g(not)1392
4978 y
SDict begin H.S end
 1392 4978 a 1392 4978 a
SDict begin 13 H.A end
 1392 4978 a 1392 4978
a
SDict begin [/View [/XYZ H.V]/Dest (0:2619) cvn /DEST pdfmark end
 1392 4978 a Fi(impose)g Fj(a)h(brok)o(er)n(-centric)c(architecture,)h
(though)h(it)i(gi)n(v)o(es)e(you)h(the)g(tools)g(to)h(b)n(uild)396
5086 y(brok)o(ers,)e(aka)h("de)n(vices",)f(and)h(we')l(v)o(e)f(b)n
(uilt)h(a)h(dozen)e(or)h(so)g(dif)n(ferent)f(ones)h(so)g(f)o(ar)m(,)g
(just)h(for)e(practice.)p Black 3759 5569 a Fi(218)p
Black eop end
%%Page: 219 233
TeXDict begin 219 232 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.219) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2638) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2620) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(So)21 b(we')o(ll)f(end)g(this)h
(chapter)e(by)g(deconstructing)f(the)i(brok)o(er)n(-based)e
(reliability)h(we')l(v)o(e)h(b)n(uilt)g(so)h(f)o(ar)m(,)e(and)h
(turning)e(it)396 180 y(back)i(into)g(a)g(distrib)n(uted)g(peer)n
(-to-peer)d(architecture)i(I)h(call)h(the)f(Freelance)g(pattern.)f(Our)
h(use)g(case)h(will)g(be)f(a)g(name)396 288 y(resolution)f(service.)h
(This)g(is)h(a)g(common)d(problem)h(with)h(\330MQ)g(architectures:)f
(ho)n(w)h(do)g(we)g(kno)n(w)g(the)g(endpoint)e(to)396
396 y(connect)h(to?)h(Hard-coding)e(TCP/IP)j(addresses)f(in)g(code)f
(is)j(insanely)d(fragile.)g(Using)h(con\002guration)e(\002les)j
(creates)396 504 y(an)f(administration)f(nightmare.)f(Imagine)h(if)h
(you)g(had)f(to)i(hand-con\002gure)16 b(your)j(web)h(bro)n(wser)m(,)e
(on)i(e)n(v)o(ery)f(PC)i(or)396 612 y(mobile)f(phone)e(you)i(used,)f
(to)i(realize)f(that)g("google.com")d(w)o(as)k("74.125.230.82".)-2
796 y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:2621) cvn /DEST pdfmark end
 -2 796 a 396
886 a Fj(A)g(\330MQ)f(name)g(service)g(\(and)f(we')o(ll)i(mak)o(e)e(a)i
(simple)f(implementation\))e(has)i(to:)-2 904 y
SDict begin H.S end
 -2 904
a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:2622) cvn /DEST pdfmark end
 -2 904 a -2 914 a
SDict begin H.S end
 -2 914
a -2 914 a
SDict begin 13 H.A end
 -2 914 a -2 914 a
SDict begin [/View [/XYZ H.V]/Dest (0:2623) cvn /DEST pdfmark end
 -2 914 a Black 396 1056
a Fe(\225)p Black 479 1056 a
SDict begin H.S end
 479 1056 a 479 1056 a
SDict begin 13 H.A end
 479
1056 a 479 1056 a
SDict begin [/View [/XYZ H.V]/Dest (0:2624) cvn /DEST pdfmark end
 479 1056 a Fj(Resolv)o(e)g(a)h(logical)f(name)f(into)
h(at)h(least)g(a)f(bind)g(endpoint,)e(and)h(a)i(connect)e(endpoint.)f
(A)j(realistic)f(name)g(service)479 1164 y(w)o(ould)g(pro)o(vide)e
(multiple)h(bind)h(endpoints,)e(and)i(possibly)f(multiple)h(connect)f
(endpoints)g(too.)-2 1182 y
SDict begin H.S end
 -2 1182 a -2 1182 a
SDict begin 13 H.A end
 -2 1182
a -2 1182 a
SDict begin [/View [/XYZ H.V]/Dest (0:2625) cvn /DEST pdfmark end
 -2 1182 a Black 396 1314 a Fe(\225)p Black
479 1314 a
SDict begin H.S end
 479 1314 a 479 1314 a
SDict begin 13 H.A end
 479 1314 a 479 1314
a
SDict begin [/View [/XYZ H.V]/Dest (0:2626) cvn /DEST pdfmark end
 479 1314 a Fj(Allo)n(w)i(us)f(to)g(manage)f(multiple)h(parallel)g(en)
m(vironments,)d(e.g.)i("test")i(vs.)g("production")c(without)i
(modifying)479 1422 y(code.)-2 1423 y
SDict begin H.S end
 -2 1423 a -2 1423
a
SDict begin 13 H.A end
 -2 1423 a -2 1423 a
SDict begin [/View [/XYZ H.V]/Dest (0:2627) cvn /DEST pdfmark end
 -2 1423 a Black 396 1571 a Fe(\225)p
Black 479 1571 a
SDict begin H.S end
 479 1571 a 479 1571 a
SDict begin 13 H.A end
 479 1571 a 479
1571 a
SDict begin [/View [/XYZ H.V]/Dest (0:2628) cvn /DEST pdfmark end
 479 1571 a Fj(Be)i(reliable,)f(because)f(if)i(it)g(is)g(una)n(v)
n(ailable,)d(applications)h(w)o(on')o(t)g(be)i(able)f(to)g(connect)f
(to)h(the)g(netw)o(ork.)-2 1755 y
SDict begin H.S end
 -2 1755 a -2 1755 a
SDict begin 13 H.A end

-2 1755 a -2 1755 a
SDict begin [/View [/XYZ H.V]/Dest (0:2629) cvn /DEST pdfmark end
 -2 1755 a 396 1845 a Fj(Putting)g(a)h(name)e
(service)h(behind)f(a)h(service-oriented)e(Majordomo)g(brok)o(er)g(is)j
(cle)n(v)o(er)f(from)f(some)h(points)g(of)g(vie)n(w)-5
b(.)396 1953 y(Ho)n(we)n(v)o(er)19 b(it')-5 b(s)21 b(simpler)f(and)g
(much)f(less)i(surprising)e(to)h(just)h(e)o(xpose)e(the)h(name)g
(service)g(as)h(a)f(serv)o(er)g(that)g(clients)g(can)396
2061 y(connect)f(to)i(directly)-5 b(.)18 b(If)i(we)h(do)f(this)g
(right,)g(the)g(name)g(service)f(becomes)h(the)2699 2061
y
SDict begin H.S end
 2699 2061 a 2699 2061 a
SDict begin 13 H.A end
 2699 2061 a 2699 2061 a
SDict begin [/View [/XYZ H.V]/Dest (0:2630) cvn /DEST pdfmark end
 2699
2061 a Fi(only)g Fj(global)f(netw)o(ork)g(endpoint)f(we)396
2169 y(need)i(to)g(hard-code)e(in)i(our)g(code)f(or)h(con\002guration)d
(\002les.)-2 2353 y
SDict begin H.S end
 -2 2353 a -2 2353 a
SDict begin 13 H.A end
 -2 2353 a -2
2353 a
SDict begin [/View [/XYZ H.V]/Dest (0:2631) cvn /DEST pdfmark end
 -2 2353 a 396 2443 a Fj(The)j(types)g(of)g(f)o(ailure)g(we)g
(aim)g(to)h(handle)e(are)h(serv)o(er)f(crashes)h(and)g(restarts,)g
(serv)o(er)g(b)n(usy)g(looping,)e(serv)o(er)396 2551
y(o)o(v)o(erload,)g(and)h(netw)o(ork)g(issues.)i(T)-7
b(o)21 b(get)f(reliability)-5 b(,)19 b(we')o(ll)h(create)g(a)h(pool)e
(of)h(name)g(serv)o(ers)f(so)i(if)f(one)g(crashes)g(or)396
2659 y(goes)g(a)o(w)o(ay)-5 b(,)19 b(clients)i(can)f(connect)f(to)h
(another)m(,)e(and)i(so)h(on.)e(In)h(practice,)f(tw)o(o)i(w)o(ould)e
(be)h(enough.)e(But)j(for)f(the)396 2767 y(e)o(xample,)f(we')o(ll)h
(assume)h(the)f(pool)f(can)h(be)g(an)o(y)g(size\()p 0
TeXcolorgray 1996 2767 a
SDict begin H.S end
 1996 2767 a Fj(Figure)f(4-9)2345
2767 y
SDict begin 13 H.L end
 2345 2767 a 2345 2767 a
SDict begin [/Subtype /Link/Dest (0:figure-61) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2345 2767 a Black -1 w
Fj(\).)-2 2785 y
SDict begin H.S end
 -2 2785 a -2 2785 a
SDict begin 13 H.A end
 -2 2785 a -2 2785
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-61) cvn /DEST pdfmark
end
 -2 2785 a Black 3759 5569 a Fi(219)p Black eop end
%%Page: 220 234
TeXDict begin 220 233 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.220) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(4-9.)f(The)i(Fr)o(eelance)
e(P)o(atter)o(n)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2635) cvn /DEST pdfmark end
 -2 172 a 396 2314 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2314 a @beginspecial 0
@llx -252 @lly 392 @urx 0 @ury 3920 @rwi @setspecial
%%BeginDocument: images/fig61.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -252 392 0
%%HiResBoundingBox: 0.0 -252.0 392.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -32.40024185180664 moveto
22.400239944458008 -74.40023803710938 lineto
22.400239944458008 -78.40023803710938 23.73357327779134 -80.40023803710938 26.400239944458008 -80.40023803710938 curveto
114.40023803710938 -80.40023803710938 lineto
114.40023803710938 -80.40023803710938 lineto
117.06690470377605 -80.40023803710938 118.40023803710938 -78.40023803710938 118.40023803710938 -74.40023803710938 curveto
118.40023803710938 -32.40024185180664 lineto
118.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -32.40024185180664 moveto
150.40023803710938 -74.40023803710938 lineto
150.40023803710938 -78.40023803710938 151.73357137044272 -80.40023803710938 154.40023803710938 -80.40023803710938 curveto
242.40023803710938 -80.40023803710938 lineto
242.40023803710938 -80.40023803710938 lineto
245.06690470377603 -80.40023803710938 246.40023803710938 -78.40023803710938 246.40023803710938 -74.40023803710938 curveto
246.40023803710938 -32.40024185180664 lineto
246.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -32.40024185180664 moveto
278.4002380371094 -74.40023803710938 lineto
278.4002380371094 -78.40023803710938 279.7335713704427 -80.40023803710938 282.4002380371094 -80.40023803710938 curveto
370.4002380371094 -80.40023803710938 lineto
370.4002380371094 -80.40023803710938 lineto
373.06690470377606 -80.40023803710938 374.4002380371094 -78.40023803710938 374.4002380371094 -74.40023803710938 curveto
374.4002380371094 -32.40024185180664 lineto
374.4002380371094 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -176.40023803710938 moveto
23.73357327779134 -176.40023803710938 22.400239944458008 -178.40023803710938 22.400239944458008 -182.40023803710938 curveto
22.400239944458008 -224.40023803710938 lineto
118.40023803710938 -224.40023803710938 lineto
118.40023803710938 -182.40023803710938 lineto
118.40023803710938 -178.40023803710938 117.06690470377605 -176.40023803710938 114.40023803710938 -176.40023803710938 curveto
26.400239944458008 -176.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -176.40023803710938 moveto
151.73357137044272 -176.40023803710938 150.40023803710938 -178.40023803710938 150.40023803710938 -182.40023803710938 curveto
150.40023803710938 -224.40023803710938 lineto
246.40023803710938 -224.40023803710938 lineto
246.40023803710938 -182.40023803710938 lineto
246.40023803710938 -178.40023803710938 245.06690470377603 -176.40023803710938 242.40023803710938 -176.40023803710938 curveto
154.40023803710938 -176.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -176.40023803710938 moveto
279.7335713704427 -176.40023803710938 278.4002380371094 -178.40023803710938 278.4002380371094 -182.40023803710938 curveto
278.4002380371094 -224.40023803710938 lineto
374.4002380371094 -224.40023803710938 lineto
374.4002380371094 -182.40023803710938 lineto
374.4002380371094 -178.40023803710938 373.06690470377606 -176.40023803710938 370.4002380371094 -176.40023803710938 curveto
282.4002380371094 -176.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -30.0 moveto
20.0 -72.0 lineto
20.0 -76.0 21.333333333333332 -78.0 24.0 -78.0 curveto
112.0 -78.0 lineto
112.0 -78.0 lineto
114.66666666666667 -78.0 116.0 -76.0 116.0 -72.0 curveto
116.0 -30.0 lineto
116.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
20.0 -30.0 moveto
20.0 -72.0 lineto
20.0 -76.0 21.333333333333332 -78.0 24.0 -78.0 curveto
112.0 -78.0 lineto
112.0 -78.0 lineto
114.66666666666667 -78.0 116.0 -76.0 116.0 -72.0 curveto
116.0 -30.0 lineto
116.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -72.0 lineto
148.0 -76.0 149.33333333333334 -78.0 152.0 -78.0 curveto
240.0 -78.0 lineto
240.0 -78.0 lineto
242.66666666666666 -78.0 244.0 -76.0 244.0 -72.0 curveto
244.0 -30.0 lineto
244.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -30.0 moveto
148.0 -72.0 lineto
148.0 -76.0 149.33333333333334 -78.0 152.0 -78.0 curveto
240.0 -78.0 lineto
240.0 -78.0 lineto
242.66666666666666 -78.0 244.0 -76.0 244.0 -72.0 curveto
244.0 -30.0 lineto
244.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -72.0 lineto
276.0 -76.0 277.3333333333333 -78.0 280.0 -78.0 curveto
368.0 -78.0 lineto
368.0 -78.0 lineto
370.6666666666667 -78.0 372.0 -76.0 372.0 -72.0 curveto
372.0 -30.0 lineto
372.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -30.0 moveto
276.0 -72.0 lineto
276.0 -76.0 277.3333333333333 -78.0 280.0 -78.0 curveto
368.0 -78.0 lineto
368.0 -78.0 lineto
370.6666666666667 -78.0 372.0 -76.0 372.0 -72.0 curveto
372.0 -30.0 lineto
372.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -174.0 moveto
21.333333333333332 -174.0 20.0 -176.0 20.0 -180.0 curveto
20.0 -222.0 lineto
116.0 -222.0 lineto
116.0 -180.0 lineto
116.0 -176.0 114.66666666666667 -174.0 112.0 -174.0 curveto
24.0 -174.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -174.0 moveto
21.333333333333332 -174.0 20.0 -176.0 20.0 -180.0 curveto
20.0 -222.0 lineto
116.0 -222.0 lineto
116.0 -180.0 lineto
116.0 -176.0 114.66666666666667 -174.0 112.0 -174.0 curveto
24.0 -174.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -174.0 moveto
149.33333333333334 -174.0 148.0 -176.0 148.0 -180.0 curveto
148.0 -222.0 lineto
244.0 -222.0 lineto
244.0 -180.0 lineto
244.0 -176.0 242.66666666666666 -174.0 240.0 -174.0 curveto
152.0 -174.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -174.0 moveto
149.33333333333334 -174.0 148.0 -176.0 148.0 -180.0 curveto
148.0 -222.0 lineto
244.0 -222.0 lineto
244.0 -180.0 lineto
244.0 -176.0 242.66666666666666 -174.0 240.0 -174.0 curveto
152.0 -174.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -174.0 moveto
277.3333333333333 -174.0 276.0 -176.0 276.0 -180.0 curveto
276.0 -222.0 lineto
372.0 -222.0 lineto
372.0 -180.0 lineto
372.0 -176.0 370.6666666666667 -174.0 368.0 -174.0 curveto
280.0 -174.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -174.0 moveto
277.3333333333333 -174.0 276.0 -176.0 276.0 -180.0 curveto
276.0 -222.0 lineto
372.0 -222.0 lineto
372.0 -180.0 lineto
372.0 -176.0 370.6666666666667 -174.0 368.0 -174.0 curveto
280.0 -174.0 lineto
closepath
stroke
newpath
68.0 -102.0 moveto
68.0 -126.0 lineto
stroke
newpath
196.0 -102.0 moveto
196.0 -126.0 lineto
stroke
newpath
324.0 -102.0 moveto
324.0 -126.0 lineto
stroke
newpath
68.0 -150.0 moveto
68.0 -126.0 lineto
stroke
newpath
196.0 -150.0 moveto
196.0 -126.0 lineto
stroke
newpath
324.0 -150.0 moveto
324.0 -126.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
43.0 -59.0 moveto
(Client) show
171.0 -59.0 moveto
(Client) show
299.0 -59.0 moveto
(Client) show
40.0 -94.0 moveto
(connect) show
168.0 -94.0 moveto
(connect) show
296.0 -94.0 moveto
(connect) show
49.0 -166.0 moveto
(bind) show
177.0 -166.0 moveto
(bind) show
305.0 -166.0 moveto
(bind) show
41.0 -203.0 moveto
(Server) show
169.0 -203.0 moveto
(Server) show
297.0 -203.0 moveto
(Server) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2314 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2314 a 274 x Fj(In)h(this)h(architecture)e
(a)h(lar)o(ge)f(set)i(of)f(clients)h(connect)e(to)h(a)h(small)f(set)h
(of)f(serv)o(ers)g(directly)-5 b(.)19 b(The)g(serv)o(ers)h(bind)f(to)
396 2696 y(their)h(respecti)n(v)o(e)f(addresses.)h(It')-5
b(s)21 b(fundamentally)c(dif)n(ferent)i(from)g(a)h(brok)o(er)n(-based)e
(approach)g(lik)o(e)i(Majordomo,)396 2804 y(where)g(w)o(ork)o(ers)f
(connect)g(to)i(the)f(brok)o(er)-5 b(.)19 b(F)o(or)g(clients,)i(there)e
(are)i(a)f(couple)f(of)h(options:)-2 2822 y
SDict begin H.S end
 -2 2822 a
-2 2822 a
SDict begin 13 H.A end
 -2 2822 a -2 2822 a
SDict begin [/View [/XYZ H.V]/Dest (0:2639) cvn /DEST pdfmark end
 -2 2822 a -2 2832 a
SDict begin H.S end
 -2
2832 a -2 2832 a
SDict begin 13 H.A end
 -2 2832 a -2 2832 a
SDict begin [/View [/XYZ H.V]/Dest (0:2640) cvn /DEST pdfmark end
 -2 2832 a Black
396 2974 a Fe(\225)p Black 479 2974 a
SDict begin H.S end
 479 2974 a 479
2974 a
SDict begin 13 H.A end
 479 2974 a 479 2974 a
SDict begin [/View [/XYZ H.V]/Dest (0:2641) cvn /DEST pdfmark end
 479 2974 a Fj(Clients)h(could)f(use)g(REQ)
h(sock)o(ets)f(and)g(the)g(Lazy)g(Pirate)g(pattern.)f(Easy)-5
b(,)20 b(b)n(ut)g(w)o(ould)f(need)h(some)g(additional)479
3082 y(intelligence)f(to)i(not)f(stupidly)f(reconnect)f(to)j(dead)e
(serv)o(ers)h(o)o(v)o(er)f(and)g(o)o(v)o(er)-5 b(.)-2
3100 y
SDict begin H.S end
 -2 3100 a -2 3100 a
SDict begin 13 H.A end
 -2 3100 a -2 3100 a
SDict begin [/View [/XYZ H.V]/Dest (0:2642) cvn /DEST pdfmark end
 -2 3100
a Black 396 3231 a Fe(\225)p Black 479 3231 a
SDict begin H.S end
 479 3231
a 479 3231 a
SDict begin 13 H.A end
 479 3231 a 479 3231 a
SDict begin [/View [/XYZ H.V]/Dest (0:2643) cvn /DEST pdfmark end
 479 3231 a Fj(Clients)21
b(could)f(use)g(DEALER)g(sock)o(ets)h(and)e(blast)i(out)f(requests)f
(\(which)h(will)h(be)f(load)f(balanced)g(to)i(all)479
3339 y(connected)e(serv)o(ers\))g(until)h(the)o(y)f(get)i(a)f(reply)-5
b(.)19 b(Brutal,)h(b)n(ut)g(not)g(ele)o(gant.)-2 3357
y
SDict begin H.S end
 -2 3357 a -2 3357 a
SDict begin 13 H.A end
 -2 3357 a -2 3357 a
SDict begin [/View [/XYZ H.V]/Dest (0:2644) cvn /DEST pdfmark end
 -2 3357 a Black
396 3489 a Fe(\225)p Black 479 3489 a
SDict begin H.S end
 479 3489 a 479
3489 a
SDict begin 13 H.A end
 479 3489 a 479 3489 a
SDict begin [/View [/XYZ H.V]/Dest (0:2645) cvn /DEST pdfmark end
 479 3489 a Fj(Clients)h(could)f(use)g(R)m
(OUTER)g(sock)o(ets)h(so)f(the)o(y)g(can)g(address)f(speci\002c)i(serv)
o(ers.)e(But)i(ho)n(w)e(does)h(the)h(client)f(kno)n(w)479
3597 y(the)g(identity)g(of)g(the)g(serv)o(er)f(sock)o(ets?)i(Either)e
(the)h(serv)o(er)g(has)g(to)h(ping)e(the)h(client)g(\002rst)h(\(comple)
o(x\),)d(or)i(the)g(each)479 3704 y(serv)o(er)g(has)g(to)g(use)h(a)f
(hard-coded,)d(\002x)o(ed)j(identity)f(kno)n(wn)g(to)h(the)h(client)f
(\(nasty\).)-2 3722 y
SDict begin H.S end
 -2 3722 a -2 3722 a
SDict begin 13 H.A end
 -2 3722 a -2
3722 a
SDict begin [/View [/XYZ H.V]/Dest (0:2646) cvn /DEST pdfmark end
 -2 3722 a 396 4033 a Fd(4.14.1.)36 b(Model)e(One)f(-)h(Simple)g
(Retr)q(y)g(and)g(F)n(ailo)n(ver)2977 4033 y
SDict begin H.S end
 2977 4033
a 2977 4033 a
SDict begin 18.72 H.A end
 2977 4033 a 2977 4033 a
SDict begin [/View [/XYZ H.V]/Dest (9.53.30.2) cvn /DEST pdfmark end
 2977 4033 a -2
4223 a
SDict begin H.S end
 -2 4223 a -2 4223 a
SDict begin 13 H.A end
 -2 4223 a -2 4223 a
SDict begin [/View [/XYZ H.V]/Dest (0:2648) cvn /DEST pdfmark end
 -2 4223
a 396 4307 a Fj(So)21 b(our)e(menu)g(appears)h(to)g(of)n(fer:)f
(simple,)h(brutal,)f(comple)o(x,)f(or)i(nasty)-5 b(.)20
b(Let')-5 b(s)20 b(start)h(with)g(')-5 b(simple')19 b(and)h(then)g(w)o
(ork)396 4414 y(out)g(the)g(kinks.)g(W)-7 b(e)21 b(tak)o(e)f(Lazy)g
(Pirate)g(and)g(re)n(write)g(it)h(to)f(w)o(ork)g(with)g(multiple)g
(serv)o(er)f(endpoints.)f(Start)j(the)f(serv)o(er)396
4522 y(\002rst,)h(specifying)e(a)h(bind)g(endpoint)e(as)j(ar)o(gument.)
c(Run)k(one)e(or)h(se)n(v)o(eral)g(serv)o(ers:)-2 4540
y
SDict begin H.S end
 -2 4540 a -2 4540 a
SDict begin 13 H.A end
 -2 4540 a -2 4540 a
SDict begin [/View [/XYZ H.V]/Dest (0:flserver1-php) cvn /DEST pdfmark
end
 -2 4540 a 396
4724 a Fk(Example)h(4-22.)d(Fr)o(eelance)h(ser)o(v)o(er)-8
b(,)21 b(Model)g(One)f(\(\003ser)o(v)o(er1.php\))-2 4824
y
SDict begin H.S end
 -2 4824 a -2 4824 a
SDict begin 11.7 H.A end
 -2 4824 a -2 4824 a
SDict begin [/View [/XYZ H.V]/Dest (0:2651) cvn /DEST pdfmark end
 -2 4824 a 396
4904 a Fg(<?php)396 5001 y(/)441 5014 y(*)396 5111 y(*)486
5098 y(Freelance)43 b(server)h(-)h(Model)f(1)p Black
3759 5569 a Fi(220)p Black eop end
%%Page: 221 235
TeXDict begin 221 234 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.221) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 396 85 a Fg(*)486 72 y(Trivial)44 b(echo)g(service)
396 183 y(*)396 280 y(*)486 267 y(Author:)g(Rob)g(Gagnon)g
(<rgagnon24\(at\)gmail\(dot\)com>)396 377 y(*)441 364
y(/)396 558 y(if)h(\(count\($argv\))d(<)j(2\))g({)441
655 y(printf\("I:)e(Syntax:)h(\045s)g(<endpoint>\\n",)f($argv[0]\);)441
752 y(exit;)396 850 y(})396 1044 y($endpoint)h(=)g($argv[1];)396
1141 y($context)g(=)g(new)h(ZMQContext\(\);)396 1238
y($server)f(=)h($context->getSocket\(ZMQ::SOCKET_REP\);)396
1335 y($server->bind\($endpoint\);)396 1530 y(printf\("I:)e(Echo)i
(service)e(is)i(ready)f(at)g(\045s\\n",)g($endpoint\);)396
1627 y(while\(true\))f({)441 1724 y($msg)h(=)h($server->recvMulti\(\);)
441 1821 y($server->sendMulti\($msg\);)-2 1998 y
SDict begin H.S end
 -2 1998
a -2 1998 a
SDict begin 13 H.A end
 -2 1998 a -2 1998 a
SDict begin [/View [/XYZ H.V]/Dest (0:2652) cvn /DEST pdfmark end
 -2 1998 a 396 2095 a
Fj(Then)20 b(start)g(the)h(client,)f(specifying)e(one)i(or)g(more)f
(connect)g(endpoints)g(as)i(ar)o(guments:)-2 2113 y
SDict begin H.S end
 -2
2113 a -2 2113 a
SDict begin 13 H.A end
 -2 2113 a -2 2113 a
SDict begin [/View [/XYZ H.V]/Dest (0:flclient1-php) cvn /DEST pdfmark
end
 -2 2113 a 396 2296
a Fk(Example)g(4-23.)d(Fr)o(eelance)h(client,)i(Model)f(One)h
(\(\003client1.php\))-2 2396 y
SDict begin H.S end
 -2 2396 a -2 2396 a
SDict begin 11.7 H.A end
 -2
2396 a -2 2396 a
SDict begin [/View [/XYZ H.V]/Dest (0:2655) cvn /DEST pdfmark end
 -2 2396 a 396 2476 a Fg(<?php)396 2574
y(/)441 2587 y(*)396 2684 y(*)486 2671 y(Freelance)43
b(Client)h(-)h(Model)f(1)396 2781 y(*)486 2768 y(Uses)g(REQ)g(socket)g
(to)h(query)f(one)g(or)h(more)f(services)396 2878 y(*)396
2975 y(*)486 2962 y(Author:)g(Rob)g(Gagnon)g
(<rgagnon24\(at\)gmail\(dot\)com>)396 3072 y(*)441 3059
y(/)396 3253 y($request_timeout)e(=)j(1000;)f(//)h(ms)396
3351 y($max_retries)e(=)i(3;)f(#)h(Before)f(we)g(abandon)396
3545 y(/)441 3558 y(**)396 3655 y(*)486 3642 y(@param)g(ZMQContext)f
($ctx)396 3752 y(*)486 3739 y(@param)h(string)g($endpoint)396
3849 y(*)486 3836 y(@param)g(string)g($request)396 3946
y(*)441 3933 y(/)396 4031 y(function)g(try_request\($ctx,)e($endpoint,)
h($request\))g({)441 4128 y(global)h($request_timeout;)441
4322 y(printf\("I:)f(Trying)h(echo)g(service)g(at)g(\045s...\\n",)g
($endpoint\);)441 4419 y($client)g(=)g
($ctx->getSocket\(ZMQ::SOCKET_REQ\);)441 4516 y
($client->connect\($endpoint\);)441 4613 y($client->send\($request\);)
441 4808 y($poll)g(=)h(new)f(ZMQPoll\(\);)441 4905 y
($poll->add\($client,)e(ZMQ::POLL_IN\);)441 5002 y($readable)h(=)i
($writable)e(=)i(array\(\);)p Black 3759 5569 a Fi(221)p
Black eop end
%%Page: 222 236
TeXDict begin 222 235 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.222) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 72 a Fg($events)44 b(=)g($poll->poll\($readable,)
e($writable,)h($request_timeout\);)441 170 y($reply)h(=)h(null;)441
267 y(foreach\($readable)d(as)j($sock\))e({)486 364 y(if)h(\($sock)g
(==)h($client\))e({)531 461 y($reply)h(=)g($client->recvMulti\(\);)486
558 y(})h(else)f({)531 655 y($reply)g(=)g(null;)486 752
y(})441 850 y(})441 1044 y($poll->remove\($client\);)441
1141 y($poll)g(=)h(null;)441 1238 y($client)f(=)g(null;)441
1335 y(return)g($reply;)396 1432 y(})396 1627 y($context)g(=)g(new)h
(ZMQContext\(\);)396 1724 y($request)f(=)g('Hello)g(world';)396
1821 y($reply)g(=)h(null;)396 2015 y($cmd)f(=)h(array_shift\($argv\);)
396 2112 y($endpoints)e(=)i(count\($argv\);)396 2209
y(if)g(\($endpoints)e(==)h(0\))h({)441 2307 y(printf\("I:)e(syntax:)h
(\045s)g(<endpoint>)g(...\\n",)f($cmd\);)441 2404 y(exit;)396
2501 y(})396 2695 y(if)i(\($endpoints)e(==)h(1\))h({)441
2792 y(//)g(For)f(one)g(endpoint,)g(we)g(retry)g(N)h(times)441
2889 y($endpoint)e(=)i($argv[0];)441 2987 y(for\($retries)e(=)i(0;)f
($retries)g(<)g($max_retries;)f($retries++\))g({)486
3084 y($reply)h(=)g(try_request\($context,)e($endpoint,)h($request\);)
486 3181 y(if)h(\(isset\($reply\)\))f({)531 3278 y(break;)h(//)g
(Success)486 3375 y(})486 3472 y(printf\("W:)f(No)i(response)e(from)h
(\045s,)h(retrying\\n",)d($endpoint\);)441 3569 y(})396
3666 y(})j(else)f({)441 3764 y(//)h(For)f(multiple)f(endpoints,)h(try)g
(each)g(at)h(most)f(once)441 3861 y(foreach\($argv)f(as)h($endpoint\))f
({)486 3958 y($reply)h(=)g(try_request\($context,)e($endpoint,)h
($request\);)486 4055 y(if)h(\(isset\($reply\)\))f({)531
4152 y(break;)h(//)g(Success)486 4249 y(})486 4346 y(printf\("W:)f(No)i
(response)e(from)h(\045s\\n",)g($endpoint\);)441 4444
y(})396 4541 y(})396 4735 y(if)h(\(isset\($reply\)\))d({)441
4832 y(print)i("Service)g(is)g(running)g(OK\\n";)-2 5010
y
SDict begin H.S end
 -2 5010 a -2 5010 a
SDict begin 13 H.A end
 -2 5010 a -2 5010 a
SDict begin [/View [/XYZ H.V]/Dest (0:2656) cvn /DEST pdfmark end
 -2 5010 a 396
5106 a Fj(F)o(or)20 b(e)o(xample:)p Black 3759 5569 a
Fi(222)p Black eop end
%%Page: 223 237
TeXDict begin 223 236 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.223) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2657) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fg(flserver1)44 b(tcp://)1115
85 y(*)1160 72 y(:5555)e(&)396 170 y(flserver1)i(tcp://)1115
183 y(*)1160 170 y(:5556)e(&)396 267 y(flclient1)i
(tcp://localhost:5555)d(tcp://localhost:5556)-2 444 y
SDict begin H.S end

-2 444 a -2 444 a
SDict begin 13 H.A end
 -2 444 a -2 444 a
SDict begin [/View [/XYZ H.V]/Dest (0:2658) cvn /DEST pdfmark end
 -2 444 a 396 541
a Fj(While)21 b(the)f(basic)g(approach)f(is)i(Lazy)e(Pirate,)i(the)f
(client)g(aims)h(to)f(just)h(get)f(one)f(successful)h(reply)-5
b(.)19 b(It)i(has)f(tw)o(o)396 649 y(techniques,)f(depending)e(on)j
(whether)f(you)h(are)g(running)e(a)i(single)h(serv)o(er)m(,)d(or)i
(multiple)g(serv)o(ers:)-2 667 y
SDict begin H.S end
 -2 667 a -2 667 a
SDict begin 13 H.A end
 -2
667 a -2 667 a
SDict begin [/View [/XYZ H.V]/Dest (0:2659) cvn /DEST pdfmark end
 -2 667 a -2 677 a
SDict begin H.S end
 -2 677 a -2 677 a
SDict begin 13 H.A end
 -2
677 a -2 677 a
SDict begin [/View [/XYZ H.V]/Dest (0:2660) cvn /DEST pdfmark end
 -2 677 a Black 396 819 a Fe(\225)p Black
479 819 a
SDict begin H.S end
 479 819 a 479 819 a
SDict begin 13 H.A end
 479 819 a 479 819 a
SDict begin [/View [/XYZ H.V]/Dest (0:2661) cvn /DEST pdfmark end
 479
819 a Fj(W)m(ith)h(a)f(single)g(serv)o(er)m(,)f(the)h(client)h(will)g
(retry)e(se)n(v)o(eral)h(times,)g(e)o(xactly)f(as)i(for)f(Lazy)g
(Pirate.)-2 837 y
SDict begin H.S end
 -2 837 a -2 837 a
SDict begin 13 H.A end
 -2 837 a -2 837 a
SDict begin [/View [/XYZ H.V]/Dest (0:2662) cvn /DEST pdfmark end

-2 837 a Black 396 968 a Fe(\225)p Black 479 968 a
SDict begin H.S end
 479
968 a 479 968 a
SDict begin 13 H.A end
 479 968 a 479 968 a
SDict begin [/View [/XYZ H.V]/Dest (0:2663) cvn /DEST pdfmark end
 479 968 a Fj(W)m(ith)h(multiple)e
(serv)o(ers,)h(the)g(client)g(will)h(try)f(each)g(serv)o(er)f(at)i
(most)f(once,)f(until)h(it')-5 b(s)22 b(recei)n(v)o(ed)c(a)j(reply)-5
b(,)19 b(or)h(has)479 1076 y(tried)g(all)h(serv)o(ers.)-2
1243 y
SDict begin H.S end
 -2 1243 a -2 1243 a
SDict begin 13 H.A end
 -2 1243 a -2 1243 a
SDict begin [/View [/XYZ H.V]/Dest (0:2664) cvn /DEST pdfmark end
 -2 1243
a 396 1350 a Fj(This)g(solv)o(es)f(the)g(main)g(weakness)g(of)g(Lazy)f
(Pirate,)h(namely)g(that)g(it)h(could)e(not)h(do)g(f)o(ail-o)o(v)o(er)e
(to)i(backup)f(/)i(alternate)396 1458 y(serv)o(ers.)-2
1625 y
SDict begin H.S end
 -2 1625 a -2 1625 a
SDict begin 13 H.A end
 -2 1625 a -2 1625 a
SDict begin [/View [/XYZ H.V]/Dest (0:2665) cvn /DEST pdfmark end
 -2 1625
a 396 1732 a Fj(Ho)n(we)n(v)o(er)e(this)i(design)e(w)o(on')o(t)g(w)o
(ork)h(well)h(in)f(a)g(real)h(application.)d(If)i(we')l(re)g
(connecting)e(man)o(y)h(sock)o(ets,)h(and)g(our)396 1840
y(primary)f(name)g(serv)o(er)h(is)h(do)n(wn,)e(we')l(re)g(going)g(to)i
(do)e(this)i(painful)e(timeout)h(each)f(time.)-2 1868
y
SDict begin H.S end
 -2 1868 a -2 1868 a
SDict begin 13 H.A end
 -2 1868 a -2 1868 a
SDict begin [/View [/XYZ H.V]/Dest (0:2666) cvn /DEST pdfmark end
 -2 1868 a 396
2178 a Fd(4.14.2.)36 b(Model)e(T)-7 b(w)n(o)32 b(-)i(Brutal)f(Shotgun)g
(Massacre)2949 2178 y
SDict begin H.S end
 2949 2178 a 2949 2178 a
SDict begin 18.72 H.A end
 2949 2178
a 2949 2178 a
SDict begin [/View [/XYZ H.V]/Dest (9.53.31.2) cvn /DEST pdfmark end
 2949 2178 a -2 2371 a
SDict begin H.S end
 -2 2371 a -2 2371
a
SDict begin 13 H.A end
 -2 2371 a -2 2371 a
SDict begin [/View [/XYZ H.V]/Dest (0:2668) cvn /DEST pdfmark end
 -2 2371 a 396 2452 a Fj(Let')-5
b(s)21 b(switch)g(our)e(client)h(to)h(using)e(a)i(DEALER)f(sock)o(et.)g
(Our)g(goal)f(here)h(is)h(to)g(mak)o(e)e(sure)h(we)h(get)f(a)h(reply)e
(back)396 2560 y(within)h(the)g(shortest)g(possible)g(time,)g(no)g
(matter)g(whether)f(the)i(primary)d(serv)o(er)h(is)j(do)n(wn)d(or)h
(not.)f(Our)h(client)g(tak)o(es)396 2668 y(this)h(approach:)-2
2686 y
SDict begin H.S end
 -2 2686 a -2 2686 a
SDict begin 13 H.A end
 -2 2686 a -2 2686 a
SDict begin [/View [/XYZ H.V]/Dest (0:2669) cvn /DEST pdfmark end
 -2 2686
a -2 2696 a
SDict begin H.S end
 -2 2696 a -2 2696 a
SDict begin 13 H.A end
 -2 2696 a -2 2696 a
SDict begin [/View [/XYZ H.V]/Dest (0:2670) cvn /DEST pdfmark end
 -2
2696 a Black 396 2839 a Fe(\225)p Black 479 2839 a
SDict begin H.S end
 479
2839 a 479 2839 a
SDict begin 13 H.A end
 479 2839 a 479 2839 a
SDict begin [/View [/XYZ H.V]/Dest (0:2671) cvn /DEST pdfmark end
 479 2839 a Fj(W)-7
b(e)22 b(set)f(things)e(up,)h(connecting)e(to)i(all)h(serv)o(ers.)-2
2856 y
SDict begin H.S end
 -2 2856 a -2 2856 a
SDict begin 13 H.A end
 -2 2856 a -2 2856 a
SDict begin [/View [/XYZ H.V]/Dest (0:2672) cvn /DEST pdfmark end
 -2 2856
a Black 396 2988 a Fe(\225)p Black 479 2988 a
SDict begin H.S end
 479 2988
a 479 2988 a
SDict begin 13 H.A end
 479 2988 a 479 2988 a
SDict begin [/View [/XYZ H.V]/Dest (0:2673) cvn /DEST pdfmark end
 479 2988 a Fj(When)f(we)h(ha)n(v)o
(e)e(a)i(request,)e(we)i(blast)f(it)h(out)f(as)h(man)o(y)e(times)i(as)g
(we)f(ha)n(v)o(e)g(serv)o(ers.)-2 3006 y
SDict begin H.S end
 -2 3006 a -2
3006 a
SDict begin 13 H.A end
 -2 3006 a -2 3006 a
SDict begin [/View [/XYZ H.V]/Dest (0:2674) cvn /DEST pdfmark end
 -2 3006 a Black 396 3137 a
Fe(\225)p Black 479 3137 a
SDict begin H.S end
 479 3137 a 479 3137 a
SDict begin 13 H.A end
 479
3137 a 479 3137 a
SDict begin [/View [/XYZ H.V]/Dest (0:2675) cvn /DEST pdfmark end
 479 3137 a Fj(W)-7 b(e)22 b(w)o(ait)f(for)e(the)h
(\002rst)h(reply)-5 b(,)19 b(and)h(tak)o(e)g(that.)-2
3155 y
SDict begin H.S end
 -2 3155 a -2 3155 a
SDict begin 13 H.A end
 -2 3155 a -2 3155 a
SDict begin [/View [/XYZ H.V]/Dest (0:2676) cvn /DEST pdfmark end
 -2 3155
a Black 396 3287 a Fe(\225)p Black 479 3287 a
SDict begin H.S end
 479 3287
a 479 3287 a
SDict begin 13 H.A end
 479 3287 a 479 3287 a
SDict begin [/View [/XYZ H.V]/Dest (0:2677) cvn /DEST pdfmark end
 479 3287 a Fj(W)-7
b(e)22 b(ignore)d(an)o(y)g(other)g(replies.)-2 3471 y
SDict begin H.S end

-2 3471 a -2 3471 a
SDict begin 13 H.A end
 -2 3471 a -2 3471 a
SDict begin [/View [/XYZ H.V]/Dest (0:2678) cvn /DEST pdfmark end
 -2 3471 a 396
3561 a Fj(What)i(will)g(happen)d(in)j(practice)e(is)i(that)g(when)e
(all)i(serv)o(ers)f(are)g(running,)d(\330MQ)k(will)g(distrib)n(ute)f
(the)g(requests)g(so)396 3669 y(each)g(serv)o(er)f(gets)i(one)f
(request,)f(and)h(sends)g(one)f(reply)-5 b(.)19 b(When)h(an)o(y)f(serv)
o(er)h(is)h(of)n(\003ine,)e(and)h(disconnected,)e(\330MQ)396
3777 y(will)j(distrib)n(ute)f(the)g(requests)g(to)g(the)h(remaining)d
(serv)o(ers.)h(So)i(a)f(serv)o(er)g(may)f(in)i(some)f(cases)h(get)f
(the)g(same)g(request)396 3885 y(more)g(than)f(once.)-2
4051 y
SDict begin H.S end
 -2 4051 a -2 4051 a
SDict begin 13 H.A end
 -2 4051 a -2 4051 a
SDict begin [/View [/XYZ H.V]/Dest (0:2679) cvn /DEST pdfmark end
 -2 4051
a 396 4159 a Fj(What')-5 b(s)21 b(more)f(anno)o(ying)e(for)h(the)h
(client)h(is)g(that)f(we')o(ll)g(get)h(multiple)e(replies)h(back,)g(b)n
(ut)g(there')-5 b(s)20 b(no)g(guarantee)e(we')o(ll)396
4267 y(get)i(a)h(precise)f(number)e(of)i(replies.)g(Requests)h(and)e
(replies)h(can)g(get)h(lost)f(\(e.g.)g(if)g(the)g(serv)o(er)g(crashes)g
(while)396 4374 y(processing)f(a)i(request\).)-2 4558
y
SDict begin H.S end
 -2 4558 a -2 4558 a
SDict begin 13 H.A end
 -2 4558 a -2 4558 a
SDict begin [/View [/XYZ H.V]/Dest (0:2680) cvn /DEST pdfmark end
 -2 4558 a 396
4648 a Fj(So,)f(we)h(ha)n(v)o(e)f(to)g(number)e(requests,)i(and)g
(ignore)e(an)o(y)i(replies)g(that)g(don')o(t)f(match)g(the)i(request)e
(number)-5 b(.)19 b(Our)h(Model)396 4756 y(One)g(serv)o(er)g(will)h(w)o
(ork,)e(since)h(it')-5 b(s)22 b(an)e(echo)f(serv)o(er)m(,)g(b)n(ut)h
(coincidence)e(is)k(not)d(a)i(great)f(basis)h(for)e(understanding.)e
(So)396 4864 y(we')o(ll)k(mak)o(e)f(a)g(Model)g(T)-7
b(w)o(o)20 b(serv)o(er)f(that)i(che)n(ws)f(up)g(the)g(message,)g
(returns)f(a)i(correctly-numbered)15 b(reply)k(with)i(the)396
4972 y(content)e("OK".)i(W)-7 b(e')o(ll)21 b(use)f(messages)h
(consisting)e(of)h(tw)o(o)g(parts,)g(a)h(sequence)e(number)f(and)i(a)h
(body)-5 b(.)p Black 3759 5569 a Fi(223)p Black eop end
%%Page: 224 238
TeXDict begin 224 237 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.224) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2681) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Start)21 b(the)f(serv)o(er)f(once)h(or)g
(more,)f(specifying)g(a)h(bind)g(endpoint)e(each)i(time:)-2
90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:flserver2-php) cvn /DEST pdfmark
end
 -2 90 a 396 274
a Fk(Example)h(4-24.)d(Fr)o(eelance)h(ser)o(v)o(er)-8
b(,)21 b(Model)g(T)-6 b(w)o(o)20 b(\(\003ser)o(v)o(er2.php\))-2
374 y
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 11.7 H.A end
 -2 374 a -2 374 a
SDict begin [/View [/XYZ H.V]/Dest (0:2684) cvn /DEST pdfmark end
 -2 374 a 396
454 a Fg(<?php)396 551 y(/)441 564 y(*)396 661 y(*)486
648 y(Freelance)43 b(server)h(-)h(Model)f(2)396 758 y(*)486
745 y(Does)g(some)g(work,)g(replies)g(OK,)g(with)g(message)g
(sequencing)396 856 y(*)396 953 y(*)486 940 y(Author:)g(Rob)g(Gagnon)g
(<rgagnon24\(at\)gmail\(dot\)com>)396 1050 y(*)441 1037
y(/)396 1231 y(if)h(\(count\($argv\))d(<)j(2\))g({)441
1328 y(printf\("I:)e(Syntax:)h(\045s)g(<endpoint>\\n",)f($argv[0]\);)
441 1425 y(exit;)396 1522 y(})396 1717 y($endpoint)h(=)g($argv[1];)396
1814 y($context)g(=)g(new)h(ZMQContext\(\);)396 1911
y($server)f(=)h($context->getSocket\(ZMQ::SOCKET_REP\);)396
2008 y($server->bind\($endpoint\);)396 2202 y(printf\("I:)e(Echo)i
(service)e(is)i(ready)f(at)g(\045s\\n",)g($endpoint\);)396
2300 y(while\(true\))f({)441 2397 y($request)h(=)g
($server->recvMulti\(\);)441 2494 y(if)h(\(count\($request\))d(!=)i
(2\))h({)486 2591 y(//)f(Fail)h(nastily)e(if)i(run)f(against)g(wrong)g
(client)486 2688 y(exit\(-1\);)441 2785 y(})441 2979
y($address)g(=)g($request[0];)441 3077 y($reply)g(=)h(array\($address,)
d('OK'\);)441 3174 y($server->sendMulti\($reply\);)-2
3351 y
SDict begin H.S end
 -2 3351 a -2 3351 a
SDict begin 13 H.A end
 -2 3351 a -2 3351 a
SDict begin [/View [/XYZ H.V]/Dest (0:2685) cvn /DEST pdfmark end
 -2 3351
a 396 3448 a Fj(Then)20 b(start)g(the)h(client,)f(specifying)e(the)i
(connect)f(endpoints)g(as)i(ar)o(guments:)-2 3466 y
SDict begin H.S end
 -2
3466 a -2 3466 a
SDict begin 13 H.A end
 -2 3466 a -2 3466 a
SDict begin [/View [/XYZ H.V]/Dest (0:flclient2-php) cvn /DEST pdfmark
end
 -2 3466 a 396 3649
a Fk(Example)g(4-25.)d(Fr)o(eelance)h(client,)i(Model)f(T)-6
b(w)o(o)21 b(\(\003client2.php\))-2 3749 y
SDict begin H.S end
 -2 3749 a
-2 3749 a
SDict begin 11.7 H.A end
 -2 3749 a -2 3749 a
SDict begin [/View [/XYZ H.V]/Dest (0:2688) cvn /DEST pdfmark end
 -2 3749 a 396 3829 a Fg(<?php)396
3926 y(/)441 3939 y(*)396 4036 y(*)486 4023 y(Freelance)43
b(Client)h(-)h(Model)f(2)396 4134 y(*)486 4121 y(Uses)g(DEALER)g
(socket)g(to)g(blast)g(one)h(or)f(more)g(services)396
4231 y(*)396 4328 y(*)486 4315 y(Author:)g(Rob)g(Gagnon)g
(<rgagnon24\(at\)gmail\(dot\)com>)396 4425 y(*)441 4412
y(/)396 4606 y(class)g(FLClient)g({)441 4703 y(const)g(GLOBAL_TIMEOUT)f
(=)h(2500;)g(//)h(ms)441 4898 y(private)f($servers)f(=)i(0;)441
4995 y(private)f($sequence)f(=)i(0;)441 5092 y(/)486
5105 y(**)620 5092 y(@var)g(ZMQContext)1338 5105 y(*)1383
5092 y(/)p Black 3759 5569 a Fi(224)p Black eop end
%%Page: 225 239
TeXDict begin 225 238 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.225) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black 441 72 a Fg(private)44 b($context)f(=)i(null;)441
170 y(/)486 183 y(**)620 170 y(@var)g(ZMQSocket)1293
183 y(*)1338 170 y(/)441 267 y(private)f($socket)f(=)i(null;)441
461 y(public)f(function)f(__construct\(\))g({)486 558
y($this->servers)f(=)j(0;)486 655 y($this->sequence)d(=)j(0;)486
752 y($this->context)d(=)j(new)f(ZMQContext\(\);)486
850 y($this->socket)f(=)h($this->context->getSocket\(ZMQ::SOCKET_DEA)o
(LER\);)441 947 y(})441 1141 y(public)g(function)f(__destruct\(\))g({)
486 1238 y($this->socket->setSockOpt\(ZMQ::SOCKOPT_)o(LINGER)o(,)c
(0\);)486 1335 y($this->socket)k(=)h(null;)486 1432 y($this->context)e
(=)j(null;)441 1530 y(})441 1724 y(/)486 1737 y(**)441
1834 y(*)531 1821 y(@param)f(string)f($endpoint)441 1931
y(*)486 1918 y(/)441 2015 y(public)h(function)f(connect\($endpoint\))f
({)486 2112 y($this->socket->connect\($endpoint\);)486
2209 y($this->servers++;)486 2307 y(printf\("I:)h(Connected)g(to)i
(\045s\\n",)f($endpoint\);)441 2404 y(})441 2598 y(/)486
2611 y(**)441 2708 y(*)531 2695 y(@param)g(string)f($request)441
2805 y(*)486 2792 y(/)441 2889 y(public)h(function)f
(request\($request\))f({)486 2987 y(//)i(Prefix)g(request)g(with)g
(sequence)g(number)f(and)i(empty)f(envelope)486 3084
y($this->sequence++;)486 3181 y($msg)g(=)h(array\(\224,)e
($this->sequence,)f($request\);)486 3375 y(//)i(Blast)g(the)h(request)e
(to)i(all)f(connected)g(servers)486 3472 y(for\($server)f(=)i(1;)f
($server)g(<=)g($this->servers;)f($server++\))g({)531
3569 y($this->socket->sendMulti\($msg\);)486 3666 y(})486
3861 y(//)h(Wait)h(for)f(a)h(matching)e(reply)h(to)h(arrive)e(from)i
(anywhere)486 3958 y(//)f(Since)g(we)h(can)f(poll)g(several)g(times,)g
(calculate)f(each)h(one)486 4055 y($poll)g(=)h(new)f(ZMQPoll\(\);)486
4152 y($poll->add\($this->socket,)d(ZMQ::POLL_IN\);)486
4346 y($reply)j(=)g(null;)486 4444 y($endtime)f(=)i(time\(\))f(+)h
(self::GLOBAL_TIMEOUT)c(/)k(1000;)486 4541 y(while)f(\(time\(\))g(<)g
($endtime\))g({)531 4638 y($readable)f(=)i($writable)e(=)i(array\(\);)
531 4735 y($events)e(=)i($poll->poll\($readable,)c($writable,)i
(\($endtime)h(-)g(time\(\)\))3400 4748 y(*)3490 4735
y(1000\);)531 4832 y(foreach\($readable)e(as)i($sock\))g({)576
4929 y(if)g(\($sock)g(==)g($this->socket\))f({)620 5026
y($reply)h(=)h($this->socket->recvMulti\(\);)620 5124
y(if)g(\(count\($reply\))d(!=)j(3\))f({)p Black 3759
5569 a Fi(225)p Black eop end
%%Page: 226 240
TeXDict begin 226 239 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.226) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2699) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black 665 72 a Fg(exit;)620 170 y(})620
267 y($sequence)44 b(=)g($reply[1];)620 364 y(if)h(\($sequence)e(==)i
($this->sequence\))d({)665 461 y(break;)620 558 y(})576
655 y(})531 752 y(})486 850 y(})486 1044 y(return)i($reply;)441
1141 y(})396 1238 y(})396 1432 y($cmd)g(=)h(array_shift\($argv\);)396
1530 y(if)g(\(count\($argv\))d(==)j(0\))f({)441 1627
y(printf\("I:)f(syntax:)h(\045s)g(<endpoint>)g(...\\n",)f($cmd\);)441
1724 y(exit;)396 1821 y(})396 2015 y(//)i(Create)f(new)g(freelance)f
(client)h(object)396 2112 y($client)g(=)h(new)f(FLClient\(\);)396
2307 y(foreach\($argv)f(as)h($endpoint\))g({)441 2404
y($client->connect\($endpoint\);)396 2501 y(})396 2695
y($start)g(=)h(time\(\);)396 2792 y(for\($requests)e(=)i(0;)f
($requests)f(<)i(10000;)f($requests++\))f({)441 2889
y($request)h(=)g("random)g(name";)441 2987 y($reply)g(=)h
($client->request\($request\);)441 3084 y(if)g(\(!isset\($reply\)\))d
({)486 3181 y(print)i("E:)g(name)g(service)g(not)g(available,)g
(aborting\\n";)486 3278 y(break;)441 3375 y(})396 3472
y(})396 3666 y(printf\("Average)f(round)h(trip)g(cost:)g(\045i)g
(ms\\n",)g(\(\(time\(\))g(-)g($start\))g(/)h(100\)\);)396
3764 y($client)f(=)h(null)-2 3940 y
SDict begin H.S end
 -2 3940 a -2 3940
a
SDict begin 13 H.A end
 -2 3940 a -2 3940 a
SDict begin [/View [/XYZ H.V]/Dest (0:2689) cvn /DEST pdfmark end
 -2 3940 a 396 4038 a Fj(Some)20
b(notes)g(on)g(this)h(code:)-2 4039 y
SDict begin H.S end
 -2 4039 a -2 4039
a
SDict begin 13 H.A end
 -2 4039 a -2 4039 a
SDict begin [/View [/XYZ H.V]/Dest (0:2690) cvn /DEST pdfmark end
 -2 4039 a -2 4049 a
SDict begin H.S end
 -2 4049 a -2
4049 a
SDict begin 13 H.A end
 -2 4049 a -2 4049 a
SDict begin [/View [/XYZ H.V]/Dest (0:2691) cvn /DEST pdfmark end
 -2 4049 a Black 396 4208 a
Fe(\225)p Black 479 4208 a
SDict begin H.S end
 479 4208 a 479 4208 a
SDict begin 13 H.A end
 479
4208 a 479 4208 a
SDict begin [/View [/XYZ H.V]/Dest (0:2692) cvn /DEST pdfmark end
 479 4208 a Fj(The)f(client)g(is)h(structured)e(as)i
(a)g(nice)f(little)h(class-based)f(API)g(that)g(hides)g(the)h(dirty)e
(w)o(ork)h(of)g(creating)f(\330MQ)479 4316 y(conte)o(xts)h(and)f(sock)o
(ets,)h(and)g(talking)f(to)i(the)f(serv)o(er)-5 b(.)19
b(If)h(a)h(shotgun)e(blast)h(to)h(the)f(midrif)n(f)f(can)h(be)g(called)
g("talking".)-2 4334 y
SDict begin H.S end
 -2 4334 a -2 4334 a
SDict begin 13 H.A end
 -2 4334 a
-2 4334 a
SDict begin [/View [/XYZ H.V]/Dest (0:2693) cvn /DEST pdfmark end
 -2 4334 a Black 396 4465 a Fe(\225)p Black
479 4465 a
SDict begin H.S end
 479 4465 a 479 4465 a
SDict begin 13 H.A end
 479 4465 a 479 4465
a
SDict begin [/View [/XYZ H.V]/Dest (0:2694) cvn /DEST pdfmark end
 479 4465 a Fj(The)g(client)g(will)h(abandon)d(the)j(chase)f(if)g(it)h
(can')o(t)e(\002nd)2087 4465 y
SDict begin H.S end
 2087 4465 a 2087 4465
a
SDict begin 13 H.A end
 2087 4465 a 2087 4465 a
SDict begin [/View [/XYZ H.V]/Dest (0:2695) cvn /DEST pdfmark end
 2087 4465 a Fi(any)h Fj(responsi)n(v)o(e)e
(serv)o(er)i(within)g(a)g(fe)n(w)g(seconds.)-2 4483 y
SDict begin H.S end

-2 4483 a -2 4483 a
SDict begin 13 H.A end
 -2 4483 a -2 4483 a
SDict begin [/View [/XYZ H.V]/Dest (0:2696) cvn /DEST pdfmark end
 -2 4483 a Black
396 4615 a Fe(\225)p Black 479 4615 a
SDict begin H.S end
 479 4615 a 479
4615 a
SDict begin 13 H.A end
 479 4615 a 479 4615 a
SDict begin [/View [/XYZ H.V]/Dest (0:2697) cvn /DEST pdfmark end
 479 4615 a Fj(The)g(client)g(has)h(to)f
(create)g(a)h(v)n(alid)e(REP)i(en)m(v)o(elope,)d(i.e.)i(add)g(an)g
(empty)f(message)h(frame)g(to)g(the)g(front)f(of)h(the)479
4723 y(message.)p Black 3757 5569 a Fi(226)p Black eop
end
%%Page: 227 241
TeXDict begin 227 240 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.227) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2698) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(The)20 b(client)g(does)g(10,000)e(name)i
(resolution)f(requests)h(\(f)o(ak)o(e)f(ones,)h(since)g(our)g(serv)o
(er)f(does)h(essentially)g(nothing\),)396 180 y(and)g(measures)g(the)g
(a)n(v)o(erage)f(cost.)h(On)g(my)g(test)h(box,)e(talking)h(to)g(one)g
(serv)o(er)m(,)e(it')-5 b(s)22 b(about)d(60)h(usec.)g(T)-7
b(alking)19 b(to)h(three)396 288 y(serv)o(ers,)g(it')-5
b(s)21 b(about)e(80)h(usec.)396 562 y(So)h(pros)e(and)h(cons)g(of)g
(our)f(shotgun)g(approach:)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end

-2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:2700) cvn /DEST pdfmark end
 -2 580 a -2 590 a
SDict begin H.S end
 -2 590 a -2 590 a
SDict begin 13 H.A end

-2 590 a -2 590 a
SDict begin [/View [/XYZ H.V]/Dest (0:2701) cvn /DEST pdfmark end
 -2 590 a Black 396 733 a Fe(\225)p
Black 479 733 a
SDict begin H.S end
 479 733 a 479 733 a
SDict begin 13 H.A end
 479 733 a 479 733
a
SDict begin [/View [/XYZ H.V]/Dest (0:2702) cvn /DEST pdfmark end
 479 733 a Fj(Pro:)h(it)h(is)g(simple,)f(easy)h(to)f(mak)o(e)g(and)f
(easy)i(to)f(understand.)-2 750 y
SDict begin H.S end
 -2 750 a -2 750 a
SDict begin 13 H.A end
 -2
750 a -2 750 a
SDict begin [/View [/XYZ H.V]/Dest (0:2703) cvn /DEST pdfmark end
 -2 750 a Black 396 882 a Fe(\225)p Black
479 882 a
SDict begin H.S end
 479 882 a 479 882 a
SDict begin 13 H.A end
 479 882 a 479 882 a
SDict begin [/View [/XYZ H.V]/Dest (0:2704) cvn /DEST pdfmark end
 479
882 a Fj(Pro:)g(it)h(does)f(the)g(job)g(of)g(f)o(ail-o)o(v)o(er)m(,)e
(and)i(w)o(orks)f(rapidly)-5 b(,)19 b(so)h(long)g(as)h(there)e(is)i(at)
g(least)g(one)f(serv)o(er)f(running.)-2 900 y
SDict begin H.S end
 -2 900
a -2 900 a
SDict begin 13 H.A end
 -2 900 a -2 900 a
SDict begin [/View [/XYZ H.V]/Dest (0:2705) cvn /DEST pdfmark end
 -2 900 a Black 396 1031
a Fe(\225)p Black 479 1031 a
SDict begin H.S end
 479 1031 a 479 1031 a
SDict begin 13 H.A end
 479
1031 a 479 1031 a
SDict begin [/View [/XYZ H.V]/Dest (0:2706) cvn /DEST pdfmark end
 479 1031 a Fj(Con:)i(it)f(creates)h(redundant)c(netw)
o(ork)i(traf)n(\002c.)-2 1032 y
SDict begin H.S end
 -2 1032 a -2 1032 a
SDict begin 13 H.A end
 -2
1032 a -2 1032 a
SDict begin [/View [/XYZ H.V]/Dest (0:2707) cvn /DEST pdfmark end
 -2 1032 a Black 396 1181 a Fe(\225)p
Black 479 1181 a
SDict begin H.S end
 479 1181 a 479 1181 a
SDict begin 13 H.A end
 479 1181 a 479
1181 a
SDict begin [/View [/XYZ H.V]/Dest (0:2708) cvn /DEST pdfmark end
 479 1181 a Fj(Con:)i(we)f(can')o(t)f(prioritize)g(our)h(serv)o
(ers,)f(i.e.)h(Primary)-5 b(,)19 b(then)h(Secondary)-5
b(.)-2 1199 y
SDict begin H.S end
 -2 1199 a -2 1199 a
SDict begin 13 H.A end
 -2 1199 a -2 1199 a
SDict begin [/View [/XYZ H.V]/Dest (0:2709) cvn /DEST pdfmark end

-2 1199 a Black 396 1330 a Fe(\225)p Black 479 1330 a
SDict begin H.S end

479 1330 a 479 1330 a
SDict begin 13 H.A end
 479 1330 a 479 1330 a
SDict begin [/View [/XYZ H.V]/Dest (0:2710) cvn /DEST pdfmark end
 479 1330
a Fj(Con:)21 b(the)f(serv)o(er)f(can)h(do)g(at)h(most)f(one)f(request)h
(at)h(a)f(time,)g(period.)-2 1390 y
SDict begin H.S end
 -2 1390 a -2 1390
a
SDict begin 13 H.A end
 -2 1390 a -2 1390 a
SDict begin [/View [/XYZ H.V]/Dest (0:2711) cvn /DEST pdfmark end
 -2 1390 a 396 1700 a Fd(4.14.3.)36
b(Model)e(Three)f(-)h(Comple)n(x)h(and)f(Nasty)2712 1700
y
SDict begin H.S end
 2712 1700 a 2712 1700 a
SDict begin 18.72 H.A end
 2712 1700 a 2712 1700 a
SDict begin [/View [/XYZ H.V]/Dest (9.53.32.2) cvn /DEST pdfmark end
 2712
1700 a -2 1891 a
SDict begin H.S end
 -2 1891 a -2 1891 a
SDict begin 13 H.A end
 -2 1891 a -2 1891
a
SDict begin [/View [/XYZ H.V]/Dest (0:2713) cvn /DEST pdfmark end
 -2 1891 a 396 1974 a Fj(The)20 b(shotgun)e(approach)g(seems)i(too)f
(good)g(to)h(be)f(true.)h(Let')-5 b(s)20 b(be)g(scienti\002c)g(and)f(w)
o(ork)g(through)f(all)i(the)g(alternati)n(v)o(es.)396
2082 y(W)-7 b(e')l(re)21 b(going)d(to)j(e)o(xplore)d(the)j(comple)o
(x/nasty)c(option,)i(e)n(v)o(en)g(if)i(it')-5 b(s)21
b(only)e(to)i(\002nally)f(realize)g(that)g(we)g(preferred)396
2190 y(brutal.)f(Ah,)h(the)h(story)e(of)h(my)g(life.)-2
2374 y
SDict begin H.S end
 -2 2374 a -2 2374 a
SDict begin 13 H.A end
 -2 2374 a -2 2374 a
SDict begin [/View [/XYZ H.V]/Dest (0:2714) cvn /DEST pdfmark end
 -2 2374
a 396 2464 a Fj(W)-7 b(e)22 b(can)e(solv)o(e)f(the)i(main)e(problems)g
(of)h(the)g(client)g(by)g(switching)g(to)g(a)h(R)m(OUTER)f(sock)o(et.)g
(That)g(lets)h(us)g(send)396 2572 y(requests)f(to)g(speci\002c)h(serv)o
(ers,)e(a)n(v)n(oid)h(serv)o(ers)g(we)g(kno)n(w)f(are)i(dead,)e(and)g
(in)i(general)e(be)h(as)h(smart)f(as)h(we)g(w)o(ant)f(to)396
2680 y(mak)o(e)g(it.)h(W)-7 b(e)21 b(can)f(also)h(solv)o(e)e(the)h
(main)g(problem)f(of)h(the)g(serv)o(er)f(\(single-threadedness\))e(by)j
(switching)f(to)i(a)396 2787 y(R)m(OUTER)g(sock)o(et.)-2
2954 y
SDict begin H.S end
 -2 2954 a -2 2954 a
SDict begin 13 H.A end
 -2 2954 a -2 2954 a
SDict begin [/View [/XYZ H.V]/Dest (0:2715) cvn /DEST pdfmark end
 -2 2954
a 396 3061 a Fj(But)g(doing)e(R)m(OUTER-to-R)m(OUTER)g(between)g(tw)o
(o)i(anon)o(ymous)c(sock)o(ets)k(\(which)e(ha)n(v)o(en')o(t)f(set)j(an)
f(identity\))f(is)j(not)396 3169 y(possible.)e(Both)g(sides)h(generate)
e(an)h(identity)f(\(for)h(the)g(other)f(peer\))h(only)f(when)g(the)o(y)
h(recei)n(v)o(e)f(a)i(\002rst)g(message,)e(and)396 3277
y(thus)h(neither)e(can)h(talk)h(to)f(the)h(other)e(until)h(it)i(has)e
(\002rst)h(recei)n(v)o(ed)e(a)i(message.)f(The)g(only)g(w)o(ay)g(out)g
(of)g(this)h(conundrum)396 3385 y(is)h(to)g(cheat,)e(and)h(use)g
(hard-coded)e(identities)i(in)g(one)g(direction.)e(The)i(proper)f(w)o
(ay)h(to)g(cheat,)g(in)g(a)h(client)f(serv)o(er)396 3493
y(case,)h(is)g(that)f(the)g(client)h('kno)n(ws')d(the)i(identity)g(of)g
(the)g(serv)o(er)-5 b(.)20 b(V)-5 b(ice-v)o(ersa)19 b(w)o(ould)g(be)h
(insane,)g(on)g(top)g(of)f(comple)o(x)396 3601 y(and)h(nasty)-5
b(.)19 b(Insane,)g(comple)o(x,)g(and)g(nasty)h(are)g(great)g(attrib)n
(utes)g(for)g(a)g(genocidal)f(dictator)m(,)g(b)n(ut)h(terrible)g(ones)f
(for)396 3709 y(softw)o(are.)-2 3876 y
SDict begin H.S end
 -2 3876 a -2 3876
a
SDict begin 13 H.A end
 -2 3876 a -2 3876 a
SDict begin [/View [/XYZ H.V]/Dest (0:2716) cvn /DEST pdfmark end
 -2 3876 a 396 3983 a Fj(Rather)h(than)g(in)m(v)o
(ent)f(yet)h(another)f(concept)g(to)h(manage,)f(we')o(ll)h(use)h(the)f
(connection)e(endpoint)g(as)j(identity)-5 b(.)19 b(This)h(is)h(a)396
4091 y(unique)e(string)h(both)f(sides)i(can)f(agree)g(on)f(without)h
(more)f(prior)g(kno)n(wledge)f(than)i(the)o(y)f(already)h(ha)n(v)o(e)f
(for)h(the)396 4199 y(shotgun)f(model.)g(It')-5 b(s)21
b(a)f(sneak)o(y)g(and)f(ef)n(fecti)n(v)o(e)g(w)o(ay)h(to)h(connect)d
(tw)o(o)j(R)m(OUTER)f(sock)o(ets.)-2 4383 y
SDict begin H.S end
 -2 4383 a
-2 4383 a
SDict begin 13 H.A end
 -2 4383 a -2 4383 a
SDict begin [/View [/XYZ H.V]/Dest (0:2717) cvn /DEST pdfmark end
 -2 4383 a 396 4473 a Fj(Remember)f(ho)n
(w)h(\330MQ)g(identities)h(w)o(ork.)e(The)h(serv)o(er)f(R)m(OUTER)i
(sock)o(et)f(sets)h(an)f(identity)g(before)e(it)j(binds)f(its)396
4581 y(sock)o(et.)g(When)g(a)h(client)f(connects,)f(the)o(y)g(do)h(a)h
(little)g(handshak)o(e)d(to)j(e)o(xchange)d(identities,)h(before)g
(either)h(side)h(sends)396 4689 y(a)g(real)f(message.)g(The)g(client)g
(R)m(OUTER)g(sock)o(et,)g(ha)n(ving)f(not)h(set)h(an)f(identity)-5
b(,)19 b(sends)h(a)h(null)f(identity)f(to)i(the)f(serv)o(er)-5
b(.)396 4797 y(The)20 b(serv)o(er)f(generates)h(a)g(random)f(UUID)h
(for)f(the)i(client,)f(for)f(its)i(o)n(wn)f(use.)g(The)g(serv)o(er)f
(sends)i(its)g(identity)e(\(which)396 4905 y(we')l(v)o(e)g(agreed)g(is)
j(going)c(to)j(be)f(an)g(endpoint)e(string\))i(to)g(the)g(client.)p
Black 3756 5569 a Fi(227)p Black eop end
%%Page: 228 242
TeXDict begin 228 241 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.228) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2743) cvn /DEST pdfmark end
 -2 -201 a 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2718) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(This)21 b(means)f(our)f(client)h
(can)g(route)g(a)g(message)g(to)h(the)f(serv)o(er)f(\(i.e.)h(send)g(on)
g(its)h(R)m(OUTER)f(sock)o(et,)g(specifying)f(the)396
180 y(serv)o(er)h(endpoint)e(as)j(identity\))e(as)i(soon)e(as)i(the)g
(connection)d(is)j(established.)e(That')-5 b(s)21 b(not)3028
180 y
SDict begin H.S end
 3028 180 a 3028 180 a
SDict begin 13 H.A end
 3028 180 a 3028 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:2719) cvn /DEST pdfmark end
 3028
180 a Fi(immediately)f Fj(after)g(doing)f(a)396 288 y
SDict begin H.S end

396 288 a 396 288 a
SDict begin 13 H.A end
 396 288 a 396 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:2720) cvn /DEST pdfmark end
 396 288 a Fg(zmq_connect\(\))p
Fj(,)g(b)n(ut)h(some)g(random)e(time)j(thereafter)-5
b(.)19 b(Herein)g(lies)i(one)f(problem:)e(we)j(don')o(t)e(kno)n(w)g
(when)g(the)396 396 y(serv)o(er)h(will)g(actually)g(be)g(a)n(v)n
(ailable)g(and)f(complete)g(its)i(connection)d(handshak)o(e.)g(If)i
(the)g(serv)o(er)g(is)h(actually)e(online,)g(it)396 504
y(could)g(be)i(after)e(a)i(fe)n(w)f(milliseconds.)f(If)i(the)f(serv)o
(er)f(is)i(do)n(wn,)e(and)h(the)g(sysadmin)f(is)i(out)f(to)h(lunch,)e
(it)i(could)e(be)h(an)396 612 y(hour)-5 b(.)-2 779 y
SDict begin H.S end

-2 779 a -2 779 a
SDict begin 13 H.A end
 -2 779 a -2 779 a
SDict begin [/View [/XYZ H.V]/Dest (0:2721) cvn /DEST pdfmark end
 -2 779 a 396 886
a Fj(There')g(s)20 b(a)h(small)f(paradox)e(here.)i(W)-7
b(e)21 b(need)f(to)g(kno)n(w)f(when)h(serv)o(ers)f(become)g(connected)g
(and)g(a)n(v)n(ailable)h(for)g(w)o(ork.)396 994 y(In)g(the)g(Freelance)
g(pattern,)f(unlik)o(e)g(the)i(brok)o(er)n(-based)c(patterns)j(we)g(sa)
o(w)h(earlier)f(in)g(this)h(chapter)m(,)d(serv)o(ers)i(are)g(silent)396
1102 y(until)g(spok)o(en)f(to.)i(Thus)e(we)i(can')o(t)e(talk)h(to)h(a)f
(serv)o(er)g(until)g(it')-5 b(s)21 b(told)f(us)g(it')-5
b(s)22 b(on-line,)c(which)i(it)h(can')o(t)e(do)h(until)g(we')l(v)o(e)
396 1210 y(ask)o(ed)g(it.)-2 1377 y
SDict begin H.S end
 -2 1377 a -2 1377
a
SDict begin 13 H.A end
 -2 1377 a -2 1377 a
SDict begin [/View [/XYZ H.V]/Dest (0:2722) cvn /DEST pdfmark end
 -2 1377 a 396 1484 a Fj(My)g(solution)g(is)h(to)f
(mix)g(in)g(a)h(little)g(of)f(the)g(shotgun)f(approach)f(from)h(model)g
(2,)h(meaning)f(we')o(ll)i(\002re)f(\(harmless\))396
1592 y(shots)h(at)f(an)o(ything)e(we)j(can,)f(and)f(if)i(an)o(ything)d
(mo)o(v)o(es,)h(we)h(kno)n(w)g(it')-5 b(s)21 b(ali)n(v)o(e.)e(W)-7
b(e')l(re)21 b(not)f(going)e(to)j(\002re)f(real)g(requests,)396
1700 y(b)n(ut)g(rather)g(a)g(kind)g(of)g(ping-pong)d(heartbeat.)-2
1884 y
SDict begin H.S end
 -2 1884 a -2 1884 a
SDict begin 13 H.A end
 -2 1884 a -2 1884 a
SDict begin [/View [/XYZ H.V]/Dest (0:2723) cvn /DEST pdfmark end
 -2 1884
a 396 1974 a Fj(This)k(brings)e(us)i(to)f(the)g(realm)g(of)g(protocols)
f(again,)f(so)j(here')-5 b(s)20 b(a)h(short)e(spec)i(that)f(de\002nes)g
(ho)n(w)g(a)g(Freelance)g(client)396 2082 y(and)g(serv)o(er)f(e)o
(xchange)f(PING-PONG)i(commands,)f(and)g(request-reply)f(commands:)-2
2100 y
SDict begin H.S end
 -2 2100 a -2 2100 a
SDict begin 13 H.A end
 -2 2100 a -2 2100 a
SDict begin [/View [/XYZ H.V]/Dest (0:2724) cvn /DEST pdfmark end
 -2 2100
a -2 2110 a
SDict begin H.S end
 -2 2110 a -2 2110 a
SDict begin 13 H.A end
 -2 2110 a -2 2110 a
SDict begin [/View [/XYZ H.V]/Dest (0:2725) cvn /DEST pdfmark end
 -2
2110 a Black 396 2252 a Fe(\225)p Black 479 2252 a
SDict begin H.S end
 479
2252 a 479 2252 a
SDict begin 13 H.A end
 479 2252 a 479 2252 a
SDict begin [/View [/XYZ H.V]/Dest (0:2726) cvn /DEST pdfmark end
 479 2252 a Fj
(http://rfc.zeromq.or)o(g/spec:10)-2 2436 y
SDict begin H.S end
 -2 2436 a
-2 2436 a
SDict begin 13 H.A end
 -2 2436 a -2 2436 a
SDict begin [/View [/XYZ H.V]/Dest (0:2727) cvn /DEST pdfmark end
 -2 2436 a 396 2526 a Fj(It)j(is)g(short)f
(and)f(sweet)i(to)f(implement)f(as)i(a)g(serv)o(er)-5
b(.)19 b(Here')-5 b(s)21 b(our)e(echo)h(serv)o(er)m(,)f(Model)g(Three,)
g(no)n(w)h(speaking)f(FLP)-9 b(.)-2 2710 y
SDict begin H.S end
 -2 2710 a
-2 2710 a
SDict begin 13 H.A end
 -2 2710 a -2 2710 a
SDict begin [/View [/XYZ H.V]/Dest (0:2728) cvn /DEST pdfmark end
 -2 2710 a 396 2800 a Fj(Model)20
b(Three)f(of)h(the)g(serv)o(er)g(is)h(just)f(slightly)g(dif)n(ferent:)
-2 2818 y
SDict begin H.S end
 -2 2818 a -2 2818 a
SDict begin 13 H.A end
 -2 2818 a -2 2818 a
SDict begin [/View [/XYZ H.V]/Dest (0:flserver3-php) cvn /DEST pdfmark
end
 -2
2818 a 396 3001 a Fk(Example)h(4-26.)d(Fr)o(eelance)h(ser)o(v)o(er)-8
b(,)21 b(Model)g(Thr)o(ee)f(\(\003ser)o(v)o(er3.php\))-2
3101 y
SDict begin H.S end
 -2 3101 a -2 3101 a
SDict begin 11.7 H.A end
 -2 3101 a -2 3101 a
SDict begin [/View [/XYZ H.V]/Dest (0:2731) cvn /DEST pdfmark end
 -2 3101
a 396 3181 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 3359 y
SDict begin H.S end
 -2 3359 a -2 3359 a
SDict begin 13 H.A end
 -2 3359 a
-2 3359 a
SDict begin [/View [/XYZ H.V]/Dest (0:2732) cvn /DEST pdfmark end
 -2 3359 a 396 3455 a Fj(The)20 b(Freelance)g(client,)g(ho)n
(we)n(v)o(er)m(,)d(has)k(gotten)e(lar)o(ge.)g(F)o(or)h(clarity)-5
b(,)19 b(it')-5 b(s)21 b(split)g(into)f(an)g(e)o(xample)f(application)g
(and)g(a)396 3563 y(class)i(that)g(does)f(the)g(hard)f(w)o(ork.)g
(Here')-5 b(s)21 b(the)f(top-le)n(v)o(el)f(application:)-2
3581 y
SDict begin H.S end
 -2 3581 a -2 3581 a
SDict begin 13 H.A end
 -2 3581 a -2 3581 a
SDict begin [/View [/XYZ H.V]/Dest (0:flclient3-php) cvn /DEST pdfmark
end
 -2 3581
a 396 3764 a Fk(Example)i(4-27.)d(Fr)o(eelance)h(client,)i(Model)f(Thr)
o(ee)h(\(\003client3.php\))-2 3864 y
SDict begin H.S end
 -2 3864 a -2 3864
a
SDict begin 11.7 H.A end
 -2 3864 a -2 3864 a
SDict begin [/View [/XYZ H.V]/Dest (0:2735) cvn /DEST pdfmark end
 -2 3864 a 396 3945 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
4122 y
SDict begin H.S end
 -2 4122 a -2 4122 a
SDict begin 13 H.A end
 -2 4122 a -2 4122 a
SDict begin [/View [/XYZ H.V]/Dest (0:2736) cvn /DEST pdfmark end
 -2 4122
a 396 4219 a Fj(And)20 b(here,)f(almost)i(as)f(comple)o(x)f(and)h(lar)o
(ge)f(as)i(the)f(Majordomo)e(brok)o(er)m(,)g(is)j(the)f(client)g(API)h
(class:)-2 4237 y
SDict begin H.S end
 -2 4237 a -2 4237 a
SDict begin 13 H.A end
 -2 4237 a -2 4237
a
SDict begin [/View [/XYZ H.V]/Dest (0:flcliapi-php) cvn /DEST pdfmark
end
 -2 4237 a 396 4420 a Fk(Example)g(4-28.)d(Fr)o(eelance)h(client)i
(API)g(\(\003cliapi.php\))-2 4520 y
SDict begin H.S end
 -2 4520 a -2 4520
a
SDict begin 11.7 H.A end
 -2 4520 a -2 4520 a
SDict begin [/View [/XYZ H.V]/Dest (0:2739) cvn /DEST pdfmark end
 -2 4520 a 396 4600 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
4778 y
SDict begin H.S end
 -2 4778 a -2 4778 a
SDict begin 13 H.A end
 -2 4778 a -2 4778 a
SDict begin [/View [/XYZ H.V]/Dest (0:2740) cvn /DEST pdfmark end
 -2 4778
a 396 4874 a Fj(This)21 b(API)f(implementation)e(is)j(f)o(airly)f
(sophisticated)f(and)h(uses)h(a)f(couple)f(of)h(techniques)f(that)h
(we')l(v)o(e)g(not)f(seen)396 4982 y(before:)p Black
3759 5569 a Fi(228)p Black eop end
%%Page: 229 243
TeXDict begin 229 242 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.229) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2435 -132 a Fi(Chapter)20 b(4.)g(Reliable)f(Request-Reply)f(P)-7
b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2741) cvn /DEST pdfmark end
 -2 -11 a -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a
-2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2742) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fk(Multithr)o(eaded)20 b(API)396
346 y Fj(The)g(client)g(API)g(consists)g(of)g(tw)o(o)g(parts,)f(a)i
(synchronous)c('\003cliapi')i(class)i(that)f(runs)f(in)h(the)g
(application)f(thread,)f(and)396 454 y(an)i(asynchronous)e('agent')h
(class)i(that)f(runs)g(as)h(a)f(background)d(thread.)i(Remember)g(ho)n
(w)h(\330MQ)g(mak)o(es)g(it)h(easy)f(to)396 562 y(create)g
(multithreaded)e(apps.)i(The)g(\003cliapi)g(and)g(agent)f(classes)j
(talk)e(to)g(each)g(other)f(with)i(messages)f(o)o(v)o(er)f(an)396
670 y Fg(inproc)h Fj(sock)o(et.)g(All)h(\330MQ)f(aspects)h(\(such)e(as)
i(creating)e(and)h(destro)o(ying)e(a)j(conte)o(xt\))e(are)h(hidden)e
(in)j(the)f(API.)g(The)396 778 y(agent)g(in)g(ef)n(fect)g(acts)h(lik)o
(e)f(a)h(mini-brok)o(er)m(,)c(talking)i(to)h(serv)o(ers)g(in)g(the)h
(background,)16 b(so)21 b(that)f(when)f(we)i(mak)o(e)f(a)396
886 y(request,)g(it)g(can)g(mak)o(e)g(a)h(best)f(ef)n(fort)f(to)i
(reach)e(a)i(serv)o(er)e(it)i(belie)n(v)o(es)f(is)h(a)n(v)n(ailable.)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:2745) cvn /DEST pdfmark end
 -2 1070
a -2 1070 a
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:2746) cvn /DEST pdfmark end
 -2
1070 a 396 1160 a Fk(T)o(ickless)h(poll)e(timer)-2 1343
y
SDict begin H.S end
 -2 1343 a -2 1343 a
SDict begin 13 H.A end
 -2 1343 a -2 1343 a
SDict begin [/View [/XYZ H.V]/Dest (0:2747) cvn /DEST pdfmark end
 -2 1343 a 396
1434 a Fj(In)g(pre)n(vious)f(poll)h(loops)f(we)i(al)o(w)o(ays)g(used)f
(a)g(\002x)o(ed)g(tick)g(interv)n(al,)f(e.g.)h(1)g(second,)f(which)h
(is)h(simple)f(enough)e(b)n(ut)i(not)396 1542 y(e)o(xcellent)f(on)h(po)
n(wer)n(-sensiti)n(v)o(e)f(clients,)h(such)g(as)h(notebooks)d(or)i
(mobile)f(phones,)g(where)g(w)o(aking)h(the)g(CPU)h(costs)396
1650 y(po)n(wer)-5 b(.)20 b(F)o(or)f(fun,)h(and)f(to)i(help)e(sa)n(v)o
(e)i(the)f(planet,)f(the)i(agent)e(uses)i(a)f(')o(tickless)g(timer',)g
(which)f(calculates)i(the)f(poll)396 1758 y(delay)g(based)g(on)f(the)i
(ne)o(xt)e(timeout)h(we')l(re)f(e)o(xpecting.)f(A)j(proper)d
(implementation)g(w)o(ould)i(k)o(eep)f(an)i(ordered)d(list)j(of)396
1866 y(timeouts.)f(W)-7 b(e)21 b(just)g(check)e(all)i(timeouts)f(and)f
(calculate)h(the)g(poll)g(delay)g(until)g(the)g(ne)o(xt)g(one.)-2
1977 y
SDict begin H.S end
 -2 1977 a -2 1977 a
SDict begin 13 H.A end
 -2 1977 a -2 1977 a
SDict begin [/View [/XYZ H.V]/Dest (0:2748) cvn /DEST pdfmark end
 -2 1977
a 359 x Fh(4.15.)39 b(Conc)m(lusion)1138 2336 y
SDict begin H.S end
 1138
2336 a 1138 2336 a
SDict begin 22.464 H.A end
 1138 2336 a 1138 2336 a
SDict begin [/View [/XYZ H.V]/Dest (9.54.1) cvn /DEST pdfmark end
 1138 2336
a -2 2504 a
SDict begin H.S end
 -2 2504 a -2 2504 a
SDict begin 13 H.A end
 -2 2504 a -2 2504 a
SDict begin [/View [/XYZ H.V]/Dest (0:2750) cvn /DEST pdfmark end
 -2
2504 a 396 2610 a Fj(In)20 b(this)h(chapter)e(we')l(v)o(e)g(seen)h(a)h
(v)n(ariety)e(of)h(reliable)g(request-reply)e(mechanisms,)h(each)h
(with)g(certain)g(costs)g(and)396 2718 y(bene\002ts.)g(The)g(e)o
(xample)f(code)g(is)i(lar)o(gely)e(ready)g(for)h(real)g(use,)g(though)f
(it)i(is)g(not)f(optimized.)e(Of)i(all)h(the)f(dif)n(ferent)396
2826 y(patterns,)g(the)g(tw)o(o)g(that)h(stand)f(out)f(are)i(the)f
(Majordomo)e(pattern,)h(for)g(brok)o(er)n(-based)f(reliability)-5
b(,)19 b(and)g(the)i(Freelance)396 2934 y(pattern)f(for)f(brok)o
(erless)g(reliability)-5 b(.)p Black 3759 5569 a Fi(229)p
Black eop end
%%Page: 230 244
TeXDict begin 230 243 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.230) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:advanced-pub-sub) cvn /DEST pdfmark
end
 -2 -11 a 126 x Fl(Chapter)48 b(5.)f(Ad)m(v)m(anced)h(Pub)n
(lish-Subscribe)-2 339 y(P)-5 b(atterns)682 339 y
SDict begin H.S end
 682
339 a 682 339 a
SDict begin 26.957 H.A end
 682 339 a 682 339 a
SDict begin [/View [/XYZ H.V]/Dest (10.0) cvn /DEST pdfmark end
 682 339 a -2 561
a
SDict begin H.S end
 -2 561 a -2 561 a
SDict begin 13 H.A end
 -2 561 a -2 561 a
SDict begin [/View [/XYZ H.V]/Dest (0:2753) cvn /DEST pdfmark end
 -2 561 a 396 667
a Fj(In)20 b(Adv)n(anced)e(Request-Reply)i(P)o(atterns)p
0 TeXcolorgray 1623 667 a
SDict begin H.S end
 1623 667 a Fj(Chapter)f(3)1948
667 y
SDict begin 13 H.L end
 1948 667 a 1948 667 a
SDict begin [/Subtype /Link/Dest (0:advanced-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1948 667 a Black 20 w Fj(and)g(Reliable)i
(Request-Reply)e(P)o(atterns)p 0 TeXcolorgray 3187 667
a
SDict begin H.S end
 3187 667 a Fj(Chapter)g(4)3512 667 y
SDict begin 13 H.L end
 3512 667 a 3512
667 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3512 667 a Black 20 w Fj(we)i(look)o(ed)396 775
y(at)g(adv)n(anced)d(use)j(of)e(\330MQ')-5 b(s)21 b(request-reply)d
(pattern.)h(If)h(you)f(managed)g(to)h(digest)g(all)h(that,)f
(congratulations.)e(In)396 882 y(this)j(chapter)e(we')o(ll)i(focus)e
(on)h(publish-subscribe,)d(and)j(e)o(xtend)f(\330MQ')-5
b(s)20 b(core)g(pub-sub)e(pattern)i(with)g(higher)n(-le)n(v)o(el)396
990 y(patterns)g(for)f(performance,)e(reliability)-5
b(,)19 b(state)i(distrib)n(ution,)e(and)h(monitoring.)-2
1174 y
SDict begin H.S end
 -2 1174 a -2 1174 a
SDict begin 13 H.A end
 -2 1174 a -2 1174 a
SDict begin [/View [/XYZ H.V]/Dest (0:2756) cvn /DEST pdfmark end
 -2 1174
a 396 1264 a Fj(W)-7 b(e')o(ll)22 b(co)o(v)o(er:)-2 1265
y
SDict begin H.S end
 -2 1265 a -2 1265 a
SDict begin 13 H.A end
 -2 1265 a -2 1265 a
SDict begin [/View [/XYZ H.V]/Dest (0:2757) cvn /DEST pdfmark end
 -2 1265 a -2
1275 a
SDict begin H.S end
 -2 1275 a -2 1275 a
SDict begin 13 H.A end
 -2 1275 a -2 1275 a
SDict begin [/View [/XYZ H.V]/Dest (0:2758) cvn /DEST pdfmark end
 -2 1275
a Black 396 1435 a Fe(\225)p Black 479 1435 a
SDict begin H.S end
 479 1435
a 479 1435 a
SDict begin 13 H.A end
 479 1435 a 479 1435 a
SDict begin [/View [/XYZ H.V]/Dest (0:2759) cvn /DEST pdfmark end
 479 1435 a Fj(Ho)n(w)e(to)h(handle)e
(too-slo)n(w)g(subscribers)g(\(the)1840 1435 y
SDict begin H.S end
 1840 1435
a 1840 1435 a
SDict begin 13 H.A end
 1840 1435 a 1840 1435 a
SDict begin [/View [/XYZ H.V]/Dest (0:2760) cvn /DEST pdfmark end
 1840 1435 a Fi(Suicidal)g(Snail)h
Fj(pattern\).)-2 1453 y
SDict begin H.S end
 -2 1453 a -2 1453 a
SDict begin 13 H.A end
 -2 1453 a
-2 1453 a
SDict begin [/View [/XYZ H.V]/Dest (0:2761) cvn /DEST pdfmark end
 -2 1453 a Black 396 1584 a Fe(\225)p Black
479 1584 a
SDict begin H.S end
 479 1584 a 479 1584 a
SDict begin 13 H.A end
 479 1584 a 479 1584
a
SDict begin [/View [/XYZ H.V]/Dest (0:2762) cvn /DEST pdfmark end
 479 1584 a Fj(Ho)n(w)g(to)h(design)e(high-speed)f(subscribers)i
(\(the)1911 1584 y
SDict begin H.S end
 1911 1584 a 1911 1584 a
SDict begin 13 H.A end
 1911 1584
a 1911 1584 a
SDict begin [/View [/XYZ H.V]/Dest (0:2763) cvn /DEST pdfmark end
 1911 1584 a Fi(Blac)n(k)h(Box)f Fj(pattern\).)-2
1602 y
SDict begin H.S end
 -2 1602 a -2 1602 a
SDict begin 13 H.A end
 -2 1602 a -2 1602 a
SDict begin [/View [/XYZ H.V]/Dest (0:2764) cvn /DEST pdfmark end
 -2 1602
a Black 396 1733 a Fe(\225)p Black 479 1733 a
SDict begin H.S end
 479 1733
a 479 1733 a
SDict begin 13 H.A end
 479 1733 a 479 1733 a
SDict begin [/View [/XYZ H.V]/Dest (0:2765) cvn /DEST pdfmark end
 479 1733 a Fj(Ho)n(w)g(to)h(b)n
(uild)e(a)i(shared)f(k)o(e)o(y-v)n(alue)e(cache)h(\(the)1933
1733 y
SDict begin H.S end
 1933 1733 a 1933 1733 a
SDict begin 13 H.A end
 1933 1733 a 1933 1733
a
SDict begin [/View [/XYZ H.V]/Dest (0:2766) cvn /DEST pdfmark end
 1933 1733 a Fi(Clone)h Fj(pattern\).)-2 1751 y
SDict begin H.S end
 -2 1751
a -2 1751 a
SDict begin 13 H.A end
 -2 1751 a -2 1751 a
SDict begin [/View [/XYZ H.V]/Dest (0:2767) cvn /DEST pdfmark end
 -2 1751 a Black 396 1883
a Fe(\225)p Black 479 1883 a
SDict begin H.S end
 479 1883 a 479 1883 a
SDict begin 13 H.A end
 479
1883 a 479 1883 a
SDict begin [/View [/XYZ H.V]/Dest (0:2768) cvn /DEST pdfmark end
 479 1883 a Fj(Ho)n(w)g(to)h(use)f(reactors)g(to)g
(simplify)g(comple)o(x)e(serv)o(ers.)-2 1901 y
SDict begin H.S end
 -2 1901
a -2 1901 a
SDict begin 13 H.A end
 -2 1901 a -2 1901 a
SDict begin [/View [/XYZ H.V]/Dest (0:2769) cvn /DEST pdfmark end
 -2 1901 a Black 396 2032
a Fe(\225)p Black 479 2032 a
SDict begin H.S end
 479 2032 a 479 2032 a
SDict begin 13 H.A end
 479
2032 a 479 2032 a
SDict begin [/View [/XYZ H.V]/Dest (0:2770) cvn /DEST pdfmark end
 479 2032 a Fj(Ho)n(w)i(to)h(use)f(the)g(Binary)g
(Star)h(pattern)e(to)h(add)g(f)o(ailo)o(v)o(er)e(to)j(a)f(serv)o(er)-5
b(.)-2 2050 y
SDict begin H.S end
 -2 2050 a -2 2050 a
SDict begin 13 H.A end
 -2 2050 a -2 2050 a
SDict begin [/View [/XYZ H.V]/Dest (0:2771) cvn /DEST pdfmark end

-2 2050 a Black 396 2182 a Fe(\225)p Black 479 2182 a
SDict begin H.S end

479 2182 a 479 2182 a
SDict begin 13 H.A end
 479 2182 a 479 2182 a
SDict begin [/View [/XYZ H.V]/Dest (0:2772) cvn /DEST pdfmark end
 479 2182
a Fj(Ho)n(w)20 b(to)h(monitor)d(a)j(publish-subscribe)c(netw)o(ork)i
(\(the)2134 2182 y
SDict begin H.S end
 2134 2182 a 2134 2182 a
SDict begin 13 H.A end
 2134 2182
a 2134 2182 a
SDict begin [/View [/XYZ H.V]/Dest (0:2773) cvn /DEST pdfmark end
 2134 2182 a Fi(Espr)m(esso)i Fj(pattern\).)-2
2200 y
SDict begin H.S end
 -2 2200 a -2 2200 a
SDict begin 13 H.A end
 -2 2200 a -2 2200 a
SDict begin [/View [/XYZ H.V]/Dest (0:2774) cvn /DEST pdfmark end
 -2 2200
a 359 x Fh(5.1.)39 b(Slo)n(w)f(Subscriber)g(Detection)f(\(Suicidal)h
(Snail)h(P)l(attern\))3693 2559 y
SDict begin H.S end
 3693 2559 a 3693 2559
a
SDict begin 22.464 H.A end
 3693 2559 a 3693 2559 a
SDict begin [/View [/XYZ H.V]/Dest (10.55.1) cvn /DEST pdfmark end
 3693 2559 a -2 2755 a
SDict begin H.S end
 -2 2755
a -2 2755 a
SDict begin 13 H.A end
 -2 2755 a -2 2755 a
SDict begin [/View [/XYZ H.V]/Dest (0:2776) cvn /DEST pdfmark end
 -2 2755 a 396 2833 a
Fj(A)21 b(common)d(problem)h(you)g(will)i(hit)f(when)g(using)g(the)g
(pub-sub)e(pattern)h(in)i(real)f(life)g(is)i(the)e(slo)n(w)g
(subscriber)-5 b(.)19 b(In)h(an)396 2941 y(ideal)g(w)o(orld,)g(we)g
(stream)g(data)g(at)h(full)f(speed)g(from)f(publishers)g(to)i
(subscribers.)e(In)h(reality)-5 b(,)19 b(subscriber)396
3049 y(applications)g(are)h(often)g(written)g(in)g(interpreted)e
(languages,)h(or)h(just)h(do)e(a)i(lot)f(of)g(w)o(ork,)g(or)g(are)g
(just)g(badly)g(written,)396 3157 y(to)h(the)f(e)o(xtent)f(that)i(the)o
(y)e(can')o(t)g(k)o(eep)h(up)g(with)g(publishers.)-2
3341 y
SDict begin H.S end
 -2 3341 a -2 3341 a
SDict begin 13 H.A end
 -2 3341 a -2 3341 a
SDict begin [/View [/XYZ H.V]/Dest (0:2777) cvn /DEST pdfmark end
 -2 3341
a 396 3431 a Fj(Ho)n(w)g(do)g(we)h(handle)e(a)h(slo)n(w)h(subscriber?)e
(The)h(ideal)g(\002x)g(is)h(to)g(mak)o(e)e(the)i(subscriber)e(f)o
(aster)m(,)g(b)n(ut)h(that)h(might)e(tak)o(e)396 3539
y(w)o(ork)h(and)f(time.)i(Some)e(of)h(the)h(classic)g(strate)o(gies)f
(for)f(handling)g(a)h(slo)n(w)h(subscriber)e(are:)-2
3557 y
SDict begin H.S end
 -2 3557 a -2 3557 a
SDict begin 13 H.A end
 -2 3557 a -2 3557 a
SDict begin [/View [/XYZ H.V]/Dest (0:2778) cvn /DEST pdfmark end
 -2 3557
a -2 3567 a
SDict begin H.S end
 -2 3567 a -2 3567 a
SDict begin 13 H.A end
 -2 3567 a -2 3567 a
SDict begin [/View [/XYZ H.V]/Dest (0:2779) cvn /DEST pdfmark end
 -2
3567 a Black 396 3709 a Fe(\225)p Black 479 3709 a
SDict begin H.S end
 479
3709 a 479 3709 a
SDict begin 13 H.A end
 479 3709 a 479 3709 a
SDict begin [/View [/XYZ H.V]/Dest (0:2780) cvn /DEST pdfmark end
 479 3709 a 479
3709 a
SDict begin H.S end
 479 3709 a 479 3709 a
SDict begin 13 H.A end
 479 3709 a 479 3709 a
SDict begin [/View [/XYZ H.V]/Dest (0:2781) cvn /DEST pdfmark end
 479
3709 a Fk(Queue)i(messages)f(on)h(the)f(publisher)p Fj(.)h(This)g(is)g
(what)f(Gmail)g(does)g(when)g(I)g(don')o(t)f(read)g(my)h(email)g(for)g
(a)h(couple)479 3817 y(of)f(hours.)f(But)i(in)f(high-v)n(olume)e
(messaging,)h(pushing)f(queues)i(upstream)f(has)h(the)g(thrilling)g(b)n
(ut)g(unpro\002table)479 3925 y(result)h(of)e(making)g(publishers)g
(run)h(out)g(of)f(memory)g(and)h(crash.)f(Especially)h(if)g(there)g
(are)g(lots)h(of)f(subscribers)479 4033 y(and)g(it')-5
b(s)21 b(not)f(possible)g(to)g(\003ush)h(to)f(disk)g(for)g(performance)
d(reasons.)-2 4051 y
SDict begin H.S end
 -2 4051 a -2 4051 a
SDict begin 13 H.A end
 -2 4051 a -2
4051 a
SDict begin [/View [/XYZ H.V]/Dest (0:2782) cvn /DEST pdfmark end
 -2 4051 a Black 396 4182 a Fe(\225)p Black 479
4182 a
SDict begin H.S end
 479 4182 a 479 4182 a
SDict begin 13 H.A end
 479 4182 a 479 4182 a
SDict begin [/View [/XYZ H.V]/Dest (0:2783) cvn /DEST pdfmark end
 479
4182 a 479 4182 a
SDict begin H.S end
 479 4182 a 479 4182 a
SDict begin 13 H.A end
 479 4182 a 479
4182 a
SDict begin [/View [/XYZ H.V]/Dest (0:2784) cvn /DEST pdfmark end
 479 4182 a Fk(Queue)k(messages)f(on)h(the)f(subscriber)p
Fj(.)h(This)g(is)g(much)e(better)m(,)g(and)h(it')-5 b(s)21
b(what)f(\330MQ)h(does)f(by)f(def)o(ault)h(if)g(the)479
4290 y(netw)o(ork)f(can)h(k)o(eep)g(up)g(with)g(things.)g(If)g(an)o
(yone')-5 b(s)18 b(going)h(to)h(run)g(out)g(of)g(memory)e(and)i(crash,)
f(it')o(ll)i(be)f(the)479 4398 y(subscriber)f(rather)h(than)f(the)i
(publisher)m(,)d(which)h(is)j(f)o(air)-5 b(.)20 b(This)g(is)h(perfect)f
(for)f("peak)o(y")g(streams)h(where)g(a)479 4506 y(subscriber)f(can')o
(t)g(k)o(eep)h(up)g(for)f(a)i(while,)f(b)n(ut)g(can)g(catch)g(up)g
(when)g(the)g(stream)g(slo)n(ws)h(do)n(wn.)e(Ho)n(we)n(v)o(er)f(it')-5
b(s)21 b(no)479 4614 y(answer)f(to)h(a)f(subscriber)f(that')-5
b(s)21 b(simply)f(too)f(slo)n(w)i(in)f(general.)-2 4632
y
SDict begin H.S end
 -2 4632 a -2 4632 a
SDict begin 13 H.A end
 -2 4632 a -2 4632 a
SDict begin [/View [/XYZ H.V]/Dest (0:2785) cvn /DEST pdfmark end
 -2 4632 a Black
396 4763 a Fe(\225)p Black 479 4763 a
SDict begin H.S end
 479 4763 a 479
4763 a
SDict begin 13 H.A end
 479 4763 a 479 4763 a
SDict begin [/View [/XYZ H.V]/Dest (0:2786) cvn /DEST pdfmark end
 479 4763 a 479 4763 a
SDict begin H.S end
 479
4763 a 479 4763 a
SDict begin 13 H.A end
 479 4763 a 479 4763 a
SDict begin [/View [/XYZ H.V]/Dest (0:2787) cvn /DEST pdfmark end
 479 4763 a Fk(Stop)h(queuing)f
(new)h(messages)g(after)e(a)h(while)p Fj(.)h(This)f(is)h(what)f(Gmail)h
(does)f(when)f(my)h(mailbox)f(o)o(v)o(er\003o)n(ws)g(its)479
4871 y(7.554GB,)g(no)h(7.555GB)f(of)g(space.)h(Ne)n(w)h(messages)f
(just)h(get)f(rejected)g(or)f(dropped.)f(This)i(is)i(a)e(great)g
(strate)o(gy)479 4979 y(from)f(the)i(perspecti)n(v)o(e)d(of)i(the)g
(publisher)m(,)e(and)i(it')-5 b(s)21 b(what)g(\330MQ)f(does)g(when)g
(the)g(publisher)e(sets)k(a)e(high)g(w)o(ater)p Black
3759 5569 a Fi(230)p Black eop end
%%Page: 231 245
TeXDict begin 231 244 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.231) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black 479 72 a Fj(mark)20 b(or)g(HWM.)g(Ho)n(we)n(v)o
(er)f(it)i(still)g(doesn')o(t)e(help)h(us)g(\002x)g(the)h(slo)n(w)f
(subscriber)-5 b(.)19 b(No)n(w)h(we)h(just)g(get)f(gaps)f(in)i(our)479
180 y(message)f(stream.)-2 198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2
198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:2788) cvn /DEST pdfmark end
 -2 198 a Black 396 330 a Fe(\225)p Black
479 330 a
SDict begin H.S end
 479 330 a 479 330 a
SDict begin 13 H.A end
 479 330 a 479 330 a
SDict begin [/View [/XYZ H.V]/Dest (0:2789) cvn /DEST pdfmark end
 479
330 a 479 330 a
SDict begin H.S end
 479 330 a 479 330 a
SDict begin 13 H.A end
 479 330 a 479 330
a
SDict begin [/View [/XYZ H.V]/Dest (0:2790) cvn /DEST pdfmark end
 479 330 a Fk(Punish)i(slo)o(w)e(subscribers)i(with)f(disconnect)p
Fj(.)f(This)g(is)h(what)f(Hotmail)g(does)g(when)g(I)g(don')o(t)f(login)
g(for)h(tw)o(o)479 438 y(weeks,)g(which)g(is)h(why)e(I'm)h(on)g(my)g
(\002fteenth)f(Hotmail)h(account.)f(It')-5 b(s)21 b(a)f(nice)g(brutal)g
(strate)o(gy)f(that)h(forces)479 546 y(subscribers)g(to)g(sit)h(up)f
(and)g(pay)f(attention,)g(and)h(w)o(ould)f(be)h(ideal,)g(b)n(ut)h
(\330MQ)f(doesn')o(t)f(do)g(this,)i(and)f(there')-5 b(s)20
b(no)479 654 y(w)o(ay)h(to)f(layer)g(it)g(on)g(top)g(since)g
(subscribers)g(are)g(in)m(visible)f(to)i(publisher)d(applications.)-2
838 y
SDict begin H.S end
 -2 838 a -2 838 a
SDict begin 13 H.A end
 -2 838 a -2 838 a
SDict begin [/View [/XYZ H.V]/Dest (0:2791) cvn /DEST pdfmark end
 -2 838 a 396
928 a Fj(None)i(of)g(these)g(classic)h(strate)o(gies)f(\002t.)h(So)f
(we)h(need)f(to)g(get)g(creati)n(v)o(e.)f(Rather)h(than)g(disconnect)f
(the)h(publisher)m(,)e(let')-5 b(s)396 1036 y(con)m(vince)18
b(the)j(subscriber)e(to)h(kill)g(itself.)h(This)f(is)h(the)g(Suicidal)f
(Snail)g(pattern.)f(When)h(a)h(subscriber)e(detects)h(that)g(it')-5
b(s)396 1143 y(running)18 b(too)i(slo)n(wly)g(\(where)f("too)h(slo)n
(wly")g(is)h(presumably)d(a)j(con\002gured)d(option)h(that)h(really)g
(means)g("so)g(slo)n(wly)396 1251 y(that)f(if)g(you)e(e)n(v)o(er)h(get)
h(here,)e(shout)h(really)h(loudly)e(because)h(I)g(need)g(to)h(kno)n(w)
-5 b(,)17 b(so)i(I)g(can)f(\002x)h(this!"\),)f(it)h(croaks)f(and)g
(dies.)-2 1435 y
SDict begin H.S end
 -2 1435 a -2 1435 a
SDict begin 13 H.A end
 -2 1435 a -2 1435
a
SDict begin [/View [/XYZ H.V]/Dest (0:2792) cvn /DEST pdfmark end
 -2 1435 a 396 1525 a Fj(Ho)n(w)i(can)g(a)h(subscriber)e(detect)h
(this?)h(One)f(w)o(ay)g(w)o(ould)f(be)h(to)h(sequence)e(messages)h
(\(number)e(them)i(in)g(order\),)f(and)396 1633 y(use)h(a)g(HWM)h(at)f
(the)g(publisher)-5 b(.)19 b(No)n(w)-5 b(,)19 b(if)h(the)f(subscriber)g
(detects)h(a)g(gap)f(\(i.e.)g(the)h(numbering)d(isn')o(t)j(consecuti)n
(v)o(e\),)d(it)396 1741 y(kno)n(ws)j(something)e(is)k(wrong.)c(W)-7
b(e)22 b(then)d(tune)h(the)g(HWM)h(to)f(the)h("croak)e(and)g(die)h(if)h
(you)e(hit)i(this")f(le)n(v)o(el.)-2 1925 y
SDict begin H.S end
 -2 1925 a
-2 1925 a
SDict begin 13 H.A end
 -2 1925 a -2 1925 a
SDict begin [/View [/XYZ H.V]/Dest (0:2793) cvn /DEST pdfmark end
 -2 1925 a 396 2015 a Fj(There)g(are)g(tw)
o(o)g(problems)f(with)h(this)h(solution.)e(One,)h(if)g(we)h(ha)n(v)o(e)
f(man)o(y)f(publishers,)f(ho)n(w)i(do)g(we)g(sequence)396
2123 y(messages?)g(The)g(solution)g(is)h(to)f(gi)n(v)o(e)g(each)f
(publisher)g(a)i(unique)d(ID)j(and)e(add)h(that)g(to)h(the)f
(sequencing.)e(Second,)h(if)396 2231 y(subscribers)h(use)922
2231 y
SDict begin H.S end
 922 2231 a 922 2231 a
SDict begin 13 H.A end
 922 2231 a 922 2231 a
SDict begin [/View [/XYZ H.V]/Dest (0:2794) cvn /DEST pdfmark end
 922
2231 a Fg(ZMQ_SUBSCRIBE)f Fj(\002lters,)h(the)o(y)g(will)h(get)f(gaps)f
(by)h(de\002nition.)f(Our)h(precious)f(sequencing)f(will)396
2339 y(be)i(for)g(nothing.)-2 2523 y
SDict begin H.S end
 -2 2523 a -2 2523
a
SDict begin 13 H.A end
 -2 2523 a -2 2523 a
SDict begin [/View [/XYZ H.V]/Dest (0:2795) cvn /DEST pdfmark end
 -2 2523 a 396 2613 a Fj(Some)g(use-cases)g(w)o
(on')o(t)g(use)g(\002lters,)h(and)e(sequencing)f(will)j(w)o(ork)f(for)f
(them.)h(But)h(a)f(more)g(general)f(solution)g(is)i(that)396
2721 y(the)f(publisher)f(timestamps)h(each)g(message.)g(When)g(a)g
(subscriber)f(gets)i(a)g(message)f(it)h(checks)e(the)h(time,)h(and)e
(if)i(the)396 2829 y(dif)n(ference)d(is)j(more)e(than,)h(say)-5
b(,)19 b(one)h(second,)f(it)h(does)g(the)g("croak)f(and)g(die")h
(thing.)f(Possibly)h(\002ring)g(of)n(f)f(a)i(squa)o(wk)e(to)396
2937 y(some)h(operator)f(console)g(\002rst.)-2 3121 y
SDict begin H.S end

-2 3121 a -2 3121 a
SDict begin 13 H.A end
 -2 3121 a -2 3121 a
SDict begin [/View [/XYZ H.V]/Dest (0:2796) cvn /DEST pdfmark end
 -2 3121 a 396
3211 a Fj(The)h(Suicide)g(Snail)g(pattern)g(w)o(orks)g(especially)f
(when)h(subscribers)f(ha)n(v)o(e)h(their)g(o)n(wn)f(clients)i(and)e
(service-le)n(v)o(el)396 3319 y(agreements)g(and)h(need)f(to)i
(guarantee)d(certain)i(maximum)e(latencies.)i(Aborting)f(a)h
(subscriber)f(may)h(not)g(seem)g(lik)o(e)h(a)396 3427
y(constructi)n(v)o(e)e(w)o(ay)h(to)g(guarantee)f(a)h(maximum)f(latenc)o
(y)-5 b(,)18 b(b)n(ut)i(it')-5 b(s)22 b(the)e(assertion)g(model.)f
(Abort)g(today)-5 b(,)19 b(and)h(the)396 3534 y(problem)f(will)i(be)f
(\002x)o(ed.)f(Allo)n(w)h(late)h(data)f(to)g(\003o)n(w)h(do)n
(wnstream,)d(and)i(the)g(problem)e(may)i(cause)g(wider)g(damage)396
3642 y(and)g(tak)o(e)g(longer)f(to)h(appear)f(on)h(the)g(radar)-5
b(.)-2 3826 y
SDict begin H.S end
 -2 3826 a -2 3826 a
SDict begin 13 H.A end
 -2 3826 a -2 3826 a
SDict begin [/View [/XYZ H.V]/Dest (0:2797) cvn /DEST pdfmark end

-2 3826 a 396 3916 a Fj(So)21 b(here)e(is)i(a)g(minimal)f(e)o(xample)e
(of)i(a)h(Suicidal)f(Snail:)-2 3934 y
SDict begin H.S end
 -2 3934 a -2 3934
a
SDict begin 13 H.A end
 -2 3934 a -2 3934 a
SDict begin [/View [/XYZ H.V]/Dest (0:suisnail-php) cvn /DEST pdfmark
end
 -2 3934 a 396 4118 a Fk(Example)h(5-1.)e
(Suicidal)i(Snail)f(\(suisnail.php\))-2 4218 y
SDict begin H.S end
 -2 4218
a -2 4218 a
SDict begin 11.7 H.A end
 -2 4218 a -2 4218 a
SDict begin [/View [/XYZ H.V]/Dest (0:2800) cvn /DEST pdfmark end
 -2 4218 a 396 4298 a
Fg(<?php)396 4395 y(/)441 4408 y(*)531 4395 y(Suicidal)43
b(Snail)441 4505 y(*)441 4602 y(*)576 4589 y(@author)g(Ian)i(Barber)e
(<ian\(dot\)barber\(at\)gmail\(dot\)com>)396 4699 y(*)441
4686 y(/)396 4881 y(/)441 4894 y(*)576 4881 y
(-------------------------------------)o(------)o(------)o(------)o
(------)o(-----)o(---)441 4991 y(*)531 4978 y(This)h(is)g(our)h
(subscriber)441 5088 y(*)531 5075 y(It)f(connects)g(to)g(the)h
(publisher)e(and)h(subscribes)f(to)i(everything.)e(It)p
Black 3759 5569 a Fi(231)p Black eop end
%%Page: 232 246
TeXDict begin 232 245 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.232) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black 441 85 a Fg(*)531 72 y(sleeps)44
b(for)g(a)h(short)f(time)g(between)f(messages)h(to)g(simulate)g(doing)g
(too)441 183 y(*)531 170 y(much)g(work.)g(If)g(a)h(message)f(is)g(more)
g(than)h(1)f(second)g(late,)g(it)h(croaks.)441 280 y(*)486
267 y(/)396 364 y(define\("MAX_ALLOWED_DELAY",)c(100\);)j(//)g(msecs)
396 558 y(function)g(subscriber\(\))f({)441 655 y($context)h(=)g(new)h
(ZMQContext\(\);)441 850 y(//)g(Subscribe)e(to)h(everything)441
947 y($subscriber)f(=)i(new)f(ZMQSocket\($context,)e
(ZMQ::SOCKET_SUB\);)441 1044 y
($subscriber->connect\("tcp://localhost:55)o(56"\);)441
1141 y($subscriber->setSockOpt\(ZMQ::SOCKOPT_SUB)o(SCRIBE)o(,)d(""\);)
441 1335 y(//)89 b(Get)45 b(and)f(process)g(messages)441
1432 y(while\(true\))f({)486 1530 y($clock)h(=)g
($subscriber->recv\(\);)486 1627 y(//)89 b(Suicide)44
b(snail)g(logic)486 1724 y(if\(microtime\(true\))1296
1737 y(*)1341 1724 y(100)d(-)k($clock)1877 1737 y(*)1922
1724 y(100)e(>)i(MAX_ALLOWED_DELAY\))c({)531 1821 y(echo)j("E:)g
(subscriber)f(cannot)h(keep)g(up,)h(aborting",)e(PHP_EOL;)531
1918 y(break;)486 2015 y(})486 2209 y(//)89 b(Work)44
b(for)h(1)f(msec)h(plus)f(some)g(random)g(additional)f(time)486
2307 y(usleep\(1000)g(+)i(rand\(0,)e(1000\)\);)441 2404
y(})396 2501 y(})396 2792 y(/)441 2805 y(*)531 2792 y
(--------------------------------------)o(------)o(------)o(------)o
(------)o(-----)o(--)441 2902 y(*)531 2889 y(This)h(is)g(our)h(server)f
(task)441 3000 y(*)531 2987 y(It)g(publishes)g(a)g(time-stamped)f
(message)h(to)g(its)h(pub)f(socket)g(every)g(1ms.)441
3097 y(*)486 3084 y(/)396 3181 y(function)g(publisher\(\))f({)441
3278 y($context)h(=)g(new)h(ZMQContext\(\);)441 3472
y(//)89 b(Prepare)44 b(publisher)441 3569 y($publisher)f(=)i(new)f
(ZMQSocket\($context,)e(ZMQ::SOCKET_PUB\);)441 3666 y
($publisher->bind\("tcp://)1521 3679 y(*)1566 3666 y(:5556"\);)441
3861 y(while\(true\))h({)486 3958 y(//)89 b(Send)44 b(current)g(clock)g
(\(msecs\))g(to)g(subscribers)486 4055 y
($publisher->send\(microtime\(true\)\);)486 4152 y(usleep\(1000\);)f
(//)89 b(1msec)44 b(wait)441 4249 y(})396 4346 y(})396
4638 y(/)441 4651 y(*)441 4748 y(*)531 4735 y(This)g(main)g(thread)g
(simply)g(starts)g(a)g(client,)g(and)g(a)h(server,)f(and)g(then)441
4845 y(*)531 4832 y(waits)g(for)g(the)g(client)g(to)h(croak.)441
4942 y(*)486 4929 y(/)396 5026 y($pid)f(=)h(pcntl_fork\(\);)396
5124 y(if\($pid)f(==)g(0\))h({)p Black 3759 5569 a Fi(232)p
Black eop end
%%Page: 233 247
TeXDict begin 233 246 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.233) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black 441 72 a Fg(publisher\(\);)441
170 y(exit\(\);)396 267 y(})396 461 y($pid)44 b(=)h(pcntl_fork\(\);)396
558 y(if\($pid)f(==)g(0\))h({)441 655 y(subscriber\(\);)441
752 y(exit\(\);)396 850 y(})-2 1024 y
SDict begin H.S end
 -2 1024 a -2 1024
a
SDict begin 13 H.A end
 -2 1024 a -2 1024 a
SDict begin [/View [/XYZ H.V]/Dest (0:2801) cvn /DEST pdfmark end
 -2 1024 a 396 1124 a Fj(Notes)21
b(about)e(this)i(e)o(xample:)-2 1142 y
SDict begin H.S end
 -2 1142 a -2 1142
a
SDict begin 13 H.A end
 -2 1142 a -2 1142 a
SDict begin [/View [/XYZ H.V]/Dest (0:2802) cvn /DEST pdfmark end
 -2 1142 a -2 1152 a
SDict begin H.S end
 -2 1152 a -2
1152 a
SDict begin 13 H.A end
 -2 1152 a -2 1152 a
SDict begin [/View [/XYZ H.V]/Dest (0:2803) cvn /DEST pdfmark end
 -2 1152 a Black 396 1294 a
Fe(\225)p Black 479 1294 a
SDict begin H.S end
 479 1294 a 479 1294 a
SDict begin 13 H.A end
 479
1294 a 479 1294 a
SDict begin [/View [/XYZ H.V]/Dest (0:2804) cvn /DEST pdfmark end
 479 1294 a Fj(The)f(message)g(here)g(consists)g
(simply)g(of)g(the)g(current)f(system)i(clock)e(as)i(a)g(number)d(of)i
(milliseconds.)f(In)h(a)479 1402 y(realistic)h(application)e(you')l(d)f
(ha)n(v)o(e)h(at)i(least)g(a)g(message)f(header)f(with)h(the)g
(timestamp,)g(and)f(a)i(message)f(body)479 1510 y(with)h(data.)-2
1511 y
SDict begin H.S end
 -2 1511 a -2 1511 a
SDict begin 13 H.A end
 -2 1511 a -2 1511 a
SDict begin [/View [/XYZ H.V]/Dest (0:2805) cvn /DEST pdfmark end
 -2 1511
a Black 396 1659 a Fe(\225)p Black 479 1659 a
SDict begin H.S end
 479 1659
a 479 1659 a
SDict begin 13 H.A end
 479 1659 a 479 1659 a
SDict begin [/View [/XYZ H.V]/Dest (0:2806) cvn /DEST pdfmark end
 479 1659 a Fj(The)f(e)o(xample)f
(has)h(subscriber)f(and)h(publisher)f(in)h(a)h(single)f(process,)f(as)i
(tw)o(o)g(threads.)e(In)h(reality)g(the)o(y)f(w)o(ould)h(be)479
1767 y(separate)g(processes.)g(Using)g(threads)f(is)i(just)g(con)m(v)o
(enient)d(for)h(the)h(demonstration.)-2 1826 y
SDict begin H.S end
 -2 1826
a -2 1826 a
SDict begin 13 H.A end
 -2 1826 a -2 1826 a
SDict begin [/View [/XYZ H.V]/Dest (0:2807) cvn /DEST pdfmark end
 -2 1826 a 360 x Fh(5.2.)39
b(High-speed)e(Subscriber)n(s)g(\(Blac)m(k)h(Bo)l(x)h(P)l(attern\))3279
2186 y
SDict begin H.S end
 3279 2186 a 3279 2186 a
SDict begin 22.464 H.A end
 3279 2186 a 3279 2186
a
SDict begin [/View [/XYZ H.V]/Dest (10.56.1) cvn /DEST pdfmark end
 3279 2186 a -2 2384 a
SDict begin H.S end
 -2 2384 a -2 2384 a
SDict begin 13 H.A end
 -2 2384 a
-2 2384 a
SDict begin [/View [/XYZ H.V]/Dest (0:2809) cvn /DEST pdfmark end
 -2 2384 a 396 2460 a Fj(A)21 b(common)d(use-case)i(for)g
(pub-sub)e(is)j(distrib)n(uting)e(lar)o(ge)g(data)h(streams.)h(F)o(or)e
(e)o(xample,)g('mark)o(et)g(data')h(coming)396 2567 y(from)f(stock)h(e)
o(xchanges.)e(A)j(typical)f(set-up)g(w)o(ould)f(ha)n(v)o(e)h(a)g
(publisher)f(connected)f(to)j(a)f(stock)g(e)o(xchange,)e(taking)396
2675 y(price)i(quotes,)f(and)h(sending)f(them)h(out)g(to)g(a)h(number)d
(of)i(subscribers.)f(If)h(there)g(are)g(a)g(handful)f(of)h
(subscribers,)f(we)396 2783 y(could)g(use)i(TCP)-9 b(.)20
b(If)h(we)f(ha)n(v)o(e)g(a)g(lar)o(ger)f(number)g(of)g(subscribers,)g
(we')l(d)h(probably)e(use)i(reliable)g(multicast,)g(i.e.)3703
2783 y
SDict begin H.S end
 3703 2783 a 3703 2783 a
SDict begin 13 H.A end
 3703 2783 a 3703 2783
a
SDict begin [/View [/XYZ H.V]/Dest (0:2810) cvn /DEST pdfmark end
 3703 2783 a Fg(pgm)p Fj(.)-2 2967 y
SDict begin H.S end
 -2 2967 a -2 2967
a
SDict begin 13 H.A end
 -2 2967 a -2 2967 a
SDict begin [/View [/XYZ H.V]/Dest (0:2811) cvn /DEST pdfmark end
 -2 2967 a 396 3057 a Fj(Let')-5
b(s)21 b(imagine)e(our)h(feed)f(has)i(an)f(a)n(v)o(erage)f(of)g
(100,000)f(100-byte)g(messages)i(a)h(second.)e(That')-5
b(s)20 b(a)g(typical)g(rate,)g(after)396 3165 y(\002ltering)g(mark)o
(et)f(data)h(we)h(don')o(t)e(need)g(to)h(send)g(on)g(to)g(subscribers.)
f(No)n(w)i(we)f(decide)g(to)g(record)f(a)h(day')-5 b(s)20
b(data)396 3273 y(\(maybe)f(250)g(GB)i(in)g(8)f(hours\),)f(and)g(then)h
(replay)f(it)i(to)f(a)h(simulation)e(netw)o(ork,)g(i.e.)h(a)h(small)g
(group)d(of)i(subscribers.)396 3381 y(While)h(100K)e(messages)h(a)h
(second)e(is)j(easy)e(for)f(a)i(\330MQ)f(application,)f(we)h(w)o(ant)h
(to)f(replay)3125 3381 y
SDict begin H.S end
 3125 3381 a 3125 3381 a
SDict begin 13 H.A end
 3125
3381 a 3125 3381 a
SDict begin [/View [/XYZ H.V]/Dest (0:2812) cvn /DEST pdfmark end
 3125 3381 a Fi(muc)o(h)g(faster)r
Fj(.)-2 3565 y
SDict begin H.S end
 -2 3565 a -2 3565 a
SDict begin 13 H.A end
 -2 3565 a -2 3565
a
SDict begin [/View [/XYZ H.V]/Dest (0:2813) cvn /DEST pdfmark end
 -2 3565 a 396 3655 a Fj(So)h(we)f(set-up)g(our)f(architecture)g(with)
h(a)h(b)n(unch)e(of)h(box)o(es,)f(one)g(for)h(the)g(publisher)m(,)e
(and)i(one)g(for)f(each)h(subscriber)-5 b(.)396 3763
y(These)20 b(are)g(well-speci\002ed)g(box)o(es,)f(eight)h(cores,)f
(twelv)o(e)h(for)g(the)g(publisher)-5 b(.)19 b(\(If)h(you')l(re)e
(reading)h(this)h(in)h(2015,)396 3871 y(which)f(is)h(when)f(the)g
(Guide)g(is)h(scheduled)d(to)j(be)f(\002nished,)f(please)i(add)e(a)i
(zero)e(to)i(those)f(numbers.\))-2 4055 y
SDict begin H.S end
 -2 4055 a -2
4055 a
SDict begin 13 H.A end
 -2 4055 a -2 4055 a
SDict begin [/View [/XYZ H.V]/Dest (0:2814) cvn /DEST pdfmark end
 -2 4055 a 396 4145 a Fj(And)g(as)h(we)f
(pump)f(data)h(into)g(our)g(subscribers,)f(we)h(notice)g(tw)o(o)g
(things:)-2 4163 y
SDict begin H.S end
 -2 4163 a -2 4163 a
SDict begin 13 H.A end
 -2 4163 a -2 4163
a
SDict begin [/View [/XYZ H.V]/Dest (0:2815) cvn /DEST pdfmark end
 -2 4163 a -2 4173 a
SDict begin H.S end
 -2 4173 a -2 4173 a
SDict begin 13 H.A end
 -2 4173 a -2
4173 a
SDict begin [/View [/XYZ H.V]/Dest (0:2816) cvn /DEST pdfmark end
 -2 4173 a Black 463 4315 a Fj(1.)p Black 546 4315
a
SDict begin H.S end
 546 4315 a 546 4315 a
SDict begin 13 H.A end
 546 4315 a 546 4315 a
SDict begin [/View [/XYZ H.V]/Dest (0:2817) cvn /DEST pdfmark end
 546 4315
a Fj(When)g(we)g(do)g(e)n(v)o(en)f(the)h(slightest)h(amount)e(of)h(w)o
(ork)f(with)i(a)f(message,)g(it)h(slo)n(ws)g(do)n(wn)e(our)g
(subscriber)g(to)i(the)546 4423 y(point)e(where)h(it)h(can')o(t)e
(catch)h(up)g(with)g(the)g(publisher)f(again.)-2 4441
y
SDict begin H.S end
 -2 4441 a -2 4441 a
SDict begin 13 H.A end
 -2 4441 a -2 4441 a
SDict begin [/View [/XYZ H.V]/Dest (0:2818) cvn /DEST pdfmark end
 -2 4441 a Black
463 4572 a Fj(2.)p Black 546 4572 a
SDict begin H.S end
 546 4572 a 546 4572
a
SDict begin 13 H.A end
 546 4572 a 546 4572 a
SDict begin [/View [/XYZ H.V]/Dest (0:2819) cvn /DEST pdfmark end
 546 4572 a Fj(W)-7 b(e')l(re)20
b(hitting)g(a)g(ceiling,)g(at)g(both)g(publisher)f(and)g(subscriber)m
(,)g(to)h(around)e(say)j(6M)f(messages)g(a)h(second,)e(e)n(v)o(en)546
4680 y(after)h(careful)f(optimization)f(and)i(TCP)h(tuning.)-2
4864 y
SDict begin H.S end
 -2 4864 a -2 4864 a
SDict begin 13 H.A end
 -2 4864 a -2 4864 a
SDict begin [/View [/XYZ H.V]/Dest (0:2820) cvn /DEST pdfmark end
 -2 4864
a 396 4954 a Fj(The)f(\002rst)h(thing)f(we)g(ha)n(v)o(e)g(to)g(do)g(is)
h(break)e(our)g(subscriber)g(into)h(a)h(multithreaded)d(design)h(so)i
(that)f(we)h(can)f(do)g(w)o(ork)396 5062 y(with)h(messages)f(in)g(one)g
(set)h(of)f(threads,)f(while)h(reading)f(messages)h(in)h(another)-5
b(.)19 b(T)-7 b(ypically)19 b(we)i(don')o(t)d(w)o(ant)i(to)p
Black 3759 5569 a Fi(233)p Black eop end
%%Page: 234 248
TeXDict begin 234 247 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.234) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2830) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black 396 72 a
Fj(process)20 b(e)n(v)o(ery)f(message)h(the)g(same)g(w)o(ay)-5
b(.)20 b(Rather)m(,)g(the)g(subscriber)f(will)i(\002lter)f(some)g
(messages,)g(perhaps)f(by)h(pre\002x)396 180 y(k)o(e)o(y)-5
b(.)19 b(When)h(a)h(message)f(matches)g(some)g(criteria,)f(the)i
(subscriber)d(will)j(call)g(a)g(w)o(ork)o(er)e(to)h(deal)g(with)h(it.)f
(In)g(\330MQ)396 288 y(terms)g(this)h(means)f(sending)f(the)h(message)g
(to)h(a)f(w)o(ork)o(er)g(thread.)-2 472 y
SDict begin H.S end
 -2 472 a -2
472 a
SDict begin 13 H.A end
 -2 472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:2821) cvn /DEST pdfmark end
 -2 472 a 396 562 a Fj(So)h(the)f(subscriber)f
(looks)h(something)e(lik)o(e)j(a)f(queue)f(de)n(vice.)g(W)-7
b(e)22 b(could)d(use)h(v)n(arious)g(sock)o(ets)g(to)g(connect)f(the)396
670 y(subscriber)g(and)h(w)o(ork)o(ers.)f(If)h(we)h(assume)f(one-w)o
(ay)f(traf)n(\002c,)g(and)h(w)o(ork)o(ers)g(that)g(are)g(all)h
(identical,)e(we)i(can)f(use)396 778 y(PUSH)h(and)f(PULL,)g(and)g(dele)
o(gate)e(all)j(the)f(routing)f(w)o(ork)g(to)i(\330MQ\()p
0 TeXcolorgray 2440 778 a
SDict begin H.S end
 2440 778 a Fj(Figure)e(5-1)2789
778 y
SDict begin 13 H.L end
 2789 778 a 2789 778 a
SDict begin [/Subtype /Link/Dest (0:figure-62) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2789 778 a Black -2 w Fj(\).)h(This)h(is)g
(the)f(simplest)h(and)e(f)o(astest)396 886 y(approach.)-2
904 y
SDict begin H.S end
 -2 904 a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-62) cvn /DEST pdfmark
end
 -2 904 a 396
1087 a Fk(Figur)o(e)h(5-1.)f(The)i(Simple)g(Black)g(Box)f(P)o(atter)o
(n)-2 1187 y
SDict begin H.S end
 -2 1187 a -2 1187 a
SDict begin 13 H.A end
 -2 1187 a -2 1187 a
SDict begin [/View [/XYZ H.V]/Dest (0:2825) cvn /DEST pdfmark end

-2 1187 a 396 4395 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4395 a @beginspecial 0 @llx
-380 @lly 399 @urx 0 @ury 3990 @rwi @setspecial
%%BeginDocument: images/fig62.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -380 399 0
%%HiResBoundingBox: 0.0 -380.0 399.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.10020446777344 -27.100210189819336 moveto
159.10020446777344 -65.10021209716797 lineto
243.10020446777344 -65.10021209716797 lineto
243.10020446777344 -27.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.10020446777344 -68.10021209716797 moveto
159.10020446777344 -82.10021209716797 lineto
159.10020446777344 -85.4335454305013 160.43353780110678 -87.10021209716797 163.10020446777344 -87.10021209716797 curveto
240.10020446777344 -87.10021209716797 lineto
240.10020446777344 -87.10021209716797 lineto
242.10020446777344 -87.10021209716797 243.10020446777344 -85.4335454305013 243.10020446777344 -82.10021209716797 curveto
243.10020446777344 -68.50021362304688 lineto
243.10020446777344 -68.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.10020446777344 -137.10020446777344 moveto
160.43353780110678 -137.10020446777344 159.10020446777344 -138.7668711344401 159.10020446777344 -142.10020446777344 curveto
159.10020446777344 -155.10020446777344 lineto
243.10020446777344 -155.10020446777344 lineto
243.10020446777344 -142.10020446777344 lineto
243.10020446777344 -138.7668711344401 242.10020446777344 -137.10020446777344 240.10020446777344 -137.10020446777344 curveto
163.10020446777344 -137.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.10020446777344 -158.10020446777344 moveto
159.10020446777344 -195.10020446777344 lineto
243.10020446777344 -195.10020446777344 lineto
243.10020446777344 -158.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.10020446777344 -198.10020446777344 moveto
159.10020446777344 -212.10020446777344 lineto
159.10020446777344 -215.43353780110678 160.43353780110678 -217.10020446777344 163.10020446777344 -217.10020446777344 curveto
240.10020446777344 -217.10020446777344 lineto
240.10020446777344 -217.10020446777344 lineto
242.10020446777344 -217.10020446777344 243.10020446777344 -215.43353780110678 243.10020446777344 -212.10020446777344 curveto
243.10020446777344 -198.5001983642578 lineto
243.10020446777344 -198.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
51.1002082824707 -277.1002197265625 moveto
48.43354161580404 -277.1002197265625 47.1002082824707 -278.7668863932292 47.1002082824707 -282.1002197265625 curveto
47.1002082824707 -295.1002197265625 lineto
131.10020446777344 -295.1002197265625 lineto
131.10020446777344 -282.1002197265625 lineto
131.10020446777344 -278.7668863932292 130.10020446777344 -277.1002197265625 128.10020446777344 -277.1002197265625 curveto
51.1002082824707 -277.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
47.1002082824707 -298.1002197265625 moveto
47.1002082824707 -337.1002197265625 lineto
131.10020446777344 -337.1002197265625 lineto
131.10020446777344 -298.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.10020446777344 -277.1002197265625 moveto
160.43353780110678 -277.1002197265625 159.10020446777344 -278.7668863932292 159.10020446777344 -282.1002197265625 curveto
159.10020446777344 -295.1002197265625 lineto
243.10020446777344 -295.1002197265625 lineto
243.10020446777344 -282.1002197265625 lineto
243.10020446777344 -278.7668863932292 242.10020446777344 -277.1002197265625 240.10020446777344 -277.1002197265625 curveto
163.10020446777344 -277.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.10020446777344 -298.1002197265625 moveto
159.10020446777344 -337.1002197265625 lineto
243.10020446777344 -337.1002197265625 lineto
243.10020446777344 -298.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
275.1002197265625 -277.1002197265625 moveto
272.4335530598958 -277.1002197265625 271.1002197265625 -278.7668863932292 271.1002197265625 -282.1002197265625 curveto
271.1002197265625 -295.1002197265625 lineto
355.1002197265625 -295.1002197265625 lineto
355.1002197265625 -282.1002197265625 lineto
355.1002197265625 -278.7668863932292 354.1002197265625 -277.1002197265625 352.1002197265625 -277.1002197265625 curveto
275.1002197265625 -277.1002197265625 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
271.1002197265625 -298.1002197265625 moveto
271.1002197265625 -337.1002197265625 lineto
355.1002197265625 -337.1002197265625 lineto
355.1002197265625 -298.1002197265625 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -25.0 moveto
157.0 -63.0 lineto
241.0 -63.0 lineto
241.0 -25.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
157.0 -25.0 moveto
157.0 -63.0 lineto
241.0 -63.0 lineto
241.0 -25.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -66.0 moveto
157.0 -80.0 lineto
157.0 -83.33333333333333 158.33333333333334 -85.0 161.0 -85.0 curveto
238.0 -85.0 lineto
238.0 -85.0 lineto
240.0 -85.0 241.0 -83.33333333333333 241.0 -80.0 curveto
241.0 -66.4000015258789 lineto
241.0 -66.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -66.0 moveto
157.0 -80.0 lineto
157.0 -83.33333333333333 158.33333333333334 -85.0 161.0 -85.0 curveto
238.0 -85.0 lineto
238.0 -85.0 lineto
240.0 -85.0 241.0 -83.33333333333333 241.0 -80.0 curveto
241.0 -66.4000015258789 lineto
241.0 -66.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
161.0 -135.0 moveto
158.33333333333334 -135.0 157.0 -136.66666666666666 157.0 -140.0 curveto
157.0 -153.0 lineto
241.0 -153.0 lineto
241.0 -140.0 lineto
241.0 -136.66666666666666 240.0 -135.0 238.0 -135.0 curveto
161.0 -135.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
161.0 -135.0 moveto
158.33333333333334 -135.0 157.0 -136.66666666666666 157.0 -140.0 curveto
157.0 -153.0 lineto
241.0 -153.0 lineto
241.0 -140.0 lineto
241.0 -136.66666666666666 240.0 -135.0 238.0 -135.0 curveto
161.0 -135.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -156.0 moveto
157.0 -193.0 lineto
241.0 -193.0 lineto
241.0 -156.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -156.0 moveto
157.0 -193.0 lineto
241.0 -193.0 lineto
241.0 -156.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -196.0 moveto
157.0 -210.0 lineto
157.0 -213.33333333333334 158.33333333333334 -215.0 161.0 -215.0 curveto
238.0 -215.0 lineto
238.0 -215.0 lineto
240.0 -215.0 241.0 -213.33333333333334 241.0 -210.0 curveto
241.0 -196.39999389648438 lineto
241.0 -196.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -196.0 moveto
157.0 -210.0 lineto
157.0 -213.33333333333334 158.33333333333334 -215.0 161.0 -215.0 curveto
238.0 -215.0 lineto
238.0 -215.0 lineto
240.0 -215.0 241.0 -213.33333333333334 241.0 -210.0 curveto
241.0 -196.39999389648438 lineto
241.0 -196.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
49.0 -275.0 moveto
46.333333333333336 -275.0 45.0 -276.6666666666667 45.0 -280.0 curveto
45.0 -293.0 lineto
129.0 -293.0 lineto
129.0 -280.0 lineto
129.0 -276.6666666666667 128.0 -275.0 126.0 -275.0 curveto
49.0 -275.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
49.0 -275.0 moveto
46.333333333333336 -275.0 45.0 -276.6666666666667 45.0 -280.0 curveto
45.0 -293.0 lineto
129.0 -293.0 lineto
129.0 -280.0 lineto
129.0 -276.6666666666667 128.0 -275.0 126.0 -275.0 curveto
49.0 -275.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
45.0 -296.0 moveto
45.0 -335.0 lineto
129.0 -335.0 lineto
129.0 -296.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
45.0 -296.0 moveto
45.0 -335.0 lineto
129.0 -335.0 lineto
129.0 -296.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
161.0 -275.0 moveto
158.33333333333334 -275.0 157.0 -276.6666666666667 157.0 -280.0 curveto
157.0 -293.0 lineto
241.0 -293.0 lineto
241.0 -280.0 lineto
241.0 -276.6666666666667 240.0 -275.0 238.0 -275.0 curveto
161.0 -275.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
161.0 -275.0 moveto
158.33333333333334 -275.0 157.0 -276.6666666666667 157.0 -280.0 curveto
157.0 -293.0 lineto
241.0 -293.0 lineto
241.0 -280.0 lineto
241.0 -276.6666666666667 240.0 -275.0 238.0 -275.0 curveto
161.0 -275.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -296.0 moveto
157.0 -335.0 lineto
241.0 -335.0 lineto
241.0 -296.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -296.0 moveto
157.0 -335.0 lineto
241.0 -335.0 lineto
241.0 -296.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
273.0 -275.0 moveto
270.3333333333333 -275.0 269.0 -276.6666666666667 269.0 -280.0 curveto
269.0 -293.0 lineto
353.0 -293.0 lineto
353.0 -280.0 lineto
353.0 -276.6666666666667 352.0 -275.0 350.0 -275.0 curveto
273.0 -275.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
273.0 -275.0 moveto
270.3333333333333 -275.0 269.0 -276.6666666666667 269.0 -280.0 curveto
269.0 -293.0 lineto
353.0 -293.0 lineto
353.0 -280.0 lineto
353.0 -276.6666666666667 352.0 -275.0 350.0 -275.0 curveto
273.0 -275.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
269.0 -296.0 moveto
269.0 -335.0 lineto
353.0 -335.0 lineto
353.0 -296.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
269.0 -296.0 moveto
269.0 -335.0 lineto
353.0 -335.0 lineto
353.0 -296.0 lineto
closepath
stroke
0.7 setlinewidth
0 setlinecap
[3.0] 0.0 setdash
newpath
196.0 -105.0 moveto
17.0 -105.0 lineto
17.0 -355.0 lineto
381.0 -355.0 lineto
381.0 -105.0 lineto
203.0 -105.0 lineto
stroke
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
199.0 -85.0 moveto
199.0 -125.0 lineto
stroke
newpath
196.0 -120.0 moveto
199.0 -130.0 lineto
203.0 -120.0 lineto
closepath
fill
newpath
84.0 -260.0 moveto
87.0 -270.0 lineto
91.0 -260.0 lineto
closepath
fill
newpath
196.0 -260.0 moveto
199.0 -270.0 lineto
203.0 -260.0 lineto
closepath
fill
newpath
308.0 -260.0 moveto
311.0 -270.0 lineto
315.0 -260.0 lineto
closepath
fill
newpath
199.0 -215.0 moveto
199.0 -245.0 lineto
stroke
newpath
87.0 -265.0 moveto
87.0 -250.0 lineto
87.0 -246.66666666666666 88.33333333333333 -245.0 91.0 -245.0 curveto
199.0 -245.0 lineto
199.0 -245.0 lineto
stroke
newpath
199.0 -265.0 moveto
199.0 -245.0 lineto
stroke
newpath
311.0 -265.0 moveto
311.0 -250.0 lineto
311.0 -246.66666666666666 310.0 -245.0 308.0 -245.0 curveto
199.0 -245.0 lineto
199.0 -245.0 lineto
stroke
/Helvetica findfont
10 scalefont setfont
173.0 -49.0 moveto
(Publisher) show
190.0 -78.0 moveto
(PUB) show
319.0 -119.0 moveto
(Fast box) show
190.0 -148.0 moveto
(SUB) show
173.0 -179.0 moveto
(Subscriber) show
183.0 -208.0 moveto
(PUSH) show
71.0 -289.0 moveto
(PULL) show
183.0 -289.0 moveto
(PULL) show
295.0 -289.0 moveto
(PULL) show
63.0 -319.0 moveto
(Worker) show
175.0 -319.0 moveto
(Worker) show
287.0 -319.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4395 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4395 a -2 4562 a
SDict begin H.S end
 -2 4562
a -2 4562 a
SDict begin 13 H.A end
 -2 4562 a -2 4562 a
SDict begin [/View [/XYZ H.V]/Dest (0:2828) cvn /DEST pdfmark end
 -2 4562 a 396 4669 a
Fj(The)g(subscriber)f(talks)i(to)f(the)g(publisher)f(o)o(v)o(er)g(TCP)i
(or)f(PGM.)g(The)g(subscriber)f(talks)i(to)f(its)h(w)o(ork)o(ers,)e
(which)h(are)g(all)396 4777 y(in)h(the)f(same)g(process,)g(o)o(v)o(er)e
(inproc.)-2 4961 y
SDict begin H.S end
 -2 4961 a -2 4961 a
SDict begin 13 H.A end
 -2 4961 a -2 4961
a
SDict begin [/View [/XYZ H.V]/Dest (0:2829) cvn /DEST pdfmark end
 -2 4961 a 396 5051 a Fj(No)n(w)i(to)h(break)e(that)h(ceiling.)g(What)
g(happens)f(is)i(that)f(the)h(subscriber)e(thread)g(hits)i(100\045)e
(of)h(CPU,)h(and)f(since)g(it)h(is)396 5159 y(one)e(thread,)g(it)h
(cannot)e(use)i(more)f(than)g(one)g(core.)g(A)h(single)f(thread)g(will)
h(al)o(w)o(ays)g(hit)g(a)g(ceiling,)f(be)g(it)i(at)f(2M,)f(6M,)g(or)p
Black 3759 5569 a Fi(234)p Black eop end
%%Page: 235 249
TeXDict begin 235 248 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.235) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black 396 72 a Fj(more)20 b(messages)g(per)g(second.)
f(W)-7 b(e)21 b(w)o(ant)f(to)h(split)g(the)f(w)o(ork)f(across)i
(multiple)e(threads)h(that)g(can)g(run)f(in)i(parallel.)396
346 y(The)f(approach)e(used)i(by)g(man)o(y)f(high-performance)c
(products,)k(which)g(w)o(orks)h(here,)g(is)h Fi(shar)m(ding)p
Fj(,)d(meaning)h(we)396 454 y(split)i(the)f(w)o(ork)g(into)g(parallel)f
(and)h(independent)e(streams.)i(E.g.)f(half)h(of)g(the)g(topic)g(k)o(e)
o(ys)g(are)g(in)g(one)g(stream,)g(half)g(in)396 562 y(another\()p
0 TeXcolorgray 675 562 a
SDict begin H.S end
 675 562 a Fj(Figure)d(5-2)1022
562 y
SDict begin 13 H.L end
 1022 562 a 1022 562 a
SDict begin [/Subtype /Link/Dest (0:figure-63) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1022 562 a Black -1 w Fj(\).)j(W)-7
b(e)21 b(could)e(use)h(man)o(y)f(streams,)h(b)n(ut)g(performance)d(w)o
(on')o(t)i(scale)i(unless)f(we)g(ha)n(v)o(e)g(free)f(cores.)-2
746 y
SDict begin H.S end
 -2 746 a -2 746 a
SDict begin 13 H.A end
 -2 746 a -2 746 a
SDict begin [/View [/XYZ H.V]/Dest (0:2833) cvn /DEST pdfmark end
 -2 746 a 396
836 a Fj(So)i(let')-5 b(s)21 b(see)g(ho)n(w)e(to)i(shard)e(into)h(tw)o
(o)h(streams:)-2 837 y
SDict begin H.S end
 -2 837 a -2 837 a
SDict begin 13 H.A end
 -2 837 a -2
837 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-63) cvn /DEST pdfmark
end
 -2 837 a 396 1038 a Fk(Figur)o(e)f(5-2.)f(Mad)i(Black)f(Box)h(P)o
(atter)o(n)-2 1137 y
SDict begin H.S end
 -2 1137 a -2 1137 a
SDict begin 13 H.A end
 -2 1137 a -2
1137 a
SDict begin [/View [/XYZ H.V]/Dest (0:2836) cvn /DEST pdfmark end
 -2 1137 a 396 4029 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4029 a @beginspecial
0 @llx -342 @lly 378 @urx 0 @ury 3780 @rwi @setspecial
%%BeginDocument: images/fig63.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -342 378 0
%%HiResBoundingBox: 0.0 -342.0 378.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
160.80018615722656 -23.800180435180664 moveto
160.80018615722656 -59.80017852783203 lineto
232.80018615722656 -59.80017852783203 lineto
232.80018615722656 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
160.80018615722656 -59.80017852783203 moveto
160.80018615722656 -73.80017852783203 lineto
160.80018615722656 -76.4668451944987 161.80018615722656 -77.80017852783203 163.80018615722656 -77.80017852783203 curveto
195.60018920898438 -77.80017852783203 lineto
194.80018615722656 -77.80017852783203 lineto
194.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
197.80018615722656 -59.80017852783203 moveto
197.80018615722656 -77.80017852783203 lineto
229.80018615722656 -77.80017852783203 lineto
231.80018615722656 -77.80017852783203 232.80018615722656 -76.4668451944987 232.80018615722656 -73.80017852783203 curveto
232.80018615722656 -59.80017852783203 lineto
232.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.80018615722656 -122.80017852783203 moveto
161.80018615722656 -122.80017852783203 160.80018615722656 -124.4668451944987 160.80018615722656 -127.80017852783203 curveto
160.80018615722656 -140.80018615722656 lineto
194.80018615722656 -140.80018615722656 lineto
194.80018615722656 -122.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
197.80018615722656 -122.80017852783203 moveto
197.80018615722656 -140.80018615722656 lineto
232.80018615722656 -140.80018615722656 lineto
232.80018615722656 -127.80017852783203 lineto
232.80018615722656 -124.4668451944987 231.80018615722656 -122.80017852783203 229.80018615722656 -122.80017852783203 curveto
198.00018310546875 -122.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
160.80018615722656 -140.80018615722656 moveto
160.80018615722656 -176.80018615722656 lineto
232.80018615722656 -176.80018615722656 lineto
232.80018615722656 -140.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
160.80018615722656 -176.80018615722656 moveto
160.80018615722656 -190.80018615722656 lineto
160.80018615722656 -193.46685282389322 161.80018615722656 -194.80018615722656 163.80018615722656 -194.80018615722656 curveto
195.60018920898438 -194.80018615722656 lineto
194.80018615722656 -194.80018615722656 lineto
194.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
197.80018615722656 -176.80018615722656 moveto
197.80018615722656 -194.80018615722656 lineto
229.80018615722656 -194.80018615722656 lineto
231.80018615722656 -194.80018615722656 232.80018615722656 -193.46685282389322 232.80018615722656 -190.80018615722656 curveto
232.80018615722656 -176.80018615722656 lineto
232.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
67.80017852783203 -248.80018615722656 moveto
65.80017852783203 -248.80018615722656 64.80017852783203 -250.46685282389322 64.80017852783203 -253.80018615722656 curveto
64.80017852783203 -264.8001708984375 lineto
136.80018615722656 -264.8001708984375 lineto
136.80018615722656 -253.80018615722656 lineto
136.80018615722656 -250.46685282389322 135.80018615722656 -248.80018615722656 133.80018615722656 -248.80018615722656 curveto
67.80017852783203 -248.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
64.80017852783203 -267.8001708984375 moveto
64.80017852783203 -302.8001708984375 lineto
136.80018615722656 -302.8001708984375 lineto
136.80018615722656 -267.8001708984375 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.80018615722656 -248.80018615722656 moveto
161.80018615722656 -248.80018615722656 160.80018615722656 -250.46685282389322 160.80018615722656 -253.80018615722656 curveto
160.80018615722656 -264.8001708984375 lineto
232.80018615722656 -264.8001708984375 lineto
232.80018615722656 -253.80018615722656 lineto
232.80018615722656 -250.46685282389322 231.80018615722656 -248.80018615722656 229.80018615722656 -248.80018615722656 curveto
163.80018615722656 -248.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
160.80018615722656 -267.8001708984375 moveto
160.80018615722656 -302.8001708984375 lineto
232.80018615722656 -302.8001708984375 lineto
232.80018615722656 -267.8001708984375 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
259.8001708984375 -248.80018615722656 moveto
257.8001708984375 -248.80018615722656 256.8001708984375 -250.46685282389322 256.8001708984375 -253.80018615722656 curveto
256.8001708984375 -264.8001708984375 lineto
328.8001708984375 -264.8001708984375 lineto
328.8001708984375 -253.80018615722656 lineto
328.8001708984375 -250.46685282389322 327.8001708984375 -248.80018615722656 325.8001708984375 -248.80018615722656 curveto
259.8001708984375 -248.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
256.8001708984375 -267.8001708984375 moveto
256.8001708984375 -302.8001708984375 lineto
328.8001708984375 -302.8001708984375 lineto
328.8001708984375 -267.8001708984375 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
159.0 -22.0 moveto
159.0 -58.0 lineto
231.0 -58.0 lineto
231.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
159.0 -22.0 moveto
159.0 -58.0 lineto
231.0 -58.0 lineto
231.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
159.0 -58.0 moveto
159.0 -72.0 lineto
159.0 -74.66666666666667 160.0 -76.0 162.0 -76.0 curveto
193.8000030517578 -76.0 lineto
193.0 -76.0 lineto
193.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
159.0 -58.0 moveto
159.0 -72.0 lineto
159.0 -74.66666666666667 160.0 -76.0 162.0 -76.0 curveto
193.8000030517578 -76.0 lineto
193.0 -76.0 lineto
193.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
196.0 -58.0 moveto
196.0 -76.0 lineto
228.0 -76.0 lineto
230.0 -76.0 231.0 -74.66666666666667 231.0 -72.0 curveto
231.0 -58.0 lineto
231.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
196.0 -58.0 moveto
196.0 -76.0 lineto
228.0 -76.0 lineto
230.0 -76.0 231.0 -74.66666666666667 231.0 -72.0 curveto
231.0 -58.0 lineto
231.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
162.0 -121.0 moveto
160.0 -121.0 159.0 -122.66666666666667 159.0 -126.0 curveto
159.0 -139.0 lineto
193.0 -139.0 lineto
193.0 -121.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
162.0 -121.0 moveto
160.0 -121.0 159.0 -122.66666666666667 159.0 -126.0 curveto
159.0 -139.0 lineto
193.0 -139.0 lineto
193.0 -121.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
196.0 -121.0 moveto
196.0 -139.0 lineto
231.0 -139.0 lineto
231.0 -126.0 lineto
231.0 -122.66666666666667 230.0 -121.0 228.0 -121.0 curveto
196.1999969482422 -121.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
196.0 -121.0 moveto
196.0 -139.0 lineto
231.0 -139.0 lineto
231.0 -126.0 lineto
231.0 -122.66666666666667 230.0 -121.0 228.0 -121.0 curveto
196.1999969482422 -121.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
159.0 -139.0 moveto
159.0 -175.0 lineto
231.0 -175.0 lineto
231.0 -139.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
159.0 -139.0 moveto
159.0 -175.0 lineto
231.0 -175.0 lineto
231.0 -139.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
159.0 -175.0 moveto
159.0 -189.0 lineto
159.0 -191.66666666666666 160.0 -193.0 162.0 -193.0 curveto
193.8000030517578 -193.0 lineto
193.0 -193.0 lineto
193.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
159.0 -175.0 moveto
159.0 -189.0 lineto
159.0 -191.66666666666666 160.0 -193.0 162.0 -193.0 curveto
193.8000030517578 -193.0 lineto
193.0 -193.0 lineto
193.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
196.0 -175.0 moveto
196.0 -193.0 lineto
228.0 -193.0 lineto
230.0 -193.0 231.0 -191.66666666666666 231.0 -189.0 curveto
231.0 -175.0 lineto
231.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
196.0 -175.0 moveto
196.0 -193.0 lineto
228.0 -193.0 lineto
230.0 -193.0 231.0 -191.66666666666666 231.0 -189.0 curveto
231.0 -175.0 lineto
231.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
66.0 -247.0 moveto
64.0 -247.0 63.0 -248.66666666666666 63.0 -252.0 curveto
63.0 -263.0 lineto
135.0 -263.0 lineto
135.0 -252.0 lineto
135.0 -248.66666666666666 134.0 -247.0 132.0 -247.0 curveto
66.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
66.0 -247.0 moveto
64.0 -247.0 63.0 -248.66666666666666 63.0 -252.0 curveto
63.0 -263.0 lineto
135.0 -263.0 lineto
135.0 -252.0 lineto
135.0 -248.66666666666666 134.0 -247.0 132.0 -247.0 curveto
66.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
63.0 -266.0 moveto
63.0 -301.0 lineto
135.0 -301.0 lineto
135.0 -266.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
63.0 -266.0 moveto
63.0 -301.0 lineto
135.0 -301.0 lineto
135.0 -266.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
162.0 -247.0 moveto
160.0 -247.0 159.0 -248.66666666666666 159.0 -252.0 curveto
159.0 -263.0 lineto
231.0 -263.0 lineto
231.0 -252.0 lineto
231.0 -248.66666666666666 230.0 -247.0 228.0 -247.0 curveto
162.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
162.0 -247.0 moveto
160.0 -247.0 159.0 -248.66666666666666 159.0 -252.0 curveto
159.0 -263.0 lineto
231.0 -263.0 lineto
231.0 -252.0 lineto
231.0 -248.66666666666666 230.0 -247.0 228.0 -247.0 curveto
162.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
159.0 -266.0 moveto
159.0 -301.0 lineto
231.0 -301.0 lineto
231.0 -266.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
159.0 -266.0 moveto
159.0 -301.0 lineto
231.0 -301.0 lineto
231.0 -266.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
258.0 -247.0 moveto
256.0 -247.0 255.0 -248.66666666666666 255.0 -252.0 curveto
255.0 -263.0 lineto
327.0 -263.0 lineto
327.0 -252.0 lineto
327.0 -248.66666666666666 326.0 -247.0 324.0 -247.0 curveto
258.0 -247.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
258.0 -247.0 moveto
256.0 -247.0 255.0 -248.66666666666666 255.0 -252.0 curveto
255.0 -263.0 lineto
327.0 -263.0 lineto
327.0 -252.0 lineto
327.0 -248.66666666666666 326.0 -247.0 324.0 -247.0 curveto
258.0 -247.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
255.0 -266.0 moveto
255.0 -301.0 lineto
327.0 -301.0 lineto
327.0 -266.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
255.0 -266.0 moveto
255.0 -301.0 lineto
327.0 -301.0 lineto
327.0 -266.0 lineto
closepath
stroke
0.6 setlinewidth
0 setlinecap
[3.0] 0.0 setdash
newpath
174.0 -94.0 moveto
27.0 -94.0 lineto
27.0 -319.0 lineto
363.0 -319.0 lineto
363.0 -94.0 lineto
216.0 -94.0 lineto
stroke
newpath
180.0 -94.0 moveto
210.0 -94.0 lineto
stroke
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
177.0 -76.0 moveto
177.0 -112.0 lineto
stroke
newpath
213.0 -76.0 moveto
213.0 -112.0 lineto
stroke
newpath
213.0 -193.0 moveto
213.0 -220.0 lineto
288.0 -220.0 lineto
290.0 -220.0 291.0 -221.66666666666666 291.0 -225.0 curveto
291.0 -238.0 lineto
291.0 -238.0 lineto
stroke
newpath
174.0 -108.0 moveto
177.0 -117.0 lineto
180.0 -108.0 lineto
closepath
fill
newpath
210.0 -108.0 moveto
213.0 -117.0 lineto
216.0 -108.0 lineto
closepath
fill
newpath
96.0 -234.0 moveto
99.0 -243.0 lineto
102.0 -234.0 lineto
closepath
fill
newpath
192.0 -234.0 moveto
195.0 -243.0 lineto
198.0 -234.0 lineto
closepath
fill
newpath
288.0 -234.0 moveto
291.0 -243.0 lineto
294.0 -234.0 lineto
closepath
fill
newpath
177.0 -193.0 moveto
177.0 -220.0 lineto
stroke
newpath
99.0 -238.0 moveto
99.0 -225.0 lineto
99.0 -221.66666666666666 100.0 -220.0 102.0 -220.0 curveto
177.0 -220.0 lineto
177.0 -220.0 lineto
stroke
newpath
195.0 -238.0 moveto
195.0 -220.0 lineto
177.0 -220.0 lineto
stroke
/Helvetica findfont
9 scalefont setfont
173.0 -44.0 moveto
(Publisher) show
169.0 -71.0 moveto
(PUB) show
205.0 -71.0 moveto
(PUB) show
297.0 -107.0 moveto
(Fast box) show
169.0 -134.0 moveto
(SUB) show
205.0 -134.0 moveto
(SUB) show
173.0 -161.0 moveto
(Subscriber) show
172.0 -188.0 moveto
(PUSH PUSH) show
85.0 -260.0 moveto
(PULL) show
181.0 -260.0 moveto
(PULL) show
277.0 -260.0 moveto
(PULL) show
78.0 -287.0 moveto
(Worker) show
174.0 -287.0 moveto
(Worker) show
270.0 -287.0 moveto
(Worker) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4029 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4029 a -2 4195 a
SDict begin H.S end
 -2 4195
a -2 4195 a
SDict begin 13 H.A end
 -2 4195 a -2 4195 a
SDict begin [/View [/XYZ H.V]/Dest (0:2839) cvn /DEST pdfmark end
 -2 4195 a 396 4303 a
Fj(W)m(ith)g(tw)o(o)f(streams,)g(w)o(orking)f(at)i(full)f(speed,)f(we)i
(w)o(ould)e(con\002gure)g(\330MQ)h(as)h(follo)n(ws:)-2
4321 y
SDict begin H.S end
 -2 4321 a -2 4321 a
SDict begin 13 H.A end
 -2 4321 a -2 4321 a
SDict begin [/View [/XYZ H.V]/Dest (0:2840) cvn /DEST pdfmark end
 -2 4321
a -2 4331 a
SDict begin H.S end
 -2 4331 a -2 4331 a
SDict begin 13 H.A end
 -2 4331 a -2 4331 a
SDict begin [/View [/XYZ H.V]/Dest (0:2841) cvn /DEST pdfmark end
 -2
4331 a Black 396 4473 a Fe(\225)p Black 479 4473 a
SDict begin H.S end
 479
4473 a 479 4473 a
SDict begin 13 H.A end
 479 4473 a 479 4473 a
SDict begin [/View [/XYZ H.V]/Dest (0:2842) cvn /DEST pdfmark end
 479 4473 a Fj(T)-7
b(w)o(o)21 b(I/O)f(threads,)f(rather)h(than)g(one.)-2
4485 y
SDict begin H.S end
 -2 4485 a -2 4485 a
SDict begin 13 H.A end
 -2 4485 a -2 4485 a
SDict begin [/View [/XYZ H.V]/Dest (0:2843) cvn /DEST pdfmark end
 -2 4485
a Black 396 4623 a Fe(\225)p Black 479 4623 a
SDict begin H.S end
 479 4623
a 479 4623 a
SDict begin 13 H.A end
 479 4623 a 479 4623 a
SDict begin [/View [/XYZ H.V]/Dest (0:2844) cvn /DEST pdfmark end
 479 4623 a Fj(T)-7
b(w)o(o)21 b(netw)o(ork)e(interf)o(aces)g(\(NIC\),)h(one)g(per)g
(subscriber)-5 b(.)-2 4641 y
SDict begin H.S end
 -2 4641 a -2 4641 a
SDict begin 13 H.A end
 -2 4641
a -2 4641 a
SDict begin [/View [/XYZ H.V]/Dest (0:2845) cvn /DEST pdfmark end
 -2 4641 a Black 396 4772 a Fe(\225)p Black
479 4772 a
SDict begin H.S end
 479 4772 a 479 4772 a
SDict begin 13 H.A end
 479 4772 a 479 4772
a
SDict begin [/View [/XYZ H.V]/Dest (0:2846) cvn /DEST pdfmark end
 479 4772 a Fj(Each)20 b(I/O)g(thread)g(bound)e(to)i(a)h(speci\002c)f
(NIC.)-2 4790 y
SDict begin H.S end
 -2 4790 a -2 4790 a
SDict begin 13 H.A end
 -2 4790 a -2 4790
a
SDict begin [/View [/XYZ H.V]/Dest (0:2847) cvn /DEST pdfmark end
 -2 4790 a Black 396 4921 a Fe(\225)p Black 479 4921
a
SDict begin H.S end
 479 4921 a 479 4921 a
SDict begin 13 H.A end
 479 4921 a 479 4921 a
SDict begin [/View [/XYZ H.V]/Dest (0:2848) cvn /DEST pdfmark end
 479 4921
a Fj(T)-7 b(w)o(o)21 b(subscriber)e(threads,)g(bound)f(to)j(speci\002c)
f(cores.)-2 4939 y
SDict begin H.S end
 -2 4939 a -2 4939 a
SDict begin 13 H.A end
 -2 4939 a -2 4939
a
SDict begin [/View [/XYZ H.V]/Dest (0:2849) cvn /DEST pdfmark end
 -2 4939 a Black 396 5071 a Fe(\225)p Black 479 5071
a
SDict begin H.S end
 479 5071 a 479 5071 a
SDict begin 13 H.A end
 479 5071 a 479 5071 a
SDict begin [/View [/XYZ H.V]/Dest (0:2850) cvn /DEST pdfmark end
 479 5071
a Fj(T)-7 b(w)o(o)21 b(SUB)g(sock)o(ets,)f(one)g(per)f(subscriber)g
(thread.)-2 5089 y
SDict begin H.S end
 -2 5089 a -2 5089 a
SDict begin 13 H.A end
 -2 5089 a -2 5089
a
SDict begin [/View [/XYZ H.V]/Dest (0:2851) cvn /DEST pdfmark end
 -2 5089 a Black 3759 5569 a Fi(235)p Black eop end
%%Page: 236 250
TeXDict begin 236 249 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.236) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2882) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black Black 396
72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72
a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2852) cvn /DEST pdfmark end
 479 72 a Fj(The)20 b(remaining)f(cores)g(assigned)h(to)h(w)o
(ork)o(er)e(threads.)-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a
-2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:2853) cvn /DEST pdfmark end
 -2 90 a Black 396 222 a Fe(\225)p Black 479 222
a
SDict begin H.S end
 479 222 a 479 222 a
SDict begin 13 H.A end
 479 222 a 479 222 a
SDict begin [/View [/XYZ H.V]/Dest (0:2854) cvn /DEST pdfmark end
 479 222 a Fj(W)-7
b(ork)o(er)20 b(threads)g(connected)e(to)i(both)g(subscriber)f(PUSH)i
(sock)o(ets.)-2 389 y
SDict begin H.S end
 -2 389 a -2 389 a
SDict begin 13 H.A end
 -2 389 a -2 389
a
SDict begin [/View [/XYZ H.V]/Dest (0:2855) cvn /DEST pdfmark end
 -2 389 a 396 496 a Fj(W)m(ith)g(ideally)-5 b(,)19 b(no)h(more)f
(threads)h(in)g(our)f(architecture)g(than)h(we)g(had)g(cores.)f(Once)h
(we)h(create)f(more)f(threads)h(than)396 604 y(cores,)g(we)h(get)f
(contention)e(between)h(threads,)h(and)f(diminishing)g(returns.)g
(There)g(w)o(ould)h(be)g(no)g(bene\002t,)f(for)396 712
y(e)o(xample,)g(in)h(creating)f(more)h(I/O)g(threads.)-2
740 y
SDict begin H.S end
 -2 740 a -2 740 a
SDict begin 13 H.A end
 -2 740 a -2 740 a
SDict begin [/View [/XYZ H.V]/Dest (0:2856) cvn /DEST pdfmark end
 -2 740 a 359
x Fh(5.3.)39 b(A)g(Shared)g(K)n(e)n(y-V)-9 b(alue)37
b(Cac)o(he)h(\(Clone)g(P)l(attern\))3162 1099 y
SDict begin H.S end
 3162
1099 a 3162 1099 a
SDict begin 22.464 H.A end
 3162 1099 a 3162 1099 a
SDict begin [/View [/XYZ H.V]/Dest (10.57.1) cvn /DEST pdfmark end
 3162 1099
a -2 1295 a
SDict begin H.S end
 -2 1295 a -2 1295 a
SDict begin 13 H.A end
 -2 1295 a -2 1295 a
SDict begin [/View [/XYZ H.V]/Dest (0:2858) cvn /DEST pdfmark end
 -2
1295 a 396 1373 a Fj(Pub-sub)19 b(is)i(lik)o(e)g(a)f(radio)g
(broadcast,)e(you)i(miss)h(e)n(v)o(erything)c(before)i(you)g(join,)h
(and)g(then)f(ho)n(w)h(much)f(information)396 1481 y(you)h(get)g
(depends)f(on)g(the)i(quality)e(of)h(your)f(reception.)f(Surprisingly)
-5 b(,)18 b(for)h(engineers)g(who)h(are)g(used)g(to)g(aiming)g(for)396
1589 y("perfection",)e(this)j(model)e(is)i(useful)f(and)g(wide-spread,)
e(because)h(it)i(maps)f(perfectly)f(to)h(real-w)o(orld)f(distrib)n
(ution)g(of)396 1697 y(information.)f(Think)h(of)h(F)o(acebook)e(and)i
(T)-7 b(witter)m(,)20 b(the)g(BBC)i(W)-7 b(orld)20 b(Service,)g(and)f
(the)h(sports)g(results.)-2 1881 y
SDict begin H.S end
 -2 1881 a -2 1881
a
SDict begin 13 H.A end
 -2 1881 a -2 1881 a
SDict begin [/View [/XYZ H.V]/Dest (0:2859) cvn /DEST pdfmark end
 -2 1881 a 396 1971 a Fj(Ho)n(we)n(v)o(er)m(,)e
(there)i(are)g(also)h(a)f(whole)g(lot)g(of)g(cases)h(where)f(more)f
(reliable)h(pub-sub)e(w)o(ould)i(be)g(v)n(aluable,)e(if)j(we)f(could)
396 2079 y(do)g(it.)h(As)g(we)f(did)g(for)g(request-reply)-5
b(,)17 b(let')-5 b(s)21 b(de\002ne)f(\224reliability')f(in)h(terms)g
(of)g(what)g(can)g(go)g(wrong.)f(Here)h(are)g(the)396
2187 y(classic)h(problems)e(with)h(pub-sub:)-2 2205 y
SDict begin H.S end

-2 2205 a -2 2205 a
SDict begin 13 H.A end
 -2 2205 a -2 2205 a
SDict begin [/View [/XYZ H.V]/Dest (0:2860) cvn /DEST pdfmark end
 -2 2205 a -2
2215 a
SDict begin H.S end
 -2 2215 a -2 2215 a
SDict begin 13 H.A end
 -2 2215 a -2 2215 a
SDict begin [/View [/XYZ H.V]/Dest (0:2861) cvn /DEST pdfmark end
 -2 2215
a Black 396 2357 a Fe(\225)p Black 479 2357 a
SDict begin H.S end
 479 2357
a 479 2357 a
SDict begin 13 H.A end
 479 2357 a 479 2357 a
SDict begin [/View [/XYZ H.V]/Dest (0:2862) cvn /DEST pdfmark end
 479 2357 a Fj(Subscribers)f(join)h
(late,)h(so)f(miss)h(messages)g(the)f(serv)o(er)f(already)g(sent.)-2
2375 y
SDict begin H.S end
 -2 2375 a -2 2375 a
SDict begin 13 H.A end
 -2 2375 a -2 2375 a
SDict begin [/View [/XYZ H.V]/Dest (0:2863) cvn /DEST pdfmark end
 -2 2375
a Black 396 2506 a Fe(\225)p Black 479 2506 a
SDict begin H.S end
 479 2506
a 479 2506 a
SDict begin 13 H.A end
 479 2506 a 479 2506 a
SDict begin [/View [/XYZ H.V]/Dest (0:2864) cvn /DEST pdfmark end
 479 2506 a Fj(Subscriber)g
(connections)f(are)j(slo)n(w)-5 b(,)19 b(and)h(can)g(lose)h(messages)f
(during)e(that)j(time.)-2 2524 y
SDict begin H.S end
 -2 2524 a -2 2524 a
SDict begin 13 H.A end

-2 2524 a -2 2524 a
SDict begin [/View [/XYZ H.V]/Dest (0:2865) cvn /DEST pdfmark end
 -2 2524 a Black 396 2656 a Fe(\225)p
Black 479 2656 a
SDict begin H.S end
 479 2656 a 479 2656 a
SDict begin 13 H.A end
 479 2656 a 479
2656 a
SDict begin [/View [/XYZ H.V]/Dest (0:2866) cvn /DEST pdfmark end
 479 2656 a Fj(Subscribers)e(go)h(a)o(w)o(ay)-5
b(,)19 b(and)h(lose)h(messages)f(while)g(the)o(y)g(are)g(a)o(w)o(ay)-5
b(.)-2 2840 y
SDict begin H.S end
 -2 2840 a -2 2840 a
SDict begin 13 H.A end
 -2 2840 a -2 2840 a
SDict begin [/View [/XYZ H.V]/Dest (0:2867) cvn /DEST pdfmark end

-2 2840 a 396 2930 a Fj(Less)21 b(often,)e(we)i(see)g(problems)d(lik)o
(e)j(these:)-2 2948 y
SDict begin H.S end
 -2 2948 a -2 2948 a
SDict begin 13 H.A end
 -2 2948 a -2
2948 a
SDict begin [/View [/XYZ H.V]/Dest (0:2868) cvn /DEST pdfmark end
 -2 2948 a -2 2958 a
SDict begin H.S end
 -2 2958 a -2 2958 a
SDict begin 13 H.A end
 -2 2958
a -2 2958 a
SDict begin [/View [/XYZ H.V]/Dest (0:2869) cvn /DEST pdfmark end
 -2 2958 a Black 396 3100 a Fe(\225)p Black
479 3100 a
SDict begin H.S end
 479 3100 a 479 3100 a
SDict begin 13 H.A end
 479 3100 a 479 3100
a
SDict begin [/View [/XYZ H.V]/Dest (0:2870) cvn /DEST pdfmark end
 479 3100 a Fj(Subscribers)e(can)h(crash,)g(and)g(restart,)g(and)f
(lose)i(whate)n(v)o(er)e(data)h(the)o(y)f(already)g(recei)n(v)o(ed.)-2
3118 y
SDict begin H.S end
 -2 3118 a -2 3118 a
SDict begin 13 H.A end
 -2 3118 a -2 3118 a
SDict begin [/View [/XYZ H.V]/Dest (0:2871) cvn /DEST pdfmark end
 -2 3118
a Black 396 3250 a Fe(\225)p Black 479 3250 a
SDict begin H.S end
 479 3250
a 479 3250 a
SDict begin 13 H.A end
 479 3250 a 479 3250 a
SDict begin [/View [/XYZ H.V]/Dest (0:2872) cvn /DEST pdfmark end
 479 3250 a Fj(Subscribers)g(can)h
(fetch)g(messages)g(too)g(slo)n(wly)-5 b(,)20 b(so)g(queues)g(b)n(uild)
f(up)h(and)g(then)g(o)o(v)o(er\003o)n(w)-5 b(.)-2 3267
y
SDict begin H.S end
 -2 3267 a -2 3267 a
SDict begin 13 H.A end
 -2 3267 a -2 3267 a
SDict begin [/View [/XYZ H.V]/Dest (0:2873) cvn /DEST pdfmark end
 -2 3267 a Black
396 3399 a Fe(\225)p Black 479 3399 a
SDict begin H.S end
 479 3399 a 479
3399 a
SDict begin 13 H.A end
 479 3399 a 479 3399 a
SDict begin [/View [/XYZ H.V]/Dest (0:2874) cvn /DEST pdfmark end
 479 3399 a Fj(Netw)o(orks)20
b(can)g(become)f(o)o(v)o(erloaded)e(and)j(drop)f(data)h
(\(speci\002cally)-5 b(,)19 b(for)g(PGM\).)-2 3417 y
SDict begin H.S end

-2 3417 a -2 3417 a
SDict begin 13 H.A end
 -2 3417 a -2 3417 a
SDict begin [/View [/XYZ H.V]/Dest (0:2875) cvn /DEST pdfmark end
 -2 3417 a Black
396 3548 a Fe(\225)p Black 479 3548 a
SDict begin H.S end
 479 3548 a 479
3548 a
SDict begin 13 H.A end
 479 3548 a 479 3548 a
SDict begin [/View [/XYZ H.V]/Dest (0:2876) cvn /DEST pdfmark end
 479 3548 a Fj(Netw)o(orks)h(can)g(become)f
(too)h(slo)n(w)-5 b(,)20 b(so)g(publisher)n(-side)f(queues)g(o)o(v)o
(er\003o)n(w)-5 b(,)18 b(and)h(publishers)g(crash.)-2
3732 y
SDict begin H.S end
 -2 3732 a -2 3732 a
SDict begin 13 H.A end
 -2 3732 a -2 3732 a
SDict begin [/View [/XYZ H.V]/Dest (0:2877) cvn /DEST pdfmark end
 -2 3732
a 396 3822 a Fj(A)i(lot)f(more)g(can)g(go)g(wrong)e(b)n(ut)j(these)f
(are)g(the)g(typical)g(f)o(ailures)g(we)g(see)h(in)g(a)f(realistic)h
(system.)-2 4006 y
SDict begin H.S end
 -2 4006 a -2 4006 a
SDict begin 13 H.A end
 -2 4006 a -2 4006
a
SDict begin [/View [/XYZ H.V]/Dest (0:2878) cvn /DEST pdfmark end
 -2 4006 a 396 4096 a Fj(W)-7 b(e')l(v)o(e)19 b(already)f(solv)o(ed)g
(some)h(of)g(these,)g(such)f(as)i(the)f(slo)n(w)h(subscriber)m(,)d
(which)h(we)i(handle)e(with)h(the)g(Suicidal)f(Snail)396
4204 y(pattern.)h(But)i(for)f(the)g(rest,)g(it)h(w)o(ould)f(be)g(nice)g
(to)g(ha)n(v)o(e)g(a)g(generic,)f(reusable)h(frame)n(w)o(ork)e(for)h
(reliable)h(pub-sub)m(.)-2 4388 y
SDict begin H.S end
 -2 4388 a -2 4388 a
SDict begin 13 H.A end

-2 4388 a -2 4388 a
SDict begin [/View [/XYZ H.V]/Dest (0:2879) cvn /DEST pdfmark end
 -2 4388 a 396 4478 a Fj(The)g(dif)n(\002culty)f(is)
i(that)g(we)f(ha)n(v)o(e)g(no)g(idea)g(what)g(our)f(tar)o(get)h
(applications)f(actually)g(w)o(ant)h(to)h(do)f(with)g(their)g(data.)g
(Do)396 4586 y(the)o(y)g(\002lter)g(it,)h(and)f(process)f(only)h(a)g
(subset)h(of)f(messages?)g(Do)g(the)o(y)f(log)h(the)g(data)h(some)n
(where)d(for)i(later)g(reuse?)g(Do)396 4694 y(the)o(y)f(distrib)n(ute)g
(the)h(data)f(further)f(to)i(w)o(ork)o(ers?)f(There)g(are)g(dozens)g
(of)g(plausible)g(scenarios,)g(and)g(each)g(will)i(ha)n(v)o(e)e(its)396
4802 y(o)n(wn)h(ideas)g(about)f(what)i(reliability)e(means)h(and)g(ho)n
(w)f(much)h(it')-5 b(s)21 b(w)o(orth)f(in)g(terms)g(of)g(ef)n(fort)f
(and)h(performance.)p Black 3757 5569 a Fi(236)p Black
eop end
%%Page: 237 251
TeXDict begin 237 250 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.237) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2905) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end

-2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2880) cvn /DEST pdfmark end
 -2 -11 a 396 72 a
Fj(So)21 b(we')o(ll)f(b)n(uild)g(an)g(abstraction)f(that)h(we)h(can)f
(implement)f(once,)g(and)h(then)g(reuse)f(for)h(man)o(y)f
(applications.)g(This)396 180 y(abstraction)g(is)i(a)915
180 y
SDict begin H.S end
 915 180 a 915 180 a
SDict begin 13 H.A end
 915 180 a 915 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:2881) cvn /DEST pdfmark end
 915 180
a Fk(shar)o(ed)f(k)o(ey-v)o(alue)g(cache)p Fj(,)f(which)h(stores)g(a)h
(set)g(of)f(blobs)g(inde)o(x)o(ed)e(by)i(unique)e(k)o(e)o(ys.)396
454 y(Don')o(t)h(confuse)g(this)i(with)f Fi(distrib)n(uted)g(hash)g
(tables)p Fj(,)g(which)f(solv)o(e)h(the)g(wider)g(problem)e(of)i
(connecting)e(peers)i(in)h(a)396 562 y(distrib)n(uted)f(netw)o(ork,)e
(or)i(with)1342 562 y
SDict begin H.S end
 1342 562 a 1342 562 a
SDict begin 13 H.A end
 1342 562
a 1342 562 a
SDict begin [/View [/XYZ H.V]/Dest (0:2884) cvn /DEST pdfmark end
 1342 562 a Fi(distrib)n(uted)f(k)o(e)n(y-value)g(tables)p
Fj(,)h(which)f(act)i(lik)o(e)f(non-SQL)f(databases.)h(All)h(we)f(will)
396 670 y(b)n(uild)g(is)h(a)g(system)f(that)g(reliably)g(clones)g(some)
g(in-memory)d(state)k(from)f(a)g(serv)o(er)f(to)i(a)f(set)h(of)f
(clients.)h(W)-7 b(e)21 b(w)o(ant)f(to:)-2 688 y
SDict begin H.S end
 -2 688
a -2 688 a
SDict begin 13 H.A end
 -2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:2885) cvn /DEST pdfmark end
 -2 688 a -2 698 a
SDict begin H.S end
 -2 698
a -2 698 a
SDict begin 13 H.A end
 -2 698 a -2 698 a
SDict begin [/View [/XYZ H.V]/Dest (0:2886) cvn /DEST pdfmark end
 -2 698 a Black 396 840 a
Fe(\225)p Black 479 840 a
SDict begin H.S end
 479 840 a 479 840 a
SDict begin 13 H.A end
 479 840
a 479 840 a
SDict begin [/View [/XYZ H.V]/Dest (0:2887) cvn /DEST pdfmark end
 479 840 a Fj(Let)h(a)f(client)h(join)e(the)i(netw)o(ork)e
(at)h(an)o(y)g(time,)g(and)g(reliably)f(get)h(the)g(current)f(serv)o
(er)h(state.)-2 858 y
SDict begin H.S end
 -2 858 a -2 858 a
SDict begin 13 H.A end
 -2 858 a -2 858
a
SDict begin [/View [/XYZ H.V]/Dest (0:2888) cvn /DEST pdfmark end
 -2 858 a Black 396 990 a Fe(\225)p Black 479 990 a
SDict begin H.S end

479 990 a 479 990 a
SDict begin 13 H.A end
 479 990 a 479 990 a
SDict begin [/View [/XYZ H.V]/Dest (0:2889) cvn /DEST pdfmark end
 479 990 a Fj(Let)h(an)o(y)e
(client)h(update)f(the)i(k)o(e)o(y-v)n(alue)d(cache)h(\(inserting)g(ne)
n(w)h(k)o(e)o(y-v)n(alue)e(pairs,)i(updating)e(e)o(xisting)i(ones,)g
(or)479 1098 y(deleting)g(them\).)-2 1116 y
SDict begin H.S end
 -2 1116 a
-2 1116 a
SDict begin 13 H.A end
 -2 1116 a -2 1116 a
SDict begin [/View [/XYZ H.V]/Dest (0:2890) cvn /DEST pdfmark end
 -2 1116 a Black 396 1247
a Fe(\225)p Black 479 1247 a
SDict begin H.S end
 479 1247 a 479 1247 a
SDict begin 13 H.A end
 479
1247 a 479 1247 a
SDict begin [/View [/XYZ H.V]/Dest (0:2891) cvn /DEST pdfmark end
 479 1247 a Fj(Reliably)g(propagate)e(changes)h(to)i
(all)f(clients,)h(and)e(do)h(this)h(with)f(minimum)f(latenc)o(y)g(o)o
(v)o(erhead.)-2 1265 y
SDict begin H.S end
 -2 1265 a -2 1265 a
SDict begin 13 H.A end
 -2 1265 a
-2 1265 a
SDict begin [/View [/XYZ H.V]/Dest (0:2892) cvn /DEST pdfmark end
 -2 1265 a Black 396 1397 a Fe(\225)p Black
479 1397 a
SDict begin H.S end
 479 1397 a 479 1397 a
SDict begin 13 H.A end
 479 1397 a 479 1397
a
SDict begin [/View [/XYZ H.V]/Dest (0:2893) cvn /DEST pdfmark end
 479 1397 a Fj(Handle)h(v)o(ery)f(lar)o(ge)g(numbers)g(of)h(clients,)g
(e.g.)g(tens)g(of)g(thousands)f(or)h(more.)-2 1581 y
SDict begin H.S end

-2 1581 a -2 1581 a
SDict begin 13 H.A end
 -2 1581 a -2 1581 a
SDict begin [/View [/XYZ H.V]/Dest (0:2894) cvn /DEST pdfmark end
 -2 1581 a 396
1671 a Fj(The)g(k)o(e)o(y)g(aspect)g(of)g(the)g(Clone)g(pattern)f(is)j
(that)e(clients)g(talk)h(back)e(to)h(serv)o(ers,)g(which)g(is)h(more)e
(than)h(we)g(do)g(in)g(a)396 1779 y(simple)g(pub-sub)f(dialog.)g(This)h
(is)h(why)f(I)g(use)g(the)h(terms)f(')-5 b(serv)o(er')19
b(and)h('client')f(instead)h(of)g('publisher')e(and)396
1887 y(')-5 b(subscriber'.)19 b(W)-7 b(e')o(ll)21 b(use)f(pub-sub)f(as)
i(the)f(core)f(of)h(Clone)g(b)n(ut)h(it)g(is)g(a)f(bit)h(more)e(than)h
(that.)-2 1904 y
SDict begin H.S end
 -2 1904 a -2 1904 a
SDict begin 13 H.A end
 -2 1904 a -2 1904
a
SDict begin [/View [/XYZ H.V]/Dest (0:2895) cvn /DEST pdfmark end
 -2 1904 a 396 2215 a Fd(5.3.1.)36 b(Distrib)n(uting)d(K)n(e)n(y-V)-7
b(alue)36 b(Updates)2501 2215 y
SDict begin H.S end
 2501 2215 a 2501 2215
a
SDict begin 18.72 H.A end
 2501 2215 a 2501 2215 a
SDict begin [/View [/XYZ H.V]/Dest (10.57.33.2) cvn /DEST pdfmark end
 2501 2215 a -2 2407 a
SDict begin H.S end
 -2 2407
a -2 2407 a
SDict begin 13 H.A end
 -2 2407 a -2 2407 a
SDict begin [/View [/XYZ H.V]/Dest (0:2897) cvn /DEST pdfmark end
 -2 2407 a 396 2489 a
Fj(W)-7 b(e')o(ll)22 b(de)n(v)o(elop)c(Clone)i(in)g(stages,)h(solving)e
(one)h(problem)e(at)j(a)f(time.)h(First,)f(let')-5 b(s)21
b(look)f(at)g(ho)n(w)g(to)g(distrib)n(ute)396 2597 y(k)o(e)o(y-v)n
(alue)e(updates)i(from)f(a)h(serv)o(er)g(to)g(a)h(set)g(of)f(clients.)g
(W)-7 b(e')o(ll)21 b(tak)o(e)f(our)g(weather)f(serv)o(er)h(from)f
(Basics)p 0 TeXcolorgray 3477 2597 a
SDict begin H.S end
 3477 2597 a Fj(Chapter)h(1)3803
2597 y
SDict begin 13 H.L end
 3803 2597 a 3803 2597 a
SDict begin [/Subtype /Link/Dest (0:basics) cvn/H /I/Border [0 0 0]BorderArrayPatch/Color
[1 0 0] H.B /ANN pdfmark end
 3803 2597 a Black 396
2704 a Fj(and)f(ref)o(actor)g(it)h(to)f(send)h(messages)f(as)h(k)o(e)o
(y-v)n(alue)e(pairs\()p 0 TeXcolorgray 2093 2704 a
SDict begin H.S end
 2093
2704 a Fj(Figure)g(5-3)2441 2704 y
SDict begin 13 H.L end
 2441 2704 a 2441 2704
a
SDict begin [/Subtype /Link/Dest (0:figure-64) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2441 2704 a Black -1 w Fj(\).)h(W)-7 b(e')o(ll)21 b(modify)d(our)g
(client)i(to)g(store)f(these)h(in)f(a)396 2812 y(hash)h(table.)-2
2813 y
SDict begin H.S end
 -2 2813 a -2 2813 a
SDict begin 13 H.A end
 -2 2813 a -2 2813 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-64) cvn /DEST pdfmark
end
 -2 2813
a Black 3756 5569 a Fi(237)p Black eop end
%%Page: 238 252
TeXDict begin 238 251 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.238) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black 396 72 a Fk(Figur)o(e)20 b(5-3.)f(Simplest)i
(Clone)f(Model)-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2
172 a
SDict begin [/View [/XYZ H.V]/Dest (0:2902) cvn /DEST pdfmark end
 -2 172 a 396 2814 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2814 a @beginspecial 0
@llx -312 @lly 400 @urx 0 @ury 4000 @rwi @setspecial
%%BeginDocument: images/fig64.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -312 400 0
%%HiResBoundingBox: 0.0 -312.0 400.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -32.40024185180664 moveto
142.40023803710938 -78.40023803710938 lineto
254.40023803710938 -78.40023803710938 lineto
254.40023803710938 -32.40024185180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
142.40023803710938 -81.40023803710938 moveto
142.40023803710938 -98.40023803710938 lineto
142.40023803710938 -102.40023803710938 143.73357137044272 -104.40023803710938 146.40023803710938 -104.40023803710938 curveto
250.40023803710938 -104.40023803710938 lineto
250.40023803710938 -104.40023803710938 lineto
253.06690470377603 -104.40023803710938 254.40023803710938 -102.40023803710938 254.40023803710938 -98.40023803710938 curveto
254.40023803710938 -82.00023651123047 lineto
254.40023803710938 -81.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
26.400239944458008 -212.40023803710938 moveto
23.73357327779134 -212.40023803710938 22.400239944458008 -214.40023803710938 22.400239944458008 -218.40023803710938 curveto
22.400239944458008 -234.40023803710938 lineto
126.40023803710938 -234.40023803710938 lineto
126.40023803710938 -218.40023803710938 lineto
126.40023803710938 -214.40023803710938 125.06690470377605 -212.40023803710938 122.40023803710938 -212.40023803710938 curveto
26.400239944458008 -212.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
22.400239944458008 -237.40023803710938 moveto
22.400239944458008 -284.4002380371094 lineto
126.40023803710938 -284.4002380371094 lineto
126.40023803710938 -237.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
154.40023803710938 -212.40023803710938 moveto
151.73357137044272 -212.40023803710938 150.40023803710938 -214.40023803710938 150.40023803710938 -218.40023803710938 curveto
150.40023803710938 -234.40023803710938 lineto
254.40023803710938 -234.40023803710938 lineto
254.40023803710938 -218.40023803710938 lineto
254.40023803710938 -214.40023803710938 253.06690470377603 -212.40023803710938 250.40023803710938 -212.40023803710938 curveto
154.40023803710938 -212.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.40023803710938 -237.40023803710938 moveto
150.40023803710938 -284.4002380371094 lineto
254.40023803710938 -284.4002380371094 lineto
254.40023803710938 -237.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
282.4002380371094 -212.40023803710938 moveto
279.7335713704427 -212.40023803710938 278.4002380371094 -214.40023803710938 278.4002380371094 -218.40023803710938 curveto
278.4002380371094 -234.40023803710938 lineto
382.4002380371094 -234.40023803710938 lineto
382.4002380371094 -218.40023803710938 lineto
382.4002380371094 -214.40023803710938 381.06690470377606 -212.40023803710938 378.4002380371094 -212.40023803710938 curveto
282.4002380371094 -212.40023803710938 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
278.4002380371094 -237.40023803710938 moveto
278.4002380371094 -284.4002380371094 lineto
382.4002380371094 -284.4002380371094 lineto
382.4002380371094 -237.40023803710938 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -30.0 moveto
140.0 -76.0 lineto
252.0 -76.0 lineto
252.0 -30.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.8 setlinewidth
1 setlinecap
[] 0 setdash
newpath
140.0 -30.0 moveto
140.0 -76.0 lineto
252.0 -76.0 lineto
252.0 -30.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
140.0 -79.0 moveto
140.0 -96.0 lineto
140.0 -100.0 141.33333333333334 -102.0 144.0 -102.0 curveto
248.0 -102.0 lineto
248.0 -102.0 lineto
250.66666666666666 -102.0 252.0 -100.0 252.0 -96.0 curveto
252.0 -79.5999984741211 lineto
252.0 -79.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
140.0 -79.0 moveto
140.0 -96.0 lineto
140.0 -100.0 141.33333333333334 -102.0 144.0 -102.0 curveto
248.0 -102.0 lineto
248.0 -102.0 lineto
250.66666666666666 -102.0 252.0 -100.0 252.0 -96.0 curveto
252.0 -79.5999984741211 lineto
252.0 -79.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
24.0 -210.0 moveto
21.333333333333332 -210.0 20.0 -212.0 20.0 -216.0 curveto
20.0 -232.0 lineto
124.0 -232.0 lineto
124.0 -216.0 lineto
124.0 -212.0 122.66666666666667 -210.0 120.0 -210.0 curveto
24.0 -210.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
24.0 -210.0 moveto
21.333333333333332 -210.0 20.0 -212.0 20.0 -216.0 curveto
20.0 -232.0 lineto
124.0 -232.0 lineto
124.0 -216.0 lineto
124.0 -212.0 122.66666666666667 -210.0 120.0 -210.0 curveto
24.0 -210.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
20.0 -235.0 moveto
20.0 -282.0 lineto
124.0 -282.0 lineto
124.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
20.0 -235.0 moveto
20.0 -282.0 lineto
124.0 -282.0 lineto
124.0 -235.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
152.0 -210.0 moveto
149.33333333333334 -210.0 148.0 -212.0 148.0 -216.0 curveto
148.0 -232.0 lineto
252.0 -232.0 lineto
252.0 -216.0 lineto
252.0 -212.0 250.66666666666666 -210.0 248.0 -210.0 curveto
152.0 -210.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
152.0 -210.0 moveto
149.33333333333334 -210.0 148.0 -212.0 148.0 -216.0 curveto
148.0 -232.0 lineto
252.0 -232.0 lineto
252.0 -216.0 lineto
252.0 -212.0 250.66666666666666 -210.0 248.0 -210.0 curveto
152.0 -210.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
148.0 -235.0 moveto
148.0 -282.0 lineto
252.0 -282.0 lineto
252.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
148.0 -235.0 moveto
148.0 -282.0 lineto
252.0 -282.0 lineto
252.0 -235.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
280.0 -210.0 moveto
277.3333333333333 -210.0 276.0 -212.0 276.0 -216.0 curveto
276.0 -232.0 lineto
380.0 -232.0 lineto
380.0 -216.0 lineto
380.0 -212.0 378.6666666666667 -210.0 376.0 -210.0 curveto
280.0 -210.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
280.0 -210.0 moveto
277.3333333333333 -210.0 276.0 -212.0 276.0 -216.0 curveto
276.0 -232.0 lineto
380.0 -232.0 lineto
380.0 -216.0 lineto
380.0 -212.0 378.6666666666667 -210.0 376.0 -210.0 curveto
280.0 -210.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
276.0 -235.0 moveto
276.0 -282.0 lineto
380.0 -282.0 lineto
380.0 -235.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
276.0 -235.0 moveto
276.0 -282.0 lineto
380.0 -282.0 lineto
380.0 -235.0 lineto
closepath
stroke
newpath
64.0 -192.0 moveto
68.0 -204.0 lineto
72.0 -192.0 lineto
closepath
fill
newpath
192.0 -192.0 moveto
196.0 -204.0 lineto
200.0 -192.0 lineto
closepath
fill
newpath
320.0 -192.0 moveto
324.0 -204.0 lineto
328.0 -192.0 lineto
closepath
fill
newpath
196.0 -102.0 moveto
196.0 -162.0 lineto
stroke
newpath
68.0 -198.0 moveto
68.0 -162.0 lineto
196.0 -162.0 lineto
stroke
newpath
196.0 -198.0 moveto
196.0 -162.0 lineto
stroke
newpath
324.0 -198.0 moveto
324.0 -162.0 lineto
196.0 -162.0 lineto
stroke
/Helvetica findfont
13 scalefont setfont
169.0 -59.0 moveto
(Server) show
185.0 -94.0 moveto
(PUB) show
170.0 -142.0 moveto
(updates) show
57.0 -226.0 moveto
(SUB) show
185.0 -226.0 moveto
(SUB) show
313.0 -226.0 moveto
(SUB) show
51.0 -263.0 moveto
(Client) show
179.0 -263.0 moveto
(Client) show
307.0 -263.0 moveto
(Client) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2814 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2814 a 274 x Fj(This)h(is)g(the)f(serv)o
(er:)-2 3089 y
SDict begin H.S end
 -2 3089 a -2 3089 a
SDict begin 13 H.A end
 -2 3089 a -2 3089
a
SDict begin [/View [/XYZ H.V]/Dest (0:clonesrv1-php) cvn /DEST pdfmark
end
 -2 3089 a 396 3289 a Fk(Example)h(5-2.)e(Clone)h(ser)o(v)o(er)-8
b(,)21 b(Model)f(One)h(\(clonesr)o(v1.php\))-2 3389 y
SDict begin H.S end

-2 3389 a -2 3389 a
SDict begin 11.7 H.A end
 -2 3389 a -2 3389 a
SDict begin [/View [/XYZ H.V]/Dest (0:2908) cvn /DEST pdfmark end
 -2 3389 a 396
3469 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h
(PHP\))-2 3647 y
SDict begin H.S end
 -2 3647 a -2 3647 a
SDict begin 13 H.A end
 -2 3647 a -2 3647
a
SDict begin [/View [/XYZ H.V]/Dest (0:2909) cvn /DEST pdfmark end
 -2 3647 a 396 3743 a Fj(And)20 b(here)g(is)h(the)f(client:)-2
3744 y
SDict begin H.S end
 -2 3744 a -2 3744 a
SDict begin 13 H.A end
 -2 3744 a -2 3744 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonecli1-php) cvn /DEST pdfmark
end
 -2 3744
a 396 3945 a Fk(Example)h(5-3.)e(Clone)h(client,)g(Model)h(One)f
(\(clonecli1.php\))-2 4044 y
SDict begin H.S end
 -2 4044 a -2 4044 a
SDict begin 11.7 H.A end
 -2 4044
a -2 4044 a
SDict begin [/View [/XYZ H.V]/Dest (0:2912) cvn /DEST pdfmark end
 -2 4044 a 396 4125 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 4302 y
SDict begin H.S end
 -2 4302
a -2 4302 a
SDict begin 13 H.A end
 -2 4302 a -2 4302 a
SDict begin [/View [/XYZ H.V]/Dest (0:2913) cvn /DEST pdfmark end
 -2 4302 a 396 4399 a
Fj(Some)20 b(notes)g(about)f(this)i(code:)-2 4400 y
SDict begin H.S end
 -2
4400 a -2 4400 a
SDict begin 13 H.A end
 -2 4400 a -2 4400 a
SDict begin [/View [/XYZ H.V]/Dest (0:2914) cvn /DEST pdfmark end
 -2 4400 a -2 4410
a
SDict begin H.S end
 -2 4410 a -2 4410 a
SDict begin 13 H.A end
 -2 4410 a -2 4410 a
SDict begin [/View [/XYZ H.V]/Dest (0:2915) cvn /DEST pdfmark end
 -2 4410 a Black
396 4569 a Fe(\225)p Black 479 4569 a
SDict begin H.S end
 479 4569 a 479
4569 a
SDict begin 13 H.A end
 479 4569 a 479 4569 a
SDict begin [/View [/XYZ H.V]/Dest (0:2916) cvn /DEST pdfmark end
 479 4569 a Fj(All)g(the)f(hard)g(w)o(ork)f
(is)i(done)e(in)i(a)1488 4569 y
SDict begin H.S end
 1488 4569 a 1488 4569
a
SDict begin 13 H.A end
 1488 4569 a 1488 4569 a
SDict begin [/View [/XYZ H.V]/Dest (0:2917) cvn /DEST pdfmark end
 1488 4569 a Fk(kvmsg)g Fj(class.)g(This)f
(class)h(w)o(orks)f(with)g(k)o(e)o(y-v)n(alue)e(message)i(objects,)g
(which)479 4677 y(are)g(multi-part)f(\330MQ)i(messages)f(structured)f
(as)i(three)e(frames:)h(a)h(k)o(e)o(y)e(\(a)i(\330MQ)f(string\),)f(a)i
(sequence)e(number)479 4785 y(\(64-bit)g(v)n(alue,)g(in)i(netw)o(ork)e
(byte)g(order\),)g(and)g(a)i(binary)e(body)g(\(holds)g(e)n(v)o
(erything)e(else\).)-2 4803 y
SDict begin H.S end
 -2 4803 a -2 4803 a
SDict begin 13 H.A end
 -2
4803 a -2 4803 a
SDict begin [/View [/XYZ H.V]/Dest (0:2918) cvn /DEST pdfmark end
 -2 4803 a Black 396 4934 a Fe(\225)p
Black 479 4934 a
SDict begin H.S end
 479 4934 a 479 4934 a
SDict begin 13 H.A end
 479 4934 a 479
4934 a
SDict begin [/View [/XYZ H.V]/Dest (0:2919) cvn /DEST pdfmark end
 479 4934 a Fj(The)j(serv)o(er)f(generates)h(messages)g(with)g(a)
h(randomized)d(4-digit)h(k)o(e)o(y)-5 b(,)19 b(which)g(lets)j(us)e
(simulate)g(a)h(lar)o(ge)e(b)n(ut)h(not)479 5042 y(enormous)e(hash)i
(table)h(\(10K)e(entries\).)-2 5057 y
SDict begin H.S end
 -2 5057 a -2 5057
a
SDict begin 13 H.A end
 -2 5057 a -2 5057 a
SDict begin [/View [/XYZ H.V]/Dest (0:2920) cvn /DEST pdfmark end
 -2 5057 a Black 3759 5569 a Fi(238)p
Black eop end
%%Page: 239 253
TeXDict begin 239 252 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.239) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:2921) cvn /DEST pdfmark end
 479 72 a
Fj(The)20 b(serv)o(er)f(does)h(a)h(200)e(millisecond)h(pause)f(after)h
(binding)f(its)i(sock)o(et.)f(This)g(is)h(to)f(pre)n(v)o(ent)f("slo)n
(w)h(joiner)479 180 y(syndrome")e(where)h(the)h(subscriber)e(loses)i
(messages)g(as)h(it)f(connects)f(to)h(the)g(serv)o(er')-5
b(s)19 b(sock)o(et.)g(W)-7 b(e')o(ll)21 b(remo)o(v)o(e)d(that)479
288 y(in)j(later)f(models.)-2 289 y
SDict begin H.S end
 -2 289 a -2 289 a
SDict begin 13 H.A end

-2 289 a -2 289 a
SDict begin [/View [/XYZ H.V]/Dest (0:2922) cvn /DEST pdfmark end
 -2 289 a Black 396 438 a Fe(\225)p
Black 479 438 a
SDict begin H.S end
 479 438 a 479 438 a
SDict begin 13 H.A end
 479 438 a 479 438
a
SDict begin [/View [/XYZ H.V]/Dest (0:2923) cvn /DEST pdfmark end
 479 438 a Fj(W)-7 b(e')o(ll)22 b(use)e(the)g(terms)g('publisher')f
(and)g(')-5 b(subscriber')19 b(in)h(the)g(code)g(to)g(refer)g(to)g
(sock)o(ets.)g(This)g(will)h(help)f(later)479 546 y(when)g(we)g(ha)n(v)
o(e)g(multiple)g(sock)o(ets)g(doing)f(dif)n(ferent)f(things.)-2
730 y
SDict begin H.S end
 -2 730 a -2 730 a
SDict begin 13 H.A end
 -2 730 a -2 730 a
SDict begin [/View [/XYZ H.V]/Dest (0:2924) cvn /DEST pdfmark end
 -2 730 a 396
820 a Fj(Here)i(is)h(the)g(kvmsg)e(class,)i(in)f(the)g(simplest)h(form)
e(that)h(w)o(orks)g(for)g(no)n(w:)-2 838 y
SDict begin H.S end
 -2 838 a -2
838 a
SDict begin 13 H.A end
 -2 838 a -2 838 a
SDict begin [/View [/XYZ H.V]/Dest (0:kvsimple-php) cvn /DEST pdfmark
end
 -2 838 a 396 1021 a Fk(Example)h(5-4.)e(K)n
(ey-v)o(alue)f(message)j(class)f(\(kvsimple.php\))-2
1121 y
SDict begin H.S end
 -2 1121 a -2 1121 a
SDict begin 11.7 H.A end
 -2 1121 a -2 1121 a
SDict begin [/View [/XYZ H.V]/Dest (0:2927) cvn /DEST pdfmark end
 -2 1121
a 396 1201 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 1379 y
SDict begin H.S end
 -2 1379 a -2 1379 a
SDict begin 13 H.A end
 -2 1379 a
-2 1379 a
SDict begin [/View [/XYZ H.V]/Dest (0:2928) cvn /DEST pdfmark end
 -2 1379 a 396 1475 a Fj(W)-7 b(e')o(ll)22 b(mak)o(e)d(a)i
(more)e(sophisticated)h(kvmsg)f(class)i(later)m(,)f(for)f(using)h(in)g
(real)g(applications.)-2 1659 y
SDict begin H.S end
 -2 1659 a -2 1659 a
SDict begin 13 H.A end
 -2
1659 a -2 1659 a
SDict begin [/View [/XYZ H.V]/Dest (0:2929) cvn /DEST pdfmark end
 -2 1659 a 396 1749 a Fj(Both)g(the)h(serv)o(er)e(and)h
(client)g(maintain)f(hash)h(tables,)g(b)n(ut)h(this)f(\002rst)h(model)f
(only)f(w)o(orks)h(properly)e(if)i(we)h(start)g(all)396
1857 y(clients)g(before)e(the)h(serv)o(er)m(,)f(and)g(the)h(clients)h
(ne)n(v)o(er)e(crash.)g(That')-5 b(s)21 b(not)f(')l(reliability'.)-2
1885 y
SDict begin H.S end
 -2 1885 a -2 1885 a
SDict begin 13 H.A end
 -2 1885 a -2 1885 a
SDict begin [/View [/XYZ H.V]/Dest (0:2930) cvn /DEST pdfmark end
 -2 1885
a 396 2196 a Fd(5.3.2.)36 b(Getting)d(a)h(Snapshot)1824
2196 y
SDict begin H.S end
 1824 2196 a 1824 2196 a
SDict begin 18.72 H.A end
 1824 2196 a 1824 2196
a
SDict begin [/View [/XYZ H.V]/Dest (10.57.34.2) cvn /DEST pdfmark end
 1824 2196 a -2 2388 a
SDict begin H.S end
 -2 2388 a -2 2388 a
SDict begin 13 H.A end
 -2 2388 a
-2 2388 a
SDict begin [/View [/XYZ H.V]/Dest (0:2932) cvn /DEST pdfmark end
 -2 2388 a 396 2469 a Fj(In)20 b(order)f(to)h(allo)n(w)h(a)f
(late)h(\(or)e(reco)o(v)o(ering\))e(client)k(to)f(catch)g(up)g(with)g
(a)h(serv)o(er)e(it)i(has)f(to)h(get)f(a)g(snapshot)g(of)g(the)396
2577 y(serv)o(er')-5 b(s)20 b(state.)h(Just)g(as)g(we')l(v)o(e)e
(reduced)f("message")i(to)g(mean)g("a)g(sequenced)f(k)o(e)o(y-v)n(alue)
f(pair",)h(we)i(can)f(reduce)396 2685 y("state")h(to)f(mean)g("a)g
(hash)g(table".)g(T)-7 b(o)20 b(get)h(the)f(serv)o(er)f(state,)i(a)f
(client)h(opens)e(a)i(DEALER)f(sock)o(et)g(and)g(asks)g(for)g(it)396
2793 y(e)o(xplicitly\()p 0 TeXcolorgray 738 2793 a
SDict begin H.S end
 738
2793 a Fj(Figure)e(5-4)1086 2793 y
SDict begin 13 H.L end
 1086 2793 a 1086 2793
a
SDict begin [/Subtype /Link/Dest (0:figure-65) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1086 2793 a Black -1 w Fj(\).)-2 2811 y
SDict begin H.S end
 -2 2811 a -2
2811 a
SDict begin 13 H.A end
 -2 2811 a -2 2811 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-65) cvn /DEST pdfmark
end
 -2 2811 a 396 2995 a Fk(Figur)o(e)i(5-4.)f
(State)g(Replication)-2 3094 y
SDict begin H.S end
 -2 3094 a -2 3094 a
SDict begin 13 H.A end
 -2
3094 a -2 3094 a
SDict begin [/View [/XYZ H.V]/Dest (0:2936) cvn /DEST pdfmark end
 -2 3094 a 396 5086 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 5086 a @beginspecial
0 @llx -234 @lly 427 @urx 0 @ury 4270 @rwi @setspecial
%%BeginDocument: images/fig65.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -234 427 0
%%HiResBoundingBox: 0.0 -234.0 427.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
145.10020446777344 -24.100210189819336 moveto
145.10020446777344 -60.1002082824707 lineto
271.1002197265625 -60.1002082824707 lineto
271.1002197265625 -24.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
145.10020446777344 -60.1002082824707 moveto
145.10020446777344 -74.10021209716797 lineto
145.10020446777344 -76.76687876383464 146.43353780110678 -78.10021209716797 149.10020446777344 -78.10021209716797 curveto
206.70021057128906 -78.10021209716797 lineto
206.10020446777344 -78.10021209716797 lineto
206.10020446777344 -60.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
209.10020446777344 -60.1002082824707 moveto
209.10020446777344 -78.10021209716797 lineto
268.1002197265625 -78.10021209716797 lineto
270.1002197265625 -78.10021209716797 271.1002197265625 -76.76687876383464 271.1002197265625 -74.10021209716797 curveto
271.1002197265625 -60.1002082824707 lineto
271.1002197265625 -60.1002082824707 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
303.1002197265625 -159.10020446777344 moveto
300.4335530598958 -159.10020446777344 299.1002197265625 -160.7668711344401 299.1002197265625 -164.10020446777344 curveto
299.1002197265625 -177.10020446777344 lineto
346.1002197265625 -177.10020446777344 lineto
346.1002197265625 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
349.1002197265625 -159.10020446777344 moveto
349.1002197265625 -177.10020446777344 lineto
411.1002197265625 -177.10020446777344 lineto
411.1002197265625 -164.10020446777344 lineto
411.1002197265625 -160.7668711344401 410.1002197265625 -159.10020446777344 408.1002197265625 -159.10020446777344 curveto
349.5002136230469 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
299.1002197265625 -177.10020446777344 moveto
299.1002197265625 -213.10020446777344 lineto
411.1002197265625 -213.10020446777344 lineto
411.1002197265625 -177.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
23.100210189819336 -159.10020446777344 moveto
20.433543523152668 -159.10020446777344 19.100210189819336 -160.7668711344401 19.100210189819336 -164.10020446777344 curveto
19.100210189819336 -211.10020446777344 lineto
131.10020446777344 -211.10020446777344 lineto
131.10020446777344 -164.10020446777344 lineto
131.10020446777344 -160.7668711344401 130.10020446777344 -159.10020446777344 128.10020446777344 -159.10020446777344 curveto
23.100210189819336 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
23.100210189819336 -159.10020446777344 moveto
20.433543523152668 -159.10020446777344 19.100210189819336 -160.7668711344401 19.100210189819336 -164.10020446777344 curveto
19.100210189819336 -177.10020446777344 lineto
66.10021209716797 -177.10020446777344 lineto
66.10021209716797 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
69.10021209716797 -159.10020446777344 moveto
69.10021209716797 -177.10020446777344 lineto
131.10020446777344 -177.10020446777344 lineto
131.10020446777344 -164.10020446777344 lineto
131.10020446777344 -160.7668711344401 130.10020446777344 -159.10020446777344 128.10020446777344 -159.10020446777344 curveto
69.50021362304688 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.100210189819336 -177.10020446777344 moveto
19.100210189819336 -211.10020446777344 lineto
131.10020446777344 -211.10020446777344 lineto
131.10020446777344 -177.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.10020446777344 -159.10020446777344 moveto
160.43353780110678 -159.10020446777344 159.10020446777344 -160.7668711344401 159.10020446777344 -164.10020446777344 curveto
159.10020446777344 -211.10020446777344 lineto
271.1002197265625 -211.10020446777344 lineto
271.1002197265625 -164.10020446777344 lineto
271.1002197265625 -160.7668711344401 270.1002197265625 -159.10020446777344 268.1002197265625 -159.10020446777344 curveto
163.10020446777344 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
163.10020446777344 -159.10020446777344 moveto
160.43353780110678 -159.10020446777344 159.10020446777344 -160.7668711344401 159.10020446777344 -164.10020446777344 curveto
159.10020446777344 -177.10020446777344 lineto
206.10020446777344 -177.10020446777344 lineto
206.10020446777344 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
209.10020446777344 -159.10020446777344 moveto
209.10020446777344 -177.10020446777344 lineto
271.1002197265625 -177.10020446777344 lineto
271.1002197265625 -164.10020446777344 lineto
271.1002197265625 -160.7668711344401 270.1002197265625 -159.10020446777344 268.1002197265625 -159.10020446777344 curveto
209.5001983642578 -159.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
159.10020446777344 -177.10020446777344 moveto
159.10020446777344 -211.10020446777344 lineto
271.1002197265625 -211.10020446777344 lineto
271.1002197265625 -177.10020446777344 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
143.0 -22.0 moveto
143.0 -58.0 lineto
269.0 -58.0 lineto
269.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
143.0 -22.0 moveto
143.0 -58.0 lineto
269.0 -58.0 lineto
269.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
143.0 -58.0 moveto
143.0 -72.0 lineto
143.0 -74.66666666666667 144.33333333333334 -76.0 147.0 -76.0 curveto
204.60000610351562 -76.0 lineto
204.0 -76.0 lineto
204.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
143.0 -58.0 moveto
143.0 -72.0 lineto
143.0 -74.66666666666667 144.33333333333334 -76.0 147.0 -76.0 curveto
204.60000610351562 -76.0 lineto
204.0 -76.0 lineto
204.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -58.0 moveto
207.0 -76.0 lineto
266.0 -76.0 lineto
268.0 -76.0 269.0 -74.66666666666667 269.0 -72.0 curveto
269.0 -58.0 lineto
269.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -58.0 moveto
207.0 -76.0 lineto
266.0 -76.0 lineto
268.0 -76.0 269.0 -74.66666666666667 269.0 -72.0 curveto
269.0 -58.0 lineto
269.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
301.0 -157.0 moveto
298.3333333333333 -157.0 297.0 -158.66666666666666 297.0 -162.0 curveto
297.0 -175.0 lineto
344.0 -175.0 lineto
344.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
301.0 -157.0 moveto
298.3333333333333 -157.0 297.0 -158.66666666666666 297.0 -162.0 curveto
297.0 -175.0 lineto
344.0 -175.0 lineto
344.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
347.0 -157.0 moveto
347.0 -175.0 lineto
409.0 -175.0 lineto
409.0 -162.0 lineto
409.0 -158.66666666666666 408.0 -157.0 406.0 -157.0 curveto
347.3999938964844 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
347.0 -157.0 moveto
347.0 -175.0 lineto
409.0 -175.0 lineto
409.0 -162.0 lineto
409.0 -158.66666666666666 408.0 -157.0 406.0 -157.0 curveto
347.3999938964844 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
297.0 -175.0 moveto
297.0 -211.0 lineto
409.0 -211.0 lineto
409.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
297.0 -175.0 moveto
297.0 -211.0 lineto
409.0 -211.0 lineto
409.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
21.0 -157.0 moveto
18.333333333333332 -157.0 17.0 -158.66666666666666 17.0 -162.0 curveto
17.0 -209.0 lineto
129.0 -209.0 lineto
129.0 -162.0 lineto
129.0 -158.66666666666666 128.0 -157.0 126.0 -157.0 curveto
21.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
21.0 -157.0 moveto
18.333333333333332 -157.0 17.0 -158.66666666666666 17.0 -162.0 curveto
17.0 -209.0 lineto
129.0 -209.0 lineto
129.0 -162.0 lineto
129.0 -158.66666666666666 128.0 -157.0 126.0 -157.0 curveto
21.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
21.0 -157.0 moveto
18.333333333333332 -157.0 17.0 -158.66666666666666 17.0 -162.0 curveto
17.0 -175.0 lineto
64.0 -175.0 lineto
64.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
21.0 -157.0 moveto
18.333333333333332 -157.0 17.0 -158.66666666666666 17.0 -162.0 curveto
17.0 -175.0 lineto
64.0 -175.0 lineto
64.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
67.0 -157.0 moveto
67.0 -175.0 lineto
129.0 -175.0 lineto
129.0 -162.0 lineto
129.0 -158.66666666666666 128.0 -157.0 126.0 -157.0 curveto
67.4000015258789 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
67.0 -157.0 moveto
67.0 -175.0 lineto
129.0 -175.0 lineto
129.0 -162.0 lineto
129.0 -158.66666666666666 128.0 -157.0 126.0 -157.0 curveto
67.4000015258789 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
17.0 -175.0 moveto
17.0 -209.0 lineto
129.0 -209.0 lineto
129.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
17.0 -175.0 moveto
17.0 -209.0 lineto
129.0 -209.0 lineto
129.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
161.0 -157.0 moveto
158.33333333333334 -157.0 157.0 -158.66666666666666 157.0 -162.0 curveto
157.0 -209.0 lineto
269.0 -209.0 lineto
269.0 -162.0 lineto
269.0 -158.66666666666666 268.0 -157.0 266.0 -157.0 curveto
161.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
161.0 -157.0 moveto
158.33333333333334 -157.0 157.0 -158.66666666666666 157.0 -162.0 curveto
157.0 -209.0 lineto
269.0 -209.0 lineto
269.0 -162.0 lineto
269.0 -158.66666666666666 268.0 -157.0 266.0 -157.0 curveto
161.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
161.0 -157.0 moveto
158.33333333333334 -157.0 157.0 -158.66666666666666 157.0 -162.0 curveto
157.0 -175.0 lineto
204.0 -175.0 lineto
204.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
161.0 -157.0 moveto
158.33333333333334 -157.0 157.0 -158.66666666666666 157.0 -162.0 curveto
157.0 -175.0 lineto
204.0 -175.0 lineto
204.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -157.0 moveto
207.0 -175.0 lineto
269.0 -175.0 lineto
269.0 -162.0 lineto
269.0 -158.66666666666666 268.0 -157.0 266.0 -157.0 curveto
207.39999389648438 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -157.0 moveto
207.0 -175.0 lineto
269.0 -175.0 lineto
269.0 -162.0 lineto
269.0 -158.66666666666666 268.0 -157.0 266.0 -157.0 curveto
207.39999389648438 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
157.0 -175.0 moveto
157.0 -209.0 lineto
269.0 -209.0 lineto
269.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
157.0 -175.0 moveto
157.0 -209.0 lineto
269.0 -209.0 lineto
269.0 -175.0 lineto
closepath
stroke
newpath
234.0 -85.0 moveto
234.0 -103.0 lineto
371.0 -103.0 lineto
373.0 -103.0 374.0 -104.66666666666667 374.0 -108.0 curveto
374.0 -157.0 lineto
374.0 -157.0 lineto
stroke
newpath
234.0 -81.0 moveto
231.0 -90.0 lineto
238.0 -90.0 lineto
closepath
fill
newpath
42.0 -144.0 moveto
45.0 -153.0 lineto
49.0 -144.0 lineto
closepath
fill
newpath
175.0 -144.0 moveto
178.0 -153.0 lineto
182.0 -144.0 lineto
closepath
fill
newpath
315.0 -144.0 moveto
318.0 -153.0 lineto
322.0 -144.0 lineto
closepath
fill
newpath
178.0 -76.0 moveto
178.0 -121.0 lineto
stroke
newpath
45.0 -148.0 moveto
45.0 -126.0 lineto
45.0 -122.66666666666667 46.333333333333336 -121.0 49.0 -121.0 curveto
178.0 -121.0 lineto
178.0 -121.0 lineto
stroke
newpath
178.0 -148.0 moveto
178.0 -121.0 lineto
stroke
newpath
318.0 -148.0 moveto
318.0 -126.0 lineto
318.0 -122.66666666666667 317.0 -121.0 315.0 -121.0 curveto
178.0 -121.0 lineto
178.0 -121.0 lineto
stroke
/Helvetica findfont
9 scalefont setfont
187.0 -44.0 moveto
(Server) show
169.0 -71.0 moveto
(PUB) show
218.0 -71.0 moveto
(ROUTER) show
258.0 -98.0 moveto
(state request) show
159.0 -107.0 moveto
(updates) show
29.0 -170.0 moveto
(SUB) show
79.0 -170.0 moveto
(DEALER) show
169.0 -170.0 moveto
(SUB) show
219.0 -170.0 moveto
(DEALER) show
309.0 -170.0 moveto
(SUB) show
359.0 -170.0 moveto
(DEALER) show
56.0 -197.0 moveto
(Client) show
196.0 -197.0 moveto
(Client) show
336.0 -197.0 moveto
(Client) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 5086 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 5086 a Black 3759 5569 a
Fi(239)p Black eop end
%%Page: 240 254
TeXDict begin 240 253 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.240) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2939) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(T)g(o)20 b(mak)o(e)f(this)h(w)o
(ork,)e(we)i(ha)n(v)o(e)f(to)h(solv)o(e)f(the)g(timing)g(problem.)f
(Getting)h(a)h(state)g(snapshot)e(will)j(tak)o(e)e(a)h(certain)f(time,)
396 180 y(possibly)h(f)o(airly)g(long)f(if)h(the)h(snapshot)e(is)i(lar)
o(ge.)e(W)-7 b(e)21 b(need)f(to)g(correctly)f(apply)g(updates)h(to)g
(the)g(snapshot.)f(But)i(the)396 288 y(serv)o(er)f(w)o(on')o(t)f(kno)n
(w)g(when)g(to)i(start)g(sending)e(us)h(updates.)f(One)h(w)o(ay)h(w)o
(ould)e(be)h(to)h(start)f(subscribing,)f(get)h(a)g(\002rst)396
396 y(update,)f(and)h(then)f(ask)i(for)e("state)i(for)f(update)f(N".)h
(This)g(w)o(ould)g(require)f(the)h(serv)o(er)f(storing)h(one)f
(snapshot)h(for)f(each)396 504 y(update,)g(which)h(isn')o(t)g
(practical.)-2 688 y
SDict begin H.S end
 -2 688 a -2 688 a
SDict begin 13 H.A end
 -2 688 a -2 688
a
SDict begin [/View [/XYZ H.V]/Dest (0:2940) cvn /DEST pdfmark end
 -2 688 a 396 778 a Fj(So)h(we)f(will)h(do)f(the)g(synchronization)d
(in)k(the)f(client,)g(as)h(follo)n(ws:)-2 796 y
SDict begin H.S end
 -2 796
a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:2941) cvn /DEST pdfmark end
 -2 796 a -2 806 a
SDict begin H.S end
 -2 806
a -2 806 a
SDict begin 13 H.A end
 -2 806 a -2 806 a
SDict begin [/View [/XYZ H.V]/Dest (0:2942) cvn /DEST pdfmark end
 -2 806 a Black 396 948 a
Fe(\225)p Black 479 948 a
SDict begin H.S end
 479 948 a 479 948 a
SDict begin 13 H.A end
 479 948
a 479 948 a
SDict begin [/View [/XYZ H.V]/Dest (0:2943) cvn /DEST pdfmark end
 479 948 a Fj(The)f(client)g(\002rst)h(subscribes)f(to)g
(updates)g(and)f(then)h(mak)o(es)g(a)h(state)g(request.)e(This)h
(guarantees)f(that)h(the)g(state)h(is)479 1056 y(going)e(to)i(be)f(ne)n
(wer)f(than)h(the)g(oldest)g(update)f(it)i(has.)-2 1074
y
SDict begin H.S end
 -2 1074 a -2 1074 a
SDict begin 13 H.A end
 -2 1074 a -2 1074 a
SDict begin [/View [/XYZ H.V]/Dest (0:2944) cvn /DEST pdfmark end
 -2 1074 a Black
396 1206 a Fe(\225)p Black 479 1206 a
SDict begin H.S end
 479 1206 a 479
1206 a
SDict begin 13 H.A end
 479 1206 a 479 1206 a
SDict begin [/View [/XYZ H.V]/Dest (0:2945) cvn /DEST pdfmark end
 479 1206 a Fj(The)f(client)g(w)o(aits)i
(for)d(the)h(serv)o(er)g(to)g(reply)f(with)i(state,)f(and)g(meanwhile)f
(queues)g(all)i(updates.)e(It)i(does)f(this)479 1314
y(simply)f(by)f(not)g(reading)f(them:)h(\330MQ)h(k)o(eeps)g(them)f
(queued)f(on)h(the)h(sock)o(et)f(queue,)f(since)i(we)g(don')o(t)e(set)i
(a)g(HWM.)-2 1332 y
SDict begin H.S end
 -2 1332 a -2 1332 a
SDict begin 13 H.A end
 -2 1332 a -2
1332 a
SDict begin [/View [/XYZ H.V]/Dest (0:2946) cvn /DEST pdfmark end
 -2 1332 a Black 396 1463 a Fe(\225)p Black 479
1463 a
SDict begin H.S end
 479 1463 a 479 1463 a
SDict begin 13 H.A end
 479 1463 a 479 1463 a
SDict begin [/View [/XYZ H.V]/Dest (0:2947) cvn /DEST pdfmark end
 479
1463 a Fj(When)h(the)h(client)f(recei)n(v)o(es)f(its)i(state)g(update,)
e(it)i(be)o(gins)e(once)h(again)f(to)h(read)g(updates.)f(Ho)n(we)n(v)o
(er)g(it)i(discards)e(an)o(y)479 1571 y(updates)h(that)g(are)g(older)f
(than)h(the)g(state)h(update.)d(So)j(if)f(the)g(state)h(update)e
(includes)g(updates)h(up)f(to)i(200,)e(the)h(client)479
1679 y(will)h(discard)f(updates)f(up)h(to)g(201.)-2 1697
y
SDict begin H.S end
 -2 1697 a -2 1697 a
SDict begin 13 H.A end
 -2 1697 a -2 1697 a
SDict begin [/View [/XYZ H.V]/Dest (0:2948) cvn /DEST pdfmark end
 -2 1697 a Black
396 1828 a Fe(\225)p Black 479 1828 a
SDict begin H.S end
 479 1828 a 479
1828 a
SDict begin 13 H.A end
 479 1828 a 479 1828 a
SDict begin [/View [/XYZ H.V]/Dest (0:2949) cvn /DEST pdfmark end
 479 1828 a Fj(The)g(client)g(then)g
(applies)g(updates)f(to)i(its)g(o)n(wn)f(state)h(snapshot.)-2
2012 y
SDict begin H.S end
 -2 2012 a -2 2012 a
SDict begin 13 H.A end
 -2 2012 a -2 2012 a
SDict begin [/View [/XYZ H.V]/Dest (0:2950) cvn /DEST pdfmark end
 -2 2012
a 396 2102 a Fj(It')-5 b(s)21 b(a)g(simple)f(model)f(that)i(e)o
(xploits)e(\330MQ')-5 b(s)21 b(o)n(wn)e(internal)h(queues.)f(Here')-5
b(s)20 b(the)g(serv)o(er:)-2 2120 y
SDict begin H.S end
 -2 2120 a -2 2120
a
SDict begin 13 H.A end
 -2 2120 a -2 2120 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonesrv2-php) cvn /DEST pdfmark
end
 -2 2120 a 396 2304 a Fk(Example)h(5-5.)e(Clone)h
(ser)o(v)o(er)-8 b(,)21 b(Model)f(T)-6 b(w)o(o)21 b(\(clonesr)o
(v2.php\))-2 2404 y
SDict begin H.S end
 -2 2404 a -2 2404 a
SDict begin 11.7 H.A end
 -2 2404 a -2
2404 a
SDict begin [/View [/XYZ H.V]/Dest (0:2953) cvn /DEST pdfmark end
 -2 2404 a 396 2484 a Fg(\(This)44 b(example)g(still)g(needs)g
(translation)f(into)h(PHP\))-2 2661 y
SDict begin H.S end
 -2 2661 a -2 2661
a
SDict begin 13 H.A end
 -2 2661 a -2 2661 a
SDict begin [/View [/XYZ H.V]/Dest (0:2954) cvn /DEST pdfmark end
 -2 2661 a 396 2758 a Fj(And)20
b(here)g(is)h(the)f(client:)-2 2759 y
SDict begin H.S end
 -2 2759 a -2 2759
a
SDict begin 13 H.A end
 -2 2759 a -2 2759 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonecli2-php) cvn /DEST pdfmark
end
 -2 2759 a 396 2959 a Fk(Example)h(5-6.)e(Clone)h
(client,)g(Model)h(T)-6 b(w)o(o)21 b(\(clonecli2.php\))-2
3059 y
SDict begin H.S end
 -2 3059 a -2 3059 a
SDict begin 11.7 H.A end
 -2 3059 a -2 3059 a
SDict begin [/View [/XYZ H.V]/Dest (0:2957) cvn /DEST pdfmark end
 -2 3059
a 396 3139 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 3317 y
SDict begin H.S end
 -2 3317 a -2 3317 a
SDict begin 13 H.A end
 -2 3317 a
-2 3317 a
SDict begin [/View [/XYZ H.V]/Dest (0:2958) cvn /DEST pdfmark end
 -2 3317 a 396 3413 a Fj(Some)20 b(notes)g(about)f(this)i
(code:)-2 3414 y
SDict begin H.S end
 -2 3414 a -2 3414 a
SDict begin 13 H.A end
 -2 3414 a -2 3414
a
SDict begin [/View [/XYZ H.V]/Dest (0:2959) cvn /DEST pdfmark end
 -2 3414 a -2 3424 a
SDict begin H.S end
 -2 3424 a -2 3424 a
SDict begin 13 H.A end
 -2 3424 a -2
3424 a
SDict begin [/View [/XYZ H.V]/Dest (0:2960) cvn /DEST pdfmark end
 -2 3424 a Black 396 3583 a Fe(\225)p Black 479
3583 a
SDict begin H.S end
 479 3583 a 479 3583 a
SDict begin 13 H.A end
 479 3583 a 479 3583 a
SDict begin [/View [/XYZ H.V]/Dest (0:2961) cvn /DEST pdfmark end
 479
3583 a Fj(The)f(serv)o(er)f(uses)i(tw)o(o)g(threads,)e(for)g(simpler)h
(design.)g(One)g(thread)f(produces)f(random)h(updates,)g(and)g(the)i
(second)479 3691 y(thread)f(handles)f(state.)i(The)e(tw)o(o)i
(communicate)d(across)i(P)-8 b(AIR)21 b(sock)o(ets.)g(Y)-9
b(ou)19 b(might)h(lik)o(e)g(to)g(use)h(SUB)g(sock)o(ets)479
3799 y(b)n(ut)f(you')l(d)f(hit)h(the)g("slo)n(w)h(joiner")e(problem)g
(where)g(the)h(subscriber)f(w)o(ould)h(randomly)e(miss)j(some)f
(messages)479 3907 y(while)h(connecting.)c(P)-8 b(AIR)22
b(sock)o(ets)e(let)h(us)f(e)o(xplicitly)f(synchronize)f(the)j(tw)o(o)f
(threads.)-2 3925 y
SDict begin H.S end
 -2 3925 a -2 3925 a
SDict begin 13 H.A end
 -2 3925 a -2
3925 a
SDict begin [/View [/XYZ H.V]/Dest (0:2962) cvn /DEST pdfmark end
 -2 3925 a Black 396 4057 a Fe(\225)p Black 479
4057 a
SDict begin H.S end
 479 4057 a 479 4057 a
SDict begin 13 H.A end
 479 4057 a 479 4057 a
SDict begin [/View [/XYZ H.V]/Dest (0:2963) cvn /DEST pdfmark end
 479
4057 a Fj(W)-7 b(e)22 b(set)f(a)f(HWM)h(on)f(the)g(updates)f(sock)o(et)
i(pair)m(,)e(since)h(hash)g(table)g(insertions)g(are)g(relati)n(v)o
(ely)f(slo)n(w)-5 b(.)20 b(W)m(ithout)f(this,)479 4165
y(the)h(serv)o(er)g(runs)g(out)f(of)h(memory)-5 b(.)18
b(On)1639 4165 y
SDict begin H.S end
 1639 4165 a 1639 4165 a
SDict begin 13 H.A end
 1639 4165 a
1639 4165 a
SDict begin [/View [/XYZ H.V]/Dest (0:2964) cvn /DEST pdfmark end
 1639 4165 a Fg(inproc)i Fj(connections,)e(the)i(real)h(HWM)
f(is)i(the)e(sum)g(of)g(the)g(HWM)h(of)479 4273 y
SDict begin H.S end
 479
4273 a 479 4273 a
SDict begin 13 H.A end
 479 4273 a 479 4273 a
SDict begin [/View [/XYZ H.V]/Dest (0:2965) cvn /DEST pdfmark end
 479 4273 a Fi(both)f
Fj(sock)o(ets,)g(so)g(we)h(set)g(the)f(HWM)h(on)f(each)g(sock)o(et.)-2
4285 y
SDict begin H.S end
 -2 4285 a -2 4285 a
SDict begin 13 H.A end
 -2 4285 a -2 4285 a
SDict begin [/View [/XYZ H.V]/Dest (0:2966) cvn /DEST pdfmark end
 -2 4285
a Black 396 4422 a Fe(\225)p Black 479 4422 a
SDict begin H.S end
 479 4422
a 479 4422 a
SDict begin 13 H.A end
 479 4422 a 479 4422 a
SDict begin [/View [/XYZ H.V]/Dest (0:2967) cvn /DEST pdfmark end
 479 4422 a Fj(The)g(client)g(is)h
(really)f(simple.)g(In)g(C,)h(under)e(60)h(lines)g(of)g(code.)f(A)i
(lot)f(of)g(the)h(hea)n(vy)e(lifting)h(is)h(done)e(in)h(the)h(kvmsg)479
4530 y(class,)g(b)n(ut)f(still,)i(the)e(basic)g(Clone)g(pattern)f(is)j
(easier)e(to)g(implement)f(than)h(it)h(seemed)f(at)g(\002rst.)-2
4548 y
SDict begin H.S end
 -2 4548 a -2 4548 a
SDict begin 13 H.A end
 -2 4548 a -2 4548 a
SDict begin [/View [/XYZ H.V]/Dest (0:2968) cvn /DEST pdfmark end
 -2 4548
a Black 396 4679 a Fe(\225)p Black 479 4679 a
SDict begin H.S end
 479 4679
a 479 4679 a
SDict begin 13 H.A end
 479 4679 a 479 4679 a
SDict begin [/View [/XYZ H.V]/Dest (0:2969) cvn /DEST pdfmark end
 479 4679 a Fj(W)-7
b(e)22 b(don')o(t)c(use)j(an)o(ything)d(f)o(anc)o(y)h(for)g
(serializing)h(the)g(state.)h(The)f(hash)g(table)g(holds)f(a)i(set)g
(of)f(kvmsg)f(objects,)h(and)479 4787 y(the)g(serv)o(er)g(sends)g
(these,)g(as)h(a)g(batch)e(of)h(messages,)g(to)h(the)f(client)g
(requesting)f(state.)h(If)g(multiple)g(clients)g(request)479
4895 y(state)h(at)g(once,)e(each)h(will)h(get)f(a)h(dif)n(ferent)d
(snapshot.)-2 4913 y
SDict begin H.S end
 -2 4913 a -2 4913 a
SDict begin 13 H.A end
 -2 4913 a -2
4913 a
SDict begin [/View [/XYZ H.V]/Dest (0:2970) cvn /DEST pdfmark end
 -2 4913 a Black 396 5045 a Fe(\225)p Black 479
5045 a
SDict begin H.S end
 479 5045 a 479 5045 a
SDict begin 13 H.A end
 479 5045 a 479 5045 a
SDict begin [/View [/XYZ H.V]/Dest (0:2971) cvn /DEST pdfmark end
 479
5045 a Fj(W)-7 b(e)22 b(assume)e(that)g(the)g(client)h(has)f(e)o
(xactly)f(one)h(serv)o(er)f(to)i(talk)f(to.)g(The)g(serv)o(er)2809
5045 y
SDict begin H.S end
 2809 5045 a 2809 5045 a
SDict begin 13 H.A end
 2809 5045 a 2809 5045
a
SDict begin [/View [/XYZ H.V]/Dest (0:2972) cvn /DEST pdfmark end
 2809 5045 a Fk(must)h Fj(be)f(running;)e(we)j(do)f(not)g(try)479
5153 y(to)h(solv)o(e)e(the)i(question)e(of)h(what)g(happens)f(if)h(the)
g(serv)o(er)g(crashes.)p Black 3759 5569 a Fi(240)p Black
eop end
%%Page: 241 255
TeXDict begin 241 254 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.241) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:2990) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end

-2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:2973) cvn /DEST pdfmark end
 -2 -11 a 396 72 a
Fj(Right)21 b(no)n(w)-5 b(,)19 b(these)h(tw)o(o)g(programs)f(don')o(t)f
(do)i(an)o(ything)e(real,)i(b)n(ut)g(the)o(y)g(correctly)f(synchronize)
e(state.)k(It')-5 b(s)21 b(a)g(neat)396 180 y(e)o(xample)e(of)h(ho)n(w)
g(to)g(mix)g(dif)n(ferent)e(patterns:)i(P)-8 b(AIR-o)o(v)o(er)n
(-inproc,)17 b(PUB-SUB,)k(and)f(R)m(OUTER-DEALER.)-2
209 y
SDict begin H.S end
 -2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:2974) cvn /DEST pdfmark end
 -2 209 a 396
519 a Fd(5.3.3.)36 b(Repub)o(lishing)f(Updates)1988 519
y
SDict begin H.S end
 1988 519 a 1988 519 a
SDict begin 18.72 H.A end
 1988 519 a 1988 519 a
SDict begin [/View [/XYZ H.V]/Dest (10.57.35.2) cvn /DEST pdfmark end
 1988 519
a -2 712 a
SDict begin H.S end
 -2 712 a -2 712 a
SDict begin 13 H.A end
 -2 712 a -2 712 a
SDict begin [/View [/XYZ H.V]/Dest (0:2976) cvn /DEST pdfmark end
 -2 712
a 396 793 a Fj(In)20 b(our)g(second)f(model,)g(changes)g(to)h(the)h(k)o
(e)o(y-v)n(alue)d(cache)h(came)h(from)f(the)i(serv)o(er)e(itself.)i
(This)f(is)h(a)g(centralized)396 901 y(model,)e(useful)g(for)g(e)o
(xample)f(if)i(we)g(ha)n(v)o(e)f(a)h(central)g(con\002guration)d
(\002le)j(we)g(w)o(ant)g(to)g(distrib)n(ute,)f(with)g(local)h(caching)
396 1009 y(on)g(each)g(node.)f(A)h(more)g(interesting)f(model)g(tak)o
(es)i(updates)e(from)h(clients,)g(not)g(the)g(serv)o(er)-5
b(.)19 b(The)h(serv)o(er)g(thus)396 1117 y(becomes)g(a)g(stateless)i
(brok)o(er)-5 b(.)18 b(This)j(gi)n(v)o(es)e(us)i(some)f(bene\002ts:)-2
1135 y
SDict begin H.S end
 -2 1135 a -2 1135 a
SDict begin 13 H.A end
 -2 1135 a -2 1135 a
SDict begin [/View [/XYZ H.V]/Dest (0:2977) cvn /DEST pdfmark end
 -2 1135
a -2 1145 a
SDict begin H.S end
 -2 1145 a -2 1145 a
SDict begin 13 H.A end
 -2 1145 a -2 1145 a
SDict begin [/View [/XYZ H.V]/Dest (0:2978) cvn /DEST pdfmark end
 -2
1145 a Black 396 1287 a Fe(\225)p Black 479 1287 a
SDict begin H.S end
 479
1287 a 479 1287 a
SDict begin 13 H.A end
 479 1287 a 479 1287 a
SDict begin [/View [/XYZ H.V]/Dest (0:2979) cvn /DEST pdfmark end
 479 1287 a Fj(W)-7
b(e')l(re)21 b(less)g(w)o(orried)e(about)g(the)h(reliability)g(of)g
(the)g(serv)o(er)-5 b(.)20 b(If)g(it)h(crashes,)f(we)g(can)g(start)h(a)
f(ne)n(w)g(instance,)g(and)479 1395 y(feed)g(it)h(ne)n(w)f(v)n(alues.)
-2 1396 y
SDict begin H.S end
 -2 1396 a -2 1396 a
SDict begin 13 H.A end
 -2 1396 a -2 1396 a
SDict begin [/View [/XYZ H.V]/Dest (0:2980) cvn /DEST pdfmark end
 -2
1396 a Black 396 1544 a Fe(\225)p Black 479 1544 a
SDict begin H.S end
 479
1544 a 479 1544 a
SDict begin 13 H.A end
 479 1544 a 479 1544 a
SDict begin [/View [/XYZ H.V]/Dest (0:2981) cvn /DEST pdfmark end
 479 1544 a Fj(W)-7
b(e)22 b(can)e(use)g(the)g(k)o(e)o(y-v)n(alue)e(cache)i(to)g(share)g
(kno)n(wledge)e(between)i(dynamic)e(peers.)-2 1728 y
SDict begin H.S end

-2 1728 a -2 1728 a
SDict begin 13 H.A end
 -2 1728 a -2 1728 a
SDict begin [/View [/XYZ H.V]/Dest (0:2982) cvn /DEST pdfmark end
 -2 1728 a 396
1818 a Fj(Updates)i(from)f(clients)i(go)f(via)g(a)g(PUSH-PULL)h(sock)o
(et)f(\003o)n(w)g(from)f(client)h(to)h(serv)o(er\()p
0 TeXcolorgray 2963 1818 a
SDict begin H.S end
 2963 1818 a Fj(Figure)c(5-5)3310
1818 y
SDict begin 13 H.L end
 3310 1818 a 3310 1818 a
SDict begin [/Subtype /Link/Dest (0:figure-66) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3310 1818 a Black -1 w
Fj(\).)-2 1836 y
SDict begin H.S end
 -2 1836 a -2 1836 a
SDict begin 13 H.A end
 -2 1836 a -2 1836
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-66) cvn /DEST pdfmark
end
 -2 1836 a 396 2020 a Fk(Figur)o(e)j(5-5.)f(Republishing)i(Updates)-2
2119 y
SDict begin H.S end
 -2 2119 a -2 2119 a
SDict begin 13 H.A end
 -2 2119 a -2 2119 a
SDict begin [/View [/XYZ H.V]/Dest (0:2986) cvn /DEST pdfmark end
 -2 2119
a 396 4494 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 4494 a @beginspecial 0 @llx -280 @lly
399 @urx 0 @ury 3990 @rwi @setspecial
%%BeginDocument: images/fig66.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -280 399 0
%%HiResBoundingBox: 0.0 -280.0 399.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
110.10021209716797 -27.100210189819336 moveto
110.10021209716797 -67.10021209716797 lineto
299.1002197265625 -67.10021209716797 lineto
299.1002197265625 -27.100210189819336 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
110.10021209716797 -67.10021209716797 moveto
110.10021209716797 -82.10021209716797 lineto
110.10021209716797 -85.4335454305013 111.4335454305013 -87.10021209716797 114.10021209716797 -87.10021209716797 curveto
171.70021057128906 -87.10021209716797 lineto
171.10020446777344 -87.10021209716797 lineto
171.10020446777344 -67.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
174.10020446777344 -67.10021209716797 moveto
174.10020446777344 -87.10021209716797 lineto
234.10020446777344 -87.10021209716797 lineto
234.10020446777344 -67.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
237.10020446777344 -67.10021209716797 moveto
237.10020446777344 -87.10021209716797 lineto
296.1002197265625 -87.10021209716797 lineto
298.1002197265625 -87.10021209716797 299.1002197265625 -85.4335454305013 299.1002197265625 -82.10021209716797 curveto
299.1002197265625 -67.10021209716797 lineto
299.1002197265625 -67.10021209716797 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
226.10020446777344 -197.10020446777344 moveto
223.43353780110678 -197.10020446777344 222.10020446777344 -198.7668711344401 222.10020446777344 -202.10020446777344 curveto
222.10020446777344 -217.10020446777344 lineto
269.1002197265625 -217.10020446777344 lineto
269.1002197265625 -197.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
272.1002197265625 -197.10020446777344 moveto
272.1002197265625 -217.10020446777344 lineto
332.1002197265625 -217.10020446777344 lineto
332.1002197265625 -197.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
335.1002197265625 -197.10020446777344 moveto
335.1002197265625 -217.10020446777344 lineto
383.1002197265625 -217.10020446777344 lineto
383.1002197265625 -202.10020446777344 lineto
383.1002197265625 -198.7668711344401 382.1002197265625 -197.10020446777344 380.1002197265625 -197.10020446777344 curveto
335.5002136230469 -197.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
222.10020446777344 -217.10020446777344 moveto
222.10020446777344 -257.1002197265625 lineto
383.1002197265625 -257.1002197265625 lineto
383.1002197265625 -217.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
23.100210189819336 -197.10020446777344 moveto
20.433543523152668 -197.10020446777344 19.100210189819336 -198.7668711344401 19.100210189819336 -202.10020446777344 curveto
19.100210189819336 -217.10020446777344 lineto
66.10021209716797 -217.10020446777344 lineto
66.10021209716797 -197.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
69.10021209716797 -197.10020446777344 moveto
69.10021209716797 -217.10020446777344 lineto
129.10020446777344 -217.10020446777344 lineto
129.10020446777344 -197.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
132.10020446777344 -197.10020446777344 moveto
132.10020446777344 -217.10020446777344 lineto
180.10020446777344 -217.10020446777344 lineto
180.10020446777344 -202.10020446777344 lineto
180.10020446777344 -198.7668711344401 179.10020446777344 -197.10020446777344 177.10020446777344 -197.10020446777344 curveto
132.5001983642578 -197.10020446777344 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.100210189819336 -217.10020446777344 moveto
19.100210189819336 -257.1002197265625 lineto
180.10020446777344 -257.1002197265625 lineto
180.10020446777344 -217.10020446777344 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
108.0 -25.0 moveto
108.0 -65.0 lineto
297.0 -65.0 lineto
297.0 -25.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.7 setlinewidth
1 setlinecap
[] 0 setdash
newpath
108.0 -25.0 moveto
108.0 -65.0 lineto
297.0 -65.0 lineto
297.0 -25.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
108.0 -65.0 moveto
108.0 -80.0 lineto
108.0 -83.33333333333333 109.33333333333333 -85.0 112.0 -85.0 curveto
169.60000610351562 -85.0 lineto
169.0 -85.0 lineto
169.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
108.0 -65.0 moveto
108.0 -80.0 lineto
108.0 -83.33333333333333 109.33333333333333 -85.0 112.0 -85.0 curveto
169.60000610351562 -85.0 lineto
169.0 -85.0 lineto
169.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
172.0 -65.0 moveto
172.0 -85.0 lineto
232.0 -85.0 lineto
232.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
172.0 -65.0 moveto
172.0 -85.0 lineto
232.0 -85.0 lineto
232.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
235.0 -65.0 moveto
235.0 -85.0 lineto
294.0 -85.0 lineto
296.0 -85.0 297.0 -83.33333333333333 297.0 -80.0 curveto
297.0 -65.0 lineto
297.0 -65.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
235.0 -65.0 moveto
235.0 -85.0 lineto
294.0 -85.0 lineto
296.0 -85.0 297.0 -83.33333333333333 297.0 -80.0 curveto
297.0 -65.0 lineto
297.0 -65.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
224.0 -195.0 moveto
221.33333333333334 -195.0 220.0 -196.66666666666666 220.0 -200.0 curveto
220.0 -215.0 lineto
267.0 -215.0 lineto
267.0 -195.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
224.0 -195.0 moveto
221.33333333333334 -195.0 220.0 -196.66666666666666 220.0 -200.0 curveto
220.0 -215.0 lineto
267.0 -215.0 lineto
267.0 -195.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
270.0 -195.0 moveto
270.0 -215.0 lineto
330.0 -215.0 lineto
330.0 -195.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
270.0 -195.0 moveto
270.0 -215.0 lineto
330.0 -215.0 lineto
330.0 -195.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
333.0 -195.0 moveto
333.0 -215.0 lineto
381.0 -215.0 lineto
381.0 -200.0 lineto
381.0 -196.66666666666666 380.0 -195.0 378.0 -195.0 curveto
333.3999938964844 -195.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
333.0 -195.0 moveto
333.0 -215.0 lineto
381.0 -215.0 lineto
381.0 -200.0 lineto
381.0 -196.66666666666666 380.0 -195.0 378.0 -195.0 curveto
333.3999938964844 -195.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
220.0 -215.0 moveto
220.0 -255.0 lineto
381.0 -255.0 lineto
381.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
220.0 -215.0 moveto
220.0 -255.0 lineto
381.0 -255.0 lineto
381.0 -215.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
21.0 -195.0 moveto
18.333333333333332 -195.0 17.0 -196.66666666666666 17.0 -200.0 curveto
17.0 -215.0 lineto
64.0 -215.0 lineto
64.0 -195.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
21.0 -195.0 moveto
18.333333333333332 -195.0 17.0 -196.66666666666666 17.0 -200.0 curveto
17.0 -215.0 lineto
64.0 -215.0 lineto
64.0 -195.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
67.0 -195.0 moveto
67.0 -215.0 lineto
127.0 -215.0 lineto
127.0 -195.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
67.0 -195.0 moveto
67.0 -215.0 lineto
127.0 -215.0 lineto
127.0 -195.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
130.0 -195.0 moveto
130.0 -215.0 lineto
178.0 -215.0 lineto
178.0 -200.0 lineto
178.0 -196.66666666666666 177.0 -195.0 175.0 -195.0 curveto
130.39999389648438 -195.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
130.0 -195.0 moveto
130.0 -215.0 lineto
178.0 -215.0 lineto
178.0 -200.0 lineto
178.0 -196.66666666666666 177.0 -195.0 175.0 -195.0 curveto
130.39999389648438 -195.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
17.0 -215.0 moveto
17.0 -255.0 lineto
178.0 -255.0 lineto
178.0 -215.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
17.0 -215.0 moveto
17.0 -255.0 lineto
178.0 -255.0 lineto
178.0 -215.0 lineto
closepath
stroke
newpath
38.0 -160.0 moveto
38.0 -185.0 lineto
stroke
newpath
199.0 -95.0 moveto
199.0 -130.0 lineto
199.0 -133.33333333333334 200.33333333333334 -135.0 203.0 -135.0 curveto
294.0 -135.0 lineto
294.0 -135.0 lineto
296.0 -135.0 297.0 -136.66666666666666 297.0 -140.0 curveto
297.0 -195.0 lineto
297.0 -195.0 lineto
stroke
newpath
262.0 -95.0 moveto
262.0 -110.0 lineto
262.0 -113.33333333333333 263.3333333333333 -115.0 266.0 -115.0 curveto
350.0 -115.0 lineto
350.0 -115.0 lineto
352.0 -115.0 353.0 -116.66666666666667 353.0 -120.0 curveto
353.0 -195.0 lineto
353.0 -195.0 lineto
stroke
newpath
94.0 -175.0 moveto
94.0 -195.0 lineto
stroke
newpath
150.0 -175.0 moveto
150.0 -195.0 lineto
stroke
newpath
199.0 -90.0 moveto
196.0 -100.0 lineto
203.0 -100.0 lineto
closepath
fill
newpath
262.0 -90.0 moveto
259.0 -100.0 lineto
266.0 -100.0 lineto
closepath
fill
newpath
94.0 -170.0 moveto
91.0 -180.0 lineto
98.0 -180.0 lineto
closepath
fill
newpath
150.0 -170.0 moveto
147.0 -180.0 lineto
154.0 -180.0 lineto
closepath
fill
newpath
35.0 -180.0 moveto
38.0 -190.0 lineto
42.0 -180.0 lineto
closepath
fill
newpath
238.0 -180.0 moveto
241.0 -190.0 lineto
245.0 -180.0 lineto
closepath
fill
newpath
143.0 -85.0 moveto
143.0 -155.0 lineto
stroke
newpath
45.0 -155.0 moveto
143.0 -155.0 lineto
stroke
newpath
241.0 -185.0 moveto
241.0 -160.0 lineto
241.0 -156.66666666666666 240.0 -155.0 238.0 -155.0 curveto
143.0 -155.0 lineto
143.0 -155.0 lineto
stroke
/Helvetica findfont
10 scalefont setfont
184.0 -49.0 moveto
(Server) show
134.0 -78.0 moveto
(PUB) show
183.0 -78.0 moveto
(ROUTER) show
253.0 -79.0 moveto
(PULL) show
279.0 -109.0 moveto
(state update) show
217.0 -129.0 moveto
(state request) show
120.0 -139.0 moveto
(updates) show
39.0 -159.0 moveto
(. ) show
29.0 -208.0 moveto
(SUB) show
79.0 -208.0 moveto
(DEALER) show
141.0 -208.0 moveto
(PUSH) show
232.0 -208.0 moveto
(SUB) show
282.0 -208.0 moveto
(DEALER) show
344.0 -208.0 moveto
(PUSH) show
82.0 -239.0 moveto
(Client) show
285.0 -239.0 moveto
(Client) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 4494 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 4494 a -2 4660 a
SDict begin H.S end
 -2 4660
a -2 4660 a
SDict begin 13 H.A end
 -2 4660 a -2 4660 a
SDict begin [/View [/XYZ H.V]/Dest (0:2989) cvn /DEST pdfmark end
 -2 4660 a 396 4768 a
Fj(Why)f(don')o(t)f(we)h(allo)n(w)g(clients)h(to)f(publish)f(updates)h
(directly)f(to)h(other)g(clients?)g(While)h(this)g(w)o(ould)e(reduce)g
(latenc)o(y)-5 b(,)396 4876 y(it)21 b(mak)o(es)f(it)h(impossible)f(to)g
(assign)g(ascending)f(unique)g(sequence)g(numbers)g(to)h(messages.)g
(The)g(serv)o(er)f(can)h(do)g(this.)396 4984 y(There')-5
b(s)20 b(a)g(more)f(subtle)h(second)f(reason.)f(In)i(man)o(y)f
(applications)f(it')-5 b(s)21 b(important)d(that)i(updates)f(ha)n(v)o
(e)h(a)g(single)g(order)m(,)p Black 3759 5569 a Fi(241)p
Black eop end
%%Page: 242 256
TeXDict begin 242 255 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.242) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black 396 72 a Fj(across)20 b(man)o(y)f(clients.)i(F)
o(orcing)e(all)h(updates)g(through)e(the)i(serv)o(er)f(ensures)h(that)g
(the)o(y)g(ha)n(v)o(e)f(the)i(same)f(order)f(when)396
180 y(the)o(y)h(\002nally)g(get)g(to)g(clients.)396 454
y(W)m(ith)h(unique)d(sequencing,)h(clients)h(can)g(detect)g(the)g
(nastier)g(f)o(ailures)g(-)h(netw)o(ork)e(congestion)f(and)i(queue)f(o)
o(v)o(er\003o)n(w)-5 b(.)396 562 y(If)20 b(a)h(client)f(disco)o(v)o
(ers)f(that)h(its)h(incoming)e(message)h(stream)g(has)g(a)h(hole,)f(it)
g(can)g(tak)o(e)h(action.)e(It)i(seems)f(sensible)g(that)396
670 y(the)g(client)g(contact)f(the)h(serv)o(er)f(and)g(ask)h(for)g(the)
g(missing)f(messages,)h(b)n(ut)g(in)g(practice)f(that)h(isn')o(t)g
(useful.)f(If)g(there)h(are)396 778 y(holes,)g(the)o(y')l(re)f(caused)g
(by)h(netw)o(ork)f(stress,)i(and)f(adding)e(more)i(stress)h(to)f(the)g
(netw)o(ork)f(will)i(mak)o(e)f(things)g(w)o(orse.)396
886 y(All)h(the)f(client)h(can)f(really)f(do)h(is)h(w)o(arn)f(its)h
(users)g("Unable)e(to)h(continue",)f(and)g(stop,)h(and)g(not)g(restart)
g(until)g(someone)396 994 y(has)h(manually)d(check)o(ed)h(the)i(cause)f
(of)g(the)g(problem.)-2 1178 y
SDict begin H.S end
 -2 1178 a -2 1178 a
SDict begin 13 H.A end
 -2
1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:2991) cvn /DEST pdfmark end
 -2 1178 a 396 1268 a Fj(W)-7 b(e')o(ll)22
b(no)n(w)d(generate)g(state)i(updates)e(in)i(the)f(client.)g(Here')-5
b(s)20 b(the)h(serv)o(er:)-2 1286 y
SDict begin H.S end
 -2 1286 a -2 1286
a
SDict begin 13 H.A end
 -2 1286 a -2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonesrv3-php) cvn /DEST pdfmark
end
 -2 1286 a 396 1469 a Fk(Example)g(5-7.)e(Clone)h
(ser)o(v)o(er)-8 b(,)21 b(Model)f(Thr)o(ee)h(\(clonesr)o(v3.php\))-2
1569 y
SDict begin H.S end
 -2 1569 a -2 1569 a
SDict begin 11.7 H.A end
 -2 1569 a -2 1569 a
SDict begin [/View [/XYZ H.V]/Dest (0:2994) cvn /DEST pdfmark end
 -2 1569
a 396 1649 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 1827 y
SDict begin H.S end
 -2 1827 a -2 1827 a
SDict begin 13 H.A end
 -2 1827 a
-2 1827 a
SDict begin [/View [/XYZ H.V]/Dest (0:2995) cvn /DEST pdfmark end
 -2 1827 a 396 1923 a Fj(And)20 b(here)g(is)h(the)f(client:)-2
1924 y
SDict begin H.S end
 -2 1924 a -2 1924 a
SDict begin 13 H.A end
 -2 1924 a -2 1924 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonecli3-php) cvn /DEST pdfmark
end
 -2 1924
a 396 2125 a Fk(Example)h(5-8.)e(Clone)h(client,)g(Model)h(Thr)o(ee)f
(\(clonecli3.php\))-2 2225 y
SDict begin H.S end
 -2 2225 a -2 2225 a
SDict begin 11.7 H.A end
 -2 2225
a -2 2225 a
SDict begin [/View [/XYZ H.V]/Dest (0:2998) cvn /DEST pdfmark end
 -2 2225 a 396 2305 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 2482 y
SDict begin H.S end
 -2 2482
a -2 2482 a
SDict begin 13 H.A end
 -2 2482 a -2 2482 a
SDict begin [/View [/XYZ H.V]/Dest (0:2999) cvn /DEST pdfmark end
 -2 2482 a 396 2579 a
Fj(Some)20 b(notes)g(about)f(this)i(code:)-2 2580 y
SDict begin H.S end
 -2
2580 a -2 2580 a
SDict begin 13 H.A end
 -2 2580 a -2 2580 a
SDict begin [/View [/XYZ H.V]/Dest (0:3000) cvn /DEST pdfmark end
 -2 2580 a -2 2590
a
SDict begin H.S end
 -2 2590 a -2 2590 a
SDict begin 13 H.A end
 -2 2590 a -2 2590 a
SDict begin [/View [/XYZ H.V]/Dest (0:3001) cvn /DEST pdfmark end
 -2 2590 a Black
396 2749 a Fe(\225)p Black 479 2749 a
SDict begin H.S end
 479 2749 a 479
2749 a
SDict begin 13 H.A end
 479 2749 a 479 2749 a
SDict begin [/View [/XYZ H.V]/Dest (0:3002) cvn /DEST pdfmark end
 479 2749 a Fj(The)f(serv)o(er)f(has)h
(collapsed)f(to)h(a)g(single)g(task.)g(It)g(manages)f(a)h(PULL)g(sock)o
(et)g(for)f(incoming)f(updates,)h(a)h(R)m(OUTER)479 2857
y(sock)o(et)g(for)g(state)h(requests,)e(and)h(a)h(PUB)g(sock)o(et)f
(for)f(outgoing)f(updates.)-2 2875 y
SDict begin H.S end
 -2 2875 a -2 2875
a
SDict begin 13 H.A end
 -2 2875 a -2 2875 a
SDict begin [/View [/XYZ H.V]/Dest (0:3003) cvn /DEST pdfmark end
 -2 2875 a Black 396 3006 a Fe(\225)p
Black 479 3006 a
SDict begin H.S end
 479 3006 a 479 3006 a
SDict begin 13 H.A end
 479 3006 a 479
3006 a
SDict begin [/View [/XYZ H.V]/Dest (0:3004) cvn /DEST pdfmark end
 479 3006 a Fj(The)i(client)g(uses)h(a)g(simple)f(tickless)h
(timer)f(to)g(send)g(a)h(random)d(update)h(to)h(the)h(serv)o(er)e(once)
g(a)i(second.)e(In)h(a)h(real)479 3114 y(implementation)d(we)j(w)o
(ould)e(dri)n(v)o(e)g(updates)h(from)f(application)g(code.)-2
3174 y
SDict begin H.S end
 -2 3174 a -2 3174 a
SDict begin 13 H.A end
 -2 3174 a -2 3174 a
SDict begin [/View [/XYZ H.V]/Dest (0:3005) cvn /DEST pdfmark end
 -2 3174
a 396 3484 a Fd(5.3.4.)36 b(Clone)e(Subtrees)1605 3484
y
SDict begin H.S end
 1605 3484 a 1605 3484 a
SDict begin 18.72 H.A end
 1605 3484 a 1605 3484 a
SDict begin [/View [/XYZ H.V]/Dest (10.57.36.2) cvn /DEST pdfmark end
 1605
3484 a -2 3652 a
SDict begin H.S end
 -2 3652 a -2 3652 a
SDict begin 13 H.A end
 -2 3652 a -2 3652
a
SDict begin [/View [/XYZ H.V]/Dest (0:3007) cvn /DEST pdfmark end
 -2 3652 a 396 3758 a Fj(A)21 b(realistic)g(k)o(e)o(y-v)n(alue)d
(cache)h(will)i(get)f(lar)o(ge,)f(and)h(clients)h(will)f(usually)g(be)g
(interested)g(only)f(in)h(parts)h(of)e(the)i(cache.)396
3866 y(W)-7 b(orking)20 b(with)g(a)h(subtree)e(is)i(f)o(airly)f
(simple.)g(The)g(client)g(has)g(to)h(tell)g(the)f(serv)o(er)f(the)h
(subtree)g(when)f(it)i(mak)o(es)f(a)h(state)396 3974
y(request,)f(and)f(it)i(has)g(to)f(specify)f(the)i(same)f(subtree)f
(when)h(it)h(subscribes)f(to)g(updates.)-2 4158 y
SDict begin H.S end
 -2
4158 a -2 4158 a
SDict begin 13 H.A end
 -2 4158 a -2 4158 a
SDict begin [/View [/XYZ H.V]/Dest (0:3008) cvn /DEST pdfmark end
 -2 4158 a 396 4248
a Fj(There)g(are)g(a)g(couple)f(of)h(common)f(syntax)o(es)g(for)h
(trees.)g(One)g(is)h(the)f("path)g(hierarchy",)d(and)j(another)f(is)i
(the)f("topic)396 4356 y(tree".)g(These)g(look)f(lik)o(e:)-2
4357 y
SDict begin H.S end
 -2 4357 a -2 4357 a
SDict begin 13 H.A end
 -2 4357 a -2 4357 a
SDict begin [/View [/XYZ H.V]/Dest (0:3009) cvn /DEST pdfmark end
 -2 4357
a -2 4367 a
SDict begin H.S end
 -2 4367 a -2 4367 a
SDict begin 13 H.A end
 -2 4367 a -2 4367 a
SDict begin [/View [/XYZ H.V]/Dest (0:3010) cvn /DEST pdfmark end
 -2
4367 a Black 396 4526 a Fe(\225)p Black 479 4526 a
SDict begin H.S end
 479
4526 a 479 4526 a
SDict begin 13 H.A end
 479 4526 a 479 4526 a
SDict begin [/View [/XYZ H.V]/Dest (0:3011) cvn /DEST pdfmark end
 479 4526 a Fj(P)o(ath)h
(hierarchy:)e("/some/list/of/paths")-2 4544 y
SDict begin H.S end
 -2 4544
a -2 4544 a
SDict begin 13 H.A end
 -2 4544 a -2 4544 a
SDict begin [/View [/XYZ H.V]/Dest (0:3012) cvn /DEST pdfmark end
 -2 4544 a Black 396 4675
a Fe(\225)p Black 479 4675 a
SDict begin H.S end
 479 4675 a 479 4675 a
SDict begin 13 H.A end
 479
4675 a 479 4675 a
SDict begin [/View [/XYZ H.V]/Dest (0:3013) cvn /DEST pdfmark end
 479 4675 a Fj(T)-7 b(opic)20 b(tree:)g
("some.list.of.topics")-2 4859 y
SDict begin H.S end
 -2 4859 a -2 4859 a
SDict begin 13 H.A end

-2 4859 a -2 4859 a
SDict begin [/View [/XYZ H.V]/Dest (0:3014) cvn /DEST pdfmark end
 -2 4859 a 396 4949 a Fj(W)-7 b(e')o(ll)22
b(use)e(the)g(path)g(hierarchy)-5 b(,)17 b(and)j(e)o(xtend)f(our)g
(client)h(and)g(serv)o(er)f(so)i(that)f(a)h(client)f(can)g(w)o(ork)f
(with)i(a)f(single)396 5057 y(subtree.)f(W)-7 b(orking)19
b(with)h(multiple)f(subtrees)g(is)i(not)e(much)g(more)g(dif)n
(\002cult,)g(we)h(w)o(on')o(t)f(do)g(that)h(here)f(b)n(ut)h(it')-5
b(s)21 b(a)f(tri)n(vial)396 5165 y(e)o(xtension.)p Black
3759 5569 a Fi(242)p Black eop end
%%Page: 243 257
TeXDict begin 243 256 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.243) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3015) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Here')i(s)21 b(the)f(serv)o(er)m(,)
f(a)h(small)h(v)n(ariation)e(on)h(Model)f(Three:)-2 84
y
SDict begin H.S end
 -2 84 a -2 84 a
SDict begin 13 H.A end
 -2 84 a -2 84 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonesrv4-php) cvn /DEST pdfmark
end
 -2 84 a 396 274 a Fk(Example)i(5-9.)e
(Clone)h(ser)o(v)o(er)-8 b(,)21 b(Model)f(F)n(our)g(\(clonesr)o
(v4.php\))-2 374 y
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 11.7 H.A end
 -2 374 a -2 374
a
SDict begin [/View [/XYZ H.V]/Dest (0:3018) cvn /DEST pdfmark end
 -2 374 a 396 454 a Fg(\(This)44 b(example)g(still)g(needs)g
(translation)f(into)h(PHP\))-2 632 y
SDict begin H.S end
 -2 632 a -2 632
a
SDict begin 13 H.A end
 -2 632 a -2 632 a
SDict begin [/View [/XYZ H.V]/Dest (0:3019) cvn /DEST pdfmark end
 -2 632 a 396 728 a Fj(And)20 b(here)g(is)h(the)f
(client:)-2 729 y
SDict begin H.S end
 -2 729 a -2 729 a
SDict begin 13 H.A end
 -2 729 a -2 729 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonecli4-php) cvn /DEST pdfmark
end

-2 729 a 396 929 a Fk(Example)h(5-10.)d(Clone)j(client,)f(Model)h(F)n
(our)f(\(clonecli4.php\))-2 1029 y
SDict begin H.S end
 -2 1029 a -2 1029
a
SDict begin 11.7 H.A end
 -2 1029 a -2 1029 a
SDict begin [/View [/XYZ H.V]/Dest (0:3022) cvn /DEST pdfmark end
 -2 1029 a 396 1109 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
1204 y
SDict begin H.S end
 -2 1204 a -2 1204 a
SDict begin 13 H.A end
 -2 1204 a -2 1204 a
SDict begin [/View [/XYZ H.V]/Dest (0:3023) cvn /DEST pdfmark end
 -2 1204
a 396 1521 a Fd(5.3.5.)36 b(Ephemeral)e(V)-7 b(alues)1750
1521 y
SDict begin H.S end
 1750 1521 a 1750 1521 a
SDict begin 18.72 H.A end
 1750 1521 a 1750 1521
a
SDict begin [/View [/XYZ H.V]/Dest (10.57.37.2) cvn /DEST pdfmark end
 1750 1521 a -2 1711 a
SDict begin H.S end
 -2 1711 a -2 1711 a
SDict begin 13 H.A end
 -2 1711 a
-2 1711 a
SDict begin [/View [/XYZ H.V]/Dest (0:3025) cvn /DEST pdfmark end
 -2 1711 a 396 1795 a Fj(An)20 b(ephemeral)f(v)n(alue)h(is)h
(one)e(that)i(e)o(xpires)e(dynamically)-5 b(.)17 b(If)j(you)g(think)f
(of)h(Clone)g(being)f(used)h(for)g(a)h(DNS-lik)o(e)396
1902 y(service,)f(then)g(ephemeral)e(v)n(alues)i(w)o(ould)f(let)i(you)e
(do)h(dynamic)f(DNS.)h(A)h(node)e(joins)i(the)f(netw)o(ork,)f
(publishes)g(its)396 2010 y(address,)h(and)f(refreshes)h(this)g(re)o
(gularly)-5 b(.)18 b(If)i(the)g(node)f(dies,)i(its)g(address)f(e)n(v)o
(entually)e(gets)i(remo)o(v)o(ed.)-2 2194 y
SDict begin H.S end
 -2 2194 a
-2 2194 a
SDict begin 13 H.A end
 -2 2194 a -2 2194 a
SDict begin [/View [/XYZ H.V]/Dest (0:3026) cvn /DEST pdfmark end
 -2 2194 a 396 2284 a Fj(The)g(usual)g
(abstraction)f(for)h(ephemeral)e(v)n(alues)i(is)h(to)g(attach)f(them)f
(to)i(a)f("session",)g(and)g(delete)g(them)g(when)f(the)396
2392 y(session)i(ends.)f(In)f(Clone,)h(sessions)h(w)o(ould)f(be)g
(de\002ned)f(by)h(clients,)g(and)g(w)o(ould)f(end)h(if)g(the)g(client)h
(died.)-2 2576 y
SDict begin H.S end
 -2 2576 a -2 2576 a
SDict begin 13 H.A end
 -2 2576 a -2 2576
a
SDict begin [/View [/XYZ H.V]/Dest (0:3027) cvn /DEST pdfmark end
 -2 2576 a 396 2666 a Fj(The)f(simpler)f(alternati)n(v)o(e)g(to)h
(using)g(sessions)g(is)h(to)f(de\002ne)g(e)n(v)o(ery)e(ephemeral)g(v)n
(alue)i(with)g(a)g("time)g(to)g(li)n(v)o(e")g(that)g(tells)396
2774 y(the)g(serv)o(er)g(when)f(to)i(e)o(xpire)e(the)h(v)n(alue.)f
(Clients)i(then)f(refresh)f(v)n(alues,)h(and)f(if)i(the)o(y)e(don')o
(t,)g(the)h(v)n(alues)g(e)o(xpire.)-2 2958 y
SDict begin H.S end
 -2 2958
a -2 2958 a
SDict begin 13 H.A end
 -2 2958 a -2 2958 a
SDict begin [/View [/XYZ H.V]/Dest (0:3028) cvn /DEST pdfmark end
 -2 2958 a 396 3048 a
Fj(I'm)g(going)f(to)h(implement)f(that)h(simpler)g(model)f(because)h
(we)h(don')o(t)d(kno)n(w)h(yet)h(that)h(it')-5 b(s)21
b(w)o(orth)f(making)e(a)j(more)396 3156 y(comple)o(x)e(one.)g(The)h
(dif)n(ference)e(is)j(really)f(in)g(performance.)d(If)j(clients)h(ha)n
(v)o(e)f(a)g(handful)f(of)g(ephemeral)g(v)n(alues,)h(it')-5
b(s)396 3264 y(\002ne)20 b(to)g(set)h(a)f(TTL)f(on)h(each)f(one.)g(If)g
(clients)i(use)e(masses)i(of)e(ephemeral)g(v)n(alues,)g(it')-5
b(s)20 b(more)f(ef)n(\002cient)h(to)g(attach)f(them)396
3372 y(to)i(sessions,)f(and)g(e)o(xpire)f(them)h(in)g(b)n(ulk.)-2
3556 y
SDict begin H.S end
 -2 3556 a -2 3556 a
SDict begin 13 H.A end
 -2 3556 a -2 3556 a
SDict begin [/View [/XYZ H.V]/Dest (0:3029) cvn /DEST pdfmark end
 -2 3556
a 396 3646 a Fj(First)h(of)n(f,)f(we)g(need)g(a)g(w)o(ay)g(to)h(encode)
e(the)h(TTL)g(in)g(the)g(k)o(e)o(y-v)n(alue)e(message.)i(W)-7
b(e)21 b(could)f(add)f(a)i(frame.)e(The)396 3754 y(problem)g(with)h
(using)g(frames)f(for)h(properties)f(is)i(that)f(each)g(time)g(we)h(w)o
(ant)f(to)h(add)e(a)i(ne)n(w)f(property)-5 b(,)17 b(we)k(ha)n(v)o(e)e
(to)396 3862 y(change)g(the)h(structure)g(of)g(our)f(kvmsg)g(class.)i
(It)f(breaks)g(compatibility)-5 b(.)18 b(So)i(let')-5
b(s)21 b(add)f(a)h('properties')d(frame)h(to)h(the)396
3970 y(message,)g(and)g(code)f(to)i(let)f(us)h(get)f(and)g(put)g
(property)e(v)n(alues.)-2 4154 y
SDict begin H.S end
 -2 4154 a -2 4154 a
SDict begin 13 H.A end

-2 4154 a -2 4154 a
SDict begin [/View [/XYZ H.V]/Dest (0:3030) cvn /DEST pdfmark end
 -2 4154 a 396 4244 a Fj(Ne)o(xt,)i(we)g(need)g(a)h
(w)o(ay)f(to)g(say)-5 b(,)20 b("delete)g(this)h(v)n(alue".)e(Up)h(to)g
(no)n(w)g(serv)o(ers)g(and)f(clients)i(ha)n(v)o(e)e(al)o(w)o(ays)i
(blindly)396 4352 y(inserted)f(or)g(updated)e(ne)n(w)i(v)n(alues)g
(into)g(their)g(hash)g(table.)g(W)-7 b(e')o(ll)21 b(say)g(that)f(if)g
(the)h(v)n(alue)e(is)i(empty)-5 b(,)19 b(that)h(means)396
4460 y("delete)g(this)h(k)o(e)o(y".)-2 4644 y
SDict begin H.S end
 -2 4644
a -2 4644 a
SDict begin 13 H.A end
 -2 4644 a -2 4644 a
SDict begin [/View [/XYZ H.V]/Dest (0:3031) cvn /DEST pdfmark end
 -2 4644 a 396 4733 a
Fj(Here')-5 b(s)21 b(a)f(more)g(complete)f(v)o(ersion)g(of)h(the)g
(kvmsg)f(class,)i(which)f(implements)f(a)h('properties')e(frame)i
(\(and)f(adds)h(a)396 4841 y(UUID)g(frame,)g(which)f(we')o(ll)i(need)e
(later)i(on\).)e(It)h(also)h(handles)e(empty)g(v)n(alues)h(by)g
(deleting)f(the)h(k)o(e)o(y)g(from)f(the)h(hash,)396
4949 y(if)h(necessary:)-2 4967 y
SDict begin H.S end
 -2 4967 a -2 4967 a
SDict begin 13 H.A end

-2 4967 a -2 4967 a
SDict begin [/View [/XYZ H.V]/Dest (0:kvmsg-php) cvn /DEST pdfmark
end
 -2 4967 a Black 3759 5569 a Fi(243)p
Black eop end
%%Page: 244 258
TeXDict begin 244 257 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.244) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3055) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black 396 72 a
Fk(Example)21 b(5-11.)d(K)n(ey-v)o(alue)h(message)h(class)h(-)f(full)h
(\(kvmsg)o(.php\))-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 11.7 H.A end
 -2 172 a
-2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:3034) cvn /DEST pdfmark end
 -2 172 a 396 253 a Fg(\(This)44 b(example)g(still)g(needs)g
(translation)f(into)h(PHP\))-2 430 y
SDict begin H.S end
 -2 430 a -2 430
a
SDict begin 13 H.A end
 -2 430 a -2 430 a
SDict begin [/View [/XYZ H.V]/Dest (0:3035) cvn /DEST pdfmark end
 -2 430 a 396 527 a Fj(The)20 b(Model)g(Fi)n(v)o(e)g
(client)g(is)h(almost)f(identical)g(to)g(Model)g(F)o(our)-5
b(.)19 b(Dif)n(f)h(is)h(your)e(friend.)g(It)i(uses)f(the)h(full)f
(kvmsg)f(class)396 635 y(instead)h(of)g(kvsimple,)f(and)h(sets)h(a)g
(randomized)c(')o(ttl')j(property)e(\(measured)h(in)h(seconds\))f(on)h
(each)g(message:)-2 736 y
SDict begin H.S end
 -2 736 a -2 736 a
SDict begin 11.7 H.A end
 -2 736 a
-2 736 a
SDict begin [/View [/XYZ H.V]/Dest (0:3036) cvn /DEST pdfmark end
 -2 736 a 396 815 a Fg(kvmsg_set_prop)43 b(\(kvmsg,)g("ttl",)h
("\045d",)g(randof)g(\(30\)\);)-2 992 y
SDict begin H.S end
 -2 992 a -2 992
a
SDict begin 13 H.A end
 -2 992 a -2 992 a
SDict begin [/View [/XYZ H.V]/Dest (0:3037) cvn /DEST pdfmark end
 -2 992 a 396 1089 a Fj(The)20 b(Model)g(Fi)n(v)o(e)
g(serv)o(er)f(has)h(totally)g(changed.)f(Instead)g(of)h(a)h(poll)f
(loop,)f(we')l(re)g(no)n(w)h(using)g(a)g(reactor)-5 b(.)20
b(This)g(just)396 1197 y(mak)o(es)g(it)h(simpler)f(to)g(mix)g(timers)h
(and)e(sock)o(et)h(e)n(v)o(ents.)g(Unfortunately)d(in)j(C)i(the)e
(reactor)f(style)i(is)g(more)e(v)o(erbose.)396 1305 y(Y)-9
b(our)19 b(mileage)h(will)h(v)n(ary)e(in)i(other)e(languages.)f(But)j
(reactors)f(seem)g(to)g(be)h(a)f(better)g(w)o(ay)g(of)g(b)n(uilding)f
(more)396 1412 y(comple)o(x)g(\330MQ)h(applications.)f(Here')-5
b(s)20 b(the)h(serv)o(er:)-2 1430 y
SDict begin H.S end
 -2 1430 a -2 1430
a
SDict begin 13 H.A end
 -2 1430 a -2 1430 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonesrv5-php) cvn /DEST pdfmark
end
 -2 1430 a 396 1614 a Fk(Example)g(5-12.)d(Clone)j
(ser)o(v)o(er)-8 b(,)20 b(Model)h(Fi)o(v)o(e)f(\(clonesr)o(v5.php\))-2
1714 y
SDict begin H.S end
 -2 1714 a -2 1714 a
SDict begin 11.7 H.A end
 -2 1714 a -2 1714 a
SDict begin [/View [/XYZ H.V]/Dest (0:3040) cvn /DEST pdfmark end
 -2 1714
a 396 1794 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 1888 y
SDict begin H.S end
 -2 1888 a -2 1888 a
SDict begin 13 H.A end
 -2 1888 a
-2 1888 a
SDict begin [/View [/XYZ H.V]/Dest (0:3041) cvn /DEST pdfmark end
 -2 1888 a 396 2205 a Fd(5.3.6.)36 b(Clone)e(Ser)q(ver)g
(Reliability)2063 2205 y
SDict begin H.S end
 2063 2205 a 2063 2205 a
SDict begin 18.72 H.A end
 2063
2205 a 2063 2205 a
SDict begin [/View [/XYZ H.V]/Dest (10.57.38.2) cvn /DEST pdfmark end
 2063 2205 a -2 2396 a
SDict begin H.S end
 -2 2396 a -2
2396 a
SDict begin 13 H.A end
 -2 2396 a -2 2396 a
SDict begin [/View [/XYZ H.V]/Dest (0:3043) cvn /DEST pdfmark end
 -2 2396 a 396 2479 a Fj(Clone)20
b(models)g(one)g(to)g(\002)n(v)o(e)g(are)g(relati)n(v)o(ely)f(simple.)h
(W)-7 b(e')l(re)20 b(no)n(w)g(going)f(to)h(get)g(into)g(unpleasantly)f
(comple)o(x)396 2587 y(territory)g(here)h(that)g(has)g(me)h(getting)e
(up)h(for)f(another)g(espresso.)h(Y)-9 b(ou)19 b(should)h(appreciate)f
(that)h(making)f("reliable")396 2695 y(messaging)h(is)h(comple)o(x)d
(enough)g(that)j(you)e(al)o(w)o(ays)h(need)g(to)g(ask,)h("do)e(we)i
(actually)e(need)h(this?")g(before)f(jumping)396 2803
y(into)h(it.)h(If)f(you)f(can)h(get)g(a)o(w)o(ay)g(with)h(unreliable,)d
(or)i("good)f(enough")f(reliability)-5 b(,)19 b(you)g(can)h(mak)o(e)g
(a)g(huge)g(win)g(in)396 2911 y(terms)g(of)g(cost)h(and)f(comple)o
(xity)-5 b(.)17 b(Sure,)j(you)f(may)h(lose)g(some)g(data)g(no)n(w)g
(and)g(then.)f(It)i(is)g(often)e(a)i(good)d(trade-of)n(f.)396
3019 y(Ha)n(ving)i(said,)g(that,)g(and)g(\(sips\))g(since)g(the)h
(espresso)f(is)h(really)e(good,)g(let')-5 b(s)21 b(jump)f(in!)-2
3203 y
SDict begin H.S end
 -2 3203 a -2 3203 a
SDict begin 13 H.A end
 -2 3203 a -2 3203 a
SDict begin [/View [/XYZ H.V]/Dest (0:3044) cvn /DEST pdfmark end
 -2 3203
a 396 3293 a Fj(As)h(you)f(play)f(with)i(model)e(three,)g(you')o(ll)h
(stop)g(and)f(restart)i(the)f(serv)o(er)-5 b(.)19 b(It)i(might)e(look)h
(lik)o(e)g(it)h(reco)o(v)o(ers,)d(b)n(ut)j(of)396 3401
y(course)f(it')-5 b(s)21 b(applying)d(updates)i(to)g(an)g(empty)f
(state,)i(instead)f(of)g(the)g(proper)f(current)g(state.)h(An)o(y)g(ne)
n(w)g(client)g(joining)396 3509 y(the)g(netw)o(ork)f(will)i(get)g(just)
f(the)h(latest)g(updates,)e(instead)h(of)g(all)g(of)g(them.)g(So)g
(let')-5 b(s)21 b(w)o(ork)f(out)g(a)g(design)g(for)f(making)396
3616 y(Clone)h(w)o(ork)g(despite)g(serv)o(er)f(f)o(ailures.)-2
3800 y
SDict begin H.S end
 -2 3800 a -2 3800 a
SDict begin 13 H.A end
 -2 3800 a -2 3800 a
SDict begin [/View [/XYZ H.V]/Dest (0:3045) cvn /DEST pdfmark end
 -2 3800
a 396 3890 a Fj(Let')-5 b(s)21 b(list)g(the)g(f)o(ailures)e(we)i(w)o
(ant)f(to)h(be)f(able)g(to)g(handle:)-2 3891 y
SDict begin H.S end
 -2 3891
a -2 3891 a
SDict begin 13 H.A end
 -2 3891 a -2 3891 a
SDict begin [/View [/XYZ H.V]/Dest (0:3046) cvn /DEST pdfmark end
 -2 3891 a -2 3901 a
SDict begin H.S end
 -2
3901 a -2 3901 a
SDict begin 13 H.A end
 -2 3901 a -2 3901 a
SDict begin [/View [/XYZ H.V]/Dest (0:3047) cvn /DEST pdfmark end
 -2 3901 a Black
396 4061 a Fe(\225)p Black 479 4061 a
SDict begin H.S end
 479 4061 a 479
4061 a
SDict begin 13 H.A end
 479 4061 a 479 4061 a
SDict begin [/View [/XYZ H.V]/Dest (0:3048) cvn /DEST pdfmark end
 479 4061 a Fj(Clone)g(serv)o(er)f(process)
g(crashes)h(and)f(is)h(automatically)f(or)g(manually)f(restarted.)h
(The)h(process)f(loses)h(its)h(state)f(and)479 4169 y(has)h(to)f(get)g
(it)h(back)f(from)f(some)n(where.)-2 4187 y
SDict begin H.S end
 -2 4187 a
-2 4187 a
SDict begin 13 H.A end
 -2 4187 a -2 4187 a
SDict begin [/View [/XYZ H.V]/Dest (0:3049) cvn /DEST pdfmark end
 -2 4187 a Black 396 4318
a Fe(\225)p Black 479 4318 a
SDict begin H.S end
 479 4318 a 479 4318 a
SDict begin 13 H.A end
 479
4318 a 479 4318 a
SDict begin [/View [/XYZ H.V]/Dest (0:3050) cvn /DEST pdfmark end
 479 4318 a Fj(Clone)h(serv)o(er)g(machine)f(dies)h
(and)g(is)h(of)n(f-line)e(for)g(a)i(signi\002cant)f(time.)g(Clients)h
(ha)n(v)o(e)e(to)i(switch)f(to)h(an)f(alternate)479 4426
y(serv)o(er)g(some)n(where.)-2 4427 y
SDict begin H.S end
 -2 4427 a -2 4427
a
SDict begin 13 H.A end
 -2 4427 a -2 4427 a
SDict begin [/View [/XYZ H.V]/Dest (0:3051) cvn /DEST pdfmark end
 -2 4427 a Black 396 4575 a Fe(\225)p
Black 479 4575 a
SDict begin H.S end
 479 4575 a 479 4575 a
SDict begin 13 H.A end
 479 4575 a 479
4575 a
SDict begin [/View [/XYZ H.V]/Dest (0:3052) cvn /DEST pdfmark end
 479 4575 a Fj(Clone)g(serv)o(er)g(process)f(or)h(machine)f(gets)
i(disconnected)d(from)h(the)h(netw)o(ork,)f(e.g.)h(a)g(switch)h(dies.)f
(It)h(may)e(come)479 4683 y(back)h(at)g(some)g(point,)g(b)n(ut)g(in)g
(the)g(meantime)g(clients)g(need)g(an)g(alternate)f(serv)o(er)-5
b(.)-2 4867 y
SDict begin H.S end
 -2 4867 a -2 4867 a
SDict begin 13 H.A end
 -2 4867 a -2 4867 a
SDict begin [/View [/XYZ H.V]/Dest (0:3053) cvn /DEST pdfmark end

-2 4867 a 396 4957 a Fj(Our)20 b(\002rst)h(step)g(is)g(to)f(add)g(a)g
(second)g(serv)o(er)-5 b(.)19 b(W)-7 b(e)21 b(can)f(use)h(the)f(Binary)
g(Star)g(pattern)g(from)f(Reliable)h(Request-Reply)396
5065 y(P)o(atterns)p 0 TeXcolorgray 663 5065 a
SDict begin H.S end
 663 5065
a Fj(Chapter)f(4)988 5065 y
SDict begin 13 H.L end
 988 5065 a 988 5065 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 988
5065 a Black 20 w Fj(to)i(or)o(ganize)c(these)k(into)f(primary)e(and)i
(backup.)e(Binary)i(Star)g(is)i(a)e(reactor)m(,)f(so)h(it')-5
b(s)22 b(useful)d(that)p Black 3759 5569 a Fi(244)p Black
eop end
%%Page: 245 259
TeXDict begin 245 258 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.245) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3085) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black 396 72 a
Fj(we)21 b(already)e(ref)o(actored)f(the)j(last)g(serv)o(er)e(model)g
(into)h(a)h(reactor)e(style.)396 346 y(W)-7 b(e)22 b(need)d(to)h
(ensure)g(that)g(updates)g(are)g(not)g(lost)g(if)h(the)f(primary)f
(serv)o(er)g(crashes.)h(The)g(simplest)g(technique)f(is)i(to)396
454 y(send)f(them)g(to)g(both)g(serv)o(ers.)-2 621 y
SDict begin H.S end

-2 621 a -2 621 a
SDict begin 13 H.A end
 -2 621 a -2 621 a
SDict begin [/View [/XYZ H.V]/Dest (0:3056) cvn /DEST pdfmark end
 -2 621 a 396 728
a Fj(The)g(backup)f(serv)o(er)g(can)h(then)g(act)g(as)h(a)g(client,)f
(and)f(k)o(eep)h(its)h(state)g(synchronized)d(by)h(recei)n(ving)g
(updates)g(as)i(all)396 836 y(clients)g(do.)e(It')o(ll)i(also)f(get)g
(ne)n(w)g(updates)g(from)f(clients.)h(It)h(can')o(t)e(yet)h(store)g
(these)h(in)f(its)h(hash)f(table,)g(b)n(ut)g(it)h(can)f(hold)396
944 y(onto)g(them)f(for)h(a)h(while.)-2 1111 y
SDict begin H.S end
 -2 1111
a -2 1111 a
SDict begin 13 H.A end
 -2 1111 a -2 1111 a
SDict begin [/View [/XYZ H.V]/Dest (0:3057) cvn /DEST pdfmark end
 -2 1111 a 396 1218 a
Fj(So,)f(Model)g(Six)g(introduces)f(these)h(changes)g(o)o(v)o(er)e
(Model)i(Fi)n(v)o(e:)-2 1236 y
SDict begin H.S end
 -2 1236 a -2 1236 a
SDict begin 13 H.A end
 -2
1236 a -2 1236 a
SDict begin [/View [/XYZ H.V]/Dest (0:3058) cvn /DEST pdfmark end
 -2 1236 a -2 1246 a
SDict begin H.S end
 -2 1246 a -2 1246
a
SDict begin 13 H.A end
 -2 1246 a -2 1246 a
SDict begin [/View [/XYZ H.V]/Dest (0:3059) cvn /DEST pdfmark end
 -2 1246 a Black 396 1388 a Fe(\225)p
Black 479 1388 a
SDict begin H.S end
 479 1388 a 479 1388 a
SDict begin 13 H.A end
 479 1388 a 479
1388 a
SDict begin [/View [/XYZ H.V]/Dest (0:3060) cvn /DEST pdfmark end
 479 1388 a Fj(W)-7 b(e)21 b(use)f(a)g(pub-sub)e(\003o)n(w)i
(instead)f(of)h(a)g(push-pull)e(\003o)n(w)i(for)f(client)h(updates)f
(\(to)g(the)h(serv)o(ers\).)f(The)g(reasons:)g(push)479
1496 y(sock)o(ets)i(will)g(block)e(if)h(there)g(is)h(no)f(recipient,)f
(and)h(the)o(y)f(round-robin,)d(so)21 b(we')l(d)e(need)h(to)g(open)f
(tw)o(o)i(of)f(them.)479 1604 y(W)-7 b(e')o(ll)22 b(bind)d(the)h(serv)o
(ers')f(SUB)j(sock)o(ets)e(and)g(connect)f(the)h(clients')g(PUB)h(sock)
o(ets)g(to)f(them.)f(This)i(tak)o(es)f(care)g(of)479
1712 y(f)o(anning)f(out)h(from)f(one)g(client)i(to)f(tw)o(o)h(serv)o
(ers.)-2 1730 y
SDict begin H.S end
 -2 1730 a -2 1730 a
SDict begin 13 H.A end
 -2 1730 a -2 1730
a
SDict begin [/View [/XYZ H.V]/Dest (0:3061) cvn /DEST pdfmark end
 -2 1730 a Black 396 1862 a Fe(\225)p Black 479 1862
a
SDict begin H.S end
 479 1862 a 479 1862 a
SDict begin 13 H.A end
 479 1862 a 479 1862 a
SDict begin [/View [/XYZ H.V]/Dest (0:3062) cvn /DEST pdfmark end
 479 1862
a Fj(W)-7 b(e)22 b(add)d(heartbeats)g(to)i(serv)o(er)e(updates)g(\(to)h
(clients\),)g(so)g(that)h(a)f(client)g(can)g(detect)g(when)g(the)g
(primary)e(serv)o(er)i(has)479 1970 y(died.)g(It)g(can)g(then)g(switch)
g(o)o(v)o(er)f(to)i(the)f(backup)e(serv)o(er)-5 b(.)-2
1988 y
SDict begin H.S end
 -2 1988 a -2 1988 a
SDict begin 13 H.A end
 -2 1988 a -2 1988 a
SDict begin [/View [/XYZ H.V]/Dest (0:3063) cvn /DEST pdfmark end
 -2 1988
a Black 396 2119 a Fe(\225)p Black 479 2119 a
SDict begin H.S end
 479 2119
a 479 2119 a
SDict begin 13 H.A end
 479 2119 a 479 2119 a
SDict begin [/View [/XYZ H.V]/Dest (0:3064) cvn /DEST pdfmark end
 479 2119 a Fj(W)e(e)22
b(connect)d(the)h(tw)o(o)g(serv)o(ers)g(using)g(the)g(Binary)f(Star)
2133 2119 y
SDict begin H.S end
 2133 2119 a 2133 2119 a
SDict begin 13 H.A end
 2133 2119 a 2133
2119 a
SDict begin [/View [/XYZ H.V]/Dest (0:3065) cvn /DEST pdfmark end
 2133 2119 a Fg(bstar)h Fj(reactor)f(class.)i(Binary)f(Star)g
(relies)h(on)f(the)g(clients)479 2227 y(to)h(')l(v)n(ote')e(by)h
(making)e(an)j(e)o(xplicit)e(request)h(to)g(the)g(serv)o(er)g(the)o(y)f
(consider)g("master".)h(W)-7 b(e')o(ll)21 b(use)f(snapshot)479
2335 y(requests)g(for)g(this.)-2 2353 y
SDict begin H.S end
 -2 2353 a -2
2353 a
SDict begin 13 H.A end
 -2 2353 a -2 2353 a
SDict begin [/View [/XYZ H.V]/Dest (0:3066) cvn /DEST pdfmark end
 -2 2353 a Black 396 2484 a
Fe(\225)p Black 479 2484 a
SDict begin H.S end
 479 2484 a 479 2484 a
SDict begin 13 H.A end
 479
2484 a 479 2484 a
SDict begin [/View [/XYZ H.V]/Dest (0:3067) cvn /DEST pdfmark end
 479 2484 a Fj(W)-7 b(e)22 b(mak)o(e)d(all)i(update)e
(messages)i(uniquely)d(identi\002able)h(by)h(adding)f(a)h(UUID)h
(\002eld.)f(The)g(client)g(generates)f(this,)479 2592
y(and)h(the)g(serv)o(er)f(propagates)f(it)j(back)f(on)g(re-published)d
(updates.)-2 2610 y
SDict begin H.S end
 -2 2610 a -2 2610 a
SDict begin 13 H.A end
 -2 2610 a -2
2610 a
SDict begin [/View [/XYZ H.V]/Dest (0:3068) cvn /DEST pdfmark end
 -2 2610 a Black 396 2742 a Fe(\225)p Black 479
2742 a
SDict begin H.S end
 479 2742 a 479 2742 a
SDict begin 13 H.A end
 479 2742 a 479 2742 a
SDict begin [/View [/XYZ H.V]/Dest (0:3069) cvn /DEST pdfmark end
 479
2742 a Fj(The)j(sla)n(v)o(e)g(serv)o(er)f(k)o(eeps)h(a)g("pending)e
(list")i(of)g(updates)f(that)h(it)h(has)f(recei)n(v)o(ed)e(from)h
(clients,)h(b)n(ut)g(not)f(yet)h(from)f(the)479 2850
y(master)h(serv)o(er)-5 b(.)20 b(Or)m(,)g(updates)f(it')-5
b(s)21 b(recei)n(v)o(ed)e(from)g(the)h(master)m(,)g(b)n(ut)g(not)g(yet)
g(clients.)g(The)g(list)i(is)f(ordered)d(from)479 2957
y(oldest)i(to)h(ne)n(west,)f(so)g(that)h(it)f(is)i(easy)e(to)g(remo)o
(v)o(e)e(updates)i(of)n(f)f(the)i(head.)-2 3142 y
SDict begin H.S end
 -2
3142 a -2 3142 a
SDict begin 13 H.A end
 -2 3142 a -2 3142 a
SDict begin [/View [/XYZ H.V]/Dest (0:3070) cvn /DEST pdfmark end
 -2 3142 a 396 3231
a Fj(It')-5 b(s)21 b(useful)f(to)g(design)g(the)g(client)g(logic)g(as)h
(a)f(\002nite)h(state)g(machine.)e(The)g(client)i(c)o(ycles)f(through)e
(three)h(states:)-2 3249 y
SDict begin H.S end
 -2 3249 a -2 3249 a
SDict begin 13 H.A end
 -2 3249
a -2 3249 a
SDict begin [/View [/XYZ H.V]/Dest (0:3071) cvn /DEST pdfmark end
 -2 3249 a -2 3259 a
SDict begin H.S end
 -2 3259 a -2 3259 a
SDict begin 13 H.A end
 -2
3259 a -2 3259 a
SDict begin [/View [/XYZ H.V]/Dest (0:3072) cvn /DEST pdfmark end
 -2 3259 a Black 396 3402 a Fe(\225)p
Black 479 3402 a
SDict begin H.S end
 479 3402 a 479 3402 a
SDict begin 13 H.A end
 479 3402 a 479
3402 a
SDict begin [/View [/XYZ H.V]/Dest (0:3073) cvn /DEST pdfmark end
 479 3402 a Fj(The)h(client)g(opens)g(and)f(connects)h(its)h
(sock)o(ets,)f(and)g(then)f(requests)h(a)h(snapshot)e(from)g(the)h
(\002rst)h(serv)o(er)-5 b(.)20 b(T)-7 b(o)20 b(a)n(v)n(oid)479
3510 y(request)g(storms,)g(it)h(will)g(ask)f(an)o(y)f(gi)n(v)o(en)g
(serv)o(er)h(only)f(twice.)h(One)g(request)g(might)f(get)i(lost,)f
(that')l(d)f(be)i(bad)e(luck.)479 3618 y(T)-7 b(w)o(o)21
b(getting)e(lost)i(w)o(ould)e(be)h(carelessness.)-2 3635
y
SDict begin H.S end
 -2 3635 a -2 3635 a
SDict begin 13 H.A end
 -2 3635 a -2 3635 a
SDict begin [/View [/XYZ H.V]/Dest (0:3074) cvn /DEST pdfmark end
 -2 3635 a Black
396 3767 a Fe(\225)p Black 479 3767 a
SDict begin H.S end
 479 3767 a 479
3767 a
SDict begin 13 H.A end
 479 3767 a 479 3767 a
SDict begin [/View [/XYZ H.V]/Dest (0:3075) cvn /DEST pdfmark end
 479 3767 a Fj(The)g(client)g(w)o(aits)i
(for)d(a)i(reply)e(\(snapshot)g(data\))h(from)f(the)h(current)f(serv)o
(er)m(,)g(and)g(if)i(it)g(gets)f(it,)h(it)g(stores)f(it.)h(If)f(there)
479 3875 y(is)h(no)f(reply)g(within)g(some)g(timeout,)f(it)i(f)o(ails)g
(o)o(v)o(er)d(to)j(the)f(ne)o(xt)f(serv)o(er)-5 b(.)-2
3893 y
SDict begin H.S end
 -2 3893 a -2 3893 a
SDict begin 13 H.A end
 -2 3893 a -2 3893 a
SDict begin [/View [/XYZ H.V]/Dest (0:3076) cvn /DEST pdfmark end
 -2 3893
a Black 396 4024 a Fe(\225)p Black 479 4024 a
SDict begin H.S end
 479 4024
a 479 4024 a
SDict begin 13 H.A end
 479 4024 a 479 4024 a
SDict begin [/View [/XYZ H.V]/Dest (0:3077) cvn /DEST pdfmark end
 479 4024 a Fj(When)20
b(the)h(client)f(has)g(gotten)f(its)j(snapshot,)d(it)i(w)o(aits)g(for)e
(and)h(processes)g(updates.)f(Again,)g(if)i(it)f(doesn')o(t)f(hear)479
4132 y(an)o(ything)f(from)i(the)g(serv)o(er)f(within)h(some)g(timeout,)
f(it)i(f)o(ails)g(o)o(v)o(er)e(to)h(the)g(ne)o(xt)g(serv)o(er)-5
b(.)-2 4316 y
SDict begin H.S end
 -2 4316 a -2 4316 a
SDict begin 13 H.A end
 -2 4316 a -2 4316 a
SDict begin [/View [/XYZ H.V]/Dest (0:3078) cvn /DEST pdfmark end

-2 4316 a 396 4406 a Fj(The)19 b(client)h(loops)f(fore)n(v)o(er)-5
b(.)17 b(It')-5 b(s)21 b(quite)e(lik)o(ely)g(during)f(startup)h(or)g(f)
o(ail-o)o(v)o(er)f(that)h(some)g(clients)h(may)f(be)h(trying)e(to)i
(talk)396 4514 y(to)h(the)f(primary)e(serv)o(er)i(while)g(others)g(are)
g(trying)f(to)h(talk)g(to)h(the)f(backup)f(serv)o(er)-5
b(.)19 b(The)h(Binary)g(Star)g(state)h(machine)396 4622
y(handles)f(this\()p 0 TeXcolorgray 819 4622 a
SDict begin H.S end
 819 4622
a Fj(Figure)f(5-6)1168 4622 y
SDict begin 13 H.L end
 1168 4622 a 1168 4622 a
SDict begin [/Subtype /Link/Dest (0:figure-67) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end

1168 4622 a Black -2 w Fj(\),)i(hopefully)d(accurately)-5
b(.)18 b(\(One)i(of)f(the)i(jo)o(ys)f(of)g(making)f(designs)h(lik)o(e)g
(this)h(is)g(we)f(cannot)396 4730 y(pro)o(v)o(e)e(the)o(y)h(are)g
(right,)g(we)g(can)h(only)e(pro)o(v)o(e)g(them)h(wrong.)f(So)i(it')-5
b(s)20 b(lik)o(e)g(a)g(guy)e(f)o(alling)h(of)n(f)g(a)h(tall)g(b)n
(uilding.)e(So)i(f)o(ar)m(,)e(so)396 4838 y(good...)g(so)j(f)o(ar)m(,)e
(so)i(good...\))-2 4856 y
SDict begin H.S end
 -2 4856 a -2 4856 a
SDict begin 13 H.A end
 -2 4856
a -2 4856 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-67) cvn /DEST pdfmark
end
 -2 4856 a Black 3759 5569 a Fi(245)p Black
eop end
%%Page: 246 260
TeXDict begin 246 259 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.246) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3099) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black 396 72 a
Fk(Figur)o(e)20 b(5-6.)f(Clone)h(Client)h(Finite)f(State)g(Machine)-2
172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:3082) cvn /DEST pdfmark end
 -2 172 a 396
3597 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3597 a @beginspecial 0 @llx -406 @lly 420
@urx 0 @ury 4200 @rwi @setspecial
%%BeginDocument: images/fig67.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -406 420 0
%%HiResBoundingBox: 0.0 -406.0 420.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.000301361083984 -38.000301361083984 moveto
38.000301361083984 -94.00029754638672 lineto
158.00030517578125 -94.00029754638672 lineto
158.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.000301361083984 -164.00030517578125 moveto
38.000301361083984 -234.00030517578125 lineto
158.00030517578125 -234.00030517578125 lineto
158.00030517578125 -164.00030517578125 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
38.000301361083984 -304.00030517578125 moveto
38.000301361083984 -374.00030517578125 lineto
158.00030517578125 -374.00030517578125 lineto
158.00030517578125 -304.00030517578125 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
35.0 -35.0 moveto
35.0 -91.0 lineto
155.0 -91.0 lineto
155.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
35.0 -35.0 moveto
35.0 -91.0 lineto
155.0 -91.0 lineto
155.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
35.0 -161.0 moveto
35.0 -231.0 lineto
155.0 -231.0 lineto
155.0 -161.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
35.0 -161.0 moveto
35.0 -231.0 lineto
155.0 -231.0 lineto
155.0 -161.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
35.0 -301.0 moveto
35.0 -371.0 lineto
155.0 -371.0 lineto
155.0 -301.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
35.0 -301.0 moveto
35.0 -371.0 lineto
155.0 -371.0 lineto
155.0 -301.0 lineto
closepath
stroke
newpath
165.0 -49.0 moveto
390.0 -49.0 lineto
393.3333333333333 -49.0 395.0 -51.333333333333336 395.0 -56.0 curveto
395.0 -350.0 lineto
395.0 -350.0 lineto
395.0 -354.6666666666667 393.3333333333333 -357.0 390.0 -357.0 curveto
240.0 -357.0 lineto
240.0 -357.0 lineto
stroke
newpath
165.0 -63.0 moveto
360.0 -63.0 lineto
363.3333333333333 -63.0 365.0 -65.33333333333333 365.0 -70.0 curveto
365.0 -210.0 lineto
365.0 -210.0 lineto
365.0 -214.66666666666666 363.3333333333333 -217.0 360.0 -217.0 curveto
240.0 -217.0 lineto
240.0 -217.0 lineto
stroke
newpath
135.0 -147.0 moveto
135.0 -126.0 lineto
135.0 -121.33333333333333 136.66666666666666 -119.0 140.0 -119.0 curveto
300.0 -119.0 lineto
300.0 -119.0 lineto
303.3333333333333 -119.0 305.0 -121.33333333333333 305.0 -126.0 curveto
305.0 -168.0 lineto
305.0 -168.0 lineto
305.0 -172.66666666666666 303.3333333333333 -175.0 300.0 -175.0 curveto
220.0 -175.0 lineto
220.0 -175.0 lineto
stroke
newpath
95.0 -252.0 moveto
95.0 -287.0 lineto
stroke
newpath
135.0 -287.0 moveto
135.0 -266.0 lineto
135.0 -261.3333333333333 136.66666666666666 -259.0 140.0 -259.0 curveto
300.0 -259.0 lineto
300.0 -259.0 lineto
303.3333333333333 -259.0 305.0 -261.3333333333333 305.0 -266.0 curveto
305.0 -308.0 lineto
305.0 -308.0 lineto
305.0 -312.6666666666667 303.3333333333333 -315.0 300.0 -315.0 curveto
220.0 -315.0 lineto
220.0 -315.0 lineto
stroke
newpath
95.0 -91.0 moveto
95.0 -147.0 lineto
stroke
newpath
155.0 -175.0 moveto
169.0 -175.0 lineto
stroke
newpath
155.0 -217.0 moveto
169.0 -217.0 lineto
stroke
newpath
155.0 -315.0 moveto
169.0 -315.0 lineto
stroke
newpath
155.0 -357.0 moveto
169.0 -357.0 lineto
stroke
newpath
170.0 -42.0 moveto
160.0 -49.0 lineto
170.0 -56.0 lineto
closepath
fill
newpath
170.0 -56.0 moveto
160.0 -63.0 lineto
170.0 -70.0 lineto
closepath
fill
newpath
90.0 -140.0 moveto
95.0 -154.0 lineto
100.0 -140.0 lineto
closepath
fill
newpath
130.0 -140.0 moveto
135.0 -154.0 lineto
140.0 -140.0 lineto
closepath
fill
newpath
90.0 -280.0 moveto
95.0 -294.0 lineto
100.0 -280.0 lineto
closepath
fill
newpath
130.0 -280.0 moveto
135.0 -294.0 lineto
140.0 -280.0 lineto
closepath
fill
/Helvetica findfont
15 scalefont setfont
73.0 -68.0 moveto
(Initial) show
27.0 -110.0 moveto
(Request snapshot) show
172.0 -180.0 moveto
(INPUT) show
170.0 -194.0 moveto
(Store snapshot) show
63.0 -194.0 moveto
(Syncing) show
170.0 -222.0 moveto
(SILENCE) show
170.0 -236.0 moveto
(Failover to next) show
62.0 -250.0 moveto
(KTHXBAI) show
172.0 -320.0 moveto
(INPUT) show
170.0 -334.0 moveto
(Store update) show
65.0 -334.0 moveto
(Active) show
170.0 -362.0 moveto
(SILENCE) show
170.0 -376.0 moveto
(Failover to next) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3597 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3597 a 274 x Fj(F)o(ail-o)o(v)o(er)f
(happens)f(as)j(follo)n(ws:)-2 3889 y
SDict begin H.S end
 -2 3889 a -2 3889
a
SDict begin 13 H.A end
 -2 3889 a -2 3889 a
SDict begin [/View [/XYZ H.V]/Dest (0:3086) cvn /DEST pdfmark end
 -2 3889 a -2 3899 a
SDict begin H.S end
 -2 3899 a -2
3899 a
SDict begin 13 H.A end
 -2 3899 a -2 3899 a
SDict begin [/View [/XYZ H.V]/Dest (0:3087) cvn /DEST pdfmark end
 -2 3899 a Black 396 4041 a
Fe(\225)p Black 479 4041 a
SDict begin H.S end
 479 4041 a 479 4041 a
SDict begin 13 H.A end
 479
4041 a 479 4041 a
SDict begin [/View [/XYZ H.V]/Dest (0:3088) cvn /DEST pdfmark end
 479 4041 a Fj(The)f(client)g(detects)h(that)f
(primary)f(serv)o(er)g(is)i(no)f(longer)f(sending)g(heartbeats,)g(so)h
(has)h(died.)e(The)h(client)g(connects)479 4149 y(to)h(the)f(backup)e
(serv)o(er)i(and)f(requests)h(a)h(ne)n(w)f(state)h(snapshot.)-2
4167 y
SDict begin H.S end
 -2 4167 a -2 4167 a
SDict begin 13 H.A end
 -2 4167 a -2 4167 a
SDict begin [/View [/XYZ H.V]/Dest (0:3089) cvn /DEST pdfmark end
 -2 4167
a Black 396 4299 a Fe(\225)p Black 479 4299 a
SDict begin H.S end
 479 4299
a 479 4299 a
SDict begin 13 H.A end
 479 4299 a 479 4299 a
SDict begin [/View [/XYZ H.V]/Dest (0:3090) cvn /DEST pdfmark end
 479 4299 a Fj(The)f(backup)f(serv)o
(er)g(starts)i(to)f(recei)n(v)o(e)f(snapshot)h(requests)g(from)f
(clients,)h(and)g(detects)g(that)g(primary)f(serv)o(er)g(has)479
4407 y(gone,)g(so)i(tak)o(es)f(o)o(v)o(er)f(as)i(primary)-5
b(.)-2 4425 y
SDict begin H.S end
 -2 4425 a -2 4425 a
SDict begin 13 H.A end
 -2 4425 a -2 4425 a
SDict begin [/View [/XYZ H.V]/Dest (0:3091) cvn /DEST pdfmark end

-2 4425 a Black 396 4556 a Fe(\225)p Black 479 4556 a
SDict begin H.S end

479 4556 a 479 4556 a
SDict begin 13 H.A end
 479 4556 a 479 4556 a
SDict begin [/View [/XYZ H.V]/Dest (0:3092) cvn /DEST pdfmark end
 479 4556
a Fj(The)20 b(backup)f(serv)o(er)g(applies)h(its)h(pending)d(list)k(to)
e(its)h(o)n(wn)f(hash)g(table,)g(and)f(then)h(starts)h(to)f(process)g
(state)479 4664 y(snapshot)g(requests.)-2 4848 y
SDict begin H.S end
 -2 4848
a -2 4848 a
SDict begin 13 H.A end
 -2 4848 a -2 4848 a
SDict begin [/View [/XYZ H.V]/Dest (0:3093) cvn /DEST pdfmark end
 -2 4848 a 396 4938 a
Fj(When)g(the)g(primary)f(serv)o(er)g(comes)h(back)g(on-line,)e(it)j
(will:)-2 4956 y
SDict begin H.S end
 -2 4956 a -2 4956 a
SDict begin 13 H.A end
 -2 4956 a -2 4956
a
SDict begin [/View [/XYZ H.V]/Dest (0:3094) cvn /DEST pdfmark end
 -2 4956 a -2 4966 a
SDict begin H.S end
 -2 4966 a -2 4966 a
SDict begin 13 H.A end
 -2 4966 a -2
4966 a
SDict begin [/View [/XYZ H.V]/Dest (0:3095) cvn /DEST pdfmark end
 -2 4966 a Black 396 5108 a Fe(\225)p Black 479
5108 a
SDict begin H.S end
 479 5108 a 479 5108 a
SDict begin 13 H.A end
 479 5108 a 479 5108 a
SDict begin [/View [/XYZ H.V]/Dest (0:3096) cvn /DEST pdfmark end
 479
5108 a Fj(Start)g(up)f(as)h(sla)n(v)o(e)f(serv)o(er)m(,)f(and)g
(connect)g(to)i(the)f(backup)e(serv)o(er)i(as)h(a)f(Clone)g(client.)-2
5126 y
SDict begin H.S end
 -2 5126 a -2 5126 a
SDict begin 13 H.A end
 -2 5126 a -2 5126 a
SDict begin [/View [/XYZ H.V]/Dest (0:3097) cvn /DEST pdfmark end
 -2 5126
a Black 3757 5569 a Fi(246)p Black eop end
%%Page: 247 261
TeXDict begin 247 260 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.247) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3098) cvn /DEST pdfmark end
 479 72 a
Fj(Start)21 b(to)f(recei)n(v)o(e)f(updates)h(from)f(clients,)h(via)g
(its)i(SUB)f(sock)o(et.)396 346 y(W)-7 b(e)22 b(mak)o(e)d(some)h
(assumptions:)-2 364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2
364 a
SDict begin [/View [/XYZ H.V]/Dest (0:3100) cvn /DEST pdfmark end
 -2 364 a -2 374 a
SDict begin H.S end
 -2 374 a -2 374 a
SDict begin 13 H.A end
 -2 374 a -2
374 a
SDict begin [/View [/XYZ H.V]/Dest (0:3101) cvn /DEST pdfmark end
 -2 374 a Black 396 517 a Fe(\225)p Black 479 517
a
SDict begin H.S end
 479 517 a 479 517 a
SDict begin 13 H.A end
 479 517 a 479 517 a
SDict begin [/View [/XYZ H.V]/Dest (0:3102) cvn /DEST pdfmark end
 479 517 a Fj(That)g(at)h
(least)g(one)e(serv)o(er)h(will)h(k)o(eep)e(running.)f(If)i(both)g
(serv)o(ers)f(crash,)h(we)g(lose)h(all)g(serv)o(er)e(state)i(and)f
(there')-5 b(s)20 b(no)479 625 y(w)o(ay)h(to)f(reco)o(v)o(er)e(it.)-2
643 y
SDict begin H.S end
 -2 643 a -2 643 a
SDict begin 13 H.A end
 -2 643 a -2 643 a
SDict begin [/View [/XYZ H.V]/Dest (0:3103) cvn /DEST pdfmark end
 -2 643 a Black
396 774 a Fe(\225)p Black 479 774 a
SDict begin H.S end
 479 774 a 479 774
a
SDict begin 13 H.A end
 479 774 a 479 774 a
SDict begin [/View [/XYZ H.V]/Dest (0:3104) cvn /DEST pdfmark end
 479 774 a Fj(That)i(multiple)g(clients)g(do)g
(not)g(update)f(the)h(same)h(hash)f(k)o(e)o(ys,)f(at)i(the)f(same)g
(time.)h(Client)f(updates)g(will)h(arri)n(v)o(e)e(at)479
882 y(the)h(tw)o(o)h(serv)o(ers)f(in)g(a)h(dif)n(ferent)d(order)-5
b(.)19 b(So,)h(the)h(backup)d(serv)o(er)h(may)h(apply)f(updates)h(from)
f(its)i(pending)d(list)k(in)e(a)479 990 y(dif)n(ferent)f(order)g(than)g
(the)i(primary)d(serv)o(er)i(w)o(ould)f(or)h(did.)g(Updates)f(from)h
(one)f(client)h(will)h(al)o(w)o(ays)g(arri)n(v)o(e)e(in)h(the)479
1098 y(same)h(order)e(on)g(both)h(serv)o(ers,)f(so)i(that)f(is)h(safe.)
-2 1276 y
SDict begin H.S end
 -2 1276 a -2 1276 a
SDict begin 13 H.A end
 -2 1276 a -2 1276 a
SDict begin [/View [/XYZ H.V]/Dest (0:3105) cvn /DEST pdfmark end
 -2
1276 a 396 1372 a Fj(So)g(the)f(architecture)f(for)g(our)g(high-a)n(v)n
(ailability)f(serv)o(er)i(pair)g(using)f(the)h(Binary)g(Star)h(pattern)
e(has)h(tw)o(o)h(serv)o(ers)e(and)396 1480 y(a)i(set)g(of)f(clients)g
(that)h(talk)f(to)g(both)g(serv)o(ers\()p 0 TeXcolorgray
1702 1480 a
SDict begin H.S end
 1702 1480 a Fj(Figure)e(5-7)2050 1480 y
SDict begin 13 H.L end
 2050
1480 a 2050 1480 a
SDict begin [/Subtype /Link/Dest (0:figure-68) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2050 1480 a Black -2 w Fj(\).)-2 1498
y
SDict begin H.S end
 -2 1498 a -2 1498 a
SDict begin 13 H.A end
 -2 1498 a -2 1498 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-68) cvn /DEST pdfmark
end
 -2 1498 a 396
1681 a Fk(Figur)o(e)i(5-7.)f(High-a)n(v)o(ailability)e(Clone)k(Ser)o(v)
o(er)f(P)o(air)-2 1781 y
SDict begin H.S end
 -2 1781 a -2 1781 a
SDict begin 13 H.A end
 -2 1781
a -2 1781 a
SDict begin [/View [/XYZ H.V]/Dest (0:3109) cvn /DEST pdfmark end
 -2 1781 a 396 3622 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3622 a @beginspecial
0 @llx -216 @lly 390 @urx 0 @ury 3900 @rwi @setspecial
%%BeginDocument: images/fig68.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -216 390 0
%%HiResBoundingBox: 0.0 -216.0 390.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -23.800180435180664 moveto
16.800180435180664 -59.80017852783203 lineto
142.80018615722656 -59.80017852783203 lineto
142.80018615722656 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -59.80017852783203 moveto
16.800180435180664 -73.80017852783203 lineto
16.800180435180664 -76.4668451944987 17.800180435180664 -77.80017852783203 19.800180435180664 -77.80017852783203 curveto
51.60017776489258 -77.80017852783203 lineto
50.80017852783203 -77.80017852783203 lineto
50.80017852783203 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
53.80017852783203 -59.80017852783203 moveto
53.80017852783203 -77.80017852783203 lineto
104.80017852783203 -77.80017852783203 lineto
104.80017852783203 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
107.80017852783203 -59.80017852783203 moveto
107.80017852783203 -77.80017852783203 lineto
139.80018615722656 -77.80017852783203 lineto
141.80018615722656 -77.80017852783203 142.80018615722656 -76.4668451944987 142.80018615722656 -73.80017852783203 curveto
142.80018615722656 -59.80017852783203 lineto
142.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.80018615722656 -24.800180435180664 moveto
250.80018615722656 -73.80017852783203 lineto
250.80018615722656 -76.4668451944987 251.80018615722656 -77.80017852783203 253.80018615722656 -77.80017852783203 curveto
373.8001708984375 -77.80017852783203 lineto
373.8001708984375 -77.80017852783203 lineto
375.8001708984375 -77.80017852783203 376.8001708984375 -76.4668451944987 376.8001708984375 -73.80017852783203 curveto
376.8001708984375 -25.000181198120117 lineto
376.8001708984375 -24.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.80018615722656 -24.800180435180664 moveto
250.80018615722656 -59.80017852783203 lineto
376.8001708984375 -59.80017852783203 lineto
376.8001708984375 -24.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
250.80018615722656 -59.80017852783203 moveto
250.80018615722656 -73.80017852783203 lineto
250.80018615722656 -76.4668451944987 251.80018615722656 -77.80017852783203 253.80018615722656 -77.80017852783203 curveto
285.60015869140625 -77.80017852783203 lineto
284.8001708984375 -77.80017852783203 lineto
284.8001708984375 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
287.8001708984375 -59.80017852783203 moveto
287.8001708984375 -77.80017852783203 lineto
338.8001708984375 -77.80017852783203 lineto
338.8001708984375 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
341.8001708984375 -59.80017852783203 moveto
341.8001708984375 -77.80017852783203 lineto
373.8001708984375 -77.80017852783203 lineto
375.8001708984375 -77.80017852783203 376.8001708984375 -76.4668451944987 376.8001708984375 -73.80017852783203 curveto
376.8001708984375 -59.80017852783203 lineto
376.8001708984375 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -140.80018615722656 moveto
17.800180435180664 -140.80018615722656 16.800180435180664 -142.46685282389322 16.800180435180664 -145.80018615722656 curveto
16.800180435180664 -158.80018615722656 lineto
50.80017852783203 -158.80018615722656 lineto
50.80017852783203 -140.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
53.80017852783203 -140.80018615722656 moveto
53.80017852783203 -158.80018615722656 lineto
104.80017852783203 -158.80018615722656 lineto
104.80017852783203 -140.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
107.80017852783203 -140.80018615722656 moveto
107.80017852783203 -158.80018615722656 lineto
142.80018615722656 -158.80018615722656 lineto
142.80018615722656 -145.80018615722656 lineto
142.80018615722656 -142.46685282389322 141.80018615722656 -140.80018615722656 139.80018615722656 -140.80018615722656 curveto
108.00017547607422 -140.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -158.80018615722656 moveto
16.800180435180664 -194.80018615722656 lineto
142.80018615722656 -194.80018615722656 lineto
142.80018615722656 -158.80018615722656 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -22.0 moveto
15.0 -58.0 lineto
141.0 -58.0 lineto
141.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
15.0 -22.0 moveto
15.0 -58.0 lineto
141.0 -58.0 lineto
141.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -58.0 moveto
15.0 -72.0 lineto
15.0 -74.66666666666667 16.0 -76.0 18.0 -76.0 curveto
49.79999923706055 -76.0 lineto
49.0 -76.0 lineto
49.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -58.0 moveto
15.0 -72.0 lineto
15.0 -74.66666666666667 16.0 -76.0 18.0 -76.0 curveto
49.79999923706055 -76.0 lineto
49.0 -76.0 lineto
49.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
52.0 -58.0 moveto
52.0 -76.0 lineto
103.0 -76.0 lineto
103.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
52.0 -58.0 moveto
52.0 -76.0 lineto
103.0 -76.0 lineto
103.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
106.0 -58.0 moveto
106.0 -76.0 lineto
138.0 -76.0 lineto
140.0 -76.0 141.0 -74.66666666666667 141.0 -72.0 curveto
141.0 -58.0 lineto
141.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
106.0 -58.0 moveto
106.0 -76.0 lineto
138.0 -76.0 lineto
140.0 -76.0 141.0 -74.66666666666667 141.0 -72.0 curveto
141.0 -58.0 lineto
141.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
249.0 -23.0 moveto
249.0 -72.0 lineto
249.0 -74.66666666666667 250.0 -76.0 252.0 -76.0 curveto
372.0 -76.0 lineto
372.0 -76.0 lineto
374.0 -76.0 375.0 -74.66666666666667 375.0 -72.0 curveto
375.0 -23.200000762939453 lineto
375.0 -23.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
249.0 -23.0 moveto
249.0 -72.0 lineto
249.0 -74.66666666666667 250.0 -76.0 252.0 -76.0 curveto
372.0 -76.0 lineto
372.0 -76.0 lineto
374.0 -76.0 375.0 -74.66666666666667 375.0 -72.0 curveto
375.0 -23.200000762939453 lineto
375.0 -23.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
249.0 -23.0 moveto
249.0 -58.0 lineto
375.0 -58.0 lineto
375.0 -23.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
249.0 -23.0 moveto
249.0 -58.0 lineto
375.0 -58.0 lineto
375.0 -23.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
249.0 -58.0 moveto
249.0 -72.0 lineto
249.0 -74.66666666666667 250.0 -76.0 252.0 -76.0 curveto
283.79998779296875 -76.0 lineto
283.0 -76.0 lineto
283.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
249.0 -58.0 moveto
249.0 -72.0 lineto
249.0 -74.66666666666667 250.0 -76.0 252.0 -76.0 curveto
283.79998779296875 -76.0 lineto
283.0 -76.0 lineto
283.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
286.0 -58.0 moveto
286.0 -76.0 lineto
337.0 -76.0 lineto
337.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
286.0 -58.0 moveto
286.0 -76.0 lineto
337.0 -76.0 lineto
337.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
340.0 -58.0 moveto
340.0 -76.0 lineto
372.0 -76.0 lineto
374.0 -76.0 375.0 -74.66666666666667 375.0 -72.0 curveto
375.0 -58.0 lineto
375.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
340.0 -58.0 moveto
340.0 -76.0 lineto
372.0 -76.0 lineto
374.0 -76.0 375.0 -74.66666666666667 375.0 -72.0 curveto
375.0 -58.0 lineto
375.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -139.0 moveto
16.0 -139.0 15.0 -140.66666666666666 15.0 -144.0 curveto
15.0 -157.0 lineto
49.0 -157.0 lineto
49.0 -139.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
18.0 -139.0 moveto
16.0 -139.0 15.0 -140.66666666666666 15.0 -144.0 curveto
15.0 -157.0 lineto
49.0 -157.0 lineto
49.0 -139.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
52.0 -139.0 moveto
52.0 -157.0 lineto
103.0 -157.0 lineto
103.0 -139.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
52.0 -139.0 moveto
52.0 -157.0 lineto
103.0 -157.0 lineto
103.0 -139.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
106.0 -139.0 moveto
106.0 -157.0 lineto
141.0 -157.0 lineto
141.0 -144.0 lineto
141.0 -140.66666666666666 140.0 -139.0 138.0 -139.0 curveto
106.19999694824219 -139.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
106.0 -139.0 moveto
106.0 -157.0 lineto
141.0 -157.0 lineto
141.0 -144.0 lineto
141.0 -140.66666666666666 140.0 -139.0 138.0 -139.0 curveto
106.19999694824219 -139.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -157.0 moveto
15.0 -193.0 lineto
141.0 -193.0 lineto
141.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -157.0 moveto
15.0 -193.0 lineto
141.0 -193.0 lineto
141.0 -157.0 lineto
closepath
stroke
newpath
147.0 -40.0 moveto
243.0 -40.0 lineto
stroke
newpath
33.0 -76.0 moveto
33.0 -130.0 lineto
stroke
newpath
81.0 -85.0 moveto
81.0 -139.0 lineto
stroke
newpath
150.0 -36.0 moveto
144.0 -40.0 lineto
150.0 -45.0 lineto
closepath
fill
newpath
240.0 -36.0 moveto
246.0 -40.0 lineto
240.0 -45.0 lineto
closepath
fill
newpath
81.0 -81.0 moveto
78.0 -90.0 lineto
84.0 -90.0 lineto
closepath
fill
newpath
123.0 -81.0 moveto
120.0 -90.0 lineto
126.0 -90.0 lineto
closepath
fill
newpath
357.0 -81.0 moveto
354.0 -90.0 lineto
360.0 -90.0 lineto
closepath
fill
newpath
30.0 -126.0 moveto
33.0 -135.0 lineto
36.0 -126.0 lineto
closepath
fill
newpath
123.0 -85.0 moveto
123.0 -112.0 lineto
stroke
newpath
357.0 -85.0 moveto
357.0 -108.0 lineto
357.0 -110.66666666666667 356.0 -112.0 354.0 -112.0 curveto
123.0 -112.0 lineto
123.0 -112.0 lineto
stroke
newpath
123.0 -139.0 moveto
123.0 -112.0 lineto
stroke
/Helvetica findfont
9 scalefont setfont
183.0 -35.0 moveto
(Binary) show
62.0 -44.0 moveto
(Primary) show
295.0 -44.0 moveto
(Backup) show
188.0 -53.0 moveto
(Star) show
25.0 -71.0 moveto
(PUB) show
62.0 -71.0 moveto
(ROUTER) show
115.0 -71.0 moveto
(SUB) show
259.0 -71.0 moveto
(PUB) show
296.0 -71.0 moveto
(ROUTER) show
349.0 -71.0 moveto
(SUB) show
25.0 -152.0 moveto
(SUB) show
61.0 -152.0 moveto
(DEALER) show
115.0 -152.0 moveto
(PUB) show
64.0 -179.0 moveto
(Client) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3622 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3622 a -2 3788 a
SDict begin H.S end
 -2 3788
a -2 3788 a
SDict begin 13 H.A end
 -2 3788 a -2 3788 a
SDict begin [/View [/XYZ H.V]/Dest (0:3112) cvn /DEST pdfmark end
 -2 3788 a 396 3896 a
Fj(As)h(a)g(\002rst)g(step)f(to)h(b)n(uilding)e(this,)h(we')l(re)g
(going)e(to)j(ref)o(actor)e(the)h(client)g(as)h(a)g(reusable)e(class.)i
(This)f(is)i(partly)d(for)h(fun)396 4004 y(\(writing)g(asynchronous)d
(classes)k(with)f(\330MQ)h(is)g(lik)o(e)g(an)f(e)o(x)o(ercise)f(in)h
(ele)o(gance\),)e(b)n(ut)i(mainly)g(because)f(we)i(w)o(ant)396
4112 y(Clone)f(to)h(be)f(really)g(easy)g(to)g(plug-in)f(to)h(random)f
(applications.)f(Since)j(resilience)e(depends)g(on)h(clients)h(beha)n
(ving)396 4220 y(correctly)-5 b(,)18 b(it')-5 b(s)22
b(much)d(easier)h(to)h(guarantee)d(this)j(when)e(there')-5
b(s)21 b(a)f(reusable)g(client)g(API.)g(When)g(we)h(start)f(to)h
(handle)396 4328 y(f)o(ail-o)o(v)o(er)e(in)h(clients,)g(it)h(does)f
(get)g(a)h(little)g(comple)o(x)d(\(imagine)h(mixing)g(a)i(Freelance)e
(client)i(with)f(a)h(Clone)f(client\).)396 4436 y(So,)g(reusability)g
(aho)o(y!)-2 4620 y
SDict begin H.S end
 -2 4620 a -2 4620 a
SDict begin 13 H.A end
 -2 4620 a -2
4620 a
SDict begin [/View [/XYZ H.V]/Dest (0:3113) cvn /DEST pdfmark end
 -2 4620 a 396 4710 a Fj(My)g(usual)f(design)f(approach)g(is)i
(to)g(\002rst)g(design)e(an)i(API)g(that)f(feels)h(right,)e(then)h(to)h
(implement)e(that.)h(So,)g(we)h(start)g(by)396 4818 y(taking)g(the)g
(clone)f(client,)h(and)g(re)n(writing)f(it)i(to)f(sit)h(on)f(top)g(of)g
(some)g(presumed)f(class)i(API)f(called)3304 4818 y
SDict begin H.S end
 3304
4818 a 3304 4818 a
SDict begin 13 H.A end
 3304 4818 a 3304 4818 a
SDict begin [/View [/XYZ H.V]/Dest (0:3114) cvn /DEST pdfmark end
 3304 4818
a Fk(clone)p Fj(.)g(T)l(urning)396 4926 y(random)f(code)g(into)h(an)g
(API)h(means)f(de\002ning)e(a)j(reasonably)e(stable)h(and)g(abstract)g
(contract)f(with)h(applications.)f(F)o(or)396 5034 y(e)o(xample,)g(in)h
(Model)g(Fi)n(v)o(e,)f(the)i(client)f(opened)e(three)i(separate)g(sock)
o(ets)g(to)h(the)f(serv)o(er)m(,)f(using)g(endpoints)g(that)h(were)396
5142 y(hard-coded)d(in)k(the)f(source.)f(W)-7 b(e)22
b(could)d(mak)o(e)h(an)g(API)g(with)h(three)e(methods,)g(lik)o(e)i
(this:)p Black 3756 5569 a Fi(247)p Black eop end
%%Page: 248 262
TeXDict begin 248 261 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.248) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3115) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fg(//)90 b(Specify)43
b(endpoints)h(for)g(each)g(socket)g(we)g(need)396 170
y(clone_subscribe)f(\(clone,)g("tcp://localhost:5556"\);)396
267 y(clone_snapshot)88 b(\(clone,)43 b("tcp://localhost:5557"\);)396
364 y(clone_updates)133 b(\(clone,)43 b("tcp://localhost:5558"\);)396
558 y(//)90 b(Times)44 b(two,)g(since)g(we)g(have)g(two)h(servers)396
655 y(clone_subscribe)e(\(clone,)g("tcp://localhost:5566"\);)396
752 y(clone_snapshot)88 b(\(clone,)43 b("tcp://localhost:5567"\);)396
850 y(clone_updates)133 b(\(clone,)43 b("tcp://localhost:5568"\);)-2
1027 y
SDict begin H.S end
 -2 1027 a -2 1027 a
SDict begin 13 H.A end
 -2 1027 a -2 1027 a
SDict begin [/View [/XYZ H.V]/Dest (0:3116) cvn /DEST pdfmark end
 -2 1027
a 396 1124 a Fj(But)21 b(this)g(is)g(both)e(v)o(erbose)g(and)h
(fragile.)f(It')-5 b(s)21 b(not)e(a)i(good)e(idea)h(to)g(e)o(xpose)f
(the)i(internals)e(of)h(a)h(design)e(to)396 1231 y(applications.)g(T)-7
b(oday)i(,)19 b(we)h(use)h(three)e(sock)o(ets.)h(T)-7
b(omorro)n(w)i(,)18 b(tw)o(o,)i(or)g(four)-5 b(.)19 b(Do)h(we)h(really)
f(w)o(ant)g(to)g(go)g(and)g(change)396 1339 y(e)n(v)o(ery)f
(application)g(that)h(uses)h(the)f(clone)g(class?)h(So)f(to)g(hide)g
(these)g(sausage)g(f)o(actory)f(details,)i(we)f(mak)o(e)g(a)h(small)396
1447 y(abstraction,)e(lik)o(e)i(this:)-2 1542 y
SDict begin H.S end
 -2 1542
a -2 1542 a
SDict begin 11.7 H.A end
 -2 1542 a -2 1542 a
SDict begin [/View [/XYZ H.V]/Dest (0:3117) cvn /DEST pdfmark end
 -2 1542 a 396 1627 a
Fg(//)90 b(Specify)43 b(primary)h(and)g(backup)g(servers)396
1725 y(clone_connect)f(\(clone,)h("tcp://localhost:5551"\);)396
1822 y(clone_connect)f(\(clone,)h("tcp://localhost:5561"\);)-2
1999 y
SDict begin H.S end
 -2 1999 a -2 1999 a
SDict begin 13 H.A end
 -2 1999 a -2 1999 a
SDict begin [/View [/XYZ H.V]/Dest (0:3118) cvn /DEST pdfmark end
 -2 1999
a 396 2096 a Fj(Which)20 b(has)h(the)f(adv)n(antage)e(of)i(simplicity)g
(\(one)f(serv)o(er)h(sits)h(at)g(one)f(endpoint\))d(b)n(ut)k(has)f(an)g
(impact)g(on)g(our)f(internal)396 2204 y(design.)h(W)-7
b(e)21 b(no)n(w)f(need)f(to)h(someho)n(w)f(turn)h(that)g(single)g
(endpoint)e(into)i(three)g(endpoints.)f(One)h(w)o(ay)g(w)o(ould)f(be)h
(to)396 2312 y(bak)o(e)g(the)g(kno)n(wledge)e("client)i(and)g(serv)o
(er)f(talk)h(o)o(v)o(er)f(three)h(consecuti)n(v)o(e)e(ports")i(into)g
(our)f(client-serv)o(er)g(protocol.)396 2420 y(Another)g(w)o(ay)h(w)o
(ould)g(be)g(to)g(get)g(the)h(tw)o(o)f(missing)g(endpoints)f(from)g
(the)h(serv)o(er)-5 b(.)20 b(W)-7 b(e')o(ll)21 b(tak)o(e)f(the)h
(simplest)f(w)o(ay)-5 b(,)396 2527 y(which)20 b(is:)-2
2528 y
SDict begin H.S end
 -2 2528 a -2 2528 a
SDict begin 13 H.A end
 -2 2528 a -2 2528 a
SDict begin [/View [/XYZ H.V]/Dest (0:3119) cvn /DEST pdfmark end
 -2 2528
a -2 2538 a
SDict begin H.S end
 -2 2538 a -2 2538 a
SDict begin 13 H.A end
 -2 2538 a -2 2538 a
SDict begin [/View [/XYZ H.V]/Dest (0:3120) cvn /DEST pdfmark end
 -2
2538 a Black 396 2698 a Fe(\225)p Black 479 2698 a
SDict begin H.S end
 479
2698 a 479 2698 a
SDict begin 13 H.A end
 479 2698 a 479 2698 a
SDict begin [/View [/XYZ H.V]/Dest (0:3121) cvn /DEST pdfmark end
 479 2698 a Fj(The)g(serv)o(er)f
(state)i(router)e(\(R)m(OUTER\))h(is)h(at)g(port)f(P)-9
b(.)-2 2716 y
SDict begin H.S end
 -2 2716 a -2 2716 a
SDict begin 13 H.A end
 -2 2716 a -2 2716 a
SDict begin [/View [/XYZ H.V]/Dest (0:3122) cvn /DEST pdfmark end

-2 2716 a Black 396 2847 a Fe(\225)p Black 479 2847 a
SDict begin H.S end

479 2847 a 479 2847 a
SDict begin 13 H.A end
 479 2847 a 479 2847 a
SDict begin [/View [/XYZ H.V]/Dest (0:3123) cvn /DEST pdfmark end
 479 2847
a Fj(The)20 b(serv)o(er)f(updates)h(publisher)f(\(PUB\))h(is)h(at)g
(port)e(P)i(+)g(1.)-2 2865 y
SDict begin H.S end
 -2 2865 a -2 2865 a
SDict begin 13 H.A end
 -2 2865
a -2 2865 a
SDict begin [/View [/XYZ H.V]/Dest (0:3124) cvn /DEST pdfmark end
 -2 2865 a Black 396 2997 a Fe(\225)p Black
479 2997 a
SDict begin H.S end
 479 2997 a 479 2997 a
SDict begin 13 H.A end
 479 2997 a 479 2997
a
SDict begin [/View [/XYZ H.V]/Dest (0:3125) cvn /DEST pdfmark end
 479 2997 a Fj(The)f(serv)o(er)f(updates)h(subscriber)f(\(SUB\))h(is)h
(at)g(port)f(P)h(+)f(2.)-2 3181 y
SDict begin H.S end
 -2 3181 a -2 3181 a
SDict begin 13 H.A end

-2 3181 a -2 3181 a
SDict begin [/View [/XYZ H.V]/Dest (0:3126) cvn /DEST pdfmark end
 -2 3181 a 396 3270 a Fj(The)g(clone)g(class)h(has)f
(the)g(same)h(structure)e(as)i(the)f(\003cliapi)h(class)g(from)e
(Reliable)h(Request-Reply)396 3378 y(P)o(atterns)p 0
TeXcolorgray 663 3378 a
SDict begin H.S end
 663 3378 a Fj(Chapter)f(4)988
3378 y
SDict begin 13 H.L end
 988 3378 a 988 3378 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 988 3378 a Black Fj(.)h(It)h(consists)f
(of)g(tw)o(o)h(parts:)-2 3396 y
SDict begin H.S end
 -2 3396 a -2 3396 a
SDict begin 13 H.A end
 -2
3396 a -2 3396 a
SDict begin [/View [/XYZ H.V]/Dest (0:3128) cvn /DEST pdfmark end
 -2 3396 a -2 3406 a
SDict begin H.S end
 -2 3406 a -2 3406
a
SDict begin 13 H.A end
 -2 3406 a -2 3406 a
SDict begin [/View [/XYZ H.V]/Dest (0:3129) cvn /DEST pdfmark end
 -2 3406 a Black 396 3549 a Fe(\225)p
Black 479 3549 a
SDict begin H.S end
 479 3549 a 479 3549 a
SDict begin 13 H.A end
 479 3549 a 479
3549 a
SDict begin [/View [/XYZ H.V]/Dest (0:3130) cvn /DEST pdfmark end
 479 3549 a Fj(An)f(asynchronous)e(clone)h(agent)h(that)g(runs)g
(in)g(a)h(background)c(thread.)i(The)g(agent)h(handles)f(all)i(netw)o
(ork)e(I/O,)479 3657 y(talking)h(to)g(serv)o(ers)g(in)g(real-time,)f
(no)h(matter)g(what)g(the)g(application)f(is)i(doing.)-2
3675 y
SDict begin H.S end
 -2 3675 a -2 3675 a
SDict begin 13 H.A end
 -2 3675 a -2 3675 a
SDict begin [/View [/XYZ H.V]/Dest (0:3131) cvn /DEST pdfmark end
 -2 3675
a Black 396 3806 a Fe(\225)p Black 479 3806 a
SDict begin H.S end
 479 3806
a 479 3806 a
SDict begin 13 H.A end
 479 3806 a 479 3806 a
SDict begin [/View [/XYZ H.V]/Dest (0:3132) cvn /DEST pdfmark end
 479 3806 a Fj(A)g(synchronous)c
('clone')i(class)i(which)f(runs)g(in)g(the)g(caller')-5
b(s)21 b(thread.)e(When)h(you)f(create)h(a)h(clone)e(object,)h(that)479
3914 y(automatically)f(launches)g(an)h(agent)g(thread,)f(and)h(when)f
(you)g(destro)o(y)h(a)g(clone)g(object,)f(it)i(kills)g(the)f(agent)g
(thread.)-2 4098 y
SDict begin H.S end
 -2 4098 a -2 4098 a
SDict begin 13 H.A end
 -2 4098 a -2 4098
a
SDict begin [/View [/XYZ H.V]/Dest (0:3133) cvn /DEST pdfmark end
 -2 4098 a 396 4188 a Fj(The)g(frontend)e(class)j(talks)g(to)f(the)g
(agent)g(class)h(o)o(v)o(er)e(an)2063 4188 y
SDict begin H.S end
 2063 4188
a 2063 4188 a
SDict begin 13 H.A end
 2063 4188 a 2063 4188 a
SDict begin [/View [/XYZ H.V]/Dest (0:3134) cvn /DEST pdfmark end
 2063 4188 a Fg(inproc)h
Fj('pipe')f(sock)o(et.)h(In)g(C,)g(the)h(CZMQ)f(thread)f(layer)396
4296 y(creates)h(this)h(pipe)f(automatically)f(for)g(us)i(as)g(it)g
(starts)g(an)f("attached)f(thread".)g(This)h(is)h(a)g(natural)e
(pattern)h(for)396 4404 y(multithreading)e(o)o(v)o(er)h(\330MQ.)-2
4588 y
SDict begin H.S end
 -2 4588 a -2 4588 a
SDict begin 13 H.A end
 -2 4588 a -2 4588 a
SDict begin [/View [/XYZ H.V]/Dest (0:3135) cvn /DEST pdfmark end
 -2 4588
a 396 4678 a Fj(W)m(ithout)h(\330MQ,)g(this)h(kind)e(of)h(asynchronous)
d(class)k(design)f(w)o(ould)f(be)i(weeks)f(of)g(really)g(hard)f(w)o
(ork.)g(W)m(ith)i(\330MQ,)396 4786 y(it)g(w)o(as)g(a)g(day)e(or)h(tw)o
(o)h(of)f(w)o(ork.)f(The)h(results)g(are)h(kind)e(of)h(comple)o(x,)e
(gi)n(v)o(en)h(the)h(simplicity)g(of)g(the)g(Clone)g(protocol)396
4894 y(it')-5 b(s)22 b(actually)d(running.)f(There)h(are)h(some)g
(reasons)g(for)g(this.)g(W)-7 b(e)22 b(could)d(turn)g(this)i(into)f(a)h
(reactor)m(,)d(b)n(ut)i(that')l(d)g(mak)o(e)f(it)396
5001 y(harder)g(to)h(use)h(in)f(applications.)f(So)h(the)h(API)f(looks)
g(a)g(bit)h(lik)o(e)f(a)h(k)o(e)o(y-v)n(alue)d(table)i(that)g
(magically)f(talks)i(to)f(some)396 5109 y(serv)o(ers:)p
Black 3759 5569 a Fi(248)p Black eop end
%%Page: 249 263
TeXDict begin 249 262 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.249) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3136) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fg(clone_t)755 85 y(*)800
72 y(clone_new)43 b(\(void\);)396 170 y(void)h(clone_destroy)f
(\(clone_t)1652 183 y(**)1742 170 y(self_p\);)396 267
y(void)h(clone_connect)f(\(clone_t)1652 280 y(*)1697
267 y(self,)g(char)2190 280 y(*)2235 267 y(address,)g(char)2862
280 y(*)2907 267 y(service\);)396 364 y(void)h(clone_set)g(\(clone_t)
1472 377 y(*)1517 364 y(self,)g(char)2010 377 y(*)2055
364 y(key,)g(char)2503 377 y(*)2548 364 y(value\);)396
461 y(char)620 474 y(*)665 461 y(clone_get)g(\(clone_t)1517
474 y(*)1562 461 y(self,)g(char)2055 474 y(*)2100 461
y(key\);)-2 639 y
SDict begin H.S end
 -2 639 a -2 639 a
SDict begin 13 H.A end
 -2 639 a -2 639 a
SDict begin [/View [/XYZ H.V]/Dest (0:3137) cvn /DEST pdfmark end

-2 639 a 396 735 a Fj(So)21 b(here)e(is)i(Model)f(Six)g(of)g(the)h
(clone)e(client,)h(which)g(has)g(no)n(w)g(become)f(just)i(a)f(thin)g
(shell)h(using)e(the)i(clone)e(class:)-2 753 y
SDict begin H.S end
 -2 753
a -2 753 a
SDict begin 13 H.A end
 -2 753 a -2 753 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonecli6-php) cvn /DEST pdfmark
end
 -2 753 a 396 936 a Fk(Example)i(5-13.)d
(Clone)j(client,)f(Model)h(Six)f(\(clonecli6.php\))-2
1036 y
SDict begin H.S end
 -2 1036 a -2 1036 a
SDict begin 11.7 H.A end
 -2 1036 a -2 1036 a
SDict begin [/View [/XYZ H.V]/Dest (0:3140) cvn /DEST pdfmark end
 -2 1036
a 396 1116 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 1294 y
SDict begin H.S end
 -2 1294 a -2 1294 a
SDict begin 13 H.A end
 -2 1294 a
-2 1294 a
SDict begin [/View [/XYZ H.V]/Dest (0:3141) cvn /DEST pdfmark end
 -2 1294 a 396 1390 a Fj(And)20 b(here)g(is)h(the)f(actual)g
(clone)g(class)h(implementation:)-2 1408 y
SDict begin H.S end
 -2 1408 a
-2 1408 a
SDict begin 13 H.A end
 -2 1408 a -2 1408 a
SDict begin [/View [/XYZ H.V]/Dest (0:clone-php) cvn /DEST pdfmark
end
 -2 1408 a 396 1592 a Fk(Example)g(5-14.)d
(Clone)j(class)f(\(clone.php\))-2 1692 y
SDict begin H.S end
 -2 1692 a -2
1692 a
SDict begin 11.7 H.A end
 -2 1692 a -2 1692 a
SDict begin [/View [/XYZ H.V]/Dest (0:3144) cvn /DEST pdfmark end
 -2 1692 a 396 1772 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
1949 y
SDict begin H.S end
 -2 1949 a -2 1949 a
SDict begin 13 H.A end
 -2 1949 a -2 1949 a
SDict begin [/View [/XYZ H.V]/Dest (0:3145) cvn /DEST pdfmark end
 -2 1949
a 396 2046 a Fj(Finally)-5 b(,)20 b(here)f(is)i(the)g(sixth)f(and)g
(last)h(model)e(of)h(the)g(clone)g(serv)o(er:)-2 2064
y
SDict begin H.S end
 -2 2064 a -2 2064 a
SDict begin 13 H.A end
 -2 2064 a -2 2064 a
SDict begin [/View [/XYZ H.V]/Dest (0:clonesrv6-php) cvn /DEST pdfmark
end
 -2 2064 a 396
2247 a Fk(Example)h(5-15.)d(Clone)j(ser)o(v)o(er)-8 b(,)20
b(Model)h(Six)f(\(clonesr)o(v6.php\))-2 2347 y
SDict begin H.S end
 -2 2347
a -2 2347 a
SDict begin 11.7 H.A end
 -2 2347 a -2 2347 a
SDict begin [/View [/XYZ H.V]/Dest (0:3148) cvn /DEST pdfmark end
 -2 2347 a 396 2427 a
Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
2605 y
SDict begin H.S end
 -2 2605 a -2 2605 a
SDict begin 13 H.A end
 -2 2605 a -2 2605 a
SDict begin [/View [/XYZ H.V]/Dest (0:3149) cvn /DEST pdfmark end
 -2 2605
a 396 2701 a Fj(This)21 b(main)e(program)f(is)k(only)d(a)i(fe)n(w)f
(hundred)e(lines)i(of)g(code,)f(b)n(ut)h(it)h(took)f(some)g(time)g(to)g
(get)h(w)o(orking.)d(T)-7 b(o)20 b(be)396 2809 y(accurate,)f(b)n
(uilding)g(Model)h(Six)g(took)g(about)f(a)h(full)h(week)e(of)h("sweet)h
(god,)e(this)i(is)g(just)g(too)e(comple)o(x)g(for)g(the)396
2917 y(Guide")h(hacking.)e(W)-7 b(e')l(v)o(e)20 b(assembled)g(pretty)f
(much)g(e)n(v)o(erything)f(and)i(the)g(kitchen)f(sink)h(into)g(this)h
(small)396 3025 y(application.)e(W)-7 b(e)21 b(ha)n(v)o(e)f(f)o(ail-o)o
(v)o(er)m(,)d(ephemeral)i(v)n(alues,)g(subtrees,)h(and)g(so)g(on.)g
(What)g(surprised)f(me)i(w)o(as)g(that)f(the)396 3133
y(upfront)e(design)i(w)o(as)h(pretty)e(accurate.)g(But)i(the)f(details)
h(of)f(writing)f(and)h(deb)n(ugging)e(so)i(man)o(y)f(sock)o(et)h(\003o)
n(ws)h(is)396 3241 y(something)e(special.)h(Here')-5
b(s)20 b(ho)n(w)g(I)h(made)e(this)i(w)o(ork:)-2 3259
y
SDict begin H.S end
 -2 3259 a -2 3259 a
SDict begin 13 H.A end
 -2 3259 a -2 3259 a
SDict begin [/View [/XYZ H.V]/Dest (0:3150) cvn /DEST pdfmark end
 -2 3259 a -2
3269 a
SDict begin H.S end
 -2 3269 a -2 3269 a
SDict begin 13 H.A end
 -2 3269 a -2 3269 a
SDict begin [/View [/XYZ H.V]/Dest (0:3151) cvn /DEST pdfmark end
 -2 3269
a Black 396 3411 a Fe(\225)p Black 479 3411 a
SDict begin H.S end
 479 3411
a 479 3411 a
SDict begin 13 H.A end
 479 3411 a 479 3411 a
SDict begin [/View [/XYZ H.V]/Dest (0:3152) cvn /DEST pdfmark end
 479 3411 a Fj(By)g(using)f(reactors)
f(\(bstar)m(,)g(on)h(top)g(of)g(zloop\),)f(which)g(remo)o(v)o(e)f(a)j
(lot)f(of)g(grunt-w)o(ork)e(from)h(the)h(code,)f(and)h(lea)n(v)o(e)479
3519 y(what)g(remains)g(simpler)g(and)f(more)h(ob)o(vious.)e(The)i
(whole)g(serv)o(er)f(runs)h(as)h(one)e(thread,)g(so)i(there')-5
b(s)20 b(no)479 3627 y(inter)n(-thread)f(weirdness)g(going)g(on.)h
(Just)h(pass)f(a)h(structure)e(pointer)g(\(')-5 b(self)5
b('\))20 b(around)e(to)i(all)h(handlers,)e(which)g(can)479
3735 y(do)h(their)g(thing)f(happily)-5 b(.)19 b(One)h(nice)g(side-ef)n
(fect)f(of)h(using)f(reactors)h(is)h(that)f(code,)g(being)f(less)i
(tightly)f(inte)o(grated)479 3843 y(into)g(a)h(poll)f(loop,)f(is)i
(much)e(easier)i(to)f(reuse.)g(Lar)o(ge)f(chunks)f(of)i(Model)g(Six)g
(are)h(tak)o(en)e(from)g(Model)h(Fi)n(v)o(e.)-2 3861
y
SDict begin H.S end
 -2 3861 a -2 3861 a
SDict begin 13 H.A end
 -2 3861 a -2 3861 a
SDict begin [/View [/XYZ H.V]/Dest (0:3153) cvn /DEST pdfmark end
 -2 3861 a Black
396 3992 a Fe(\225)p Black 479 3992 a
SDict begin H.S end
 479 3992 a 479
3992 a
SDict begin 13 H.A end
 479 3992 a 479 3992 a
SDict begin [/View [/XYZ H.V]/Dest (0:3154) cvn /DEST pdfmark end
 479 3992 a Fj(By)h(b)n(uilding)e(it)i
(piece)f(by)f(piece,)h(and)g(getting)f(each)h(piece)g(w)o(orking)2534
3992 y
SDict begin H.S end
 2534 3992 a 2534 3992 a
SDict begin 13 H.A end
 2534 3992 a 2534 3992
a
SDict begin [/View [/XYZ H.V]/Dest (0:3155) cvn /DEST pdfmark end
 2534 3992 a Fk(pr)o(operly)f Fj(before)g(going)g(onto)g(the)h(ne)o
(xt)479 4100 y(one.)g(Since)g(there)g(are)g(four)f(or)h(\002)n(v)o(e)g
(main)f(sock)o(et)i(\003o)n(ws,)f(that)g(meant)g(quite)g(a)g(lot)h(of)f
(deb)n(ugging)d(and)j(testing.)g(I)479 4208 y(deb)n(ug)f(just)i(by)f
(printing)e(stuf)n(f)i(to)h(the)f(console)f(\(e.g.)h(dumping)e
(messages\).)h(There')-5 b(s)20 b(no)g(sense)g(in)h(actually)479
4316 y(opening)e(a)h(deb)n(ugger)e(for)i(this)g(kind)g(of)g(w)o(ork.)-2
4334 y
SDict begin H.S end
 -2 4334 a -2 4334 a
SDict begin 13 H.A end
 -2 4334 a -2 4334 a
SDict begin [/View [/XYZ H.V]/Dest (0:3156) cvn /DEST pdfmark end
 -2 4334
a Black 396 4466 a Fe(\225)p Black 479 4466 a
SDict begin H.S end
 479 4466
a 479 4466 a
SDict begin 13 H.A end
 479 4466 a 479 4466 a
SDict begin [/View [/XYZ H.V]/Dest (0:3157) cvn /DEST pdfmark end
 479 4466 a Fj(By)h(al)o(w)o(ays)g
(testing)f(under)f(V)-9 b(algrind,)18 b(so)j(that)f(I'm)f(sure)i(there)
e(are)h(no)g(memory)f(leaks.)h(In)g(C)h(this)f(is)i(a)e(major)479
4574 y(concern,)f(you)g(can')o(t)g(dele)o(gate)g(to)h(some)g(garbage)e
(collector)-5 b(.)20 b(Using)g(proper)e(and)i(consistent)g
(abstractions)f(lik)o(e)479 4681 y(kvmsg)g(and)h(CZMQ)h(helps)f
(enormously)-5 b(.)-2 4865 y
SDict begin H.S end
 -2 4865 a -2 4865 a
SDict begin 13 H.A end
 -2 4865
a -2 4865 a
SDict begin [/View [/XYZ H.V]/Dest (0:3158) cvn /DEST pdfmark end
 -2 4865 a 396 4955 a Fj(I'm)20 b(sure)g(the)g(code)g(still)
h(has)f(\003a)o(ws)h(which)f(kind)f(readers)h(will)h(spend)e(week)o
(ends)g(deb)n(ugging)f(and)i(\002xing)f(for)h(me.)396
5063 y(I'm)g(happ)o(y)f(enough)f(with)i(this)h(model)e(to)i(use)f(it)h
(as)g(the)f(basis)h(for)e(real)i(applications.)p Black
3759 5569 a Fi(249)p Black eop end
%%Page: 250 264
TeXDict begin 250 263 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.250) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3159) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(T)g(o)20 b(test)h(the)f(sixth)f
(model,)g(start)h(the)g(primary)e(serv)o(er)h(and)g(backup)f(serv)o(er)
m(,)h(and)g(a)h(set)h(of)e(clients,)h(in)g(an)o(y)f(order)-5
b(.)19 b(Then)396 180 y(kill)i(and)e(restart)i(one)e(of)h(the)g(serv)o
(ers,)g(randomly)-5 b(,)17 b(and)j(k)o(eep)f(doing)g(this.)i(If)f(the)g
(design)g(and)f(code)h(is)h(accurate,)396 288 y(clients)g(will)g
(continue)d(to)j(get)f(the)g(same)h(stream)f(of)g(updates)f(from)g
(whate)n(v)o(er)g(serv)o(er)g(is)i(currently)e(master)-5
b(.)-2 317 y
SDict begin H.S end
 -2 317 a -2 317 a
SDict begin 13 H.A end
 -2 317 a -2 317 a
SDict begin [/View [/XYZ H.V]/Dest (0:3160) cvn /DEST pdfmark end
 -2 317
a 396 627 a Fd(5.3.7.)36 b(Clone)e(Pr)n(otocol)f(Speci\002cation)2352
627 y
SDict begin H.S end
 2352 627 a 2352 627 a
SDict begin 18.72 H.A end
 2352 627 a 2352 627 a
SDict begin [/View [/XYZ H.V]/Dest (10.57.39.2) cvn /DEST pdfmark end
 2352
627 a -2 818 a
SDict begin H.S end
 -2 818 a -2 818 a
SDict begin 13 H.A end
 -2 818 a -2 818 a
SDict begin [/View [/XYZ H.V]/Dest (0:3162) cvn /DEST pdfmark end
 -2
818 a 396 901 a Fj(After)20 b(this)h(much)e(w)o(ork)h(to)g(b)n(uild)g
(reliable)g(pub-sub,)e(we)i(w)o(ant)g(some)g(guarantee)f(that)h(we)h
(can)f(safely)g(b)n(uild)396 1009 y(applications)f(to)i(e)o(xploit)e
(the)h(w)o(ork.)f(A)i(good)e(start)h(is)i(to)e(write-up)f(the)h
(protocol.)e(This)j(lets)g(us)f(mak)o(e)396 1117 y(implementations)f
(in)h(other)f(languages)g(and)h(lets)h(us)f(impro)o(v)o(e)e(the)i
(design)g(on)g(paper)m(,)e(rather)i(than)f(hands-deep)f(in)396
1225 y(code.)-2 1391 y
SDict begin H.S end
 -2 1391 a -2 1391 a
SDict begin 13 H.A end
 -2 1391 a
-2 1391 a
SDict begin [/View [/XYZ H.V]/Dest (0:3163) cvn /DEST pdfmark end
 -2 1391 a 396 1499 a Fj(Here,)i(then,)g(is)h(the)f(Clustered)
g(Hashmap)f(Protocol,)g(which)h("de\002nes)g(a)g(cluster)n(-wide)g(k)o
(e)o(y-v)n(alue)e(hashmap,)g(and)396 1606 y(mechanisms)h(for)h(sharing)
f(this)i(across)f(a)h(set)g(of)f(clients.)g(CHP)h(allo)n(ws)g(clients)f
(to)g(w)o(ork)g(with)g(subtrees)g(of)g(the)396 1714 y(hashmap,)f(to)h
(update)f(v)n(alues,)h(and)g(to)g(de\002ne)g(ephemeral)e(v)n(alues.")-2
1732 y
SDict begin H.S end
 -2 1732 a -2 1732 a
SDict begin 13 H.A end
 -2 1732 a -2 1732 a
SDict begin [/View [/XYZ H.V]/Dest (0:3164) cvn /DEST pdfmark end
 -2 1732
a -2 1742 a
SDict begin H.S end
 -2 1742 a -2 1742 a
SDict begin 13 H.A end
 -2 1742 a -2 1742 a
SDict begin [/View [/XYZ H.V]/Dest (0:3165) cvn /DEST pdfmark end
 -2
1742 a Black 396 1885 a Fe(\225)p Black 479 1885 a
SDict begin H.S end
 479
1885 a 479 1885 a
SDict begin 13 H.A end
 479 1885 a 479 1885 a
SDict begin [/View [/XYZ H.V]/Dest (0:3166) cvn /DEST pdfmark end
 479 1885 a Fj
(http://rfc.zeromq.or)o(g/spec:12)-2 2027 y
SDict begin H.S end
 -2 2027 a
-2 2027 a
SDict begin 13 H.A end
 -2 2027 a -2 2027 a
SDict begin [/View [/XYZ H.V]/Dest (0:3167) cvn /DEST pdfmark end
 -2 2027 a 359 x Fh(5.4.)39
b(The)g(Espresso)f(P)l(attern)1750 2386 y
SDict begin H.S end
 1750 2386 a
1750 2386 a
SDict begin 22.464 H.A end
 1750 2386 a 1750 2386 a
SDict begin [/View [/XYZ H.V]/Dest (10.58.1) cvn /DEST pdfmark end
 1750 2386 a -2 2582
a
SDict begin H.S end
 -2 2582 a -2 2582 a
SDict begin 13 H.A end
 -2 2582 a -2 2582 a
SDict begin [/View [/XYZ H.V]/Dest (0:3169) cvn /DEST pdfmark end
 -2 2582 a 396
2660 a Fj(here)20 b(is)h(a)g(fun)e(little)i(machine)e(that)h(e)o
(xploits)g(the)1850 2660 y
SDict begin H.S end
 1850 2660 a 1850 2660 a
SDict begin 13 H.A end
 1850
2660 a 1850 2660 a
SDict begin [/View [/XYZ H.V]/Dest (0:3170) cvn /DEST pdfmark end
 1850 2660 a Fg(zmq_proxy\(\))f Fj(method)g(to)h(sho)
n(w)g(you)f(what')-5 b(s)21 b(happening)c(on)j(a)396
2768 y(pub-sub)f(netw)o(ork.)f(It')-5 b(s)21 b(decepti)n(v)o(ely)d
(simple:)-2 2786 y
SDict begin H.S end
 -2 2786 a -2 2786 a
SDict begin 13 H.A end
 -2 2786 a -2 2786
a
SDict begin [/View [/XYZ H.V]/Dest (0:espresso-php) cvn /DEST pdfmark
end
 -2 2786 a 396 2969 a Fk(Example)j(5-16.)d(Espr)o(esso)j(Machine)g
(\(espr)o(esso.php\))-2 3069 y
SDict begin H.S end
 -2 3069 a -2 3069 a
SDict begin 11.7 H.A end
 -2
3069 a -2 3069 a
SDict begin [/View [/XYZ H.V]/Dest (0:3173) cvn /DEST pdfmark end
 -2 3069 a 396 3150 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 3244 y
SDict begin H.S end
 -2 3244
a -2 3244 a
SDict begin 13 H.A end
 -2 3244 a -2 3244 a
SDict begin [/View [/XYZ H.V]/Dest (0:3174) cvn /DEST pdfmark end
 -2 3244 a 366 x Fh(5.5.)39
b(Last)g(V)-9 b(alue)39 b(Cac)o(hing)1593 3610 y
SDict begin H.S end
 1593
3610 a 1593 3610 a
SDict begin 22.464 H.A end
 1593 3610 a 1593 3610 a
SDict begin [/View [/XYZ H.V]/Dest (10.59.1) cvn /DEST pdfmark end
 1593 3610
a -2 3808 a
SDict begin H.S end
 -2 3808 a -2 3808 a
SDict begin 13 H.A end
 -2 3808 a -2 3808 a
SDict begin [/View [/XYZ H.V]/Dest (0:3176) cvn /DEST pdfmark end
 -2
3808 a 396 3884 a Fj(If)20 b(you')l(v)o(e)e(used)i(commercial)f
(publish-subscribe)e(systems)k(you)e(may)h(be)g(used)g(to)g(some)g
(features)g(that)g(are)g(missing)396 3992 y(in)h(the)f(f)o(ast)h(and)e
(cheerful)g(\330MQ)h(pub-sub)f(model.)g(One)h(of)g(these)g(is)h("last)g
(v)n(alue)f(caching".)e(The)i(problem)f(this)396 4100
y(solv)o(es)h(is)h(ho)n(w)f(a)h(ne)n(w)f(subscriber)f(catches)h(up)g
(when)f(it)i(joins)f(the)g(netw)o(ork.)f(The)h(theory)f(is)i(that)f
(publishers)f(get)396 4208 y(noti\002ed)h(when)f(a)i(ne)n(w)f
(subscriber)f(joins)h(and)g(subscribes)f(to)i(some)f(speci\002c)g
(topics.)g(The)g(publisher)f(can)h(then)396 4315 y(re-broadcast)e(the)j
(last)g(message)f(for)f(those)h(topics.)-2 4499 y
SDict begin H.S end
 -2
4499 a -2 4499 a
SDict begin 13 H.A end
 -2 4499 a -2 4499 a
SDict begin [/View [/XYZ H.V]/Dest (0:3177) cvn /DEST pdfmark end
 -2 4499 a 396 4589
a Fj(First)h(I')o(ll)g(e)o(xplain)e(why)g(\330MQ)h(does)g(not)g(do)g
(this,)g(and)g(then)g(I')o(ll)g(sho)n(w)g(ho)n(w)g(to)g(do)g(it)h(an)o
(yho)n(w)-5 b(.)-2 4773 y
SDict begin H.S end
 -2 4773 a -2 4773 a
SDict begin 13 H.A end
 -2 4773
a -2 4773 a
SDict begin [/View [/XYZ H.V]/Dest (0:3178) cvn /DEST pdfmark end
 -2 4773 a 396 4863 a Fj(W)e(e)22 b(don')o(t)c(do)i(it)h
(because)e(in)i(lar)o(ge)e(pub-sub)f(systems)j(the)f(v)n(olumes)f(of)h
(data)g(mak)o(e)g(it)h(pretty)f(much)f(impossible.)g(T)-7
b(o)396 4971 y(mak)o(e)19 b(really)g(lar)o(ge-scale)f(pub-sub)f(netw)o
(orks)h(you)h(need)f(a)i(protocol)d(lik)o(e)j(PGM)f(that)h(e)o(xploits)
e(an)h(upscale)g(Ethernet)396 5079 y(switch')-5 b(s)21
b(ability)f(to)g(multicast)h(data)f(to)g(thousands)f(of)h(subscribers.)
f(T)m(rying)g(to)h(do)g(a)g(TCP)h(unicast)f(from)g(the)p
Black 3759 5569 a Fi(250)p Black eop end
%%Page: 251 265
TeXDict begin 251 264 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.251) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3197) cvn /DEST pdfmark end
 -2 -201 a 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e
(Publish-Subscribe)f(P)-7 b(atterns)p Black 396 72 a
Fj(publisher)19 b(to)h(each)g(of)g(thousands)f(of)h(subscribers)f(just)
i(doesn')o(t)e(scale.)h(Y)-9 b(ou)20 b(get)g(weird)g(spik)o(es,)g(unf)o
(air)f(distrib)n(ution)396 180 y(\(some)h(subscribers)f(getting)h(the)g
(message)g(before)f(others\),)g(netw)o(ork)g(congestion,)f(and)i
(general)f(unhappiness.)-2 364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2
364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:3179) cvn /DEST pdfmark end
 -2 364 a 396 454 a Fj(PGM)i(is)g(a)g(one-w)o(ay)d
(protocol:)h(the)h(publisher)f(sends)h(a)h(message)f(to)g(a)h
(multicast)f(address)g(at)g(the)h(switch,)f(which)396
562 y(then)g(rebroadcasts)f(that)h(to)g(all)h(interested)f
(subscribers.)f(The)g(publisher)g(ne)n(v)o(er)g(sees)i(when)f
(subscribers)f(join)h(or)396 670 y(lea)n(v)o(e:)g(this)h(all)g(happens)
e(in)h(the)g(switch,)h(which)e(we)i(don')o(t)d(really)i(w)o(ant)g(to)h
(start)f(reprogramming.)-2 854 y
SDict begin H.S end
 -2 854 a -2 854 a
SDict begin 13 H.A end
 -2
854 a -2 854 a
SDict begin [/View [/XYZ H.V]/Dest (0:3180) cvn /DEST pdfmark end
 -2 854 a 396 944 a Fj(OK,)h(b)n(ut)f(in)g(a)h(lo)n(wer)n
(-v)n(olume)d(netw)o(ork,)h(with)h(a)h(fe)n(w)f(dozen)f(subscribers,)g
(and)g(a)i(limited)f(number)e(of)i(topics,)g(ho)n(w)396
1052 y(do)g(we)h(mak)o(e)e(a)i(L)-8 b(VC)20 b(using)g(\330MQ?)g(The)g
(answer)g(is)h(to)g(create)f(a)g(proxy)f(that)h(sits)h(between)f(the)g
(publisher)f(and)396 1160 y(subscribers;)h(an)g(analog)f(for)g(the)i
(switch,)f(b)n(ut)g(one)g(we)g(can)g(program)e(ourselv)o(es.)-2
1344 y
SDict begin H.S end
 -2 1344 a -2 1344 a
SDict begin 13 H.A end
 -2 1344 a -2 1344 a
SDict begin [/View [/XYZ H.V]/Dest (0:3181) cvn /DEST pdfmark end
 -2 1344
a 396 1434 a Fj(I')o(ll)j(start)f(by)g(making)f(a)i(publisher)d(and)i
(subscriber)f(that)h(highlight)f(the)h(w)o(orst)g(case)h(scenario.)e
(This)i(publisher)d(is)396 1542 y(pathological.)g(It)j(starts)g(by)e
(immediately)g(sending)g(messages)i(to)f(each)g(of)g(a)g(thousand)f
(topics,)h(and)f(then)h(it)h(sends)396 1650 y(one)f(update)f(a)i
(second)e(to)h(a)h(random)d(topic.)i(A)h(subscriber)d(connects,)h(and)h
(subscribes)g(to)g(a)h(topic.)e(W)m(ithout)h(L)-8 b(VC,)20
b(a)396 1758 y(subscriber)f(w)o(ould)h(ha)n(v)o(e)f(to)i(w)o(ait)g(an)f
(a)n(v)o(erage)f(of)h(500)f(seconds)g(to)i(get)f(an)o(y)f(data.)h(T)-7
b(o)21 b(add)e(some)h(drama,)f(let')-5 b(s)396 1866 y(pretend)19
b(there')-5 b(s)20 b(an)g(escaped)g(con)m(vict)f(called)h(Roth)g
(threatening)e(to)i(rip)g(the)h(head)e(of)n(f)h(Roger)f(the)h(to)o(y)h
(b)n(unn)o(y)d(if)i(we)396 1974 y(can')o(t)f(\002x)i(that)f(8.3)g
(minutes')f(delay)-5 b(.)-2 2158 y
SDict begin H.S end
 -2 2158 a -2 2158
a
SDict begin 13 H.A end
 -2 2158 a -2 2158 a
SDict begin [/View [/XYZ H.V]/Dest (0:3182) cvn /DEST pdfmark end
 -2 2158 a 396 2248 a Fj(Here')g(s)21
b(the)f(publisher)f(code.)g(Note)h(that)g(it)h(has)g(the)f(command)e
(line)i(option)f(to)i(connect)e(to)h(some)g(address,)f(b)n(ut)396
2356 y(otherwise)h(binds)f(to)i(an)f(endpoint.)e(W)-7
b(e')o(ll)21 b(use)g(this)f(later)h(to)f(connect)f(to)h(our)g(last)h(v)
n(alue)e(cache:)-2 2374 y
SDict begin H.S end
 -2 2374 a -2 2374 a
SDict begin 13 H.A end
 -2 2374
a -2 2374 a
SDict begin [/View [/XYZ H.V]/Dest (0:pathopub-php) cvn /DEST pdfmark
end
 -2 2374 a 396 2557 a Fk(Example)i(5-17.)d(P)o(athologic)h
(Publisher)i(\(pathopub)m(.php\))-2 2657 y
SDict begin H.S end
 -2 2657 a
-2 2657 a
SDict begin 11.7 H.A end
 -2 2657 a -2 2657 a
SDict begin [/View [/XYZ H.V]/Dest (0:3185) cvn /DEST pdfmark end
 -2 2657 a 396 2737 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
2915 y
SDict begin H.S end
 -2 2915 a -2 2915 a
SDict begin 13 H.A end
 -2 2915 a -2 2915 a
SDict begin [/View [/XYZ H.V]/Dest (0:3186) cvn /DEST pdfmark end
 -2 2915
a 396 3011 a Fj(And)20 b(here')-5 b(s)20 b(the)g(subscriber:)-2
3012 y
SDict begin H.S end
 -2 3012 a -2 3012 a
SDict begin 13 H.A end
 -2 3012 a -2 3012 a
SDict begin [/View [/XYZ H.V]/Dest (0:pathosub-php) cvn /DEST pdfmark
end
 -2 3012
a 396 3212 a Fk(Example)h(5-18.)d(P)o(athologic)h(Subscriber)i
(\(pathosub)m(.php\))-2 3312 y
SDict begin H.S end
 -2 3312 a -2 3312 a
SDict begin 11.7 H.A end
 -2
3312 a -2 3312 a
SDict begin [/View [/XYZ H.V]/Dest (0:3189) cvn /DEST pdfmark end
 -2 3312 a 396 3393 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 3570 y
SDict begin H.S end
 -2 3570
a -2 3570 a
SDict begin 13 H.A end
 -2 3570 a -2 3570 a
SDict begin [/View [/XYZ H.V]/Dest (0:3190) cvn /DEST pdfmark end
 -2 3570 a 396 3667 a
Fj(T)m(ry)20 b(b)n(uilding)f(and)h(running)e(these:)i(\002rst)h(the)f
(subscriber)m(,)f(then)g(the)h(publisher)-5 b(.)19 b(Y)-9
b(ou')o(ll)20 b(see)h(the)f(subscriber)f(reports)396
3774 y(getting)h("Sa)n(v)o(e)g(Roger")f(as)i(you')l(d)e(e)o(xpect:)-2
3875 y
SDict begin H.S end
 -2 3875 a -2 3875 a
SDict begin 11.7 H.A end
 -2 3875 a -2 3875 a
SDict begin [/View [/XYZ H.V]/Dest (0:3191) cvn /DEST pdfmark end
 -2 3875
a 396 3955 a Fg(./pathosub)43 b(&)396 4052 y(./pathopub)-2
4229 y
SDict begin H.S end
 -2 4229 a -2 4229 a
SDict begin 13 H.A end
 -2 4229 a -2 4229 a
SDict begin [/View [/XYZ H.V]/Dest (0:3192) cvn /DEST pdfmark end
 -2 4229
a 396 4326 a Fj(It')-5 b(s)21 b(when)f(you)f(run)g(a)i(second)e
(subscriber)g(that)i(you)e(understand)f(Roger')-5 b(s)20
b(predicament.)e(Y)-9 b(ou)19 b(ha)n(v)o(e)h(to)g(lea)n(v)o(e)g(it)h
(an)396 4434 y(a)o(wful)f(long)f(time)i(before)d(it)j(reports)f
(getting)f(an)o(y)g(data.)h(So,)g(here')-5 b(s)20 b(our)g(last)h(v)n
(alue)e(cache.)h(As)h(I)f(promised,)f(it')-5 b(s)21 b(a)396
4542 y(proxy)e(that)h(binds)g(to)g(tw)o(o)g(sock)o(ets)h(and)e(then)h
(handles)g(messages)g(on)g(both)f(them:)-2 4560 y
SDict begin H.S end
 -2
4560 a -2 4560 a
SDict begin 13 H.A end
 -2 4560 a -2 4560 a
SDict begin [/View [/XYZ H.V]/Dest (0:lvcache-php) cvn /DEST pdfmark
end
 -2 4560 a 396 4743
a Fk(Example)i(5-19.)d(Last)j(V)-8 b(alue)21 b(Caching)f(Pr)o(oxy)e
(\(lvcache.php\))-2 4843 y
SDict begin H.S end
 -2 4843 a -2 4843 a
SDict begin 11.7 H.A end
 -2 4843
a -2 4843 a
SDict begin [/View [/XYZ H.V]/Dest (0:3195) cvn /DEST pdfmark end
 -2 4843 a 396 4923 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))p Black 3759 5569
a Fi(251)p Black eop end
%%Page: 252 266
TeXDict begin 252 265 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.252) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2255 -132 a Fi(Chapter)20 b(5.)g(Advanced)e(Publish-Subscribe)f
(P)-7 b(atterns)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3196) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(No)n(w)i(,)20 b(run)f(the)h(proxy)
-5 b(,)18 b(then)i(the)g(publisher:)396 253 y Fg(./lvcache)44
b(&)396 350 y(./pathopub)f(tcp://localhost:5557)-2 527
y
SDict begin H.S end
 -2 527 a -2 527 a
SDict begin 13 H.A end
 -2 527 a -2 527 a
SDict begin [/View [/XYZ H.V]/Dest (0:3198) cvn /DEST pdfmark end
 -2 527 a 396 624
a Fj(And)20 b(no)n(w)g(run)f(as)i(man)o(y)e(instances)h(of)g(the)g
(subscriber)f(as)i(you)e(w)o(ant)i(to)f(try)-5 b(,)19
b(each)h(time)h(connecting)d(to)i(the)g(proxy)396 732
y(on)g(port)g(5558:)-2 833 y
SDict begin H.S end
 -2 833 a -2 833 a
SDict begin 11.7 H.A end
 -2 833
a -2 833 a
SDict begin [/View [/XYZ H.V]/Dest (0:3199) cvn /DEST pdfmark end
 -2 833 a 396 912 a Fg(./pathosub)43 b(tcp://localhost:5558)
-2 1089 y
SDict begin H.S end
 -2 1089 a -2 1089 a
SDict begin 13 H.A end
 -2 1089 a -2 1089 a
SDict begin [/View [/XYZ H.V]/Dest (0:3200) cvn /DEST pdfmark end
 -2
1089 a 396 1186 a Fj(Each)20 b(subscriber)f(happily)g(reports)g("Sa)n
(v)o(e)h(Roger",)f(and)h(Roth)g(the)h(Escaped)e(Con)m(vict)g(slinks)i
(back)e(to)i(his)f(cell)h(for)396 1294 y(dinner)e(and)h(a)g(nice)g(cup)
g(of)g(hot)g(milk,)g(which)f(is)i(all)g(he)f(really)g(w)o(anted)g(an)o
(yho)n(w)e(and)i(could)f(someone)g(call)i(his)f(mum)396
1402 y(and)g(tell)h(her)f(his)g(clean)g(socks)g(are)g(almost)h(all)f
(up.)-2 1586 y
SDict begin H.S end
 -2 1586 a -2 1586 a
SDict begin 13 H.A end
 -2 1586 a -2 1586
a
SDict begin [/View [/XYZ H.V]/Dest (0:3201) cvn /DEST pdfmark end
 -2 1586 a 396 1676 a Fj(One)g(note:)g(the)g(XPUB)i(sock)o(et)e(by)f
(def)o(ault)h(does)g(not)g(report)f(duplicate)g(subscriptions,)f(which)
i(is)h(what)f(you)g(w)o(ant)396 1784 y(when)g(you')l(re)e(nai)n(v)o
(ely)h(connecting)f(an)i(XPUB)h(to)g(an)f(XSUB.)h(Our)f(e)o(xample)e
(sneakily)i(gets)g(around)f(this)h(by)g(using)396 1891
y(random)f(topics)h(so)g(the)h(chance)e(of)h(it)h(not)e(w)o(orking)g
(is)i(one)f(in)g(a)h(million.)e(In)h(a)h(real)f(L)-8
b(VC)20 b(proxy)f(you')o(ll)g(w)o(ant)h(to)h(use)396
1999 y(the)518 1999 y
SDict begin H.S end
 518 1999 a 518 1999 a
SDict begin 13 H.A end
 518 1999
a 518 1999 a
SDict begin [/View [/XYZ H.V]/Dest (0:3202) cvn /DEST pdfmark end
 518 1999 a Fg(ZMQ_XPUB_VERBOSE)e Fj(option)f(that)j(we)f
(implement)f(later)i(in)f(The)g(\330MQ)g(Community)p
0 TeXcolorgray 3145 1999 a
SDict begin H.S end
 3145 1999 a Fj(Chapter)e(7)3469
1999 y
SDict begin 13 H.L end
 3469 1999 a 3469 1999 a
SDict begin [/Subtype /Link/Dest (0:the-community) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3469 1999 a Black 20 w
Fj(as)j(an)396 2107 y(e)o(x)o(ercise.)p Black 3759 5569
a Fi(252)p Black eop end
%%Page: 253 267
TeXDict begin 253 266 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.253) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:the-human-scale) cvn /DEST pdfmark
end
 -2 -11 a 126 x Fl(Chapter)48 b(6.)f(The)h(Human)h(Scale)2324
115 y
SDict begin H.S end
 2324 115 a 2324 115 a
SDict begin 26.957 H.A end
 2324 115 a 2324 115 a
SDict begin [/View [/XYZ H.V]/Dest (11.0) cvn /DEST pdfmark end
 2324
115 a -2 371 a
SDict begin H.S end
 -2 371 a -2 371 a
SDict begin 13 H.A end
 -2 371 a -2 371 a
SDict begin [/View [/XYZ H.V]/Dest (0:3206) cvn /DEST pdfmark end
 -2
371 a 396 443 a Fj(If)20 b(you')l(v)o(e)e(survi)n(v)o(ed)h(the)h
(\002rst)h(\002)n(v)o(e)f(chapters,)f(congratulations.)e(It)k(w)o(as)g
(hard)e(for)h(for)f(me)h(too.)g(Happily)f(the)h(jok)o(es)396
551 y(and)g(the)g(code)g(mostly)f(write)i(themselv)o(es,)e(so)i(we')o
(ll)f(continue)f(with)h(our)g(journe)o(y)e(of)i(e)o(xploring)d(\330MQ.)
k(In)e(this)396 659 y(chapter)g(I'm)h(going)f(to)h(step)h(back)e(from)g
(the)i(nuts)f(and)f(bolts)i(of)f(\330MQ')-5 b(s)20 b(technical)g
(machinery)-5 b(,)17 b(and)j(look)f(more)h(at)396 767
y(ho)n(w)g(to)g(use)h(\330MQ)f(successfully)g(in)g(lar)o(ger)f
(projects.)-2 951 y
SDict begin H.S end
 -2 951 a -2 951 a
SDict begin 13 H.A end
 -2 951 a -2 951
a
SDict begin [/View [/XYZ H.V]/Dest (0:3207) cvn /DEST pdfmark end
 -2 951 a 396 1041 a Fj(W)-7 b(e')o(ll)22 b(co)o(v)o(er:)-2
1042 y
SDict begin H.S end
 -2 1042 a -2 1042 a
SDict begin 13 H.A end
 -2 1042 a -2 1042 a
SDict begin [/View [/XYZ H.V]/Dest (0:3208) cvn /DEST pdfmark end
 -2 1042
a -2 1052 a
SDict begin H.S end
 -2 1052 a -2 1052 a
SDict begin 13 H.A end
 -2 1052 a -2 1052 a
SDict begin [/View [/XYZ H.V]/Dest (0:3209) cvn /DEST pdfmark end
 -2
1052 a Black 396 1211 a Fe(\225)p Black 479 1211 a
SDict begin H.S end
 479
1211 a 479 1211 a
SDict begin 13 H.A end
 479 1211 a 479 1211 a
SDict begin [/View [/XYZ H.V]/Dest (0:3210) cvn /DEST pdfmark end
 479 1211 a Fj(What)f("softw)o
(are)f(architecture")e(is)j(really)f(about.)-2 1229 y
SDict begin H.S end

-2 1229 a -2 1229 a
SDict begin 13 H.A end
 -2 1229 a -2 1229 a
SDict begin [/View [/XYZ H.V]/Dest (0:3211) cvn /DEST pdfmark end
 -2 1229 a Black
396 1360 a Fe(\225)p Black 479 1360 a
SDict begin H.S end
 479 1360 a 479
1360 a
SDict begin 13 H.A end
 479 1360 a 479 1360 a
SDict begin [/View [/XYZ H.V]/Dest (0:3212) cvn /DEST pdfmark end
 479 1360 a Fj(The)g(Simplicity-Oriented)e
(Design)i(process)g(and)f(its)j(ugly)d(cousins)h(Cod)g(and)g(T)-7
b(od.)-2 1378 y
SDict begin H.S end
 -2 1378 a -2 1378 a
SDict begin 13 H.A end
 -2 1378 a -2 1378
a
SDict begin [/View [/XYZ H.V]/Dest (0:3213) cvn /DEST pdfmark end
 -2 1378 a Black 396 1510 a Fe(\225)p Black 479 1510
a
SDict begin H.S end
 479 1510 a 479 1510 a
SDict begin 13 H.A end
 479 1510 a 479 1510 a
SDict begin [/View [/XYZ H.V]/Dest (0:3214) cvn /DEST pdfmark end
 479 1510
a Fj(Ho)n(w)20 b(to)h(use)f(\330MQ)h(to)f(go)g(from)f(idea)h(to)g(w)o
(orking)f(prototype)f(safely)-5 b(.)-2 1528 y
SDict begin H.S end
 -2 1528
a -2 1528 a
SDict begin 13 H.A end
 -2 1528 a -2 1528 a
SDict begin [/View [/XYZ H.V]/Dest (0:3215) cvn /DEST pdfmark end
 -2 1528 a Black 396 1659
a Fe(\225)p Black 479 1659 a
SDict begin H.S end
 479 1659 a 479 1659 a
SDict begin 13 H.A end
 479
1659 a 479 1659 a
SDict begin [/View [/XYZ H.V]/Dest (0:3216) cvn /DEST pdfmark end
 479 1659 a Fj(Dif)n(ferent)19 b(w)o(ays)i(to)f
(serialize)g(your)f(data)h(as)h(\330MQ)g(messages.)-2
1677 y
SDict begin H.S end
 -2 1677 a -2 1677 a
SDict begin 13 H.A end
 -2 1677 a -2 1677 a
SDict begin [/View [/XYZ H.V]/Dest (0:3217) cvn /DEST pdfmark end
 -2 1677
a Black 396 1809 a Fe(\225)p Black 479 1809 a
SDict begin H.S end
 479 1809
a 479 1809 a
SDict begin 13 H.A end
 479 1809 a 479 1809 a
SDict begin [/View [/XYZ H.V]/Dest (0:3218) cvn /DEST pdfmark end
 479 1809 a Fj(Ho)n(w)f(to)h
(code-generate)c(binary)i(serialization)g(codecs.)-2
1826 y
SDict begin H.S end
 -2 1826 a -2 1826 a
SDict begin 13 H.A end
 -2 1826 a -2 1826 a
SDict begin [/View [/XYZ H.V]/Dest (0:3219) cvn /DEST pdfmark end
 -2 1826
a Black 396 1958 a Fe(\225)p Black 479 1958 a
SDict begin H.S end
 479 1958
a 479 1958 a
SDict begin 13 H.A end
 479 1958 a 479 1958 a
SDict begin [/View [/XYZ H.V]/Dest (0:3220) cvn /DEST pdfmark end
 479 1958 a Fj(Ho)n(w)h(to)h(b)n
(uild)e(custom)h(code)g(generators.)-2 1976 y
SDict begin H.S end
 -2 1976
a -2 1976 a
SDict begin 13 H.A end
 -2 1976 a -2 1976 a
SDict begin [/View [/XYZ H.V]/Dest (0:3221) cvn /DEST pdfmark end
 -2 1976 a Black 396 2107
a Fe(\225)p Black 479 2107 a
SDict begin H.S end
 479 2107 a 479 2107 a
SDict begin 13 H.A end
 479
2107 a 479 2107 a
SDict begin [/View [/XYZ H.V]/Dest (0:3222) cvn /DEST pdfmark end
 479 2107 a Fj(Ho)n(w)g(to)h(write)f(and)g(license)g
(an)g(protocol)f(speci\002cation.)-2 2125 y
SDict begin H.S end
 -2 2125 a
-2 2125 a
SDict begin 13 H.A end
 -2 2125 a -2 2125 a
SDict begin [/View [/XYZ H.V]/Dest (0:3223) cvn /DEST pdfmark end
 -2 2125 a Black 396 2257
a Fe(\225)p Black 479 2257 a
SDict begin H.S end
 479 2257 a 479 2257 a
SDict begin 13 H.A end
 479
2257 a 479 2257 a
SDict begin [/View [/XYZ H.V]/Dest (0:3224) cvn /DEST pdfmark end
 479 2257 a Fj(Ho)n(w)h(to)h(do)e(f)o(ast)i
(restartable)f(\002le)h(transfer)e(o)o(v)o(er)g(\330MQ.)-2
2272 y
SDict begin H.S end
 -2 2272 a -2 2272 a
SDict begin 13 H.A end
 -2 2272 a -2 2272 a
SDict begin [/View [/XYZ H.V]/Dest (0:3225) cvn /DEST pdfmark end
 -2 2272
a Black 396 2406 a Fe(\225)p Black 479 2406 a
SDict begin H.S end
 479 2406
a 479 2406 a
SDict begin 13 H.A end
 479 2406 a 479 2406 a
SDict begin [/View [/XYZ H.V]/Dest (0:3226) cvn /DEST pdfmark end
 479 2406 a Fj(Ho)n(w)h(to)h(do)e
(credit-based)g(\003o)n(w)h(control.)-2 2407 y
SDict begin H.S end
 -2 2407
a -2 2407 a
SDict begin 13 H.A end
 -2 2407 a -2 2407 a
SDict begin [/View [/XYZ H.V]/Dest (0:3227) cvn /DEST pdfmark end
 -2 2407 a Black 396 2556
a Fe(\225)p Black 479 2556 a
SDict begin H.S end
 479 2556 a 479 2556 a
SDict begin 13 H.A end
 479
2556 a 479 2556 a
SDict begin [/View [/XYZ H.V]/Dest (0:3228) cvn /DEST pdfmark end
 479 2556 a Fj(Ho)n(w)g(to)h(do)e(heartbeating)g(for)g
(dif)n(ferent)g(\330MQ)h(patterns.)-2 2574 y
SDict begin H.S end
 -2 2574
a -2 2574 a
SDict begin 13 H.A end
 -2 2574 a -2 2574 a
SDict begin [/View [/XYZ H.V]/Dest (0:3229) cvn /DEST pdfmark end
 -2 2574 a Black 396 2705
a Fe(\225)p Black 479 2705 a
SDict begin H.S end
 479 2705 a 479 2705 a
SDict begin 13 H.A end
 479
2705 a 479 2705 a
SDict begin [/View [/XYZ H.V]/Dest (0:3230) cvn /DEST pdfmark end
 479 2705 a Fj(Ho)n(w)g(to)h(b)n(uild)e(protocol)g
(serv)o(ers)h(and)f(clients)i(as)g(state)g(machines.)-2
2723 y
SDict begin H.S end
 -2 2723 a -2 2723 a
SDict begin 13 H.A end
 -2 2723 a -2 2723 a
SDict begin [/View [/XYZ H.V]/Dest (0:3231) cvn /DEST pdfmark end
 -2 2723
a Black 396 2855 a Fe(\225)p Black 479 2855 a
SDict begin H.S end
 479 2855
a 479 2855 a
SDict begin 13 H.A end
 479 2855 a 479 2855 a
SDict begin [/View [/XYZ H.V]/Dest (0:3232) cvn /DEST pdfmark end
 479 2855 a Fj(Ho)n(w)f(to)h(mak)o(e)
e(a)i(secure)f(protocol)e(o)o(v)o(er)h(\330MQ)i(\(yay!\).)-2
2873 y
SDict begin H.S end
 -2 2873 a -2 2873 a
SDict begin 13 H.A end
 -2 2873 a -2 2873 a
SDict begin [/View [/XYZ H.V]/Dest (0:3233) cvn /DEST pdfmark end
 -2 2873
a Black 396 3004 a Fe(\225)p Black 479 3004 a
SDict begin H.S end
 479 3004
a 479 3004 a
SDict begin 13 H.A end
 479 3004 a 479 3004 a
SDict begin [/View [/XYZ H.V]/Dest (0:3234) cvn /DEST pdfmark end
 479 3004 a Fj(A)g(lar)o(ge-scale)e
(\002le)i(publishing)d(system)i(\(FileMQ\).)-2 3022 y
SDict begin H.S end

-2 3022 a -2 3022 a
SDict begin 13 H.A end
 -2 3022 a -2 3022 a
SDict begin [/View [/XYZ H.V]/Dest (0:3235) cvn /DEST pdfmark end
 -2 3022 a 359
x Fh(6.1.)39 b(The)g(T)-11 b(ale)38 b(of)i(T)-9 b(w)m(o)39
b(Bridg)q(es)1915 3381 y
SDict begin H.S end
 1915 3381 a 1915 3381 a
SDict begin 22.464 H.A end
 1915
3381 a 1915 3381 a
SDict begin [/View [/XYZ H.V]/Dest (11.60.1) cvn /DEST pdfmark end
 1915 3381 a -2 3579 a
SDict begin H.S end
 -2 3579 a -2
3579 a
SDict begin 13 H.A end
 -2 3579 a -2 3579 a
SDict begin [/View [/XYZ H.V]/Dest (0:3237) cvn /DEST pdfmark end
 -2 3579 a 396 3655 a Fj(T)-7
b(w)o(o)21 b(old)f(engineers)e(were)j(talking)e(of)h(their)g(li)n(v)o
(es)g(and)g(boasting)f(of)h(their)g(greatest)g(projects.)f(One)h(of)g
(the)g(engineers)396 3763 y(e)o(xplained)f(ho)n(w)g(he)h(had)g
(designed)f(one)h(of)f(the)i(greatest)f(bridges)f(e)n(v)o(er)g(made.)-2
3947 y
SDict begin H.S end
 -2 3947 a -2 3947 a
SDict begin 13 H.A end
 -2 3947 a -2 3947 a
SDict begin [/View [/XYZ H.V]/Dest (0:3238) cvn /DEST pdfmark end
 -2 3947
a 396 4037 a Fj("W)-7 b(e)21 b(b)n(uilt)g(it)g(across)f(a)h(ri)n(v)o
(er)e(gor)o(ge,")f(he)i(told)g(his)g(friend.)f("It)i(w)o(as)g(wide)f
(and)f(deep.)h(W)-7 b(e)21 b(spent)f(tw)o(o)g(years)g(studying)396
4145 y(the)g(land,)f(and)g(choosing)f(designs)h(and)g(materials.)h(W)-7
b(e)20 b(hired)f(the)h(best)g(engineers)e(and)h(designed)g(the)g
(bridge,)f(which)396 4253 y(took)i(another)e(\002)n(v)o(e)i(years.)g(W)
-7 b(e)21 b(contracted)e(the)h(lar)o(gest)g(engineering)d(\002rms)k(to)
f(b)n(uild)g(the)g(structures,)f(the)i(to)n(wers,)396
4361 y(the)f(tollbooths,)f(and)g(the)h(roads)f(that)h(w)o(ould)f
(connect)g(the)h(bridge)f(to)h(the)f(main)h(highw)o(ays.)f(Dozens)g
(died)g(during)g(the)396 4469 y(construction.)f(Under)h(the)i(road)e
(le)n(v)o(el)h(we)g(had)g(trains,)g(and)g(a)g(special)h(path)e(for)h(c)
o(yclists.)g(That)g(bridge)f(represented)396 4577 y(years)h(of)g(my)g
(life.")-2 4761 y
SDict begin H.S end
 -2 4761 a -2 4761 a
SDict begin 13 H.A end
 -2 4761 a -2 4761
a
SDict begin [/View [/XYZ H.V]/Dest (0:3239) cvn /DEST pdfmark end
 -2 4761 a 396 4851 a Fj(The)g(second)f(man)g(re\003ected)h(for)f(a)i
(while,)e(then)h(spok)o(e.)f("One)h(e)n(v)o(ening)e(me)i(and)f(a)i
(friend)d(got)i(drunk)e(on)i(v)n(odka,)e(and)396 4959
y(we)j(thre)n(w)f(a)g(rope)f(across)i(a)f(gor)o(ge,")e(he)i(said.)h
("Just)f(a)h(rope,)e(tied)h(to)h(tw)o(o)f(trees.)g(There)g(were)g(tw)o
(o)g(villages,)g(one)g(at)396 5067 y(each)g(side.)g(At)h(\002rst,)g
(people)e(pulled)g(packages)g(across)h(that)h(rope)e(with)h(a)h(pulle)o
(y)e(and)h(string.)f(Then)h(someone)f(thre)n(w)p Black
3759 5569 a Fi(253)p Black eop end
%%Page: 254 268
TeXDict begin 254 267 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.254) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(a)i(second)e(rope,)g(and)h(b)n(uilt)g(a)h(foot)e(w)o
(alk.)h(It)h(w)o(as)g(dangerous,)d(b)n(ut)i(the)g(kids)g(lo)o(v)o(ed)f
(it.)i(A)f(group)f(of)h(men)f(then)h(reb)n(uilt)396 180
y(that,)g(made)g(it)h(solid,)f(and)f(w)o(omen)h(started)g(to)g(cross,)g
(e)n(v)o(eryday)-5 b(,)17 b(with)k(their)f(produce.)e(A)i(mark)o(et)g
(gre)n(w)f(up)h(on)g(one)396 288 y(side)h(of)f(the)g(bridge,)f(and)g
(slo)n(wly)h(that)h(became)e(a)h(lar)o(ge)g(to)n(wn,)f(since)i(there)e
(w)o(as)i(a)g(lot)f(of)g(space)g(for)g(houses.)f(The)396
396 y(rope)h(bridge)e(got)i(replaced)f(with)i(a)f(w)o(ooden)f(bridge,)g
(to)h(allo)n(w)g(horses)g(and)g(carts)g(to)g(cross.)h(Then)e(the)h(to)n
(wn)g(b)n(uilt)g(a)396 504 y(real)g(stone)g(bridge,)f(with)h(metal)h
(beams.)e(Later)m(,)h(the)o(y)f(replaced)g(the)h(stone)g(part)g(with)h
(steel,)f(and)g(today)f(there')-5 b(s)20 b(a)396 612
y(suspension)f(bridge)g(standing)g(in)i(that)f(same)g(spot.")-2
796 y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:3240) cvn /DEST pdfmark end
 -2 796 a 396
886 a Fj(The)g(\002rst)h(engineer)e(w)o(as)i(silent.)f("Funn)o(y)f
(thing,")g(he)h(said,)g("my)g(bridge)f(w)o(as)i(demolished)d(about)i
(ten)g(years)g(after)396 994 y(we)h(b)n(uilt)f(it.)h(T)l(urns)f(out)f
(it)i(w)o(as)g(b)n(uilt)g(in)f(the)g(wrong)f(place)h(and)g(no-one)e(w)o
(anted)i(to)g(use)g(it.)h(Some)f(guys)g(had)f(thro)n(wn)396
1102 y(a)i(rope)e(across)h(the)h(gor)o(ge,)d(a)i(fe)n(w)g(miles)h
(further)e(do)n(wnstream,)f(and)i(that')-5 b(s)20 b(where)g(e)n(v)o
(eryone)e(went.")-2 1130 y
SDict begin H.S end
 -2 1130 a -2 1130 a
SDict begin 13 H.A end
 -2 1130
a -2 1130 a
SDict begin [/View [/XYZ H.V]/Dest (0:3241) cvn /DEST pdfmark end
 -2 1130 a 359 x Fh(6.2.)39 b(Code)f(on)i(the)f(Human)f
(Scale)2048 1489 y
SDict begin H.S end
 2048 1489 a 2048 1489 a
SDict begin 22.464 H.A end
 2048 1489
a 2048 1489 a
SDict begin [/View [/XYZ H.V]/Dest (11.61.1) cvn /DEST pdfmark end
 2048 1489 a -2 1657 a
SDict begin H.S end
 -2 1657 a -2 1657
a
SDict begin 13 H.A end
 -2 1657 a -2 1657 a
SDict begin [/View [/XYZ H.V]/Dest (0:3243) cvn /DEST pdfmark end
 -2 1657 a 396 1763 a Fj(T)-7 b(o)21
b(write)f(a)h(poem)e(that)h(captures)f(the)i(heart,)e(\002rst)i(learn)f
(the)g(language.)e(T)-7 b(o)21 b(use)f(\330MQ)g(successfully)g(at)h
(scale)f(you)396 1871 y(ha)n(v)o(e)g(to)g(learn)g(tw)o(o)g(languages.)f
(The)g(\002rst)i(is)g(\330MQ)g(itself.)f(This)h(tak)o(es)f(e)n(v)o(en)f
(the)h(best)h(of)f(us)g(time.)g(It')-5 b(s)21 b(a)g(truism)f(that)396
1979 y(if)h(you)e(try)h(to)g(port)g(an)g(old)g(architecture)e(onto)i
(\330MQ,)g(the)g(results)h(are)f(going)f(to)h(be)g(weird.)g(\330MQ')-5
b(s)21 b(language)d(is)396 2087 y(subtle)i(and)g(profound)d(and)j(when)
f(you)h(master)g(it)h(you)e(will)i(\002nd)f(yourself)f(remo)o(ving)e
(old)j(comple)o(xity)-5 b(,)18 b(not)396 2195 y(con)m(v)o(erting)g(it.)
-2 2379 y
SDict begin H.S end
 -2 2379 a -2 2379 a
SDict begin 13 H.A end
 -2 2379 a -2 2379 a
SDict begin [/View [/XYZ H.V]/Dest (0:3244) cvn /DEST pdfmark end
 -2
2379 a 396 2469 a Fj(Ho)n(we)n(v)o(er)h(the)h(real)g(challenge)f(of)h
(using)g(\330MQ)g(is)h(that)g(old)e(barriers)h(f)o(all)g(a)o(w)o(ay)-5
b(,)20 b(and)f(the)h(size)h(of)f(the)g(projects)g(you)396
2577 y(can)g(do)g(increases)g(hugely)-5 b(.)18 b(Non-distrib)n(uted)g
(code)i(is)h(often)e(a)i(single-person)d(project.)h(Y)-9
b(ou)19 b(can)h(w)o(ork)g(in)g(your)396 2685 y(corner)m(,)e(perhaps)h
(for)h(years,)g(lik)o(e)g(an)g(author)f(on)h(a)h(book.)d(It')-5
b(s)21 b(all)g(about)e(concentration.)e(But)k(distrib)n(uted)e(code)h
(is)396 2793 y(dif)n(ferent.)f(T)-7 b(o)20 b(quote)f(my)h(f)o(a)n(v)n
(orite)g(author)m(,)e(it)j("has)f(to)h(talk)f(to)g(code,)g(has)g(to)g
(be)g(chatty)-5 b(,)19 b(sociable,)h(well-connected".)-2
2977 y
SDict begin H.S end
 -2 2977 a -2 2977 a
SDict begin 13 H.A end
 -2 2977 a -2 2977 a
SDict begin [/View [/XYZ H.V]/Dest (0:3245) cvn /DEST pdfmark end
 -2 2977
a 396 3067 a Fj(Writing)g(distrib)n(uted)g(code)f(is)i(lik)o(e)g
(playing)d(li)n(v)o(e)i(music:)h(it')-5 b(s)21 b(all)g(about)e(other)g
(people.)g(Concentration)f(is)j(w)o(orthless)396 3175
y(if)g(you)e(can')o(t)g(listen.)i(No-one)d(enjo)o(ys)i(listening)g(to)g
(an)g(amazingly)f(pro\002cient)g(musician)g(who')-5 b(s)21
b(out)e(of)h(time)h(with)396 3283 y(the)f(rest)h(of)f(the)g(group)f
(and)g(can')o(t)h(read)f(the)h(mood)f(of)h(the)g(audience.)f(A)i(li)n
(v)o(e)f(jam)g(is)h(entrancing)d(not)i(because)g(of)f(the)396
3391 y(technical)h(quality)f(b)n(ut)h(because)g(of)g(the)g(real-time)f
(creati)n(v)o(e)h(ener)o(gy)-5 b(.)-2 3575 y
SDict begin H.S end
 -2 3575
a -2 3575 a
SDict begin 13 H.A end
 -2 3575 a -2 3575 a
SDict begin [/View [/XYZ H.V]/Dest (0:3246) cvn /DEST pdfmark end
 -2 3575 a 396 3665 a
Fj(And)20 b(so)h(it)f(goes)g(with)h(distrib)n(uted)e(code.)g(Real-time)
h(creati)n(v)o(e)g(ener)o(gy)e(is)j(what)f(wins,)g(not)g(pure)g
(technical)f(quality)-5 b(,)396 3773 y(and)20 b(certainly)f(not)h
(technical)f(quality)h(combined)e(with)i(inability)g(to)g(w)o(ork)g
(with)g(others.)-2 3957 y
SDict begin H.S end
 -2 3957 a -2 3957 a
SDict begin 13 H.A end
 -2 3957
a -2 3957 a
SDict begin [/View [/XYZ H.V]/Dest (0:3247) cvn /DEST pdfmark end
 -2 3957 a 396 4047 a Fj(All)h(this)g(is)g(\002ne)f(in)h
(theory)-5 b(.)18 b(Here)i(comes)g(the)g(catch:)g(w)o(orking)f(with)h
(other)f(people)g(is)2950 4047 y
SDict begin H.S end
 2950 4047 a 2950 4047
a
SDict begin 13 H.A end
 2950 4047 a 2950 4047 a
SDict begin [/View [/XYZ H.V]/Dest (0:3248) cvn /DEST pdfmark end
 2950 4047 a Fi(plain)g(har)m(d)r
Fj(.)h(W)-7 b(e)21 b(can)f(e)o(xpect)f(a)396 4154 y(musician)h(to)g(be)
g(naturally)f(social.)h(But)h(softw)o(are)f(de)n(v)o(elopers?)e(W)-7
b(e')l(re)20 b(the)g(v)o(ery)f(caricature)g(of)h(anti-social)396
4262 y(tunnel-visioned)e(hermits.)h(Other)h(people)f(are)h(hard)f(w)o
(ork.)h(The)o(y')l(re)e(slo)n(w)-5 b(,)20 b(the)o(y)f(mak)o(e)h(mistak)
o(es,)g(the)o(y)g(ask)g(too)396 4370 y(man)o(y)f(questions,)g(the)o(y)h
(don')o(t)e(respect)i(our)g(code,)f(the)o(y)g(mak)o(e)h(wrong)f
(assumptions,)g(the)o(y)h(ar)o(gue.)-2 4554 y
SDict begin H.S end
 -2 4554
a -2 4554 a
SDict begin 13 H.A end
 -2 4554 a -2 4554 a
SDict begin [/View [/XYZ H.V]/Dest (0:3249) cvn /DEST pdfmark end
 -2 4554 a 396 4644 a
Fj(My)g(response)g(isn')o(t)f(v)o(ery)g(sympathetic.)g(T)-7
b(o)21 b(succeed)e(in)h(the)h(softw)o(are)e(industry)g(as)i(it)g(turns)
f(into)g(something)f(more)396 4752 y(lik)o(e)i(a)f(ne)n(v)o(er)n
(-ending)d(li)n(v)o(e)j(jam,)g(we)h(ha)n(v)o(e)e(to)i(learn)e(to)i(put)
f(a)o(w)o(ay)f(our)h(e)o(gos,)f(w)o(ork)h(successfully)f(with)i
(others,)e(w)o(orry)396 4860 y(less)j(about)d(our)g(o)n(wn)h(skills)h
(and)f(look)f(more)g(at)i(others,)e(put)h(a)o(w)o(ay)g(our)g(natural)f
(insolence)g(and)h(attitude,)f(and)h(to)396 4968 y(learn)g(to)g(lik)o
(e)h(and)e(trust)i(other)e(people.)p Black 3759 5569
a Fi(254)p Black eop end
%%Page: 255 269
TeXDict begin 255 268 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.255) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3250) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(So)i(this)f(is)i(what)e(this)g(chapter)f(is)j(really)
d(about:)h(writing)f(code)h(at)h(scale)f(by)g(understanding)d(ourselv)o
(es)i(much)g(better)-5 b(.)396 180 y(Of)21 b(course)e(these)h(lessons)h
(apply)e(to)i(all)f(lar)o(ge-scale)f(applications.)g(Using)h(\330MQ)g
(we)h(just)g(hit)f(the)g(problem)f(sooner)396 288 y(than)h(we')l(d)g(e)
o(xpect.)-2 317 y
SDict begin H.S end
 -2 317 a -2 317 a
SDict begin 13 H.A end
 -2 317 a -2 317 a
SDict begin [/View [/XYZ H.V]/Dest (0:3251) cvn /DEST pdfmark end

-2 317 a 359 x Fh(6.3.)39 b(Psyc)o(hology)e(of)i(Software)f(De)n
(velopment)2844 676 y
SDict begin H.S end
 2844 676 a 2844 676 a
SDict begin 22.464 H.A end
 2844 676
a 2844 676 a
SDict begin [/View [/XYZ H.V]/Dest (11.62.1) cvn /DEST pdfmark end
 2844 676 a -2 874 a
SDict begin H.S end
 -2 874 a -2 874 a
SDict begin 13 H.A end
 -2
874 a -2 874 a
SDict begin [/View [/XYZ H.V]/Dest (0:3253) cvn /DEST pdfmark end
 -2 874 a 396 950 a Fj(Dirkjan)20 b(Ochtman)f(pointed)g
(me)h(to)1473 950 y
SDict begin H.S end
 1473 950 a 1473 950 a
SDict begin 13 H.A end
 1473 950 a
1473 950 a
SDict begin [/View [/XYZ H.V]/Dest (0:3254) cvn /DEST pdfmark end
 1473 950 a Fj(W)m(ikipedia')-5 b(s)20 b(de\002nition)f(of)h
(Softw)o(are)f(Architecture)396 1058 y(\(http://en.wikipedia.or)o
(g/wiki/Softw)o(are)o(_ar)o(chitectu)o(re\))14 b(as)21
b("the)f(set)h(of)f(structures)g(needed)f(to)h(reason)f(about)h(the)396
1166 y(system,)g(which)g(comprise)f(softw)o(are)h(elements,)g
(relations)f(among)g(them,)h(and)f(properties)g(of)h(both".)f(F)o(or)h
(me)g(this)396 1274 y(v)n(apid)f(and)h(circular)f(jar)o(gon)g(is)i(a)f
(good)f(e)o(xample)g(of)h(ho)n(w)g(miserably)f(little)i(we)f
(understand)e(about)i(what)g(actually)396 1382 y(mak)o(es)g(a)h
(successful)f(lar)o(ge)f(scale)i(softw)o(are)f(architecture.)-2
1566 y
SDict begin H.S end
 -2 1566 a -2 1566 a
SDict begin 13 H.A end
 -2 1566 a -2 1566 a
SDict begin [/View [/XYZ H.V]/Dest (0:3255) cvn /DEST pdfmark end
 -2 1566
a 396 1655 a Fj(Architecture)e(is)j(the)e(art)h(and)e(science)i(of)f
(making)f(lar)o(ge)g(arti\002cial)i(structures)f(for)g(human)f(use.)h
(If)g(there)g(is)i(one)d(thing)396 1763 y(I')l(v)o(e)h(learned)g(and)h
(applied)f(successfully)h(in)g(30)g(years)g(of)g(making)f(lar)o(ger)f
(and)i(lar)o(ger)f(softw)o(are)h(systems)g(it)h(is)g(this:)396
1871 y(softw)o(are)f(is)h(about)e(people.)g(Lar)o(ge)g(structures)h(in)
g(themselv)o(es)f(are)i(meaningless.)e(It')-5 b(s)20
b(ho)n(w)g(the)o(y)g(function)e(for)396 1979 y
SDict begin H.S end
 396 1979
a 396 1979 a
SDict begin 13 H.A end
 396 1979 a 396 1979 a
SDict begin [/View [/XYZ H.V]/Dest (0:3256) cvn /DEST pdfmark end
 396 1979 a Fi(human)h(use)h
Fj(that)h(matters.)f(And)f(in)i(softw)o(are,)e(human)g(use)h(starts)h
(with)g(the)f(programmers)d(who)j(mak)o(e)g(the)g(softw)o(are)396
2087 y(itself.)-2 2254 y
SDict begin H.S end
 -2 2254 a -2 2254 a
SDict begin 13 H.A end
 -2 2254
a -2 2254 a
SDict begin [/View [/XYZ H.V]/Dest (0:3257) cvn /DEST pdfmark end
 -2 2254 a 396 2361 a Fj(The)g(core)g(problems)f(in)h(softw)
o(are)g(architecture)e(are)i(dri)n(v)o(en)f(by)h(human)e(psychology)-5
b(,)17 b(not)j(technology)-5 b(.)17 b(There)j(are)396
2469 y(man)o(y)f(w)o(ays)i(our)e(psychology)f(af)n(fects)i(our)f(w)o
(ork.)g(I)i(could)e(point)g(to)i(the)f(w)o(ay)g(teams)h(seem)f(to)g
(get)h(stupider)e(as)i(the)o(y)396 2577 y(get)f(lar)o(ger)m(,)f(or)h
(ha)n(v)o(e)f(to)i(w)o(ork)e(across)h(lar)o(ger)f(distances.)h(Does)g
(that)h(mean)e(the)i(smaller)f(the)g(team,)g(the)g(more)396
2685 y(ef)n(fecti)n(v)o(e?)f(Ho)n(w)h(then)g(does)g(a)g(lar)o(ge)f
(global)h(community)e(lik)o(e)i(\330MQ)h(manage)e(to)h(w)o(ork)f
(successfully?)-2 2869 y
SDict begin H.S end
 -2 2869 a -2 2869 a
SDict begin 13 H.A end
 -2 2869
a -2 2869 a
SDict begin [/View [/XYZ H.V]/Dest (0:3258) cvn /DEST pdfmark end
 -2 2869 a 396 2959 a Fj(The)h(\330MQ)h(community)d(w)o
(asn')o(t)h(accidental,)g(it)i(w)o(as)g(a)g(deliberate)e(design,)g(my)h
(contrib)n(ution)e(to)j(the)f(early)f(days)396 3067 y(when)h(the)g
(code)g(came)f(out)h(of)g(a)h(cellar)f(in)g(Bratisla)n(v)n(a.)h(The)f
(design)f(w)o(as)i(based)f(on)g(my)g(pet)g(science)g(of)g("Social)396
3175 y(Architecture",)f(which)1110 3175 y
SDict begin H.S end
 1110 3175 a
1110 3175 a
SDict begin 13 H.A end
 1110 3175 a 1110 3175 a
SDict begin [/View [/XYZ H.V]/Dest (0:3259) cvn /DEST pdfmark end
 1110 3175 a Fj(W)m(ikipedia)h
(de\002nes)g(\(http://en.wikipedia.or)o(g/wiki/So)o(cial_ar)o(chitectu)
o(re\))14 b(\(what)20 b(a)396 3283 y(coincidence!\))e(as)j("the)f
(process,)f(and)h(the)g(product,)e(of)i(planning,)e(designing,)h(and)g
(gro)n(wing)g(an)h(on-line)396 3391 y(community)-5 b(.")-2
3575 y
SDict begin H.S end
 -2 3575 a -2 3575 a
SDict begin 13 H.A end
 -2 3575 a -2 3575 a
SDict begin [/View [/XYZ H.V]/Dest (0:3260) cvn /DEST pdfmark end
 -2 3575
a 396 3665 a Fj(One)20 b(of)g(the)g(tenets)g(of)g(Social)g
(Architecture)f(is)i(that)1956 3665 y
SDict begin H.S end
 1956 3665 a 1956
3665 a
SDict begin 13 H.A end
 1956 3665 a 1956 3665 a
SDict begin [/View [/XYZ H.V]/Dest (0:3261) cvn /DEST pdfmark end
 1956 3665 a Fi(how)f(we)h(or)m(ganize)e
Fj(is)i(more)e(signi\002cant)h(than)3333 3665 y
SDict begin H.S end
 3333
3665 a 3333 3665 a
SDict begin 13 H.A end
 3333 3665 a 3333 3665 a
SDict begin [/View [/XYZ H.V]/Dest (0:3262) cvn /DEST pdfmark end
 3333 3665
a Fi(who)g(we)h(ar)m(e)p Fj(.)f(The)396 3773 y(same)h(group,)d(or)o
(ganized)f(dif)n(ferently)-5 b(,)17 b(can)j(produce)f(entirely)g
(opposite)g(results.)h(W)-7 b(e)22 b(are)e(lik)o(e)g(peers)g(in)h(a)f
(\330MQ)396 3880 y(netw)o(ork,)f(and)h(our)f(communication)e(patterns)j
(ha)n(v)o(e)g(dramatic)f(impact)h(on)f(our)h(performance.)d(Ordinary)h
(people,)396 3988 y(well)j(connected,)d(can)i(f)o(ar)g(outperform)d(a)k
(team)f(of)g(e)o(xperts)f(w)o(orking)g(in)h(the)h(wrong)d(patterns.)i
(If)g(you')l(re)e(the)396 4096 y(architect)i(of)g(a)g(lar)o(ger)f
(\330MQ)i(application,)d(you')l(re)g(going)h(to)i(ha)n(v)o(e)e(to)i
(help)e(others)h(\002nd)g(the)g(right)g(patterns)f(for)396
4204 y(w)o(orking)g(together)-5 b(.)19 b(Do)h(this)h(right,)e(and)h
(your)f(project)g(can)h(succeed.)f(Do)i(it)f(wrong,)f(and)h(your)f
(project)g(will)i(f)o(ail.)-2 4388 y
SDict begin H.S end
 -2 4388 a -2 4388
a
SDict begin 13 H.A end
 -2 4388 a -2 4388 a
SDict begin [/View [/XYZ H.V]/Dest (0:3263) cvn /DEST pdfmark end
 -2 4388 a 396 4478 a Fj(The)f(tw)o(o)h(most)f
(important)e(psychological)g(elements)i(are)g(IMO)h(that)f(we')l(re)f
(really)h(bad)g(at)h(understanding)396 4586 y(comple)o(xity)-5
b(,)18 b(and)h(that)i(we)f(are)g(so)h(good)e(at)h(w)o(orking)f
(together)g(to)h(di)n(vide)f(and)h(conquer)e(lar)o(ge)h(problems.)g(W)
-7 b(e')l(re)396 4694 y(highly)19 b(social)i(apes,)f(and)f(kind)h(of)g
(smart,)g(b)n(ut)g(only)f(in)i(the)f(right)f(kind)h(of)g(cro)n(wd.)-2
4878 y
SDict begin H.S end
 -2 4878 a -2 4878 a
SDict begin 13 H.A end
 -2 4878 a -2 4878 a
SDict begin [/View [/XYZ H.V]/Dest (0:3264) cvn /DEST pdfmark end
 -2 4878
a 396 4968 a Fj(So)h(here)e(is)i(my)f(short)g(list)h(of)f(the)h
(Psychological)d(Elements)i(of)g(Softw)o(are)f(Architecture:)-2
4986 y
SDict begin H.S end
 -2 4986 a -2 4986 a
SDict begin 13 H.A end
 -2 4986 a -2 4986 a
SDict begin [/View [/XYZ H.V]/Dest (0:3265) cvn /DEST pdfmark end
 -2 4986
a -2 4996 a
SDict begin H.S end
 -2 4996 a -2 4996 a
SDict begin 13 H.A end
 -2 4996 a -2 4996 a
SDict begin [/View [/XYZ H.V]/Dest (0:3266) cvn /DEST pdfmark end
 -2
4996 a Black 3759 5569 a Fi(255)p Black eop end
%%Page: 256 270
TeXDict begin 256 269 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.256) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3267) cvn /DEST pdfmark end
 479 72 a 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3268) cvn /DEST pdfmark end
 479 72 a Fk(Stupidity)p
Fj(:)i(our)e(mental)h(bandwidth)e(is)j(limited,)f(so)h(we')l(re)e(all)i
(stupid)f(at)g(some)g(point.)g(The)f(architecture)g(has)i(to)479
180 y(be)f(simple)h(to)f(understand.)e(This)i(is)h(the)f(number)f(one)g
(rule:)h(simplicity)g(beats)h(functionality)-5 b(,)17
b(e)n(v)o(ery)i(single)h(time.)479 288 y(If)g(you)g(can')o(t)f
(understand)f(an)i(architecture)f(on)g(a)i(cold)f(gray)f(Monday)g
(morning)f(before)g(cof)n(fee,)h(it)i(is)g(too)479 396
y(comple)o(x.)-2 414 y
SDict begin H.S end
 -2 414 a -2 414 a
SDict begin 13 H.A end
 -2 414 a -2
414 a
SDict begin [/View [/XYZ H.V]/Dest (0:3269) cvn /DEST pdfmark end
 -2 414 a Black 396 546 a Fe(\225)p Black 479 546
a
SDict begin H.S end
 479 546 a 479 546 a
SDict begin 13 H.A end
 479 546 a 479 546 a
SDict begin [/View [/XYZ H.V]/Dest (0:3270) cvn /DEST pdfmark end
 479 546 a 479
546 a
SDict begin H.S end
 479 546 a 479 546 a
SDict begin 13 H.A end
 479 546 a 479 546 a
SDict begin [/View [/XYZ H.V]/Dest (0:3271) cvn /DEST pdfmark end
 479 546
a Fk(Sel\002shness)p Fj(:)h(we)f(act)g(only)e(out)h(of)g
(self-interest,)f(so)i(the)f(architecture)f(must)h(create)g(space)g
(and)f(opportunity)f(for)479 654 y(sel\002sh)j(acts)f(that)g(bene\002t)
g(the)g(whole.)f(Sel\002shness)h(is)h(often)e(indirect)g(and)g(subtle.)
h(F)o(or)f(e)o(xample)g(I')o(ll)h(spend)f(hours)479 762
y(helping)g(someone)g(else)i(understand)d(something)h(because)g(that)h
(could)g(be)g(w)o(orth)f(days)h(to)h(me)f(later)-5 b(.)-2
780 y
SDict begin H.S end
 -2 780 a -2 780 a
SDict begin 13 H.A end
 -2 780 a -2 780 a
SDict begin [/View [/XYZ H.V]/Dest (0:3272) cvn /DEST pdfmark end
 -2 780 a Black
396 911 a Fe(\225)p Black 479 911 a
SDict begin H.S end
 479 911 a 479 911
a
SDict begin 13 H.A end
 479 911 a 479 911 a
SDict begin [/View [/XYZ H.V]/Dest (0:3273) cvn /DEST pdfmark end
 479 911 a 479 911 a
SDict begin H.S end
 479 911 a 479
911 a
SDict begin 13 H.A end
 479 911 a 479 911 a
SDict begin [/View [/XYZ H.V]/Dest (0:3274) cvn /DEST pdfmark end
 479 911 a Fk(Laziness)p Fj(:)22
b(we)e(mak)o(e)g(lots)h(of)e(assumptions,)h(man)o(y)f(of)g(which)h(are)
g(wrong.)f(W)-7 b(e)21 b(are)f(happiest)g(when)f(we)i(can)479
1019 y(spend)f(the)g(least)h(ef)n(fort)e(to)h(get)g(a)h(result,)f(to)g
(test)i(an)e(assumption)f(quickly)-5 b(,)18 b(so)i(the)h(architecture)d
(has)j(to)f(mak)o(e)g(this)479 1127 y(possible.)g(Speci\002cally)-5
b(,)19 b(that)h(means)g(it)h(must)f(be)h(simple.)-2 1145
y
SDict begin H.S end
 -2 1145 a -2 1145 a
SDict begin 13 H.A end
 -2 1145 a -2 1145 a
SDict begin [/View [/XYZ H.V]/Dest (0:3275) cvn /DEST pdfmark end
 -2 1145 a Black
396 1276 a Fe(\225)p Black 479 1276 a
SDict begin H.S end
 479 1276 a 479
1276 a
SDict begin 13 H.A end
 479 1276 a 479 1276 a
SDict begin [/View [/XYZ H.V]/Dest (0:3276) cvn /DEST pdfmark end
 479 1276 a 479 1276 a
SDict begin H.S end
 479
1276 a 479 1276 a
SDict begin 13 H.A end
 479 1276 a 479 1276 a
SDict begin [/View [/XYZ H.V]/Dest (0:3277) cvn /DEST pdfmark end
 479 1276 a Fk(J)o(ealousy)p
Fj(:)e(we')l(re)h(jealous)g(of)g(others,)f(which)h(means)g(we')o(ll)g
(o)o(v)o(ercome)e(our)h(stupidity)h(and)f(laziness)i(to)f(pro)o(v)o(e)
479 1384 y(others)g(wrong,)f(and)g(beat)h(them)g(in)g(competition.)f
(The)g(architecture)g(thus)h(has)h(to)f(create)g(space)g(for)g(public)
479 1492 y(competition)f(based)h(on)f(f)o(air)h(rules)h(that)f(an)o
(yone)e(can)i(understand.)-2 1510 y
SDict begin H.S end
 -2 1510 a -2 1510
a
SDict begin 13 H.A end
 -2 1510 a -2 1510 a
SDict begin [/View [/XYZ H.V]/Dest (0:3278) cvn /DEST pdfmark end
 -2 1510 a Black 396 1642 a Fe(\225)p
Black 479 1642 a
SDict begin H.S end
 479 1642 a 479 1642 a
SDict begin 13 H.A end
 479 1642 a 479
1642 a
SDict begin [/View [/XYZ H.V]/Dest (0:3279) cvn /DEST pdfmark end
 479 1642 a 479 1642 a
SDict begin H.S end
 479 1642 a 479 1642 a
SDict begin 13 H.A end
 479
1642 a 479 1642 a
SDict begin [/View [/XYZ H.V]/Dest (0:3280) cvn /DEST pdfmark end
 479 1642 a Fk(Recipr)o(ocity)p Fj(:)f(we')o(ll)i(pay)
e(e)o(xtra)h(in)g(terms)g(of)g(hard)f(w)o(ork,)h(e)n(v)o(en)f(mone)o(y)
-5 b(,)18 b(to)i(punish)f(cheats)h(and)g(enforce)f(f)o(air)479
1750 y(rules.)h(The)g(architecture)f(should)g(be)h(hea)n(vily)f
(rule-based,)g(telling)h(people)f(ho)n(w)g(to)i(w)o(ork)e(together)m(,)
g(b)n(ut)h(not)g(what)479 1857 y(to)h(w)o(ork)e(on.)-2
1858 y
SDict begin H.S end
 -2 1858 a -2 1858 a
SDict begin 13 H.A end
 -2 1858 a -2 1858 a
SDict begin [/View [/XYZ H.V]/Dest (0:3281) cvn /DEST pdfmark end
 -2 1858
a Black 396 2007 a Fe(\225)p Black 479 2007 a
SDict begin H.S end
 479 2007
a 479 2007 a
SDict begin 13 H.A end
 479 2007 a 479 2007 a
SDict begin [/View [/XYZ H.V]/Dest (0:3282) cvn /DEST pdfmark end
 479 2007 a 479 2007
a
SDict begin H.S end
 479 2007 a 479 2007 a
SDict begin 13 H.A end
 479 2007 a 479 2007 a
SDict begin [/View [/XYZ H.V]/Dest (0:3283) cvn /DEST pdfmark end
 479 2007
a Fk(Pride)p Fj(:)i(we')l(re)e(intensely)h(a)o(w)o(are)g(of)g(our)f
(social)i(status,)f(and)g(we')o(ll)g(w)o(ork)g(hard)f(to)i(a)n(v)n(oid)
e(looking)g(stupid)h(or)479 2115 y(incompetent)e(in)j(public.)e(The)h
(architecture)e(has)j(to)f(mak)o(e)g(sure)g(e)n(v)o(ery)f(piece)h(we)g
(mak)o(e)g(has)g(our)g(name)f(on)h(it,)h(so)479 2223
y(we')o(ll)g(ha)n(v)o(e)e(sleepless)i(nights)f(stressing)g(about)g
(what)g(others)f(will)i(say)g(about)e(our)g(w)o(ork.)-2
2241 y
SDict begin H.S end
 -2 2241 a -2 2241 a
SDict begin 13 H.A end
 -2 2241 a -2 2241 a
SDict begin [/View [/XYZ H.V]/Dest (0:3284) cvn /DEST pdfmark end
 -2 2241
a Black 396 2372 a Fe(\225)p Black 479 2372 a
SDict begin H.S end
 479 2372
a 479 2372 a
SDict begin 13 H.A end
 479 2372 a 479 2372 a
SDict begin [/View [/XYZ H.V]/Dest (0:3285) cvn /DEST pdfmark end
 479 2372 a 479 2372
a
SDict begin H.S end
 479 2372 a 479 2372 a
SDict begin 13 H.A end
 479 2372 a 479 2372 a
SDict begin [/View [/XYZ H.V]/Dest (0:3286) cvn /DEST pdfmark end
 479 2372
a Fk(Gr)o(eed)p Fj(:)h(we')l(re)g(ultimately)f(economic)g(animals)h
(\(see)g(sel\002shness\),)g(so)h(the)f(architecture)f(has)h(to)g(gi)n
(v)o(e)g(us)479 2480 y(economic)f(incenti)n(v)o(e)g(to)h(in)m(v)o(est)f
(in)i(making)e(it)i(happen.)d(Maybe)h(it')-5 b(s)21 b(polishing)e(our)h
(reputation)e(as)j(e)o(xperts,)479 2588 y(maybe)e(it')-5
b(s)21 b(literally)f(making)f(mone)o(y)f(from)h(some)h(skill)h(or)f
(component.)d(It)j(doesn')o(t)f(matter)h(what)g(it)g(is,)h(b)n(ut)f
(there)479 2696 y(must)h(be)f(economic)e(incenti)n(v)o(e.)h(Think)g(of)
h(architecture)e(as)j(a)g(mark)o(et)e(place,)h(not)g(an)g(engineering)e
(design.)-2 2714 y
SDict begin H.S end
 -2 2714 a -2 2714 a
SDict begin 13 H.A end
 -2 2714 a -2 2714
a
SDict begin [/View [/XYZ H.V]/Dest (0:3287) cvn /DEST pdfmark end
 -2 2714 a Black 396 2845 a Fe(\225)p Black 479 2845
a
SDict begin H.S end
 479 2845 a 479 2845 a
SDict begin 13 H.A end
 479 2845 a 479 2845 a
SDict begin [/View [/XYZ H.V]/Dest (0:3288) cvn /DEST pdfmark end
 479 2845
a 479 2845 a
SDict begin H.S end
 479 2845 a 479 2845 a
SDict begin 13 H.A end
 479 2845 a 479 2845
a
SDict begin [/View [/XYZ H.V]/Dest (0:3289) cvn /DEST pdfmark end
 479 2845 a Fk(Conf)n(ormity)p Fj(:)h(we')l(re)h(happiest)f(to)h
(conform,)e(out)i(of)g(fear)g(and)f(laziness,)i(so)f(the)h
(architecture)d(should)h(be)479 2953 y(strongly)g(rule-based,)f(and)i
(rules)g(should)f(be)i(clear)m(,)e(accurate,)g(well-documented,)e(and)j
(enforced.)-2 2971 y
SDict begin H.S end
 -2 2971 a -2 2971 a
SDict begin 13 H.A end
 -2 2971 a -2
2971 a
SDict begin [/View [/XYZ H.V]/Dest (0:3290) cvn /DEST pdfmark end
 -2 2971 a Black 396 3103 a Fe(\225)p Black 479
3103 a
SDict begin H.S end
 479 3103 a 479 3103 a
SDict begin 13 H.A end
 479 3103 a 479 3103 a
SDict begin [/View [/XYZ H.V]/Dest (0:3291) cvn /DEST pdfmark end
 479
3103 a 479 3103 a
SDict begin H.S end
 479 3103 a 479 3103 a
SDict begin 13 H.A end
 479 3103 a 479
3103 a
SDict begin [/View [/XYZ H.V]/Dest (0:3292) cvn /DEST pdfmark end
 479 3103 a Fk(F)n(ear)p Fj(:)g(we')l(re)g(unwilling)f(to)h(tak)o
(e)g(risks,)h(especially)e(if)i(it)g(mak)o(es)f(us)g(look)g(stupid.)f
(Fear)h(of)g(f)o(ailure)g(is)h(a)g(major)479 3211 y(reason)f(people)f
(conform)f(and)h(follo)n(w)h(the)g(group)f(in)h(mass)h(stupidity)-5
b(.)19 b(The)g(architecture)g(should)g(mak)o(e)h(silent)479
3319 y(e)o(xperimentation)d(easy)k(and)e(cheap,)g(gi)n(ving)g(people)g
(opportunity)f(for)h(success)i(without)e(punishing)g(f)o(ailure.)-2
3503 y
SDict begin H.S end
 -2 3503 a -2 3503 a
SDict begin 13 H.A end
 -2 3503 a -2 3503 a
SDict begin [/View [/XYZ H.V]/Dest (0:3293) cvn /DEST pdfmark end
 -2 3503
a 396 3593 a Fj(These)h(strate)o(gies)g(w)o(ork)g(on)g(lar)o(ge)f
(scale)i(b)n(ut)f(also)g(on)g(small)h(scale,)f(within)g(an)g(or)o
(ganization)d(or)j(team.)-2 3621 y
SDict begin H.S end
 -2 3621 a -2 3621
a
SDict begin 13 H.A end
 -2 3621 a -2 3621 a
SDict begin [/View [/XYZ H.V]/Dest (0:3294) cvn /DEST pdfmark end
 -2 3621 a 359 x Fh(6.4.)39 b(The)g(Bad,)g(the)g
(Ugl)n(y)-11 b(,)38 b(and)h(the)g(Delicious)2745 3980
y
SDict begin H.S end
 2745 3980 a 2745 3980 a
SDict begin 22.464 H.A end
 2745 3980 a 2745 3980 a
SDict begin [/View [/XYZ H.V]/Dest (11.63.1) cvn /DEST pdfmark end
 2745
3980 a -2 4178 a
SDict begin H.S end
 -2 4178 a -2 4178 a
SDict begin 13 H.A end
 -2 4178 a -2 4178
a
SDict begin [/View [/XYZ H.V]/Dest (0:3296) cvn /DEST pdfmark end
 -2 4178 a 396 4254 a Fj(Comple)o(xity)19 b(is)i(easy)-5
b(,)20 b(it')-5 b(s)21 b(simplicity)f(that)g(is)h(hard.)e(Whether)h
(our)f(softw)o(are)h(is)h(bad,)f(ugly)-5 b(,)18 b(or)i(so)h(delicious)e
(that)i(it)396 4362 y(feels)f(wrong)f(to)h(consume)f(alone,)g(doesn')o
(t)f(depend)h(so)h(much)f(on)g(our)g(indi)n(vidual)g(skills)h(as)h(ho)n
(w)e(we)i(w)o(ork)e(together)-5 b(.)396 4470 y(That)20
b(is,)h(our)f(processes.)-2 4654 y
SDict begin H.S end
 -2 4654 a -2 4654
a
SDict begin 13 H.A end
 -2 4654 a -2 4654 a
SDict begin [/View [/XYZ H.V]/Dest (0:3297) cvn /DEST pdfmark end
 -2 4654 a 396 4744 a Fj(There)g(are)g(man)o(y)f
(aspects)h(to)h(getting)e(product-b)n(uilding)d(teams)21
b(and)e(or)o(ganizations)e(to)k(think)e(wisely)-5 b(.)20
b(Y)-9 b(ou)20 b(need)396 4852 y(di)n(v)o(ersity)-5 b(,)19
b(freedom,)f(challenge,)g(resources,)h(and)h(so)h(on.)e(I)i(discuss)f
(these)h(in)f(detail)g(in)2988 4852 y
SDict begin H.S end
 2988 4852 a 2988
4852 a
SDict begin 13 H.A end
 2988 4852 a 2988 4852 a
SDict begin [/View [/XYZ H.V]/Dest (0:3298) cvn /DEST pdfmark end
 2988 4852 a Fj(Softw)o(are)g(and)g
(Silicon)396 4960 y(\(http://swsi.info\).)f(Ho)n(we)n(v)o(er)m(,)f(e)n
(v)o(en)h(if)h(you)g(ha)n(v)o(e)f(all)i(the)f(right)g(ingredients,)e
(the)i(def)o(ault)g(processes)g(that)g(skilled)396 5068
y(engineers)f(and)h(designers)f(de)n(v)o(elop)f(will)j(result)g(in)f
(comple)o(x,)e(hard-to-use)g(products.)p Black 3757 5569
a Fi(256)p Black eop end
%%Page: 257 271
TeXDict begin 257 270 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.257) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3299) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)h(classic)h(errors)f(are:)g(to)g(focus)g(on)f
(ideas,)i(not)e(problems;)g(to)i(focus)e(on)h(the)g(wrong)f(problems;)g
(to)h(misjudge)f(the)396 180 y(v)n(alue)h(of)g(solving)f(problems;)g
(to)h(not)g(use)g(ones')g(o)n(wn)g(w)o(ork;)f(and)h(in)g(man)o(y)f
(other)h(w)o(ays)g(to)g(misjudge)g(the)g(real)396 288
y(mark)o(et.)-2 455 y
SDict begin H.S end
 -2 455 a -2 455 a
SDict begin 13 H.A end
 -2 455 a -2 455
a
SDict begin [/View [/XYZ H.V]/Dest (0:3300) cvn /DEST pdfmark end
 -2 455 a 396 562 a Fj(I')o(ll)g(propose)e(a)i(process)f(called)g
("Simplicity)g(Oriented)f(Design",)h(or)g(SOD,)h(which)f(is)h(as)g(f)o
(ar)g(as)g(I)f(can)h(tell)g(a)f(reliable,)396 670 y(repeatable)g(w)o
(ay)h(of)g(de)n(v)o(eloping)e(simple)i(and)f(ele)o(gant)g(products.)g
(This)h(process)g(or)o(ganizes)e(people)h(into)h(\003e)o(xible)396
778 y(supply)f(chains)h(that)h(are)f(able)g(to)g(na)n(vigate)f(a)i
(problem)d(landscape)h(rapidly)g(and)h(cheaply)-5 b(.)18
b(The)o(y)h(do)h(this)h(by)396 886 y(b)n(uilding,)e(testing,)h(and)f(k)
o(eeping)g(or)h(discarding)f(minimal)g(plausible)h(solutions,)f(called)
h("patches".)f(Li)n(ving)396 994 y(products)g(consist)h(of)f(long)g
(series)i(of)f(patches,)f(applied)g(one)g(atop)g(the)h(other)-5
b(.)20 b(Y)-8 b(es,)20 b(you)f(may)g(recognize)f(the)i(process)396
1102 y(by)g(which)g(we)g(de)n(v)o(elop)f(\330MQ.)-2 1286
y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286 a -2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:3301) cvn /DEST pdfmark end
 -2 1286 a 396
1376 a Fj(Let')-5 b(s)21 b(\002rst)g(look)e(at)i(the)f(more)g(common)e
(and)i(less)h(jo)o(yful)e(processes,)h(T)o(OD)g(and)f(COD.)-2
1394 y
SDict begin H.S end
 -2 1394 a -2 1394 a
SDict begin 13 H.A end
 -2 1394 a -2 1394 a
SDict begin [/View [/XYZ H.V]/Dest (0:3302) cvn /DEST pdfmark end
 -2 1394
a 396 1704 a Fd(6.4.1.)36 b(T)-10 b(rash-Oriented)34
b(Design)2006 1704 y
SDict begin H.S end
 2006 1704 a 2006 1704 a
SDict begin 18.72 H.A end
 2006 1704
a 2006 1704 a
SDict begin [/View [/XYZ H.V]/Dest (11.63.40.2) cvn /DEST pdfmark end
 2006 1704 a -2 1897 a
SDict begin H.S end
 -2 1897 a -2 1897
a
SDict begin 13 H.A end
 -2 1897 a -2 1897 a
SDict begin [/View [/XYZ H.V]/Dest (0:3304) cvn /DEST pdfmark end
 -2 1897 a 396 1978 a Fj(The)20
b(most)f(popular)f(design)h(process)h(in)g(lar)o(ge)e(b)n(usinesses)i
(seems)h(to)f(be)f("T)m(rash)h(Oriented)e(Design",)h(or)h(T)o(OD.)f(T)o
(OD)396 2086 y(feeds)h(of)n(f)g(the)g(belief)g(that)g(all)h(we)f(need)g
(to)g(mak)o(e)g(mone)o(y)e(are)j(great)e(ideas.)h(It')-5
b(s)21 b(tenacious)f(nonsense)f(b)n(ut)h(a)396 2194 y(po)n(werful)f
(crutch)g(for)g(people)h(who)f(lack)h(imagination.)e(The)i(theory)f
(goes)h(that)g(ideas)h(are)f(rare,)f(so)i(the)f(trick)g(is)h(to)396
2302 y(capture)e(them.)h(It')-5 b(s)21 b(lik)o(e)f(non-musicians)e
(being)h(a)o(wed)h(by)g(a)h(guitar)e(player)m(,)g(not)h(realizing)f
(that)h(great)g(talent)g(is)h(so)396 2410 y(cheap)f(it)h(literally)f
(plays)g(on)f(the)i(streets)f(for)g(coins.)-2 2594 y
SDict begin H.S end

-2 2594 a -2 2594 a
SDict begin 13 H.A end
 -2 2594 a -2 2594 a
SDict begin [/View [/XYZ H.V]/Dest (0:3305) cvn /DEST pdfmark end
 -2 2594 a 396
2684 a Fj(The)g(main)g(output)f(of)h(T)o(ODs)g(are)g(e)o(xpensi)n(v)o
(e)e("ideations":)i(concepts,)f(design)g(documents,)f(and)i(products)f
(that)h(go)396 2792 y(straight)g(into)g(the)g(trash)g(can.)g(It)h(w)o
(orks)e(as)i(follo)n(ws:)-2 2810 y
SDict begin H.S end
 -2 2810 a -2 2810
a
SDict begin 13 H.A end
 -2 2810 a -2 2810 a
SDict begin [/View [/XYZ H.V]/Dest (0:3306) cvn /DEST pdfmark end
 -2 2810 a -2 2820 a
SDict begin H.S end
 -2 2820 a -2
2820 a
SDict begin 13 H.A end
 -2 2820 a -2 2820 a
SDict begin [/View [/XYZ H.V]/Dest (0:3307) cvn /DEST pdfmark end
 -2 2820 a Black 396 2962 a
Fe(\225)p Black 479 2962 a
SDict begin H.S end
 479 2962 a 479 2962 a
SDict begin 13 H.A end
 479
2962 a 479 2962 a
SDict begin [/View [/XYZ H.V]/Dest (0:3308) cvn /DEST pdfmark end
 479 2962 a Fj(The)f(Creati)n(v)o(e)g(People)g(come)f
(up)h(with)g(long)g(lists)h(of)f("we)h(could)e(do)h(X)g(and)g(Y".)g(I')
l(v)o(e)f(seen)i(endlessly)e(detailed)479 3070 y(lists)j(of)e(e)n(v)o
(erything)d(amazing)i(a)i(product)d(could)i(do.)f(Once)h(the)g(creati)n
(v)o(e)f(w)o(ork)h(of)g(idea)g(generation)e(has)479 3178
y(happened,)g(it')-5 b(s)21 b(just)g(a)g(matter)e(of)h(e)o(x)o
(ecution,)e(of)i(course.)-2 3196 y
SDict begin H.S end
 -2 3196 a -2 3196
a
SDict begin 13 H.A end
 -2 3196 a -2 3196 a
SDict begin [/View [/XYZ H.V]/Dest (0:3309) cvn /DEST pdfmark end
 -2 3196 a Black 396 3327 a Fe(\225)p
Black 479 3327 a
SDict begin H.S end
 479 3327 a 479 3327 a
SDict begin 13 H.A end
 479 3327 a 479
3327 a
SDict begin [/View [/XYZ H.V]/Dest (0:3310) cvn /DEST pdfmark end
 479 3327 a Fj(So)h(the)f(managers)f(and)g(their)h(consultants)g
(pass)g(their)g(brilliant,)g(w)o(orld-shattering)e(ideas)i(to)g
(designers)g(who)479 3435 y(create)g(acres)g(of)g(detailed,)g
(preciously)e(re\002ned)i(design)f(documents.)f(The)i(designers)g(tak)o
(e)g(the)g(tens)h(of)e(ideas)i(the)479 3543 y(managers)e(came)h(up)g
(with,)g(and)g(turn)f(them)h(into)g(hundreds)e(of)i(amazing,)f(w)o
(orld-changing)d(designs.)-2 3561 y
SDict begin H.S end
 -2 3561 a -2 3561
a
SDict begin 13 H.A end
 -2 3561 a -2 3561 a
SDict begin [/View [/XYZ H.V]/Dest (0:3311) cvn /DEST pdfmark end
 -2 3561 a Black 396 3692 a Fe(\225)p
Black 479 3692 a
SDict begin H.S end
 479 3692 a 479 3692 a
SDict begin 13 H.A end
 479 3692 a 479
3692 a
SDict begin [/View [/XYZ H.V]/Dest (0:3312) cvn /DEST pdfmark end
 479 3692 a Fj(These)k(designs)g(get)g(gi)n(v)o(en)f(to)i
(engineers)d(who)i(scratch)g(their)g(heads)g(and)f(w)o(onder)g(who)h
(the)g(heck)g(came)g(up)f(with)479 3800 y(such)h(stupid)g(nonsense.)f
(The)o(y)g(start)i(to)f(ar)o(gue)f(back)g(b)n(ut)h(the)h(designs)e
(come)h(from)f(up)h(high,)f(and)h(really)-5 b(,)19 b(it')-5
b(s)21 b(not)479 3908 y(up)f(to)g(engineers)f(to)i(ar)o(gue)d(with)j
(creati)n(v)o(e)e(people)g(and)h(e)o(xpensi)n(v)o(e)e(consultants.)-2
3926 y
SDict begin H.S end
 -2 3926 a -2 3926 a
SDict begin 13 H.A end
 -2 3926 a -2 3926 a
SDict begin [/View [/XYZ H.V]/Dest (0:3313) cvn /DEST pdfmark end
 -2 3926
a Black 396 4058 a Fe(\225)p Black 479 4058 a
SDict begin H.S end
 479 4058
a 479 4058 a
SDict begin 13 H.A end
 479 4058 a 479 4058 a
SDict begin [/View [/XYZ H.V]/Dest (0:3314) cvn /DEST pdfmark end
 479 4058 a Fj(So)j(the)f(engineers)f
(creep)g(back)h(to)g(their)g(cubicles,)g(humiliated)f(and)g(threatened)
g(into)h(b)n(uilding)f(the)h(gigantic)f(b)n(ut)479 4166
y(oh-so-ele)o(gant)e(pile)k(of)e(junk.)h(It)g(is)h(bone-breakingly)16
b(hard)j(w)o(ork)h(since)g(the)g(designs)g(tak)o(e)h(no)e(account)g(of)
479 4274 y(practical)h(costs.)g(Minor)g(whims)g(might)f(tak)o(e)i
(weeks)f(of)g(w)o(ork)f(to)i(b)n(uild.)e(As)i(the)f(project)g(gets)g
(delayed,)f(the)479 4381 y(managers)g(b)n(ully)h(the)g(engineers)f
(into)h(gi)n(ving)f(up)h(their)g(e)n(v)o(enings)e(and)i(week)o(ends.)-2
4399 y
SDict begin H.S end
 -2 4399 a -2 4399 a
SDict begin 13 H.A end
 -2 4399 a -2 4399 a
SDict begin [/View [/XYZ H.V]/Dest (0:3315) cvn /DEST pdfmark end
 -2 4399
a Black 396 4531 a Fe(\225)p Black 479 4531 a
SDict begin H.S end
 479 4531
a 479 4531 a
SDict begin 13 H.A end
 479 4531 a 479 4531 a
SDict begin [/View [/XYZ H.V]/Dest (0:3316) cvn /DEST pdfmark end
 479 4531 a Fj(Ev)o(entually)-5
b(,)18 b(something)h(resembling)f(a)j(w)o(orking)e(product)f(mak)o(es)i
(it)h(out)f(of)g(the)g(door)-5 b(.)19 b(It')-5 b(s)21
b(creak)o(y)e(and)g(fragile,)479 4639 y(comple)o(x)g(and)g(ugly)-5
b(.)19 b(The)h(designers)f(curse)h(the)g(engineers)f(for)h(their)g
(incompetence)e(and)h(pay)h(more)f(consultants)479 4747
y(to)i(put)e(lipstick)i(onto)e(the)h(pig,)g(and)g(slo)n(wly)g(the)g
(product)e(starts)j(to)g(look)e(a)i(little)g(nicer)-5
b(.)-2 4765 y
SDict begin H.S end
 -2 4765 a -2 4765 a
SDict begin 13 H.A end
 -2 4765 a -2 4765 a
SDict begin [/View [/XYZ H.V]/Dest (0:3317) cvn /DEST pdfmark end

-2 4765 a Black 396 4896 a Fe(\225)p Black 479 4896 a
SDict begin H.S end

479 4896 a 479 4896 a
SDict begin 13 H.A end
 479 4896 a 479 4896 a
SDict begin [/View [/XYZ H.V]/Dest (0:3318) cvn /DEST pdfmark end
 479 4896
a Fj(By)21 b(this)g(time,)f(the)g(managers)f(ha)n(v)o(e)g(started)i(to)
f(try)g(to)g(sell)h(the)g(product)d(and)i(the)o(y)f(\002nd,)h
(shockingly)-5 b(,)17 b(that)j(no-one)479 5004 y(w)o(ants)h(it.)g
(Undaunted)d(and)h(courageously)f(the)o(y)h(b)n(uild)h(million-dollar)e
(web)i(sites)h(and)f(ad)g(campaigns)f(to)h(e)o(xplain)p
Black 3756 5569 a Fi(257)p Black eop end
%%Page: 258 272
TeXDict begin 258 271 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.258) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 479 72 a Fj(to)i(the)f(public)f(why)g(the)o(y)h(absolutely)f
(need)g(this)i(product.)d(The)o(y)h(do)h(deals)h(with)f(other)f(b)n
(usinesses)i(to)f(force)g(the)479 180 y(product)f(on)g(the)i(lazy)-5
b(,)19 b(stupid)h(and)f(ungrateful)f(mark)o(et.)-2 198
y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:3319) cvn /DEST pdfmark end
 -2 198 a Black
396 330 a Fe(\225)p Black 479 330 a
SDict begin H.S end
 479 330 a 479 330
a
SDict begin 13 H.A end
 479 330 a 479 330 a
SDict begin [/View [/XYZ H.V]/Dest (0:3320) cvn /DEST pdfmark end
 479 330 a Fj(After)i(twelv)o(e)g(months)f(of)h
(intense)g(mark)o(eting,)f(the)h(product)e(still)j(isn')o(t)f(making)f
(pro\002ts.)h(W)-7 b(orse,)20 b(it)h(suf)n(fers)479 438
y(dramatic)f(f)o(ailures)f(and)h(gets)h(branded)d(in)i(the)g(press)h
(as)g(a)f(disaster)-5 b(.)21 b(The)f(compan)o(y)d(quietly)j(shelv)o(es)
g(it,)g(\002res)h(the)479 546 y(consultants,)e(b)n(uys)h(a)h(competing)
d(product)h(from)g(a)h(small)h(start-up)e(and)h(re-brands)e(that)j(as)f
(its)i(o)n(wn)d(V)-9 b(ersion)20 b(2.)479 654 y(Hundreds)f(of)h
(millions)g(of)g(dollars)f(end-up)g(in)h(the)g(trash.)-2
672 y
SDict begin H.S end
 -2 672 a -2 672 a
SDict begin 13 H.A end
 -2 672 a -2 672 a
SDict begin [/View [/XYZ H.V]/Dest (0:3321) cvn /DEST pdfmark end
 -2 672 a Black
396 803 a Fe(\225)p Black 479 803 a
SDict begin H.S end
 479 803 a 479 803
a
SDict begin 13 H.A end
 479 803 a 479 803 a
SDict begin [/View [/XYZ H.V]/Dest (0:3322) cvn /DEST pdfmark end
 479 803 a Fj(Meanwhile,)f(another)g(visionary)g
(manager)m(,)f(some)n(where)h(in)h(the)g(Or)o(ganization,)d(drinks)j(a)
g(little)h(too)f(much)479 911 y(tequila)g(with)g(some)g(mark)o(eting)f
(people)g(and)h(has)g(a)h(Brilliant)f(Idea.)-2 1095 y
SDict begin H.S end

-2 1095 a -2 1095 a
SDict begin 13 H.A end
 -2 1095 a -2 1095 a
SDict begin [/View [/XYZ H.V]/Dest (0:3323) cvn /DEST pdfmark end
 -2 1095 a 396
1185 a Fj(T)m(rash-Oriented)e(Design)i(w)o(ould)g(be)g(a)g(caricature)f
(if)i(it)g(w)o(asn')o(t)f(so)g(common.)e(Something)h(lik)o(e)h(19)g
(out)g(of)g(20)396 1293 y(mark)o(et-ready)e(products)g(b)n(uilt)j(by)f
(lar)o(ge)f(\002rms)h(are)g(f)o(ailures)g(\(yes,)g(87\045)g(of)g
(statistics)i(are)e(made)f(up)h(on)g(the)g(spot\).)396
1401 y(The)g(remaining)e(one)i(in)g(20)g(probably)e(only)h(succeeds)h
(because)f(the)i(competitors)d(are)i(so)h(bad)f(and)f(the)h(mark)o
(eting)f(is)396 1509 y(so)i(aggressi)n(v)o(e.)-2 1693
y
SDict begin H.S end
 -2 1693 a -2 1693 a
SDict begin 13 H.A end
 -2 1693 a -2 1693 a
SDict begin [/View [/XYZ H.V]/Dest (0:3324) cvn /DEST pdfmark end
 -2 1693 a 396
1783 a Fj(The)f(main)g(lessons)h(of)e(T)o(OD)h(are)g(quite)g
(straight-forw)o(ard)e(b)n(ut)i(hard)f(to)h(sw)o(allo)n(w)-5
b(.)20 b(The)o(y)f(are:)-2 1801 y
SDict begin H.S end
 -2 1801 a -2 1801 a
SDict begin 13 H.A end

-2 1801 a -2 1801 a
SDict begin [/View [/XYZ H.V]/Dest (0:3325) cvn /DEST pdfmark end
 -2 1801 a -2 1811 a
SDict begin H.S end
 -2 1811 a -2
1811 a
SDict begin 13 H.A end
 -2 1811 a -2 1811 a
SDict begin [/View [/XYZ H.V]/Dest (0:3326) cvn /DEST pdfmark end
 -2 1811 a Black 396 1953 a
Fe(\225)p Black 479 1953 a
SDict begin H.S end
 479 1953 a 479 1953 a
SDict begin 13 H.A end
 479
1953 a 479 1953 a
SDict begin [/View [/XYZ H.V]/Dest (0:3327) cvn /DEST pdfmark end
 479 1953 a Fj(Ideas)h(are)g(cheap.)f(No)i(e)o
(xceptions.)d(There)h(are)h(no)g(brilliant)g(ideas.)g(An)o(yone)e(who)i
(tries)h(to)f(start)h(a)g(discussion)479 2061 y(with)g("oooh,)d(we)j
(can)f(do)f(this)i(too!")f(should)f(be)h(beaten)f(do)n(wn)g(with)i(all)
g(the)f(passion)g(one)f(reserv)o(es)h(for)f(tra)n(v)o(eling)479
2169 y(e)n(v)n(angelists.)h(It)g(is)h(lik)o(e)g(sitting)f(in)g(a)h
(cafe)f(at)h(the)f(foot)f(of)h(a)h(mountain,)d(drinking)g(a)j(hot)f
(chocolate)f(and)g(telling)479 2277 y(others,)h("he)o(y)-5
b(,)18 b(I)j(ha)n(v)o(e)e(a)i(great)f(idea,)f(we)i(can)f(climb)g(that)g
(mountain!)e(And)i(b)n(uild)g(a)g(chalet)g(on)g(top!)g(W)m(ith)g(tw)o
(o)479 2385 y(saunas!)g(And)g(a)g(garden!)e(He)o(y)-5
b(,)19 b(and)h(we)h(can)f(mak)o(e)f(it)i(solar)f(po)n(wered!)f(Dude,)g
(that')-5 b(s)21 b(a)o(wesome!)e(What)h(color)479 2493
y(should)f(we)i(paint)f(it?)h(Green!)e(No,)h(blue!)f(OK,)i(go)e(and)h
(mak)o(e)g(it,)g(I')o(ll)h(stay)f(here)g(and)g(mak)o(e)f(spreadsheets)h
(and)479 2600 y(graphics!")-2 2618 y
SDict begin H.S end
 -2 2618 a -2 2618
a
SDict begin 13 H.A end
 -2 2618 a -2 2618 a
SDict begin [/View [/XYZ H.V]/Dest (0:3328) cvn /DEST pdfmark end
 -2 2618 a Black 396 2750 a Fe(\225)p
Black 479 2750 a
SDict begin H.S end
 479 2750 a 479 2750 a
SDict begin 13 H.A end
 479 2750 a 479
2750 a
SDict begin [/View [/XYZ H.V]/Dest (0:3329) cvn /DEST pdfmark end
 479 2750 a Fj(The)g(starting)g(point)f(for)h(a)h(good)d(design)i
(process)g(is)h(to)f(collect)g(real)g(problems)f(that)h(confront)e
(real)j(people.)e(The)479 2858 y(second)h(step)g(is)h(to)g(e)n(v)n
(aluate)e(these)h(problems)f(with)h(the)g(basic)h(question,)e("ho)n(w)g
(much)g(is)j(it)f(w)o(orth)e(to)h(solv)o(e)g(this)479
2966 y(problem?")e(Ha)n(ving)i(done)f(that,)h(we)h(can)f(collect)g
(that)g(set)h(of)f(problems)f(that)h(are)g(w)o(orth)g(solving.)-2
2984 y
SDict begin H.S end
 -2 2984 a -2 2984 a
SDict begin 13 H.A end
 -2 2984 a -2 2984 a
SDict begin [/View [/XYZ H.V]/Dest (0:3330) cvn /DEST pdfmark end
 -2 2984
a Black 396 3115 a Fe(\225)p Black 479 3115 a
SDict begin H.S end
 479 3115
a 479 3115 a
SDict begin 13 H.A end
 479 3115 a 479 3115 a
SDict begin [/View [/XYZ H.V]/Dest (0:3331) cvn /DEST pdfmark end
 479 3115 a Fj(Good)g(solutions)f(to)
h(real)h(problems)d(will)j(succeed)f(as)h(products.)d(Their)i(success)h
(will)f(depend)f(on)h(ho)n(w)f(good)g(and)479 3223 y(cheap)h(the)g
(solution)f(is,)i(and)f(ho)n(w)f(important)g(the)h(problem)f(is)i
(\(and)e(sadly)-5 b(,)19 b(ho)n(w)h(big)g(the)g(mark)o(eting)f(b)n
(udgets)479 3331 y(are\).)h(But)h(their)e(success)i(will)g(also)g
(depend)d(on)i(ho)n(w)g(much)f(the)o(y)g(demand)g(in)h(ef)n(fort)f(to)i
(use,)f(in)g(other)g(w)o(ords)f(ho)n(w)479 3439 y(simple)h(the)o(y)g
(are.)-2 3623 y
SDict begin H.S end
 -2 3623 a -2 3623 a
SDict begin 13 H.A end
 -2 3623 a -2 3623
a
SDict begin [/View [/XYZ H.V]/Dest (0:3332) cvn /DEST pdfmark end
 -2 3623 a 396 3713 a Fj(Hence)g(after)g(slaying)g(the)g(dragon)e(of)i
(utter)g(irrele)n(v)n(ance,)e(we)j(attack)f(the)g(demon)f(of)g(comple)o
(xity)-5 b(.)-2 3741 y
SDict begin H.S end
 -2 3741 a -2 3741 a
SDict begin 13 H.A end
 -2 3741 a
-2 3741 a
SDict begin [/View [/XYZ H.V]/Dest (0:3333) cvn /DEST pdfmark end
 -2 3741 a 396 4051 a Fd(6.4.2.)36 b(Comple)n(xity-Oriented)g
(Design)2333 4051 y
SDict begin H.S end
 2333 4051 a 2333 4051 a
SDict begin 18.72 H.A end
 2333 4051
a 2333 4051 a
SDict begin [/View [/XYZ H.V]/Dest (11.63.41.2) cvn /DEST pdfmark end
 2333 4051 a -2 4244 a
SDict begin H.S end
 -2 4244 a -2 4244
a
SDict begin 13 H.A end
 -2 4244 a -2 4244 a
SDict begin [/View [/XYZ H.V]/Dest (0:3335) cvn /DEST pdfmark end
 -2 4244 a 396 4325 a Fj(Really)21
b(good)e(engineering)e(teams)k(and)e(small)i(\002rms)f(can)g(usually)g
(b)n(uild)g(decent)f(products.)g(But)h(the)h(v)n(ast)f(majority)396
4433 y(of)g(products)f(still)i(end)f(up)g(being)f(too)h(comple)o(x)e
(and)i(less)h(successful)f(than)g(the)o(y)f(might)h(be.)g(This)g(is)h
(because)396 4541 y(specialist)g(teams,)f(e)n(v)o(en)f(the)i(best,)f
(often)f(stubbornly)f(apply)h(a)i(process)f(I)g(call)h("Comple)o
(xity-Oriented)16 b(Design",)k(or)396 4649 y(COD,)h(which)f(w)o(orks)g
(as)g(follo)n(ws:)-2 4661 y
SDict begin H.S end
 -2 4661 a -2 4661 a
SDict begin 13 H.A end
 -2 4661
a -2 4661 a
SDict begin [/View [/XYZ H.V]/Dest (0:3336) cvn /DEST pdfmark end
 -2 4661 a -2 4671 a
SDict begin H.S end
 -2 4671 a -2 4671 a
SDict begin 13 H.A end
 -2
4671 a -2 4671 a
SDict begin [/View [/XYZ H.V]/Dest (0:3337) cvn /DEST pdfmark end
 -2 4671 a Black 396 4819 a Fe(\225)p
Black 479 4819 a
SDict begin H.S end
 479 4819 a 479 4819 a
SDict begin 13 H.A end
 479 4819 a 479
4819 a
SDict begin [/View [/XYZ H.V]/Dest (0:3338) cvn /DEST pdfmark end
 479 4819 a Fj(Management)e(correctly)h(identi\002es)h(some)h
(interesting)e(and)g(dif)n(\002cult)h(problem)e(with)j(economic)d(v)n
(alue.)i(In)g(doing)479 4927 y(so)h(the)o(y)e(already)g(leapfrog)g(o)o
(v)o(er)g(an)o(y)g(T)o(OD)h(team.)-2 4945 y
SDict begin H.S end
 -2 4945 a
-2 4945 a
SDict begin 13 H.A end
 -2 4945 a -2 4945 a
SDict begin [/View [/XYZ H.V]/Dest (0:3339) cvn /DEST pdfmark end
 -2 4945 a Black 3759 5569
a Fi(258)p Black eop end
%%Page: 259 273
TeXDict begin 259 272 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.259) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3340) cvn /DEST pdfmark end
 479 72 a Fj(The)h(team)g(with)h
(enthusiasm)e(start)i(to)f(b)n(uild)g(prototypes)e(and)i(core)f
(layers.)h(These)g(w)o(ork)g(as)h(designed)e(and)g(thus)479
180 y(encouraged,)e(the)k(team)f(go)g(of)n(f)f(into)h(intense)g(design)
f(and)h(architecture)f(discussions,)g(coming)g(up)h(with)g(ele)o(gant)
479 288 y(schemas)g(that)h(look)e(beautiful)g(and)h(solid.)-2
289 y
SDict begin H.S end
 -2 289 a -2 289 a
SDict begin 13 H.A end
 -2 289 a -2 289 a
SDict begin [/View [/XYZ H.V]/Dest (0:3341) cvn /DEST pdfmark end
 -2 289 a Black
396 438 a Fe(\225)p Black 479 438 a
SDict begin H.S end
 479 438 a 479 438
a
SDict begin 13 H.A end
 479 438 a 479 438 a
SDict begin [/View [/XYZ H.V]/Dest (0:3342) cvn /DEST pdfmark end
 479 438 a Fj(Management)e(comes)i(back)g(and)g
(challenges)f(team)h(with)g(yet)g(more)g(dif)n(\002cult)f(problems.)g
(W)-7 b(e)21 b(tend)f(to)g(equate)479 546 y(v)n(alue)g(with)g(cost,)g
(so)h(the)f(harder)f(the)h(problem,)e(and)i(more)f(e)o(xpensi)n(v)o(e)g
(to)h(solv)o(e,)f(the)i(more)e(the)h(solution)g(should)479
654 y(be)g(w)o(orth,)g(in)g(their)g(minds.)-2 666 y
SDict begin H.S end
 -2
666 a -2 666 a
SDict begin 13 H.A end
 -2 666 a -2 666 a
SDict begin [/View [/XYZ H.V]/Dest (0:3343) cvn /DEST pdfmark end
 -2 666 a Black 396 803
a Fe(\225)p Black 479 803 a
SDict begin H.S end
 479 803 a 479 803 a
SDict begin 13 H.A end
 479 803
a 479 803 a
SDict begin [/View [/XYZ H.V]/Dest (0:3344) cvn /DEST pdfmark end
 479 803 a Fj(The)g(team,)g(being)f(engineers)g(and)h(thus)g
(lo)o(ving)f(to)h(b)n(uild)g(stuf)n(f,)f(b)n(uild)h(stuf)n(f.)g(The)o
(y)f(b)n(uild)h(and)f(b)n(uild)h(and)g(b)n(uild)479 911
y(and)g(end-up)e(with)j(massi)n(v)o(e,)e(perfectly-designed)e(comple)o
(xity)-5 b(.)-2 929 y
SDict begin H.S end
 -2 929 a -2 929 a
SDict begin 13 H.A end
 -2 929 a -2 929
a
SDict begin [/View [/XYZ H.V]/Dest (0:3345) cvn /DEST pdfmark end
 -2 929 a Black 396 1060 a Fe(\225)p Black 479 1060
a
SDict begin H.S end
 479 1060 a 479 1060 a
SDict begin 13 H.A end
 479 1060 a 479 1060 a
SDict begin [/View [/XYZ H.V]/Dest (0:3346) cvn /DEST pdfmark end
 479 1060
a Fj(The)20 b(products)f(go)h(to)g(mark)o(et,)f(and)h(the)g(mark)o(et)f
(scratches)i(its)g(head)e(and)h(asks,)g("seriously)-5
b(,)19 b(is)i(this)g(the)f(best)h(you)479 1168 y(can)f(do?")g(People)g
(do)f(use)i(the)f(products,)e(especially)i(if)h(the)o(y)e(aren')o(t)g
(spending)f(their)i(o)n(wn)g(mone)o(y)f(in)h(climbing)479
1276 y(the)g(learning)f(curv)o(e.)-2 1294 y
SDict begin H.S end
 -2 1294 a
-2 1294 a
SDict begin 13 H.A end
 -2 1294 a -2 1294 a
SDict begin [/View [/XYZ H.V]/Dest (0:3347) cvn /DEST pdfmark end
 -2 1294 a Black 396 1426
a Fe(\225)p Black 479 1426 a
SDict begin H.S end
 479 1426 a 479 1426 a
SDict begin 13 H.A end
 479
1426 a 479 1426 a
SDict begin [/View [/XYZ H.V]/Dest (0:3348) cvn /DEST pdfmark end
 479 1426 a Fj(Management)f(gets)j(positi)n(v)o(e)e
(feedback)g(from)g(its)i(lar)o(ger)e(customers,)g(who)h(share)g(the)g
(same)g(idea)g(that)h(high)e(cost)479 1534 y(\(in)h(training)f(and)h
(use\))g(means)g(high)f(v)n(alue.)h(and)f(so)i(continues)e(to)h(push)g
(the)g(process.)-2 1552 y
SDict begin H.S end
 -2 1552 a -2 1552 a
SDict begin 13 H.A end
 -2 1552
a -2 1552 a
SDict begin [/View [/XYZ H.V]/Dest (0:3349) cvn /DEST pdfmark end
 -2 1552 a Black 396 1683 a Fe(\225)p Black
479 1683 a
SDict begin H.S end
 479 1683 a 479 1683 a
SDict begin 13 H.A end
 479 1683 a 479 1683
a
SDict begin [/View [/XYZ H.V]/Dest (0:3350) cvn /DEST pdfmark end
 479 1683 a Fj(Meanwhile)g(some)n(where)e(across)j(the)f(w)o(orld,)f
(a)i(small)f(team)h(is)g(solving)e(the)h(same)g(problem)f(using)h(a)g
(better)479 1791 y(process,)g(and)f(a)i(year)f(later)g(smashes)g(the)h
(mark)o(et)e(to)h(little)h(pieces.)-2 1975 y
SDict begin H.S end
 -2 1975
a -2 1975 a
SDict begin 13 H.A end
 -2 1975 a -2 1975 a
SDict begin [/View [/XYZ H.V]/Dest (0:3351) cvn /DEST pdfmark end
 -2 1975 a 396 2065 a
Fj(COD)g(is)g(characterized)e(by)g(a)i(team)f(obsessi)n(v)o(ely)f
(solving)h(the)g(wrong)f(problems)g(to)h(the)g(point)g(of)f(collecti)n
(v)o(e)396 2173 y(insanity)-5 b(.)19 b(COD)i(products)e(tend)h(to)g(be)
g(lar)o(ge,)f(ambitious,)g(comple)o(x,)f(and)i(unpopular)-5
b(.)18 b(Much)h(open)g(source)h(softw)o(are)396 2281
y(is)h(the)e(output)f(of)h(COD)i(processes.)e(It)g(is)i(insanely)d
(hard)h(for)g(engineers)f(to)2619 2281 y
SDict begin H.S end
 2619 2281 a
2619 2281 a
SDict begin 13 H.A end
 2619 2281 a 2619 2281 a
SDict begin [/View [/XYZ H.V]/Dest (0:3352) cvn /DEST pdfmark end
 2619 2281 a Fk(stop)h
Fj(e)o(xtending)e(a)j(design)f(to)h(co)o(v)o(er)e(more)396
2389 y(potential)h(problems.)f(The)o(y)h(ar)o(gue,)f("what)h(if)h
(someone)f(w)o(ants)h(to)g(do)f(X?")h(b)n(ut)g(ne)n(v)o(er)e(ask)i
(themselv)o(es,)f("what)g(is)i(the)396 2497 y(real)f(v)n(alue)g(of)g
(solving)f(X?")-2 2681 y
SDict begin H.S end
 -2 2681 a -2 2681 a
SDict begin 13 H.A end
 -2 2681
a -2 2681 a
SDict begin [/View [/XYZ H.V]/Dest (0:3353) cvn /DEST pdfmark end
 -2 2681 a 396 2771 a Fj(A)i(good)e(e)o(xample)g(of)g(COD)i
(in)g(practice)e(is)i(Bluetooth,)e(a)i(comple)o(x,)d(o)o(v)o(er)n
(-designed)f(set)k(of)f(protocols)f(that)h(users)396
2879 y(hate.)g(It)h(continues)e(to)h(e)o(xist)g(only)g(because)f(in)h
(a)h(massi)n(v)o(ely-patented)d(industry)g(there)i(are)g(no)g(real)g
(alternati)n(v)o(es.)396 2987 y(Bluetooth)g(is)h(perfectly)d(secure,)i
(which)g(is)h(close)f(to)h(pointless)e(for)h(a)h(proximity)d(protocol.)
g(At)j(the)f(same)h(time)f(it)396 3094 y(lacks)h(a)f(standard)f(API)i
(for)e(de)n(v)o(elopers,)f(meaning)h(it')-5 b(s)21 b(really)f(costly)g
(to)g(use)h(Bluetooth)e(in)h(applications.)-2 3278 y
SDict begin H.S end

-2 3278 a -2 3278 a
SDict begin 13 H.A end
 -2 3278 a -2 3278 a
SDict begin [/View [/XYZ H.V]/Dest (0:3354) cvn /DEST pdfmark end
 -2 3278 a 396
3368 a Fj(On)g(the)f(#zeromq)f(IRC)i(channel,)e(W)m(intre)h(once)g
(wrote)g(of)g(ho)n(w)g(enraged)f(he)h(w)o(as)h(man)o(y)e(years)i(ago)e
(when)h(he)h("found)396 3476 y(that)h(XMMS)f(2)g(had)g(a)h(w)o(orking)d
(plugin)h(system)i(b)n(ut)f(could)f(not)h(actually)f(play)h(music.")-2
3660 y
SDict begin H.S end
 -2 3660 a -2 3660 a
SDict begin 13 H.A end
 -2 3660 a -2 3660 a
SDict begin [/View [/XYZ H.V]/Dest (0:3355) cvn /DEST pdfmark end
 -2 3660
a 396 3750 a Fj(COD)h(is)g(a)g(form)e(of)h(lar)o(ge-scale)f("rabbit)g
(holing",)g(in)h(which)g(designers)f(and)h(engineers)f(cannot)g
(distance)396 3858 y(themselv)o(es)h(from)e(the)j(technical)e(details)h
(of)g(their)g(w)o(ork.)f(The)o(y)g(add)g(more)g(and)h(more)f(features,)
g(utterly)g(misreading)396 3966 y(the)h(economics)f(of)h(their)g(w)o
(ork.)-2 4133 y
SDict begin H.S end
 -2 4133 a -2 4133 a
SDict begin 13 H.A end
 -2 4133 a -2 4133
a
SDict begin [/View [/XYZ H.V]/Dest (0:3356) cvn /DEST pdfmark end
 -2 4133 a 396 4240 a Fj(The)g(main)g(lessons)h(of)e(COD)i(are)g(also)
f(simple)g(b)n(ut)g(hard)g(for)f(e)o(xperts)h(to)g(sw)o(allo)n(w)-5
b(.)20 b(The)o(y)f(are:)-2 4258 y
SDict begin H.S end
 -2 4258 a -2 4258 a
SDict begin 13 H.A end

-2 4258 a -2 4258 a
SDict begin [/View [/XYZ H.V]/Dest (0:3357) cvn /DEST pdfmark end
 -2 4258 a -2 4268 a
SDict begin H.S end
 -2 4268 a -2
4268 a
SDict begin 13 H.A end
 -2 4268 a -2 4268 a
SDict begin [/View [/XYZ H.V]/Dest (0:3358) cvn /DEST pdfmark end
 -2 4268 a Black 396 4410 a
Fe(\225)p Black 479 4410 a
SDict begin H.S end
 479 4410 a 479 4410 a
SDict begin 13 H.A end
 479
4410 a 479 4410 a
SDict begin [/View [/XYZ H.V]/Dest (0:3359) cvn /DEST pdfmark end
 479 4410 a Fj(Making)g(stuf)n(f)h(that)g(you)g(don')o
(t)e(immediately)h(ha)n(v)o(e)h(a)g(need)g(for)f(is)j(pointless.)d
(Doesn')o(t)g(matter)h(ho)n(w)g(talented)f(or)479 4518
y(brilliant)h(you)f(are,)h(if)h(you)e(just)i(sit)g(do)n(wn)e(and)h(mak)
o(e)f(stuf)n(f)h(people)f(are)h(not)g(actually)g(asking)f(for)m(,)g
(you)h(are)g(most)479 4626 y(lik)o(ely)g(w)o(asting)h(your)d(time.)-2
4644 y
SDict begin H.S end
 -2 4644 a -2 4644 a
SDict begin 13 H.A end
 -2 4644 a -2 4644 a
SDict begin [/View [/XYZ H.V]/Dest (0:3360) cvn /DEST pdfmark end
 -2 4644
a Black 396 4776 a Fe(\225)p Black 479 4776 a
SDict begin H.S end
 479 4776
a 479 4776 a
SDict begin 13 H.A end
 479 4776 a 479 4776 a
SDict begin [/View [/XYZ H.V]/Dest (0:3361) cvn /DEST pdfmark end
 479 4776 a Fj(Problems)i(are)g(not)g
(equal.)f(Some)h(are)g(simple,)g(and)g(some)g(are)g(comple)o(x.)e
(Ironically)-5 b(,)18 b(solving)h(the)h(simpler)479 4884
y(problems)f(often)g(has)i(more)e(v)n(alue)h(to)g(more)f(people)h(than)
f(solving)g(the)i(really)e(hard)h(ones.)f(So)i(if)f(you)g(allo)n(w)479
4992 y(engineers)f(to)i(just)f(w)o(ork)g(on)g(random)e(things,)h(the)o
(y')o(ll)h(most)g(focus)g(on)f(the)i(most)f(interesting)f(b)n(ut)h
(least)479 5099 y(w)o(orthwhile)f(things.)-2 5117 y
SDict begin H.S end
 -2
5117 a -2 5117 a
SDict begin 13 H.A end
 -2 5117 a -2 5117 a
SDict begin [/View [/XYZ H.V]/Dest (0:3362) cvn /DEST pdfmark end
 -2 5117 a Black
3759 5569 a Fi(259)p Black eop end
%%Page: 260 274
TeXDict begin 260 273 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.260) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3363) cvn /DEST pdfmark end
 479 72 a Fj(Engineers)g(and)h(designers)f
(lo)o(v)o(e)g(to)i(mak)o(e)e(stuf)n(f)h(and)g(decoration,)e(and)h(this)
i(ine)n(vitably)e(leads)h(to)h(comple)o(xity)-5 b(.)17
b(It)479 180 y(is)k(crucial)f(to)g(ha)n(v)o(e)g(a)h("stop)f
(mechanism",)e(a)j(w)o(ay)f(to)g(set)h(short,)f(hard)f(deadlines)h
(that)g(force)f(people)g(to)i(mak)o(e)479 288 y(smaller)m(,)f(simpler)g
(answers)g(to)g(just)h(the)f(most)g(crucial)g(problems.)-2
348 y
SDict begin H.S end
 -2 348 a -2 348 a
SDict begin 13 H.A end
 -2 348 a -2 348 a
SDict begin [/View [/XYZ H.V]/Dest (0:3364) cvn /DEST pdfmark end
 -2 348 a 396
658 a Fd(6.4.3.)36 b(Simplicity-Oriented)f(Design)2255
658 y
SDict begin H.S end
 2255 658 a 2255 658 a
SDict begin 18.72 H.A end
 2255 658 a 2255 658 a
SDict begin [/View [/XYZ H.V]/Dest (11.63.42.2) cvn /DEST pdfmark end
 2255
658 a -2 851 a
SDict begin H.S end
 -2 851 a -2 851 a
SDict begin 13 H.A end
 -2 851 a -2 851 a
SDict begin [/View [/XYZ H.V]/Dest (0:3366) cvn /DEST pdfmark end
 -2
851 a 396 932 a Fj(Finally)-5 b(,)20 b(we)g(come)g(to)g(the)g(rare)g(b)
n(ut)g(precious)f(Simplicity-Oriented)f(Design.)i(This)g(process)g
(starts)h(with)f(a)396 1040 y(realization:)g(we)g(do)g(not)g(kno)n(w)f
(what)h(we)h(ha)n(v)o(e)e(to)i(mak)o(e)e(until)h(after)g(we)h(start)f
(making)f(it.)i(Coming)e(up)h(with)g(ideas,)396 1148
y(or)g(lar)o(ge-scale)f(designs)h(isn')o(t)g(just)g(w)o(asteful,)g(it')
-5 b(s)22 b(a)e(direct)g(hindrance)e(to)j(designing)d(the)i(truly)g
(accurate)f(solutions.)396 1256 y(The)h(really)f(juic)o(y)g(problems)f
(are)i(hidden)e(lik)o(e)i(f)o(ar)g(v)n(alle)o(ys,)f(and)g(an)o(y)g
(acti)n(vity)g(e)o(xcept)g(acti)n(v)o(e)g(scouting)g(creates)g(a)i(fog)
396 1364 y(that)g(hides)f(those)g(distant)g(v)n(alle)o(ys.)f(Y)-9
b(ou)20 b(need)f(to)i(k)o(eep)e(mobile,)g(pack)h(light,)g(and)f(mo)o(v)
o(e)g(f)o(ast.)-2 1548 y
SDict begin H.S end
 -2 1548 a -2 1548 a
SDict begin 13 H.A end
 -2 1548
a -2 1548 a
SDict begin [/View [/XYZ H.V]/Dest (0:3367) cvn /DEST pdfmark end
 -2 1548 a 396 1638 a Fj(SOD)i(w)o(orks)f(as)h(follo)n(ws:)
-2 1639 y
SDict begin H.S end
 -2 1639 a -2 1639 a
SDict begin 13 H.A end
 -2 1639 a -2 1639 a
SDict begin [/View [/XYZ H.V]/Dest (0:3368) cvn /DEST pdfmark end
 -2
1639 a -2 1649 a
SDict begin H.S end
 -2 1649 a -2 1649 a
SDict begin 13 H.A end
 -2 1649 a -2 1649
a
SDict begin [/View [/XYZ H.V]/Dest (0:3369) cvn /DEST pdfmark end
 -2 1649 a Black 396 1808 a Fe(\225)p Black 479 1808
a
SDict begin H.S end
 479 1808 a 479 1808 a
SDict begin 13 H.A end
 479 1808 a 479 1808 a
SDict begin [/View [/XYZ H.V]/Dest (0:3370) cvn /DEST pdfmark end
 479 1808
a Fj(W)-7 b(e)22 b(collect)e(a)g(set)h(of)f(interesting)g(problems)e
(\(by)i(looking)e(at)j(ho)n(w)f(people)f(use)h(technology)e(or)i(other)
f(products\))479 1916 y(and)h(we)g(line)h(these)f(up)g(from)f(simple)h
(to)h(comple)o(x,)d(looking)g(for)i(and)f(identifying)g(patterns)g(of)h
(use.)-2 1934 y
SDict begin H.S end
 -2 1934 a -2 1934 a
SDict begin 13 H.A end
 -2 1934 a -2 1934
a
SDict begin [/View [/XYZ H.V]/Dest (0:3371) cvn /DEST pdfmark end
 -2 1934 a Black 396 2065 a Fe(\225)p Black 479 2065
a
SDict begin H.S end
 479 2065 a 479 2065 a
SDict begin 13 H.A end
 479 2065 a 479 2065 a
SDict begin [/View [/XYZ H.V]/Dest (0:3372) cvn /DEST pdfmark end
 479 2065
a Fj(W)-7 b(e)22 b(tak)o(e)e(the)g(simplest,)g(most)h(dramatic)e
(problem)f(and)i(we)h(solv)o(e)e(this)i(with)f(a)h(minimal)f(plausible)
f(solution,)g(or)479 2173 y("patch".)g(Each)h(patch)g(solv)o(es)g(e)o
(xactly)f(a)i(genuine)d(and)i(agreed)f(problem)f(in)j(a)f(brutally)f
(minimal)h(f)o(ashion.)-2 2191 y
SDict begin H.S end
 -2 2191 a -2 2191 a
SDict begin 13 H.A end

-2 2191 a -2 2191 a
SDict begin [/View [/XYZ H.V]/Dest (0:3373) cvn /DEST pdfmark end
 -2 2191 a Black 396 2323 a Fe(\225)p
Black 479 2323 a
SDict begin H.S end
 479 2323 a 479 2323 a
SDict begin 13 H.A end
 479 2323 a 479
2323 a
SDict begin [/View [/XYZ H.V]/Dest (0:3374) cvn /DEST pdfmark end
 479 2323 a Fj(W)-7 b(e)22 b(apply)d(one)h(measure)f(of)h
(quality)f(to)i(patches,)e(namely)g("can)h(this)h(be)f(done)f(an)o(y)g
(simpler)h(while)g(still)i(solving)479 2430 y(the)e(stated)h(problem?")
d(W)-7 b(e)21 b(can)f(measure)g(comple)o(xity)e(in)i(terms)h(of)e
(concepts)h(and)f(models)h(that)g(the)g(user)g(has)h(to)479
2538 y(learn)f(or)g(guess)g(in)g(order)f(to)i(use)f(the)g(patch.)g(The)
g(fe)n(wer)m(,)f(the)h(better)-5 b(.)20 b(A)h(perfect)e(patch)g(solv)o
(es)h(a)h(problem)d(with)479 2646 y(zero)i(learning)f(required)f(by)i
(the)g(user)-5 b(.)-2 2664 y
SDict begin H.S end
 -2 2664 a -2 2664 a
SDict begin 13 H.A end
 -2 2664
a -2 2664 a
SDict begin [/View [/XYZ H.V]/Dest (0:3375) cvn /DEST pdfmark end
 -2 2664 a Black 396 2796 a Fe(\225)p Black
479 2796 a
SDict begin H.S end
 479 2796 a 479 2796 a
SDict begin 13 H.A end
 479 2796 a 479 2796
a
SDict begin [/View [/XYZ H.V]/Dest (0:3376) cvn /DEST pdfmark end
 479 2796 a Fj(Our)20 b(product)f(de)n(v)o(elopment)e(consists)j(of)g
(a)h(patch)f(that)g(solv)o(es)g(the)g(problem)f("we)h(need)f(a)i(proof)
e(of)g(concept")g(and)479 2904 y(then)h(e)n(v)n(olv)o(es)f(in)i(an)f
(unbrok)o(en)d(line)k(to)f(a)h(mature)e(series)i(of)f(products,)e
(through)g(hundreds)g(or)i(thousands)f(of)479 3012 y(patches)h(piled)g
(on)g(top)f(of)h(each)g(other)-5 b(.)-2 3030 y
SDict begin H.S end
 -2 3030
a -2 3030 a
SDict begin 13 H.A end
 -2 3030 a -2 3030 a
SDict begin [/View [/XYZ H.V]/Dest (0:3377) cvn /DEST pdfmark end
 -2 3030 a Black 396 3161
a Fe(\225)p Black 479 3161 a
SDict begin H.S end
 479 3161 a 479 3161 a
SDict begin 13 H.A end
 479
3161 a 479 3161 a
SDict begin [/View [/XYZ H.V]/Dest (0:3378) cvn /DEST pdfmark end
 479 3161 a Fj(W)e(e)22 b(do)d(not)h(do)943
3161 y
SDict begin H.S end
 943 3161 a 943 3161 a
SDict begin 13 H.A end
 943 3161 a 943 3161 a
SDict begin [/View [/XYZ H.V]/Dest (0:3379) cvn /DEST pdfmark end
 943
3161 a Fi(anything)e Fj(that)j(is)g(not)f(a)g(patch.)g(W)-7
b(e)21 b(enforce)e(this)h(rule)g(with)h(formal)e(processes)h(that)g
(demand)e(that)479 3269 y(e)n(v)o(ery)h(acti)n(vity)h(or)g(task)g(is)h
(tied)g(to)f(a)h(genuine)d(and)i(agreed)f(problem,)f(e)o(xplicitly)h
(enunciated)g(and)g(documented.)-2 3287 y
SDict begin H.S end
 -2 3287 a -2
3287 a
SDict begin 13 H.A end
 -2 3287 a -2 3287 a
SDict begin [/View [/XYZ H.V]/Dest (0:3380) cvn /DEST pdfmark end
 -2 3287 a Black 396 3418 a
Fe(\225)p Black 479 3418 a
SDict begin H.S end
 479 3418 a 479 3418 a
SDict begin 13 H.A end
 479
3418 a 479 3418 a
SDict begin [/View [/XYZ H.V]/Dest (0:3381) cvn /DEST pdfmark end
 479 3418 a Fj(W)-7 b(e)22 b(b)n(uild)d(our)h
(projects)f(into)h(a)h(supply)e(chain)h(where)f(each)h(project)f(can)h
(pro)o(vide)f(problems)f(to)j(its)g("suppliers")479 3526
y(and)f(recei)n(v)o(e)f(patches)h(in)g(return.)f(The)h(supply)f(chain)g
(creates)i(the)f("stop)g(mechanism")f(since)h(when)g(people)f(are)479
3634 y(impatiently)g(w)o(aiting)h(for)g(an)g(answer)m(,)f(we)i
(necessarily)e(cut)i(our)e(w)o(ork)h(short.)-2 3652 y
SDict begin H.S end

-2 3652 a -2 3652 a
SDict begin 13 H.A end
 -2 3652 a -2 3652 a
SDict begin [/View [/XYZ H.V]/Dest (0:3382) cvn /DEST pdfmark end
 -2 3652 a Black
396 3784 a Fe(\225)p Black 479 3784 a
SDict begin H.S end
 479 3784 a 479
3784 a
SDict begin 13 H.A end
 479 3784 a 479 3784 a
SDict begin [/View [/XYZ H.V]/Dest (0:3383) cvn /DEST pdfmark end
 479 3784 a Fj(Indi)n(viduals)e(are)h(free)
g(to)h(w)o(ork)f(on)g(an)o(y)g(projects,)g(and)g(pro)o(vide)e(patches)i
(at)h(an)o(y)f(place)g(the)o(y)g(feel)g(it')-5 b(s)21
b(w)o(orthwhile.)479 3892 y(No)f(indi)n(viduals)f("o)n(wn")h(an)o(y)f
(project,)g(e)o(xcept)g(to)i(enforce)d(the)i(formal)g(processes.)f(A)i
(single)f(project)f(can)h(ha)n(v)o(e)479 4000 y(man)o(y)f(v)n
(ariations,)g(each)h(a)h(collection)e(of)h(dif)n(ferent,)e(competing)g
(patches.)-2 4018 y
SDict begin H.S end
 -2 4018 a -2 4018 a
SDict begin 13 H.A end
 -2 4018 a -2
4018 a
SDict begin [/View [/XYZ H.V]/Dest (0:3384) cvn /DEST pdfmark end
 -2 4018 a Black 396 4149 a Fe(\225)p Black 479
4149 a
SDict begin H.S end
 479 4149 a 479 4149 a
SDict begin 13 H.A end
 479 4149 a 479 4149 a
SDict begin [/View [/XYZ H.V]/Dest (0:3385) cvn /DEST pdfmark end
 479
4149 a Fj(Projects)j(e)o(xport)d(formal)h(and)h(documented)d(interf)o
(aces)j(so)h(that)f(upstream)f(\(client\))h(projects)f(are)h(una)o(w)o
(are)f(of)479 4257 y(change)g(happening)f(in)i(supplier)f(projects.)h
(Thus)g(multiple)f(supplier)g(projects)h(can)g(compete)f(for)h(client)g
(projects,)479 4365 y(in)h(ef)n(fect)e(creating)g(a)i(free)f(and)f
(competiti)n(v)o(e)g(mark)o(et.)-2 4383 y
SDict begin H.S end
 -2 4383 a -2
4383 a
SDict begin 13 H.A end
 -2 4383 a -2 4383 a
SDict begin [/View [/XYZ H.V]/Dest (0:3386) cvn /DEST pdfmark end
 -2 4383 a Black 396 4514 a
Fe(\225)p Black 479 4514 a
SDict begin H.S end
 479 4514 a 479 4514 a
SDict begin 13 H.A end
 479
4514 a 479 4514 a
SDict begin [/View [/XYZ H.V]/Dest (0:3387) cvn /DEST pdfmark end
 479 4514 a Fj(W)-7 b(e)22 b(tie)e(our)g(supply)f
(chain)h(to)g(real)g(users)g(and)g(e)o(xternal)f(clients)i(and)e(we)i
(dri)n(v)o(e)e(the)h(whole)g(process)f(by)h(rapid)479
4622 y(c)o(ycles)g(so)h(that)f(a)h(problem)d(recei)n(v)o(ed)h(from)g
(outside)h(users)g(can)g(be)g(analyzed,)f(e)n(v)n(aluated,)f(and)i
(solv)o(ed)f(with)h(a)479 4730 y(patch)g(in)g(a)h(fe)n(w)f(hours.)-2
4748 y
SDict begin H.S end
 -2 4748 a -2 4748 a
SDict begin 13 H.A end
 -2 4748 a -2 4748 a
SDict begin [/View [/XYZ H.V]/Dest (0:3388) cvn /DEST pdfmark end
 -2 4748
a Black 396 4880 a Fe(\225)p Black 479 4880 a
SDict begin H.S end
 479 4880
a 479 4880 a
SDict begin 13 H.A end
 479 4880 a 479 4880 a
SDict begin [/View [/XYZ H.V]/Dest (0:3389) cvn /DEST pdfmark end
 479 4880 a Fj(At)h(e)n(v)o(ery)e
(moment)g(from)g(the)h(v)o(ery)f(\002rst)i(patch,)e(our)h(product)e(is)
j(shippable.)e(This)h(is)i(essential,)e(because)g(a)g(lar)o(ge)479
4988 y(proportion)e(of)h(patches)h(will)h(be)f(wrong)f(\(10-30\045\))f
(and)i(only)f(by)h(gi)n(ving)f(the)h(product)e(to)j(users)f(can)g(we)h
(kno)n(w)479 5095 y(which)f(patches)g(ha)n(v)o(e)f(become)g(problems)g
(and)h(themselv)o(es)f(need)h(solving.)p Black 3759 5569
a Fi(260)p Black eop end
%%Page: 261 275
TeXDict begin 261 274 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.261) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3390) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(SOD)i(is)g(a)g(form)e(of)h("hill)g(climbing)f
(algorithm",)f(a)j(reliable)f(w)o(ay)g(of)g(\002nding)f(optimal)g
(solutions)h(to)g(the)h(most)396 180 y(signi\002cant)f(problems)f(in)h
(an)g(unkno)n(wn)e(landscape.)h(Y)-9 b(ou)19 b(don')o(t)g(need)g(to)i
(be)f(a)g(genius)g(to)g(use)h(SOD)g(successfully)-5 b(,)396
288 y(you)20 b(just)g(need)g(to)g(be)g(able)g(to)h(see)f(the)h(dif)n
(ference)d(between)h(the)h(fog)g(of)g(acti)n(vity)f(and)h(the)g
(progress)f(to)n(w)o(ards)h(ne)n(w)396 396 y(real)g(problems.)-2
580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:3391) cvn /DEST pdfmark end
 -2 580 a 396
670 a Fj(A)h(really)f(good)f(designer)g(with)h(a)h(good)d(team)j(can)f
(use)g(SOD)h(to)f(b)n(uild)g(w)o(orld-class)g(products,)e(rapidly)h
(and)396 778 y(accurately)-5 b(.)18 b(T)-7 b(o)20 b(get)g(the)g(most)g
(out)f(of)h(SOD,)g(the)g(designer)e(has)i(to)g(use)g(the)g(product)e
(continuously)-5 b(,)17 b(from)h(day)i(1,)f(and)396 886
y(de)n(v)o(elop)g(his)h(or)g(her)g(ability)g(to)g(smell)h(out)f
(problems)e(such)i(as)h(inconsistenc)o(y)-5 b(,)18 b(surprising)h(beha)
n(vior)m(,)f(and)i(other)396 994 y(forms)g(of)g(friction.)e(W)-7
b(e)22 b(naturally)d(o)o(v)o(erlook)e(man)o(y)i(anno)o(yances)f(b)n(ut)
i(a)h(good)e(designer)g(picks)h(these)g(up,)g(and)f(thinks)396
1102 y(about)g(ho)n(w)h(to)g(patch)g(them.)g(Design)g(is)h(about)e
(remo)o(ving)f(friction)h(in)h(the)g(use)h(of)f(a)g(product.)-2
1286 y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286 a -2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:3392) cvn /DEST pdfmark end
 -2 1286
a 396 1376 a Fj(In)g(an)g(open)f(source)h(setting,)g(we)g(do)g(this)h
(w)o(ork)e(in)i(public.)e(There')-5 b(s)20 b(no)f("let')-5
b(s)21 b(open)f(the)g(code")f(moment.)g(Projects)396
1484 y(that)i(do)e(this)i(are)f(in)h(my)e(vie)n(w)h(missing)h(the)f
(point)f(of)h(open)f(source,)g(which)h(is)h(to)g(engage)d(your)h(users)
h(in)h(your)396 1592 y(e)o(xploration,)d(and)h(to)i(b)n(uild)e
(community)f(around)h(the)h(seed)g(of)g(the)g(architecture.)-2
1703 y
SDict begin H.S end
 -2 1703 a -2 1703 a
SDict begin 13 H.A end
 -2 1703 a -2 1703 a
SDict begin [/View [/XYZ H.V]/Dest (0:3393) cvn /DEST pdfmark end
 -2 1703
a 359 x Fh(6.5.)39 b(Messa)o(g)q(e)f(Oriented)g(P)l(attern)f(f)m(or)j
(Elastic)e(Design)3293 2062 y
SDict begin H.S end
 3293 2062 a 3293 2062 a
SDict begin 22.464 H.A end

3293 2062 a 3293 2062 a
SDict begin [/View [/XYZ H.V]/Dest (11.64.1) cvn /DEST pdfmark end
 3293 2062 a -2 2260 a
SDict begin H.S end
 -2 2260
a -2 2260 a
SDict begin 13 H.A end
 -2 2260 a -2 2260 a
SDict begin [/View [/XYZ H.V]/Dest (0:3395) cvn /DEST pdfmark end
 -2 2260 a 396 2336 a
Fj(No)n(w)20 b(I')o(ll)h(introduce)d(MOPED,)i(which)g(is)h(a)g(SOD)f
(pattern)g(custom-designed)d(for)j(\330MQ)g(architectures.)f(It)h(w)o
(as)396 2444 y(either)g(MOPED)g(or)g(BIKE,)h(the)f(Backron)o
(ym-Induced)15 b(Kinetic)20 b(Ef)n(fect.)f(That')-5 b(s)20
b(short)g(for)g(BICICLE,)g(the)396 2552 y(Backron)o(ym-In\003ated)c
(See)21 b(if)g(I)f(Care)g(Less)h(Ef)n(fect.)f(In)g(life,)g(one)f
(learns)h(to)h(go)e(with)i(the)f(least)h(embarrassing)396
2660 y(choices.)-2 2827 y
SDict begin H.S end
 -2 2827 a -2 2827 a
SDict begin 13 H.A end
 -2 2827
a -2 2827 a
SDict begin [/View [/XYZ H.V]/Dest (0:3396) cvn /DEST pdfmark end
 -2 2827 a 396 2934 a Fj(Speaking)e(of)h(embarrassments,)e
(just)j(as)g(\330MQ)f(lets)h(us)g(aim)f(for)g(really)g(massi)n(v)o(e)g
(architectures,)e(it)j(also,)f(lik)o(e)h(an)o(y)396 3042
y(technology)d(that)i(remo)o(v)o(es)f(friction,)g(opens)g(the)h(door)f
(to)i(truly)e(massi)n(v)o(e)h(blunders.)f(If)h(\330MQ)g(is)h(the)f(A)m
(CME)396 3150 y(rock)o(et-propelled)d(shoe)j(of)g(distrib)n(uted)f
(softw)o(are)h(de)n(v)o(elopment,)d(a)j(lot)h(of)f(us)g(are)g(lik)o(e)h
(W)m(ile)g(E.)f(Co)o(yote,)g(slamming)396 3258 y(full)g(speed)g(into)g
(the)g(pro)o(v)o(erbial)e(desert)i(clif)n(f.)-2 3442
y
SDict begin H.S end
 -2 3442 a -2 3442 a
SDict begin 13 H.A end
 -2 3442 a -2 3442 a
SDict begin [/View [/XYZ H.V]/Dest (0:3397) cvn /DEST pdfmark end
 -2 3442 a 396
3532 a Fj(So)h(MOPED)f(is)h(meant)f(to)g(sa)n(v)o(e)h(us)f(from)f(such)
h(mistak)o(es.)g(P)o(artly)g(it')-5 b(s)22 b(about)d(slo)n(wing)g(do)n
(wn,)g(partly)h(it')-5 b(s)21 b(about)396 3640 y(ensuring)e(that)h
(when)g(you)f(mo)o(v)o(e)g(f)o(ast,)h(you)g(go)f(-)i(and)f(this)g(is)h
(essential,)g(dear)e(reader)h(-)g(in)g(the)3188 3640
y
SDict begin H.S end
 3188 3640 a 3188 3640 a
SDict begin 13 H.A end
 3188 3640 a 3188 3640 a
SDict begin [/View [/XYZ H.V]/Dest (0:3398) cvn /DEST pdfmark end
 3188
3640 a Fi(right)g(dir)m(ection)p Fj(.)f(It')-5 b(s)396
3748 y(my)20 b(standard)f(intervie)n(w)g(riddle:)h(what')-5
b(s)20 b(the)h(rarest)f(property)e(of)i(an)o(y)f(softw)o(are)h(system,)
g(the)g(absolute)g(hardest)396 3856 y(thing)g(to)g(get)g(right,)g(the)g
(lack)g(of)g(which)f(causes)i(the)f(slo)n(w)h(or)f(f)o(ast)g(death)g
(of)g(the)g(v)n(ast)g(majority)g(of)f(projects?)h(The)396
3964 y(answer)g(is)h(not)f(code)g(quality)-5 b(,)18 b(funding,)g
(performance,)f(or)j(e)n(v)o(en)f(\(though)f(it')-5 b(s)22
b(a)e(close)h(answer\),)e(popularity)-5 b(.)17 b(The)396
4071 y(answer)j(is)h("accurac)o(y".)-2 4255 y
SDict begin H.S end
 -2 4255
a -2 4255 a
SDict begin 13 H.A end
 -2 4255 a -2 4255 a
SDict begin [/View [/XYZ H.V]/Dest (0:3399) cvn /DEST pdfmark end
 -2 4255 a 396 4345 a
Fj(If)f(you')l(v)o(e)e(read)i(the)g(Guide)g(observ)n(antly)e(you')o(ll)
h(ha)n(v)o(e)h(seen)g(MOPED)g(in)h(action)e(already)-5
b(.)19 b(The)h(de)n(v)o(elopment)d(of)396 4453 y(Majordomo)h(in)i
(Reliable)h(Request-Reply)e(P)o(atterns)p 0 TeXcolorgray
1973 4453 a
SDict begin H.S end
 1973 4453 a Fj(Chapter)g(4)2298 4453 y
SDict begin 13 H.L end
 2298
4453 a 2298 4453 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2298 4453 a Black 20 w Fj(is)i(a)g(near)n(-perfect)d
(case.)i(But)h(cute)f(names)g(are)396 4561 y(w)o(orth)g(a)g(thousand)f
(w)o(ords.)-2 4728 y
SDict begin H.S end
 -2 4728 a -2 4728 a
SDict begin 13 H.A end
 -2 4728 a -2
4728 a
SDict begin [/View [/XYZ H.V]/Dest (0:3401) cvn /DEST pdfmark end
 -2 4728 a 396 4835 a Fj(The)h(goal)g(of)g(MOPED)g(is)h(to)g
(de\002ne)e(a)i(process,)e(a)i(pattern)e(by)h(which)g(we)g(can)g(tak)o
(e)g(a)h(rough)e(use)h(case)h(for)e(a)i(ne)n(w)396 4943
y(distrib)n(uted)f(application,)e(and)i(go)f(from)h("hello)f(w)o(orld")
h(to)g(fully-w)o(orking)d(prototype)h(in)i(an)o(y)g(language)e(in)j
(under)d(a)396 5051 y(week.)p Black 3759 5569 a Fi(261)p
Black eop end
%%Page: 262 276
TeXDict begin 262 275 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.262) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3430) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3402) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Using)h(MOPED,)g(you)g(gro)n(w)-5 b(,)18
b(more)i(than)f(b)n(uild,)h(a)h(w)o(orking)d(\330MQ)j(architecture)d
(from)h(the)i(ground-up,)16 b(with)396 180 y(minimal)k(risk)g(of)g(f)o
(ailure.)f(By)i(focusing)e(on)g(the)i(contracts,)e(rather)g(than)h(the)
g(implementations,)e(you)h(a)n(v)n(oid)h(the)h(risk)396
288 y(of)f(premature)e(optimization.)h(By)h(dri)n(ving)f(the)h(design)g
(process)f(through)f(ultra-short)h(test-based)h(c)o(ycles,)g(you)f(can)
396 396 y(be)h(more)g(certain)f(what)i(you)e(ha)n(v)o(e)g(w)o(orks,)h
(before)f(you)g(add)h(more.)-2 580 y
SDict begin H.S end
 -2 580 a -2 580
a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:3403) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(W)-7 b(e)22
b(can)e(turn)f(this)i(into)f(\002)n(v)o(e)g(real)g(steps:)-2
688 y
SDict begin H.S end
 -2 688 a -2 688 a
SDict begin 13 H.A end
 -2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:3404) cvn /DEST pdfmark end
 -2 688 a -2
698 a
SDict begin H.S end
 -2 698 a -2 698 a
SDict begin 13 H.A end
 -2 698 a -2 698 a
SDict begin [/View [/XYZ H.V]/Dest (0:3405) cvn /DEST pdfmark end
 -2 698 a Black
396 840 a Fe(\225)p Black 479 840 a
SDict begin H.S end
 479 840 a 479 840
a
SDict begin 13 H.A end
 479 840 a 479 840 a
SDict begin [/View [/XYZ H.V]/Dest (0:3406) cvn /DEST pdfmark end
 479 840 a Fj(Step)h(1:)f(internalize)f(the)h
(\330MQ)h(semantics.)-2 858 y
SDict begin H.S end
 -2 858 a -2 858 a
SDict begin 13 H.A end
 -2 858
a -2 858 a
SDict begin [/View [/XYZ H.V]/Dest (0:3407) cvn /DEST pdfmark end
 -2 858 a Black 396 990 a Fe(\225)p Black 479
990 a
SDict begin H.S end
 479 990 a 479 990 a
SDict begin 13 H.A end
 479 990 a 479 990 a
SDict begin [/View [/XYZ H.V]/Dest (0:3408) cvn /DEST pdfmark end
 479 990
a Fj(Step)g(2:)f(dra)o(w)f(a)i(rough)e(architecture.)-2
1008 y
SDict begin H.S end
 -2 1008 a -2 1008 a
SDict begin 13 H.A end
 -2 1008 a -2 1008 a
SDict begin [/View [/XYZ H.V]/Dest (0:3409) cvn /DEST pdfmark end
 -2 1008
a Black 396 1139 a Fe(\225)p Black 479 1139 a
SDict begin H.S end
 479 1139
a 479 1139 a
SDict begin 13 H.A end
 479 1139 a 479 1139 a
SDict begin [/View [/XYZ H.V]/Dest (0:3410) cvn /DEST pdfmark end
 479 1139 a Fj(Step)i(3:)f(decide)f
(on)h(the)g(contracts.)-2 1157 y
SDict begin H.S end
 -2 1157 a -2 1157 a
SDict begin 13 H.A end

-2 1157 a -2 1157 a
SDict begin [/View [/XYZ H.V]/Dest (0:3411) cvn /DEST pdfmark end
 -2 1157 a Black 396 1289 a Fe(\225)p
Black 479 1289 a
SDict begin H.S end
 479 1289 a 479 1289 a
SDict begin 13 H.A end
 479 1289 a 479
1289 a
SDict begin [/View [/XYZ H.V]/Dest (0:3412) cvn /DEST pdfmark end
 479 1289 a Fj(Step)h(4:)f(mak)o(e)g(a)g(minimal)g(end-to-end)d
(solution.)-2 1307 y
SDict begin H.S end
 -2 1307 a -2 1307 a
SDict begin 13 H.A end
 -2 1307 a -2
1307 a
SDict begin [/View [/XYZ H.V]/Dest (0:3413) cvn /DEST pdfmark end
 -2 1307 a Black 396 1438 a Fe(\225)p Black 479
1438 a
SDict begin H.S end
 479 1438 a 479 1438 a
SDict begin 13 H.A end
 479 1438 a 479 1438 a
SDict begin [/View [/XYZ H.V]/Dest (0:3414) cvn /DEST pdfmark end
 479
1438 a Fj(Step)k(5:)f(solv)o(e)g(one)f(problem)g(and)h(repeat.)-2
1456 y
SDict begin H.S end
 -2 1456 a -2 1456 a
SDict begin 13 H.A end
 -2 1456 a -2 1456 a
SDict begin [/View [/XYZ H.V]/Dest (0:3415) cvn /DEST pdfmark end
 -2 1456
a 396 1766 a Fd(6.5.1.)36 b(Step)d(1:)g(Internaliz)q(e)i(the)f
(Semantics)2595 1766 y
SDict begin H.S end
 2595 1766 a 2595 1766 a
SDict begin 18.72 H.A end
 2595 1766
a 2595 1766 a
SDict begin [/View [/XYZ H.V]/Dest (11.64.43.2) cvn /DEST pdfmark end
 2595 1766 a -2 1957 a
SDict begin H.S end
 -2 1957 a -2 1957
a
SDict begin 13 H.A end
 -2 1957 a -2 1957 a
SDict begin [/View [/XYZ H.V]/Dest (0:3417) cvn /DEST pdfmark end
 -2 1957 a 396 2040 a Fj(T)-7 b(o)21
b(repeat)e(myself:)h(you)f(must)i(learn)e(\330MQ')-5
b(s)21 b(language.)d(The)i(only)g(w)o(ay)g(to)g(learn)g(a)g(language)f
(is)i(to)f(use)h(it.)f(There')-5 b(s)396 2148 y(no)20
b(w)o(ay)g(to)h(a)n(v)n(oid)f(this)g(in)m(v)o(estment,)f(no)g(tapes)i
(you)e(can)h(play)g(while)g(you)f(sleep,)h(no)g(chips)g(you)f(can)h
(plug)g(in)g(to)396 2256 y(magically)f(become)g(smarter)-5
b(.)20 b(Read)h(the)f(Guide,)f(w)o(ork)h(through)e(the)i(code)g(e)o
(xamples,)e(understand)g(what')-5 b(s)21 b(going)396
2364 y(on,)f(and)f(\(most)h(importantly\))e(write)j(some)f(e)o(xamples)
f(yourself,)f(and)i(then)2646 2364 y
SDict begin H.S end
 2646 2364 a 2646
2364 a
SDict begin 13 H.A end
 2646 2364 a 2646 2364 a
SDict begin [/View [/XYZ H.V]/Dest (0:3418) cvn /DEST pdfmark end
 2646 2364 a Fi(thr)l(ow)g(them)g(away)p
Fj(.)-2 2548 y
SDict begin H.S end
 -2 2548 a -2 2548 a
SDict begin 13 H.A end
 -2 2548 a -2 2548
a
SDict begin [/View [/XYZ H.V]/Dest (0:3419) cvn /DEST pdfmark end
 -2 2548 a 396 2638 a Fj(At)h(a)g(certain)e(point)h(you')o(ll)f(feel)h
(a)h(clicking)e(noise)h(in)g(your)f(brain.)h(Maybe)f(you')o(ll)g(ha)n
(v)o(e)h(a)g(weird)g(chili-induced)396 2746 y(dream)f(where)h(little)h
(\330MQ)g(tasks)f(run)g(around)e(trying)h(to)h(eat)h(you)e(ali)n(v)o
(e.)h(Maybe)f(you')o(ll)g(just)i(think)f("aaahh,)f(so)396
2854 y
SDict begin H.S end
 396 2854 a 396 2854 a
SDict begin 13 H.A end
 396 2854 a 396 2854 a
SDict begin [/View [/XYZ H.V]/Dest (0:3420) cvn /DEST pdfmark end
 396
2854 a Fi(that')m(s)h Fj(what)g(it)h(means!")e(If)h(we)h(did)f(our)f(w)
o(ork)h(right,)f(it)i(should)e(tak)o(e)h(2-3)g(days.)f(Ho)n(we)n(v)o
(er)g(long)g(it)i(tak)o(es,)g(until)f(you)396 2962 y(start)h(thinking)e
(in)h(terms)g(of)g(\330MQ)g(sock)o(ets)h(and)e(patterns,)h(you')l(re)e
(not)i(ready)f(for)h(step)g(2.)-2 2990 y
SDict begin H.S end
 -2 2990 a -2
2990 a
SDict begin 13 H.A end
 -2 2990 a -2 2990 a
SDict begin [/View [/XYZ H.V]/Dest (0:3421) cvn /DEST pdfmark end
 -2 2990 a 396 3300 a Fd(6.5.2.)36
b(Step)d(2:)g(Dra)n(w)h(a)g(Rough)g(Ar)n(c)o(hitecture)2696
3300 y
SDict begin H.S end
 2696 3300 a 2696 3300 a
SDict begin 18.72 H.A end
 2696 3300 a 2696 3300
a
SDict begin [/View [/XYZ H.V]/Dest (11.64.44.2) cvn /DEST pdfmark end
 2696 3300 a -2 3493 a
SDict begin H.S end
 -2 3493 a -2 3493 a
SDict begin 13 H.A end
 -2 3493 a
-2 3493 a
SDict begin [/View [/XYZ H.V]/Dest (0:3423) cvn /DEST pdfmark end
 -2 3493 a 396 3574 a Fj(Whiteboard)18 b(time.)i(Get)g(a)g
(couple)f(of)g(colleagues)g(and)g(try)h(to)f(dra)o(w)g(your)g
(architecture)f(on)h(a)h(whiteboard.)e(you)h(w)o(ant)396
3682 y(to)i(dra)o(w)e(box)o(es)g(connected)g(with)h(arro)n(ws,)f(sho)n
(wing)g(the)i(\003o)n(w)f(of)g(w)o(ork,)f(data,)h(results,)g(etc.)g
(Since)h(we)f(li)n(v)o(e)g(in)h(a)396 3790 y(gra)n(vity)f(well,)g(it')
-5 b(s)21 b(best)g(to)f(dra)o(w)g(the)g(main)g(arro)n(ws)f(going)g(do)n
(wn.)g(Almost)h(all)h(architectures)e(ha)n(v)o(e)h(a)3416
3790 y
SDict begin H.S end
 3416 3790 a 3416 3790 a
SDict begin 13 H.A end
 3416 3790 a 3416 3790
a
SDict begin [/View [/XYZ H.V]/Dest (0:3424) cvn /DEST pdfmark end
 3416 3790 a Fi(dir)m(ection)p Fj(,)f(and)396 3898 y(a)i(certain)f
(symmetry)-5 b(,)18 b(and)h(what)i(you)e(w)o(ant)h(to)g(do)g(is)h
(capture)e(that)i(as)g(simply)e(and)h(cleanly)g(as)h(you)e(can.)-2
4082 y
SDict begin H.S end
 -2 4082 a -2 4082 a
SDict begin 13 H.A end
 -2 4082 a -2 4082 a
SDict begin [/View [/XYZ H.V]/Dest (0:3425) cvn /DEST pdfmark end
 -2 4082
a 396 4172 a Fj(Ignore)g(an)o(ything)f(that')-5 b(s)20
b(not)g(central)g(to)g(the)h(core)e(problem.)f(Ignore)h(logging,)f
(error)h(handling,)f(reco)o(v)o(ery)g(from)396 4280 y(f)o(ailures,)i
(etc.)g(What)h(you)e(lea)n(v)o(e)h(out)g(is)h(as)g(important)e(as)i
(what)f(you)f(capture:)g(you)g(can)h(al)o(w)o(ays)h(add,)e(b)n(ut)i
(it')-5 b(s)21 b(v)o(ery)396 4388 y(hard)f(to)g(remo)o(v)o(e.)e(When)i
(you)f(ha)n(v)o(e)h(a)g(simple,)g(clean)g(dra)o(wing,)f(you')l(re)f
(ready)h(for)h(step)g(3.)-2 4416 y
SDict begin H.S end
 -2 4416 a -2 4416
a
SDict begin 13 H.A end
 -2 4416 a -2 4416 a
SDict begin [/View [/XYZ H.V]/Dest (0:3426) cvn /DEST pdfmark end
 -2 4416 a 396 4726 a Fd(6.5.3.)36
b(Step)d(3:)g(Decide)j(on)d(the)h(Contracts)2535 4726
y
SDict begin H.S end
 2535 4726 a 2535 4726 a
SDict begin 18.72 H.A end
 2535 4726 a 2535 4726 a
SDict begin [/View [/XYZ H.V]/Dest (11.64.45.2) cvn /DEST pdfmark end
 2535
4726 a -2 4917 a
SDict begin H.S end
 -2 4917 a -2 4917 a
SDict begin 13 H.A end
 -2 4917 a -2 4917
a
SDict begin [/View [/XYZ H.V]/Dest (0:3428) cvn /DEST pdfmark end
 -2 4917 a 396 5000 a Fj(Human)19 b(scale)i(depends)e(on)h(contracts,)
f(and)h(the)g(more)f(e)o(xplicit)h(the)o(y)f(are,)h(the)g(better)g
(things)g(scale.)g(Y)-9 b(ou)20 b(don')o(t)e(care)396
5108 y
SDict begin H.S end
 396 5108 a 396 5108 a
SDict begin 13 H.A end
 396 5108 a 396 5108 a
SDict begin [/View [/XYZ H.V]/Dest (0:3429) cvn /DEST pdfmark end
 396
5108 a Fi(how)i Fj(things)g(happen,)e(only)i(the)g(results.)g(If)g(I)h
(send)f(an)g(email,)g(I)g(don')o(t)f(care)h(ho)n(w)f(it)i(arri)n(v)o
(es)f(at)g(its)h(destination,)e(so)p Black 3759 5569
a Fi(262)p Black eop end
%%Page: 263 277
TeXDict begin 263 276 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.263) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(long)h(as)h(the)f(contract)f(\(it)h(arri)n(v)o(es)g
(within)g(a)g(fe)n(w)h(minutes,)e(it')-5 b(s)21 b(not)f(modi\002ed,)f
(it)i(doesn')o(t)d(get)j(lost\))f(is)h(respected.)396
346 y(And)f(to)g(b)n(uild)g(a)h(lar)o(ge)e(system)h(that)h(w)o(orks)e
(well,)i(you)e(must)h(focus)g(on)g(the)g(contracts,)f(before)g(the)396
454 y(implementations.)f(It)j(may)e(sound)g(ob)o(vious)f(b)n(ut)j(all)f
(too)g(often,)f(people)g(for)o(get)f(and)i(ignore)f(this,)h(or)g(are)g
(just)h(too)e(shy)396 562 y(to)i(impose)e(themselv)o(es.)g(I)i(wish)f
(I)h(could)e(say)h(\330MQ)h(had)f(done)f(this)h(properly)e(b)n(ut)j
(for)e(years)h(our)g(public)f(contracts)396 670 y(were)h(second-rate)f
(afterthoughts)f(instead)i(of)f(primary)g(in-your)n(-f)o(ace)f(pieces)i
(of)g(w)o(ork.)-2 854 y
SDict begin H.S end
 -2 854 a -2 854 a
SDict begin 13 H.A end
 -2 854 a -2
854 a
SDict begin [/View [/XYZ H.V]/Dest (0:3431) cvn /DEST pdfmark end
 -2 854 a 396 944 a Fj(So)h(what)f(is)h(a)g(contract)e(in)h(a)h
(distrib)n(uted)e(system?)h(There)g(are,)f(in)i(my)f(e)o(xperience,)d
(tw)o(o)k(types)f(of)g(contract:)-2 962 y
SDict begin H.S end
 -2 962 a -2
962 a
SDict begin 13 H.A end
 -2 962 a -2 962 a
SDict begin [/View [/XYZ H.V]/Dest (0:3432) cvn /DEST pdfmark end
 -2 962 a -2 972 a
SDict begin H.S end
 -2 972 a -2
972 a
SDict begin 13 H.A end
 -2 972 a -2 972 a
SDict begin [/View [/XYZ H.V]/Dest (0:3433) cvn /DEST pdfmark end
 -2 972 a Black 396 1114 a Fe(\225)p
Black 479 1114 a
SDict begin H.S end
 479 1114 a 479 1114 a
SDict begin 13 H.A end
 479 1114 a 479
1114 a
SDict begin [/View [/XYZ H.V]/Dest (0:3434) cvn /DEST pdfmark end
 479 1114 a Fj(The)g(APIs)h(to)f(client)h(applications.)d
(Remember)h(the)i(Psychological)d(Elements.)i(The)f(APIs)i(need)f(to)g
(be)g(as)479 1222 y(absolutely)841 1222 y
SDict begin H.S end
 841 1222 a
841 1222 a
SDict begin 13 H.A end
 841 1222 a 841 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:3435) cvn /DEST pdfmark end
 841 1222 a Fi(simple)p
Fj(,)1099 1222 y
SDict begin H.S end
 1099 1222 a 1099 1222 a
SDict begin 13 H.A end
 1099 1222 a
1099 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:3436) cvn /DEST pdfmark end
 1099 1222 a Fi(consistent)q Fj(,)g(and)1615
1222 y
SDict begin H.S end
 1615 1222 a 1615 1222 a
SDict begin 13 H.A end
 1615 1222 a 1615 1222
a
SDict begin [/View [/XYZ H.V]/Dest (0:3437) cvn /DEST pdfmark end
 1615 1222 a Fi(familiar)i Fj(as)f(possible.)e(Y)-8
b(es,)20 b(you)g(can)f(generate)g(API)i(documentation)c(from)479
1330 y(code,)j(b)n(ut)g(you)f(must)h(\002rst)h(design)f(it,)g(and)g
(designing)f(an)h(API)g(is)h(often)f(hard.)-2 1348 y
SDict begin H.S end

-2 1348 a -2 1348 a
SDict begin 13 H.A end
 -2 1348 a -2 1348 a
SDict begin [/View [/XYZ H.V]/Dest (0:3438) cvn /DEST pdfmark end
 -2 1348 a Black
396 1480 a Fe(\225)p Black 479 1480 a
SDict begin H.S end
 479 1480 a 479
1480 a
SDict begin 13 H.A end
 479 1480 a 479 1480 a
SDict begin [/View [/XYZ H.V]/Dest (0:3439) cvn /DEST pdfmark end
 479 1480 a Fj(The)g(protocols)f(that)h
(connect)f(the)h(pieces.)g(It)h(sounds)e(lik)o(e)i(rock)o(et)e
(science,)h(b)n(ut)g(it')-5 b(s)21 b(really)f(just)h(a)g(simple)f
(trick,)479 1588 y(and)g(one)g(that)g(\330MQ)g(mak)o(es)g(particularly)
f(easy)-5 b(.)19 b(In)h(f)o(act)h(the)o(y')l(re)d(so)j(simple)f(to)g
(write,)g(and)g(need)g(so)g(little)479 1696 y(b)n(ureaucrac)o(y)e(that)
i(I)g(call)h(them)f("unprotocols".)-2 1880 y
SDict begin H.S end
 -2 1880
a -2 1880 a
SDict begin 13 H.A end
 -2 1880 a -2 1880 a
SDict begin [/View [/XYZ H.V]/Dest (0:3440) cvn /DEST pdfmark end
 -2 1880 a 396 1970 a
Fj(Y)-9 b(ou)20 b(write)g(minimal)g(contracts)f(that)i(are)f(mostly)f
(just)i(place)f(mark)o(ers.)f(Most)i(messages)f(and)g(most)g(API)g
(methods)396 2077 y(will)h(be)f(missing,)g(or)g(empty)-5
b(.)19 b(Y)-9 b(ou)19 b(also)i(w)o(ant)f(to)h(write)f(do)n(wn)f(an)o(y)
g(kno)n(wn)g(technical)h(requirements)e(in)i(terms)g(of)396
2185 y(throughput,)d(latenc)o(y)-5 b(,)19 b(reliability)-5
b(,)19 b(etc.)h(These)g(are)g(the)g(criteria)g(on)g(which)g(you)f(will)
i(accept,)f(or)f(reject,)h(an)o(y)396 2293 y(particular)f(piece)h(of)g
(w)o(ork.)-2 2322 y
SDict begin H.S end
 -2 2322 a -2 2322 a
SDict begin 13 H.A end
 -2 2322 a -2
2322 a
SDict begin [/View [/XYZ H.V]/Dest (0:3441) cvn /DEST pdfmark end
 -2 2322 a 396 2632 a Fd(6.5.4.)36 b(Step)d(4:)g(Write)h(a)f
(Minimal)i(End-to-End)d(Solution)3226 2632 y
SDict begin H.S end
 3226 2632
a 3226 2632 a
SDict begin 18.72 H.A end
 3226 2632 a 3226 2632 a
SDict begin [/View [/XYZ H.V]/Dest (11.64.46.2) cvn /DEST pdfmark end
 3226 2632 a -2
2823 a
SDict begin H.S end
 -2 2823 a -2 2823 a
SDict begin 13 H.A end
 -2 2823 a -2 2823 a
SDict begin [/View [/XYZ H.V]/Dest (0:3443) cvn /DEST pdfmark end
 -2 2823
a 396 2906 a Fj(The)20 b(goal)g(is)h(to)f(test)h(out)f(the)g(o)o(v)o
(erall)f(architecture)g(as)i(rapidly)e(as)i(possible.)e(Mak)o(e)h(sk)o
(eleton)g(applications)f(that)h(call)396 3014 y(the)g(APIs,)h(and)f(sk)
o(eleton)f(stacks)i(that)f(implement)f(both)h(sides)g(of)g(e)n(v)o(ery)
f(protocol.)f(Y)-9 b(ou)20 b(w)o(ant)g(to)h(get)f(a)g(w)o(orking)396
3122 y(end-to-end)e("hello)h(w)o(orld")h(as)h(soon)e(as)i(you)f(can.)f
(Y)-9 b(ou)20 b(w)o(ant)g(to)h(be)f(able)g(to)g(test)h(code,)e(as)i
(you)f(write)g(it,)h(to)396 3230 y(weed-out)e(the)h(brok)o(en)f
(assumptions)g(and)h(ine)n(vitable)f(errors)g(you)g(mak)o(e.)h(Do)g
(not)g(go)g(of)n(f)f(and)h(spend)f(six)i(months)396 3337
y(writing)f(a)g(test)i(suite!)e(Instead,)f(mak)o(e)h(a)g(minimal)g
(bare-bones)e(application)h(that)h(uses)h(our)e(still-hypothetical)f
(API.)-2 3522 y
SDict begin H.S end
 -2 3522 a -2 3522 a
SDict begin 13 H.A end
 -2 3522 a -2 3522
a
SDict begin [/View [/XYZ H.V]/Dest (0:3444) cvn /DEST pdfmark end
 -2 3522 a 396 3611 a Fj(If)i(you)g(design)f(an)h(API)h(wearing)e(the)
h(hat)g(of)g(the)g(person)g(who)f(implements)g(it,)i(you')o(ll)e(start)
i(to)f(think)g(of)396 3719 y(performance,)d(features,)j(options,)f(and)
g(so)i(on.)e(Y)-9 b(ou')o(ll)20 b(mak)o(e)g(it)h(more)e(comple)o(x,)f
(more)h(irre)o(gular)m(,)f(and)i(more)396 3827 y(surprising)f(than)g
(it)h(should)f(be.)g(But,)h(and)f(here')-5 b(s)20 b(the)g(trick)f
(\(it')-5 b(s)21 b(a)f(cheap)f(one,)g(w)o(as)h(big)f(in)h(Japan\),)f
(if)h(you)f(design)g(an)396 3935 y(API)i(while)f(wearing)f(the)h(hat)h
(of)e(the)i(poor)e(suck)o(er)g(who)h(has)g(to)h(actually)e(write)i
(apps)f(that)g(use)g(it,)h(you)e(use)i(all)f(that)396
4043 y(laziness)h(and)f(fear)f(to)i(our)e(adv)n(antage.)-2
4227 y
SDict begin H.S end
 -2 4227 a -2 4227 a
SDict begin 13 H.A end
 -2 4227 a -2 4227 a
SDict begin [/View [/XYZ H.V]/Dest (0:3445) cvn /DEST pdfmark end
 -2 4227
a 396 4317 a Fj(Write)i(do)n(wn)e(the)h(protocols,)f(on)h(a)g(wiki)h
(or)f(shared)f(document,)f(in)i(such)g(a)h(w)o(ay)f(that)g(you)g(can)g
(e)o(xplain)f(e)n(v)o(ery)396 4425 y(command)f(clearly)i(without)g(too)
f(much)h(detail.)g(Strip)g(of)n(f)f(an)o(y)h(real)g(functionality)-5
b(,)17 b(because)j(it')o(ll)h(create)f(inertia)g(that)396
4533 y(just)g(mak)o(es)g(it)g(harder)e(to)i(mo)o(v)o(e)e(stuf)n(f)i
(around.)d(Y)-9 b(ou)19 b(can)h(al)o(w)o(ays)g(add)f(weight.)g(Don')o
(t)f(spend)h(ef)n(fort)g(de\002ning)f(formal)396 4641
y(message)i(structures:)g(pass)h(the)f(minimum)f(around,)f(in)i(the)g
(simplest)h(possible)f(f)o(ashion,)f(using)g(\330MQ')-5
b(s)21 b(multi-part)396 4749 y(framing.)-2 4933 y
SDict begin H.S end
 -2
4933 a -2 4933 a
SDict begin 13 H.A end
 -2 4933 a -2 4933 a
SDict begin [/View [/XYZ H.V]/Dest (0:3446) cvn /DEST pdfmark end
 -2 4933 a 396 5023
a Fj(Our)e(goal)h(is)g(to)g(get)f(the)h(simplest)g(test)g(case)g(w)o
(orking,)e(without)g(an)o(y)h(a)n(v)n(oidable)g(functionality)-5
b(.)17 b(Ev)o(erything)f(you)j(can)396 5131 y(chop)g(of)n(f)h(the)g
(list)h(of)f(things)g(to)g(do,)g(you)f(chop.)g(Ignore)g(the)h(groans)f
(from)g(colleagues)g(and)h(bosses.)g(I')o(ll)g(repeat)g(this)p
Black 3759 5569 a Fi(263)p Black eop end
%%Page: 264 278
TeXDict begin 264 277 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.264) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(once)h(again:)f(you)g(can)1078 72 y
SDict begin H.S end

1078 72 a 1078 72 a
SDict begin 13 H.A end
 1078 72 a 1078 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3447) cvn /DEST pdfmark end
 1078 72 a Fi(always)i
Fj(add)e(functionality)-5 b(,)18 b(that')-5 b(s)20 b(relati)n(v)o(ely)f
(easy)-5 b(.)20 b(But)h(aim)f(to)g(k)o(eep)g(the)g(o)o(v)o(erall)f
(weight)h(to)396 180 y(a)h(minimum.)-2 191 y
SDict begin H.S end
 -2 191 a
-2 191 a
SDict begin 13 H.A end
 -2 191 a -2 191 a
SDict begin [/View [/XYZ H.V]/Dest (0:3448) cvn /DEST pdfmark end
 -2 191 a 396 519 a Fd(6.5.5.)36
b(Step)d(5:)g(Solve)i(One)e(Pr)n(ob)o(lem)g(and)h(Repeat)2929
519 y
SDict begin H.S end
 2929 519 a 2929 519 a
SDict begin 18.72 H.A end
 2929 519 a 2929 519 a
SDict begin [/View [/XYZ H.V]/Dest (11.64.47.2) cvn /DEST pdfmark end
 2929
519 a -2 710 a
SDict begin H.S end
 -2 710 a -2 710 a
SDict begin 13 H.A end
 -2 710 a -2 710 a
SDict begin [/View [/XYZ H.V]/Dest (0:3450) cvn /DEST pdfmark end
 -2
710 a 396 793 a Fj(Y)-9 b(ou')l(re)19 b(no)n(w)g(in)i(the)f(Happ)o(y)f
(Loop)g(of)h(issue-dri)n(v)o(en)e(de)n(v)o(elopment)g(where)h(you)h
(can)g(start)g(to)h(solv)o(e)e(tangible)396 901 y(problems)f(instead)i
(of)f(adding)f(features.)h(Write)h(issues)h(that)f(state)g(a)g(clear)g
(problem,)d(and)i(propose)f(a)j(solution.)d(K)n(eep)396
1009 y(in)j(mind,)e(as)i(you)e(design)g(the)h(API,)h(your)e(standards)g
(for)g(names,)h(consistenc)o(y)-5 b(,)18 b(and)i(beha)n(vior)-5
b(.)18 b(Writing)i(these)h(do)n(wn)396 1117 y(in)g(prose)e(often)h
(helps)g(k)o(eep)f(them)h(sane.)-2 1301 y
SDict begin H.S end
 -2 1301 a -2
1301 a
SDict begin 13 H.A end
 -2 1301 a -2 1301 a
SDict begin [/View [/XYZ H.V]/Dest (0:3451) cvn /DEST pdfmark end
 -2 1301 a 396 1391 a Fj(From)g(here,)f(e)n
(v)o(ery)g(single)h(change)f(you)g(mak)o(e)h(to)g(the)h(architecture)d
(and)i(code)f(is)j(no)n(w)d(pro)o(v)o(en)f(by)i(running)e(the)i(test)
396 1499 y(case,)h(w)o(atching)e(it)i(not)f(w)o(ork,)f(making)g(the)h
(change,)f(and)g(then)h(w)o(atching)f(it)i(w)o(ork.)-2
1683 y
SDict begin H.S end
 -2 1683 a -2 1683 a
SDict begin 13 H.A end
 -2 1683 a -2 1683 a
SDict begin [/View [/XYZ H.V]/Dest (0:3452) cvn /DEST pdfmark end
 -2 1683
a 396 1773 a Fj(No)n(w)f(you)g(go)f(through)f(the)j(whole)e(c)o(ycle)h
(\(e)o(xtending)e(the)i(test)h(case,)f(\002xing)g(the)g(API,)g
(updating)f(the)h(protocol,)396 1880 y(e)o(xtending)e(the)i(code,)g(as)
h(needed\),)d(taking)h(problems)g(one)h(at)g(a)h(time)f(and)g(testing)g
(the)g(solutions)g(indi)n(vidually)-5 b(.)17 b(It)396
1988 y(should)i(tak)o(e)i(about)e(10-30)f(minutes)i(for)g(each)f(c)o
(ycle,)h(with)g(the)g(occasional)g(spik)o(e)g(due)f(to)i(random)d
(confusion.)-2 2100 y
SDict begin H.S end
 -2 2100 a -2 2100 a
SDict begin 13 H.A end
 -2 2100 a -2
2100 a
SDict begin [/View [/XYZ H.V]/Dest (0:3453) cvn /DEST pdfmark end
 -2 2100 a 359 x Fh(6.6.)39 b(Unpr)m(otocols)1122
2459 y
SDict begin H.S end
 1122 2459 a 1122 2459 a
SDict begin 22.464 H.A end
 1122 2459 a 1122 2459
a
SDict begin [/View [/XYZ H.V]/Dest (11.65.1) cvn /DEST pdfmark end
 1122 2459 a -2 2489 a
SDict begin H.S end
 -2 2489 a -2 2489 a
SDict begin 13 H.A end
 -2 2489 a
-2 2489 a
SDict begin [/View [/XYZ H.V]/Dest (0:3455) cvn /DEST pdfmark end
 -2 2489 a 396 2787 a Fd(6.6.1.)d(Wh)n(y)d(Unpr)n(otocols?)
1786 2787 y
SDict begin H.S end
 1786 2787 a 1786 2787 a
SDict begin 18.72 H.A end
 1786 2787 a 1786
2787 a
SDict begin [/View [/XYZ H.V]/Dest (11.65.48.2) cvn /DEST pdfmark end
 1786 2787 a -2 2978 a
SDict begin H.S end
 -2 2978 a -2 2978 a
SDict begin 13 H.A end
 -2 2978
a -2 2978 a
SDict begin [/View [/XYZ H.V]/Dest (0:3457) cvn /DEST pdfmark end
 -2 2978 a 396 3061 a Fj(When)20 b(this)h(man)f(thinks)f(of)
h(protocols,)f(this)i(man)e(thinks)h(of)g(massi)n(v)o(e)g(documents)e
(written)i(by)g(committees,)f(o)o(v)o(er)396 3169 y(years.)h(This)g
(man)g(thinks)g(of)g(the)g(IETF)-7 b(,)20 b(W3C,)h(ISO,)f(Oasis,)h(re)o
(gulatory)d(capture,)h(FRAND)i(patent)e(license)396 3277
y(disputes,)h(and)g(soon)f(after)m(,)g(this)i(man)f(thinks)g(of)g
(retirement)e(to)j(a)f(nice)h(little)g(f)o(arm)e(in)i(northern)d(Boli)n
(via)i(up)g(in)g(the)396 3385 y(mountains)f(where)h(the)g(only)f(other)
g(needlessly)h(stubborn)e(beings)i(are)g(the)g(goats)g(che)n(wing)f(up)
h(the)g(cof)n(fee)f(plants.)-2 3569 y
SDict begin H.S end
 -2 3569 a -2 3569
a
SDict begin 13 H.A end
 -2 3569 a -2 3569 a
SDict begin [/View [/XYZ H.V]/Dest (0:3458) cvn /DEST pdfmark end
 -2 3569 a 396 3659 a Fj(No)n(w)-5
b(,)20 b(I')l(v)o(e)f(nothing)f(personal)h(against)h(committees.)f(The)
h(useless)h(folk)e(need)h(a)h(place)e(to)i(sit)g(out)f(their)g(li)n(v)o
(es)g(with)396 3767 y(minimal)g(risk)g(of)g(reproducing,)d(after)j
(all,)g(that)g(only)g(seems)g(f)o(air)-5 b(.)21 b(But)f(most)h
(committee)e(protocols)g(tend)g(to)n(w)o(ards)396 3875
y(comple)o(xity)f(\(the)i(ones)g(that)g(w)o(ork\),)f(or)h(trash)g
(\(the)g(ones)g(we)h(don')o(t)d(talk)j(about\).)d(There')-5
b(s)20 b(a)h(fe)n(w)f(reasons)f(for)h(this.)396 3983
y(One)g(is)h(the)g(amount)d(of)i(mone)o(y)f(at)i(stak)o(e.)f(More)f
(mone)o(y)g(means)h(more)f(people)g(who)h(w)o(ant)g(their)g(particular)
396 4090 y(prejudices)f(and)h(assumptions)f(e)o(xpressed)g(in)h(prose.)
g(But)g(tw)o(o)h(is)g(the)f(lack)g(of)g(good)f(abstractions)g(on)h
(which)g(to)396 4198 y(b)n(uild.)g(People)g(ha)n(v)o(e)f(tried)h(to)g
(b)n(uild)g(reusable)g(protocol)e(abstractions,)h(lik)o(e)i(BEEP)-9
b(.)20 b(Most)g(did)g(not)g(stick,)g(and)g(those)396
4306 y(that)h(did,)e(lik)o(e)i(SO)m(AP)g(and)e(XMPP)-9
b(,)21 b(are)f(on)g(the)g(comple)o(x)e(side)j(of)f(things.)-2
4490 y
SDict begin H.S end
 -2 4490 a -2 4490 a
SDict begin 13 H.A end
 -2 4490 a -2 4490 a
SDict begin [/View [/XYZ H.V]/Dest (0:3459) cvn /DEST pdfmark end
 -2 4490
a 396 4580 a Fj(It)h(used)f(to)g(be,)g(decades)f(ago,)h(when)f(the)i
(Internet)e(w)o(as)i(a)f(young)f(modest)g(thing,)g(that)i(protocols)d
(were)i(short)g(and)396 4688 y(sweet.)h(The)o(y)e(weren')o(t)g(e)n(v)o
(en)g("standards",)g(b)n(ut)h("requests)g(for)f(comments",)g(which)h
(is)h(as)g(modest)e(as)i(you)e(can)h(get.)396 4796 y(It')-5
b(s)21 b(been)f(one)f(of)h(my)g(goals)g(since)g(we)h(started)f(iMatix)g
(in)h(1995)d(to)j(\002nd)f(a)g(w)o(ay)h(for)e(ordinary)f(people)h(lik)o
(e)i(me)f(to)396 4904 y(write)h(small,)f(accurate)f(protocols)g
(without)h(the)g(o)o(v)o(erhead)d(of)j(the)g(committees.)p
Black 3759 5569 a Fi(264)p Black eop end
%%Page: 265 279
TeXDict begin 265 278 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.265) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3460) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(No)n(w)-5 b(,)20 b(\330MQ)g(does)g(appear)f(to)h(pro)
o(vide)f(a)h(li)n(ving,)f(successful)h(protocol)f(abstraction)g(layer)h
(with)g(its)h("we')o(ll)g(carry)396 180 y(multi-part)e(messages)h(o)o
(v)o(er)f(random)g(transports")g(w)o(ay)h(of)g(w)o(orking.)e(Since)i
(\330MQ)h(deals)f(silently)g(with)h(framing,)396 288
y(connections,)d(and)i(routing,)e(it')-5 b(s)22 b(surprisingly)c(easy)i
(to)h(write)f(full)g(protocol)f(specs)h(on)g(top)g(of)g(\330MQ,)g(and)g
(in)396 396 y(Reliable)h(Request-Reply)e(P)o(atterns)p
0 TeXcolorgray 1475 396 a
SDict begin H.S end
 1475 396 a Fj(Chapter)g(4)1800
396 y
SDict begin 13 H.L end
 1800 396 a 1800 396 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1800 396 a Black 20 w Fj(and)h(Adv)n(anced)
e(Publish-Subscribe)g(P)o(atterns)p 0 TeXcolorgray 3208
396 a
SDict begin H.S end
 3208 396 a Fj(Chapter)h(5)3533 396 y
SDict begin 13 H.L end
 3533 396 a
3533 396 a
SDict begin [/Subtype /Link/Dest (0:advanced-pub-sub) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3533 396 a Black 20 w Fj(I)h(sho)n(wed)396
504 y(ho)n(w)g(to)g(do)g(this.)-2 671 y
SDict begin H.S end
 -2 671 a -2 671
a
SDict begin 13 H.A end
 -2 671 a -2 671 a
SDict begin [/View [/XYZ H.V]/Dest (0:3463) cvn /DEST pdfmark end
 -2 671 a 396 778 a Fj(Some)n(where)f(around)f
(mid-2007,)g(I)i(kick)o(ed-of)n(f)e(the)i(Digital)g(Standards)f(Or)o
(ganization)f(to)i(de\002ne)g(ne)n(w)g(simpler)396 886
y(w)o(ays)g(of)g(producing)d(little)k(standards,)e(protocols,)f
(speci\002cations.)h(In)h(my)f(defense,)g(it)i(w)o(as)f(a)h(quiet)e
(summer)-5 b(.)19 b(At)i(the)396 994 y(time)565 994 y
SDict begin H.S end

565 994 a 565 994 a
SDict begin 13 H.A end
 565 994 a 565 994 a
SDict begin [/View [/XYZ H.V]/Dest (0:3464) cvn /DEST pdfmark end
 565 994 a Fj(I)f(wrote)g(that)g
(\(http://www)-5 b(.digistan.or)o(g/spec:1\))15 b(a)20
b(ne)n(w)g(speci\002cation)g(should)f(tak)o(e)h("minutes)g(to)g(e)o
(xplain,)396 1102 y(hours)f(to)i(design,)e(days)h(to)g(write,)h(weeks)f
(to)g(pro)o(v)o(e,)e(months)h(to)i(become)e(mature,)g(and)g(years)h(to)
h(replace.")-2 1286 y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286 a -2
1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:3465) cvn /DEST pdfmark end
 -2 1286 a 396 1376 a Fj(In)f(2010)f(we)i(started)f(calling)f
(such)h(little)h(speci\002cations)f("unprotocols",)d(which)j(some)g
(people)f(might)h(mistak)o(e)g(for)396 1484 y(a)h(dastardly)e(plan)h
(for)f(w)o(orld)h(domination)e(by)i(a)g(shado)n(wy)f(international)g
(or)o(ganization,)d(b)n(ut)k(which)g(really)g(just)396
1592 y(means,)g("protocols)f(without)g(the)h(goats".)-2
1620 y
SDict begin H.S end
 -2 1620 a -2 1620 a
SDict begin 13 H.A end
 -2 1620 a -2 1620 a
SDict begin [/View [/XYZ H.V]/Dest (0:3466) cvn /DEST pdfmark end
 -2 1620
a 396 1930 a Fd(6.6.2.)36 b(Ho)n(w)d(to)h(Write)f(Unpr)n(otocols)2192
1930 y
SDict begin H.S end
 2192 1930 a 2192 1930 a
SDict begin 18.72 H.A end
 2192 1930 a 2192 1930
a
SDict begin [/View [/XYZ H.V]/Dest (11.65.49.2) cvn /DEST pdfmark end
 2192 1930 a -2 2121 a
SDict begin H.S end
 -2 2121 a -2 2121 a
SDict begin 13 H.A end
 -2 2121 a
-2 2121 a
SDict begin [/View [/XYZ H.V]/Dest (0:3468) cvn /DEST pdfmark end
 -2 2121 a 396 2204 a Fj(When)20 b(you)g(start)g(to)h(write)f
(an)g(unprotocol)e(speci\002cation)h(document,)f(stick)j(to)f(a)h
(consistent)e(structure)h(so)g(that)g(your)396 2312 y(readers)g(kno)n
(w)f(what)h(to)g(e)o(xpect.)f(Here)h(is)h(the)g(structure)e(I)h(use:)-2
2330 y
SDict begin H.S end
 -2 2330 a -2 2330 a
SDict begin 13 H.A end
 -2 2330 a -2 2330 a
SDict begin [/View [/XYZ H.V]/Dest (0:3469) cvn /DEST pdfmark end
 -2 2330
a -2 2340 a
SDict begin H.S end
 -2 2340 a -2 2340 a
SDict begin 13 H.A end
 -2 2340 a -2 2340 a
SDict begin [/View [/XYZ H.V]/Dest (0:3470) cvn /DEST pdfmark end
 -2
2340 a Black 396 2482 a Fe(\225)p Black 479 2482 a
SDict begin H.S end
 479
2482 a 479 2482 a
SDict begin 13 H.A end
 479 2482 a 479 2482 a
SDict begin [/View [/XYZ H.V]/Dest (0:3471) cvn /DEST pdfmark end
 479 2482 a Fj(Co)o(v)o(er)f
(section:)h(with)h(a)f(1-line)g(summary)-5 b(,)18 b(URL)j(to)f(the)g
(spec,)g(formal)g(name,)f(v)o(ersion,)g(who)g(to)i(blame.)-2
2500 y
SDict begin H.S end
 -2 2500 a -2 2500 a
SDict begin 13 H.A end
 -2 2500 a -2 2500 a
SDict begin [/View [/XYZ H.V]/Dest (0:3472) cvn /DEST pdfmark end
 -2 2500
a Black 396 2632 a Fe(\225)p Black 479 2632 a
SDict begin H.S end
 479 2632
a 479 2632 a
SDict begin 13 H.A end
 479 2632 a 479 2632 a
SDict begin [/View [/XYZ H.V]/Dest (0:3473) cvn /DEST pdfmark end
 479 2632 a Fj(License)f(for)g(the)g
(te)o(xt:)g(absolutely)f(needed)g(for)h(public)f(speci\002cations.)-2
2650 y
SDict begin H.S end
 -2 2650 a -2 2650 a
SDict begin 13 H.A end
 -2 2650 a -2 2650 a
SDict begin [/View [/XYZ H.V]/Dest (0:3474) cvn /DEST pdfmark end
 -2 2650
a Black 396 2781 a Fe(\225)p Black 479 2781 a
SDict begin H.S end
 479 2781
a 479 2781 a
SDict begin 13 H.A end
 479 2781 a 479 2781 a
SDict begin [/View [/XYZ H.V]/Dest (0:3475) cvn /DEST pdfmark end
 479 2781 a Fj(The)h(change)f
(process:)h(i.e.)g(ho)n(w)g(I)g(as)h(a)g(reader)e(\002x)h(problems)f
(in)h(the)g(speci\002cation?)-2 2799 y
SDict begin H.S end
 -2 2799 a -2 2799
a
SDict begin 13 H.A end
 -2 2799 a -2 2799 a
SDict begin [/View [/XYZ H.V]/Dest (0:3476) cvn /DEST pdfmark end
 -2 2799 a Black 396 2931 a Fe(\225)p
Black 479 2931 a
SDict begin H.S end
 479 2931 a 479 2931 a
SDict begin 13 H.A end
 479 2931 a 479
2931 a
SDict begin [/View [/XYZ H.V]/Dest (0:3477) cvn /DEST pdfmark end
 479 2931 a Fj(Use)h(of)f(language:)f(MUST)-6 b(,)20
b(MA)-9 b(Y)e(,)20 b(SHOULD,)h(etc.)f(with)g(a)h(reference)d(to)j(RFC)g
(2119.)-2 2949 y
SDict begin H.S end
 -2 2949 a -2 2949 a
SDict begin 13 H.A end
 -2 2949 a -2 2949
a
SDict begin [/View [/XYZ H.V]/Dest (0:3478) cvn /DEST pdfmark end
 -2 2949 a Black 396 3080 a Fe(\225)p Black 479 3080
a
SDict begin H.S end
 479 3080 a 479 3080 a
SDict begin 13 H.A end
 479 3080 a 479 3080 a
SDict begin [/View [/XYZ H.V]/Dest (0:3479) cvn /DEST pdfmark end
 479 3080
a Fj(Maturity)f(indicator:)f(is)i(this)f(a)h(e)o(xperimental,)d(draft,)
h(stable,)h(le)o(gac)o(y)-5 b(,)18 b(retired?)-2 3098
y
SDict begin H.S end
 -2 3098 a -2 3098 a
SDict begin 13 H.A end
 -2 3098 a -2 3098 a
SDict begin [/View [/XYZ H.V]/Dest (0:3480) cvn /DEST pdfmark end
 -2 3098 a Black
396 3230 a Fe(\225)p Black 479 3230 a
SDict begin H.S end
 479 3230 a 479
3230 a
SDict begin 13 H.A end
 479 3230 a 479 3230 a
SDict begin [/View [/XYZ H.V]/Dest (0:3481) cvn /DEST pdfmark end
 479 3230 a Fj(Goals)j(of)f(the)g
(protocol:)e(what)j(problems)d(is)j(it)g(trying)e(to)i(solv)o(e?)-2
3248 y
SDict begin H.S end
 -2 3248 a -2 3248 a
SDict begin 13 H.A end
 -2 3248 a -2 3248 a
SDict begin [/View [/XYZ H.V]/Dest (0:3482) cvn /DEST pdfmark end
 -2 3248
a Black 396 3379 a Fe(\225)p Black 479 3379 a
SDict begin H.S end
 479 3379
a 479 3379 a
SDict begin 13 H.A end
 479 3379 a 479 3379 a
SDict begin [/View [/XYZ H.V]/Dest (0:3483) cvn /DEST pdfmark end
 479 3379 a Fj(F)o(ormal)f(grammar:)e
(pre)n(v)o(ents)h(ar)o(guments)f(due)i(to)g(dif)n(ferent)f
(interpretation)f(of)i(the)g(te)o(xt.)-2 3397 y
SDict begin H.S end
 -2 3397
a -2 3397 a
SDict begin 13 H.A end
 -2 3397 a -2 3397 a
SDict begin [/View [/XYZ H.V]/Dest (0:3484) cvn /DEST pdfmark end
 -2 3397 a Black 396 3528
a Fe(\225)p Black 479 3528 a
SDict begin H.S end
 479 3528 a 479 3528 a
SDict begin 13 H.A end
 479
3528 a 479 3528 a
SDict begin [/View [/XYZ H.V]/Dest (0:3485) cvn /DEST pdfmark end
 479 3528 a Fj(T)-6 b(echnical)20 b(e)o(xplanation:)e
(semantics)i(of)g(each)g(message,)f(error)g(handling,)f(etc.)-2
3546 y
SDict begin H.S end
 -2 3546 a -2 3546 a
SDict begin 13 H.A end
 -2 3546 a -2 3546 a
SDict begin [/View [/XYZ H.V]/Dest (0:3486) cvn /DEST pdfmark end
 -2 3546
a Black 396 3678 a Fe(\225)p Black 479 3678 a
SDict begin H.S end
 479 3678
a 479 3678 a
SDict begin 13 H.A end
 479 3678 a 479 3678 a
SDict begin [/View [/XYZ H.V]/Dest (0:3487) cvn /DEST pdfmark end
 479 3678 a Fj(Security)i
(discussion:)g(e)o(xplicitly)-5 b(,)18 b(ho)n(w)i(secure)f(the)i
(protocol)d(is.)-2 3696 y
SDict begin H.S end
 -2 3696 a -2 3696 a
SDict begin 13 H.A end
 -2 3696
a -2 3696 a
SDict begin [/View [/XYZ H.V]/Dest (0:3488) cvn /DEST pdfmark end
 -2 3696 a Black 396 3827 a Fe(\225)p Black
479 3827 a
SDict begin H.S end
 479 3827 a 479 3827 a
SDict begin 13 H.A end
 479 3827 a 479 3827
a
SDict begin [/View [/XYZ H.V]/Dest (0:3489) cvn /DEST pdfmark end
 479 3827 a Fj(References:)i(to)g(other)g(documents,)e(protocols,)g
(etc.)-2 4011 y
SDict begin H.S end
 -2 4011 a -2 4011 a
SDict begin 13 H.A end
 -2 4011 a -2 4011
a
SDict begin [/View [/XYZ H.V]/Dest (0:3490) cvn /DEST pdfmark end
 -2 4011 a 396 4101 a Fj(Writing)i(clear)m(,)g(e)o(xpressi)n(v)o(e)e
(te)o(xt)i(is)i(hard.)d(Do)h(a)n(v)n(oid)g(trying)f(to)h(describe)g
(implementations)e(of)i(the)g(protocol.)396 4209 y(Remember)f(that)g
(you')l(re)f(writing)h(a)h(contract.)e(Y)-9 b(ou)19 b(describe)f(in)i
(clear)f(language)f(the)i(obligations)d(and)i(e)o(xpectations)396
4317 y(of)h(each)g(party)-5 b(,)19 b(the)h(le)n(v)o(el)g(of)g
(obligation,)e(and)h(the)h(penalties)g(for)g(breaking)e(the)i(rules.)g
(Y)-9 b(ou)20 b(do)g(not)f(try)h(to)h(de\002ne)396 4425
y
SDict begin H.S end
 396 4425 a 396 4425 a
SDict begin 13 H.A end
 396 4425 a 396 4425 a
SDict begin [/View [/XYZ H.V]/Dest (0:3491) cvn /DEST pdfmark end
 396 4425
a Fi(how)f Fj(each)g(party)g(honors)e(its)k(part)d(of)h(the)h(deal.)-2
4609 y
SDict begin H.S end
 -2 4609 a -2 4609 a
SDict begin 13 H.A end
 -2 4609 a -2 4609 a
SDict begin [/View [/XYZ H.V]/Dest (0:3492) cvn /DEST pdfmark end
 -2 4609
a 396 4699 a Fj(If)f(you)g(need)f(reference)g(material)g(to)i(start)f
(with,)h(read)e(the)h(http://rfc.zeromq.or)o(g)15 b(site,)21
b(which)f(has)g(a)h(b)n(unch)e(of)396 4807 y(unprotocols)f(that)i(you)g
(can)g(cop)o(y/paste)f(from.)-2 4991 y
SDict begin H.S end
 -2 4991 a -2 4991
a
SDict begin 13 H.A end
 -2 4991 a -2 4991 a
SDict begin [/View [/XYZ H.V]/Dest (0:3493) cvn /DEST pdfmark end
 -2 4991 a 396 5081 a Fj(Here)h(are)g(some)g(k)o
(e)o(y)g(points)g(about)f(unprotocols:)-2 5099 y
SDict begin H.S end
 -2 5099
a -2 5099 a
SDict begin 13 H.A end
 -2 5099 a -2 5099 a
SDict begin [/View [/XYZ H.V]/Dest (0:3494) cvn /DEST pdfmark end
 -2 5099 a -2 5109 a
SDict begin H.S end
 -2
5109 a -2 5109 a
SDict begin 13 H.A end
 -2 5109 a -2 5109 a
SDict begin [/View [/XYZ H.V]/Dest (0:3495) cvn /DEST pdfmark end
 -2 5109 a Black
3759 5569 a Fi(265)p Black eop end
%%Page: 266 280
TeXDict begin 266 279 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.266) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3496) cvn /DEST pdfmark end
 479 72 a Fj(As)i(long)f(as)h(your)d
(process)i(is)h(open)f(then)f(you)h(don')o(t)e(need)i(a)g(committee:)f
(just)i(mak)o(e)f(clean)g(minimal)f(designs)479 180 y(and)h(mak)o(e)g
(sure)g(an)o(yone)e(is)j(free)f(to)g(impro)o(v)o(e)e(them.)-2
198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:3497) cvn /DEST pdfmark end
 -2 198 a Black
396 330 a Fe(\225)p Black 479 330 a
SDict begin H.S end
 479 330 a 479 330
a
SDict begin 13 H.A end
 479 330 a 479 330 a
SDict begin [/View [/XYZ H.V]/Dest (0:3498) cvn /DEST pdfmark end
 479 330 a Fj(If)i(use)h(an)f(e)o(xisting)f
(license)i(then)e(you)h(don')o(t)e(ha)n(v)o(e)i(le)o(gal)f(w)o(orries)h
(afterw)o(ards.)f(I)i(use)f(GPLv3)g(for)f(my)h(public)479
438 y(speci\002cations)g(and)g(advise)g(you)f(to)h(do)g(the)g(same.)g
(F)o(or)g(in-house)f(w)o(ork,)g(standard)g(cop)o(yright)f(is)j
(perfect.)-2 456 y
SDict begin H.S end
 -2 456 a -2 456 a
SDict begin 13 H.A end
 -2 456 a -2 456
a
SDict begin [/View [/XYZ H.V]/Dest (0:3499) cvn /DEST pdfmark end
 -2 456 a Black 396 587 a Fe(\225)p Black 479 587 a
SDict begin H.S end

479 587 a 479 587 a
SDict begin 13 H.A end
 479 587 a 479 587 a
SDict begin [/View [/XYZ H.V]/Dest (0:3500) cvn /DEST pdfmark end
 479 587 a Fj(The)f(formality)f
(is)i(v)n(aluable.)e(That)h(is,)h(learn)e(to)i(write)f(a)h(formal)e
(grammar)f(such)i(as)h(ABNF)g(\(Augmented)479 695 y(Backus-Naur)e(F)o
(orm\))g(and)h(use)g(this)h(to)f(fully)g(document)e(your)h(messages.)-2
713 y
SDict begin H.S end
 -2 713 a -2 713 a
SDict begin 13 H.A end
 -2 713 a -2 713 a
SDict begin [/View [/XYZ H.V]/Dest (0:3501) cvn /DEST pdfmark end
 -2 713 a Black
396 845 a Fe(\225)p Black 479 845 a
SDict begin H.S end
 479 845 a 479 845
a
SDict begin 13 H.A end
 479 845 a 479 845 a
SDict begin [/View [/XYZ H.V]/Dest (0:3502) cvn /DEST pdfmark end
 479 845 a Fj(Use)i(a)g(mark)o(et-dri)n(v)o(en)c
(life-c)o(ycle)i(process)g(lik)o(e)1921 845 y
SDict begin H.S end
 1921 845
a 1921 845 a
SDict begin 13 H.A end
 1921 845 a 1921 845 a
SDict begin [/View [/XYZ H.V]/Dest (0:3503) cvn /DEST pdfmark end
 1921 845 a Fj(Digistan')-5
b(s)20 b(COSS)i(\(http://www)-5 b(.digistan.or)o(g/spec:1\))14
b(so)21 b(that)479 953 y(people)e(place)h(the)h(right)e(weight)h(on)g
(your)f(specs)h(as)h(the)o(y)f(mature)f(\(or)g(don')o(t\).)-2
1012 y
SDict begin H.S end
 -2 1012 a -2 1012 a
SDict begin 13 H.A end
 -2 1012 a -2 1012 a
SDict begin [/View [/XYZ H.V]/Dest (0:3504) cvn /DEST pdfmark end
 -2 1012
a 396 1322 a Fd(6.6.3.)36 b(Wh)n(y)d(use)h(the)g(GPLv3)g(f)n(or)e(Pub)o
(lic)i(Speci\002cations?)3338 1322 y
SDict begin H.S end
 3338 1322 a 3338
1322 a
SDict begin 18.72 H.A end
 3338 1322 a 3338 1322 a
SDict begin [/View [/XYZ H.V]/Dest (11.65.50.2) cvn /DEST pdfmark end
 3338 1322 a -2 1513 a
SDict begin H.S end

-2 1513 a -2 1513 a
SDict begin 13 H.A end
 -2 1513 a -2 1513 a
SDict begin [/View [/XYZ H.V]/Dest (0:3506) cvn /DEST pdfmark end
 -2 1513 a 396
1596 a Fj(The)20 b(license)g(you)g(choose)f(is)i(particularly)e
(crucial)g(for)h(public)f(speci\002cations.)h(T)m(raditionally)-5
b(,)17 b(protocols)i(are)396 1704 y(published)g(under)g(custom)g
(licenses,)i(where)e(the)h(authors)g(o)n(wn)f(the)h(te)o(xt)g(and)g
(deri)n(v)o(ed)f(w)o(orks)g(are)h(forbidden.)e(This)396
1812 y(sounds)i(great)f(\(after)h(all,)g(who)g(w)o(ants)h(to)f(see)h(a)
f(protocol)f(fork)o(ed?\))f(b)n(ut)i(it')-5 b(s)22 b(in)e(f)o(act)g
(highly)f(risk)o(y)-5 b(.)19 b(A)i(protocol)396 1920
y(committee)f(is)h(vulnerable)d(to)i(capture,)f(and)h(if)g(the)g
(protocol)f(is)i(important)e(and)g(v)n(aluable,)g(the)h(incenti)n(v)o
(e)f(for)396 2028 y(capture)g(gro)n(ws.)-2 2212 y
SDict begin H.S end
 -2
2212 a -2 2212 a
SDict begin 13 H.A end
 -2 2212 a -2 2212 a
SDict begin [/View [/XYZ H.V]/Dest (0:3507) cvn /DEST pdfmark end
 -2 2212 a 396 2302
a Fj(Once)h(captured,)f(lik)o(e)h(some)g(wild)g(animals,)g(an)g
(important)f(protocol)f(will)j(often)f(die.)g(The)g(real)g(problem)e
(is)j(there')-5 b(s)396 2410 y(no)20 b(w)o(ay)g(to)744
2410 y
SDict begin H.S end
 744 2410 a 744 2410 a
SDict begin 13 H.A end
 744 2410 a 744 2410 a
SDict begin [/View [/XYZ H.V]/Dest (0:3508) cvn /DEST pdfmark end
 744
2410 a Fi(fr)m(ee)g Fj(a)h(capti)n(v)o(e)e(protocol)g(published)f
(under)h(a)i(con)m(v)o(entional)c(license.)j(The)g(w)o(ord)f("free")h
(isn')o(t)g(just)g(an)396 2518 y(adjecti)n(v)o(e)f(to)i(describe)e
(speech)h(or)g(air)m(,)f(it')-5 b(s)22 b(also)e(a)h(v)o(erb,)e(and)g
(the)i(right)e(to)h(fork)g(a)g(w)o(ork,)3034 2518 y
SDict begin H.S end
 3034
2518 a 3034 2518 a
SDict begin 13 H.A end
 3034 2518 a 3034 2518 a
SDict begin [/View [/XYZ H.V]/Dest (0:3509) cvn /DEST pdfmark end
 3034 2518
a Fi(a)o(gainst)g(the)g(wishes)h(of)g(the)396 2626 y(owner)r
Fj(,)f(is)h(essential)g(to)f(a)n(v)n(oiding)f(capture.)-2
2810 y
SDict begin H.S end
 -2 2810 a -2 2810 a
SDict begin 13 H.A end
 -2 2810 a -2 2810 a
SDict begin [/View [/XYZ H.V]/Dest (0:3510) cvn /DEST pdfmark end
 -2 2810
a 396 2900 a Fj(Let)i(me)f(e)o(xplain)f(this)i(in)f(shorter)f(w)o
(ords.)h(Imagine)f(iMatix)h(writes)g(a)h(protocol)d(today)-5
b(,)19 b(that')-5 b(s)21 b(really)f(amazing)f(and)396
3007 y(popular)-5 b(.)19 b(W)-7 b(e)21 b(publish)e(the)i(spec)f(and)g
(man)o(y)f(people)g(implement)g(it.)h(Those)g(implementations)e(are)i
(f)o(ast)h(and)396 3115 y(a)o(wesome,)e(and)h(free)g(as)h(in)f(beer)-5
b(.)20 b(And)g(the)o(y)f(start)i(to)f(threaten)f(an)h(e)o(xisting)g(b)n
(usiness.)g(Their)g(e)o(xpensi)n(v)o(e)396 3223 y(commercial)f(product)
f(is)j(slo)n(wer)f(and)g(can')o(t)f(compete.)g(So)i(one)e(day)h(the)o
(y)f(come)h(to)g(our)g(iMatix)g(of)n(\002ce)g(in)396
3331 y(Maetang-Dong,)d(South)j(K)m(orea,)f(and)h(of)n(fer)f(to)h(b)n
(uy)g(our)f(\002rm.)h(Since)h(we')l(re)e(spending)g(v)n(ast)h(amounts)f
(on)h(sushi)g(and)396 3439 y(beer)g(and)g(GFEs,)g(we)h(accept)f
(gratefully)-5 b(.)17 b(W)m(ith)k(e)n(vil)f(laughter)f(the)h(ne)n(w)g
(o)n(wners)g(of)f(the)i(protocol)d(stop)i(impro)o(ving)396
3547 y(the)g(public)g(v)o(ersion,)e(and)i(close)g(the)h
(speci\002cation)e(and)h(add)f(patented)g(e)o(xtensions.)g(Their)h(ne)n
(w)g(products)e(support)396 3655 y(this,)j(and)e(the)o(y)h(tak)o(e)g(o)
o(v)o(er)f(the)h(whole)g(mark)o(et.)-2 3839 y
SDict begin H.S end
 -2 3839
a -2 3839 a
SDict begin 13 H.A end
 -2 3839 a -2 3839 a
SDict begin [/View [/XYZ H.V]/Dest (0:3511) cvn /DEST pdfmark end
 -2 3839 a 396 3929 a
Fj(When)g(you)g(contrib)n(ute)e(to)j(an)f(open)f(source)g(project,)g
(you)h(really)g(w)o(ant)g(to)g(kno)n(w)f(your)g(hard)h(w)o(ork)f(w)o
(on')o(t)g(used)396 4037 y(against)h(you)f(by)h(a)g(closed-source)f
(competitor)-5 b(.)18 b(Which)i(is)i(why)d(the)h(GPL)h(beats)f(the)g
("more)f(permissi)n(v)o(e")396 4145 y(BSD/MIT/X11)h(licenses.)g(These)g
(license)g(gi)n(v)o(e)f(permission)g(to)h(cheat.)f(This)h(applies)g
(just)h(as)f(much)f(to)h(protocols)f(as)396 4253 y(to)i(source)e(code.)
-2 4420 y
SDict begin H.S end
 -2 4420 a -2 4420 a
SDict begin 13 H.A end
 -2 4420 a -2 4420 a
SDict begin [/View [/XYZ H.V]/Dest (0:3512) cvn /DEST pdfmark end
 -2
4420 a 396 4527 a Fj(When)g(you)g(implement)f(a)i(GPLv3)e
(speci\002cation,)h(your)f(applications)g(are)h(of)g(course)f(yours,)h
(and)f(licensed)h(an)o(y)g(w)o(ay)396 4635 y(you)g(lik)o(e.)g(But)i
(you)d(can)i(be)f(sure)g(and)g(certain)g(of)h(tw)o(o)g(things.)e(One,)i
(that)f(speci\002cation)g(will)3158 4635 y
SDict begin H.S end
 3158 4635
a 3158 4635 a
SDict begin 13 H.A end
 3158 4635 a 3158 4635 a
SDict begin [/View [/XYZ H.V]/Dest (0:3513) cvn /DEST pdfmark end
 3158 4635 a Fi(e)o(ver)j
Fj(be)d(embraced)f(and)396 4743 y(e)o(xtended)g(into)i(proprietary)e
(forms.)h(An)o(y)h(deri)n(v)o(ed)e(forms)i(of)f(the)i(speci\002cation)e
(must)h(also)h(be)f(GPLv3.)f(T)-7 b(w)o(o,)396 4851 y(no-one)19
b(who)g(e)n(v)o(er)h(implements)f(or)h(uses)g(the)h(protocol)d(will)j
(e)n(v)o(er)e(launch)g(a)i(patent)f(attack)g(on)g(an)o(ything)e(it)j
(co)o(v)o(ers.)-2 4879 y
SDict begin H.S end
 -2 4879 a -2 4879 a
SDict begin 13 H.A end
 -2 4879
a -2 4879 a
SDict begin [/View [/XYZ H.V]/Dest (0:3514) cvn /DEST pdfmark end
 -2 4879 a Black 3757 5569 a Fi(266)p Black
eop end
%%Page: 267 281
TeXDict begin 267 280 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.267) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 77 a Fd(6.6.4.)36 b(Using)e(ABNF)1425 77 y
SDict begin H.S end

1425 77 a 1425 77 a
SDict begin 18.72 H.A end
 1425 77 a 1425 77 a
SDict begin [/View [/XYZ H.V]/Dest (11.65.51.2) cvn /DEST pdfmark end
 1425 77 a -2
269 a
SDict begin H.S end
 -2 269 a -2 269 a
SDict begin 13 H.A end
 -2 269 a -2 269 a
SDict begin [/View [/XYZ H.V]/Dest (0:3516) cvn /DEST pdfmark end
 -2 269 a 396
351 a Fj(My)20 b(advice)g(when)f(writing)h(protocol)e(specs)j(is)g(to)f
(learn,)g(and)g(use)g(a)h(formal)e(grammar)-5 b(.)18
b(It')-5 b(s)21 b(just)g(less)g(hassle)g(than)396 459
y(allo)n(wing)f(others)f(to)i(interpret)e(what)h(you)f(mean,)g(and)h
(then)g(reco)o(v)o(er)e(from)h(the)h(ine)n(vitable)f(f)o(alse)i
(assumptions.)e(The)396 566 y(tar)o(get)h(of)f(your)g(grammar)g(is)i
(other)e(people,)g(engineers,)g(not)h(compilers.)-2 751
y
SDict begin H.S end
 -2 751 a -2 751 a
SDict begin 13 H.A end
 -2 751 a -2 751 a
SDict begin [/View [/XYZ H.V]/Dest (0:3517) cvn /DEST pdfmark end
 -2 751 a 396 840
a Fj(My)g(f)o(a)n(v)n(orite)g(grammar)f(is)i(ABNF)-7
b(,)21 b(as)g(de\002ned)e(by)1919 840 y
SDict begin H.S end
 1919 840 a 1919
840 a
SDict begin 13 H.A end
 1919 840 a 1919 840 a
SDict begin [/View [/XYZ H.V]/Dest (0:3518) cvn /DEST pdfmark end
 1919 840 a Fj(RFC)j(2234)c(\(http://www)-5
b(.ietf.or)o(g/rfc/rfc223)o(4.)o(txt\),)14 b(because)20
b(it)396 948 y(is)h(probably)d(the)i(simplest)h(and)f(most)g(widely)g
(used)g(formal)f(language)f(for)i(de\002ning)f(bidirectional)396
1056 y(communications)f(protocols.)g(Most)j(IETF)f(\(Internet)e
(Engineering)g(T)-7 b(ask)21 b(F)o(orce\))e(speci\002cations)g(use)i
(ABNF)-7 b(,)396 1164 y(which)20 b(is)h(good)e(compan)o(y)f(to)i(be)g
(in.)-2 1348 y
SDict begin H.S end
 -2 1348 a -2 1348 a
SDict begin 13 H.A end
 -2 1348 a -2 1348
a
SDict begin [/View [/XYZ H.V]/Dest (0:3519) cvn /DEST pdfmark end
 -2 1348 a 396 1438 a Fj(I')o(ll)h(gi)n(v)o(e)e(a)i(30-second)d(crash)
i(course)f(in)h(writing)g(ABNF)-7 b(.)21 b(It)g(may)e(remind)g(you)h
(of)g(re)o(gular)e(e)o(xpressions.)h(Y)-9 b(ou)19 b(write)396
1546 y(the)h(grammar)f(as)i(rules.)f(Each)f(rule)h(tak)o(es)h(the)f
(form)f("name)h(=)g(elements".)g(An)g(element)g(can)g(be)g(another)e
(rule)396 1654 y(\(which)i(you)f(de\002ne)h(belo)n(w)f(as)i(another)e
(rule\),)g(or)h(a)h(pre-de\002ned)c("terminal")j(lik)o(e)g(CRLF)-7
b(,)22 b(OCTET)-6 b(,)19 b(or)h(a)h(number)-5 b(.)396
1762 y
SDict begin H.S end
 396 1762 a 396 1762 a
SDict begin 13 H.A end
 396 1762 a 396 1762 a
SDict begin [/View [/XYZ H.V]/Dest (0:3520) cvn /DEST pdfmark end
 396
1762 a Fj(The)20 b(RFC)i(\(http://www)-5 b(.ietf.or)o(g/rfc/rfc22)o(34)
o(.tx)o(t\))15 b(lists)22 b(all)e(the)h(terminals.)e(T)-7
b(o)20 b(de\002ne)g(alternati)n(v)o(e)f(elements,)h(use)396
1870 y("element)g(/)h(element".)e(T)-7 b(o)20 b(de\002ne)g(repetition,)
f(use)h("*")g(\(read)f(the)h(RFC)i(since)e(it')-5 b(s)22
b(not)e(intuiti)n(v)o(e\).)e(T)-7 b(o)21 b(group)396
1978 y(elements,)f(use)g(parentheses.)-2 2162 y
SDict begin H.S end
 -2 2162
a -2 2162 a
SDict begin 13 H.A end
 -2 2162 a -2 2162 a
SDict begin [/View [/XYZ H.V]/Dest (0:3521) cvn /DEST pdfmark end
 -2 2162 a 396 2252 a
Fj(I'm)g(not)g(sure)g(if)g(this)h(e)o(xtension)e(is)i(proper)m(,)d(b)n
(ut)i(I)g(then)g(pre\002x)g(elements)f(with)i("C:")g(and)e("S:")i(to)f
(indicate)g(whether)396 2360 y(the)o(y)g(come)f(from)g(the)i(client)f
(or)g(serv)o(er)-5 b(.)-2 2544 y
SDict begin H.S end
 -2 2544 a -2 2544 a
SDict begin 13 H.A end

-2 2544 a -2 2544 a
SDict begin [/View [/XYZ H.V]/Dest (0:3522) cvn /DEST pdfmark end
 -2 2544 a 396 2634 a Fj(Here')g(s)21
b(a)f(piece)g(of)g(ABNF)h(for)f(an)g(unprotocol)e(called)i(NOM)g(that)g
(we')o(ll)h(come)e(back)h(to)g(later)g(in)h(this)g(chapter:)-2
2735 y
SDict begin H.S end
 -2 2735 a -2 2735 a
SDict begin 11.7 H.A end
 -2 2735 a -2 2735 a
SDict begin [/View [/XYZ H.V]/Dest (0:3523) cvn /DEST pdfmark end
 -2 2735
a 396 2814 a Fg(nom-protocol)178 b(=)44 b(open-peering)1786
2827 y(*)1831 2814 y(use-peering)396 3008 y(open-peering)178
b(=)44 b(C:OHAI)g(\()h(S:OHAI-OK)e(/)i(S:WTF)f(\))396
3202 y(use-peering)223 b(=)44 b(C:ICANHAZ)1114 3300 y(/)g
(S:CHEEZBURGER)1114 3397 y(/)g(C:HUGZ)g(S:HUGZ-OK)1114
3494 y(/)g(S:HUGZ)g(C:HUGZ-OK)-2 3666 y
SDict begin H.S end
 -2 3666 a -2
3666 a
SDict begin 13 H.A end
 -2 3666 a -2 3666 a
SDict begin [/View [/XYZ H.V]/Dest (0:3524) cvn /DEST pdfmark end
 -2 3666 a 396 3768 a Fj(I')l(v)o(e)19
b(actually)h(used)g(these)g(k)o(e)o(yw)o(ords)f(\(OHAI,)g(WTF\))i(in)f
(commercial)f(projects.)h(The)o(y)f(mak)o(e)g(de)n(v)o(elopers)f
(giggly)396 3876 y(and)i(happ)o(y)-5 b(.)18 b(The)o(y)h(confuse)g
(management.)f(The)o(y')l(re)g(good)h(in)h(\002rst)h(drafts)f(that)g
(you)f(w)o(ant)i(to)f(thro)n(w)g(a)o(w)o(ay)f(later)-5
b(.)-2 3987 y
SDict begin H.S end
 -2 3987 a -2 3987 a
SDict begin 13 H.A end
 -2 3987 a -2 3987 a
SDict begin [/View [/XYZ H.V]/Dest (0:3525) cvn /DEST pdfmark end

-2 3987 a 359 x Fh(6.7.)39 b(Serializing)e(y)l(our)j(Data)1694
4346 y
SDict begin H.S end
 1694 4346 a 1694 4346 a
SDict begin 22.464 H.A end
 1694 4346 a 1694 4346
a
SDict begin [/View [/XYZ H.V]/Dest (11.66.1) cvn /DEST pdfmark end
 1694 4346 a -2 4544 a
SDict begin H.S end
 -2 4544 a -2 4544 a
SDict begin 13 H.A end
 -2 4544 a
-2 4544 a
SDict begin [/View [/XYZ H.V]/Dest (0:3527) cvn /DEST pdfmark end
 -2 4544 a 396 4620 a Fj(When)20 b(we)h(start)g(to)f(design)f
(a)i(protocol,)d(one)i(of)g(the)g(\002rst)h(questions)e(we)i(f)o(ace)f
(is)h(ho)n(w)f(we)g(encode)f(data)h(on)g(the)g(wire.)396
4728 y(There)g(is,)h(sadly)-5 b(,)19 b(no)h(uni)n(v)o(ersal)e(answer)-5
b(.)21 b(There)e(are)h(a)h(half-dozen)c(dif)n(ferent)i(w)o(ays)h(to)h
(serialize)f(data,)g(each)g(with)396 4836 y(pros)g(and)g(cons.)f(W)-7
b(e')o(ll)22 b(e)o(xplore)c(these.)p Black 3756 5569
a Fi(267)p Black eop end
%%Page: 268 282
TeXDict begin 268 281 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.268) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3528) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Ho)n(we)n(v)o(er)m(,)f(there)i(is)h(a)g(general)e
(lesson)h(I')l(v)o(e)f(learned)g(o)o(v)o(er)g(a)i(couple)e(of)h
(decades)f(of)h(writing)g(protocols)f(small)h(and)396
180 y(lar)o(ge.)f(I)i(call)f(this)h(the)f("Cheap)g(and)g(Nasty")g
(pattern:)f(you)h(can)g(often)f(split)i(your)e(w)o(ork)g(into)h(tw)o(o)
h(layers,)e(and)h(solv)o(e)396 288 y(these)h(separately)-5
b(,)18 b(one)i(using)g(a)g("cheap")f(approach,)f(the)i(other)g(using)f
(a)i("nasty")f(approach.)-2 306 y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2
306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:3529) cvn /DEST pdfmark end
 -2 306 a 396 616 a Fd(6.7.1.)36 b(Cheap)e(and)g(Nasty)
1697 616 y
SDict begin H.S end
 1697 616 a 1697 616 a
SDict begin 18.72 H.A end
 1697 616 a 1697 616
a
SDict begin [/View [/XYZ H.V]/Dest (11.66.52.2) cvn /DEST pdfmark end
 1697 616 a -2 807 a
SDict begin H.S end
 -2 807 a -2 807 a
SDict begin 13 H.A end
 -2 807 a -2 807
a
SDict begin [/View [/XYZ H.V]/Dest (0:3531) cvn /DEST pdfmark end
 -2 807 a 396 890 a Fj(The)20 b(k)o(e)o(y)g(insight)g(to)g(making)f
(Cheap)h(and)f(Nasty)i(w)o(ork)e(is)i(to)g(realize)f(that)g(man)o(y)f
(protocols)g(mix)h(a)g(lo)n(w-v)n(olume)396 998 y(chatty)g(part)g(for)f
(control,)g(and)h(a)g(high-v)n(olume)e(asynchronous)f(part)j(for)f
(data.)h(F)o(or)g(instance,)g(HTTP)g(has)g(a)h(chatty)396
1106 y(dialog)f(to)g(authenticate)f(and)g(get)i(pages,)e(and)h(an)g
(asynchronous)d(dialog)j(to)g(stream)g(data.)g(FTP)h(actually)e(splits)
i(this)396 1214 y(o)o(v)o(er)e(tw)o(o)i(ports;)e(one)h(port)g(for)f
(control)g(and)h(one)f(port)h(for)f(data.)-2 1398 y
SDict begin H.S end
 -2
1398 a -2 1398 a
SDict begin 13 H.A end
 -2 1398 a -2 1398 a
SDict begin [/View [/XYZ H.V]/Dest (0:3532) cvn /DEST pdfmark end
 -2 1398 a 396 1488
a Fj(Protocol)g(designers)h(who)f(don')o(t)g(separate)h(control)f(from)
g(data)h(tend)g(to)g(mak)o(e)g(a)o(wful)f(protocols,)g(because)g(the)
396 1596 y(trade-of)n(fs)g(in)h(the)g(tw)o(o)h(cases)g(are)f(almost)g
(totally)g(opposite.)f(What)h(is)h(perfect)f(for)f(control)g(is)i
(terrible)f(for)f(data,)h(and)396 1704 y(what')-5 b(s)21
b(ideal)f(for)f(data)h(just)g(doesn')o(t)f(w)o(ork)g(for)h(control.)e
(It')-5 b(s)21 b(especially)e(true)h(when)f(we)i(w)o(ant)f
(high-performance)15 b(at)396 1812 y(the)20 b(same)h(time)f(as)h(e)o
(xtensibility)e(and)h(good)f(error)g(checking.)-2 1996
y
SDict begin H.S end
 -2 1996 a -2 1996 a
SDict begin 13 H.A end
 -2 1996 a -2 1996 a
SDict begin [/View [/XYZ H.V]/Dest (0:3533) cvn /DEST pdfmark end
 -2 1996 a 396
2086 a Fj(Let')-5 b(s)21 b(break)e(this)i(do)n(wn)e(using)h(a)g
(classic)h(client-serv)o(er)e(use-case.)h(The)f(client)i(connects)e(to)
h(the)g(serv)o(er)m(,)f(and)396 2194 y(authenticates.)g(It)i(then)e
(asks)i(for)f(some)g(resource.)e(The)i(serv)o(er)g(chats)g(back,)f
(then)h(starts)h(to)f(send)g(data)g(back)g(to)g(the)396
2302 y(client.)g(Ev)o(entually)e(the)j(client)f(disconnects)f(or)h(the)
g(serv)o(er)g(\002nishes,)g(and)f(the)i(con)m(v)o(ersation)c(is)k(o)o
(v)o(er)-5 b(.)-2 2486 y
SDict begin H.S end
 -2 2486 a -2 2486 a
SDict begin 13 H.A end
 -2 2486
a -2 2486 a
SDict begin [/View [/XYZ H.V]/Dest (0:3534) cvn /DEST pdfmark end
 -2 2486 a 396 2576 a Fj(No)n(w)g(,)20 b(before)e(starting)i
(to)h(design)e(these)i(messages,)f(stop)g(and)f(think,)h(and)f(let')-5
b(s)21 b(compare)e(the)h(control)f(dialog,)g(and)396
2684 y(the)h(data)h(\003o)n(w:)-2 2685 y
SDict begin H.S end
 -2 2685 a -2
2685 a
SDict begin 13 H.A end
 -2 2685 a -2 2685 a
SDict begin [/View [/XYZ H.V]/Dest (0:3535) cvn /DEST pdfmark end
 -2 2685 a -2 2695 a
SDict begin H.S end
 -2 2695
a -2 2695 a
SDict begin 13 H.A end
 -2 2695 a -2 2695 a
SDict begin [/View [/XYZ H.V]/Dest (0:3536) cvn /DEST pdfmark end
 -2 2695 a Black 396 2854
a Fe(\225)p Black 479 2854 a
SDict begin H.S end
 479 2854 a 479 2854 a
SDict begin 13 H.A end
 479
2854 a 479 2854 a
SDict begin [/View [/XYZ H.V]/Dest (0:3537) cvn /DEST pdfmark end
 479 2854 a Fj(The)f(control)f(dialog)g(lasts)j(a)e
(short)g(time)h(and)e(in)m(v)n(olv)o(e)g(v)o(ery)g(fe)n(w)h(messages.)g
(The)g(data)g(\003o)n(w)g(could)f(last)j(for)d(hours)479
2962 y(or)h(days,)g(and)g(in)m(v)n(olv)o(e)e(billions)i(of)g(messages.)
-2 2980 y
SDict begin H.S end
 -2 2980 a -2 2980 a
SDict begin 13 H.A end
 -2 2980 a -2 2980 a
SDict begin [/View [/XYZ H.V]/Dest (0:3538) cvn /DEST pdfmark end
 -2
2980 a Black 396 3111 a Fe(\225)p Black 479 3111 a
SDict begin H.S end
 479
3111 a 479 3111 a
SDict begin 13 H.A end
 479 3111 a 479 3111 a
SDict begin [/View [/XYZ H.V]/Dest (0:3539) cvn /DEST pdfmark end
 479 3111 a Fj(The)g(control)f
(dialog)g(is)j(where)d(all)i(the)f("normal")f(errors)g(happen,)f(e.g.)i
(not)g(authenticated,)e(not)i(found,)e(payment)479 3219
y(required,)g(censored,)h(etc.)h(An)o(y)g(errors)f(that)h(happen)f
(during)f(the)j(data)f(\003o)n(w)g(are)g(e)o(xceptional)e(\(disk)i
(full,)g(serv)o(er)479 3327 y(crashed\).)-2 3342 y
SDict begin H.S end
 -2
3342 a -2 3342 a
SDict begin 13 H.A end
 -2 3342 a -2 3342 a
SDict begin [/View [/XYZ H.V]/Dest (0:3540) cvn /DEST pdfmark end
 -2 3342 a Black
396 3477 a Fe(\225)p Black 479 3477 a
SDict begin H.S end
 479 3477 a 479
3477 a
SDict begin 13 H.A end
 479 3477 a 479 3477 a
SDict begin [/View [/XYZ H.V]/Dest (0:3541) cvn /DEST pdfmark end
 479 3477 a Fj(The)g(control)f(dialog)g(is)
j(where)d(things)h(will)h(change)e(o)o(v)o(er)f(time,)j(as)f(we)h(add)f
(more)f(options,)g(parameters,)g(and)g(so)479 3584 y(on.)h(The)g(data)g
(\003o)n(w)g(should)f(barely)g(change)g(o)o(v)o(er)g(time)h(since)h
(the)f(semantics)g(of)g(a)h(resource)e(are)h(f)o(airly)g(constant)479
3692 y(o)o(v)o(er)f(time.)-2 3693 y
SDict begin H.S end
 -2 3693 a -2 3693
a
SDict begin 13 H.A end
 -2 3693 a -2 3693 a
SDict begin [/View [/XYZ H.V]/Dest (0:3542) cvn /DEST pdfmark end
 -2 3693 a Black 396 3842 a Fe(\225)p
Black 479 3842 a
SDict begin H.S end
 479 3842 a 479 3842 a
SDict begin 13 H.A end
 479 3842 a 479
3842 a
SDict begin [/View [/XYZ H.V]/Dest (0:3543) cvn /DEST pdfmark end
 479 3842 a Fj(The)h(control)f(dialog)g(is)j(essentially)e(a)g
(synchronous)e(request/reply)g(dialog.)h(The)h(data)g(\003o)n(w)g(is)h
(essentially)g(a)479 3950 y(1-w)o(ay)f(asynchronous)d(\003o)n(w)-5
b(.)-2 4134 y
SDict begin H.S end
 -2 4134 a -2 4134 a
SDict begin 13 H.A end
 -2 4134 a -2 4134 a
SDict begin [/View [/XYZ H.V]/Dest (0:3544) cvn /DEST pdfmark end

-2 4134 a 396 4224 a Fj(These)20 b(dif)n(ferences)f(are)h(critical.)g
(When)g(we)g(talk)h(about)e(performance,)e(it)k(applies)2868
4224 y
SDict begin H.S end
 2868 4224 a 2868 4224 a
SDict begin 13 H.A end
 2868 4224 a 2868 4224
a
SDict begin [/View [/XYZ H.V]/Dest (0:3545) cvn /DEST pdfmark end
 2868 4224 a Fi(only)f Fj(to)g(data)g(\003o)n(ws.)g(It')-5
b(s)396 4332 y(pathological)18 b(to)j(design)e(a)i(one-time)e(control)g
(dialog)g(to)h(be)h(f)o(ast.)f(When)g(we)h(talk)f(about)f(the)h(cost)h
(of)f(serialization,)396 4440 y(thus,)g(this)h(only)e(applies)h(to)h
(the)f(data)g(\003o)n(w)-5 b(.)19 b(The)h(cost)h(of)f
(encoding/decoding)15 b(the)21 b(control)d(\003o)n(w)j(could)e(be)h
(huge,)396 4548 y(and)g(for)f(man)o(y)g(cases)i(it)g(w)o(ould)f(not)g
(change)e(a)j(thing.)e(So,)h(we)h(encode)e(control)g(using)h("Cheap",)f
(and)h(we)g(encode)396 4655 y(data)g(\003o)n(ws)h(using)f("Nasty".)-2
4839 y
SDict begin H.S end
 -2 4839 a -2 4839 a
SDict begin 13 H.A end
 -2 4839 a -2 4839 a
SDict begin [/View [/XYZ H.V]/Dest (0:3546) cvn /DEST pdfmark end
 -2 4839
a 396 4929 a Fj(Cheap)g(is)h(essentially)g(synchronous,)c(v)o(erbose,)h
(descripti)n(v)o(e,)h(and)g(\003e)o(xible.)h(A)g(Cheap)g(message)g(is)h
(full)f(of)g(rich)396 5037 y(information)e(that)i(can)g(change)f(for)h
(each)g(application.)e(Y)-9 b(our)19 b(goal)h(as)h(designer)e(is)i(to)f
(mak)o(e)g(this)h(information)d(easy)p Black 3759 5569
a Fi(268)p Black eop end
%%Page: 269 283
TeXDict begin 269 282 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.269) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(to)i(encode)d(and)i(to)g(parse,)g(tri)n(vial)g(to)h
(e)o(xtend)d(for)i(e)o(xperimentation)d(or)j(gro)n(wth,)f(and)g(highly)
g(rob)n(ust)h(against)f(change)396 180 y(both)h(forw)o(ards)f(and)g
(backw)o(ards.)g(The)h(Cheap)g(part)g(of)f(a)i(protocol)e(looks)g(lik)o
(e)i(this:)-2 198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198
a
SDict begin [/View [/XYZ H.V]/Dest (0:3547) cvn /DEST pdfmark end
 -2 198 a -2 208 a
SDict begin H.S end
 -2 208 a -2 208 a
SDict begin 13 H.A end
 -2 208 a -2 208
a
SDict begin [/View [/XYZ H.V]/Dest (0:3548) cvn /DEST pdfmark end
 -2 208 a Black 396 351 a Fe(\225)p Black 479 351 a
SDict begin H.S end

479 351 a 479 351 a
SDict begin 13 H.A end
 479 351 a 479 351 a
SDict begin [/View [/XYZ H.V]/Dest (0:3549) cvn /DEST pdfmark end
 479 351 a Fj(It)g(uses)f(a)h
(simple)f(self-describing)e(structured)h(encoding)f(for)i(data,)g(be)g
(it)h(XML,)f(JSON,)h(HTTP-style)e(headers,)479 459 y(or)h(some)g(other)
-5 b(.)20 b(An)o(y)f(encoding)f(is)j(\002ne)g(so)f(long)g(as)h(there)e
(are)h(standard)f(simple)i(parsers)f(for)f(it)i(in)f(your)f(tar)o(get)
479 566 y(languages.)-2 584 y
SDict begin H.S end
 -2 584 a -2 584 a
SDict begin 13 H.A end
 -2 584
a -2 584 a
SDict begin [/View [/XYZ H.V]/Dest (0:3550) cvn /DEST pdfmark end
 -2 584 a Black 396 716 a Fe(\225)p Black 479
716 a
SDict begin H.S end
 479 716 a 479 716 a
SDict begin 13 H.A end
 479 716 a 479 716 a
SDict begin [/View [/XYZ H.V]/Dest (0:3551) cvn /DEST pdfmark end
 479 716
a Fj(It)i(uses)f(a)h(straight)f(request-reply)e(model)h(where)h(each)f
(request)h(has)g(a)h(success/f)o(ailure)f(reply)-5 b(.)18
b(This)j(mak)o(es)f(it)479 824 y(tri)n(vial)g(to)h(write)f(correct)f
(clients)i(and)e(serv)o(ers)h(for)g(a)g(Cheap)g(dialog.)-2
842 y
SDict begin H.S end
 -2 842 a -2 842 a
SDict begin 13 H.A end
 -2 842 a -2 842 a
SDict begin [/View [/XYZ H.V]/Dest (0:3552) cvn /DEST pdfmark end
 -2 842 a Black
396 973 a Fe(\225)p Black 479 973 a
SDict begin H.S end
 479 973 a 479 973
a
SDict begin 13 H.A end
 479 973 a 479 973 a
SDict begin [/View [/XYZ H.V]/Dest (0:3553) cvn /DEST pdfmark end
 479 973 a Fj(It)h(doesn')o(t)d(try)-5
b(,)20 b(e)n(v)o(en)f(mar)o(ginally)-5 b(,)17 b(to)k(be)f(f)o(ast.)g
(Performance)e(doesn')o(t)h(matter)h(when)f(you)h(do)f(something)g
(once)h(or)479 1081 y(a)h(fe)n(w)f(times)h(per)e(session.)-2
1265 y
SDict begin H.S end
 -2 1265 a -2 1265 a
SDict begin 13 H.A end
 -2 1265 a -2 1265 a
SDict begin [/View [/XYZ H.V]/Dest (0:3554) cvn /DEST pdfmark end
 -2 1265
a 396 1355 a Fj(A)i(Cheap)f(parser)f(is)j(something)c(you)i(tak)o(e)g
(of)n(f)f(the)h(shelf,)g(and)g(thro)n(w)f(data)h(at.)h(It)f(shouldn')o
(t)e(crash,)i(shouldn')o(t)e(leak)396 1463 y(memory)-5
b(,)18 b(should)h(be)h(highly)f(tolerant,)g(and)h(should)f(be)h(relati)
n(v)o(ely)f(simple)i(to)f(w)o(ork)f(with.)i(That')-5
b(s)20 b(it.)-2 1647 y
SDict begin H.S end
 -2 1647 a -2 1647 a
SDict begin 13 H.A end
 -2 1647 a
-2 1647 a
SDict begin [/View [/XYZ H.V]/Dest (0:3555) cvn /DEST pdfmark end
 -2 1647 a 396 1737 a Fj(Nasty)g(ho)n(we)n(v)o(er)e(is)j
(essentially)f(asynchronous,)d(terse,)j(silent,)g(and)f(in\003e)o
(xible.)g(A)h(Nasty)g(message)g(carries)f(minimal)396
1845 y(information)f(that)i(practically)g(ne)n(v)o(er)e(changes.)h(Y)-9
b(our)19 b(goal)h(as)h(designer)e(is)i(to)g(mak)o(e)e(this)i
(information)d(ultraf)o(ast)i(to)396 1953 y(parse,)g(and)g(possibly)f
(e)n(v)o(en)g(impossible)h(to)g(e)o(xtend)f(and)h(e)o(xperiment)e
(with.)i(The)g(ideal)g(Nasty)g(pattern)g(looks)f(lik)o(e)396
2061 y(this:)-2 2062 y
SDict begin H.S end
 -2 2062 a -2 2062 a
SDict begin 13 H.A end
 -2 2062 a
-2 2062 a
SDict begin [/View [/XYZ H.V]/Dest (0:3556) cvn /DEST pdfmark end
 -2 2062 a -2 2072 a
SDict begin H.S end
 -2 2072 a -2 2072 a
SDict begin 13 H.A end
 -2
2072 a -2 2072 a
SDict begin [/View [/XYZ H.V]/Dest (0:3557) cvn /DEST pdfmark end
 -2 2072 a Black 396 2231 a Fe(\225)p
Black 479 2231 a
SDict begin H.S end
 479 2231 a 479 2231 a
SDict begin 13 H.A end
 479 2231 a 479
2231 a
SDict begin [/View [/XYZ H.V]/Dest (0:3558) cvn /DEST pdfmark end
 479 2231 a Fj(It)i(uses)f(a)h(hand-optimized)c(binary)i(layout)g
(for)h(data,)g(where)f(e)n(v)o(ery)g(bit)h(is)i(precisely)d(crafted.)-2
2249 y
SDict begin H.S end
 -2 2249 a -2 2249 a
SDict begin 13 H.A end
 -2 2249 a -2 2249 a
SDict begin [/View [/XYZ H.V]/Dest (0:3559) cvn /DEST pdfmark end
 -2 2249
a Black 396 2380 a Fe(\225)p Black 479 2380 a
SDict begin H.S end
 479 2380
a 479 2380 a
SDict begin 13 H.A end
 479 2380 a 479 2380 a
SDict begin [/View [/XYZ H.V]/Dest (0:3560) cvn /DEST pdfmark end
 479 2380 a Fj(It)i(uses)f(a)h(pure)e
(asynchronous)f(model)h(where)h(one)f(or)h(both)f(peers)h(send)g(data)g
(without)g(ackno)n(wledgments)d(\(or)j(if)479 2488 y(the)o(y)g(do,)f
(the)o(y)h(use)g(sneak)o(y)f(asynchronous)f(techniques)g(lik)o(e)j
(credit-based)d(\003o)n(w)j(control\).)-2 2506 y
SDict begin H.S end
 -2 2506
a -2 2506 a
SDict begin 13 H.A end
 -2 2506 a -2 2506 a
SDict begin [/View [/XYZ H.V]/Dest (0:3561) cvn /DEST pdfmark end
 -2 2506 a Black 396 2638
a Fe(\225)p Black 479 2638 a
SDict begin H.S end
 479 2638 a 479 2638 a
SDict begin 13 H.A end
 479
2638 a 479 2638 a
SDict begin [/View [/XYZ H.V]/Dest (0:3562) cvn /DEST pdfmark end
 479 2638 a Fj(It)g(doesn')o(t)d(try)-5
b(,)20 b(e)n(v)o(en)f(mar)o(ginally)-5 b(,)17 b(to)k(be)f(friendly)-5
b(.)18 b(Performance)g(is)j(all)g(that)f(matters)g(when)g(you)f(are)h
(doing)479 2746 y(something)f(se)n(v)o(eral)h(million)f(times)i(per)f
(second.)-2 2930 y
SDict begin H.S end
 -2 2930 a -2 2930 a
SDict begin 13 H.A end
 -2 2930 a -2 2930
a
SDict begin [/View [/XYZ H.V]/Dest (0:3563) cvn /DEST pdfmark end
 -2 2930 a 396 3020 a Fj(A)h(Nasty)f(parser)g(is)h(something)e(you)g
(write)h(by)g(hand,)f(which)h(writes)g(or)g(reads)g(bits,)h(bytes,)f(w)
o(ords,)f(and)h(inte)o(gers)396 3128 y(indi)n(vidually)e(and)h
(precisely)-5 b(.)19 b(It)h(rejects)g(an)o(ything)e(it)i(doesn')o(t)e
(lik)o(e,)i(does)g(no)f(memory)f(allocations)h(at)i(all,)f(and)f(ne)n
(v)o(er)396 3236 y(crashes.)-2 3402 y
SDict begin H.S end
 -2 3402 a -2 3402
a
SDict begin 13 H.A end
 -2 3402 a -2 3402 a
SDict begin [/View [/XYZ H.V]/Dest (0:3564) cvn /DEST pdfmark end
 -2 3402 a 396 3510 a Fj(Cheap)h(and)g(Nasty)g
(isn')o(t)g(a)h(uni)n(v)o(ersal)d(pattern;)i(not)g(all)h(protocols)d
(ha)n(v)o(e)i(this)h(dichotomy)-5 b(.)17 b(Also,)j(ho)n(w)g(you)f(use)
396 3618 y(Cheap)h(and)f(Nasty)h(will)h(depend.)d(In)h(some)h(cases,)g
(it)h(can)e(be)h(tw)o(o)g(parts)g(of)f(a)i(single)e(protocol.)f(In)i
(other)f(cases)h(it)h(can)396 3725 y(be)f(tw)o(o)h(protocols,)d(one)i
(layered)f(on)h(top)g(of)g(the)g(other)-5 b(.)-2 3754
y
SDict begin H.S end
 -2 3754 a -2 3754 a
SDict begin 13 H.A end
 -2 3754 a -2 3754 a
SDict begin [/View [/XYZ H.V]/Dest (0:3565) cvn /DEST pdfmark end
 -2 3754 a 396
4064 a Fd(6.7.2.)36 b(\330MQ)c(Framing)1518 4064 y
SDict begin H.S end
 1518
4064 a 1518 4064 a
SDict begin 18.72 H.A end
 1518 4064 a 1518 4064 a
SDict begin [/View [/XYZ H.V]/Dest (11.66.53.2) cvn /DEST pdfmark end
 1518 4064
a -2 4257 a
SDict begin H.S end
 -2 4257 a -2 4257 a
SDict begin 13 H.A end
 -2 4257 a -2 4257 a
SDict begin [/View [/XYZ H.V]/Dest (0:3567) cvn /DEST pdfmark end
 -2
4257 a 396 4338 a Fj(The)20 b(simplest)h(and)e(most)i(widely)e(used)h
(serialization)g(format)f(for)g(\330MQ)i(applications)e(is)i(\330MQ')-5
b(s)21 b(o)n(wn)e(multi-part)396 4446 y(framing.)g(F)o(or)g(e)o
(xample,)g(here)h(is)h(ho)n(w)e(the)1681 4446 y
SDict begin H.S end
 1681
4446 a 1681 4446 a
SDict begin 13 H.A end
 1681 4446 a 1681 4446 a
SDict begin [/View [/XYZ H.V]/Dest (0:3568) cvn /DEST pdfmark end
 1681 4446
a Fj(Majordomo)e(Protocol)i(\(http://rfc.zeromq.or)o(g/spec:7\))14
b(de\002nes)20 b(a)396 4554 y(request:)-2 4655 y
SDict begin H.S end
 -2 4655
a -2 4655 a
SDict begin 11.7 H.A end
 -2 4655 a -2 4655 a
SDict begin [/View [/XYZ H.V]/Dest (0:3569) cvn /DEST pdfmark end
 -2 4655 a 396 4734 a
Fg(Frame)44 b(0:)h(Empty)f(frame)396 4831 y(Frame)g(1:)h("MDPW01")e
(\(six)h(bytes,)g(representing)f(MDP/Worker)g(v0.1\))396
4928 y(Frame)h(2:)h(0x02)f(\(one)g(byte,)g(representing)f(REQUEST\))396
5025 y(Frame)h(3:)h(Client)f(address)f(\(envelope)h(stack\))396
5122 y(Frame)g(4:)h(Empty)f(\(zero)g(bytes,)g(envelope)f(delimiter\))p
Black 3759 5569 a Fi(269)p Black eop end
%%Page: 270 284
TeXDict begin 270 283 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.270) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fg(Frames)44 b(5+:)g(Request)g(body)g(\(opaque)g
(binary\))-2 250 y
SDict begin H.S end
 -2 250 a -2 250 a
SDict begin 13 H.A end
 -2 250 a -2 250
a
SDict begin [/View [/XYZ H.V]/Dest (0:3570) cvn /DEST pdfmark end
 -2 250 a 396 346 a Fj(T)-7 b(o)21 b(read)e(and)h(write)g(this)h(in)f
(code)g(is)h(easy)-5 b(.)20 b(But)g(this)h(is)g(a)g(classic)g(e)o
(xample)e(of)h(a)g(control)f(\003o)n(w)h(\(the)g(whole)g(of)g(MDP)396
454 y(is,)h(really)-5 b(,)19 b(since)i(it')-5 b(s)21
b(a)g(chatty)e(request-reply)f(protocol\).)g(When)i(we)g(came)g(to)h
(impro)o(v)o(e)d(MDP)i(for)g(the)g(second)396 562 y(v)o(ersion,)f(we)i
(had)e(to)h(change)f(this)i(framing.)d(Excellent,)i(we)g(brok)o(e)f
(all)i(e)o(xisting)e(implementations!)-2 746 y
SDict begin H.S end
 -2 746
a -2 746 a
SDict begin 13 H.A end
 -2 746 a -2 746 a
SDict begin [/View [/XYZ H.V]/Dest (0:3571) cvn /DEST pdfmark end
 -2 746 a 396 836 a Fj(Backw)o(ards)h
(compatibility)f(is)i(hard,)e(b)n(ut)h(using)g(\330MQ)g(framing)f(for)g
(control)g(\003o)n(ws)2910 836 y
SDict begin H.S end
 2910 836 a 2910 836
a
SDict begin 13 H.A end
 2910 836 a 2910 836 a
SDict begin [/View [/XYZ H.V]/Dest (0:3572) cvn /DEST pdfmark end
 2910 836 a Fi(does)h(not)g(help)p
Fj(.)f(Here')-5 b(s)21 b(ho)n(w)e(I)396 944 y(should)g(ha)n(v)o(e)g
(designed)f(this)i(protocol)e(if)i(I')l(d)e(follo)n(wed)g(by)i(o)n(wn)f
(advice)f(\(and)h(I')o(ll)h(\002x)f(this)h(in)g(the)g(ne)o(xt)e(v)o
(ersion\).)g(It')-5 b(s)396 1052 y(split)21 b(into)f(a)h(Cheap)e(part)h
(and)g(a)h(Nasty)f(part,)g(and)f(uses)i(the)f(\330MQ)h(framing)d(to)j
(separate)e(these:)-2 1153 y
SDict begin H.S end
 -2 1153 a -2 1153 a
SDict begin 11.7 H.A end
 -2 1153
a -2 1153 a
SDict begin [/View [/XYZ H.V]/Dest (0:3573) cvn /DEST pdfmark end
 -2 1153 a 396 1232 a Fg(Frame)44 b(0:)h("MDP/2.0")e(for)h
(protocol)g(name)g(and)g(version)396 1329 y(Frame)g(1:)h(command)e
(header)396 1427 y(Frame)h(2:)h(command)e(body)-2 1604
y
SDict begin H.S end
 -2 1604 a -2 1604 a
SDict begin 13 H.A end
 -2 1604 a -2 1604 a
SDict begin [/View [/XYZ H.V]/Dest (0:3574) cvn /DEST pdfmark end
 -2 1604 a 396
1701 a Fj(Where)20 b(we')l(d)g(e)o(xpect)f(the)h(parse)g(the)g(command)
f(header)g(in)h(the)g(v)n(arious)f(intermediaries)g(\(client)h(API,)g
(brok)o(er)m(,)e(and)396 1808 y(w)o(ork)o(er)h(API\),)h(and)g(pass)h
(the)f(command)e(body)h(untouched)f(from)h(application)f(to)j
(application.)-2 1837 y
SDict begin H.S end
 -2 1837 a -2 1837 a
SDict begin 13 H.A end
 -2 1837 a
-2 1837 a
SDict begin [/View [/XYZ H.V]/Dest (0:3575) cvn /DEST pdfmark end
 -2 1837 a 396 2147 a Fd(6.7.3.)36 b(Serialization)e(Langua)o
(g)q(es)2095 2147 y
SDict begin H.S end
 2095 2147 a 2095 2147 a
SDict begin 18.72 H.A end
 2095 2147
a 2095 2147 a
SDict begin [/View [/XYZ H.V]/Dest (11.66.54.2) cvn /DEST pdfmark end
 2095 2147 a -2 2340 a
SDict begin H.S end
 -2 2340 a -2 2340
a
SDict begin 13 H.A end
 -2 2340 a -2 2340 a
SDict begin [/View [/XYZ H.V]/Dest (0:3577) cvn /DEST pdfmark end
 -2 2340 a 396 2421 a Fj(Serialization)20
b(languages)e(ha)n(v)o(e)i(their)g(f)o(ashions.)f(XML)i(used)f(to)g(be)
g(big)g(as)h(in)f(popular)m(,)e(then)i(it)h(got)e(big)h(as)h(in)396
2529 y(o)o(v)o(er)n(-engineered,)16 b(and)k(then)f(it)i(fell)g(into)f
(the)g(hands)f(of)h("Enterprise)f(Information)e(Architects")j(and)g
(it')-5 b(s)21 b(not)f(been)396 2637 y(seen)h(ali)n(v)o(e)e(since.)h(T)
-7 b(oday')i(s)20 b(XML)g(is)h(the)g(epitome)e(of)h("some)n(where)e(in)
j(that)f(mess)h(is)g(small,)f(ele)o(gant)f(language)396
2745 y(trying)g(to)i(escape".)-2 2929 y
SDict begin H.S end
 -2 2929 a -2
2929 a
SDict begin 13 H.A end
 -2 2929 a -2 2929 a
SDict begin [/View [/XYZ H.V]/Dest (0:3578) cvn /DEST pdfmark end
 -2 2929 a 396 3019 a Fj(Still)g(XML,)f(w)o
(as)i(w)o(ay)-5 b(,)19 b(w)o(ay)h(better)g(than)g(its)h(predecessors)e
(which)h(included)e(such)i(monsters)g(as)h(the)f(Standard)396
3127 y(Generalized)f(Markup)g(Language)f(\(SGML\),)h(which)h(in)g(turn)
g(were)g(a)g(cool)g(breeze)g(compared)e(to)i(mind-torturing)396
3235 y(beasts)h(lik)o(e)f(EDIF)-6 b(A)m(CT)g(.)20 b(So)g(the)g(history)
g(of)g(serialization)f(languages)g(seems)i(to)f(be)g(of)g(gradually)e
(emer)o(ging)g(sanity)-5 b(,)396 3342 y(hidden)19 b(by)h(w)o(a)n(v)o
(es)g(of)g(re)n(v)n(olting)f(EIAs)h(doing)f(their)h(best)h(to)f(hold)f
(onto)h(their)g(jobs.)-2 3526 y
SDict begin H.S end
 -2 3526 a -2 3526 a
SDict begin 13 H.A end
 -2
3526 a -2 3526 a
SDict begin [/View [/XYZ H.V]/Dest (0:3579) cvn /DEST pdfmark end
 -2 3526 a 396 3616 a Fj(JSON)h(popped)e(out)g(of)h
(the)h(Ja)n(v)n(aScript)e(w)o(orld)h(as)h(a)g(quick-and-dirty)16
b("I')l(d)j(rather)g(resign)h(than)g(use)g(XML)g(here")396
3724 y(w)o(ay)g(to)g(thro)n(w)g(data)g(onto)f(the)h(wire)g(and)f(get)h
(it)h(back)e(again.)g(JSON)i(is)g(just)g(minimal)e(XML)h(e)o(xpressed,)
e(sneakily)-5 b(,)19 b(as)396 3832 y(Ja)n(v)n(aScript)h(source)g(code.)
-2 4016 y
SDict begin H.S end
 -2 4016 a -2 4016 a
SDict begin 13 H.A end
 -2 4016 a -2 4016 a
SDict begin [/View [/XYZ H.V]/Dest (0:3580) cvn /DEST pdfmark end
 -2
4016 a 396 4106 a Fj(Here')-5 b(s)21 b(a)f(simple)g(e)o(xample)f(of)h
(using)g(JSON)h(in)f(a)h(Cheap)f(protocol:)-2 4207 y
SDict begin H.S end

-2 4207 a -2 4207 a
SDict begin 11.7 H.A end
 -2 4207 a -2 4207 a
SDict begin [/View [/XYZ H.V]/Dest (0:3581) cvn /DEST pdfmark end
 -2 4207 a 396
4286 a Fg("protocol":)43 b({)576 4384 y("name":)g("MTL",)576
4481 y("version":)g(1)396 4578 y(},)396 4675 y("virtual-host":)g
("test-env")-2 4842 y
SDict begin H.S end
 -2 4842 a -2 4842 a
SDict begin 13 H.A end
 -2 4842 a -2
4842 a
SDict begin [/View [/XYZ H.V]/Dest (0:3582) cvn /DEST pdfmark end
 -2 4842 a 396 4949 a Fj(The)20 b(same)g(in)h(XML)f(w)o(ould)g
(be)g(\(XML)g(forces)f(us)i(to)f(in)m(v)o(ent)f(a)h(single)g(top-le)n
(v)o(el)f(entity\):)-2 5050 y
SDict begin H.S end
 -2 5050 a -2 5050 a
SDict begin 11.7 H.A end
 -2
5050 a -2 5050 a
SDict begin [/View [/XYZ H.V]/Dest (0:3583) cvn /DEST pdfmark end
 -2 5050 a 396 5129 a Fg(<command>)p
Black 3759 5569 a Fi(270)p Black eop end
%%Page: 271 285
TeXDict begin 271 284 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.271) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 576 72 a Fg(<protocol)43 b(name)h(=)h("MTL")f(version)f(=)i("1")f
(/>)576 170 y(<virtual-host>test-env</virtual-host>)396
267 y(</command>)-2 439 y
SDict begin H.S end
 -2 439 a -2 439 a
SDict begin 13 H.A end
 -2 439 a
-2 439 a
SDict begin [/View [/XYZ H.V]/Dest (0:3584) cvn /DEST pdfmark end
 -2 439 a 396 541 a Fj(And)20 b(using)g(plain-old)e(HTTP-style)
i(headers:)-2 642 y
SDict begin H.S end
 -2 642 a -2 642 a
SDict begin 11.7 H.A end
 -2 642 a -2 642
a
SDict begin [/View [/XYZ H.V]/Dest (0:3585) cvn /DEST pdfmark end
 -2 642 a 396 721 a Fg(Protocol:)44 b(MTL/1.0)396 818
y(Virtual-host:)f(test-env)-2 985 y
SDict begin H.S end
 -2 985 a -2 985 a
SDict begin 13 H.A end

-2 985 a -2 985 a
SDict begin [/View [/XYZ H.V]/Dest (0:3586) cvn /DEST pdfmark end
 -2 985 a 396 1092 a Fj(These)20 b(are)g(all)h(pretty)
f(equi)n(v)n(alent)e(so)j(long)e(as)i(you)e(don')o(t)g(go)h(o)o(v)o
(erboard)c(with)21 b(v)n(alidating)d(parsers,)i(schemas)g(and)396
1200 y(such)g("trust)g(us,)h(this)f(is)i(all)e(for)g(your)f(o)n(wn)h
(good")e(nonsense.)h(A)i(Cheap)f(serialization)f(language)g(gi)n(v)o
(es)g(you)h(space)396 1308 y(for)g(e)o(xperimentation)d(for)i(free)h
(\("ignore)f(an)o(y)g(elements/attrib)n(utes/headers)f(that)i(you)g
(don')o(t)e(recognize"\),)g(and)h(it')-5 b(s)396 1416
y(simple)20 b(to)h(write)f(generic)f(parsers)h(that)g(e.g.)g(thunk)f(a)
i(command)d(into)i(a)g(hash)g(table,)g(or)g(vice-v)o(ersa.)-2
1600 y
SDict begin H.S end
 -2 1600 a -2 1600 a
SDict begin 13 H.A end
 -2 1600 a -2 1600 a
SDict begin [/View [/XYZ H.V]/Dest (0:3587) cvn /DEST pdfmark end
 -2 1600
a 396 1690 a Fj(Ho)n(we)n(v)o(er)f(it')-5 b(s)21 b(not)f(all)h(roses.)f
(While)h(modern)d(scripting)h(languages)g(support)g(JSON)i(and)f(XML)g
(easily)g(enough,)396 1798 y(older)g(languages)e(do)i(not.)g(If)g(you)f
(use)i(XML)f(or)g(JSON,)h(you)e(create)h(non-tri)n(vial)e
(dependencies.)g(It')-5 b(s)21 b(also)396 1906 y(some)n(what)f(of)g(a)g
(pain)g(to)g(w)o(ork)g(with)g(tree-structured)e(data)i(in)g(a)h
(language)d(lik)o(e)j(C.)-2 2090 y
SDict begin H.S end
 -2 2090 a -2 2090
a
SDict begin 13 H.A end
 -2 2090 a -2 2090 a
SDict begin [/View [/XYZ H.V]/Dest (0:3588) cvn /DEST pdfmark end
 -2 2090 a 396 2180 a Fj(So)g(you)e(can)h(dri)n(v)
o(e)f(your)g(choice)g(according)f(to)j(the)f(languages)f(you')l(re)f
(aiming)h(for)-5 b(.)20 b(If)g(your)f(uni)n(v)o(erse)g(is)i(a)g
(scripting)396 2288 y(language)d(then)h(go)g(for)g(JSON.)i(If)e(you)g
(are)g(aiming)g(to)h(b)n(uild)f(protocols)f(for)h(wider)g(system)h
(use,)g(k)o(eep)f(things)g(simple)396 2395 y(for)h(C)h(de)n(v)o
(elopers)d(and)i(stick)g(to)h(HTTP-style)e(headers.)-2
2424 y
SDict begin H.S end
 -2 2424 a -2 2424 a
SDict begin 13 H.A end
 -2 2424 a -2 2424 a
SDict begin [/View [/XYZ H.V]/Dest (0:3589) cvn /DEST pdfmark end
 -2 2424
a 396 2734 a Fd(6.7.4.)36 b(Serialization)e(Libraries)1970
2734 y
SDict begin H.S end
 1970 2734 a 1970 2734 a
SDict begin 18.72 H.A end
 1970 2734 a 1970 2734
a
SDict begin [/View [/XYZ H.V]/Dest (11.66.55.2) cvn /DEST pdfmark end
 1970 2734 a -2 2901 a
SDict begin H.S end
 -2 2901 a -2 2901 a
SDict begin 13 H.A end
 -2 2901 a
-2 2901 a
SDict begin [/View [/XYZ H.V]/Dest (0:3591) cvn /DEST pdfmark end
 -2 2901 a 396 3008 a Fj(The)20 b(msgpack.or)o(g)d(site)k
(says,)f("It')-5 b(s)21 b(lik)o(e)g(JSON.)g(b)n(ut)f(f)o(ast)h(and)e
(small.)i(MessageP)o(ack)e(is)i(an)f(ef)n(\002cient)g(binary)396
3116 y(serialization)g(format.)f(It)h(lets)h(you)f(e)o(xchange)e(data)i
(among)e(multiple)i(languages)f(lik)o(e)h(JSON)h(b)n(ut)f(it')-5
b(s)22 b(f)o(aster)e(and)396 3224 y(smaller)-5 b(.)21
b(F)o(or)e(e)o(xample,)g(small)i(inte)o(gers)e(\(lik)o(e)h(\003ags)h
(or)f(error)f(code\))g(are)h(encoded)e(into)i(a)h(single)f(byte,)f(and)
h(typical)396 3332 y(short)g(strings)g(only)g(require)e(an)j(e)o(xtra)e
(byte)h(in)g(addition)f(to)h(the)h(strings)f(themselv)o(es.")-2
3516 y
SDict begin H.S end
 -2 3516 a -2 3516 a
SDict begin 13 H.A end
 -2 3516 a -2 3516 a
SDict begin [/View [/XYZ H.V]/Dest (0:3592) cvn /DEST pdfmark end
 -2 3516
a 396 3606 a Fj(I'm)g(going)f(to)h(mak)o(e)g(the)g(perhaps)f(unpopular)
e(claim)k(that)f("f)o(ast)h(and)e(small")i(are)f(features)f(that)i
(solv)o(e)396 3714 y(non-problems.)c(The)j(only)f(real)h(problem)f
(that)h(serialization)g(libraries)g(solv)o(e)f(is,)i(as)g(f)o(ar)f(as)h
(I)f(can)g(tell,)h(the)f(need)g(to)396 3822 y(document)e(the)j(message)
f(contracts)f(and)h(actually)f(serialize)i(data)f(to)g(and)g(from)f
(the)h(wire.)-2 4006 y
SDict begin H.S end
 -2 4006 a -2 4006 a
SDict begin 13 H.A end
 -2 4006 a
-2 4006 a
SDict begin [/View [/XYZ H.V]/Dest (0:3593) cvn /DEST pdfmark end
 -2 4006 a 396 4095 a Fj(Let')-5 b(s)21 b(start)g(with)f("f)o
(ast)h(and)e(small".)i(It')-5 b(s)21 b(based)e(on)h(a)h(tw)o(o-part)e
(ar)o(gument.)f(First,)i(that)h(making)d(your)h(messages)396
4203 y(smaller)m(,)h(and)g(that)g(reducing)e(CPU)j(cost)g(for)e
(encoding)f(and)i(decoding)e(will)j(mak)o(e)f(a)g(signi\002cant)g(dif)n
(ferent)f(to)h(your)396 4311 y(application')-5 b(s)19
b(performance.)e(Second,)i(that)i(this)f(equally)f(v)n(alid)h
(across-the-board)d(to)k(all)f(messages.)-2 4495 y
SDict begin H.S end
 -2
4495 a -2 4495 a
SDict begin 13 H.A end
 -2 4495 a -2 4495 a
SDict begin [/View [/XYZ H.V]/Dest (0:3594) cvn /DEST pdfmark end
 -2 4495 a 396 4585
a Fj(But)h(most)f(real)g(applications)f(tend)h(to)g(f)o(all)h(into)f
(one)g(of)g(tw)o(o)g(cate)o(gories.)f(Either)h(the)g(speed)g(of)f
(serialization)h(and)396 4693 y(size)h(of)f(encoding)e(is)j(mar)o
(ginal)e(compared)f(to)i(other)f(costs,)i(such)f(as)h(database)e
(access)i(or)f(application)f(code)396 4801 y(performance.)e(Or)m(,)j
(netw)o(ork)f(performance)e(really)j(is)h(critical,)f(and)g(then)g(all)
g(signi\002cant)g(costs)h(occur)e(in)h(a)h(fe)n(w)396
4909 y(speci\002c)g(message)f(types.)p Black 3759 5569
a Fi(271)p Black eop end
%%Page: 272 286
TeXDict begin 272 285 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.272) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3595) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Thus,)h(aiming)f(for)h("f)o(ast)g(and)g(small")h
(across)f(the)g(board)f(is)i(a)g(f)o(alse)f(optimization.)f(Y)-9
b(ou)19 b(neither)g(get)i(the)f(easy)396 180 y(\003e)o(xibility)g(of)g
(Cheap)g(for)f(your)g(infrequent)f(control)h(\003o)n(ws,)h(nor)g(do)f
(you)h(get)g(the)g(brutal)g(ef)n(\002cienc)o(y)e(of)i(Nasty)h(for)396
288 y(your)e(high-v)n(olume)e(data)j(\003o)n(ws.)h(W)-7
b(orse,)20 b(the)g(assumption)f(that)h(all)h(messages)f(are)g(equal)f
(in)i(some)e(w)o(ay)i(can)e(corrupt)396 396 y(your)g(protocol)g
(design.)g(Cheap)h(and)f(Nasty)i(isn')o(t)f(only)f(about)g
(serialization)h(strate)o(gies,)g(it')-5 b(s)21 b(also)g(about)396
504 y(synchronous)d(vs.)i(asynchronous,)d(error)i(handling,)f(and)i
(the)g(cost)h(of)e(change.)-2 688 y
SDict begin H.S end
 -2 688 a -2 688 a
SDict begin 13 H.A end

-2 688 a -2 688 a
SDict begin [/View [/XYZ H.V]/Dest (0:3596) cvn /DEST pdfmark end
 -2 688 a 396 778 a Fj(My)h(e)o(xperience)e(is)k(that)
e(most)g(performance)d(problems)i(in)h(message-based)f(applications)g
(can)h(be)g(solv)o(ed)g(by)f(\(a\))396 886 y(impro)o(ving)f(the)i
(application)f(itself)h(and)g(\(b\))g(hand-optimizing)c(the)k(high-v)n
(olume)e(data)i(\003o)n(ws.)g(And)g(to)396 994 y(hand-optimize)e(your)h
(most)h(critical)g(data)g(\003o)n(ws,)h(you)e(need)g(to)i(cheat,)e(kno)
n(w)g(and)h(e)o(xploit)f(f)o(acts)i(about)e(your)g(data,)396
1102 y(which)h(is)h(something)e(general-purpose)d(serializers)21
b(cannot)e(do.)-2 1286 y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286
a -2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:3597) cvn /DEST pdfmark end
 -2 1286 a 396 1376 a Fj(No)n(w)h(to)h(documentation:)c(the)
j(need)g(to)g(write)g(our)g(contracts)f(e)o(xplicitly)g(and)h(formally)
-5 b(,)18 b(not)i(in)g(code.)g(This)g(is)h(a)396 1484
y(v)n(alid)f(problem)e(to)j(solv)o(e,)e(indeed)g(one)h(of)g(the)g(main)
g(ones)g(if)g(we')l(re)g(to)g(b)n(uild)g(a)h(long-lasting)d(lar)o
(ge-scale)396 1592 y(message-based)h(architecture.)-2
1776 y
SDict begin H.S end
 -2 1776 a -2 1776 a
SDict begin 13 H.A end
 -2 1776 a -2 1776 a
SDict begin [/View [/XYZ H.V]/Dest (0:3598) cvn /DEST pdfmark end
 -2 1776
a 396 1866 a Fj(Here)h(is)h(ho)n(w)f(we)h(describe)e(a)i(typical)e
(message)h(using)g(the)g(MessageP)o(ack)g(IDL:)-2 1967
y
SDict begin H.S end
 -2 1967 a -2 1967 a
SDict begin 11.7 H.A end
 -2 1967 a -2 1967 a
SDict begin [/View [/XYZ H.V]/Dest (0:3599) cvn /DEST pdfmark end
 -2 1967 a 396
2046 a Fg(message)44 b(Person)g({)486 2143 y(1:)g(string)g(surname)486
2240 y(2:)g(string)g(firstname)486 2337 y(3:)g(optional)g(string)g
(email)396 2434 y(})-2 2609 y
SDict begin H.S end
 -2 2609 a -2 2609 a
SDict begin 13 H.A end
 -2
2609 a -2 2609 a
SDict begin [/View [/XYZ H.V]/Dest (0:3600) cvn /DEST pdfmark end
 -2 2609 a 396 2708 a Fj(No)n(w)-5 b(,)20
b(the)g(same)g(message)g(using)g(the)g(protob)n(ufs)e(IDL:)-2
2809 y
SDict begin H.S end
 -2 2809 a -2 2809 a
SDict begin 11.7 H.A end
 -2 2809 a -2 2809 a
SDict begin [/View [/XYZ H.V]/Dest (0:3601) cvn /DEST pdfmark end
 -2 2809
a 396 2889 a Fg(message)44 b(Person)g({)486 2986 y(required)f(string)h
(surname)g(=)h(1;)486 3083 y(required)e(string)h(firstname)g(=)g(2;)486
3180 y(optional)f(string)h(email)g(=)h(3;)396 3277 y(})-2
3451 y
SDict begin H.S end
 -2 3451 a -2 3451 a
SDict begin 13 H.A end
 -2 3451 a -2 3451 a
SDict begin [/View [/XYZ H.V]/Dest (0:3602) cvn /DEST pdfmark end
 -2 3451
a 396 3551 a Fj(It)21 b(w)o(orks)f(b)n(ut)g(in)g(most)g(practical)g
(cases,)h(wins)f(you)f(little)j(o)o(v)o(er)c(a)j(serialization)e
(language)g(back)o(ed)g(by)h(decent)396 3659 y(speci\002cations)g
(written)g(by)g(hand)f(or)h(produced)d(mechanically)i(\(we')o(ll)h
(come)g(to)g(this\).)g(The)g(price)g(you')o(ll)f(pay)h(is)h(an)396
3767 y(e)o(xtra)f(dependenc)o(y)-5 b(,)16 b(and)k(quite)g(probably)-5
b(,)17 b(w)o(orse)j(o)o(v)o(erall)f(performance)e(than)j(if)g(you)g
(used)f(Cheap)h(and)g(Nasty)-5 b(.)-2 3795 y
SDict begin H.S end
 -2 3795
a -2 3795 a
SDict begin 13 H.A end
 -2 3795 a -2 3795 a
SDict begin [/View [/XYZ H.V]/Dest (0:3603) cvn /DEST pdfmark end
 -2 3795 a 396 4105 a
Fd(6.7.5.)36 b(Hand-written)d(Binar)q(y)i(Serialization)2602
4105 y
SDict begin H.S end
 2602 4105 a 2602 4105 a
SDict begin 18.72 H.A end
 2602 4105 a 2602 4105
a
SDict begin [/View [/XYZ H.V]/Dest (11.66.56.2) cvn /DEST pdfmark end
 2602 4105 a -2 4296 a
SDict begin H.S end
 -2 4296 a -2 4296 a
SDict begin 13 H.A end
 -2 4296 a
-2 4296 a
SDict begin [/View [/XYZ H.V]/Dest (0:3605) cvn /DEST pdfmark end
 -2 4296 a 396 4379 a Fj(As)21 b(you')o(ll)e(gather)g(from)g
(this)h(book,)f(my)g(preferred)f(language)g(for)i(systems)g
(programming)d(is)k(C)g(\(upgraded)c(to)j(C99,)396 4487
y(with)h(a)f(constructor/destructor)d(API)j(model)f(and)h(generic)f
(containers\).)g(There)g(are)h(tw)o(o)g(reasons)g(I)h(lik)o(e)f(this)
396 4595 y(modernized)e(C)j(language:)e(\002rstly)-5
b(,)20 b(I'm)f(too)h(weak-minded)e(to)i(learn)g(a)g(big)g(language)f
(lik)o(e)h(C++.)h(Life)f(just)g(seems)396 4703 y(\002lled)h(with)f
(more)f(interesting)h(things)f(to)i(understand.)d(Secondly)-5
b(,)18 b(I)i(\002nd)g(that)g(this)h(speci\002c)f(le)n(v)o(el)g(of)g
(manual)396 4811 y(control)f(lets)i(me)f(produce)f(better)g(results,)i
(and)e(f)o(aster)-5 b(.)p Black 3759 5569 a Fi(272)p
Black eop end
%%Page: 273 287
TeXDict begin 273 286 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.273) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3606) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)h(point)g(here)f(isn')o(t)h(C)h(vs.)g(C++)f(b)n
(ut)g(the)h(v)n(alue)e(of)h(manual)f(control)g(for)h(high-end)e
(professional)g(users.)i(It')-5 b(s)21 b(no)396 180 y(accident)f(that)g
(the)g(best)h(cars)f(and)g(cameras)f(and)h(espresso)g(machines)f(in)i
(the)f(w)o(orld)g(ha)n(v)o(e)f(manual)g(controls.)g(That)396
288 y(le)n(v)o(el)g(of)g(on-the-spot)e(\002ne-tuning)h(often)g(mak)o
(es)h(the)h(dif)n(ference)d(between)h(w)o(orld-class)h(success,)h(and)e
(second-best.)-2 472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end
 -2 472 a -2
472 a
SDict begin [/View [/XYZ H.V]/Dest (0:3607) cvn /DEST pdfmark end
 -2 472 a 396 562 a Fj(When)i(you)g(are)g(really)-5
b(,)19 b(truly)-5 b(,)19 b(concerned)f(about)h(the)h(speed)g(of)g
(serialization)f(and/or)g(the)h(size)h(of)f(the)g(result)h(\(often)396
670 y(these)g(contradict)d(each)i(other\),)f(you)g(need)h(hand-written)
e(binary)h(serialization,)g(in)h(other)g(w)o(ords,)f(let')-5
b(s)21 b(hear)f(it)h(for)396 778 y(Mr)-5 b(.)21 b(Nasty!)-2
962 y
SDict begin H.S end
 -2 962 a -2 962 a
SDict begin 13 H.A end
 -2 962 a -2 962 a
SDict begin [/View [/XYZ H.V]/Dest (0:3608) cvn /DEST pdfmark end
 -2 962 a 396
1052 a Fj(Y)-9 b(our)19 b(basic)i(process)f(for)f(writing)h(an)g(ef)n
(\002cient)g(Nasty)g(encoder/decoder)c(\(codec\))j(is:)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:3609) cvn /DEST pdfmark end
 -2 1070
a -2 1080 a
SDict begin H.S end
 -2 1080 a -2 1080 a
SDict begin 13 H.A end
 -2 1080 a -2 1080 a
SDict begin [/View [/XYZ H.V]/Dest (0:3610) cvn /DEST pdfmark end
 -2
1080 a Black 396 1222 a Fe(\225)p Black 479 1222 a
SDict begin H.S end
 479
1222 a 479 1222 a
SDict begin 13 H.A end
 479 1222 a 479 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:3611) cvn /DEST pdfmark end
 479 1222 a Fj(Build)i
(representati)n(v)o(e)d(data)i(sets)h(and)f(test)h(applications)e(that)
h(can)g(stress-test)h(your)e(codec.)-2 1240 y
SDict begin H.S end
 -2 1240
a -2 1240 a
SDict begin 13 H.A end
 -2 1240 a -2 1240 a
SDict begin [/View [/XYZ H.V]/Dest (0:3612) cvn /DEST pdfmark end
 -2 1240 a Black 396 1372
a Fe(\225)p Black 479 1372 a
SDict begin H.S end
 479 1372 a 479 1372 a
SDict begin 13 H.A end
 479
1372 a 479 1372 a
SDict begin [/View [/XYZ H.V]/Dest (0:3613) cvn /DEST pdfmark end
 479 1372 a Fj(Write)i(a)g(\002rst)g(dumb)e(v)o
(ersion)f(of)i(the)h(codec.)-2 1373 y
SDict begin H.S end
 -2 1373 a -2 1373
a
SDict begin 13 H.A end
 -2 1373 a -2 1373 a
SDict begin [/View [/XYZ H.V]/Dest (0:3614) cvn /DEST pdfmark end
 -2 1373 a Black 396 1521 a Fe(\225)p
Black 479 1521 a
SDict begin H.S end
 479 1521 a 479 1521 a
SDict begin 13 H.A end
 479 1521 a 479
1521 a
SDict begin [/View [/XYZ H.V]/Dest (0:3615) cvn /DEST pdfmark end
 479 1521 a Fj(T)-6 b(est,)21 b(measure,)e(impro)o(v)o(e,)f(and)h
(repeat)h(until)g(you)f(run)h(out)g(of)g(time)g(and/or)f(mone)o(y)-5
b(.)-2 1705 y
SDict begin H.S end
 -2 1705 a -2 1705 a
SDict begin 13 H.A end
 -2 1705 a -2 1705 a
SDict begin [/View [/XYZ H.V]/Dest (0:3616) cvn /DEST pdfmark end

-2 1705 a 396 1795 a Fj(Here)20 b(are)g(some)g(of)g(the)h(techniques)d
(we)j(use)f(to)h(mak)o(e)e(our)h(codecs)g(better:)-2
1813 y
SDict begin H.S end
 -2 1813 a -2 1813 a
SDict begin 13 H.A end
 -2 1813 a -2 1813 a
SDict begin [/View [/XYZ H.V]/Dest (0:3617) cvn /DEST pdfmark end
 -2 1813
a -2 1823 a
SDict begin H.S end
 -2 1823 a -2 1823 a
SDict begin 13 H.A end
 -2 1823 a -2 1823 a
SDict begin [/View [/XYZ H.V]/Dest (0:3618) cvn /DEST pdfmark end
 -2
1823 a Black 396 1965 a Fe(\225)p Black 479 1965 a
SDict begin H.S end
 479
1965 a 479 1965 a
SDict begin 13 H.A end
 479 1965 a 479 1965 a
SDict begin [/View [/XYZ H.V]/Dest (0:3619) cvn /DEST pdfmark end
 479 1965 a 479
1965 a
SDict begin H.S end
 479 1965 a 479 1965 a
SDict begin 13 H.A end
 479 1965 a 479 1965 a
SDict begin [/View [/XYZ H.V]/Dest (0:3620) cvn /DEST pdfmark end
 479
1965 a Fi(Use)h(a)f(pr)l(o\002ler)-9 b(.)20 b Fj(There')-5
b(s)20 b(simply)g(no)f(w)o(ay)i(to)f(kno)n(w)f(what)h(your)f(code)h(is)
h(doing)e(until)h(you')l(v)o(e)e(pro\002led)h(it,)h(for)479
2073 y(function)f(counts)g(and)h(for)f(CPU)j(cost)e(per)g(function.)e
(Once)i(you)f(\002nd)h(your)f(hot-spots,)g(\002x)i(them.)-2
2091 y
SDict begin H.S end
 -2 2091 a -2 2091 a
SDict begin 13 H.A end
 -2 2091 a -2 2091 a
SDict begin [/View [/XYZ H.V]/Dest (0:3621) cvn /DEST pdfmark end
 -2 2091
a Black 396 2223 a Fe(\225)p Black 479 2223 a
SDict begin H.S end
 479 2223
a 479 2223 a
SDict begin 13 H.A end
 479 2223 a 479 2223 a
SDict begin [/View [/XYZ H.V]/Dest (0:3622) cvn /DEST pdfmark end
 479 2223 a 479 2223
a
SDict begin H.S end
 479 2223 a 479 2223 a
SDict begin 13 H.A end
 479 2223 a 479 2223 a
SDict begin [/View [/XYZ H.V]/Dest (0:3623) cvn /DEST pdfmark end
 479 2223
a Fi(Eliminate)f(memory)g(allocations.)f Fj(On)h(a)g(modern)f(Linux)g
(k)o(ernel)g(the)i(heap)e(is)i(v)o(ery)e(f)o(ast,)i(b)n(ut)f(it')-5
b(s)21 b(still)h(the)479 2331 y(bottleneck)d(in)h(most)g(nai)n(v)o(e)g
(codecs.)f(On)h(older)g(k)o(ernels)f(the)i(heap)e(can)h(be)g
(tragically)g(slo)n(w)-5 b(.)19 b(Use)i(local)f(v)n(ariables)479
2439 y(\(the)g(stack\))g(instead)g(of)g(the)g(heap)g(where)f(you)h
(can.)-2 2457 y
SDict begin H.S end
 -2 2457 a -2 2457 a
SDict begin 13 H.A end
 -2 2457 a -2 2457
a
SDict begin [/View [/XYZ H.V]/Dest (0:3624) cvn /DEST pdfmark end
 -2 2457 a Black 396 2588 a Fe(\225)p Black 479 2588
a
SDict begin H.S end
 479 2588 a 479 2588 a
SDict begin 13 H.A end
 479 2588 a 479 2588 a
SDict begin [/View [/XYZ H.V]/Dest (0:3625) cvn /DEST pdfmark end
 479 2588
a 479 2588 a
SDict begin H.S end
 479 2588 a 479 2588 a
SDict begin 13 H.A end
 479 2588 a 479 2588
a
SDict begin [/View [/XYZ H.V]/Dest (0:3626) cvn /DEST pdfmark end
 479 2588 a Fi(T)-8 b(est)22 b(on)e(dif)o(fer)m(ent)f(platforms)h(and)
f(with)i(dif)o(fer)m(ent)f(compiler)o(s)g(and)f(compiler)h(options.)f
Fj(Apart)h(from)f(the)i(heap,)479 2696 y(there)f(are)g(man)o(y)f(other)
g(dif)n(ferences.)g(Y)-9 b(ou)19 b(need)h(to)g(learn)g(the)g(main)g
(ones,)g(and)f(allo)n(w)h(for)g(these.)-2 2714 y
SDict begin H.S end
 -2 2714
a -2 2714 a
SDict begin 13 H.A end
 -2 2714 a -2 2714 a
SDict begin [/View [/XYZ H.V]/Dest (0:3627) cvn /DEST pdfmark end
 -2 2714 a Black 396 2845
a Fe(\225)p Black 479 2845 a
SDict begin H.S end
 479 2845 a 479 2845 a
SDict begin 13 H.A end
 479
2845 a 479 2845 a
SDict begin [/View [/XYZ H.V]/Dest (0:3628) cvn /DEST pdfmark end
 479 2845 a 479 2845 a
SDict begin H.S end
 479 2845 a 479
2845 a
SDict begin 13 H.A end
 479 2845 a 479 2845 a
SDict begin [/View [/XYZ H.V]/Dest (0:3629) cvn /DEST pdfmark end
 479 2845 a Fi(Use)h(state)g(to)f(compr)m
(ess)g(better)-9 b(.)20 b Fj(If)g(you)g(are)g(concerned)e(about)h
(codec)g(performance,)e(you)j(are)g(almost)g(de\002nitely)479
2953 y(sending)f(the)i(same)f(kinds)g(of)f(data)i(man)o(y)e(times.)h
(There)f(will)i(be)f(redundanc)o(y)d(between)j(instances)g(of)g(data.)f
(Y)-9 b(ou)479 3061 y(can)20 b(detect)g(these,)g(and)g(use)g(that)h(to)
f(compress)f(\(e.g.)h(a)g(short)g(v)n(alue)g(that)g(means)g("same)g(as)
h(last)g(time"\).)-2 3079 y
SDict begin H.S end
 -2 3079 a -2 3079 a
SDict begin 13 H.A end
 -2 3079
a -2 3079 a
SDict begin [/View [/XYZ H.V]/Dest (0:3630) cvn /DEST pdfmark end
 -2 3079 a Black 396 3211 a Fe(\225)p Black
479 3211 a
SDict begin H.S end
 479 3211 a 479 3211 a
SDict begin 13 H.A end
 479 3211 a 479 3211
a
SDict begin [/View [/XYZ H.V]/Dest (0:3631) cvn /DEST pdfmark end
 479 3211 a 479 3211 a
SDict begin H.S end
 479 3211 a 479 3211 a
SDict begin 13 H.A end
 479 3211
a 479 3211 a
SDict begin [/View [/XYZ H.V]/Dest (0:3632) cvn /DEST pdfmark end
 479 3211 a Fi(Know)g(your)f(data.)f Fj(The)h(best)g
(compression)f(techniques)f(\(in)i(terms)h(of)f(CPU)h(cost)f(for)g
(compactness\))f(require)479 3319 y(kno)n(wing)g(about)g(the)h(data.)g
(F)o(or)g(e)o(xample)e(the)j(techniques)d(to)j(compress)e(a)i(w)o(ord)e
(list,)i(a)g(video,)e(and)h(a)g(stream)g(of)479 3427
y(stock)g(mark)o(et)g(data)g(are)g(all)h(dif)n(ferent.)-2
3428 y
SDict begin H.S end
 -2 3428 a -2 3428 a
SDict begin 13 H.A end
 -2 3428 a -2 3428 a
SDict begin [/View [/XYZ H.V]/Dest (0:3633) cvn /DEST pdfmark end
 -2 3428
a Black 396 3576 a Fe(\225)p Black 479 3576 a
SDict begin H.S end
 479 3576
a 479 3576 a
SDict begin 13 H.A end
 479 3576 a 479 3576 a
SDict begin [/View [/XYZ H.V]/Dest (0:3634) cvn /DEST pdfmark end
 479 3576 a 479 3576
a
SDict begin H.S end
 479 3576 a 479 3576 a
SDict begin 13 H.A end
 479 3576 a 479 3576 a
SDict begin [/View [/XYZ H.V]/Dest (0:3635) cvn /DEST pdfmark end
 479 3576
a Fi(Be)g(r)m(eady)e(to)i(br)m(eak)e(the)i(rules.)f Fj(Do)g(you)g
(really)f(need)h(to)g(encode)f(inte)o(gers)h(in)g(big-endian)e(netw)o
(ork)h(byte)g(order?)479 3684 y(x86)h(and)f(ARM)i(account)e(for)h
(almost)g(all)h(modern)d(CPUs,)j(yet)f(use)h(little-endian)e(\(ARM)h
(is)h(actually)f(bi-endian)479 3792 y(b)n(ut)g(Android,)f(lik)o(e)h(W)m
(indo)n(ws)g(and)f(iOS,)i(is)g(little-endian\).)-2 3848
y
SDict begin H.S end
 -2 3848 a -2 3848 a
SDict begin 13 H.A end
 -2 3848 a -2 3848 a
SDict begin [/View [/XYZ H.V]/Dest (0:3636) cvn /DEST pdfmark end
 -2 3848 a 396
4161 a Fd(6.7.6.)36 b(Code)e(Generation)1691 4161 y
SDict begin H.S end
 1691
4161 a 1691 4161 a
SDict begin 18.72 H.A end
 1691 4161 a 1691 4161 a
SDict begin [/View [/XYZ H.V]/Dest (11.66.57.2) cvn /DEST pdfmark end
 1691 4161
a -2 4329 a
SDict begin H.S end
 -2 4329 a -2 4329 a
SDict begin 13 H.A end
 -2 4329 a -2 4329 a
SDict begin [/View [/XYZ H.V]/Dest (0:3638) cvn /DEST pdfmark end
 -2
4329 a 396 4435 a Fj(Reading)20 b(the)g(pre)n(vious)f(tw)o(o)h
(sections,)g(you)f(might)h(ha)n(v)o(e)f(w)o(ondered,)f("could)i(I)g
(write)g(my)g(o)n(wn)g(IDL)g(generator)e(that)396 4543
y(w)o(as)j(better)f(than)g(a)g(general-purpose)d(one?")i(If)h(this)h
(thought)e(w)o(andered)f(into)i(your)f(mind,)g(it)i(probably)d(left)j
(pretty)396 4651 y(soon)f(after)m(,)f(chased)h(by)g(dark)f
(calculations)g(about)g(ho)n(w)h(much)f(w)o(ork)h(that)g(actually)g(in)
m(v)n(olv)o(ed.)-2 4835 y
SDict begin H.S end
 -2 4835 a -2 4835 a
SDict begin 13 H.A end
 -2 4835
a -2 4835 a
SDict begin [/View [/XYZ H.V]/Dest (0:3639) cvn /DEST pdfmark end
 -2 4835 a 396 4925 a Fj(What)h(if)f(I)h(told)f(you)f(of)h
(a)g(w)o(ay)h(to)f(b)n(uild)g(custom)f(IDL)i(generators)d(cheaply)h
(and)h(quickly?)e(A)j(w)o(ay)f(to)h(get)f(perfectly)396
5033 y(documented)d(contracts,)i(code)g(that)h(is)h(as)f(e)n(vil)g(and)
f(domain-speci\002c)f(as)i(you)f(need,)g(and)g(all)h(you)f(need)g(to)h
(do)f(is)i(sign)396 5141 y(a)o(w)o(ay)f(your)f(soul)h(\()950
5141 y
SDict begin H.S end
 950 5141 a 950 5141 a
SDict begin 13 H.A end
 950 5141 a 950 5141 a
SDict begin [/View [/XYZ H.V]/Dest (0:3640) cvn /DEST pdfmark end
 950
5141 a Fi(who)g(e)o(ver)g(r)m(eally)h(used)f(that,)f(amirite?)p
Fj(\))h(right)g(here...)p Black 3759 5569 a Fi(273)p
Black eop end
%%Page: 274 288
TeXDict begin 274 287 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.274) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3654) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3641) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(At)i(iMatix,)f(until)g(a)h(fe)n(w)f(years)g(ago,)f
(we)i(used)f(code)f(generation)f(to)j(b)n(uild)e(e)n(v)o(er)h(lar)o
(ger)f(and)g(more)h(ambitious)396 180 y(systems)h(until)f(we)h(decided)
d(the)j(technology)c(\(GSL\))j(w)o(as)h(too)f(dangerous)e(for)i(common)
e(use,)i(and)g(we)g(sealed)h(the)396 288 y(archi)n(v)o(e)e(and)h(lock)o
(ed)f(it,)i(with)f(hea)n(vy)f(chains,)h(in)g(a)h(deep)e(dungeon.)f(W)-7
b(ell,)21 b(we)g(actually)e(posted)h(it)h(on)e(github)m(.)g(If)h(you)
396 396 y(w)o(ant)g(to)h(try)f(the)g(e)o(xamples)f(that)h(are)g(coming)
e(up,)i(grab)2060 396 y
SDict begin H.S end
 2060 396 a 2060 396 a
SDict begin 13 H.A end
 2060 396
a 2060 396 a
SDict begin [/View [/XYZ H.V]/Dest (0:3642) cvn /DEST pdfmark end
 2060 396 a Fj(the)g(repository)e(\(https://github)m
(.com/imatix/gsl\))e(and)j(b)n(uild)396 504 y(yourself)g(a)747
504 y
SDict begin H.S end
 747 504 a 747 504 a
SDict begin 13 H.A end
 747 504 a 747 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:3643) cvn /DEST pdfmark end
 747 504
a Fg(gsl)h Fj(command.)e(T)-7 b(yping)19 b("mak)o(e")g(in)i(the)f(src)g
(subdirectory)e(should)h(do)h(it)h(\(and)e(if)i(you')l(re)d(that)i(guy)
g(who)396 612 y(lo)o(v)o(es)g(W)m(indo)n(ws,)f(I'm)h(sure)g(you')o(ll)f
(send)h(a)h(patch)e(with)i(project)e(\002les\).)-2 796
y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:3644) cvn /DEST pdfmark end
 -2 796 a 396 886
a Fj(This)i(section)f(isn')o(t)f(really)h(about)f(GSL)i(at)g(all,)f(b)n
(ut)g(about)g(a)g(useful)g(and)g(little-kno)n(wn)e(trick)i(that')-5
b(s)21 b(useful)e(for)396 994 y(ambitious)h(architects)f(who)h(w)o(ant)
g(to)h(scale)g(themselv)o(es,)e(as)i(well)f(as)h(their)f(w)o(ork.)f
(Once)h(you)g(learn)f(the)i(trick)f(is,)g(you)396 1102
y(can)g(whip)g(up)g(your)f(o)n(wn)g(code)h(generators)e(in)j(a)f(short)
g(time.)g(The)g(code)g(generators)e(most)i(softw)o(are)g(engineers)396
1210 y(kno)n(w)f(about)h(come)f(with)i(a)f(single)g(hard-coded)d
(model.)j(F)o(or)f(instance,)h(Ragel)g("compiles)g(e)o(x)o(ecutable)e
(\002nite)j(state)396 1318 y(machines)f(from)f(re)o(gular)f
(languages",)h(i.e.)h(Ragel')-5 b(s)21 b(model)e(is)i(a)g(re)o(gular)d
(language.)h(This)h(certainly)f(w)o(orks)h(for)g(a)396
1426 y(good)f(set)i(of)f(problems)f(b)n(ut)h(it')-5 b(s)21
b(f)o(ar)f(from)f(uni)n(v)o(ersal.)g(Ho)n(w)h(do)g(you)f(describe)h(an)
g(API)g(in)g(Ragel?)h(Or)f(a)h(project)396 1534 y(mak)o(e\002le?)f(Or)g
(e)n(v)o(en)f(a)i(\002nite-state)f(machine)f(lik)o(e)i(the)f(one)g(we)g
(used)g(to)h(design)e(the)h(Binary)g(Star)h(pattern)e(in)396
1642 y(Reliable)i(Request-Reply)e(P)o(atterns)p 0 TeXcolorgray
1475 1642 a
SDict begin H.S end
 1475 1642 a Fj(Chapter)g(4)1800 1642 y
SDict begin 13 H.L end
 1800
1642 a 1800 1642 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1800 1642 a Black -1 w Fj(?)-2 1826
y
SDict begin H.S end
 -2 1826 a -2 1826 a
SDict begin 13 H.A end
 -2 1826 a -2 1826 a
SDict begin [/View [/XYZ H.V]/Dest (0:3646) cvn /DEST pdfmark end
 -2 1826 a 396
1916 a Fj(All)i(these)f(w)o(ould)g(bene\002t)g(from)f(code)g
(generation,)f(b)n(ut)i(there')-5 b(s)21 b(no)e(uni)n(v)o(ersal)g
(model.)g(So)i(the)f(trick)g(is)h(to)f(design)396 2023
y(your)f(o)n(wn)h(models)f(as)i(you)f(need)f(them,)h(then)f(mak)o(e)h
(code)g(generators)e(as)j(cheap)e(compilers)h(for)f(that)i(model.)e(Y)
-9 b(ou)396 2131 y(need)20 b(some)g(e)o(xperience)e(in)i(ho)n(w)g(to)g
(mak)o(e)g(good)f(models,)g(and)h(you)f(need)h(a)g(technology)e(that)i
(mak)o(es)g(it)h(cheap)e(to)396 2239 y(b)n(uild)h(custom)g(code)f
(generators.)f(Scripting)i(languages)e(lik)o(e)j(Perl)f(and)g(Python)f
(are)h(a)h(good)e(option.)f(Ho)n(we)n(v)o(er)h(we)396
2347 y(actually)h(b)n(uilt)g(GSL)h(speci\002cally)f(for)f(this,)i(and)e
(that')-5 b(s)21 b(what)f(I)h(prefer)-5 b(.)-2 2531 y
SDict begin H.S end

-2 2531 a -2 2531 a
SDict begin 13 H.A end
 -2 2531 a -2 2531 a
SDict begin [/View [/XYZ H.V]/Dest (0:3647) cvn /DEST pdfmark end
 -2 2531 a 396
2621 a Fj(Let')g(s)21 b(tak)o(e)f(a)h(simple)f(e)o(xample)f(that)h
(ties)h(into)f(what)g(we)h(already)e(kno)n(w)-5 b(.)18
b(W)-7 b(e')o(ll)22 b(see)f(more)e(e)o(xtensi)n(v)o(e)g(e)o(xamples)396
2729 y(later)m(,)h(because)f(I)i(really)f(do)f(belie)n(v)o(e)h(that)g
(code)f(generation)g(is)i(crucial)e(kno)n(wledge)f(for)i(lar)o
(ge-scale)f(w)o(ork.)g(In)396 2837 y(Reliable)i(Request-Reply)e(P)o
(atterns)p 0 TeXcolorgray 1475 2837 a
SDict begin H.S end
 1475 2837 a Fj(Chapter)g(4)1800
2837 y
SDict begin 13 H.L end
 1800 2837 a 1800 2837 a
SDict begin [/Subtype /Link/Dest (0:reliable-request-reply) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1800 2837 a Black -1 w
Fj(,)i(we)f(de)n(v)o(eloped)e(the)2439 2837 y
SDict begin H.S end
 2439 2837
a 2439 2837 a
SDict begin 13 H.A end
 2439 2837 a 2439 2837 a
SDict begin [/View [/XYZ H.V]/Dest (0:3649) cvn /DEST pdfmark end
 2439 2837 a Fj(Majordomo)g
(Protocol)h(\(MDP\))396 2945 y(\(http://rfc.zeromq.or)o(g/spec:7)o(\),)
c(and)k(wrote)h(clients,)g(brok)o(ers,)f(and)h(w)o(ork)o(ers)f(for)h
(that.)g(No)n(w)g(could)f(we)h(generate)396 3053 y(those)g(pieces)h
(mechanically)-5 b(,)17 b(by)j(b)n(uilding)f(our)g(o)n(wn)h(interf)o
(ace)f(description)g(language)g(and)g(code)h(generators?)-2
3237 y
SDict begin H.S end
 -2 3237 a -2 3237 a
SDict begin 13 H.A end
 -2 3237 a -2 3237 a
SDict begin [/View [/XYZ H.V]/Dest (0:3650) cvn /DEST pdfmark end
 -2 3237
a 396 3327 a Fj(When)g(we)h(write)f(a)h(GSL)f(model,)f(we)i(can)f(use)
1793 3327 y
SDict begin H.S end
 1793 3327 a 1793 3327 a
SDict begin 13 H.A end
 1793 3327 a 1793
3327 a
SDict begin [/View [/XYZ H.V]/Dest (0:3651) cvn /DEST pdfmark end
 1793 3327 a Fi(any)g Fj(semantics)g(we)h(lik)o(e,)f(in)g(other)g
(w)o(ords)g(we)g(can)g(in)m(v)o(ent)396 3435 y(domain-speci\002c)e
(languages)h(on)h(the)g(spot.)g(I')o(ll)g(in)m(v)o(ent)f(a)i(couple)e
(-)h(see)h(if)f(you)g(can)g(guess)g(what)g(the)o(y)g(represent:)-2
3536 y
SDict begin H.S end
 -2 3536 a -2 3536 a
SDict begin 11.7 H.A end
 -2 3536 a -2 3536 a
SDict begin [/View [/XYZ H.V]/Dest (0:3652) cvn /DEST pdfmark end
 -2 3536
a 396 3615 a Fg(slideshow)576 3712 y(name)44 b(=)g(Cookery)g(level)g(3)
576 3809 y(page)755 3906 y(title)g(=)h(French)e(Cuisine)755
4004 y(item)h(=)h(Overview)755 4101 y(item)f(=)h(The)f(historical)f
(cuisine)755 4198 y(item)h(=)h(The)f(nouvelle)g(cuisine)755
4295 y(item)g(=)h(Why)f(the)g(French)g(live)g(longer)576
4392 y(page)755 4489 y(title)g(=)h(Overview)755 4586
y(item)f(=)h(Soups)f(and)g(salads)755 4684 y(item)g(=)h(Le)f(plat)g
(principal)755 4781 y(item)g(=)h(B\303\251chamel)e(and)h(other)g
(sauces)755 4878 y(item)g(=)h(Pastries,)e(cakes,)h(and)g(quiches)755
4975 y(item)g(=)h(Souffl\303\251)e(-)i(cheese)f(to)g(strawberry)p
Black 3759 5569 a Fi(274)p Black eop end
%%Page: 275 289
TeXDict begin 275 288 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.275) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3653) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Ho)n(w)h(about)g(this)g(one:)396 253
y Fg(table)576 350 y(name)44 b(=)g(person)576 447 y(column)755
544 y(name)g(=)h(firstname)755 641 y(type)f(=)h(string)576
738 y(column)755 835 y(name)f(=)h(lastname)755 933 y(type)f(=)h(string)
576 1030 y(column)755 1127 y(name)f(=)h(rating)755 1224
y(type)f(=)h(integer)-2 1402 y
SDict begin H.S end
 -2 1402 a -2 1402 a
SDict begin 13 H.A end
 -2
1402 a -2 1402 a
SDict begin [/View [/XYZ H.V]/Dest (0:3655) cvn /DEST pdfmark end
 -2 1402 a 396 1498 a Fj(The)20 b(\002rst)h(we)g(could)
e(compile)g(into)h(a)h(presentation.)d(The)i(second,)f(into)h(SQL)g(to)
h(create)f(and)f(w)o(ork)h(with)g(a)h(database)396 1606
y(table.)f(So)h(for)e(this)i(e)o(x)o(ercise)e(our)h(domain)e(language,)
h(our)g(model,)g(consists)i(of)f("classes")h(that)f(contain)f
("messages")396 1714 y(that)i(contain)e("\002elds")h(of)g(v)n(arious)f
(types.)h(It')-5 b(s)21 b(deliberately)d(f)o(amiliar)-5
b(.)20 b(Here)g(is)i(the)e(MDP)g(client)h(protocol:)-2
1815 y
SDict begin H.S end
 -2 1815 a -2 1815 a
SDict begin 11.7 H.A end
 -2 1815 a -2 1815 a
SDict begin [/View [/XYZ H.V]/Dest (0:3656) cvn /DEST pdfmark end
 -2 1815
a 396 1894 a Fg(<class)44 b(name)g(=)h("mdp_client">)576
1991 y(MDP/Client)576 2088 y(<header>)755 2185 y(<field)f(name)g(=)h
("empty")e(type)h(=)h("string")f(value)g(=)g("")934 2283
y(>Empty)g(frame</field>)755 2380 y(<field)g(name)g(=)h("protocol")e
(type)h(=)h("string")e(value)h(=)h("MDPC01")934 2477
y(>Protocol)f(identifier</field>)576 2574 y(</header>)576
2671 y(<message)f(name)h(=)h("request">)755 2768 y(Client)f(request)f
(to)i(broker)755 2865 y(<field)f(name)g(=)h("service")e(type)h(=)h
("string">Service)d(name</field>)755 2962 y(<field)i(name)g(=)h("body")
e(type)i(=)f("frame">Request)f(body</field>)576 3060
y(</message>)576 3157 y(<message)g(name)h(=)h("reply">)755
3254 y(Response)e(back)i(to)f(client)755 3351 y(<field)g(name)g(=)h
("service")e(type)h(=)h("string">Service)d(name</field>)755
3448 y(<field)i(name)g(=)h("body")e(type)i(=)f("frame">Response)e
(body</field>)576 3545 y(</message>)396 3642 y(</class>)-2
3814 y
SDict begin H.S end
 -2 3814 a -2 3814 a
SDict begin 13 H.A end
 -2 3814 a -2 3814 a
SDict begin [/View [/XYZ H.V]/Dest (0:3657) cvn /DEST pdfmark end
 -2 3814
a 396 3916 a Fj(And)20 b(here)g(is)h(the)f(MDP)h(w)o(ork)o(er)e
(protocol:)-2 4017 y
SDict begin H.S end
 -2 4017 a -2 4017 a
SDict begin 11.7 H.A end
 -2 4017 a -2
4017 a
SDict begin [/View [/XYZ H.V]/Dest (0:3658) cvn /DEST pdfmark end
 -2 4017 a 396 4097 a Fg(<class)44 b(name)g(=)h("mdp_worker">)576
4194 y(MDP/Worker)576 4291 y(<header>)755 4388 y(<field)f(name)g(=)h
("empty")e(type)h(=)h("string")f(value)g(=)g("")934 4485
y(>Empty)g(frame</field>)755 4582 y(<field)g(name)g(=)h("protocol")e
(type)h(=)h("string")e(value)h(=)h("MDPW01")934 4679
y(>Protocol)f(identifier</field>)755 4777 y(<field)g(name)g(=)h("id")f
(type)g(=)h("octet">Message)d(identifier</field>)576
4874 y(</header>)576 4971 y(<message)h(name)h(=)h("ready")f(id)g(=)h
("1">)755 5068 y(Worker)f(tells)g(broker)g(it)g(is)h(ready)755
5165 y(<field)f(name)g(=)h("service")e(type)h(=)h("string">Service)d
(name</field>)p Black 3759 5569 a Fi(275)p Black eop
end
%%Page: 276 290
TeXDict begin 276 289 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.276) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 576 72 a Fg(</message>)576 170 y(<message)43 b(name)h(=)h
("request")e(id)i(=)f("2">)755 267 y(Client)g(request)f(to)i(broker)755
364 y(<field)f(name)g(=)h("client")e(type)h(=)h("frame">Client)d
(address</field>)755 461 y(<field)i(name)g(=)h("body")e(type)i(=)f
("frame">Request)f(body</field>)576 558 y(</message>)576
655 y(<message)g(name)h(=)h("reply")f(id)g(=)h("3">)755
752 y(Worker)f(returns)f(reply)h(to)h(broker)755 850
y(<field)f(name)g(=)h("client")e(type)h(=)h("frame">Client)d
(address</field>)755 947 y(<field)i(name)g(=)h("body")e(type)i(=)f
("frame">Request)f(body</field>)576 1044 y(</message>)576
1141 y(<message)g(name)h(=)h("hearbeat")e(id)i(=)f("4">)755
1238 y(Either)g(peer)g(tells)g(the)g(other)g(it's)g(still)g(alive)576
1335 y(</message>)576 1432 y(<message)f(name)h(=)h("disconnect")e(id)h
(=)h("5">)755 1530 y(Either)f(peer)g(tells)g(other)g(the)g(party)g(is)h
(over)576 1627 y(</message>)396 1724 y(</class>)-2 1896
y
SDict begin H.S end
 -2 1896 a -2 1896 a
SDict begin 13 H.A end
 -2 1896 a -2 1896 a
SDict begin [/View [/XYZ H.V]/Dest (0:3659) cvn /DEST pdfmark end
 -2 1896 a 396
1998 a Fj(GSL)21 b(uses)g(XML)f(as)h(its)g(modeling)d(language.)h(XML)h
(has)g(a)h(poor)e(reputation,)f(ha)n(ving)h(been)g(dragged)g(through)f
(too)396 2106 y(man)o(y)h(enterprise)g(se)n(wers)i(to)f(smell)h(sweet,)
f(b)n(ut)h(it)g(has)f(some)g(strong)f(positi)n(v)o(es,)h(as)h(long)e
(as)i(you)e(k)o(eep)h(it)h(simple.)396 2214 y(An)o(y)f(w)o(ay)g(to)g
(write)h(a)f(self-describing)e(hierarchy)g(of)i(items)h(and)e(attrib)n
(utes)i(w)o(ould)e(w)o(ork.)-2 2398 y
SDict begin H.S end
 -2 2398 a -2 2398
a
SDict begin 13 H.A end
 -2 2398 a -2 2398 a
SDict begin [/View [/XYZ H.V]/Dest (0:3660) cvn /DEST pdfmark end
 -2 2398 a 396 2488 a Fj(No)n(w)h(here)g(is)h(a)g
(short)f(IDL)g(generator)e(written)i(in)g(GSL)h(that)f(turns)g(our)f
(protocol)g(models)g(into)h(documentation:)-2 2589 y
SDict begin H.S end

-2 2589 a -2 2589 a
SDict begin 11.7 H.A end
 -2 2589 a -2 2589 a
SDict begin [/View [/XYZ H.V]/Dest (0:3661) cvn /DEST pdfmark end
 -2 2589 a 396
2668 a Fg(.#)90 b(Trivial)43 b(IDL)i(generator)e(\(specs.gsl\))396
2765 y(.#)396 2862 y(.output)h("$\(class.name\).md")396
2959 y(##)h(The)f($\(string.trim)f(\(class.?\224\):left\))f(Protocol)
396 3056 y(.for)i(message)396 3153 y(.)135 b(frames)43
b(=)i(count)f(\(class->header.field\))d(+)k(count)f(\(field\))396
3348 y(A)h($\(message.NAME\))d(command)i(consists)f(of)i(a)g
(multi-part)e(message)g(of)i($\(frames\))396 3445 y(frames:)396
3639 y(.)135 b(for)44 b(class->header.field)396 3736
y(.)314 b(if)44 b(name)h(=)f("id")396 3846 y(*)486 3833
y(Frame)g($\(item)g(\(\)\):)g(0x$\(message.id:\04502x\))d(\(1)k(byte,)f
($\(message.NAME\)\))396 3931 y(.)314 b(else)396 4041
y(*)486 4028 y(Frame)44 b($\(item)g(\(\)\):)g("$\(value:\)")f
(\($\(string.length)f(\("$\(value\)"\)\))h(\\)396 4125
y(bytes,)h($\(field.:\)\))396 4222 y(.)314 b(endif)396
4319 y(.)135 b(endfor)396 4416 y(.)g(index)44 b(=)g(count)g
(\(class->header.field\))e(+)i(1)396 4513 y(.)135 b(for)44
b(field)396 4623 y(*)486 4610 y(Frame)g($\(index\):)f($\(field.?\224\))
g(\\)396 4708 y(.)314 b(if)44 b(type)h(=)f("string")396
4805 y(\(printable)f(string\))396 4902 y(.)314 b(elsif)44
b(type)g(=)h("frame")396 4999 y(\(opaque)f(binary\))396
5096 y(.)493 b(index)44 b(+=)h(1)p Black 3757 5569 a
Fi(276)p Black eop end
%%Page: 277 291
TeXDict begin 277 290 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.277) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fg(.)314 b(else)396 170 y(.)493 b(echo)44
b("E:)h(unknown)e(field)h(type:)g($\(type\)")396 267
y(.)314 b(endif)396 364 y(.)g(index)44 b(+=)g(1)396 461
y(.)135 b(endfor)396 558 y(.endfor)-2 725 y
SDict begin H.S end
 -2 725 a
-2 725 a
SDict begin 13 H.A end
 -2 725 a -2 725 a
SDict begin [/View [/XYZ H.V]/Dest (0:3662) cvn /DEST pdfmark end
 -2 725 a 396 832 a Fj(The)20
b(XML)g(models)g(and)g(this)g(script)h(are)f(in)g(the)g(subdirectory)e
(e)o(xamples/models.)g(T)-7 b(o)20 b(do)g(the)g(code)g(generation)e(I)
396 940 y(gi)n(v)o(e)i(this)g(command:)-2 1041 y
SDict begin H.S end
 -2 1041
a -2 1041 a
SDict begin 11.7 H.A end
 -2 1041 a -2 1041 a
SDict begin [/View [/XYZ H.V]/Dest (0:3663) cvn /DEST pdfmark end
 -2 1041 a 396 1120 a
Fg(gsl)45 b(-script:specs)d(mdp_client.xml)h(mdp_worker.xml)-2
1298 y
SDict begin H.S end
 -2 1298 a -2 1298 a
SDict begin 13 H.A end
 -2 1298 a -2 1298 a
SDict begin [/View [/XYZ H.V]/Dest (0:3664) cvn /DEST pdfmark end
 -2 1298
a 396 1394 a Fj(Here)20 b(is)h(the)g(Markdo)n(wn)d(te)o(xt)i(we)g(get)g
(for)g(the)g(w)o(ork)o(er)f(protocol:)-2 1495 y
SDict begin H.S end
 -2 1495
a -2 1495 a
SDict begin 11.7 H.A end
 -2 1495 a -2 1495 a
SDict begin [/View [/XYZ H.V]/Dest (0:3665) cvn /DEST pdfmark end
 -2 1495 a 396 1574 a
Fg(##)45 b(The)f(MDP/Worker)f(Protocol)396 1769 y(A)i(READY)f(command)g
(consists)f(of)i(a)f(multi-part)f(message)h(of)h(4)396
1866 y(frames:)396 2073 y(*)486 2060 y(Frame)f(1:)g("")h(\(0)f(bytes,)g
(Empty)g(frame\))396 2170 y(*)486 2157 y(Frame)g(2:)g("MDPW01")g(\(6)g
(bytes,)g(Protocol)g(identifier\))396 2267 y(*)486 2254
y(Frame)g(3:)g(0x01)h(\(1)f(byte,)g(READY\))396 2364
y(*)486 2351 y(Frame)g(4:)g(Service)g(name)g(\(printable)f(string\))396
2546 y(A)i(REQUEST)f(command)f(consists)h(of)g(a)h(multi-part)e
(message)h(of)g(5)396 2643 y(frames:)396 2850 y(*)486
2837 y(Frame)g(1:)g("")h(\(0)f(bytes,)g(Empty)g(frame\))396
2947 y(*)486 2934 y(Frame)g(2:)g("MDPW01")g(\(6)g(bytes,)g(Protocol)g
(identifier\))396 3044 y(*)486 3031 y(Frame)g(3:)g(0x02)h(\(1)f(byte,)g
(REQUEST\))396 3142 y(*)486 3129 y(Frame)g(4:)g(Client)g(address)g
(\(opaque)g(binary\))396 3239 y(*)486 3226 y(Frame)g(6:)g(Request)g
(body)g(\(opaque)g(binary\))396 3420 y(A)h(REPLY)f(command)g(consists)f
(of)i(a)f(multi-part)f(message)h(of)h(5)396 3517 y(frames:)396
3724 y(*)486 3711 y(Frame)f(1:)g("")h(\(0)f(bytes,)g(Empty)g(frame\))
396 3821 y(*)486 3808 y(Frame)g(2:)g("MDPW01")g(\(6)g(bytes,)g
(Protocol)g(identifier\))396 3919 y(*)486 3906 y(Frame)g(3:)g(0x03)h
(\(1)f(byte,)g(REPLY\))396 4016 y(*)486 4003 y(Frame)g(4:)g(Client)g
(address)g(\(opaque)g(binary\))396 4113 y(*)486 4100
y(Frame)g(6:)g(Request)g(body)g(\(opaque)g(binary\))396
4294 y(A)h(HEARBEAT)e(command)h(consists)g(of)g(a)h(multi-part)e
(message)h(of)g(3)396 4391 y(frames:)396 4599 y(*)486
4586 y(Frame)g(1:)g("")h(\(0)f(bytes,)g(Empty)g(frame\))396
4696 y(*)486 4683 y(Frame)g(2:)g("MDPW01")g(\(6)g(bytes,)g(Protocol)g
(identifier\))396 4793 y(*)486 4780 y(Frame)g(3:)g(0x04)h(\(1)f(byte,)g
(HEARBEAT\))396 4974 y(A)h(DISCONNECT)e(command)h(consists)f(of)i(a)f
(multi-part)g(message)f(of)i(3)396 5071 y(frames:)p Black
3756 5569 a Fi(277)p Black eop end
%%Page: 278 292
TeXDict begin 278 291 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.278) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 85 a Fg(*)486 72 y(Frame)44 b(1:)g("")h(\(0)f(bytes,)g(Empty)
g(frame\))396 183 y(*)486 170 y(Frame)g(2:)g("MDPW01")g(\(6)g(bytes,)g
(Protocol)g(identifier\))396 280 y(*)486 267 y(Frame)g(3:)g(0x05)h(\(1)
f(byte,)g(DISCONNECT\))-2 444 y
SDict begin H.S end
 -2 444 a -2 444 a
SDict begin 13 H.A end
 -2
444 a -2 444 a
SDict begin [/View [/XYZ H.V]/Dest (0:3666) cvn /DEST pdfmark end
 -2 444 a 396 541 a Fj(Which)20 b(as)h(you)f(can)g(see)g
(is)h(close)g(to)f(what)g(I)h(wrote)e(by)h(hand)f(in)i(the)f(original)f
(spec.)h(No)n(w)-5 b(,)19 b(if)i(you)e(ha)n(v)o(e)h(cloned)f(the)396
649 y(Guide)h(repository)e(and)i(you)f(are)h(looking)f(at)i(the)f(code)
f(in)i(e)o(xamples/models,)c(you)j(can)g(generate)f(the)h(MDP)g(client)
396 757 y(and)g(w)o(ork)o(er)f(codecs.)h(W)-7 b(e)21
b(pass)g(the)f(same)g(tw)o(o)h(models)e(to)i(a)f(dif)n(ferent)f(code)g
(generator:)-2 858 y
SDict begin H.S end
 -2 858 a -2 858 a
SDict begin 11.7 H.A end
 -2 858 a -2 858
a
SDict begin [/View [/XYZ H.V]/Dest (0:3667) cvn /DEST pdfmark end
 -2 858 a 396 937 a Fg(gsl)45 b(-script:codec_c)d(mdp_client.xml)g
(mdp_worker.xml)-2 1114 y
SDict begin H.S end
 -2 1114 a -2 1114 a
SDict begin 13 H.A end
 -2 1114
a -2 1114 a
SDict begin [/View [/XYZ H.V]/Dest (0:3668) cvn /DEST pdfmark end
 -2 1114 a 396 1211 a Fj(Which)20 b(gi)n(v)o(es)g(us)h
(mdp_client)d(and)i(mdp_w)o(ork)o(er)d(classes.)k(Actually)f(MDP)g(is)h
(so)g(simple)f(that)g(it')-5 b(s)22 b(barely)d(w)o(orth)396
1319 y(the)h(ef)n(fort)g(of)f(writing)h(the)g(code)g(generator)-5
b(.)18 b(The)i(pro\002t)g(comes)g(when)f(we)i(w)o(ant)f(to)g(change)f
(the)h(protocol)f(\(which)396 1427 y(we)i(did)f(for)f(the)h(standalone)
f(Majordomo)f(project\).)h(Y)-9 b(ou)19 b(modify)g(the)h(protocol,)e
(run)i(the)g(command,)e(and)i(out)f(pops)396 1534 y(more)h(perfect)f
(code.)-2 1719 y
SDict begin H.S end
 -2 1719 a -2 1719 a
SDict begin 13 H.A end
 -2 1719 a -2 1719
a
SDict begin [/View [/XYZ H.V]/Dest (0:3669) cvn /DEST pdfmark end
 -2 1719 a 396 1808 a Fj(The)546 1808 y
SDict begin H.S end
 546 1808 a 546
1808 a
SDict begin 13 H.A end
 546 1808 a 546 1808 a
SDict begin [/View [/XYZ H.V]/Dest (0:3670) cvn /DEST pdfmark end
 546 1808 a Fg(codec_c.gsl)g
Fj(code)h(generator)e(is)j(not)f(short,)f(b)n(ut)i(the)f(resulting)f
(codecs)h(are)g(much)f(better)h(than)g(the)396 1916 y(hand-written)e
(code)i(I)g(originally)f(put)h(together)e(for)i(Majordomo.)e(F)o(or)h
(instance)h(the)g(hand-written)e(code)i(had)g(no)396
2024 y(error)f(checking,)g(and)g(w)o(ould)h(die)g(if)g(you)g(passed)g
(it)h(bogus)e(messages.)-2 2208 y
SDict begin H.S end
 -2 2208 a -2 2208 a
SDict begin 13 H.A end

-2 2208 a -2 2208 a
SDict begin [/View [/XYZ H.V]/Dest (0:3671) cvn /DEST pdfmark end
 -2 2208 a 396 2298 a Fj(I'm)h(no)n(w)g(going)e(to)j
(e)o(xplain)e(the)h(pros)g(and)f(cons)h(of)g(GSL-po)n(wered)e
(model-oriented)f(code)j(generation.)e(Po)n(wer)396 2406
y(does)i(not)g(come)g(for)f(free)h(and)g(one)f(of)h(the)g(greatest)g
(traps)g(in)h(our)e(b)n(usiness)i(is)g(the)f(ability)g(to)g(in)m(v)o
(ent)f(concepts)g(out)h(of)396 2514 y(thin)g(air)-5 b(.)21
b(GSL)f(mak)o(es)g(this)h(particularly)e(easy)-5 b(,)19
b(so)i(can)f(be)g(a)g(particularly)f(dangerous)f(tool.)-2
2698 y
SDict begin H.S end
 -2 2698 a -2 2698 a
SDict begin 13 H.A end
 -2 2698 a -2 2698 a
SDict begin [/View [/XYZ H.V]/Dest (0:3672) cvn /DEST pdfmark end
 -2 2698
a -2 2698 a
SDict begin H.S end
 -2 2698 a -2 2698 a
SDict begin 13 H.A end
 -2 2698 a -2 2698 a
SDict begin [/View [/XYZ H.V]/Dest (0:3673) cvn /DEST pdfmark end
 -2
2698 a 396 2788 a Fi(Do)i(not)g(in)m(vent)g(concepts)p
Fj(.)f(The)h(job)f(of)h(a)h(designer)e(is)i(to)f(remo)o(v)o(e)f
(problems,)f(not)i(to)g(add)g(features.)-2 2972 y
SDict begin H.S end
 -2
2972 a -2 2972 a
SDict begin 13 H.A end
 -2 2972 a -2 2972 a
SDict begin [/View [/XYZ H.V]/Dest (0:3674) cvn /DEST pdfmark end
 -2 2972 a 396 3062
a Fj(So,)g(\002rst,)h(the)f(adv)n(antages)f(of)h(model-oriented)d(code)
i(generation:)-2 3080 y
SDict begin H.S end
 -2 3080 a -2 3080 a
SDict begin 13 H.A end
 -2 3080 a
-2 3080 a
SDict begin [/View [/XYZ H.V]/Dest (0:3675) cvn /DEST pdfmark end
 -2 3080 a -2 3090 a
SDict begin H.S end
 -2 3090 a -2 3090 a
SDict begin 13 H.A end
 -2
3090 a -2 3090 a
SDict begin [/View [/XYZ H.V]/Dest (0:3676) cvn /DEST pdfmark end
 -2 3090 a Black 396 3232 a Fe(\225)p
Black 479 3232 a
SDict begin H.S end
 479 3232 a 479 3232 a
SDict begin 13 H.A end
 479 3232 a 479
3232 a
SDict begin [/View [/XYZ H.V]/Dest (0:3677) cvn /DEST pdfmark end
 479 3232 a Fj(Y)-9 b(ou)20 b(can)g(create)g('perfect')e
(abstractions)i(that)g(map)g(to)g(your)f(real)h(w)o(orld.)g(So,)g(our)f
(protocol)g(model)g(maps)h(100\045)479 3340 y(to)h(the)f(')l(real)g(w)o
(orld')f(of)h(Majordomo.)d(This)k(w)o(ould)e(be)h(impossible)g(without)
f(the)h(freedom)f(to)h(tune)g(and)g(change)479 3448 y(the)g(model)g(in)
g(an)o(y)g(w)o(ay)-5 b(.)-2 3466 y
SDict begin H.S end
 -2 3466 a -2 3466
a
SDict begin 13 H.A end
 -2 3466 a -2 3466 a
SDict begin [/View [/XYZ H.V]/Dest (0:3678) cvn /DEST pdfmark end
 -2 3466 a Black 396 3598 a Fe(\225)p
Black 479 3598 a
SDict begin H.S end
 479 3598 a 479 3598 a
SDict begin 13 H.A end
 479 3598 a 479
3598 a
SDict begin [/View [/XYZ H.V]/Dest (0:3679) cvn /DEST pdfmark end
 479 3598 a Fj(Y)c(ou)20 b(can)g(de)n(v)o(elop)e(these)j(perfect)
e(models)g(quickly)g(and)h(cheaply)-5 b(.)-2 3616 y
SDict begin H.S end
 -2
3616 a -2 3616 a
SDict begin 13 H.A end
 -2 3616 a -2 3616 a
SDict begin [/View [/XYZ H.V]/Dest (0:3680) cvn /DEST pdfmark end
 -2 3616 a Black
396 3747 a Fe(\225)p Black 479 3747 a
SDict begin H.S end
 479 3747 a 479
3747 a
SDict begin 13 H.A end
 479 3747 a 479 3747 a
SDict begin [/View [/XYZ H.V]/Dest (0:3681) cvn /DEST pdfmark end
 479 3747 a Fj(Y)c(ou)20
b(can)g(generate)1072 3747 y
SDict begin H.S end
 1072 3747 a 1072 3747 a
SDict begin 13 H.A end

1072 3747 a 1072 3747 a
SDict begin [/View [/XYZ H.V]/Dest (0:3682) cvn /DEST pdfmark end
 1072 3747 a Fi(any)f Fj(te)o(xt)h(output.)f
(From)h(a)g(single)h(model)e(you)g(can)h(create)g(documentation,)d
(code)j(in)g(an)o(y)479 3855 y(language,)f(test)i(tools,)f(literally)g
(an)o(y)f(output)g(you)g(can)h(think)g(of.)-2 3873 y
SDict begin H.S end

-2 3873 a -2 3873 a
SDict begin 13 H.A end
 -2 3873 a -2 3873 a
SDict begin [/View [/XYZ H.V]/Dest (0:3683) cvn /DEST pdfmark end
 -2 3873 a Black
396 4004 a Fe(\225)p Black 479 4004 a
SDict begin H.S end
 479 4004 a 479
4004 a
SDict begin 13 H.A end
 479 4004 a 479 4004 a
SDict begin [/View [/XYZ H.V]/Dest (0:3684) cvn /DEST pdfmark end
 479 4004 a Fj(Y)-9 b(ou)20
b(can)g(generate)f(\(and)g(I)h(mean)g(this)h(literally\))1936
4004 y
SDict begin H.S end
 1936 4004 a 1936 4004 a
SDict begin 13 H.A end
 1936 4004 a 1936 4004
a
SDict begin [/View [/XYZ H.V]/Dest (0:3685) cvn /DEST pdfmark end
 1936 4004 a Fi(perfect)h Fj(output)d(since)i(it')-5
b(s)21 b(cheap)e(to)i(impro)o(v)o(e)d(your)g(code)479
4112 y(generators)h(to)h(an)o(y)g(le)n(v)o(el)f(you)h(w)o(ant.)-2
4130 y
SDict begin H.S end
 -2 4130 a -2 4130 a
SDict begin 13 H.A end
 -2 4130 a -2 4130 a
SDict begin [/View [/XYZ H.V]/Dest (0:3686) cvn /DEST pdfmark end
 -2 4130
a Black 396 4262 a Fe(\225)p Black 479 4262 a
SDict begin H.S end
 479 4262
a 479 4262 a
SDict begin 13 H.A end
 479 4262 a 479 4262 a
SDict begin [/View [/XYZ H.V]/Dest (0:3687) cvn /DEST pdfmark end
 479 4262 a Fj(Y)-9
b(ou)20 b(get)g(a)h(single)f(source)f(that)i(combines)d
(speci\002cations)i(and)g(semantics.)-2 4280 y
SDict begin H.S end
 -2 4280
a -2 4280 a
SDict begin 13 H.A end
 -2 4280 a -2 4280 a
SDict begin [/View [/XYZ H.V]/Dest (0:3688) cvn /DEST pdfmark end
 -2 4280 a Black 396 4411
a Fe(\225)p Black 479 4411 a
SDict begin H.S end
 479 4411 a 479 4411 a
SDict begin 13 H.A end
 479
4411 a 479 4411 a
SDict begin [/View [/XYZ H.V]/Dest (0:3689) cvn /DEST pdfmark end
 479 4411 a Fj(Y)-9 b(ou)20 b(can)g(le)n(v)o(erage)e
(a)j(small)g(team)f(to)g(a)h(massi)n(v)o(e)f(size.)g(At)h(iMatix)f(we)h
(produced)d(the)i(million-line)f(OpenAMQ)479 4519 y(messaging)h
(product)e(out)i(of)g(perhaps)f(85K)g(lines)i(of)f(input)f(models,)h
(including)e(the)i(code)g(generation)e(scripts)479 4627
y(themselv)o(es.)-2 4794 y
SDict begin H.S end
 -2 4794 a -2 4794 a
SDict begin 13 H.A end
 -2 4794
a -2 4794 a
SDict begin [/View [/XYZ H.V]/Dest (0:3690) cvn /DEST pdfmark end
 -2 4794 a 396 4901 a Fj(No)n(w)i(the)h(disadv)n(antages:)-2
4919 y
SDict begin H.S end
 -2 4919 a -2 4919 a
SDict begin 13 H.A end
 -2 4919 a -2 4919 a
SDict begin [/View [/XYZ H.V]/Dest (0:3691) cvn /DEST pdfmark end
 -2 4919
a -2 4929 a
SDict begin H.S end
 -2 4929 a -2 4929 a
SDict begin 13 H.A end
 -2 4929 a -2 4929 a
SDict begin [/View [/XYZ H.V]/Dest (0:3692) cvn /DEST pdfmark end
 -2
4929 a Black 396 5071 a Fe(\225)p Black 479 5071 a
SDict begin H.S end
 479
5071 a 479 5071 a
SDict begin 13 H.A end
 479 5071 a 479 5071 a
SDict begin [/View [/XYZ H.V]/Dest (0:3693) cvn /DEST pdfmark end
 479 5071 a Fj(Y)-9
b(ou)20 b(add)g(tool)f(dependencies)f(to)j(your)e(project.)-2
5089 y
SDict begin H.S end
 -2 5089 a -2 5089 a
SDict begin 13 H.A end
 -2 5089 a -2 5089 a
SDict begin [/View [/XYZ H.V]/Dest (0:3694) cvn /DEST pdfmark end
 -2 5089
a Black 3759 5569 a Fi(278)p Black eop end
%%Page: 279 293
TeXDict begin 279 292 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.279) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3695) cvn /DEST pdfmark end
 479 72 a Fj(Y)-9 b(ou)20
b(may)g(get)g(carried)f(a)o(w)o(ay)h(and)g(create)f(models)h(for)g(the)
g(pure)f(jo)o(y)h(of)g(creating)f(them.)-2 90 y
SDict begin H.S end
 -2 90
a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:3696) cvn /DEST pdfmark end
 -2 90 a Black 396 222 a Fe(\225)p
Black 479 222 a
SDict begin H.S end
 479 222 a 479 222 a
SDict begin 13 H.A end
 479 222 a 479 222
a
SDict begin [/View [/XYZ H.V]/Dest (0:3697) cvn /DEST pdfmark end
 479 222 a Fj(Y)-9 b(ou)20 b(may)g(alienate)g(ne)n(wcomers)e(to)j
(your)e(w)o(ork,)g(who)h(will)h(see)f("strange)g(stuf)n(f".)-2
240 y
SDict begin H.S end
 -2 240 a -2 240 a
SDict begin 13 H.A end
 -2 240 a -2 240 a
SDict begin [/View [/XYZ H.V]/Dest (0:3698) cvn /DEST pdfmark end
 -2 240 a Black
396 371 a Fe(\225)p Black 479 371 a
SDict begin H.S end
 479 371 a 479 371
a
SDict begin 13 H.A end
 479 371 a 479 371 a
SDict begin [/View [/XYZ H.V]/Dest (0:3699) cvn /DEST pdfmark end
 479 371 a Fj(Y)-9 b(ou)20 b(may)g(gi)n(v)o(e)f
(people)g(a)i(strong)e(e)o(xcuse)g(to)i(not)f(in)m(v)o(est)f(in)h(your)
f(project.)-2 555 y
SDict begin H.S end
 -2 555 a -2 555 a
SDict begin 13 H.A end
 -2 555 a -2 555
a
SDict begin [/View [/XYZ H.V]/Dest (0:3700) cvn /DEST pdfmark end
 -2 555 a 396 645 a Fj(Cynically)-5 b(,)19 b(model-oriented)e(ab)n
(use)j(w)o(orks)g(great)g(in)g(en)m(vironments)e(where)h(you)h(w)o(ant)
g(to)g(produce)e(huge)i(amounts)396 753 y(of)g(perfect)f(code)h(that)g
(you)f(can)h(maintain)g(with)g(little)h(ef)n(fort,)e(and)h(which)2582
753 y
SDict begin H.S end
 2582 753 a 2582 753 a
SDict begin 13 H.A end
 2582 753 a 2582 753 a
SDict begin [/View [/XYZ H.V]/Dest (0:3701) cvn /DEST pdfmark end
 2582
753 a Fi(no-one)f(can)g(e)o(ver)i(tak)o(e)f(away)g(fr)l(om)h(you.)396
861 y Fj(Personally)-5 b(,)19 b(I)h(lik)o(e)h(to)f(cross)g(my)g(ri)n(v)
o(ers)g(and)f(mo)o(v)o(e)g(on.)h(But)g(if)h(long-term)d(job)i(security)
g(is)h(your)e(thing,)g(this)i(is)396 969 y(almost)f(perfect.)-2
1153 y
SDict begin H.S end
 -2 1153 a -2 1153 a
SDict begin 13 H.A end
 -2 1153 a -2 1153 a
SDict begin [/View [/XYZ H.V]/Dest (0:3702) cvn /DEST pdfmark end
 -2 1153
a 396 1243 a Fj(So)h(if)f(you)f(do)h(use)h(GSL)f(and)g(w)o(ant)g(to)h
(create)e(open)h(communities)e(around)h(your)g(w)o(ork,)g(here)h(is)h
(my)e(advice:)-2 1261 y
SDict begin H.S end
 -2 1261 a -2 1261 a
SDict begin 13 H.A end
 -2 1261 a
-2 1261 a
SDict begin [/View [/XYZ H.V]/Dest (0:3703) cvn /DEST pdfmark end
 -2 1261 a -2 1271 a
SDict begin H.S end
 -2 1271 a -2 1271 a
SDict begin 13 H.A end
 -2
1271 a -2 1271 a
SDict begin [/View [/XYZ H.V]/Dest (0:3704) cvn /DEST pdfmark end
 -2 1271 a Black 396 1413 a Fe(\225)p
Black 479 1413 a
SDict begin H.S end
 479 1413 a 479 1413 a
SDict begin 13 H.A end
 479 1413 a 479
1413 a
SDict begin [/View [/XYZ H.V]/Dest (0:3705) cvn /DEST pdfmark end
 479 1413 a Fj(Use)i(only)f(where)f(you)g(w)o(ould)h(otherwise)f
(be)i(writing)e(tiresome)h(code)f(by)h(hand.)-2 1431
y
SDict begin H.S end
 -2 1431 a -2 1431 a
SDict begin 13 H.A end
 -2 1431 a -2 1431 a
SDict begin [/View [/XYZ H.V]/Dest (0:3706) cvn /DEST pdfmark end
 -2 1431 a Black
396 1563 a Fe(\225)p Black 479 1563 a
SDict begin H.S end
 479 1563 a 479
1563 a
SDict begin 13 H.A end
 479 1563 a 479 1563 a
SDict begin [/View [/XYZ H.V]/Dest (0:3707) cvn /DEST pdfmark end
 479 1563 a Fj(Design)g(natural)g(models)f
(that)h(are)h(what)f(people)f(w)o(ould)g(e)o(xpect)g(to)i(see.)-2
1581 y
SDict begin H.S end
 -2 1581 a -2 1581 a
SDict begin 13 H.A end
 -2 1581 a -2 1581 a
SDict begin [/View [/XYZ H.V]/Dest (0:3708) cvn /DEST pdfmark end
 -2 1581
a Black 396 1712 a Fe(\225)p Black 479 1712 a
SDict begin H.S end
 479 1712
a 479 1712 a
SDict begin 13 H.A end
 479 1712 a 479 1712 a
SDict begin [/View [/XYZ H.V]/Dest (0:3709) cvn /DEST pdfmark end
 479 1712 a Fj(Write)g(the)f(code)g
(by)g(hand)f(\002rst)i(so)f(you)f(kno)n(w)h(what)g(to)g(generate.)-2
1730 y
SDict begin H.S end
 -2 1730 a -2 1730 a
SDict begin 13 H.A end
 -2 1730 a -2 1730 a
SDict begin [/View [/XYZ H.V]/Dest (0:3710) cvn /DEST pdfmark end
 -2 1730
a Black 396 1862 a Fe(\225)p Black 479 1862 a
SDict begin H.S end
 479 1862
a 479 1862 a
SDict begin 13 H.A end
 479 1862 a 479 1862 a
SDict begin [/View [/XYZ H.V]/Dest (0:3711) cvn /DEST pdfmark end
 479 1862 a Fj(Do)g(not)g(o)o(v)o
(eruse.)f(K)n(eep)g(it)i(simple!)1556 1862 y
SDict begin H.S end
 1556 1862
a 1556 1862 a
SDict begin 13 H.A end
 1556 1862 a 1556 1862 a
SDict begin [/View [/XYZ H.V]/Dest (0:3712) cvn /DEST pdfmark end
 1556 1862 a Fi(Do)f(not)g(g)o(et)
h(too)e(meta!!)-2 1880 y
SDict begin H.S end
 -2 1880 a -2 1880 a
SDict begin 13 H.A end
 -2 1880
a -2 1880 a
SDict begin [/View [/XYZ H.V]/Dest (0:3713) cvn /DEST pdfmark end
 -2 1880 a Black 396 2011 a Fe(\225)p Black
479 2011 a
SDict begin H.S end
 479 2011 a 479 2011 a
SDict begin 13 H.A end
 479 2011 a 479 2011
a
SDict begin [/View [/XYZ H.V]/Dest (0:3714) cvn /DEST pdfmark end
 479 2011 a Fj(Introduce)f(gradually)h(into)g(a)i(project.)-2
2029 y
SDict begin H.S end
 -2 2029 a -2 2029 a
SDict begin 13 H.A end
 -2 2029 a -2 2029 a
SDict begin [/View [/XYZ H.V]/Dest (0:3715) cvn /DEST pdfmark end
 -2 2029
a Black 396 2160 a Fe(\225)p Black 479 2160 a
SDict begin H.S end
 479 2160
a 479 2160 a
SDict begin 13 H.A end
 479 2160 a 479 2160 a
SDict begin [/View [/XYZ H.V]/Dest (0:3716) cvn /DEST pdfmark end
 479 2160 a Fj(Put)g(the)f(generated)
e(code)i(into)g(your)f(repositories.)-2 2344 y
SDict begin H.S end
 -2 2344
a -2 2344 a
SDict begin 13 H.A end
 -2 2344 a -2 2344 a
SDict begin [/View [/XYZ H.V]/Dest (0:3717) cvn /DEST pdfmark end
 -2 2344 a 396 2434 a
Fj(W)-7 b(e')l(re)21 b(already)e(using)g(GSL)i(in)f(some)g(projects)g
(around)e(\330MQ,)i(for)g(e)o(xample)f(the)h(high-le)n(v)o(el)e(C)j
(binding,)d(CZMQ,)396 2542 y(uses)j(GSL)g(to)f(generate)f(the)h(sock)o
(et)g(options)f(class)j(\(zsock)o(opt\).)c(A)i(300-line)f(code)g
(generator)g(turns)g(78)h(lines)h(of)396 2650 y(XML)f(model)g(into)g
(1,500)e(lines)j(of)f(perfect)f(b)n(ut)h(really)g(boring)f(code.)g
(That')-5 b(s)20 b(a)h(good)e(win.)-2 2762 y
SDict begin H.S end
 -2 2762
a -2 2762 a
SDict begin 13 H.A end
 -2 2762 a -2 2762 a
SDict begin [/View [/XYZ H.V]/Dest (0:3718) cvn /DEST pdfmark end
 -2 2762 a 359 x Fh(6.8.)39
b(T)-11 b(ransf)o(erring)36 b(Files)1477 3121 y
SDict begin H.S end
 1477
3121 a 1477 3121 a
SDict begin 22.464 H.A end
 1477 3121 a 1477 3121 a
SDict begin [/View [/XYZ H.V]/Dest (11.67.1) cvn /DEST pdfmark end
 1477 3121
a -2 3319 a
SDict begin H.S end
 -2 3319 a -2 3319 a
SDict begin 13 H.A end
 -2 3319 a -2 3319 a
SDict begin [/View [/XYZ H.V]/Dest (0:3720) cvn /DEST pdfmark end
 -2
3319 a 396 3395 a Fj(Let')-5 b(s)21 b(tak)o(e)f(a)h(break)e(from)g(the)
h(lecturing)f(and)h(get)g(back)g(to)g(our)f(\002rst)i(lo)o(v)o(e)f(and)
f(the)h(reason)g(for)f(doing)g(all)i(of)f(this:)396 3503
y(code.)-2 3670 y
SDict begin H.S end
 -2 3670 a -2 3670 a
SDict begin 13 H.A end
 -2 3670 a -2 3670
a
SDict begin [/View [/XYZ H.V]/Dest (0:3721) cvn /DEST pdfmark end
 -2 3670 a 396 3777 a Fj("Ho)n(w)g(do)g(I)g(send)g(a)h(\002le?")g(is)g
(a)f(common)f(question)g(on)g(the)i(\330MQ)f(mailing)g(lists.)h(Not)f
(surprising,)f(because)g(\002le)396 3885 y(transfer)h(is)h(perhaps)e
(the)h(oldest)g(and)g(most)g(ob)o(vious)e(type)i(of)g(messaging.)f
(Sending)g(\002les)i(around)d(netw)o(orks)i(has)396 3993
y(lots)h(of)f(use-cases)g(apart)f(from)g(anno)o(ying)f(the)i(cop)o
(yright)e(cartels.)i(\330MQ)g(is)h(v)o(ery)e(good,)f(out)i(of)g(the)g
(box,)e(at)j(sending)396 4100 y(e)n(v)o(ents)f(and)f(tasks)i(b)n(ut)f
(less)i(good)d(at)h(sending)f(\002les.)-2 4285 y
SDict begin H.S end
 -2 4285
a -2 4285 a
SDict begin 13 H.A end
 -2 4285 a -2 4285 a
SDict begin [/View [/XYZ H.V]/Dest (0:3722) cvn /DEST pdfmark end
 -2 4285 a 396 4374 a
Fj(I')l(v)o(e)g(promised,)g(for)g(a)i(year)f(or)g(tw)o(o,)g(to)g(write)
g(a)h(proper)e(e)o(xplanation.)e(Here')-5 b(s)21 b(a)f(gratuitous)f
(piece)h(of)g(information)396 4482 y(to)h(brighten)d(your)h(morning:)f
(the)i(w)o(ord)g("proper")e(comes)i(from)f(the)h(archaic)g(French)f
("propre")f(which)i(means)396 4590 y("clean".)g(The)g(dark)f(age)h
(English)f(common)g(folk,)g(not)h(being)f(f)o(amiliar)h(with)g(hot)g(w)
o(ater)g(and)g(soap,)g(changed)e(the)396 4698 y(w)o(ord)i(to)g(mean)g
("foreign")e(or)i("upper)n(-class",)f(as)h(in)h("that')-5
b(s)20 b(proper)f(food!")f(b)n(ut)i(later)h(the)f(w)o(ord)f(meant)h
(just)h("real",)396 4806 y(as)g(in)g("that')-5 b(s)20
b(a)h(proper)d(mess)j(you')l(v)o(e)d(gotten)h(us)i(into!")p
Black 3759 5569 a Fi(279)p Black eop end
%%Page: 280 294
TeXDict begin 280 293 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.280) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3723) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(So,)h(\002le)h(transfer)-5 b(.)20 b(There)f(are)h(se)
n(v)o(eral)g(reasons)g(you)f(can')o(t)g(just)i(pick)f(up)f(a)i(random)d
(\002le,)j(blindfold)d(it,)j(and)e(sho)o(v)o(e)g(it)396
180 y(whole)h(into)g(a)g(message.)g(The)g(most)g(ob)o(vious)f(being)g
(that)h(despite)g(decades)g(of)g(determined)e(gro)n(wth)h(in)h(RAM)h
(sizes)396 288 y(\(and)e(who)h(among)f(us)h(old-timers)f(doesn')o(t)f
(fondly)h(remember)f(sa)n(ving)i(up)f(for)h(that)g(1,014-byte)d(memory)
h(e)o(xtension)396 396 y(card?!\),)h(disk)h(sizes)h(obstinately)e
(remain)h(much)f(lar)o(ger)-5 b(.)19 b(Ev)o(en)g(if)h(we)h(could)e
(send)h(a)h(\002le)g(with)f(one)g(instruction)f(\(say)-5
b(,)396 504 y(using)20 b(a)h(system)f(call)h(lik)o(e)f(send\002le\),)f
(we')l(d)h(hit)g(the)h(reality)f(that)g(netw)o(orks)f(are)h(not)g
(in\002nitely)g(f)o(ast,)g(nor)g(perfectly)396 612 y(reliable.)g(After)
g(trying)f(to)h(upload)f(a)h(lar)o(ge)g(\002le)h(se)n(v)o(eral)e(times)
i(on)f(a)g(slo)n(w)h(\003ak)o(y)e(netw)o(ork)g(\(W)m(iFi,)i(an)o
(yone?\),)c(you')o(ll)396 720 y(realize)j(that)h(a)f(proper)f(\002le)h
(transfer)g(protocol)e(needs)i(a)h(w)o(ay)f(to)g(reco)o(v)o(er)e(from)i
(f)o(ailures.)f(That)h(is,)h(a)g(w)o(ay)f(to)g(send)396
828 y(only)g(the)g(part)g(of)g(a)g(\002le)h(that)f(w)o(asn')o(t)g(yet)g
(recei)n(v)o(ed.)-2 1012 y
SDict begin H.S end
 -2 1012 a -2 1012 a
SDict begin 13 H.A end
 -2 1012
a -2 1012 a
SDict begin [/View [/XYZ H.V]/Dest (0:3724) cvn /DEST pdfmark end
 -2 1012 a 396 1102 a Fj(Finally)-5 b(,)20
b(after)g(all)g(this,)h(if)f(you)g(b)n(uild)f(a)i(proper)d(\002le)j
(serv)o(er)m(,)e(you')o(ll)g(notice)h(that)g(simply)g(sending)f(massi)n
(v)o(e)h(amounts)396 1210 y(of)g(data)g(to)h(lots)f(of)g(clients)h
(creates)f(that)g(situation)g(we)h(lik)o(e)f(to)g(call,)h(in)f(the)g
(technical)g(parlance,)e("serv)o(er)i(went)396 1318 y(belly-up)f(due)g
(to)i(all)f(a)n(v)n(ailable)g(heap)g(memory)e(being)h(eaten)h(by)g(a)h
(poorly-designed)16 b(application".)i(A)j(proper)e(\002le)396
1426 y(transfer)h(protocol)e(needs)i(to)g(pay)g(attention)f(to)h
(memory)f(use.)-2 1610 y
SDict begin H.S end
 -2 1610 a -2 1610 a
SDict begin 13 H.A end
 -2 1610
a -2 1610 a
SDict begin [/View [/XYZ H.V]/Dest (0:3725) cvn /DEST pdfmark end
 -2 1610 a 396 1700 a Fj(W)-7 b(e')o(ll)22
b(solv)o(e)d(these)i(problems)d(properly)-5 b(,)18 b(one)i(by)f(one,)h
(which)f(should)h(hopefully)d(get)k(us)f(to)h(a)f(good)f(and)h(proper)e
(\002le)396 1808 y(transfer)i(protocol)e(running)g(o)o(v)o(er)h
(\330MQ.)h(First,)h(let')-5 b(s)21 b(generate)e(a)i(1GB)f(test)h
(\002le)g(with)f(random)f(data)h(\(real)396 1916 y(po)n(wer)n(-of-tw)o
(o-giga-lik)o(e-V)-11 b(on-)o(Neum)o(man)o(-in)o(tend)o(ed,)14
b(not)20 b(the)g(f)o(ak)o(e)g(silicon)g(ones)g(the)h(memory)d(industry)
h(lik)o(es)i(to)396 2023 y(sell\):)-2 2121 y
SDict begin H.S end
 -2 2121
a -2 2121 a
SDict begin 11.7 H.A end
 -2 2121 a -2 2121 a
SDict begin [/View [/XYZ H.V]/Dest (0:3726) cvn /DEST pdfmark end
 -2 2121 a 396 2204 a
Fg(dd)45 b(if=/dev/urandom)d(of=testdata)h(bs=1M)h(count=1024)-2
2376 y
SDict begin H.S end
 -2 2376 a -2 2376 a
SDict begin 13 H.A end
 -2 2376 a -2 2376 a
SDict begin [/View [/XYZ H.V]/Dest (0:3727) cvn /DEST pdfmark end
 -2 2376
a 396 2478 a Fj(This)21 b(is)g(lar)o(ge)e(enough)f(to)i(be)h
(troublesome)d(when)h(we)i(ha)n(v)o(e)f(lots)g(of)g(clients)h(asking)e
(for)h(the)g(same)g(\002le)h(at)g(once,)e(and)396 2586
y(on)h(man)o(y)e(machines,)h(1GB)h(is)h(going)e(to)h(be)f(too)h(lar)o
(ge)f(to)h(allocate)g(in)g(memory)e(an)o(yho)n(w)-5 b(.)17
b(As)k(a)f(base)g(reference,)e(let')-5 b(s)396 2693 y(measure)20
b(ho)n(w)f(long)h(it)h(tak)o(es)f(to)g(cop)o(y)g(this)g(\002le)h(from)e
(disk)i(back)e(to)h(disk.)g(This)h(will)g(tell)g(us)f(ho)n(w)g(much)f
(our)g(\002le)396 2801 y(transfer)h(protocol)e(adds)i(on)g(top)g
(\(including)e('netw)o(ork')g(costs\):)-2 2902 y
SDict begin H.S end
 -2 2902
a -2 2902 a
SDict begin 11.7 H.A end
 -2 2902 a -2 2902 a
SDict begin [/View [/XYZ H.V]/Dest (0:3728) cvn /DEST pdfmark end
 -2 2902 a 396 2982 a
Fg($)45 b(time)f(cp)h(testdata)e(testdata2)396 3176 y(real)179
b(0m7.143s)396 3273 y(user)g(0m0.012s)396 3370 y(sys)224
b(0m1.188s)-2 3548 y
SDict begin H.S end
 -2 3548 a -2 3548 a
SDict begin 13 H.A end
 -2 3548 a -2
3548 a
SDict begin [/View [/XYZ H.V]/Dest (0:3729) cvn /DEST pdfmark end
 -2 3548 a 396 3644 a Fj(The)20 b(4-\002gure)f(precision)g(is)i
(misleading;)e(e)o(xpect)g(v)n(ariations)g(of)h(25\045)g(either)g(w)o
(ay)-5 b(.)20 b(This)g(is)h(just)g(an)f("order)f(of)396
3752 y(magnitude")f(measurement.)-2 3936 y
SDict begin H.S end
 -2 3936 a
-2 3936 a
SDict begin 13 H.A end
 -2 3936 a -2 3936 a
SDict begin [/View [/XYZ H.V]/Dest (0:3730) cvn /DEST pdfmark end
 -2 3936 a 396 4026 a Fj(Here')-5
b(s)21 b(our)e(\002rst)i(cut)f(at)h(the)f(code,)f(where)h(the)g(client)
g(asks)h(for)f(the)g(test)h(data)f(and)g(the)g(serv)o(er)f(just)i
(sends)f(it,)h(without)396 4134 y(stopping)e(for)h(breath,)f(as)h(a)h
(series)g(of)f(messages,)g(where)f(each)h(message)g(holds)g(one)g
('chunk':)-2 4152 y
SDict begin H.S end
 -2 4152 a -2 4152 a
SDict begin 13 H.A end
 -2 4152 a -2
4152 a
SDict begin [/View [/XYZ H.V]/Dest (0:fileio1-php) cvn /DEST pdfmark
end
 -2 4152 a 396 4335 a Fk(Example)h(6-1.)e(File)h(transfer)g
(test,)g(model)g(1)h(\(\002leio1.php\))-2 4435 y
SDict begin H.S end
 -2 4435
a -2 4435 a
SDict begin 11.7 H.A end
 -2 4435 a -2 4435 a
SDict begin [/View [/XYZ H.V]/Dest (0:3733) cvn /DEST pdfmark end
 -2 4435 a 396 4515 a
Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
4693 y
SDict begin H.S end
 -2 4693 a -2 4693 a
SDict begin 13 H.A end
 -2 4693 a -2 4693 a
SDict begin [/View [/XYZ H.V]/Dest (0:3734) cvn /DEST pdfmark end
 -2 4693
a 396 4789 a Fj(It')-5 b(s)21 b(pretty)f(simple)g(b)n(ut)g(we)g
(already)g(run)f(into)h(a)h(problem:)d(if)j(we)f(send)g(too)g(much)f
(data)h(to)h(the)f(R)m(OUTER)g(sock)o(et,)396 4897 y(we)h(can)f(easily)
g(o)o(v)o(er\003o)n(w)f(it.)h(The)g(simple)g(b)n(ut)g(stupid)g
(solution)g(is)h(to)f(put)g(an)g(in\002nite)g(high-w)o(ater)f(mark)g
(on)h(the)396 5005 y(sock)o(et.)g(It')-5 b(s)21 b(stupid)f(because)f
(we)i(no)n(w)e(ha)n(v)o(e)h(no)g(protection)e(against)i(e)o(xhausting)e
(the)i(serv)o(er')-5 b(s)20 b(memory)-5 b(.)18 b(Y)-8
b(et)396 5113 y(without)20 b(an)g(in\002nite)g(HWM)h(we)f(risk)h
(losing)e(chunks)g(of)h(lar)o(ge)f(\002les.)p Black 3759
5569 a Fi(280)p Black eop end
%%Page: 281 295
TeXDict begin 281 294 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.281) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3735) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(T)m(ry)h(this:)h(set)g(the)f(HWM)h(to)f(1,000)f(\(in)
h(\330MQ/3.x)f(this)i(is)g(the)f(def)o(ault\))f(and)h(then)g(reduce)f
(the)h(chunk)e(size)j(to)g(100K)396 180 y(so)g(we)f(send)g(10K)g
(chunks)f(in)h(one)g(go.)g(Run)g(the)g(test,)h(and)e(you')o(ll)h(see)g
(it)h(ne)n(v)o(er)e(\002nishes.)h(As)h(the)3275 180 y
SDict begin H.S end

3275 180 a 3275 180 a
SDict begin 13 H.A end
 3275 180 a 3275 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:3736) cvn /DEST pdfmark end
 3275 180
a Fg(zmq_socket\(\))396 288 y Fj(man)f(page)f(says)i(with)g(cheerful)d
(brutality)-5 b(,)19 b(for)g(the)i(R)m(OUTER)f(sock)o(et:)g("ZMQ_HWM)g
(option)f(action:)h(Drop".)-2 472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end

-2 472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:3737) cvn /DEST pdfmark end
 -2 472 a 396 562 a Fj(W)-7 b(e)22 b(ha)n(v)o(e)d(to)i
(control)e(the)h(amount)f(of)g(data)i(the)f(serv)o(er)f(sends)h
(up-front.)e(There')-5 b(s)20 b(no)f(point)h(in)g(it)h(sending)e(more)g
(than)396 670 y(the)h(netw)o(ork)f(can)h(handle.)f(Let')-5
b(s)21 b(try)f(sending)f(one)h(chunk)e(at)j(a)g(time.)f(In)g(this)g(v)o
(ersion)f(of)h(the)h(protocol,)d(the)i(client)396 778
y(will)h(e)o(xplicitly)e(say)-5 b(,"gi)n(v)o(e)19 b(me)h(chunk)f(N",)h
(and)f(the)i(serv)o(er)e(will)i(fetch)f(that)g(speci\002c)g(chunk)f
(from)g(disk)h(and)g(send)g(it.)-2 962 y
SDict begin H.S end
 -2 962 a -2
962 a
SDict begin 13 H.A end
 -2 962 a -2 962 a
SDict begin [/View [/XYZ H.V]/Dest (0:3738) cvn /DEST pdfmark end
 -2 962 a 396 1052 a Fj(Here')-5
b(s)21 b(the)f(impro)o(v)o(ed)d(second)j(model,)f(where)g(the)i(client)
f(asks)g(for)g(one)g(chunk)e(at)j(a)g(time,)f(and)f(the)i(serv)o(er)e
(only)396 1160 y(sends)h(one)g(chunk)f(for)g(each)h(request)g(it)h
(gets)f(from)f(the)h(client:)-2 1178 y
SDict begin H.S end
 -2 1178 a -2 1178
a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:fileio2-php) cvn /DEST pdfmark
end
 -2 1178 a 396 1361 a Fk(Example)h(6-2.)e(File)h
(transfer)g(test,)g(model)g(2)h(\(\002leio2.php\))-2
1461 y
SDict begin H.S end
 -2 1461 a -2 1461 a
SDict begin 11.7 H.A end
 -2 1461 a -2 1461 a
SDict begin [/View [/XYZ H.V]/Dest (0:3741) cvn /DEST pdfmark end
 -2 1461
a 396 1542 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 1719 y
SDict begin H.S end
 -2 1719 a -2 1719 a
SDict begin 13 H.A end
 -2 1719 a
-2 1719 a
SDict begin [/View [/XYZ H.V]/Dest (0:3742) cvn /DEST pdfmark end
 -2 1719 a 396 1816 a Fj(It)21 b(is)g(much)e(slo)n(wer)h(no)n
(w)-5 b(,)19 b(because)h(of)g(the)g(to-and-fro)d(chatting)i(between)h
(client)g(and)g(serv)o(er)-5 b(.)19 b(W)-7 b(e)21 b(pay)f(about)f(300)
396 1923 y(microseconds)g(for)g(each)h(request-reply)e(round-trips,)f
(on)j(a)h(local)f(loop)f(connection)f(\(client)i(and)g(serv)o(er)f(on)h
(the)396 2031 y(same)h(box\).)d(It)j(doesn')o(t)d(sound)i(lik)o(e)g
(much)f(b)n(ut)h(it)h(adds)f(up)g(quickly:)-2 2132 y
SDict begin H.S end

-2 2132 a -2 2132 a
SDict begin 11.7 H.A end
 -2 2132 a -2 2132 a
SDict begin [/View [/XYZ H.V]/Dest (0:3743) cvn /DEST pdfmark end
 -2 2132 a 396
2212 a Fg($)45 b(time)f(./fileio1)396 2309 y(4296)g(chunks)g(received,)
g(1073741824)f(bytes)396 2503 y(real)179 b(0m0.669s)396
2600 y(user)g(0m0.056s)396 2697 y(sys)224 b(0m1.048s)396
2891 y($)45 b(time)f(./fileio2)396 2989 y(4295)g(chunks)g(received,)g
(1073741824)f(bytes)396 3183 y(real)179 b(0m2.389s)396
3280 y(user)g(0m0.312s)396 3377 y(sys)224 b(0m2.136s)-2
3555 y
SDict begin H.S end
 -2 3555 a -2 3555 a
SDict begin 13 H.A end
 -2 3555 a -2 3555 a
SDict begin [/View [/XYZ H.V]/Dest (0:3744) cvn /DEST pdfmark end
 -2 3555
a 396 3651 a Fj(There)20 b(are)g(tw)o(o)g(v)n(aluable)f(lessons)i
(here.)e(First,)i(while)f(request-reply)e(is)j(easy)-5
b(,)20 b(it')-5 b(s)21 b(also)f(too)g(slo)n(w)h(for)e(high-v)n(olume)
396 3759 y(data)h(\003o)n(ws.)h(P)o(aying)e(that)h(300)f(microseconds)g
(once)g(w)o(ould)h(be)g(\002ne.)g(P)o(aying)f(it)i(for)e(e)n(v)o(ery)g
(single)h(chunk)f(isn')o(t)396 3867 y(acceptable,)g(particularly)g(on)g
(real)i(netw)o(orks)e(with)h(latencies)g(of)g(perhaps)f(1,000)g(times)i
(higher)-5 b(.)-2 4051 y
SDict begin H.S end
 -2 4051 a -2 4051 a
SDict begin 13 H.A end
 -2 4051
a -2 4051 a
SDict begin [/View [/XYZ H.V]/Dest (0:3745) cvn /DEST pdfmark end
 -2 4051 a 396 4141 a Fj(The)20 b(second)f(point)h(is)h
(something)e(I')l(v)o(e)g(said)h(before)f(b)n(ut)h(will)h(repeat:)f
(it')-5 b(s)21 b(incredibly)e(easy)h(to)g(e)o(xperiment,)396
4249 y(measure,)f(and)h(impro)o(v)o(e)e(our)h(protocols)g(o)o(v)o(er)g
(\330MQ.)h(And)g(when)f(the)i(cost)f(of)g(something)f(comes)h(w)o(ay)g
(do)n(wn,)f(you)396 4357 y(can)h(af)n(ford)f(a)h(lot)h(more)e(of)h(it.)
h(Do)f(learn)g(to)g(de)n(v)o(elop)e(and)i(pro)o(v)o(e)e(your)h
(protocols)g(in)h(isolation:)g(I')l(v)o(e)f(seen)h(teams)396
4465 y(w)o(aste)h(time)g(trying)e(to)h(impro)o(v)o(e)e(poorly-designed)
e(protocols)j(that)h(are)g(too)g(deeply)f(embedded)f(in)j(applications)
e(to)396 4573 y(be)h(easily)h(testable)f(or)g(\002xable.)-2
4757 y
SDict begin H.S end
 -2 4757 a -2 4757 a
SDict begin 13 H.A end
 -2 4757 a -2 4757 a
SDict begin [/View [/XYZ H.V]/Dest (0:3746) cvn /DEST pdfmark end
 -2 4757
a 396 4847 a Fj(Our)g(model)f(2)i(\002le)g(transfer)e(protocol)f(isn')o
(t)i(so)h(bad,)e(apart)h(from)f(performance:)-2 4865
y
SDict begin H.S end
 -2 4865 a -2 4865 a
SDict begin 13 H.A end
 -2 4865 a -2 4865 a
SDict begin [/View [/XYZ H.V]/Dest (0:3747) cvn /DEST pdfmark end
 -2 4865 a -2
4875 a
SDict begin H.S end
 -2 4875 a -2 4875 a
SDict begin 13 H.A end
 -2 4875 a -2 4875 a
SDict begin [/View [/XYZ H.V]/Dest (0:3748) cvn /DEST pdfmark end
 -2 4875
a Black 396 5017 a Fe(\225)p Black 479 5017 a
SDict begin H.S end
 479 5017
a 479 5017 a
SDict begin 13 H.A end
 479 5017 a 479 5017 a
SDict begin [/View [/XYZ H.V]/Dest (0:3749) cvn /DEST pdfmark end
 479 5017 a Fj(It)i(completely)d
(eliminates)i(an)o(y)g(risk)g(of)g(memory)e(e)o(xhaustion.)g(T)-7
b(o)20 b(pro)o(v)o(e)f(that)h(we)g(set)h(the)g(high-w)o(ater)d(mark)h
(to)i(1)479 5125 y(in)g(both)e(sender)g(and)h(recei)n(v)o(er)-5
b(.)-2 5126 y
SDict begin H.S end
 -2 5126 a -2 5126 a
SDict begin 13 H.A end
 -2 5126 a -2 5126 a
SDict begin [/View [/XYZ H.V]/Dest (0:3750) cvn /DEST pdfmark end

-2 5126 a Black 3759 5569 a Fi(281)p Black eop end
%%Page: 282 296
TeXDict begin 282 295 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.282) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3751) cvn /DEST pdfmark end
 479 72 a Fj(It)i(lets)g(the)f(client)g
(choose)g(the)g(chunk)e(size,)j(which)f(is)h(useful)e(because)h(if)g
(there')-5 b(s)21 b(an)o(y)e(tuning)g(of)h(the)g(chunk)f(size)479
180 y(to)i(be)f(done,)f(for)g(netw)o(ork)g(conditions,)g(for)g(\002le)i
(types,)f(or)g(to)g(reduce)f(memory)g(consumption)e(further)m(,)h(it')
-5 b(s)22 b(the)479 288 y(client)f(that)f(should)f(be)h(doing)f(this.)
-2 306 y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2 306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:3752) cvn /DEST pdfmark end
 -2 306 a
Black 396 438 a Fe(\225)p Black 479 438 a
SDict begin H.S end
 479 438 a 479
438 a
SDict begin 13 H.A end
 479 438 a 479 438 a
SDict begin [/View [/XYZ H.V]/Dest (0:3753) cvn /DEST pdfmark end
 479 438 a Fj(It)i(gi)n(v)o(es)e(us)i(fully)f
(restartable)f(\002le)i(transfers.)-2 456 y
SDict begin H.S end
 -2 456 a
-2 456 a
SDict begin 13 H.A end
 -2 456 a -2 456 a
SDict begin [/View [/XYZ H.V]/Dest (0:3754) cvn /DEST pdfmark end
 -2 456 a Black 396 587 a Fe(\225)p
Black 479 587 a
SDict begin H.S end
 479 587 a 479 587 a
SDict begin 13 H.A end
 479 587 a 479 587
a
SDict begin [/View [/XYZ H.V]/Dest (0:3755) cvn /DEST pdfmark end
 479 587 a Fj(It)g(allo)n(ws)f(the)g(client)h(to)f(cancel)g(the)g
(\002le)h(transfer)e(at)i(an)o(y)e(point)h(in)g(time.)-2
771 y
SDict begin H.S end
 -2 771 a -2 771 a
SDict begin 13 H.A end
 -2 771 a -2 771 a
SDict begin [/View [/XYZ H.V]/Dest (0:3756) cvn /DEST pdfmark end
 -2 771 a 396
861 a Fj(If)g(we)g(just)h(didn')o(t)d(ha)n(v)o(e)i(to)g(do)f(a)h
(request)g(for)f(each)h(chunk,)e(it')l(d)h(be)h(a)h(usable)e(protocol.)
f(What)j(we)f(need)f(is)i(a)f(w)o(ay)g(for)396 969 y(the)g(serv)o(er)g
(to)g(send)g(multiple)g(chunks,)e(without)i(w)o(aiting)g(for)f(the)i
(client)f(to)g(request)g(or)g(ackno)n(wledge)d(each)j(one.)396
1077 y(What)h(are)f(the)g(options?)-2 1095 y
SDict begin H.S end
 -2 1095
a -2 1095 a
SDict begin 13 H.A end
 -2 1095 a -2 1095 a
SDict begin [/View [/XYZ H.V]/Dest (0:3757) cvn /DEST pdfmark end
 -2 1095 a -2 1105 a
SDict begin H.S end
 -2
1105 a -2 1105 a
SDict begin 13 H.A end
 -2 1105 a -2 1105 a
SDict begin [/View [/XYZ H.V]/Dest (0:3758) cvn /DEST pdfmark end
 -2 1105 a Black
396 1247 a Fe(\225)p Black 479 1247 a
SDict begin H.S end
 479 1247 a 479
1247 a
SDict begin 13 H.A end
 479 1247 a 479 1247 a
SDict begin [/View [/XYZ H.V]/Dest (0:3759) cvn /DEST pdfmark end
 479 1247 a Fj(The)g(serv)o(er)f(could)h
(send)g(10)f(chunks)g(at)i(once,)e(then)h(w)o(ait)h(for)e(a)i(single)f
(ackno)n(wledgment.)d(That')-5 b(s)20 b(e)o(xactly)f(lik)o(e)479
1355 y(multiplying)g(the)h(chunk)e(size)j(by)f(10,)g(so)g(pointless.)g
(And)g(yes,)g(it')-5 b(s)21 b(just)g(as)g(pointless)f(for)f(all)i(v)n
(alues)f(of)g(10.)-2 1373 y
SDict begin H.S end
 -2 1373 a -2 1373 a
SDict begin 13 H.A end
 -2 1373
a -2 1373 a
SDict begin [/View [/XYZ H.V]/Dest (0:3760) cvn /DEST pdfmark end
 -2 1373 a Black 396 1505 a Fe(\225)p Black
479 1505 a
SDict begin H.S end
 479 1505 a 479 1505 a
SDict begin 13 H.A end
 479 1505 a 479 1505
a
SDict begin [/View [/XYZ H.V]/Dest (0:3761) cvn /DEST pdfmark end
 479 1505 a Fj(The)g(serv)o(er)f(could)h(send)g(chunks)f(without)g(an)
o(y)g(chatter)h(from)f(the)h(client)h(b)n(ut)f(with)g(a)h(slight)f
(delay)g(between)f(each)479 1613 y(send,)h(so)h(that)f(it)h(w)o(ould)e
(send)h(chunks)f(only)g(as)i(f)o(ast)g(as)g(the)f(netw)o(ork)f(could)h
(handle)f(them.)g(This)i(w)o(ould)e(require)479 1720
y(the)h(serv)o(er)g(to)g(kno)n(w)f(what')-5 b(s)21 b(happening)c(at)k
(the)f(netw)o(ork)f(layer)m(,)h(which)f(sounds)h(lik)o(e)g(hard)f(w)o
(ork.)h(It)g(also)h(breaks)479 1828 y(layering)d(horribly)-5
b(.)17 b(And)i(what)g(happens)g(if)g(the)h(netw)o(ork)e(is)i(really)f
(f)o(ast)h(b)n(ut)g(the)f(client)h(itself)g(is)g(slo)n(w?)g(Where)f
(are)479 1936 y(chunks)g(queued)g(then?)-2 1954 y
SDict begin H.S end
 -2
1954 a -2 1954 a
SDict begin 13 H.A end
 -2 1954 a -2 1954 a
SDict begin [/View [/XYZ H.V]/Dest (0:3762) cvn /DEST pdfmark end
 -2 1954 a Black
396 2086 a Fe(\225)p Black 479 2086 a
SDict begin H.S end
 479 2086 a 479
2086 a
SDict begin 13 H.A end
 479 2086 a 479 2086 a
SDict begin [/View [/XYZ H.V]/Dest (0:3763) cvn /DEST pdfmark end
 479 2086 a Fj(The)h(serv)o(er)f(could)h
(try)g(to)g(sp)o(y)g(on)g(the)g(sending)f(queue,)g(i.e.)h(see)h(ho)n(w)
f(full)g(it)h(is,)g(and)e(send)h(only)f(when)h(the)g(queue)479
2194 y(isn')o(t)g(full.)g(W)-7 b(ell,)21 b(\330MQ)g(doesn')o(t)d(allo)n
(w)j(that)f(because)f(it)i(doesn')o(t)e(w)o(ork,)g(for)h(the)g(same)g
(reason)g(as)h(throttling)479 2302 y(doesn')o(t)e(w)o(ork.)g(The)h
(serv)o(er)f(and)h(netw)o(ork)f(may)h(be)g(more)f(than)h(f)o(ast)h
(enough,)d(b)n(ut)i(the)g(client)g(may)g(be)g(a)h(slo)n(w)479
2410 y(little)g(de)n(vice.)-2 2411 y
SDict begin H.S end
 -2 2411 a -2 2411
a
SDict begin 13 H.A end
 -2 2411 a -2 2411 a
SDict begin [/View [/XYZ H.V]/Dest (0:3764) cvn /DEST pdfmark end
 -2 2411 a Black 396 2559 a Fe(\225)p
Black 479 2559 a
SDict begin H.S end
 479 2559 a 479 2559 a
SDict begin 13 H.A end
 479 2559 a 479
2559 a
SDict begin [/View [/XYZ H.V]/Dest (0:3765) cvn /DEST pdfmark end
 479 2559 a Fj(W)-7 b(e)22 b(could)d(modify)f(libzmq)i(to)g(tak)o
(e)g(some)g(other)g(action)f(on)h(reaching)f(HWM.)h(Perhaps)g(it)h
(could)e(block?)g(That)479 2667 y(w)o(ould)h(mean)f(that)i(a)f(single)g
(slo)n(w)h(client)f(w)o(ould)g(block)f(the)h(whole)g(serv)o(er)m(,)e
(so)j(no)f(thank)f(you.)g(Maybe)g(it)i(could)479 2775
y(return)e(an)h(error)f(to)i(the)f(caller?)g(Then)f(the)i(serv)o(er)e
(could)g(do)h(something)f(smart)h(lik)o(e...)g(well,)g(there)g(isn')o
(t)g(really)479 2883 y(an)o(ything)e(it)j(could)f(do)f(that')-5
b(s)21 b(an)o(y)e(better)h(than)g(dropping)d(the)k(message.)-2
3067 y
SDict begin H.S end
 -2 3067 a -2 3067 a
SDict begin 13 H.A end
 -2 3067 a -2 3067 a
SDict begin [/View [/XYZ H.V]/Dest (0:3766) cvn /DEST pdfmark end
 -2 3067
a 396 3157 a Fj(Apart)f(from)f(being)g(comple)o(x)g(and)h(v)n(ariously)
e(unpleasant,)h(none)g(of)h(these)g(options)f(w)o(ould)h(e)n(v)o(en)f
(w)o(ork.)g(What)i(we)396 3265 y(need)f(is)h(a)g(w)o(ay)f(for)f(the)i
(client)f(to)g(tell)h(the)f(serv)o(er)m(,)f(asynchronously)e(and)i(in)i
(the)f(background,)c(that)21 b(it')-5 b(s)21 b(ready)e(for)396
3373 y(more.)g(Some)h(kind)g(of)g(asynchronous)d(\003o)n(w)j(control.)f
(If)h(we)g(do)g(this)h(right,)e(data)h(should)g(\003o)n(w)g(without)f
(interruption)396 3481 y(from)g(the)i(serv)o(er)e(to)h(the)h(client,)e
(b)n(ut)i(only)e(as)i(long)e(as)i(the)f(client)h(is)g(reading)e(it.)h
(Let')-5 b(s)21 b(re)n(vie)n(w)f(our)f(three)h(protocols.)396
3588 y(This)h(w)o(as)g(the)f(\002rst)h(one:)-2 3672 y
SDict begin H.S end

-2 3672 a -2 3672 a
SDict begin 11.7 H.A end
 -2 3672 a -2 3672 a
SDict begin [/View [/XYZ H.V]/Dest (0:3767) cvn /DEST pdfmark end
 -2 3672 a 396
3769 a Fg(C:)45 b(fetch)396 3866 y(S:)g(chunk)f(1)396
3963 y(S:)h(chunk)f(2)396 4060 y(S:)h(chunk)f(3)396 4157
y(....)-2 4324 y
SDict begin H.S end
 -2 4324 a -2 4324 a
SDict begin 13 H.A end
 -2 4324 a -2 4324
a
SDict begin [/View [/XYZ H.V]/Dest (0:3768) cvn /DEST pdfmark end
 -2 4324 a 396 4431 a Fj(And)20 b(the)g(second)f(introduced)f(a)j
(request)e(for)h(each)g(chunk:)-2 4532 y
SDict begin H.S end
 -2 4532 a -2
4532 a
SDict begin 11.7 H.A end
 -2 4532 a -2 4532 a
SDict begin [/View [/XYZ H.V]/Dest (0:3769) cvn /DEST pdfmark end
 -2 4532 a 396 4611 a Fg(C:)45
b(fetch)f(chunk)g(1)396 4708 y(S:)h(send)f(chunk)g(1)396
4806 y(C:)h(fetch)f(chunk)g(2)396 4903 y(S:)h(send)f(chunk)g(2)396
5000 y(C:)h(fetch)f(chunk)g(3)396 5097 y(S:)h(send)f(chunk)g(3)p
Black 3759 5569 a Fi(282)p Black eop end
%%Page: 283 297
TeXDict begin 283 296 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.283) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fg(C:)45 b(fetch)f(chunk)g(4)396 170 y(....)-2
337 y
SDict begin H.S end
 -2 337 a -2 337 a
SDict begin 13 H.A end
 -2 337 a -2 337 a
SDict begin [/View [/XYZ H.V]/Dest (0:3770) cvn /DEST pdfmark end
 -2 337 a 396
444 a Fj(No)n(w)20 b(-)h(w)o(a)n(v)o(es)f(hands)g(mysteriously)e(-)j
(here')-5 b(s)20 b(a)g(changed)f(protocol)f(that)j(\002x)o(es)f(the)g
(performance)d(problem:)-2 545 y
SDict begin H.S end
 -2 545 a -2 545 a
SDict begin 11.7 H.A end
 -2
545 a -2 545 a
SDict begin [/View [/XYZ H.V]/Dest (0:3771) cvn /DEST pdfmark end
 -2 545 a 396 624 a Fg(C:)45 b(fetch)f(chunk)g(1)396
721 y(C:)h(fetch)f(chunk)g(2)396 818 y(C:)h(fetch)f(chunk)g(3)396
915 y(S:)h(send)f(chunk)g(1)396 1012 y(C:)h(fetch)f(chunk)g(4)396
1109 y(S:)h(send)f(chunk)g(2)396 1207 y(S:)h(send)f(chunk)g(3)396
1304 y(....)-2 1471 y
SDict begin H.S end
 -2 1471 a -2 1471 a
SDict begin 13 H.A end
 -2 1471 a -2
1471 a
SDict begin [/View [/XYZ H.V]/Dest (0:3772) cvn /DEST pdfmark end
 -2 1471 a 396 1578 a Fj(It)21 b(looks)e(suspiciously)h(similar)
-5 b(.)20 b(In)g(f)o(act)h(it')-5 b(s)21 b(identical)f(e)o(xcept)f
(that)h(we)h(send)f(multiple)f(requests)h(without)f(w)o(aiting)396
1686 y(for)h(a)g(reply)g(for)f(each)h(one.)g(This)g(is)h(a)g(technique)
d(called)i("pipelining")f(and)g(it)i(w)o(orks)f(because)f(our)h(DEALER)
g(and)396 1794 y(R)m(OUTER)h(sock)o(ets)f(are)g(fully)g(asynchronous.)
-2 1978 y
SDict begin H.S end
 -2 1978 a -2 1978 a
SDict begin 13 H.A end
 -2 1978 a -2 1978 a
SDict begin [/View [/XYZ H.V]/Dest (0:3773) cvn /DEST pdfmark end
 -2
1978 a 396 2067 a Fj(Here')-5 b(s)21 b(the)f(third)f(model)h(of)g(our)f
(\002le)i(transfer)e(test-bench,)g(with)h(pipelining.)f(The)g(client)i
(sends)f(a)h(number)d(of)396 2175 y(requests)i(ahead)f(\(the)h
("credit"\))f(and)h(then)g(each)g(time)g(it)h(processes)f(an)g
(incoming)e(chunk,)h(it)i(sends)f(one)g(more)396 2283
y(credit.)g(The)g(serv)o(er)f(will)i(ne)n(v)o(er)e(send)h(more)f
(chunks)g(than)h(the)g(client)g(has)h(ask)o(ed)f(for:)-2
2284 y
SDict begin H.S end
 -2 2284 a -2 2284 a
SDict begin 13 H.A end
 -2 2284 a -2 2284 a
SDict begin [/View [/XYZ H.V]/Dest (0:fileio3-php) cvn /DEST pdfmark
end
 -2 2284
a 396 2485 a Fk(Example)h(6-3.)e(File)h(transfer)g(test,)g(model)g(3)h
(\(\002leio3.php\))-2 2585 y
SDict begin H.S end
 -2 2585 a -2 2585 a
SDict begin 11.7 H.A end
 -2 2585
a -2 2585 a
SDict begin [/View [/XYZ H.V]/Dest (0:3776) cvn /DEST pdfmark end
 -2 2585 a 396 2665 a Fg(\(This)44 b(example)g(still)g
(needs)g(translation)f(into)h(PHP\))-2 2842 y
SDict begin H.S end
 -2 2842
a -2 2842 a
SDict begin 13 H.A end
 -2 2842 a -2 2842 a
SDict begin [/View [/XYZ H.V]/Dest (0:3777) cvn /DEST pdfmark end
 -2 2842 a 396 2939 a
Fj(What)21 b(we')l(v)o(e)e(achie)n(v)o(ed)g(here,)g(with)h(a)h(little)g
(magic,)e(is)i(to)g(tak)o(e)f(control)f(of)h(the)g(end-to-end)e
(pipeline)h(including)f(all)396 3047 y(netw)o(ork)h(b)n(uf)n(fers)g
(and)h(\330MQ)g(queues)g(at)g(sender)g(and)g(recei)n(v)o(er)m(,)e(and)h
(then)h(ensure)g(that)g(pipeline)f(is)i(al)o(w)o(ays)g(\002lled)396
3155 y(with)g(data)f(while)g(ne)n(v)o(er)f(gro)n(wing)f(be)o(yond)g(a)i
(prede\002ned)f(limit.)h(More)f(than)h(that,)g(the)g(client)g(decides)g
(e)o(xactly)f(when)396 3263 y(to)i(send)f("credit")f(to)h(the)h(sender)
-5 b(.)19 b(It)i(could)e(be)h(when)g(it)h(recei)n(v)o(es)e(a)i(chunk,)d
(or)i(when)g(it)g(has)h(fully)e(processed)h(a)396 3371
y(chunk.)f(And)g(this)i(happens)e(asynchronously)-5 b(,)16
b(with)21 b(no)e(signi\002cant)h(performance)d(cost.)-2
3555 y
SDict begin H.S end
 -2 3555 a -2 3555 a
SDict begin 13 H.A end
 -2 3555 a -2 3555 a
SDict begin [/View [/XYZ H.V]/Dest (0:3778) cvn /DEST pdfmark end
 -2 3555
a 396 3644 a Fj(In)j(the)g(third)g(model)f(I)i(chose)e(a)i(pipeline)e
(size)i(of)f(10)g(messages)g(\(each)g(message)g(is)h(a)f(chunk\).)f
(This)h(will)h(cost)f(a)396 3752 y(maximum)f(of)h(2.5MB)f(memory)g(per)
h(client.)g(So)g(with)g(1GB)h(of)f(memory)e(we)j(can)f(handle)f(at)i
(least)g(400)e(clients.)h(W)-7 b(e)396 3860 y(can)20
b(try)g(to)h(calculate)e(the)i(ideal)f(pipeline)f(size.)i(It)f(tak)o
(es)h(about)e(0.7)g(seconds)h(to)g(send)g(the)g(1GB)h(\002le,)g(which)e
(is)i(about)396 3968 y(160)f(microseconds)e(for)h(a)i(chunk.)d(A)j
(round)e(trip)h(is)h(300)e(microseconds,)f(so)j(the)f(pipeline)f(needs)
h(to)g(be)g(at)h(least)g(3-5)396 4076 y(to)g(k)o(eep)e(the)h(serv)o(er)
g(b)n(usy)-5 b(.)19 b(In)h(practice,)f(I)i(still)g(got)f(performance)d
(spik)o(es)k(with)f(a)h(pipeline)e(of)h(5,)g(probably)e(because)396
4184 y(the)i(credit)g(messages)h(sometimes)f(get)g(delayed)f(by)g
(outgoing)f(data.)i(So)h(at)f(10,)g(it)h(w)o(orks)f(consistently)-5
b(.)-2 4285 y
SDict begin H.S end
 -2 4285 a -2 4285 a
SDict begin 11.7 H.A end
 -2 4285 a -2 4285 a
SDict begin [/View [/XYZ H.V]/Dest (0:3779) cvn /DEST pdfmark end

-2 4285 a 396 4364 a Fg($)45 b(time)f(./fileio3)396 4461
y(4291)g(chunks)g(received,)g(1072741824)f(bytes)396
4656 y(real)179 b(0m0.777s)396 4753 y(user)g(0m0.096s)396
4850 y(sys)224 b(0m1.120s)-2 5028 y
SDict begin H.S end
 -2 5028 a -2 5028
a
SDict begin 13 H.A end
 -2 5028 a -2 5028 a
SDict begin [/View [/XYZ H.V]/Dest (0:3780) cvn /DEST pdfmark end
 -2 5028 a 396 5124 a Fj(Do)20 b(measure)g
(rigorously)-5 b(.)17 b(Y)-9 b(our)20 b(calculations)f(may)h(be)g(good)
e(b)n(ut)j(the)f(real)g(w)o(orld)g(tends)g(to)g(ha)n(v)o(e)g(its)h(o)n
(wn)f(opinions.)p Black 3759 5569 a Fi(283)p Black eop
end
%%Page: 284 298
TeXDict begin 284 297 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.284) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3804) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3781) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(What)i(we')l(v)o(e)e(made)h(is)h(clearly)e(not)h(yet)
g(a)h(real)f(\002le)h(transfer)e(protocol,)g(b)n(ut)h(it)h(pro)o(v)o
(es)d(the)j(pattern)e(and)h(I)g(think)f(it)i(is)396 180
y(the)f(simplest)h(plausible)f(design.)f(F)o(or)h(a)g(real)g(w)o
(orking)f(protocol)g(we')l(d)g(w)o(ant)h(to)h(add)e(some)h(or)g(all)h
(of:)-2 198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:3782) cvn /DEST pdfmark end
 -2
198 a -2 208 a
SDict begin H.S end
 -2 208 a -2 208 a
SDict begin 13 H.A end
 -2 208 a -2 208 a
SDict begin [/View [/XYZ H.V]/Dest (0:3783) cvn /DEST pdfmark end
 -2
208 a Black 396 351 a Fe(\225)p Black 479 351 a
SDict begin H.S end
 479 351
a 479 351 a
SDict begin 13 H.A end
 479 351 a 479 351 a
SDict begin [/View [/XYZ H.V]/Dest (0:3784) cvn /DEST pdfmark end
 479 351 a Fj(Authentication)e(and)g
(access)i(controls,)e(e)n(v)o(en)g(without)h(encryption:)e(the)i(point)
f(isn')o(t)h(to)g(protect)g(sensiti)n(v)o(e)g(data)479
459 y(b)n(ut)g(to)h(catch)f(errors)f(lik)o(e)i(sending)e(test)i(data)f
(to)g(production)e(serv)o(ers.)-2 477 y
SDict begin H.S end
 -2 477 a -2 477
a
SDict begin 13 H.A end
 -2 477 a -2 477 a
SDict begin [/View [/XYZ H.V]/Dest (0:3785) cvn /DEST pdfmark end
 -2 477 a Black 396 608 a Fe(\225)p
Black 479 608 a
SDict begin H.S end
 479 608 a 479 608 a
SDict begin 13 H.A end
 479 608 a 479 608
a
SDict begin [/View [/XYZ H.V]/Dest (0:3786) cvn /DEST pdfmark end
 479 608 a Fj(A)j(Cheap-style)e(request)h(including)e(\002le)j(path,)f
(optional)e(compression,)h(and)g(other)h(stuf)n(f)g(we')l(v)o(e)f
(learned)g(is)479 716 y(useful)h(from)f(HTTP)h(\(such)g(as)h
(If-Modi\002ed-Since\).)-2 731 y
SDict begin H.S end
 -2 731 a -2 731 a
SDict begin 13 H.A end
 -2
731 a -2 731 a
SDict begin [/View [/XYZ H.V]/Dest (0:3787) cvn /DEST pdfmark end
 -2 731 a Black 396 865 a Fe(\225)p Black
479 865 a
SDict begin H.S end
 479 865 a 479 865 a
SDict begin 13 H.A end
 479 865 a 479 865 a
SDict begin [/View [/XYZ H.V]/Dest (0:3788) cvn /DEST pdfmark end
 479
865 a Fj(A)g(Cheap-style)e(response,)g(at)i(least)g(for)f(the)g
(\002rst)h(chunk,)d(that)i(pro)o(vides)f(meta)h(data)g(such)g(as)h
(\002le)g(size)g(\(so)f(the)479 973 y(client)h(can)f(pre-allocate)e
(and)i(a)n(v)n(oid)g(unpleasant)e(disk-full)i(situations\).)-2
991 y
SDict begin H.S end
 -2 991 a -2 991 a
SDict begin 13 H.A end
 -2 991 a -2 991 a
SDict begin [/View [/XYZ H.V]/Dest (0:3789) cvn /DEST pdfmark end
 -2 991 a Black
396 1123 a Fe(\225)p Black 479 1123 a
SDict begin H.S end
 479 1123 a 479
1123 a
SDict begin 13 H.A end
 479 1123 a 479 1123 a
SDict begin [/View [/XYZ H.V]/Dest (0:3790) cvn /DEST pdfmark end
 479 1123 a Fj(The)g(ability)g(to)g(fetch)g
(a)h(set)g(of)f(\002les)h(in)f(one)g(go,)f(otherwise)h(the)g(protocol)f
(becomes)g(inef)n(\002cient)g(for)h(lar)o(ge)f(sets)i(of)479
1231 y(small)g(\002les.)-2 1232 y
SDict begin H.S end
 -2 1232 a -2 1232 a
SDict begin 13 H.A end

-2 1232 a -2 1232 a
SDict begin [/View [/XYZ H.V]/Dest (0:3791) cvn /DEST pdfmark end
 -2 1232 a Black 396 1380 a Fe(\225)p
Black 479 1380 a
SDict begin H.S end
 479 1380 a 479 1380 a
SDict begin 13 H.A end
 479 1380 a 479
1380 a
SDict begin [/View [/XYZ H.V]/Dest (0:3792) cvn /DEST pdfmark end
 479 1380 a Fj(Con\002rmation)e(from)g(the)h(client)g(when)g(it')
-5 b(s)21 b(fully)f(recei)n(v)o(ed)f(a)h(\002le,)h(to)f(reco)o(v)o(er)e
(from)h(chunks)g(that)i(might)e(be)h(lost)479 1488 y(of)g(the)g(client)
h(disconnects)e(une)o(xpectedly)-5 b(.)-2 1672 y
SDict begin H.S end
 -2 1672
a -2 1672 a
SDict begin 13 H.A end
 -2 1672 a -2 1672 a
SDict begin [/View [/XYZ H.V]/Dest (0:3793) cvn /DEST pdfmark end
 -2 1672 a 396 1762 a
Fj(So)21 b(f)o(ar)m(,)e(our)h(semantic)g(has)g(been)f("fetch";)h(that)g
(is,)h(the)f(recipient)g(kno)n(ws)f(\(someho)n(w\),)f(that)i(the)o(y)g
(need)f(a)i(speci\002c)396 1870 y(\002le,)g(so)f(the)o(y)g(ask)g(for)g
(it.)h(The)e(kno)n(wledge)f(of)i(which)g(\002les)h(e)o(xist,)f(and)g
(where)f(the)o(y)h(are)g(is)h(then)f(passed)g(out-of-band)396
1978 y(\(e.g.)g(in)g(HTTP)-9 b(,)20 b(by)g(links)g(in)g(the)g(HTML)g
(page\).)-2 2162 y
SDict begin H.S end
 -2 2162 a -2 2162 a
SDict begin 13 H.A end
 -2 2162 a -2 2162
a
SDict begin [/View [/XYZ H.V]/Dest (0:3794) cvn /DEST pdfmark end
 -2 2162 a 396 2252 a Fj(Ho)n(w)g(about)g(a)g("push")g(semantic?)f
(There)h(are)g(tw)o(o)g(plausible)g(use-cases)g(for)g(this.)g(First,)h
(if)f(we)h(adopt)e(a)i(centralized)396 2360 y(architecture)e(with)h
(\002les)h(on)f(a)h(main)f("serv)o(er")f(\(not)g(something)g(I'm)h(adv)
n(ocating,)e(b)n(ut)i(people)f(do)h(sometimes)g(lik)o(e)396
2468 y(this\),)g(then)g(it')-5 b(s)21 b(v)o(ery)e(useful)h(to)g(allo)n
(w)h(clients)f(to)g(upload)f(\002les)i(to)g(the)f(serv)o(er)-5
b(.)19 b(Second,)g(it)i(lets)g(do)f(a)h(kind)e(of)396
2576 y(pub-sub)g(for)g(\002les,)i(where)f(the)g(client)g(asks)h(for)e
(all)i(ne)n(w)f(\002les)h(of)f(some)g(type;)g(as)h(the)f(serv)o(er)f
(gets)i(these,)f(it)h(forw)o(ards)396 2684 y(them)f(to)g(the)h(client.)
-2 2850 y
SDict begin H.S end
 -2 2850 a -2 2850 a
SDict begin 13 H.A end
 -2 2850 a -2 2850 a
SDict begin [/View [/XYZ H.V]/Dest (0:3795) cvn /DEST pdfmark end
 -2
2850 a 396 2957 a Fj(A)g(fetch)f(semantic)g(is)h(synchronous,)c(while)j
(a)h(push)e(semantic)h(is)h(asynchronous.)c(Asynchronous)h(is)j(less)g
(chatty)-5 b(,)19 b(so)396 3065 y(f)o(aster)-5 b(.)21
b(Also,)f(you)f(can)h(do)g(cute)g(things)g(lik)o(e)g("subscribe)g(to)g
(this)h(path")e(so)i(creating)e(a)i(publish-subscribe)c(\002le)396
3173 y(transfer)j(architecture.)e(That)i(is)h(so)g(ob)o(viously)d(a)o
(wesome)h(that)h(I)h(shouldn')o(t)d(need)h(to)h(e)o(xplain)f(what)i
(problem)d(it)396 3281 y(solv)o(es.)-2 3448 y
SDict begin H.S end
 -2 3448
a -2 3448 a
SDict begin 13 H.A end
 -2 3448 a -2 3448 a
SDict begin [/View [/XYZ H.V]/Dest (0:3796) cvn /DEST pdfmark end
 -2 3448 a 396 3555 a
Fj(Still,)j(here)e(is)i(the)f(problem)e(with)h(the)h(fetch)g(semantic:)
f(that)h(out-of-band)c(route)j(to)h(tell)h(clients)f(what)f(\002les)i
(e)o(xist.)f(No)396 3663 y(matter)g(ho)n(w)g(you)f(do)h(this,)g(it)h
(ends)f(up)g(comple)o(x.)e(Either)i(clients)g(ha)n(v)o(e)g(to)g(poll,)g
(or)g(you)f(need)h(a)g(separate)g(pub-sub)396 3771 y(channel)f(to)i(k)o
(eep)e(clients)i(up)f(to)g(date,)g(or)g(you)f(need)g(user)h
(interaction.)-2 3955 y
SDict begin H.S end
 -2 3955 a -2 3955 a
SDict begin 13 H.A end
 -2 3955 a
-2 3955 a
SDict begin [/View [/XYZ H.V]/Dest (0:3797) cvn /DEST pdfmark end
 -2 3955 a 396 4045 a Fj(Thinking)e(this)j(through)d(a)j
(little)g(more,)e(though,)f(we)j(can)f(see)g(that)h(fetch)e(is)j(just)e
(a)h(special)f(case)h(of)396 4153 y(publish-subscribe.)c(So)k(we)f(can)
g(get)h(the)f(best)g(of)g(both)g(w)o(orlds.)f(Here)h(is)i(the)e
(general)f(design:)-2 4171 y
SDict begin H.S end
 -2 4171 a -2 4171 a
SDict begin 13 H.A end
 -2 4171
a -2 4171 a
SDict begin [/View [/XYZ H.V]/Dest (0:3798) cvn /DEST pdfmark end
 -2 4171 a -2 4181 a
SDict begin H.S end
 -2 4181 a -2 4181 a
SDict begin 13 H.A end
 -2
4181 a -2 4181 a
SDict begin [/View [/XYZ H.V]/Dest (0:3799) cvn /DEST pdfmark end
 -2 4181 a Black 396 4323 a Fe(\225)p
Black 479 4323 a
SDict begin H.S end
 479 4323 a 479 4323 a
SDict begin 13 H.A end
 479 4323 a 479
4323 a
SDict begin [/View [/XYZ H.V]/Dest (0:3800) cvn /DEST pdfmark end
 479 4323 a Fj(Fetch)i(this)f(path)-2 4341 y
SDict begin H.S end
 -2
4341 a -2 4341 a
SDict begin 13 H.A end
 -2 4341 a -2 4341 a
SDict begin [/View [/XYZ H.V]/Dest (0:3801) cvn /DEST pdfmark end
 -2 4341 a Black
396 4473 a Fe(\225)p Black 479 4473 a
SDict begin H.S end
 479 4473 a 479
4473 a
SDict begin 13 H.A end
 479 4473 a 479 4473 a
SDict begin [/View [/XYZ H.V]/Dest (0:3802) cvn /DEST pdfmark end
 479 4473 a Fj(Here)g(is)h(credit)f
(\(repeat\))-2 4657 y
SDict begin H.S end
 -2 4657 a -2 4657 a
SDict begin 13 H.A end
 -2 4657 a -2
4657 a
SDict begin [/View [/XYZ H.V]/Dest (0:3803) cvn /DEST pdfmark end
 -2 4657 a 396 4747 a Fj(T)-7 b(o)20 b(mak)o(e)f(this)h(w)o(ork)f
(\(and)g(we)h(will,)g(my)f(dear)g(readers\),)f(we)i(need)f(to)h(be)f(a)
h(little)h(more)d(e)o(xplicit)h(about)g(ho)n(w)g(we)h(send)396
4855 y(credit)g(to)g(the)h(serv)o(er)-5 b(.)19 b(The)h(cute)g(trick)g
(of)g(treating)f(a)i(pipelined)e("fetch)g(chunk")g(request)g(as)i
(credit)f(w)o(on')o(t)f(\003y)i(since)396 4962 y(the)f(client)h(doesn')
o(t)d(kno)n(w)i(an)o(y)f(longer)g(what)h(\002les)h(actually)f(e)o
(xist,)g(ho)n(w)f(lar)o(ge)h(the)o(y)f(are,)h(an)o(ything.)e(If)i(the)g
(client)p Black 3759 5569 a Fi(284)p Black eop end
%%Page: 285 299
TeXDict begin 285 298 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.285) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3823) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(says,)i("I'm)e(good)g(for)h(250,000)d(bytes)j(of)g
(data",)g(this)h(should)e(w)o(ork)g(equally)g(for)h(one)g(\002le)g(of)g
(250K)g(bytes,)f(or)h(100)396 180 y(\002les)h(of)f(2,500)f(bytes.)396
454 y(And)h(this)h(gi)n(v)o(es)e(us)i("credit-based)d(\003o)n(w)j
(control",)d(which)i(ef)n(fecti)n(v)o(ely)e(remo)o(v)o(es)h(the)h(need)
f(for)h(HWMs,)h(and)f(an)o(y)396 562 y(risk)h(of)e(memory)g(o)o(v)o
(er\003o)n(w)-5 b(.)-2 591 y
SDict begin H.S end
 -2 591 a -2 591 a
SDict begin 13 H.A end
 -2 591
a -2 591 a
SDict begin [/View [/XYZ H.V]/Dest (0:3805) cvn /DEST pdfmark end
 -2 591 a 359 x Fh(6.9.)39 b(Hear)s(tbeating)1160
950 y
SDict begin H.S end
 1160 950 a 1160 950 a
SDict begin 22.464 H.A end
 1160 950 a 1160 950 a
SDict begin [/View [/XYZ H.V]/Dest (11.68.1) cvn /DEST pdfmark end
 1160
950 a -2 1148 a
SDict begin H.S end
 -2 1148 a -2 1148 a
SDict begin 13 H.A end
 -2 1148 a -2 1148
a
SDict begin [/View [/XYZ H.V]/Dest (0:3807) cvn /DEST pdfmark end
 -2 1148 a 396 1224 a Fj(Just)21 b(as)g(a)g(real)f(protocol)e(needs)i
(to)h(solv)o(e)e(the)i(problem)d(of)i(\003o)n(w)g(control,)f(it)i(also)
f(needs)g(to)g(solv)o(e)g(the)g(problem)f(of)396 1332
y(kno)n(wing)g(whether)g(a)h(peer)g(is)h(ali)n(v)o(e)f(or)g(dead.)f
(This)h(is)i(not)d(an)i(issue)f(speci\002c)h(to)f(\330MQ.)g(TCP)h(has)g
(a)f(long)g(timeout)396 1440 y(\(30)g(minutes)f(or)h(so\),)g(that)h
(means)e(that)i(it)g(can)f(be)g(impossible)f(to)i(kno)n(w)e(whether)g
(a)i(peer)e(has)i(died,)e(been)396 1548 y(disconnected,)f(or)i(gone)f
(on)h(a)h(week)o(end)e(to)h(Prague)f(with)i(a)f(case)h(of)f(v)n(odka,)f
(a)h(redhead,)e(and)i(a)h(lar)o(ge)e(e)o(xpense)396 1655
y(account.)-2 1822 y
SDict begin H.S end
 -2 1822 a -2 1822 a
SDict begin 13 H.A end
 -2 1822 a -2
1822 a
SDict begin [/View [/XYZ H.V]/Dest (0:3808) cvn /DEST pdfmark end
 -2 1822 a 396 1929 a Fj(Heartbeating)g(is)i(not)f(easy)g(to)g
(get)h(right,)e(and)h(as)h(with)f(\003o)n(w)g(control)f(it)i(can)f(mak)
o(e)g(the)g(dif)n(ference)e(between)i(a)396 2037 y(w)o(orking,)f(and)g
(f)o(ailing)h(architecture.)e(So)j(using)e(our)h(standard)f(approach,)f
(let')-5 b(s)21 b(start)g(with)f(the)g(simplest)h(possible)396
2145 y(heartbeat)e(design,)h(and)f(de)n(v)o(elop)f(better)i(and)g
(better)g(designs)g(until)g(we)g(ha)n(v)o(e)g(one)f(with)i(no)e
(visible)i(f)o(aults.)-2 2163 y
SDict begin H.S end
 -2 2163 a -2 2163 a
SDict begin 13 H.A end
 -2
2163 a -2 2163 a
SDict begin [/View [/XYZ H.V]/Dest (0:3809) cvn /DEST pdfmark end
 -2 2163 a 396 2473 a Fd(6.9.1.)36 b(Shrug)o(ging)c(It)
i(Off)1638 2473 y
SDict begin H.S end
 1638 2473 a 1638 2473 a
SDict begin 18.72 H.A end
 1638 2473 a
1638 2473 a
SDict begin [/View [/XYZ H.V]/Dest (11.68.58.2) cvn /DEST pdfmark end
 1638 2473 a -2 2666 a
SDict begin H.S end
 -2 2666 a -2 2666 a
SDict begin 13 H.A end

-2 2666 a -2 2666 a
SDict begin [/View [/XYZ H.V]/Dest (0:3811) cvn /DEST pdfmark end
 -2 2666 a 396 2747 a Fj(A)21 b(decent)e(\002rst)i
(iteration)f(is)h(to)f(do)g(no)g(heartbeating)e(at)j(all)f(and)g(see)h
(what)f(actually)g(happens.)e(Man)o(y)h(if)i(not)f(most)396
2855 y(\330MQ)h(applications)e(do)g(this.)i(\330MQ)f(encourages)f(this)
h(by)g(hiding)f(peers)h(in)g(man)o(y)f(cases.)i(What)g(problems)d(does)
396 2963 y(this)j(approach)d(cause?)-2 2981 y
SDict begin H.S end
 -2 2981
a -2 2981 a
SDict begin 13 H.A end
 -2 2981 a -2 2981 a
SDict begin [/View [/XYZ H.V]/Dest (0:3812) cvn /DEST pdfmark end
 -2 2981 a -2 2991 a
SDict begin H.S end
 -2
2991 a -2 2991 a
SDict begin 13 H.A end
 -2 2991 a -2 2991 a
SDict begin [/View [/XYZ H.V]/Dest (0:3813) cvn /DEST pdfmark end
 -2 2991 a Black
396 3133 a Fe(\225)p Black 479 3133 a
SDict begin H.S end
 479 3133 a 479
3133 a
SDict begin 13 H.A end
 479 3133 a 479 3133 a
SDict begin [/View [/XYZ H.V]/Dest (0:3814) cvn /DEST pdfmark end
 479 3133 a Fj(When)i(we)g(use)g(a)h(R)m
(OUTER)f(sock)o(et)g(in)g(an)g(application)e(that)i(tracks)g(peers,)f
(as)i(peers)f(disconnect)e(and)i(reconnect,)479 3241
y(the)g(application)f(will)i(leak)f(memory)f(and)g(get)i(slo)n(wer)f
(and)f(slo)n(wer)-5 b(.)-2 3259 y
SDict begin H.S end
 -2 3259 a -2 3259 a
SDict begin 13 H.A end

-2 3259 a -2 3259 a
SDict begin [/View [/XYZ H.V]/Dest (0:3815) cvn /DEST pdfmark end
 -2 3259 a Black 396 3391 a Fe(\225)p
Black 479 3391 a
SDict begin H.S end
 479 3391 a 479 3391 a
SDict begin 13 H.A end
 479 3391 a 479
3391 a
SDict begin [/View [/XYZ H.V]/Dest (0:3816) cvn /DEST pdfmark end
 479 3391 a Fj(When)20 b(we)h(use)f(SUB)i(or)d(DEALER-based)g
(data)h(recipients,)g(we)g(can')o(t)f(tell)i(the)g(dif)n(ference)d
(between)h(good)479 3499 y(silence)i(\(there')-5 b(s)19
b(no)h(data\))g(and)f(bad)h(silence)g(\(the)g(other)g(end)f(died\).)g
(When)h(a)h(recipient)e(kno)n(ws)h(the)g(other)f(side)479
3607 y(died,)h(it)h(can)f(for)f(e)o(xample)g(switch)i(o)o(v)o(er)d(to)j
(a)f(backup)f(route.)-2 3625 y
SDict begin H.S end
 -2 3625 a -2 3625 a
SDict begin 13 H.A end
 -2
3625 a -2 3625 a
SDict begin [/View [/XYZ H.V]/Dest (0:3817) cvn /DEST pdfmark end
 -2 3625 a Black 396 3756 a Fe(\225)p
Black 479 3756 a
SDict begin H.S end
 479 3756 a 479 3756 a
SDict begin 13 H.A end
 479 3756 a 479
3756 a
SDict begin [/View [/XYZ H.V]/Dest (0:3818) cvn /DEST pdfmark end
 479 3756 a Fj(If)h(we)h(use)f(a)h(TCP)g(connection)d(that)i
(stays)h(silent)g(for)e(a)i(long)e(while,)h(it)h(will,)g(in)f(some)g
(netw)o(orks,)f(just)i(die.)479 3864 y(Sending)e(something)g
(\(technically)-5 b(,)18 b(a)j("k)o(eep-ali)n(v)o(e")d(more)h(than)h(a)
g(heartbeat\),)f(will)i(k)o(eep)e(the)i(netw)o(ork)e(ali)n(v)o(e.)-2
3924 y
SDict begin H.S end
 -2 3924 a -2 3924 a
SDict begin 13 H.A end
 -2 3924 a -2 3924 a
SDict begin [/View [/XYZ H.V]/Dest (0:3819) cvn /DEST pdfmark end
 -2 3924
a 396 4234 a Fd(6.9.2.)36 b(One-W)-5 b(a)n(y)34 b(Hear)r(tbeats)1891
4234 y
SDict begin H.S end
 1891 4234 a 1891 4234 a
SDict begin 18.72 H.A end
 1891 4234 a 1891 4234
a
SDict begin [/View [/XYZ H.V]/Dest (11.68.59.2) cvn /DEST pdfmark end
 1891 4234 a -2 4424 a
SDict begin H.S end
 -2 4424 a -2 4424 a
SDict begin 13 H.A end
 -2 4424 a
-2 4424 a
SDict begin [/View [/XYZ H.V]/Dest (0:3821) cvn /DEST pdfmark end
 -2 4424 a 396 4508 a Fj(So,)20 b(our)g(\002rst)h(solution)e
(is)i(to)g(sending)e(a)h("heartbeat")f(message)h(from)f(each)h(node)f
(to)i(its)g(peers,)e(e)n(v)o(ery)g(second)h(or)f(so.)396
4616 y(When)h(one)f(node)g(hears)g(nothing)f(from)h(another)m(,)f
(within)h(some)h(timeout)f(\(se)n(v)o(eral)g(seconds,)f(typically\),)h
(it)h(will)h(treat)396 4723 y(that)g(peer)e(as)i(dead.)e(Sounds)h
(good,)e(right?)i(Sadly)f(no.)h(This)g(w)o(orks)g(in)h(some)f(cases)g
(b)n(ut)h(has)f(nasty)g(edge)g(cases)h(in)396 4831 y(other)f(cases.)p
Black 3759 5569 a Fi(285)p Black eop end
%%Page: 286 300
TeXDict begin 286 299 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.286) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3822) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(F)o(or)h(PUB-SUB,)h(this)g(does)f(w)o(ork,)f(and)h
(it')-5 b(s)21 b(the)f(only)g(model)f(you)g(can)h(use.)g(SUB)i(sock)o
(ets)e(cannot)f(talk)h(back)g(to)396 180 y(PUB)h(sock)o(ets,)g(b)n(ut)f
(PUB)h(sock)o(ets)f(can)g(happily)f(send)h("I'm)g(ali)n(v)o(e")f
(messages)i(to)f(their)g(subscribers.)396 454 y(As)h(an)f
(optimization,)f(you)g(can)h(send)g(heartbeats)f(only)h(when)f(there)h
(is)h(no)f(real)g(data)g(to)g(send.)g(Furthermore,)e(you)396
562 y(can)i(send)g(heartbeats)g(progressi)n(v)o(ely)d(slo)n(wer)j(and)g
(slo)n(wer)m(,)f(if)i(netw)o(ork)e(acti)n(vity)h(is)h(an)f(issue)h
(\(e.g.)e(on)h(mobile)396 670 y(netw)o(orks)g(where)f(acti)n(vity)h
(drains)g(the)g(battery\).)e(As)j(long)f(as)h(the)f(recipient)f(can)h
(detect)g(a)h(f)o(ailure)e(\(sharp)h(stop)g(in)396 778
y(acti)n(vity\),)f(that')-5 b(s)21 b(\002ne.)-2 962 y
SDict begin H.S end

-2 962 a -2 962 a
SDict begin 13 H.A end
 -2 962 a -2 962 a
SDict begin [/View [/XYZ H.V]/Dest (0:3824) cvn /DEST pdfmark end
 -2 962 a 396 1052
a Fj(No)n(w)f(the)h(typical)e(problems)g(with)h(this)h(design:)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:3825) cvn /DEST pdfmark end
 -2 1070
a -2 1080 a
SDict begin H.S end
 -2 1080 a -2 1080 a
SDict begin 13 H.A end
 -2 1080 a -2 1080 a
SDict begin [/View [/XYZ H.V]/Dest (0:3826) cvn /DEST pdfmark end
 -2
1080 a Black 396 1222 a Fe(\225)p Black 479 1222 a
SDict begin H.S end
 479
1222 a 479 1222 a
SDict begin 13 H.A end
 479 1222 a 479 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:3827) cvn /DEST pdfmark end
 479 1222 a Fj(It)g(can)f(be)g
(inaccurate)f(when)g(we)i(send)f(lar)o(ge)f(amounts)g(of)h(data,)g
(since)g(heartbeats)g(will)h(be)f(delayed)f(behind)f(that)479
1330 y(data.)i(If)g(heartbeats)f(are)i(delayed,)d(you)i(can)g(get)g(f)o
(alse)g(timeouts)g(and)g(disconnections)e(due)i(to)g(netw)o(ork)479
1438 y(congestion.)f(Thus,)g(al)o(w)o(ays)i(treat)1506
1438 y
SDict begin H.S end
 1506 1438 a 1506 1438 a
SDict begin 13 H.A end
 1506 1438 a 1506 1438
a
SDict begin [/View [/XYZ H.V]/Dest (0:3828) cvn /DEST pdfmark end
 1506 1438 a Fi(any)f Fj(incoming)e(data)i(as)h(a)g(heartbeat,)d
(whether)i(or)g(not)f(the)i(sender)e(optimizes)479 1546
y(out)h(heartbeats.)-2 1547 y
SDict begin H.S end
 -2 1547 a -2 1547 a
SDict begin 13 H.A end
 -2
1547 a -2 1547 a
SDict begin [/View [/XYZ H.V]/Dest (0:3829) cvn /DEST pdfmark end
 -2 1547 a Black 396 1696 a Fe(\225)p
Black 479 1696 a
SDict begin H.S end
 479 1696 a 479 1696 a
SDict begin 13 H.A end
 479 1696 a 479
1696 a
SDict begin [/View [/XYZ H.V]/Dest (0:3830) cvn /DEST pdfmark end
 479 1696 a Fj(While)h(the)f(PUB-SUB)i(pattern)d(will)i(drop)e
(messages)h(for)g(disappeared)e(recipients,)h(PUSH)i(and)f(DEALER)479
1803 y(sock)o(ets)h(will)g(queue)e(them.)g(So,)h(if)h(you)e(send)h
(heartbeats)f(to)i(a)f(dead)g(peer)m(,)f(and)h(it)g(comes)g(back,)g
(it')o(ll)g(get)h(all)f(the)479 1911 y(heartbeats)g(you)f(sent.)h
(Which)g(can)g(be)g(thousands.)f(Whoa,)h(whoa!)-2 1929
y
SDict begin H.S end
 -2 1929 a -2 1929 a
SDict begin 13 H.A end
 -2 1929 a -2 1929 a
SDict begin [/View [/XYZ H.V]/Dest (0:3831) cvn /DEST pdfmark end
 -2 1929 a Black
396 2061 a Fe(\225)p Black 479 2061 a
SDict begin H.S end
 479 2061 a 479
2061 a
SDict begin 13 H.A end
 479 2061 a 479 2061 a
SDict begin [/View [/XYZ H.V]/Dest (0:3832) cvn /DEST pdfmark end
 479 2061 a Fj(This)h(design)e(assumes)i
(that)f(heartbeat)f(timeouts)h(are)g(the)g(same)g(across)h(the)f(whole)
f(netw)o(ork.)g(But)i(that)f(w)o(on')o(t)f(be)479 2169
y(accurate.)g(Some)h(peers)g(will)h(w)o(ant)f(v)o(ery)f(aggressi)n(v)o
(e)g(heart-beating,)f(to)i(detect)g(f)o(aults)h(rapidly)-5
b(.)18 b(And)i(some)g(will)479 2277 y(w)o(ant)h(v)o(ery)e(relax)o(ed)f
(heart-beating,)g(to)i(let)h(sleeping)f(netw)o(orks)f(lie,)h(and)g(sa)n
(v)o(e)g(po)n(wer)-5 b(.)-2 2336 y
SDict begin H.S end
 -2 2336 a -2 2336
a
SDict begin 13 H.A end
 -2 2336 a -2 2336 a
SDict begin [/View [/XYZ H.V]/Dest (0:3833) cvn /DEST pdfmark end
 -2 2336 a 396 2646 a Fd(6.9.3.)36
b(Ping-P)-5 b(ong)33 b(Hear)r(tbeats)1973 2646 y
SDict begin H.S end
 1973
2646 a 1973 2646 a
SDict begin 18.72 H.A end
 1973 2646 a 1973 2646 a
SDict begin [/View [/XYZ H.V]/Dest (11.68.60.2) cvn /DEST pdfmark end
 1973 2646
a -2 2839 a
SDict begin H.S end
 -2 2839 a -2 2839 a
SDict begin 13 H.A end
 -2 2839 a -2 2839 a
SDict begin [/View [/XYZ H.V]/Dest (0:3835) cvn /DEST pdfmark end
 -2
2839 a 396 2920 a Fj(Our)20 b(third)g(design)f(uses)i(a)g(ping-pong)c
(dialog.)i(One)h(peer)f(sends)i(a)f(ping)g(command)e(to)i(the)g(other)m
(,)f(which)h(replies)396 3028 y(with)h(a)f(pong)f(command.)f(Neither)i
(command)e(has)i(an)o(y)g(payload.)e(Pings)i(and)g(pongs)f(are)h(not)g
(correlated.)f(Since)h(the)396 3136 y(roles)g(of)g("client")g(and)g
("serv)o(er")f(are)h(often)f(arbitrary)-5 b(,)18 b(we)j(specify)f(that)
g(either)g(peer)f(can)h(in)h(f)o(act)f(send)g(a)h(ping)e(and)396
3244 y(e)o(xpect)g(a)i(pong)e(in)h(response.)f(Ho)n(we)n(v)o(er)m(,)f
(since)j(the)f(timeouts)g(depend)e(on)i(netw)o(ork)f(topologies)g(kno)n
(wn)f(best)j(to)396 3352 y(dynamic)e(clients,)h(it)h(is)g(usually)f
(the)g(client)g(which)g(pings)g(the)g(serv)o(er)-5 b(.)-2
3536 y
SDict begin H.S end
 -2 3536 a -2 3536 a
SDict begin 13 H.A end
 -2 3536 a -2 3536 a
SDict begin [/View [/XYZ H.V]/Dest (0:3836) cvn /DEST pdfmark end
 -2 3536
a 396 3626 a Fj(This)21 b(w)o(orks)e(for)h(all)h(R)m(OUTER-based)e
(brok)o(ers.)g(The)h(same)g(optimizations)f(we)h(used)g(in)h(the)f
(second)f(model)g(mak)o(e)396 3734 y(this)i(w)o(ork)f(e)n(v)o(en)f
(better:)h(treat)g(an)o(y)f(incoming)g(data)h(as)h(a)f(pong,)f(and)g
(only)h(send)g(a)g(ping)g(when)f(not)h(otherwise)396
3842 y(sending)f(data.)-2 3953 y
SDict begin H.S end
 -2 3953 a -2 3953 a
SDict begin 13 H.A end

-2 3953 a -2 3953 a
SDict begin [/View [/XYZ H.V]/Dest (0:3837) cvn /DEST pdfmark end
 -2 3953 a 359 x Fh(6.10.)39 b(State)f(Mac)o(hines)
1402 4312 y
SDict begin H.S end
 1402 4312 a 1402 4312 a
SDict begin 22.464 H.A end
 1402 4312 a 1402
4312 a
SDict begin [/View [/XYZ H.V]/Dest (11.69.1) cvn /DEST pdfmark end
 1402 4312 a -2 4480 a
SDict begin H.S end
 -2 4480 a -2 4480 a
SDict begin 13 H.A end
 -2 4480
a -2 4480 a
SDict begin [/View [/XYZ H.V]/Dest (0:3839) cvn /DEST pdfmark end
 -2 4480 a 396 4586 a Fj(Softw)o(are)20 b(engineers)f(tend)h
(to)g(treat)g(\(\002nite\))g(state)h(machines)e(as)i(a)g(kind)e(of)h
(intermediary)e(interpreter)-5 b(.)19 b(That)h(is,)g(you)396
4694 y(tak)o(e)h(a)f(re)o(gular)f(language)f(and)i(compile)f(that)h
(into)g(a)h(state)g(machine,)e(then)g(e)o(x)o(ecute)g(the)h(state)h
(machine.)e(The)h(state)396 4802 y(machine)f(itself)i(is)g(rarely)f
(visible)g(to)g(the)g(de)n(v)o(eloper:)e(it')-5 b(s)21
b(an)g(internal)e(representation,)f(optimized,)g(compressed,)396
4910 y(and)i(bizarre.)p Black 3757 5569 a Fi(286)p Black
eop end
%%Page: 287 301
TeXDict begin 287 300 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.287) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3840) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Ho)n(we)n(v)o(er)f(it)j(turns)e(out)g(that)h(state)g
(machines)e(are)i(also)g(v)n(aluable)e(as)i(a)g(\002rst-class)h
(modeling)c(languages)i(for)f(protocol)396 180 y(handlers,)h(i.e.)h
(\330MQ)h(clients)f(and)g(serv)o(ers.)f(\330MQ)i(mak)o(es)f(it)h
(rather)e(easy)h(to)h(design)e(protocols,)g(b)n(ut)h(we')l(v)o(e)f(ne)n
(v)o(er)396 288 y(de\002ned)g(a)i(good)e(pattern)g(for)h(writing)f
(those)h(clients)h(and)e(serv)o(ers)h(properly)-5 b(.)-2
472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end
 -2 472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:3841) cvn /DEST pdfmark end
 -2 472 a 396
562 a Fj(A)21 b(protocol)d(has)j(at)g(least)f(tw)o(o)h(le)n(v)o(els:)-2
580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:3842) cvn /DEST pdfmark end
 -2 580 a -2
590 a
SDict begin H.S end
 -2 590 a -2 590 a
SDict begin 13 H.A end
 -2 590 a -2 590 a
SDict begin [/View [/XYZ H.V]/Dest (0:3843) cvn /DEST pdfmark end
 -2 590 a Black
396 733 a Fe(\225)p Black 479 733 a
SDict begin H.S end
 479 733 a 479 733
a
SDict begin 13 H.A end
 479 733 a 479 733 a
SDict begin [/View [/XYZ H.V]/Dest (0:3844) cvn /DEST pdfmark end
 479 733 a Fj(Ho)n(w)f(we)h(represent)e(indi)n
(vidual)f(messages)j(on)e(the)i(wire.)-2 750 y
SDict begin H.S end
 -2 750
a -2 750 a
SDict begin 13 H.A end
 -2 750 a -2 750 a
SDict begin [/View [/XYZ H.V]/Dest (0:3845) cvn /DEST pdfmark end
 -2 750 a Black 396 882 a
Fe(\225)p Black 479 882 a
SDict begin H.S end
 479 882 a 479 882 a
SDict begin 13 H.A end
 479 882
a 479 882 a
SDict begin [/View [/XYZ H.V]/Dest (0:3846) cvn /DEST pdfmark end
 479 882 a Fj(Ho)n(w)f(messages)h(\003o)n(w)f(between)f
(peers,)h(and)g(the)g(signi\002cance)f(of)h(each)g(message.)-2
1066 y
SDict begin H.S end
 -2 1066 a -2 1066 a
SDict begin 13 H.A end
 -2 1066 a -2 1066 a
SDict begin [/View [/XYZ H.V]/Dest (0:3847) cvn /DEST pdfmark end
 -2 1066
a 396 1156 a Fj(W)-7 b(e')l(v)o(e)20 b(seen)h(in)f(this)h(chapter)e(ho)
n(w)g(to)i(produce)d(codecs)h(that)i(handle)e(serialization.)g(That')-5
b(s)20 b(a)h(good)e(start.)h(But)h(if)g(we)396 1264 y(lea)n(v)o(e)f
(the)g(second)g(job)g(to)g(de)n(v)o(elopers,)e(that)i(gi)n(v)o(es)g
(them)g(a)g(lot)h(of)f(room)f(to)h(interpret.)f(As)i(we)f(mak)o(e)g
(more)396 1372 y(ambitious)g(protocols)e(\(\002le)j(transfer)e(+)i
(heart-beating)c(+)k(credit)f(+)g(authentication\),)e(it)j(becomes)e
(less)i(and)f(less)h(sane)396 1480 y(to)g(try)f(to)g(implement)f
(clients)h(and)g(serv)o(ers)g(by)f(hand.)-2 1664 y
SDict begin H.S end
 -2
1664 a -2 1664 a
SDict begin 13 H.A end
 -2 1664 a -2 1664 a
SDict begin [/View [/XYZ H.V]/Dest (0:3848) cvn /DEST pdfmark end
 -2 1664 a 396 1754
a Fj(Y)-8 b(es,)21 b(people)e(do)g(this)i(almost)f(systematically)-5
b(.)19 b(But)i(the)f(costs)h(are)f(high,)f(and)h(the)o(y')l(re)f(a)n(v)
n(oidable.)g(I')o(ll)h(e)o(xplain)f(ho)n(w)396 1862 y(to)i(model)e
(protocols)g(using)g(state)i(machines,)e(and)h(ho)n(w)g(to)g(generate)f
(neat)h(and)g(solid)g(code)f(from)h(those)g(models.)-2
2046 y
SDict begin H.S end
 -2 2046 a -2 2046 a
SDict begin 13 H.A end
 -2 2046 a -2 2046 a
SDict begin [/View [/XYZ H.V]/Dest (0:3849) cvn /DEST pdfmark end
 -2 2046
a 396 2136 a Fj(My)g(e)o(xperience)e(with)j(using)e(state)i(machines)f
(as)h(a)f(softw)o(are)g(construction)e(tool)i(dates)h(to)f(1985)f(and)g
(my)h(\002rst)h(real)396 2244 y(job)f(making)f(tools)h(for)g
(application)e(de)n(v)o(elopers.)g(In)i(1991)f(I)h(turned)f(that)i(kno)
n(wledge)d(into)h(a)i(free)f(softw)o(are)g(tool)396 2351
y(called)g(Libero,)f(which)h(spat)g(out)g(e)o(x)o(ecutable)e(state)j
(machines)f(from)f(a)h(simple)h(te)o(xt)f(model.)-2 2535
y
SDict begin H.S end
 -2 2535 a -2 2535 a
SDict begin 13 H.A end
 -2 2535 a -2 2535 a
SDict begin [/View [/XYZ H.V]/Dest (0:3850) cvn /DEST pdfmark end
 -2 2535 a 396
2625 a Fj(The)g(thing)g(about)f(Libero')-5 b(s)19 b(model)h(w)o(as)h
(that)f(it)h(w)o(as)g(readable.)e(That)g(is,)i(you)f(described)f(your)f
(program)g(logic)i(as)396 2733 y(named)f(states,)i(each)f(accepting)f
(a)i(set)g(of)f(e)n(v)o(ents,)f(each)h(doing)f(some)h(real)g(w)o(ork.)f
(The)h(resulting)f(state)i(machine)396 2841 y(hook)o(ed)e(into)h(your)e
(application)h(code,)g(dri)n(ving)g(it)i(lik)o(e)f(a)h(boss.)-2
3025 y
SDict begin H.S end
 -2 3025 a -2 3025 a
SDict begin 13 H.A end
 -2 3025 a -2 3025 a
SDict begin [/View [/XYZ H.V]/Dest (0:3851) cvn /DEST pdfmark end
 -2 3025
a 396 3115 a Fj(Libero)e(w)o(as)i(charmingly)d(good)h(at)i(its)g(job,)f
(\003uent)f(in)i(man)o(y)e(languages,)f(and)i(modestly)f(popular)g(gi)n
(v)o(en)f(the)396 3223 y(enigmatic)h(nature)h(of)g(state)h(machines.)e
(W)-7 b(e)21 b(used)f(Libero)f(in)h(anger)f(in)i(dozens)e(of)h(lar)o
(ge)f(distrib)n(uted)h(applications,)396 3331 y(one)g(of)g(which)f(w)o
(as)i(\002nally)f(switched)g(of)n(f)g(in)g(2011.)f(State-machine)f(dri)
n(v)o(en)h(code)h(construction)e(w)o(ork)o(ed)h(so)h(well)396
3439 y(that)h(it')-5 b(s)21 b(some)n(what)e(impressi)n(v)o(e)g(this)i
(approach)d(ne)n(v)o(er)h(hit)h(the)h(mainstream)e(of)h(softw)o(are)f
(engineering.)-2 3623 y
SDict begin H.S end
 -2 3623 a -2 3623 a
SDict begin 13 H.A end
 -2 3623 a
-2 3623 a
SDict begin [/View [/XYZ H.V]/Dest (0:3852) cvn /DEST pdfmark end
 -2 3623 a 396 3713 a Fj(So)i(in)f(this)h(section)f(I'm)f
(going)g(to)i(e)o(xplain)d(Libero')-5 b(s)20 b(model,)f(and)h(sho)n(w)g
(ho)n(w)f(to)i(use)f(it)h(to)f(generate)f(\330MQ)i(clients)396
3821 y(and)f(serv)o(ers.)f(W)-7 b(e')o(ll)22 b(use)e(GSL)h(again)e(b)n
(ut)h(lik)o(e)g(I)h(said,)f(the)g(principles)f(are)i(general)e(and)g
(you)h(can)g(put)f(together)g(code)396 3929 y(generators)g(using)g(an)o
(y)h(scripting)f(language.)-2 4113 y
SDict begin H.S end
 -2 4113 a -2 4113
a
SDict begin 13 H.A end
 -2 4113 a -2 4113 a
SDict begin [/View [/XYZ H.V]/Dest (0:3853) cvn /DEST pdfmark end
 -2 4113 a 396 4203 a Fj(As)i(a)g(w)o(ork)o(ed)e
(e)o(xample)g(let')-5 b(s)21 b(see)g(ho)n(w)e(to)i(carry-on)d(a)i
(stateful)g(dialog)g(with)g(a)h(peer)e(on)h(a)h(R)m(OUTER)f(sock)o(et.)
g(W)-7 b(e')o(ll)396 4311 y(de)n(v)o(elop)19 b(the)h(serv)o(er)f(using)
h(a)g(state)h(machine)e(\(and)h(the)g(client)g(by)g(hand\).)e(W)-7
b(e)22 b(ha)n(v)o(e)d(a)i(simple)f(protocol)f(that)h(I')o(ll)g(call)396
4419 y("NOM".)g(I'm)g(using)g(the)g(oh-so-v)o(ery-serious)1805
4419 y
SDict begin H.S end
 1805 4419 a 1805 4419 a
SDict begin 13 H.A end
 1805 4419 a 1805 4419
a
SDict begin [/View [/XYZ H.V]/Dest (0:3854) cvn /DEST pdfmark end
 1805 4419 a Fj(k)o(e)o(yw)o(ords)e(for)i(unprotocols)e
(\(http://unprotocols.or)o(g/b)o(log)o(:2\))396 4527
y(proposal:)-2 4628 y
SDict begin H.S end
 -2 4628 a -2 4628 a
SDict begin 11.7 H.A end
 -2 4628 a -2
4628 a
SDict begin [/View [/XYZ H.V]/Dest (0:3855) cvn /DEST pdfmark end
 -2 4628 a 396 4707 a Fg(nom-protocol)178 b(=)44
b(open-peering)1786 4720 y(*)1831 4707 y(use-peering)396
4901 y(open-peering)178 b(=)44 b(C:OHAI)g(\()h(S:OHAI-OK)e(/)i(S:WTF)f
(\))396 5095 y(use-peering)223 b(=)44 b(C:ICANHAZ)p Black
3756 5569 a Fi(287)p Black eop end
%%Page: 288 302
TeXDict begin 288 301 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.288) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3876) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 1114 72 a Fg(/)44 b(S:CHEEZBURGER)1114 170 y(/)g(C:HUGZ)g
(S:HUGZ-OK)1114 267 y(/)g(S:HUGZ)g(C:HUGZ-OK)-2 439 y
SDict begin H.S end

-2 439 a -2 439 a
SDict begin 13 H.A end
 -2 439 a -2 439 a
SDict begin [/View [/XYZ H.V]/Dest (0:3856) cvn /DEST pdfmark end
 -2 439 a 396 541
a Fj(I')l(v)o(e)19 b(not)h(found)f(a)h(quick)f(w)o(ay)i(to)f(e)o
(xplain)f(the)h(true)g(nature)f(of)h(state)h(machine)e(programming.)e
(In)i(my)h(e)o(xperience,)e(it)396 649 y(in)m(v)n(ariably)g(tak)o(es)j
(a)f(fe)n(w)h(days)e(of)h(practice.)g(After)g(three)f(or)h(four)f
(days')h(e)o(xposure)e(to)i(the)h(idea)f(there)f(is)j(a)396
757 y(near)n(-audible)c('click!')h(as)i(something)e(in)h(the)h(brain)e
(connects)g(all)i(the)f(pieces)g(together)-5 b(.)19 b(W)-7
b(e')o(ll)22 b(mak)o(e)d(it)i(concrete)e(by)396 865 y(looking)g(at)h
(the)h(state)g(machine)e(for)g(our)h(NOM)g(serv)o(er)-5
b(.)-2 1049 y
SDict begin H.S end
 -2 1049 a -2 1049 a
SDict begin 13 H.A end
 -2 1049 a -2 1049 a
SDict begin [/View [/XYZ H.V]/Dest (0:3857) cvn /DEST pdfmark end

-2 1049 a 396 1138 a Fj(A)21 b(useful)f(thing)f(about)g(state)i
(machines)f(is)h(that)f(you)f(can)h(read)g(them)g(state)h(by)e(state.)i
(Each)f(state)h(has)f(a)h(unique)396 1246 y(descripti)n(v)o(e)e(name,)g
(and)h(one)g(or)g(more)1562 1246 y
SDict begin H.S end
 1562 1246 a 1562 1246
a
SDict begin 13 H.A end
 1562 1246 a 1562 1246 a
SDict begin [/View [/XYZ H.V]/Dest (0:3858) cvn /DEST pdfmark end
 1562 1246 a Fi(e)o(vents)p
Fj(,)g(which)f(we)i(list)g(in)f(an)o(y)g(order)-5 b(.)19
b(F)o(or)h(each)g(e)n(v)o(ent)f(we)h(perform)f(zero)g(or)396
1354 y(more)588 1354 y
SDict begin H.S end
 588 1354 a 588 1354 a
SDict begin 13 H.A end
 588 1354
a 588 1354 a
SDict begin [/View [/XYZ H.V]/Dest (0:3859) cvn /DEST pdfmark end
 588 1354 a Fi(actions)p Fj(,)g(and)h(we)g(then)g(mo)o(v)o
(e)f(to)h(a)1637 1354 y
SDict begin H.S end
 1637 1354 a 1637 1354 a
SDict begin 13 H.A end
 1637
1354 a 1637 1354 a
SDict begin [/View [/XYZ H.V]/Dest (0:3860) cvn /DEST pdfmark end
 1637 1354 a Fi(ne)n(xt)g(state)h Fj(\(or)e(stay)i
(in)f(the)g(same)h(state\).)-2 1538 y
SDict begin H.S end
 -2 1538 a -2 1538
a
SDict begin 13 H.A end
 -2 1538 a -2 1538 a
SDict begin [/View [/XYZ H.V]/Dest (0:3861) cvn /DEST pdfmark end
 -2 1538 a 396 1628 a Fj(In)f(a)h(\330MQ)f
(protocol)f(serv)o(er)m(,)f(we)j(ha)n(v)o(e)f(a)g(state)h(machine)e
(instance)2413 1628 y
SDict begin H.S end
 2413 1628 a 2413 1628 a
SDict begin 13 H.A end
 2413 1628
a 2413 1628 a
SDict begin [/View [/XYZ H.V]/Dest (0:3862) cvn /DEST pdfmark end
 2413 1628 a Fi(per)h(client)q Fj(.)h(That)f(sounds)f
(comple)o(x)g(b)n(ut)h(it)h(isn')o(t,)396 1736 y(as)g(we')o(ll)g(see.)f
(W)-7 b(e)22 b(describe)d(our)g(\002rst)i(state)g(\(Start\))f(as)h(ha)n
(ving)e(one)h(v)n(alid)f(e)n(v)o(ent,)g("OHAI".)h(W)-7
b(e)22 b(check)d(the)h(user')-5 b(s)396 1844 y(credentials)20
b(and)f(then)h(arri)n(v)o(e)f(in)h(the)h(Authenticated)d(state\()p
0 TeXcolorgray 2166 1844 a
SDict begin H.S end
 2166 1844 a Fj(Figure)h(6-1)2515
1844 y
SDict begin 13 H.L end
 2515 1844 a 2515 1844 a
SDict begin [/Subtype /Link/Dest (0:figure-69) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2515 1844 a Black -1 w
Fj(\).)-2 1862 y
SDict begin H.S end
 -2 1862 a -2 1862 a
SDict begin 13 H.A end
 -2 1862 a -2 1862
a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-69) cvn /DEST pdfmark
end
 -2 1862 a 396 2045 a Fk(Figur)o(e)h(6-1.)f(The)i('Start')e(State)-2
2145 y
SDict begin H.S end
 -2 2145 a -2 2145 a
SDict begin 13 H.A end
 -2 2145 a -2 2145 a
SDict begin [/View [/XYZ H.V]/Dest (0:3866) cvn /DEST pdfmark end
 -2 2145
a 396 3087 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3087 a @beginspecial 0 @llx -108 @lly
372 @urx 0 @ury 3720 @rwi @setspecial
%%BeginDocument: images/fig69.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -108 372 0
%%HiResBoundingBox: 0.0 -108.0 372.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -23.800180435180664 moveto
17.800180435180664 -23.800180435180664 16.800180435180664 -25.466847101847332 16.800180435180664 -28.800180435180664 curveto
16.800180435180664 -37.80017852783203 lineto
16.800180435180664 -40.466845194498696 17.800180435180664 -41.80017852783203 19.800180435180664 -41.80017852783203 curveto
133.80018615722656 -41.80017852783203 lineto
133.80018615722656 -41.80017852783203 lineto
135.80018615722656 -41.80017852783203 136.80018615722656 -40.466845194498696 136.80018615722656 -37.80017852783203 curveto
136.80018615722656 -28.800180435180664 lineto
136.80018615722656 -28.800180435180664 lineto
136.80018615722656 -25.466847101847332 135.80018615722656 -23.800180435180664 133.80018615722656 -23.800180435180664 curveto
19.800180435180664 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.800180435180664 -59.80017852783203 moveto
28.800180435180664 -77.80017852783203 lineto
112.80017852783203 -77.80017852783203 lineto
112.80017852783203 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
241.80018615722656 -59.80017852783203 moveto
239.80018615722656 -59.80017852783203 238.80018615722656 -61.466845194498696 238.80018615722656 -64.80017852783203 curveto
238.80018615722656 -73.80017852783203 lineto
238.80018615722656 -76.4668451944987 239.80018615722656 -77.80017852783203 241.80018615722656 -77.80017852783203 curveto
355.8001708984375 -77.80017852783203 lineto
355.8001708984375 -77.80017852783203 lineto
357.8001708984375 -77.80017852783203 358.8001708984375 -76.4668451944987 358.8001708984375 -73.80017852783203 curveto
358.8001708984375 -64.80017852783203 lineto
358.8001708984375 -64.80017852783203 lineto
358.8001708984375 -61.466845194498696 357.8001708984375 -59.80017852783203 355.8001708984375 -59.80017852783203 curveto
241.80018615722656 -59.80017852783203 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -22.0 moveto
16.0 -22.0 15.0 -23.666666666666668 15.0 -27.0 curveto
15.0 -36.0 lineto
15.0 -38.666666666666664 16.0 -40.0 18.0 -40.0 curveto
132.0 -40.0 lineto
132.0 -40.0 lineto
134.0 -40.0 135.0 -38.666666666666664 135.0 -36.0 curveto
135.0 -27.0 lineto
135.0 -27.0 lineto
135.0 -23.666666666666668 134.0 -22.0 132.0 -22.0 curveto
18.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
18.0 -22.0 moveto
16.0 -22.0 15.0 -23.666666666666668 15.0 -27.0 curveto
15.0 -36.0 lineto
15.0 -38.666666666666664 16.0 -40.0 18.0 -40.0 curveto
132.0 -40.0 lineto
132.0 -40.0 lineto
134.0 -40.0 135.0 -38.666666666666664 135.0 -36.0 curveto
135.0 -27.0 lineto
135.0 -27.0 lineto
135.0 -23.666666666666668 134.0 -22.0 132.0 -22.0 curveto
18.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -58.0 moveto
27.0 -76.0 lineto
111.0 -76.0 lineto
111.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -58.0 moveto
27.0 -76.0 lineto
111.0 -76.0 lineto
111.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
240.0 -58.0 moveto
238.0 -58.0 237.0 -59.666666666666664 237.0 -63.0 curveto
237.0 -72.0 lineto
237.0 -74.66666666666667 238.0 -76.0 240.0 -76.0 curveto
354.0 -76.0 lineto
354.0 -76.0 lineto
356.0 -76.0 357.0 -74.66666666666667 357.0 -72.0 curveto
357.0 -63.0 lineto
357.0 -63.0 lineto
357.0 -59.666666666666664 356.0 -58.0 354.0 -58.0 curveto
240.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
240.0 -58.0 moveto
238.0 -58.0 237.0 -59.666666666666664 237.0 -63.0 curveto
237.0 -72.0 lineto
237.0 -74.66666666666667 238.0 -76.0 240.0 -76.0 curveto
354.0 -76.0 lineto
354.0 -76.0 lineto
356.0 -76.0 357.0 -74.66666666666667 357.0 -72.0 curveto
357.0 -63.0 lineto
357.0 -63.0 lineto
357.0 -59.666666666666664 356.0 -58.0 354.0 -58.0 curveto
240.0 -58.0 lineto
closepath
stroke
newpath
114.0 -67.0 moveto
231.0 -67.0 lineto
stroke
newpath
27.0 -45.0 moveto
27.0 -58.0 lineto
stroke
newpath
228.0 -63.0 moveto
234.0 -67.0 lineto
228.0 -72.0 lineto
closepath
fill
/Helvetica findfont
9 scalefont setfont
27.0 -35.0 moveto
(Start) show
37.0 -71.0 moveto
(OHAI) show
251.0 -71.0 moveto
(Authenticated) show
133.0 -89.0 moveto
(Check Credentials) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3087 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3087 a -2 3253 a
SDict begin H.S end
 -2 3253
a -2 3253 a
SDict begin 13 H.A end
 -2 3253 a -2 3253 a
SDict begin [/View [/XYZ H.V]/Dest (0:3869) cvn /DEST pdfmark end
 -2 3253 a 396 3361 a
Fj(The)h(Check)g(Credentials)g(action)g(produces)e(either)i(an)g('ok')f
(or)h(an)g('error')e(e)n(v)o(ent.)h(It')-5 b(s)21 b(in)g(the)f
(Authenticated)e(state)396 3469 y(that)j(we)f(handle)f(these)i(tw)o(o)f
(possible)g(e)n(v)o(ents,)f(by)h(sending)f(an)h(appropriate)e(reply)h
(back)h(to)g(the)g(client\()p 0 TeXcolorgray 3450 3469
a
SDict begin H.S end
 3450 3469 a Fj(Figure)f(6-2)3799 3469 y
SDict begin 13 H.L end
 3799 3469 a
3799 3469 a
SDict begin [/Subtype /Link/Dest (0:figure-70) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3799 3469 a Black -1 w Fj(\).)396 3577 y(If)h
(authentication)e(f)o(ailed,)i(we)h(return)e(to)h(the)g(Start)h(state)g
(where)e(the)i(client)f(can)g(try)g(again.)-2 3595 y
SDict begin H.S end

-2 3595 a -2 3595 a
SDict begin 13 H.A end
 -2 3595 a -2 3595 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-70) cvn /DEST pdfmark
end
 -2 3595 a Black
3759 5569 a Fi(288)p Black eop end
%%Page: 289 303
TeXDict begin 289 302 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.289) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fk(Figur)o(e)h(6-2.)f(The)i('A)l(uthenticated')e(State)
-2 172 y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 13 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:3873) cvn /DEST pdfmark end
 -2 172 a
396 1489 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 1489 a @beginspecial 0 @llx -153 @lly
372 @urx 0 @ury 3720 @rwi @setspecial
%%BeginDocument: images/fig70.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -153 372 0
%%HiResBoundingBox: 0.0 -153.0 372.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -23.800180435180664 moveto
17.800180435180664 -23.800180435180664 16.800180435180664 -25.466847101847332 16.800180435180664 -28.800180435180664 curveto
16.800180435180664 -37.80017852783203 lineto
16.800180435180664 -40.466845194498696 17.800180435180664 -41.80017852783203 19.800180435180664 -41.80017852783203 curveto
133.80018615722656 -41.80017852783203 lineto
133.80018615722656 -41.80017852783203 lineto
135.80018615722656 -41.80017852783203 136.80018615722656 -40.466845194498696 136.80018615722656 -37.80017852783203 curveto
136.80018615722656 -28.800180435180664 lineto
136.80018615722656 -28.800180435180664 lineto
136.80018615722656 -25.466847101847332 135.80018615722656 -23.800180435180664 133.80018615722656 -23.800180435180664 curveto
19.800180435180664 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.800180435180664 -59.80017852783203 moveto
28.800180435180664 -77.80017852783203 lineto
112.80017852783203 -77.80017852783203 lineto
112.80017852783203 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.800180435180664 -104.80017852783203 moveto
28.800180435180664 -122.80017852783203 lineto
112.80017852783203 -122.80017852783203 lineto
112.80017852783203 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
241.80018615722656 -59.80017852783203 moveto
239.80018615722656 -59.80017852783203 238.80018615722656 -61.466845194498696 238.80018615722656 -64.80017852783203 curveto
238.80018615722656 -73.80017852783203 lineto
238.80018615722656 -76.4668451944987 239.80018615722656 -77.80017852783203 241.80018615722656 -77.80017852783203 curveto
355.8001708984375 -77.80017852783203 lineto
355.8001708984375 -77.80017852783203 lineto
357.8001708984375 -77.80017852783203 358.8001708984375 -76.4668451944987 358.8001708984375 -73.80017852783203 curveto
358.8001708984375 -64.80017852783203 lineto
358.8001708984375 -64.80017852783203 lineto
358.8001708984375 -61.466845194498696 357.8001708984375 -59.80017852783203 355.8001708984375 -59.80017852783203 curveto
241.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
241.80018615722656 -104.80017852783203 moveto
239.80018615722656 -104.80017852783203 238.80018615722656 -106.4668451944987 238.80018615722656 -109.80017852783203 curveto
238.80018615722656 -118.80017852783203 lineto
238.80018615722656 -121.4668451944987 239.80018615722656 -122.80017852783203 241.80018615722656 -122.80017852783203 curveto
355.8001708984375 -122.80017852783203 lineto
355.8001708984375 -122.80017852783203 lineto
357.8001708984375 -122.80017852783203 358.8001708984375 -121.4668451944987 358.8001708984375 -118.80017852783203 curveto
358.8001708984375 -109.80017852783203 lineto
358.8001708984375 -109.80017852783203 lineto
358.8001708984375 -106.4668451944987 357.8001708984375 -104.80017852783203 355.8001708984375 -104.80017852783203 curveto
241.80018615722656 -104.80017852783203 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -22.0 moveto
16.0 -22.0 15.0 -23.666666666666668 15.0 -27.0 curveto
15.0 -36.0 lineto
15.0 -38.666666666666664 16.0 -40.0 18.0 -40.0 curveto
132.0 -40.0 lineto
132.0 -40.0 lineto
134.0 -40.0 135.0 -38.666666666666664 135.0 -36.0 curveto
135.0 -27.0 lineto
135.0 -27.0 lineto
135.0 -23.666666666666668 134.0 -22.0 132.0 -22.0 curveto
18.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
18.0 -22.0 moveto
16.0 -22.0 15.0 -23.666666666666668 15.0 -27.0 curveto
15.0 -36.0 lineto
15.0 -38.666666666666664 16.0 -40.0 18.0 -40.0 curveto
132.0 -40.0 lineto
132.0 -40.0 lineto
134.0 -40.0 135.0 -38.666666666666664 135.0 -36.0 curveto
135.0 -27.0 lineto
135.0 -27.0 lineto
135.0 -23.666666666666668 134.0 -22.0 132.0 -22.0 curveto
18.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -58.0 moveto
27.0 -76.0 lineto
111.0 -76.0 lineto
111.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -58.0 moveto
27.0 -76.0 lineto
111.0 -76.0 lineto
111.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -103.0 moveto
27.0 -121.0 lineto
111.0 -121.0 lineto
111.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -103.0 moveto
27.0 -121.0 lineto
111.0 -121.0 lineto
111.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
240.0 -58.0 moveto
238.0 -58.0 237.0 -59.666666666666664 237.0 -63.0 curveto
237.0 -72.0 lineto
237.0 -74.66666666666667 238.0 -76.0 240.0 -76.0 curveto
354.0 -76.0 lineto
354.0 -76.0 lineto
356.0 -76.0 357.0 -74.66666666666667 357.0 -72.0 curveto
357.0 -63.0 lineto
357.0 -63.0 lineto
357.0 -59.666666666666664 356.0 -58.0 354.0 -58.0 curveto
240.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
240.0 -58.0 moveto
238.0 -58.0 237.0 -59.666666666666664 237.0 -63.0 curveto
237.0 -72.0 lineto
237.0 -74.66666666666667 238.0 -76.0 240.0 -76.0 curveto
354.0 -76.0 lineto
354.0 -76.0 lineto
356.0 -76.0 357.0 -74.66666666666667 357.0 -72.0 curveto
357.0 -63.0 lineto
357.0 -63.0 lineto
357.0 -59.666666666666664 356.0 -58.0 354.0 -58.0 curveto
240.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
240.0 -103.0 moveto
238.0 -103.0 237.0 -104.66666666666667 237.0 -108.0 curveto
237.0 -117.0 lineto
237.0 -119.66666666666667 238.0 -121.0 240.0 -121.0 curveto
354.0 -121.0 lineto
354.0 -121.0 lineto
356.0 -121.0 357.0 -119.66666666666667 357.0 -117.0 curveto
357.0 -108.0 lineto
357.0 -108.0 lineto
357.0 -104.66666666666667 356.0 -103.0 354.0 -103.0 curveto
240.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
240.0 -103.0 moveto
238.0 -103.0 237.0 -104.66666666666667 237.0 -108.0 curveto
237.0 -117.0 lineto
237.0 -119.66666666666667 238.0 -121.0 240.0 -121.0 curveto
354.0 -121.0 lineto
354.0 -121.0 lineto
356.0 -121.0 357.0 -119.66666666666667 357.0 -117.0 curveto
357.0 -108.0 lineto
357.0 -108.0 lineto
357.0 -104.66666666666667 356.0 -103.0 354.0 -103.0 curveto
240.0 -103.0 lineto
closepath
stroke
newpath
114.0 -67.0 moveto
231.0 -67.0 lineto
stroke
newpath
180.0 -85.0 moveto
185.0 -85.0 lineto
stroke
newpath
114.0 -112.0 moveto
231.0 -112.0 lineto
stroke
newpath
27.0 -45.0 moveto
27.0 -58.0 lineto
stroke
newpath
27.0 -76.0 moveto
27.0 -103.0 lineto
stroke
newpath
228.0 -63.0 moveto
234.0 -67.0 lineto
228.0 -72.0 lineto
closepath
fill
newpath
228.0 -108.0 moveto
234.0 -112.0 lineto
228.0 -117.0 lineto
closepath
fill
/Helvetica findfont
9 scalefont setfont
29.0 -35.0 moveto
(Authenticated) show
36.0 -71.0 moveto
(ok) show
248.0 -71.0 moveto
(Ready) show
128.0 -89.0 moveto
(Send OHAI OK) show
39.0 -116.0 moveto
(error) show
249.0 -116.0 moveto
(Start) show
128.0 -134.0 moveto
(Send WTF) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1489 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1489 a 274 x Fj(When)h(authentication)e
(has)j(succeeded,)d(we)j(arri)n(v)o(e)e(in)h(the)h(Ready)f(state.)g
(Here)g(we)h(ha)n(v)o(e)e(three)h(possible)g(e)n(v)o(ents:)g(an)396
1871 y(ICANHAZ)h(or)e(HUGZ)i(message)f(from)f(the)h(client,)g(or)g(a)h
(heartbeat)e(timer)h(e)n(v)o(ent\()p 0 TeXcolorgray 2839
1871 a
SDict begin H.S end
 2839 1871 a Fj(Figure)d(6-3)3186 1871 y
SDict begin 13 H.L end
 3186 1871
a 3186 1871 a
SDict begin [/Subtype /Link/Dest (0:figure-71) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3186 1871 a Black -1 w Fj(\).)-2 1889 y
SDict begin H.S end

-2 1889 a -2 1889 a
SDict begin 13 H.A end
 -2 1889 a -2 1889 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-71) cvn /DEST pdfmark
end
 -2 1889 a 396
2072 a Fk(Figur)o(e)j(6-3.)f(The)i('Ready')e(State)-2
2172 y
SDict begin H.S end
 -2 2172 a -2 2172 a
SDict begin 13 H.A end
 -2 2172 a -2 2172 a
SDict begin [/View [/XYZ H.V]/Dest (0:3880) cvn /DEST pdfmark end
 -2 2172
a 396 3863 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 3863 a @beginspecial 0 @llx -198 @lly
372 @urx 0 @ury 3720 @rwi @setspecial
%%BeginDocument: images/fig71.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -198 372 0
%%HiResBoundingBox: 0.0 -198.0 372.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
19.800180435180664 -23.800180435180664 moveto
17.800180435180664 -23.800180435180664 16.800180435180664 -25.466847101847332 16.800180435180664 -28.800180435180664 curveto
16.800180435180664 -37.80017852783203 lineto
16.800180435180664 -40.466845194498696 17.800180435180664 -41.80017852783203 19.800180435180664 -41.80017852783203 curveto
133.80018615722656 -41.80017852783203 lineto
133.80018615722656 -41.80017852783203 lineto
135.80018615722656 -41.80017852783203 136.80018615722656 -40.466845194498696 136.80018615722656 -37.80017852783203 curveto
136.80018615722656 -28.800180435180664 lineto
136.80018615722656 -28.800180435180664 lineto
136.80018615722656 -25.466847101847332 135.80018615722656 -23.800180435180664 133.80018615722656 -23.800180435180664 curveto
19.800180435180664 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.800180435180664 -59.80017852783203 moveto
28.800180435180664 -77.80017852783203 lineto
112.80017852783203 -77.80017852783203 lineto
112.80017852783203 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.800180435180664 -104.80017852783203 moveto
28.800180435180664 -122.80017852783203 lineto
112.80017852783203 -122.80017852783203 lineto
112.80017852783203 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.800180435180664 -149.80018615722656 moveto
28.800180435180664 -167.80018615722656 lineto
112.80017852783203 -167.80018615722656 lineto
112.80017852783203 -149.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
241.80018615722656 -59.80017852783203 moveto
239.80018615722656 -59.80017852783203 238.80018615722656 -61.466845194498696 238.80018615722656 -64.80017852783203 curveto
238.80018615722656 -73.80017852783203 lineto
238.80018615722656 -76.4668451944987 239.80018615722656 -77.80017852783203 241.80018615722656 -77.80017852783203 curveto
355.8001708984375 -77.80017852783203 lineto
355.8001708984375 -77.80017852783203 lineto
357.8001708984375 -77.80017852783203 358.8001708984375 -76.4668451944987 358.8001708984375 -73.80017852783203 curveto
358.8001708984375 -64.80017852783203 lineto
358.8001708984375 -64.80017852783203 lineto
358.8001708984375 -61.466845194498696 357.8001708984375 -59.80017852783203 355.8001708984375 -59.80017852783203 curveto
241.80018615722656 -59.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
241.80018615722656 -104.80017852783203 moveto
239.80018615722656 -104.80017852783203 238.80018615722656 -106.4668451944987 238.80018615722656 -109.80017852783203 curveto
238.80018615722656 -118.80017852783203 lineto
238.80018615722656 -121.4668451944987 239.80018615722656 -122.80017852783203 241.80018615722656 -122.80017852783203 curveto
355.8001708984375 -122.80017852783203 lineto
355.8001708984375 -122.80017852783203 lineto
357.8001708984375 -122.80017852783203 358.8001708984375 -121.4668451944987 358.8001708984375 -118.80017852783203 curveto
358.8001708984375 -109.80017852783203 lineto
358.8001708984375 -109.80017852783203 lineto
358.8001708984375 -106.4668451944987 357.8001708984375 -104.80017852783203 355.8001708984375 -104.80017852783203 curveto
241.80018615722656 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
241.80018615722656 -149.80018615722656 moveto
239.80018615722656 -149.80018615722656 238.80018615722656 -151.46685282389322 238.80018615722656 -154.80018615722656 curveto
238.80018615722656 -163.80018615722656 lineto
238.80018615722656 -166.46685282389322 239.80018615722656 -167.80018615722656 241.80018615722656 -167.80018615722656 curveto
355.8001708984375 -167.80018615722656 lineto
355.8001708984375 -167.80018615722656 lineto
357.8001708984375 -167.80018615722656 358.8001708984375 -166.46685282389322 358.8001708984375 -163.80018615722656 curveto
358.8001708984375 -154.80018615722656 lineto
358.8001708984375 -154.80018615722656 lineto
358.8001708984375 -151.46685282389322 357.8001708984375 -149.80018615722656 355.8001708984375 -149.80018615722656 curveto
241.80018615722656 -149.80018615722656 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
18.0 -22.0 moveto
16.0 -22.0 15.0 -23.666666666666668 15.0 -27.0 curveto
15.0 -36.0 lineto
15.0 -38.666666666666664 16.0 -40.0 18.0 -40.0 curveto
132.0 -40.0 lineto
132.0 -40.0 lineto
134.0 -40.0 135.0 -38.666666666666664 135.0 -36.0 curveto
135.0 -27.0 lineto
135.0 -27.0 lineto
135.0 -23.666666666666668 134.0 -22.0 132.0 -22.0 curveto
18.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
18.0 -22.0 moveto
16.0 -22.0 15.0 -23.666666666666668 15.0 -27.0 curveto
15.0 -36.0 lineto
15.0 -38.666666666666664 16.0 -40.0 18.0 -40.0 curveto
132.0 -40.0 lineto
132.0 -40.0 lineto
134.0 -40.0 135.0 -38.666666666666664 135.0 -36.0 curveto
135.0 -27.0 lineto
135.0 -27.0 lineto
135.0 -23.666666666666668 134.0 -22.0 132.0 -22.0 curveto
18.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -58.0 moveto
27.0 -76.0 lineto
111.0 -76.0 lineto
111.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -58.0 moveto
27.0 -76.0 lineto
111.0 -76.0 lineto
111.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -103.0 moveto
27.0 -121.0 lineto
111.0 -121.0 lineto
111.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -103.0 moveto
27.0 -121.0 lineto
111.0 -121.0 lineto
111.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
27.0 -148.0 moveto
27.0 -166.0 lineto
111.0 -166.0 lineto
111.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
27.0 -148.0 moveto
27.0 -166.0 lineto
111.0 -166.0 lineto
111.0 -148.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
240.0 -58.0 moveto
238.0 -58.0 237.0 -59.666666666666664 237.0 -63.0 curveto
237.0 -72.0 lineto
237.0 -74.66666666666667 238.0 -76.0 240.0 -76.0 curveto
354.0 -76.0 lineto
354.0 -76.0 lineto
356.0 -76.0 357.0 -74.66666666666667 357.0 -72.0 curveto
357.0 -63.0 lineto
357.0 -63.0 lineto
357.0 -59.666666666666664 356.0 -58.0 354.0 -58.0 curveto
240.0 -58.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
240.0 -58.0 moveto
238.0 -58.0 237.0 -59.666666666666664 237.0 -63.0 curveto
237.0 -72.0 lineto
237.0 -74.66666666666667 238.0 -76.0 240.0 -76.0 curveto
354.0 -76.0 lineto
354.0 -76.0 lineto
356.0 -76.0 357.0 -74.66666666666667 357.0 -72.0 curveto
357.0 -63.0 lineto
357.0 -63.0 lineto
357.0 -59.666666666666664 356.0 -58.0 354.0 -58.0 curveto
240.0 -58.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
240.0 -103.0 moveto
238.0 -103.0 237.0 -104.66666666666667 237.0 -108.0 curveto
237.0 -117.0 lineto
237.0 -119.66666666666667 238.0 -121.0 240.0 -121.0 curveto
354.0 -121.0 lineto
354.0 -121.0 lineto
356.0 -121.0 357.0 -119.66666666666667 357.0 -117.0 curveto
357.0 -108.0 lineto
357.0 -108.0 lineto
357.0 -104.66666666666667 356.0 -103.0 354.0 -103.0 curveto
240.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
240.0 -103.0 moveto
238.0 -103.0 237.0 -104.66666666666667 237.0 -108.0 curveto
237.0 -117.0 lineto
237.0 -119.66666666666667 238.0 -121.0 240.0 -121.0 curveto
354.0 -121.0 lineto
354.0 -121.0 lineto
356.0 -121.0 357.0 -119.66666666666667 357.0 -117.0 curveto
357.0 -108.0 lineto
357.0 -108.0 lineto
357.0 -104.66666666666667 356.0 -103.0 354.0 -103.0 curveto
240.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
240.0 -148.0 moveto
238.0 -148.0 237.0 -149.66666666666666 237.0 -153.0 curveto
237.0 -162.0 lineto
237.0 -164.66666666666666 238.0 -166.0 240.0 -166.0 curveto
354.0 -166.0 lineto
354.0 -166.0 lineto
356.0 -166.0 357.0 -164.66666666666666 357.0 -162.0 curveto
357.0 -153.0 lineto
357.0 -153.0 lineto
357.0 -149.66666666666666 356.0 -148.0 354.0 -148.0 curveto
240.0 -148.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
240.0 -148.0 moveto
238.0 -148.0 237.0 -149.66666666666666 237.0 -153.0 curveto
237.0 -162.0 lineto
237.0 -164.66666666666666 238.0 -166.0 240.0 -166.0 curveto
354.0 -166.0 lineto
354.0 -166.0 lineto
356.0 -166.0 357.0 -164.66666666666666 357.0 -162.0 curveto
357.0 -153.0 lineto
357.0 -153.0 lineto
357.0 -149.66666666666666 356.0 -148.0 354.0 -148.0 curveto
240.0 -148.0 lineto
closepath
stroke
newpath
114.0 -67.0 moveto
231.0 -67.0 lineto
stroke
newpath
114.0 -112.0 moveto
231.0 -112.0 lineto
stroke
newpath
180.0 -130.0 moveto
185.0 -130.0 lineto
stroke
newpath
114.0 -157.0 moveto
231.0 -157.0 lineto
stroke
newpath
27.0 -45.0 moveto
27.0 -58.0 lineto
stroke
newpath
27.0 -76.0 moveto
27.0 -103.0 lineto
stroke
newpath
27.0 -121.0 moveto
27.0 -148.0 lineto
stroke
newpath
228.0 -63.0 moveto
234.0 -67.0 lineto
228.0 -72.0 lineto
closepath
fill
newpath
228.0 -108.0 moveto
234.0 -112.0 lineto
228.0 -117.0 lineto
closepath
fill
newpath
228.0 -153.0 moveto
234.0 -157.0 lineto
228.0 -162.0 lineto
closepath
fill
/Helvetica findfont
8 scalefont setfont
26.0 -35.0 moveto
(Ready) show
37.0 -71.0 moveto
(ICANHAZ) show
248.0 -71.0 moveto
(Ready) show
128.0 -89.0 moveto
(Send CHEEZBURGER) show
37.0 -116.0 moveto
(HUGZ) show
248.0 -116.0 moveto
(Ready) show
128.0 -134.0 moveto
(Send HUGZ OK) show
39.0 -161.0 moveto
(heartbeat) show
248.0 -161.0 moveto
(Ready) show
127.0 -179.0 moveto
(Send HUGZ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 3863 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 3863 a -2 4030 a
SDict begin H.S end
 -2 4030
a -2 4030 a
SDict begin 13 H.A end
 -2 4030 a -2 4030 a
SDict begin [/View [/XYZ H.V]/Dest (0:3883) cvn /DEST pdfmark end
 -2 4030 a 396 4137 a
Fj(There)h(are)g(a)g(fe)n(w)g(more)g(things)g(about)f(this)i(state)f
(machine)g(model)f(that)h(are)g(w)o(orth)g(kno)n(wing:)-2
4155 y
SDict begin H.S end
 -2 4155 a -2 4155 a
SDict begin 13 H.A end
 -2 4155 a -2 4155 a
SDict begin [/View [/XYZ H.V]/Dest (0:3884) cvn /DEST pdfmark end
 -2 4155
a -2 4165 a
SDict begin H.S end
 -2 4165 a -2 4165 a
SDict begin 13 H.A end
 -2 4165 a -2 4165 a
SDict begin [/View [/XYZ H.V]/Dest (0:3885) cvn /DEST pdfmark end
 -2
4165 a Black 396 4308 a Fe(\225)p Black 479 4308 a
SDict begin H.S end
 479
4308 a 479 4308 a
SDict begin 13 H.A end
 479 4308 a 479 4308 a
SDict begin [/View [/XYZ H.V]/Dest (0:3886) cvn /DEST pdfmark end
 479 4308 a Fj(Ev)o(ents)g(in)g
(upper)f(case)i(\(lik)o(e)f("HUGZ"\))f(are)h('e)o(xternal)f(e)n(v)o
(ents')g(that)i(come)e(from)g(the)h(client)h(as)g(messages.)-2
4326 y
SDict begin H.S end
 -2 4326 a -2 4326 a
SDict begin 13 H.A end
 -2 4326 a -2 4326 a
SDict begin [/View [/XYZ H.V]/Dest (0:3887) cvn /DEST pdfmark end
 -2 4326
a Black 396 4457 a Fe(\225)p Black 479 4457 a
SDict begin H.S end
 479 4457
a 479 4457 a
SDict begin 13 H.A end
 479 4457 a 479 4457 a
SDict begin [/View [/XYZ H.V]/Dest (0:3888) cvn /DEST pdfmark end
 479 4457 a Fj(Ev)o(ents)f(in)g(lo)n
(wer)g(case)g(\(lik)o(e)h("heartbeat"\))d(are)i('internal)f(e)n(v)o
(ents',)g(produced)f(by)i(code)f(in)h(the)h(serv)o(er)-5
b(.)-2 4475 y
SDict begin H.S end
 -2 4475 a -2 4475 a
SDict begin 13 H.A end
 -2 4475 a -2 4475 a
SDict begin [/View [/XYZ H.V]/Dest (0:3889) cvn /DEST pdfmark end

-2 4475 a Black 396 4607 a Fe(\225)p Black 479 4607 a
SDict begin H.S end

479 4607 a 479 4607 a
SDict begin 13 H.A end
 479 4607 a 479 4607 a
SDict begin [/View [/XYZ H.V]/Dest (0:3890) cvn /DEST pdfmark end
 479 4607
a Fj(The)20 b("Send)g(SOMETHING")f(actions)h(are)g(shorthand)f(for)g
(sending)g(a)i(speci\002c)f(reply)f(back)h(to)g(the)h(client.)-2
4625 y
SDict begin H.S end
 -2 4625 a -2 4625 a
SDict begin 13 H.A end
 -2 4625 a -2 4625 a
SDict begin [/View [/XYZ H.V]/Dest (0:3891) cvn /DEST pdfmark end
 -2 4625
a Black 396 4756 a Fe(\225)p Black 479 4756 a
SDict begin H.S end
 479 4756
a 479 4756 a
SDict begin 13 H.A end
 479 4756 a 479 4756 a
SDict begin [/View [/XYZ H.V]/Dest (0:3892) cvn /DEST pdfmark end
 479 4756 a Fj(Ev)o(ents)f(that)g
(aren')o(t)f(de\002ned)g(in)h(a)h(particular)e(state)i(are)f(silently)g
(ignored.)-2 4940 y
SDict begin H.S end
 -2 4940 a -2 4940 a
SDict begin 13 H.A end
 -2 4940 a -2
4940 a
SDict begin [/View [/XYZ H.V]/Dest (0:3893) cvn /DEST pdfmark end
 -2 4940 a 396 5030 a Fj(No)n(w)-5 b(,)20 b(the)g(original)f
(source)g(for)h(these)g(pretty)g(pictures)f(is)i(an)g(XML)f(model:)p
Black 3759 5569 a Fi(289)p Black eop end
%%Page: 290 304
TeXDict begin 290 303 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.290) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3894) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fg(<class)44 b(name)g(=)h("nom_server")e(script)h(=)g
("server_c">)396 267 y(<state)g(name)g(=)h("start">)576
364 y(<event)e(name)i(=)f("OHAI")g(next)g(=)h("authenticated">)755
461 y(<action)f(name)g(=)g("check)g(credentials")f(/>)576
558 y(</event>)396 655 y(</state>)396 850 y(<state)h(name)g(=)h
("authenticated">)576 947 y(<event)e(name)i(=)f("ok")g(next)h(=)f
("ready">)755 1044 y(<action)g(name)g(=)g("send")g(message)g
(="OHAI-OK")f(/>)576 1141 y(</event>)576 1238 y(<event)g(name)i(=)f
("error")g(next)g(=)h("start">)755 1335 y(<action)f(name)g(=)g("send")g
(message)g(=)h("WTF")f(/>)576 1432 y(</event>)396 1530
y(</state>)396 1724 y(<state)g(name)g(=)h("ready">)576
1821 y(<event)e(name)i(=)f("ICANHAZ">)755 1918 y(<action)g(name)g(=)g
("send")g(message)g(=)h("CHEEZBURGER")d(/>)576 2015 y(</event>)576
2112 y(<event)h(name)i(=)f("HUGZ">)755 2209 y(<action)g(name)g(=)g
("send")g(message)g(=)h("HUGZ-OK")e(/>)576 2307 y(</event>)576
2404 y(<event)g(name)i(=)f("heartbeat">)755 2501 y(<action)g(name)g(=)g
("send")g(message)g(=)h("HUGZ")e(/>)576 2598 y(</event>)396
2695 y(</state>)396 2792 y(</class>)-2 2964 y
SDict begin H.S end
 -2 2964
a -2 2964 a
SDict begin 13 H.A end
 -2 2964 a -2 2964 a
SDict begin [/View [/XYZ H.V]/Dest (0:3895) cvn /DEST pdfmark end
 -2 2964 a 396 3066 a
Fj(The)20 b(code)g(generator)e(is)j(in)f(e)o(xamples/models/serv)o
(er_c.gsl.)c(It)k(is)h(a)g(f)o(airly)f(complete)f(tool)h(that)g(I')o
(ll)g(use)h(and)396 3174 y(e)o(xpand)e(for)g(more)g(serious)h(w)o(ork)g
(later)-5 b(.)20 b(It)h(generates:)-2 3192 y
SDict begin H.S end
 -2 3192
a -2 3192 a
SDict begin 13 H.A end
 -2 3192 a -2 3192 a
SDict begin [/View [/XYZ H.V]/Dest (0:3896) cvn /DEST pdfmark end
 -2 3192 a -2 3202 a
SDict begin H.S end
 -2
3202 a -2 3202 a
SDict begin 13 H.A end
 -2 3202 a -2 3202 a
SDict begin [/View [/XYZ H.V]/Dest (0:3897) cvn /DEST pdfmark end
 -2 3202 a Black
396 3344 a Fe(\225)p Black 479 3344 a
SDict begin H.S end
 479 3344 a 479
3344 a
SDict begin 13 H.A end
 479 3344 a 479 3344 a
SDict begin [/View [/XYZ H.V]/Dest (0:3898) cvn /DEST pdfmark end
 479 3344 a Fj(A)g(serv)o(er)e(class)i(in)g
(C)g(\(nom_serv)o(er)-5 b(.c,)17 b(nom_serv)o(er)-5 b(.h\))17
b(that)j(implements)f(the)h(whole)g(protocol)e(\003o)n(w)-5
b(.)-2 3362 y
SDict begin H.S end
 -2 3362 a -2 3362 a
SDict begin 13 H.A end
 -2 3362 a -2 3362 a
SDict begin [/View [/XYZ H.V]/Dest (0:3899) cvn /DEST pdfmark end

-2 3362 a Black 396 3494 a Fe(\225)p Black 479 3494 a
SDict begin H.S end

479 3494 a 479 3494 a
SDict begin 13 H.A end
 479 3494 a 479 3494 a
SDict begin [/View [/XYZ H.V]/Dest (0:3900) cvn /DEST pdfmark end
 479 3494
a Fj(A)21 b(selftest)g(method)e(that)h(runs)g(the)g(selftest)h(steps)g
(listed)f(in)h(the)f(XML)g(\002le.)-2 3512 y
SDict begin H.S end
 -2 3512
a -2 3512 a
SDict begin 13 H.A end
 -2 3512 a -2 3512 a
SDict begin [/View [/XYZ H.V]/Dest (0:3901) cvn /DEST pdfmark end
 -2 3512 a Black 396 3643
a Fe(\225)p Black 479 3643 a
SDict begin H.S end
 479 3643 a 479 3643 a
SDict begin 13 H.A end
 479
3643 a 479 3643 a
SDict begin [/View [/XYZ H.V]/Dest (0:3902) cvn /DEST pdfmark end
 479 3643 a Fj(Documentation)e(in)i(the)h(form)e(of)h
(graphics)f(\(the)g(pretty)h(pictures\).)-2 3827 y
SDict begin H.S end
 -2
3827 a -2 3827 a
SDict begin 13 H.A end
 -2 3827 a -2 3827 a
SDict begin [/View [/XYZ H.V]/Dest (0:3903) cvn /DEST pdfmark end
 -2 3827 a 396 3917
a Fj(Here')-5 b(s)21 b(a)f(simple)g(main)g(program)e(that)j(starts)g
(the)f(generated)e(NOM)j(serv)o(er:)-2 4018 y
SDict begin H.S end
 -2 4018
a -2 4018 a
SDict begin 11.7 H.A end
 -2 4018 a -2 4018 a
SDict begin [/View [/XYZ H.V]/Dest (0:3904) cvn /DEST pdfmark end
 -2 4018 a 396 4097 a
Fg(#include)44 b("czmq.h")396 4195 y(#include)g("nom_server.h")396
4389 y(int)h(main)f(\(int)g(argc,)g(char)1517 4402 y(*)1562
4389 y(argv)g([]\))396 4486 y({)576 4583 y(printf)f(\("Starting)h(NOM)g
(protocol)f(server)h(on)h(port)f(6000...\\n"\);)576 4680
y(nom_server_t)1158 4693 y(*)1203 4680 y(server)g(=)h(nom_server_new)d
(\(\);)576 4777 y(nom_server_bind)g(\(server,)h("tcp://)2011
4790 y(*)2056 4777 y(:6000"\);)576 4874 y(nom_server_wait)f
(\(server\);)576 4972 y(nom_server_destroy)f(\(&server\);)576
5069 y(return)i(0;)396 5166 y(})p Black 3759 5569 a Fi(290)p
Black eop end
%%Page: 291 305
TeXDict begin 291 304 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.291) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3905) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)h(generated)f(nom_serv)o(er)e(class)k(is)g(a)g(f)
o(airly)f(classic)h(model.)e(It)h(accepts)g(client)h(messages)f(on)g(a)
g(R)m(OUTER)396 180 y(sock)o(et.)g(The)g(\002rst)h(frame)e(on)h(e)n(v)o
(ery)f(request)g(is)i(the)g(client')-5 b(s)20 b(identity)-5
b(.)19 b(The)h(serv)o(er)f(manages)h(a)g(set)h(of)f(clients,)g(each)396
288 y(with)h(state.)f(As)h(messages)g(arri)n(v)o(e,)d(it)j(feeds)f
(these)h(as)g('e)n(v)o(ents')d(to)j(the)f(state)h(machine.)e(Here')-5
b(s)20 b(the)g(core)g(of)g(the)g(state)396 396 y(machine,)f(as)i(a)g
(mix)f(of)f(GSL)i(commands)d(and)i(the)g(C)h(code)f(we)h(intend)e(to)h
(generate:)-2 497 y
SDict begin H.S end
 -2 497 a -2 497 a
SDict begin 11.7 H.A end
 -2 497 a -2 497
a
SDict begin [/View [/XYZ H.V]/Dest (0:3906) cvn /DEST pdfmark end
 -2 497 a 396 576 a Fg(client_execute)43 b(\(client_t)1517
589 y(*)1562 576 y(self,)h(int)g(event\))396 674 y({)576
771 y(self->next_event)e(=)i(event;)576 868 y(while)g
(\(self->next_event\))d({)755 965 y(self->event)i(=)i
(self->next_event;)755 1062 y(self->next_event)d(=)j(0;)755
1159 y(switch)f(\(self->state\))e({)396 1256 y(.for)i(class.state)934
1354 y(case)g($\(name:c\)_state:)396 1451 y(.)135 b(for)44
b(event)396 1548 y(.)314 b(if)44 b(index)g(\(\))h(>)g(1)1114
1645 y(else)396 1742 y(.)314 b(endif)1114 1839 y(if)44
b(\(self->event)f(==)h($\(name:c\)_event\))f({)396 1936
y(.)314 b(for)44 b(action)396 2033 y(.)493 b(if)45 b(name)f(=)h("send")
1293 2131 y(zmsg_addstr)e(\(self->reply,)g("$\(message:\)"\);)396
2228 y(.)493 b(else)1114 2325 y($\(name:c\)_action)42
b(\(self\);)396 2422 y(.)493 b(endif)396 2519 y(.)314
b(endfor)396 2616 y(.)g(if)44 b(defined)g(\(event.next\))1293
2713 y(self->state)f(=)i($\(next:c\)_state;)396 2811
y(.)314 b(endif)1114 2908 y(})396 3005 y(.)135 b(endfor)1114
3102 y(break;)396 3199 y(.endfor)755 3296 y(})755 3393
y(if)44 b(\(zmsg_size)g(\(self->reply\))e(>)j(1\))f({)934
3490 y(zmsg_send)g(\(&self->reply,)e(self->router\);)934
3588 y(self->reply)h(=)i(zmsg_new)e(\(\);)934 3685 y(zmsg_add)h
(\(self->reply,)e(zframe_dup)i(\(self->address\)\);)755
3782 y(})576 3879 y(})396 3976 y(})-2 4150 y
SDict begin H.S end
 -2 4150
a -2 4150 a
SDict begin 13 H.A end
 -2 4150 a -2 4150 a
SDict begin [/View [/XYZ H.V]/Dest (0:3907) cvn /DEST pdfmark end
 -2 4150 a 396 4250 a
Fj(Each)20 b(client)g(is)h(held)f(as)h(an)f(object)g(with)g(v)n(arious)
f(properties,)g(including)f(the)i(v)n(ariables)g(we)g(need)g(to)g
(represent)f(a)396 4358 y(state)i(machine)e(instance:)-2
4442 y
SDict begin H.S end
 -2 4442 a -2 4442 a
SDict begin 11.7 H.A end
 -2 4442 a -2 4442 a
SDict begin [/View [/XYZ H.V]/Dest (0:3908) cvn /DEST pdfmark end
 -2 4442
a 396 4538 a Fg(event_t)44 b(next_event;)402 b(//)89
b(Next)44 b(event)396 4635 y(state_t)g(state;)627 b(//)89
b(Current)44 b(state)396 4733 y(event_t)g(event;)627
b(//)89 b(Current)44 b(event)-2 4908 y
SDict begin H.S end
 -2 4908 a -2 4908
a
SDict begin 13 H.A end
 -2 4908 a -2 4908 a
SDict begin [/View [/XYZ H.V]/Dest (0:3909) cvn /DEST pdfmark end
 -2 4908 a 396 5006 a Fj(Y)-9 b(ou)19
b(will)i(see)f(by)f(no)n(w)g(that)h(we)g(are)g(generating)e
(technically-perfect)e(code)j(that)h(has)g(the)g(precise)f(design)g
(and)g(shape)396 5114 y(we)i(w)o(ant.)f(The)g(only)f(clue)h(that)g(the)
h(nom_serv)o(er)c(class)k(isn')o(t)f(hand-written)e(is)j(that)g(the)f
(code)f(is)3263 5114 y
SDict begin H.S end
 3263 5114 a 3263 5114 a
SDict begin 13 H.A end
 3263 5114
a 3263 5114 a
SDict begin [/View [/XYZ H.V]/Dest (0:3910) cvn /DEST pdfmark end
 3263 5114 a Fi(too)h(good)r Fj(.)f(People)p
Black 3759 5569 a Fi(291)p Black eop end
%%Page: 292 306
TeXDict begin 292 305 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.292) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(who)h(complain)f(that)h(code)g(generators)e(produce)g
(poor)h(code)h(are)g(ob)o(viously)e(used)i(to)g(poor)f(code)h
(generators.)e(It)i(is)396 180 y(tri)n(vial)g(to)h(e)o(xtend)d(our)i
(model)f(as)i(we)g(need)e(it.)i(F)o(or)f(e)o(xample,)e(here')-5
b(s)20 b(ho)n(w)g(we)g(generate)f(the)i(selftest)g(code.)-2
364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:3911) cvn /DEST pdfmark end
 -2 364 a 396
454 a Fj(First,)g(we)g(add)e(a)i("selftest")g(item)f(to)g(the)g(state)h
(machine)e(and)h(write)g(our)g(tests.)h(W)-7 b(e')l(re)20
b(not)g(using)g(an)o(y)f(XML)396 562 y(grammar)g(or)h(v)n(alidators)f
(so)h(it)h(really)f(is)h(just)g(a)f(matter)g(of)g(opening)f(the)h
(editor)f(and)h(adding)f(half-a-dozen)e(lines)j(of)396
670 y(te)o(xt:)-2 754 y
SDict begin H.S end
 -2 754 a -2 754 a
SDict begin 11.7 H.A end
 -2 754 a -2
754 a
SDict begin [/View [/XYZ H.V]/Dest (0:3912) cvn /DEST pdfmark end
 -2 754 a 396 850 a Fg(<selftest>)576 948 y(<step)44
b(send)g(=)g("OHAI")g(body)g(=)h("Sleepy")f(recv)g(=)g("WTF")g(/>)576
1045 y(<step)g(send)g(=)g("OHAI")g(body)g(=)h("Joe")f(recv)g(=)h
("OHAI-OK")e(/>)576 1142 y(<step)h(send)g(=)g("ICANHAZ")g(recv)g(=)h
("CHEEZBURGER")d(/>)576 1239 y(<step)i(send)g(=)g("HUGZ")g(recv)g(=)h
("HUGZ-OK")e(/>)576 1336 y(<step)h(recv)g(=)g("HUGZ")g(/>)396
1433 y(</selftest>)-2 1605 y
SDict begin H.S end
 -2 1605 a -2 1605 a
SDict begin 13 H.A end
 -2 1605
a -2 1605 a
SDict begin [/View [/XYZ H.V]/Dest (0:3913) cvn /DEST pdfmark end
 -2 1605 a 396 1707 a Fj(Designing)19 b(on)h(the)g(\003y)-5
b(,)20 b(I)g(decided)f(that)i("send")e(and)h("recv")f(were)h(a)h(nice)f
(w)o(ay)g(to)h(e)o(xpress)e("send)h(this)h(request,)e(then)396
1815 y(e)o(xpect)g(this)i(reply".)e(Here')-5 b(s)21 b(the)f(GSL)g(code)
g(that)g(turns)g(this)h(model)e(into)h(real)g(code:)-2
1916 y
SDict begin H.S end
 -2 1916 a -2 1916 a
SDict begin 11.7 H.A end
 -2 1916 a -2 1916 a
SDict begin [/View [/XYZ H.V]/Dest (0:3914) cvn /DEST pdfmark end
 -2 1916
a 396 1995 a Fg(.for)44 b(class->selftest.step)396 2092
y(.)135 b(if)44 b(defined)g(\(send\))576 2190 y(msg)g(=)h(zmsg_new)e
(\(\);)576 2287 y(zmsg_addstr)g(\(msg,)h("$\(send:\)"\);)396
2384 y(.)314 b(if)44 b(defined)g(\(body\))576 2481 y(zmsg_addstr)f
(\(msg,)h("$\(body:\)"\);)396 2578 y(.)314 b(endif)576
2675 y(zmsg_send)43 b(\(&msg,)h(dealer\);)396 2869 y(.)135
b(endif)396 2967 y(.)g(if)44 b(defined)g(\(recv\))576
3064 y(msg)g(=)h(zmsg_recv)e(\(dealer\);)576 3161 y(assert)g(\(msg\);)
576 3258 y(command)g(=)i(zmsg_popstr)e(\(msg\);)576 3355
y(assert)g(\(streq)h(\(command,)g("$\(recv:\)"\)\);)576
3452 y(free)g(\(command\);)576 3549 y(zmsg_destroy)e(\(&msg\);)396
3744 y(.)135 b(endif)396 3841 y(.endfor)-2 4008 y
SDict begin H.S end
 -2
4008 a -2 4008 a
SDict begin 13 H.A end
 -2 4008 a -2 4008 a
SDict begin [/View [/XYZ H.V]/Dest (0:3915) cvn /DEST pdfmark end
 -2 4008 a 396 4115
a Fj(Finally)-5 b(,)20 b(one)f(of)h(the)g(more)g(trick)o(y)f(b)n(ut)h
(absolutely)f(essential)i(parts)f(of)g(an)o(y)f(state)i(machine)e
(generator)g(is)3516 4115 y
SDict begin H.S end
 3516 4115 a 3516 4115 a
SDict begin 13 H.A end
 3516
4115 a 3516 4115 a
SDict begin [/View [/XYZ H.V]/Dest (0:3916) cvn /DEST pdfmark end
 3516 4115 a Fi(how)h(do)g(I)396 4223
y(plug)g(this)g(into)g(my)h(own)f(code?)f Fj(As)i(a)g(minimal)e(e)o
(xample)g(for)h(this)g(e)o(x)o(ercise)f(I)i(w)o(anted)f(to)g(implement)
f(the)h("check)396 4331 y(credentials")g(action)f(by)h(accepting)f(all)
i(OHAIs)f(from)f(my)h(friend)f(Joe)i(\(Hi)f(Joe!\))g(and)f(reject)i(e)n
(v)o(eryone)c(else')-5 b(s)396 4439 y(OHAIs.)21 b(After)e(some)h
(thought)f(I)h(decided)f(to)i(grab)e(code)g(directly)h(from)f(the)h
(state)h(machine)e(model.)g(So)i(in)396 4547 y(nom_serv)o(er)-5
b(.xml,)17 b(you')o(ll)i(see)i(this:)-2 4648 y
SDict begin H.S end
 -2 4648
a -2 4648 a
SDict begin 11.7 H.A end
 -2 4648 a -2 4648 a
SDict begin [/View [/XYZ H.V]/Dest (0:3917) cvn /DEST pdfmark end
 -2 4648 a 396 4727 a
Fg(<action)44 b(name)g(=)h("check)f(credentials">)576
4824 y(char)800 4837 y(*)845 4824 y(body)g(=)g(zmsg_popstr)f
(\(self->request\);)576 4921 y(if)h(\(body)g(&&)h(streq)f(\(body,)f
("Joe"\)\))755 5018 y(self->next_event)f(=)j(ok_event;)576
5115 y(else)p Black 3759 5569 a Fi(292)p Black eop end
%%Page: 293 307
TeXDict begin 293 306 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.293) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 755 72 a Fg(self->next_event)42 b(=)j(error_event;)576
170 y(free)f(\(body\);)396 267 y(</action>)-2 439 y
SDict begin H.S end
 -2
439 a -2 439 a
SDict begin 13 H.A end
 -2 439 a -2 439 a
SDict begin [/View [/XYZ H.V]/Dest (0:3918) cvn /DEST pdfmark end
 -2 439 a 396 541 a Fj(And)20
b(the)g(code)g(generator)e(grabs)i(that)g(custom)f(code)h(and)g
(inserts)g(it)h(into)f(the)g(generated)f(nom_serv)o(er)-5
b(.c)17 b(\002le:)-2 642 y
SDict begin H.S end
 -2 642 a -2 642 a
SDict begin 11.7 H.A end
 -2 642 a
-2 642 a
SDict begin [/View [/XYZ H.V]/Dest (0:3919) cvn /DEST pdfmark end
 -2 642 a 396 721 a Fg(.for)44 b(class.action)396
818 y(static)g(void)396 915 y($\(name:c\)_action)e(\(client_t)1607
928 y(*)1652 915 y(self\))i({)396 1012 y($\(string.trim)f(\(.\):\))396
1109 y(})396 1207 y(.endfor)-2 1374 y
SDict begin H.S end
 -2 1374 a -2 1374
a
SDict begin 13 H.A end
 -2 1374 a -2 1374 a
SDict begin [/View [/XYZ H.V]/Dest (0:3920) cvn /DEST pdfmark end
 -2 1374 a 396 1481 a Fj(And)20
b(no)n(w)g(we)g(ha)n(v)o(e)g(something)e(quite)i(ele)o(gant:)f(a)i
(single)f(source)f(\002le)i(that)g(describes)e(my)h(serv)o(er)f(state)i
(machine,)396 1588 y(and)f(which)g(also)g(contains)g(the)g(nati)n(v)o
(e)f(implementations)f(for)i(my)g(actions.)f(A)i(nice)f(mix)g(of)g
(high-le)n(v)o(el)e(and)396 1696 y(lo)n(w-le)n(v)o(el)h(that)h(is)i
(about)d(90\045)h(smaller)g(than)g(the)g(C)h(code.)-2
1864 y
SDict begin H.S end
 -2 1864 a -2 1864 a
SDict begin 13 H.A end
 -2 1864 a -2 1864 a
SDict begin [/View [/XYZ H.V]/Dest (0:3921) cvn /DEST pdfmark end
 -2 1864
a 396 1970 a Fj(Be)n(w)o(are,)f(as)h(your)e(head)h(spins)g(with)h
(notions)e(of)h(all)h(the)f(amazing)f(things)g(you)h(could)f(produce)f
(with)j(such)e(le)n(v)o(erage.)396 2078 y(While)i(this)g(approach)d(gi)
n(v)o(es)h(you)h(real)g(po)n(wer)m(,)e(it)j(also)g(mo)o(v)o(es)e(you)g
(a)o(w)o(ay)h(from)f(your)g(peers,)h(and)f(if)i(you)e(go)h(too)g(f)o
(ar)m(,)396 2186 y(you')o(ll)g(\002nd)f(yourself)g(w)o(orking)g(alone.)
-2 2370 y
SDict begin H.S end
 -2 2370 a -2 2370 a
SDict begin 13 H.A end
 -2 2370 a -2 2370 a
SDict begin [/View [/XYZ H.V]/Dest (0:3922) cvn /DEST pdfmark end
 -2
2370 a 396 2460 a Fj(By)i(the)f(w)o(ay)-5 b(,)20 b(this)g(simple)h
(little)g(state)g(machine)e(design)g(e)o(xposes)g(just)i(three)f(v)n
(ariables)f(to)i(our)e(custom)h(code:)-2 2478 y
SDict begin H.S end
 -2 2478
a -2 2478 a
SDict begin 13 H.A end
 -2 2478 a -2 2478 a
SDict begin [/View [/XYZ H.V]/Dest (0:3923) cvn /DEST pdfmark end
 -2 2478 a -2 2488 a
SDict begin H.S end
 -2
2488 a -2 2488 a
SDict begin 13 H.A end
 -2 2488 a -2 2488 a
SDict begin [/View [/XYZ H.V]/Dest (0:3924) cvn /DEST pdfmark end
 -2 2488 a Black
396 2630 a Fe(\225)p Black 479 2630 a
SDict begin H.S end
 479 2630 a 479
2630 a
SDict begin 13 H.A end
 479 2630 a 479 2630 a
SDict begin [/View [/XYZ H.V]/Dest (0:3925) cvn /DEST pdfmark end
 479 2630 a 479 2630 a
SDict begin H.S end
 479
2630 a 479 2630 a
SDict begin 13 H.A end
 479 2630 a 479 2630 a
SDict begin [/View [/XYZ H.V]/Dest (0:3926) cvn /DEST pdfmark end
 479 2630 a Fg(self->next_event)
-2 2640 y
SDict begin H.S end
 -2 2640 a -2 2640 a
SDict begin 13 H.A end
 -2 2640 a -2 2640 a
SDict begin [/View [/XYZ H.V]/Dest (0:3927) cvn /DEST pdfmark end
 -2
2640 a Black 396 2780 a Fe(\225)p Black 479 2780 a
SDict begin H.S end
 479
2780 a 479 2780 a
SDict begin 13 H.A end
 479 2780 a 479 2780 a
SDict begin [/View [/XYZ H.V]/Dest (0:3928) cvn /DEST pdfmark end
 479 2780 a 479
2780 a
SDict begin H.S end
 479 2780 a 479 2780 a
SDict begin 13 H.A end
 479 2780 a 479 2780 a
SDict begin [/View [/XYZ H.V]/Dest (0:3929) cvn /DEST pdfmark end
 479
2780 a Fg(self->request)-2 2792 y
SDict begin H.S end
 -2 2792 a -2 2792 a
SDict begin 13 H.A end

-2 2792 a -2 2792 a
SDict begin [/View [/XYZ H.V]/Dest (0:3930) cvn /DEST pdfmark end
 -2 2792 a Black 396 2929 a Fe(\225)p
Black 479 2929 a
SDict begin H.S end
 479 2929 a 479 2929 a
SDict begin 13 H.A end
 479 2929 a 479
2929 a
SDict begin [/View [/XYZ H.V]/Dest (0:3931) cvn /DEST pdfmark end
 479 2929 a 479 2929 a
SDict begin H.S end
 479 2929 a 479 2929 a
SDict begin 13 H.A end
 479
2929 a 479 2929 a
SDict begin [/View [/XYZ H.V]/Dest (0:3932) cvn /DEST pdfmark end
 479 2929 a Fg(self->reply)-2 3107 y
SDict begin H.S end

-2 3107 a -2 3107 a
SDict begin 13 H.A end
 -2 3107 a -2 3107 a
SDict begin [/View [/XYZ H.V]/Dest (0:3933) cvn /DEST pdfmark end
 -2 3107 a 396
3203 a Fj(In)g(the)g(Libero)f(state)i(machine)e(model)h(there)f(are)i
(a)f(fe)n(w)g(more)g(concepts)f(that)h(we')l(v)o(e)f(not)h(used)g
(here,)g(b)n(ut)g(which)f(we)396 3311 y(will)i(need)f(when)f(we)i
(write)f(lar)o(ger)f(state)i(machines:)-2 3329 y
SDict begin H.S end
 -2 3329
a -2 3329 a
SDict begin 13 H.A end
 -2 3329 a -2 3329 a
SDict begin [/View [/XYZ H.V]/Dest (0:3934) cvn /DEST pdfmark end
 -2 3329 a -2 3339 a
SDict begin H.S end
 -2
3339 a -2 3339 a
SDict begin 13 H.A end
 -2 3339 a -2 3339 a
SDict begin [/View [/XYZ H.V]/Dest (0:3935) cvn /DEST pdfmark end
 -2 3339 a Black
396 3481 a Fe(\225)p Black 479 3481 a
SDict begin H.S end
 479 3481 a 479
3481 a
SDict begin 13 H.A end
 479 3481 a 479 3481 a
SDict begin [/View [/XYZ H.V]/Dest (0:3936) cvn /DEST pdfmark end
 479 3481 a Fj(Exceptions,)e(which)g(lets)i
(us)g(write)f(terser)h(state)f(machines.)g(When)g(an)g(action)f(raises)
i(an)f(e)o(xception,)e(further)479 3589 y(processing)h(on)h(the)g(e)n
(v)o(ent)f(stops.)i(The)e(state)i(machine)e(can)h(then)g(de\002ne)g(ho)
n(w)f(to)i(handle)e(e)o(xception)f(e)n(v)o(ents.)-2 3607
y
SDict begin H.S end
 -2 3607 a -2 3607 a
SDict begin 13 H.A end
 -2 3607 a -2 3607 a
SDict begin [/View [/XYZ H.V]/Dest (0:3937) cvn /DEST pdfmark end
 -2 3607 a Black
396 3739 a Fe(\225)p Black 479 3739 a
SDict begin H.S end
 479 3739 a 479
3739 a
SDict begin 13 H.A end
 479 3739 a 479 3739 a
SDict begin [/View [/XYZ H.V]/Dest (0:3938) cvn /DEST pdfmark end
 479 3739 a Fj(Def)o(aults)h(state,)g
(where)f(we)h(can)g(de\002ne)f(def)o(ault)g(handling)e(for)i(e)n(v)o
(ents)g(\(especially)g(useful)g(for)g(e)o(xception)f(e)n(v)o(ents\).)-2
3798 y
SDict begin H.S end
 -2 3798 a -2 3798 a
SDict begin 13 H.A end
 -2 3798 a -2 3798 a
SDict begin [/View [/XYZ H.V]/Dest (0:3939) cvn /DEST pdfmark end
 -2 3798
a 359 x Fh(6.11.)39 b(A)l(uthentication)c(using)k(SASL)2203
4157 y
SDict begin H.S end
 2203 4157 a 2203 4157 a
SDict begin 22.464 H.A end
 2203 4157 a 2203 4157
a
SDict begin [/View [/XYZ H.V]/Dest (11.70.1) cvn /DEST pdfmark end
 2203 4157 a -2 4355 a
SDict begin H.S end
 -2 4355 a -2 4355 a
SDict begin 13 H.A end
 -2 4355 a
-2 4355 a
SDict begin [/View [/XYZ H.V]/Dest (0:3941) cvn /DEST pdfmark end
 -2 4355 a 396 4431 a Fj(When)20 b(we)h(designed)e(AMQP)h(in)h
(2007,)d(we)j(chose)1930 4431 y
SDict begin H.S end
 1930 4431 a 1930 4431
a
SDict begin 13 H.A end
 1930 4431 a 1930 4431 a
SDict begin [/View [/XYZ H.V]/Dest (0:3942) cvn /DEST pdfmark end
 1930 4431 a Fj(SASL)396 4539
y(\(http://en.wikipedia.or)o(g/wiki/Simple_)o(Auth)o(enticatio)o(n_)o
(and)o(_Secu)o(rity)o(_Lay)o(er\))14 b(for)20 b(the)g(authentication)e
(layer)m(,)396 4647 y(one)i(of)g(the)g(ideas)g(we)h(took)e(from)g(the)i
(BEEP)f(protocol)f(frame)n(w)o(ork.)f(SASL)i(looks)g(comple)o(x)f(at)h
(\002rst,)h(b)n(ut)f(it')-5 b(s)396 4755 y(simple)20
b(and)g(\002ts)h(v)o(ery)e(nicely)h(into)g(a)h(\330MQ-based)e
(protocol.)f(What)j(I)f(especially)g(lik)o(e)g(about)f(SASL)i(is)g
(that)g(it')-5 b(s)396 4863 y(scalable.)20 b(Y)-9 b(ou)20
b(can)g(start)g(with)h(anon)o(ymous)c(access,)k(or)f(plain)f(te)o(xt)h
(authentication)f(and)g(no)h(security)-5 b(,)19 b(and)h(gro)n(w)f(to)
396 4971 y(more)h(secure)f(mechanisms)h(o)o(v)o(er)e(time,)j(without)e
(changing)f(your)h(protocol)g(one)g(bit.)p Black 3759
5569 a Fi(293)p Black eop end
%%Page: 294 308
TeXDict begin 294 307 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.294) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3964) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3943) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(I'm)h(not)g(going)f(to)h(gi)n(v)o(e)f(a)i(deep)e(e)o
(xplanation)f(no)n(w)-5 b(,)19 b(since)i(we')o(ll)f(see)h(SASL)g(in)f
(action)g(some)n(what)f(later)-5 b(.)21 b(But)f(I')o(ll)396
180 y(e)o(xplain)f(the)h(principle)f(so)i(you')l(re)d(already)h(some)n
(what)h(prepared.)-2 364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a
-2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:3944) cvn /DEST pdfmark end
 -2 364 a 396 454 a Fj(In)g(the)g(NOM)h(protocol)d(the)j
(client)f(started)g(with)g(an)g(OHAI)h(command,)c(which)j(the)g(serv)o
(er)g(either)f(accepted)h(\("Hi)396 562 y(Joe!"\))g(or)g(rejected.)f
(This)h(is)i(simple)e(b)n(ut)g(not)g(scalable)g(since)g(serv)o(er)g
(and)f(client)h(ha)n(v)o(e)g(to)g(agree)g(upfront)e(what)i(kind)396
670 y(of)g(authentication)e(the)o(y')l(re)h(going)g(to)h(do.)-2
854 y
SDict begin H.S end
 -2 854 a -2 854 a
SDict begin 13 H.A end
 -2 854 a -2 854 a
SDict begin [/View [/XYZ H.V]/Dest (0:3945) cvn /DEST pdfmark end
 -2 854 a 396
944 a Fj(What)h(SASL)f(introduced,)e(and)h(which)h(is)h(genius,)e(is)i
(a)f(fully)f(abstracted)h(and)f(ne)o(gotiable)f(security)i(layer)f
(that')-5 b(s)21 b(still)396 1052 y(easy)g(to)f(implement)f(at)i(the)f
(protocol)e(le)n(v)o(el.)i(It)g(w)o(orks)g(as)h(follo)n(ws:)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:3946) cvn /DEST pdfmark end
 -2 1070
a -2 1080 a
SDict begin H.S end
 -2 1080 a -2 1080 a
SDict begin 13 H.A end
 -2 1080 a -2 1080 a
SDict begin [/View [/XYZ H.V]/Dest (0:3947) cvn /DEST pdfmark end
 -2
1080 a Black 396 1222 a Fe(\225)p Black 479 1222 a
SDict begin H.S end
 479
1222 a 479 1222 a
SDict begin 13 H.A end
 479 1222 a 479 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:3948) cvn /DEST pdfmark end
 479 1222 a Fj(The)f(client)g
(connects.)-2 1223 y
SDict begin H.S end
 -2 1223 a -2 1223 a
SDict begin 13 H.A end
 -2 1223 a -2
1223 a
SDict begin [/View [/XYZ H.V]/Dest (0:3949) cvn /DEST pdfmark end
 -2 1223 a Black 396 1372 a Fe(\225)p Black 479
1372 a
SDict begin H.S end
 479 1372 a 479 1372 a
SDict begin 13 H.A end
 479 1372 a 479 1372 a
SDict begin [/View [/XYZ H.V]/Dest (0:3950) cvn /DEST pdfmark end
 479
1372 a Fj(The)g(serv)o(er)f(challenges)h(the)g(client,)g(passing)g(a)g
(list)i(of)d(security)h("mechanisms")f(that)h(it)h(kno)n(ws)f(about.)-2
1390 y
SDict begin H.S end
 -2 1390 a -2 1390 a
SDict begin 13 H.A end
 -2 1390 a -2 1390 a
SDict begin [/View [/XYZ H.V]/Dest (0:3951) cvn /DEST pdfmark end
 -2 1390
a Black 396 1521 a Fe(\225)p Black 479 1521 a
SDict begin H.S end
 479 1521
a 479 1521 a
SDict begin 13 H.A end
 479 1521 a 479 1521 a
SDict begin [/View [/XYZ H.V]/Dest (0:3952) cvn /DEST pdfmark end
 479 1521 a Fj(The)g(client)g
(chooses)g(a)h(security)e(mechanism)g(that)h(it)h(kno)n(ws)f(about,)f
(and)g(answers)i(the)f(serv)o(er')-5 b(s)19 b(challenge)g(with)479
1629 y(a)i(blob)e(of)h(opaque)f(data)h(that)g(\(and)f(here')-5
b(s)20 b(the)h(neat)f(trick\))f(some)h(generic)f(security)h(library)f
(calculates)h(and)g(gi)n(v)o(es)479 1737 y(to)h(the)f(client.)-2
1738 y
SDict begin H.S end
 -2 1738 a -2 1738 a
SDict begin 13 H.A end
 -2 1738 a -2 1738 a
SDict begin [/View [/XYZ H.V]/Dest (0:3953) cvn /DEST pdfmark end
 -2 1738
a Black 396 1887 a Fe(\225)p Black 479 1887 a
SDict begin H.S end
 479 1887
a 479 1887 a
SDict begin 13 H.A end
 479 1887 a 479 1887 a
SDict begin [/View [/XYZ H.V]/Dest (0:3954) cvn /DEST pdfmark end
 479 1887 a Fj(The)g(serv)o(er)f(tak)
o(es)i(the)f(security)g(mechanism)f(the)h(client)g(choose,)f(and)h
(that)g(blob)g(of)f(data,)h(and)g(passes)h(it)g(to)f(its)479
1994 y(o)n(wn)g(security)g(library)-5 b(.)-2 2012 y
SDict begin H.S end
 -2
2012 a -2 2012 a
SDict begin 13 H.A end
 -2 2012 a -2 2012 a
SDict begin [/View [/XYZ H.V]/Dest (0:3955) cvn /DEST pdfmark end
 -2 2012 a Black
396 2144 a Fe(\225)p Black 479 2144 a
SDict begin H.S end
 479 2144 a 479
2144 a
SDict begin 13 H.A end
 479 2144 a 479 2144 a
SDict begin [/View [/XYZ H.V]/Dest (0:3956) cvn /DEST pdfmark end
 479 2144 a Fj(The)20 b(library)f(either)h
(accepts)g(the)g(client')-5 b(s)21 b(answer)m(,)e(or)h(the)g(serv)o(er)
g(challenges)f(again.)-2 2328 y
SDict begin H.S end
 -2 2328 a -2 2328 a
SDict begin 13 H.A end
 -2
2328 a -2 2328 a
SDict begin [/View [/XYZ H.V]/Dest (0:3957) cvn /DEST pdfmark end
 -2 2328 a 396 2418 a Fj(There)h(are)g(a)g(number)f(of)
h(free)f(SASL)i(libraries.)f(When)g(we)g(come)g(to)g(real)g(code,)g
(we')o(ll)g(implement)f(just)i(tw)o(o)396 2526 y(mechanisms,)e
(ANONYMOUS)i(and)e(PLAIN,)h(which)g(don')o(t)e(need)i(an)o(y)f(special)
h(libraries.)-2 2710 y
SDict begin H.S end
 -2 2710 a -2 2710 a
SDict begin 13 H.A end
 -2 2710 a
-2 2710 a
SDict begin [/View [/XYZ H.V]/Dest (0:3958) cvn /DEST pdfmark end
 -2 2710 a 396 2800 a Fj(T)-7 b(o)21 b(support)d(SASL)j(we)g
(ha)n(v)o(e)e(to)i(add)e(an)h(optional)f(challenge/response)f(step)i
(to)h(our)e("open-peering")e(\003o)n(w)-5 b(.)19 b(Here)h(is)396
2908 y(what)g(the)h(resulting)e(protocol)f(grammar)h(looks)h(lik)o(e)g
(\(I'm)f(modifying)f(NOM)i(to)h(do)f(this\):)-2 3009
y
SDict begin H.S end
 -2 3009 a -2 3009 a
SDict begin 11.7 H.A end
 -2 3009 a -2 3009 a
SDict begin [/View [/XYZ H.V]/Dest (0:3959) cvn /DEST pdfmark end
 -2 3009 a 396
3088 a Fg(secure-nom)268 b(=)44 b(open-peering)1786 3101
y(*)1831 3088 y(use-peering)396 3282 y(open-peering)178
b(=)44 b(C:OHAI)1517 3295 y(*)1562 3282 y(\()h(S:ORLY)e(C:YARLY)h(\))h
(\()f(S:OHAI-OK)g(/)g(S:WTF)g(\))396 3476 y(ORLY)538
b(=)44 b(1)1248 3489 y(*)1293 3476 y(mechanism)f(challenge)396
3574 y(mechanism)313 b(=)44 b(string)396 3671 y(challenge)313
b(=)1203 3684 y(*)1248 3671 y(OCTET)396 3865 y(YARLY)493
b(=)44 b(mechanism)g(response)396 3962 y(response)358
b(=)1203 3975 y(*)1248 3962 y(OCTET)-2 4140 y
SDict begin H.S end
 -2 4140
a -2 4140 a
SDict begin 13 H.A end
 -2 4140 a -2 4140 a
SDict begin [/View [/XYZ H.V]/Dest (0:3960) cvn /DEST pdfmark end
 -2 4140 a 396 4236 a
Fj(Where)20 b(ORL)-8 b(Y)21 b(and)e(Y)-10 b(ARL)i(Y)21
b(contain)e(a)i(string)e(\(a)i(list)g(of)f(mechanisms)f(in)h(ORL)-8
b(Y)d(,)21 b(one)f(mechanism)e(in)j(Y)-10 b(ARL)i(Y\))396
4344 y(and)20 b(a)h(blob)e(of)h(opaque)e(data.)i(Depending)e(on)i(the)g
(mechanism,)f(the)h(initial)h(challenge)d(from)i(the)g(serv)o(er)f(may)
h(be)396 4452 y(empty)-5 b(.)19 b(W)-7 b(e)21 b(don')o(t)e(care)h(a)g
(jot:)h(we)f(just)h(pass)g(this)g(to)f(the)g(security)g(library)f(to)h
(deal)g(with.)-2 4636 y
SDict begin H.S end
 -2 4636 a -2 4636 a
SDict begin 13 H.A end
 -2 4636 a
-2 4636 a
SDict begin [/View [/XYZ H.V]/Dest (0:3961) cvn /DEST pdfmark end
 -2 4636 a 396 4726 a Fj(The)g(SASL)770 4726
y
SDict begin H.S end
 770 4726 a 770 4726 a
SDict begin 13 H.A end
 770 4726 a 770 4726 a
SDict begin [/View [/XYZ H.V]/Dest (0:3962) cvn /DEST pdfmark end
 770 4726
a Fj(RFC)i(\(http://tools.ietf.or)o(g/html/rfc4)o(422)o(\))14
b(goes)20 b(into)g(detail)h(about)e(other)g(features)h(\(that)g(we)g
(don')o(t)396 4834 y(need\),)f(the)h(kinds)g(of)g(w)o(ays)g(SASL)h
(could)e(be)i(attack)o(ed,)e(and)h(so)g(on.)p Black 3759
5569 a Fi(294)p Black eop end
%%Page: 295 309
TeXDict begin 295 308 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.295) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3980) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3963) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Unless)i(you')l(re)d(a)j(security)f(geek,)f(all)i
(you)e(should)g(care)h(about)f(is)i(the)g(impact)e(on)h(the)g
(protocol,)e(which)i(is)h(as)g(simple)396 180 y(as)g(I')l(v)o(e)e(e)o
(xplained)f(here.)-2 209 y
SDict begin H.S end
 -2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a
-2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:3964) cvn /DEST pdfmark end
 -2 209 a 359 x Fh(6.12.)39 b(Lar)n(g)q(e-scale)e(File)i(Pub)o
(lishing)2215 568 y
SDict begin H.S end
 2215 568 a 2215 568 a
SDict begin 22.464 H.A end
 2215 568 a
2215 568 a
SDict begin [/View [/XYZ H.V]/Dest (11.71.1) cvn /DEST pdfmark end
 2215 568 a -2 766 a
SDict begin H.S end
 -2 766 a -2 766 a
SDict begin 13 H.A end
 -2 766
a -2 766 a
SDict begin [/View [/XYZ H.V]/Dest (0:3966) cvn /DEST pdfmark end
 -2 766 a 396 842 a Fj(Let')-5 b(s)21 b(put)e(all)h(these)g
(techniques)e(together)h(into)g(a)h(\002le)h(distrib)n(ution)d(system)i
(that)g(I')o(ll)g(call)g(FileMQ.)g(This)g(is)g(going)f(to)396
950 y(be)h(a)h(real)f(product,)e(li)n(ving)i(on)1310
950 y
SDict begin H.S end
 1310 950 a 1310 950 a
SDict begin 13 H.A end
 1310 950 a 1310 950 a
SDict begin [/View [/XYZ H.V]/Dest (0:3967) cvn /DEST pdfmark end
 1310
950 a Fj(github)m(.com)d(\(https://github)m(.com/hintjens/\002lemq\).)d
(What)21 b(we')o(ll)f(mak)o(e)g(here)g(is)h(a)396 1058
y(\002rst)g(v)o(ersion)e(of)h(FileMQ,)g(as)h(a)g(training)e(tool.)h(If)
g(the)g(concept)f(w)o(orks,)h(the)g(real)g(thing)f(may)h(e)n(v)o
(entually)e(get)j(its)g(o)n(wn)396 1166 y(Guide.)-2 1167
y
SDict begin H.S end
 -2 1167 a -2 1167 a
SDict begin 13 H.A end
 -2 1167 a -2 1167 a
SDict begin [/View [/XYZ H.V]/Dest (0:3968) cvn /DEST pdfmark end
 -2 1167 a 396
1494 a Fd(6.12.1.)36 b(Wh)n(y)d(make)i(FileMQ?)1888 1494
y
SDict begin H.S end
 1888 1494 a 1888 1494 a
SDict begin 18.72 H.A end
 1888 1494 a 1888 1494 a
SDict begin [/View [/XYZ H.V]/Dest (11.71.61.2) cvn /DEST pdfmark end
 1888
1494 a -2 1685 a
SDict begin H.S end
 -2 1685 a -2 1685 a
SDict begin 13 H.A end
 -2 1685 a -2 1685
a
SDict begin [/View [/XYZ H.V]/Dest (0:3970) cvn /DEST pdfmark end
 -2 1685 a 396 1768 a Fj(Why)20 b(mak)o(e)g(a)g(\002le)h(distrib)n
(ution)e(system?)h(I)h(already)e(e)o(xplained)f(ho)n(w)i(to)g(send)g
(lar)o(ge)f(\002les)j(o)o(v)o(er)c(\330MQ,)j(and)e(it')-5
b(s)396 1876 y(really)20 b(quite)g(simple.)g(But)h(if)f(you)f(w)o(ant)i
(to)f(mak)o(e)g(messaging)f(accessible)h(to)h(a)f(million)g(times)h
(more)e(people)g(than)396 1984 y(can)h(use)h(\330MQ,)f(you)f(need)h
(another)e(kind)i(of)g(API.)g(An)g(API)h(that)f(my)g(\002)n(v)o(e-year)
e(old)i(son)g(can)g(understand.)e(An)i(API)396 2092 y(that)h(is)g(uni)n
(v)o(ersal,)d(requires)h(no)h(programming,)d(and)i(w)o(orks)h(with)g
(just)h(about)e(e)n(v)o(ery)g(single)h(application.)-2
2276 y
SDict begin H.S end
 -2 2276 a -2 2276 a
SDict begin 13 H.A end
 -2 2276 a -2 2276 a
SDict begin [/View [/XYZ H.V]/Dest (0:3971) cvn /DEST pdfmark end
 -2 2276
a 396 2365 a Fj(Y)-8 b(es,)21 b(I'm)e(talking)h(about)f(the)h(\002le)h
(system.)f(It')-5 b(s)21 b(the)f(DropBox)f(pattern:)g(chuck)g(your)g
(\002les)i(some)n(where,)e(and)g(the)o(y)396 2473 y(get)h(magically)g
(copied)f(some)n(where)g(else,)h(when)g(the)g(netw)o(ork)f(connects)g
(again.)-2 2657 y
SDict begin H.S end
 -2 2657 a -2 2657 a
SDict begin 13 H.A end
 -2 2657 a -2 2657
a
SDict begin [/View [/XYZ H.V]/Dest (0:3972) cvn /DEST pdfmark end
 -2 2657 a 396 2747 a Fj(Ho)n(we)n(v)o(er)g(what)h(I'm)g(aiming)f(for)
h(is)h(a)f(fully)g(decentralized)e(architecture)h(that)h(looks)g(more)f
(lik)o(e)i(git,)f(that)g(doesn')o(t)396 2855 y(need)g(an)o(y)f(cloud)g
(services)i(\(though)d(we)i(could)f(put)h(FileMQ)h(in)f(the)g(cloud\),)
f(and)h(which)f(does)h(multicast,)g(i.e.)g(can)396 2963
y(send)g(\002les)h(to)g(man)o(y)e(places)h(at)h(once.)-2
3147 y
SDict begin H.S end
 -2 3147 a -2 3147 a
SDict begin 13 H.A end
 -2 3147 a -2 3147 a
SDict begin [/View [/XYZ H.V]/Dest (0:3973) cvn /DEST pdfmark end
 -2 3147
a 396 3237 a Fj(FileMQ)g(has)f(to)h(be)f(secure\(able\),)e(has)i(to)h
(be)f(easily)g(hook)o(ed)f(into)h(random)e(scripting)h(languages,)g
(and)g(has)i(to)f(be)g(as)396 3345 y(f)o(ast)h(as)g(possible)f(across)g
(our)g(domestic)f(and)h(of)n(\002ce)f(netw)o(orks.)-2
3529 y
SDict begin H.S end
 -2 3529 a -2 3529 a
SDict begin 13 H.A end
 -2 3529 a -2 3529 a
SDict begin [/View [/XYZ H.V]/Dest (0:3974) cvn /DEST pdfmark end
 -2 3529
a 396 3619 a Fj(I)i(w)o(ant)f(to)g(use)h(it)g(to)f(back-up)e(photos)h
(from)h(my)f(mobile)h(phone)e(to)j(my)f(laptop,)f(o)o(v)o(er)f(W)m
(iFi.)j(T)-7 b(o)21 b(share)f(presentation)396 3727 y(slides)h(in)f
(real-time)g(across)g(\002fty)g(laptops)g(in)g(a)h(conference.)d(T)-7
b(o)20 b(share)g(documents)e(with)j(colleagues)e(in)h(a)h(meeting.)396
3835 y(T)-7 b(o)21 b(send)f(earthquak)o(e)e(data)i(from)f(sensors)h(to)
g(central)g(clusters.)g(T)-7 b(o)21 b(back-up)d(video)h(from)g(my)h
(phone)f(as)i(I)f(tak)o(e)g(it,)396 3943 y(during)f(protests)h(or)g
(riots.)g(T)-7 b(o)20 b(synchronize)e(con\002guration)g(\002les)j
(across)f(a)h(cloud)e(of)h(Linux)f(serv)o(ers.)-2 4127
y
SDict begin H.S end
 -2 4127 a -2 4127 a
SDict begin 13 H.A end
 -2 4127 a -2 4127 a
SDict begin [/View [/XYZ H.V]/Dest (0:3975) cvn /DEST pdfmark end
 -2 4127 a 396
4217 a Fj(A)i(visionary)e(idea,)h(isn')o(t)f(it?)i(W)-7
b(ell,)21 b(ideas)g(are)f(cheap.)f(The)h(hard)f(part)h(is)h(making)e
(this,)h(and)g(making)f(it)i(simple.)-2 4245 y
SDict begin H.S end
 -2 4245
a -2 4245 a
SDict begin 13 H.A end
 -2 4245 a -2 4245 a
SDict begin [/View [/XYZ H.V]/Dest (0:3976) cvn /DEST pdfmark end
 -2 4245 a 396 4555 a
Fd(6.12.2.)36 b(Initial)f(Design)f(Cut)g(-)f(the)g(API)2289
4555 y
SDict begin H.S end
 2289 4555 a 2289 4555 a
SDict begin 18.72 H.A end
 2289 4555 a 2289 4555
a
SDict begin [/View [/XYZ H.V]/Dest (11.71.62.2) cvn /DEST pdfmark end
 2289 4555 a -2 4748 a
SDict begin H.S end
 -2 4748 a -2 4748 a
SDict begin 13 H.A end
 -2 4748 a
-2 4748 a
SDict begin [/View [/XYZ H.V]/Dest (0:3978) cvn /DEST pdfmark end
 -2 4748 a 396 4829 a Fj(Here')-5 b(s)21 b(the)f(w)o(ay)g(I)h
(see)f(the)h(\002rst)f(design.)g(FileMQ)g(has)h(to)f(be)g(distrib)n
(uted,)f(so)i(e)n(v)o(ery)e(node)g(can)h(be)g(a)h(serv)o(er)e(and)h(a)
396 4937 y(client)g(at)h(the)f(same)h(time.)f(But)h(I)f(don')o(t)f(w)o
(ant)h(the)g(protocol)f(to)h(be)g(symmetric,)f(because)h(that)g(seems)g
(forced.)f(W)-7 b(e)396 5045 y(ha)n(v)o(e)20 b(a)g(natural)g(\003o)n(w)
g(of)g(\002les)h(from)e(point)h(A)g(to)h(point)e(B,)i(where)f(A)g(is)i
(the)e("serv)o(er")f(and)g(B)j(is)f(the)f("client".)g(If)g(\002les)p
Black 3759 5569 a Fi(295)p Black eop end
%%Page: 296 310
TeXDict begin 296 309 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.296) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 396 72 a Fj(\003o)n(w)i(back)e(the)h(other)g(w)o(ay)-5
b(,)19 b(we)i(ha)n(v)o(e)e(tw)o(o)i(\003o)n(ws.)f(So,)g(FileMQ)h(is)
2372 72 y
SDict begin H.S end
 2372 72 a 2372 72 a
SDict begin 13 H.A end
 2372 72 a 2372 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:3979) cvn /DEST pdfmark end
 2372
72 a Fi(not)h Fj(a)e(synchronization)d(protocol,)h(though)396
180 y(synchronizing)f(tw)o(o)k(directories)e(is)i(going)e(to)h(be)h(a)f
(common)e(use)j(case.)396 454 y(Thus,)f(I'm)f(going)g(to)i(b)n(uild)e
(FileMQ)i(as)g(tw)o(o)g(pieces:)f(a)g(client,)g(and)g(a)h(serv)o(er)-5
b(.)19 b(Then,)g(I')o(ll)i(put)f(these)g(together)f(in)h(a)396
562 y(main)g(application)f(\(the)h("\002lemq")f(tool\))h(that)g(can)g
(act)h(both)e(as)i(client)f(and)g(serv)o(er)-5 b(.)19
b(The)h(tw)o(o)h(pieces)f(will)h(look)e(quite)396 670
y(similar)i(to)f(the)g(nom_serv)o(er)m(,)d(with)j(the)h(same)f(kind)f
(of)h(API:)-2 765 y
SDict begin H.S end
 -2 765 a -2 765 a
SDict begin 11.7 H.A end
 -2 765 a -2 765
a
SDict begin [/View [/XYZ H.V]/Dest (0:3981) cvn /DEST pdfmark end
 -2 765 a 396 850 a Fg(fmq_server_t)979 863 y(*)1024
850 y(server)44 b(=)g(fmq_server_new)f(\(\);)396 948
y(fmq_server_bind)g(\(server,)g("tcp://)1832 961 y(*)1877
948 y(:6000"\);)396 1045 y(fmq_server_publish)f(\(server,)i
("/home/ph/filemq/share",)c("/public"\);)396 1142 y(fmq_server_publish)
i(\(server,)i("/home/ph/photos/stream",)c("/photostream"\);)396
1336 y(fmq_client_t)979 1349 y(*)1024 1336 y(client)k(=)g
(fmq_client_new)f(\(\);)396 1433 y(fmq_client_connect)f(\(client,)i
("tcp://pieter.filemq.org:6000"\);)396 1530 y(fmq_client_subscribe)e
(\(server,)h("/public/",)g("/home/ph/filemq/share"\);)396
1627 y(fmq_client_subscribe)f(\(server,)h("/photostream/",)f
("/home/ph/photos/stream"\);)396 1822 y(while)i(\(!zctx_interrupted\))
576 1919 y(sleep)g(\(1\);)396 2113 y(fmq_server_destroy)e(\(&server\);)
396 2210 y(fmq_client_destroy)g(\(&client\);)-2 2388
y
SDict begin H.S end
 -2 2388 a -2 2388 a
SDict begin 13 H.A end
 -2 2388 a -2 2388 a
SDict begin [/View [/XYZ H.V]/Dest (0:3982) cvn /DEST pdfmark end
 -2 2388 a 396
2484 a Fj(If)20 b(we)h(wrap)f(this)g(C)h(API)g(in)f(other)g(languages,)
e(we)j(can)f(easily)g(script)g(FileMQ,)h(embed)e(it)i(applications,)e
(port)g(it)i(to)396 2592 y(smartphones,)d(and)i(so)h(on.)-2
2621 y
SDict begin H.S end
 -2 2621 a -2 2621 a
SDict begin 13 H.A end
 -2 2621 a -2 2621 a
SDict begin [/View [/XYZ H.V]/Dest (0:3983) cvn /DEST pdfmark end
 -2 2621
a 396 2931 a Fd(6.12.3.)36 b(Initial)f(Design)f(Cut)g(-)f(the)g(Pr)n
(otocol)2573 2931 y
SDict begin H.S end
 2573 2931 a 2573 2931 a
SDict begin 18.72 H.A end
 2573 2931
a 2573 2931 a
SDict begin [/View [/XYZ H.V]/Dest (11.71.63.2) cvn /DEST pdfmark end
 2573 2931 a -2 3123 a
SDict begin H.S end
 -2 3123 a -2 3123
a
SDict begin 13 H.A end
 -2 3123 a -2 3123 a
SDict begin [/View [/XYZ H.V]/Dest (0:3985) cvn /DEST pdfmark end
 -2 3123 a 396 3205 a Fj(T)-7 b(o)21
b(start)f(with)h(we)f(write)h(do)n(wn)e(the)h(protocol)e(as)j(an)f
(ABNF)i(grammar)-5 b(.)18 b(Our)i(grammar)f(starts)i(with)f(the)g
(\003o)n(w)h(of)396 3313 y(commands)e(between)g(the)h(client)h(and)e
(serv)o(er)-5 b(.)20 b(Y)-9 b(ou)19 b(should)g(recognize)g(these)h(as)h
(a)g(combination)d(of)i(the)g(v)n(arious)396 3421 y(techniques)f(we')l
(v)o(e)g(seen)i(already:)-2 3522 y
SDict begin H.S end
 -2 3522 a -2 3522
a
SDict begin 11.7 H.A end
 -2 3522 a -2 3522 a
SDict begin [/View [/XYZ H.V]/Dest (0:3986) cvn /DEST pdfmark end
 -2 3522 a 396 3601 a Fg(filemq-protocol)43
b(=)h(open-peering)1786 3614 y(*)1831 3601 y(use-peering)f([)i
(close-peering)d(])396 3795 y(open-peering)178 b(=)44
b(C:OHAI)1517 3808 y(*)1562 3795 y(\()h(S:ORLY)e(C:YARLY)h(\))h(\()f
(S:OHAI-OK)g(/)g(error)g(\))396 3989 y(use-peering)223
b(=)44 b(C:ICANHAZ)g(\()g(S:ICANHAZ-OK)f(/)i(error)f(\))1114
4086 y(/)g(C:NOM)1114 4183 y(/)g(S:CHEEZBURGER)1114 4281
y(/)g(C:HUGZ)g(S:HUGZ-OK)1114 4378 y(/)g(S:HUGZ)g(C:HUGZ-OK)396
4572 y(close-peering)133 b(=)44 b(C:KTHXBAI)g(/)g(S:KTHXBAI)396
4766 y(error)493 b(=)44 b(S:SRSLY)g(/)h(S:RTFM)-2 4938
y
SDict begin H.S end
 -2 4938 a -2 4938 a
SDict begin 13 H.A end
 -2 4938 a -2 4938 a
SDict begin [/View [/XYZ H.V]/Dest (0:3987) cvn /DEST pdfmark end
 -2 4938 a 396
5040 a Fj(Here)20 b(are)g(the)h(messages)f(to)g(and)g(from)f(the)h
(serv)o(er:)p Black 3757 5569 a Fi(296)p Black eop end
%%Page: 297 311
TeXDict begin 297 310 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.297) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:3990) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3988) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fg(;)135 b(The)44 b(client)g(opens)g(peering)f(to)i(the)
f(server)396 170 y(OHAI)538 b(=)44 b(\045x01)g(protocol)g(version)g
(identity)396 267 y(protocol)358 b(=)44 b(string)358
b(;)45 b(Must)f(be)g("FILEMQ")396 364 y(string)448 b(=)44
b(size)1427 377 y(*)1472 364 y(VCHAR)396 461 y(size)538
b(=)44 b(OCTET)396 558 y(version)403 b(=)44 b(\045x01)396
655 y(identity)358 b(=)44 b(16OCTET)396 850 y(;)135 b(The)44
b(server)g(challenges)f(the)h(client)g(using)g(the)g(SASL)h(model)396
947 y(ORLY)538 b(=)44 b(\045x02)g(mechanisms)g(challenge)396
1044 y(mechanisms)268 b(=)44 b(size)g(1)1472 1057 y(*)1517
1044 y(mechanism)396 1141 y(mechanism)313 b(=)44 b(string)396
1238 y(challenge)313 b(=)1203 1251 y(*)1248 1238 y(OCTET)358
b(;)45 b(0MQ)f(frame)396 1432 y(;)135 b(The)44 b(client)g(responds)f
(with)h(SASL)h(authentication)d(information)396 1530
y(YARLY)493 b(=)44 b(\045x03)g(mechanism)g(response)396
1627 y(response)358 b(=)1203 1640 y(*)1248 1627 y(OCTET)g(;)45
b(0MQ)f(frame)396 1821 y(;)135 b(The)44 b(server)g(grants)g(the)g
(client)g(access)396 1918 y(OHAI-OK)403 b(=)44 b(\045x04)396
2112 y(;)135 b(The)44 b(client)g(subscribes)f(to)h(a)h(path)396
2209 y(ICANHAZ)403 b(=)44 b(\045x05)g(path)h(options)396
2307 y(path)538 b(=)44 b(string)358 b(;)45 b(Full)f(or)g(partial)g
(path)396 2404 y(options)403 b(=)44 b(dictionary)396
2501 y(dictionary)268 b(=)44 b(size)1427 2514 y(*)1472
2501 y(key-value)396 2598 y(key-value)313 b(=)44 b(string)358
b(;)45 b(Formatted)e(as)h(name=value)396 2792 y(;)135
b(The)44 b(server)g(confirms)f(the)i(subscription)396
2889 y(ICANHAZ-OK)268 b(=)44 b(\045x06)396 3084 y(;)135
b(The)44 b(client)g(sends)g(credit)g(to)g(the)g(server)396
3181 y(NOM)583 b(=)44 b(\045x07)g(credit)396 3278 y(credit)448
b(=)44 b(number)396 3375 y(number)448 b(=)44 b(8OCTET)358
b(;)45 b(64-bit)e(integer,)h(network)g(order)396 3472
y(sequence)358 b(=)44 b(number)396 3666 y(;)135 b(The)44
b(server)g(sends)g(a)g(chunk)g(of)h(file)f(data)396 3764
y(CHEEZBURGER)223 b(=)44 b(\045x08)g(sequence)g(operation)f(filename)
1203 3861 y(offset)h(headers)g(chunk)396 3958 y(sequence)358
b(=)44 b(number)396 4055 y(operation)313 b(=)44 b(OCTET)396
4152 y(filename)358 b(=)44 b(string)396 4249 y(offset)448
b(=)44 b(number)396 4346 y(headers)403 b(=)44 b(dictionary)396
4444 y(chunk)493 b(=)44 b(FRAME)396 4638 y(;)135 b(Client)43
b(or)i(server)f(sends)g(a)g(heartbeat,)g(the)g(other)g(peer)g(responds)
396 4735 y(HUGZ)538 b(=)44 b(\045x09)396 4832 y(HUGZ-OK)403
b(=)44 b(\045x0A)396 5026 y(;)135 b(Client)43 b(closes)h(the)h(peering)
396 5124 y(KTHXBAI)403 b(=)44 b(\045x0B)p Black 3756
5569 a Fi(297)p Black eop end
%%Page: 298 312
TeXDict begin 298 311 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.298) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4016) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:3989) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(And)h(here)g(are)g(the)g(dif)n(ferent)e(w)o(ays)j
(the)f(serv)o(er)g(can)g(tell)g(the)h(client)f(things)g(went)g(wrong:)
396 253 y Fg(;)135 b(Server)43 b(error)h(replies)396
350 y(S:SRSLY)403 b(=)44 b(\045x80)g(reason)179 b(;)44
b(Refused)g(due)g(to)h(access)f(rights)396 447 y(S:RTFM)448
b(=)44 b(\045x81)g(reason)179 b(;)44 b(Client)g(sent)g(an)h(invalid)f
(command)-2 621 y
SDict begin H.S end
 -2 621 a -2 621 a
SDict begin 13 H.A end
 -2 621 a -2 621 a
SDict begin [/View [/XYZ H.V]/Dest (0:3991) cvn /DEST pdfmark end

-2 621 a 396 721 a Fj(The)20 b(FILEMQ/1.0)f(protocol)f(is)j
(speci\002ed)f(on)g(the)1918 721 y
SDict begin H.S end
 1918 721 a 1918 721
a
SDict begin 13 H.A end
 1918 721 a 1918 721 a
SDict begin [/View [/XYZ H.V]/Dest (0:3992) cvn /DEST pdfmark end
 1918 721 a Fj(\330MQ)h(unprotocols)c(website)k
(\(http://rfc.zeromq.or)o(g/spe)o(c:19)o(\).)-2 749 y
SDict begin H.S end

-2 749 a -2 749 a
SDict begin 13 H.A end
 -2 749 a -2 749 a
SDict begin [/View [/XYZ H.V]/Dest (0:3993) cvn /DEST pdfmark end
 -2 749 a 396 1059
a Fd(6.12.4.)36 b(Building)f(and)e(T)-10 b(r)q(ying)35
b(FileMQ)2341 1059 y
SDict begin H.S end
 2341 1059 a 2341 1059 a
SDict begin 18.72 H.A end
 2341 1059
a 2341 1059 a
SDict begin [/View [/XYZ H.V]/Dest (11.71.64.2) cvn /DEST pdfmark end
 2341 1059 a -2 1252 a
SDict begin H.S end
 -2 1252 a -2 1252
a
SDict begin 13 H.A end
 -2 1252 a -2 1252 a
SDict begin [/View [/XYZ H.V]/Dest (0:3995) cvn /DEST pdfmark end
 -2 1252 a 396 1333 a Fj(The)19
b(FileMQ)h(stack)f(is)1093 1333 y
SDict begin H.S end
 1093 1333 a 1093 1333
a
SDict begin 13 H.A end
 1093 1333 a 1093 1333 a
SDict begin [/View [/XYZ H.V]/Dest (0:3996) cvn /DEST pdfmark end
 1093 1333 a Fj(on)g(github)f
(\(https://github)m(.com/hintjens/\002lemq\).)c(It)19
b(w)o(orks)g(lik)o(e)h(a)f(classic)h(C/C++)h(project:)-2
1434 y
SDict begin H.S end
 -2 1434 a -2 1434 a
SDict begin 11.7 H.A end
 -2 1434 a -2 1434 a
SDict begin [/View [/XYZ H.V]/Dest (0:3997) cvn /DEST pdfmark end
 -2 1434
a 396 1513 a Fg(git)45 b(clone)f(git://github.com/hintjens/filemq.git)
396 1611 y(cd)h(filemq)396 1708 y(./autogen.sh)396 1805
y(./configure)396 1902 y(make)f(check)-2 2069 y
SDict begin H.S end
 -2 2069
a -2 2069 a
SDict begin 13 H.A end
 -2 2069 a -2 2069 a
SDict begin [/View [/XYZ H.V]/Dest (0:3998) cvn /DEST pdfmark end
 -2 2069 a 396 2176 a
Fj(Y)-9 b(ou)20 b(w)o(ant)g(to)h(be)f(using)f(the)i(latest)g(CZMQ)f
(master)g(for)g(this.)g(No)n(w)g(try)g(running)e(the)2912
2176 y
SDict begin H.S end
 2912 2176 a 2912 2176 a
SDict begin 13 H.A end
 2912 2176 a 2912 2176
a
SDict begin [/View [/XYZ H.V]/Dest (0:3999) cvn /DEST pdfmark end
 2912 2176 a Fg(track)h Fj(command,)f(which)i(is)h(a)396
2284 y(simple)f(tool)g(that)h(uses)f(FileMQ)h(to)f(track)g(changes)f
(in)i(one)e(directory)g(in)h(another:)-2 2385 y
SDict begin H.S end
 -2 2385
a -2 2385 a
SDict begin 11.7 H.A end
 -2 2385 a -2 2385 a
SDict begin [/View [/XYZ H.V]/Dest (0:4000) cvn /DEST pdfmark end
 -2 2385 a 396 2464 a
Fg(cd)45 b(src)396 2561 y(./track)f(./fmqroot/send)e(./fmqroot/recv)-2
2739 y
SDict begin H.S end
 -2 2739 a -2 2739 a
SDict begin 13 H.A end
 -2 2739 a -2 2739 a
SDict begin [/View [/XYZ H.V]/Dest (0:4001) cvn /DEST pdfmark end
 -2 2739
a 396 2835 a Fj(And)20 b(open)f(tw)o(o)i(\002le)f(na)n(vigator)f(windo)
n(ws,)g(one)h(into)1975 2835 y
SDict begin H.S end
 1975 2835 a 1975 2835
a
SDict begin 13 H.A end
 1975 2835 a 1975 2835 a
SDict begin [/View [/XYZ H.V]/Dest (0:4002) cvn /DEST pdfmark end
 1975 2835 a Fg(src/fmqroot/send)f
Fj(and)g(one)h(into)3145 2835 y
SDict begin H.S end
 3145 2835 a 3145 2835
a
SDict begin 13 H.A end
 3145 2835 a 3145 2835 a
SDict begin [/View [/XYZ H.V]/Dest (0:4003) cvn /DEST pdfmark end
 3145 2835 a Fg(src/fmqroot/recv)p
Fj(.)396 2943 y(Drop)g(\002les)h(into)f(the)g(send)g(folder)f(and)h
(you')o(ll)f(see)i(them)e(arri)n(v)o(e)g(in)i(the)f(recv)g(folder)-5
b(.)19 b(The)h(serv)o(er)f(checks)h(once)f(per)396 3051
y(second)h(for)f(ne)n(w)h(\002les.)h(Delete)f(\002les)i(in)e(the)g
(send)g(folder)m(,)f(and)g(the)o(y')l(re)g(deleted)g(in)i(the)f(recv)f
(folder)g(similarly)-5 b(.)-2 3235 y
SDict begin H.S end
 -2 3235 a -2 3235
a
SDict begin 13 H.A end
 -2 3235 a -2 3235 a
SDict begin [/View [/XYZ H.V]/Dest (0:4004) cvn /DEST pdfmark end
 -2 3235 a 396 3325 a Fj(I)21 b(use)f(track)g(for)
f(things)h(lik)o(e)h(updating)d(my)i(MP3)g(player)f(mounted)g(as)h(a)h
(USB)g(dri)n(v)o(e.)e(As)i(I)f(add)g(or)g(remo)o(v)o(e)e(\002les)j(in)
396 3433 y(my)f(laptop')-5 b(s)20 b(Music)g(folder)m(,)f(the)h(same)g
(changes)f(happen)g(on)h(the)g(MP3)g(player)-5 b(.)19
b(FILEMQ)h(isn')o(t)g(a)h(full)f(replication)396 3541
y(protocol)f(it)i(might)e(become)g(one.)-2 3569 y
SDict begin H.S end
 -2
3569 a -2 3569 a
SDict begin 13 H.A end
 -2 3569 a -2 3569 a
SDict begin [/View [/XYZ H.V]/Dest (0:4005) cvn /DEST pdfmark end
 -2 3569 a 396 3879
a Fd(6.12.5.)36 b(Internal)e(Ar)n(c)o(hitecture)1960
3879 y
SDict begin H.S end
 1960 3879 a 1960 3879 a
SDict begin 18.72 H.A end
 1960 3879 a 1960 3879
a
SDict begin [/View [/XYZ H.V]/Dest (11.71.65.2) cvn /DEST pdfmark end
 1960 3879 a -2 4047 a
SDict begin H.S end
 -2 4047 a -2 4047 a
SDict begin 13 H.A end
 -2 4047 a
-2 4047 a
SDict begin [/View [/XYZ H.V]/Dest (0:4007) cvn /DEST pdfmark end
 -2 4047 a 396 4153 a Fj(T)-7 b(o)21 b(b)n(uild)e(FileMQ)i(I)f
(used)g(a)h(lot)f(of)g(code)g(generation,)e(possibly)h(too)h(much.)f
(Ho)n(we)n(v)o(er)g(the)h(code)g(generators)e(are)i(all)396
4261 y(reusable)g(in)g(other)f(stacks.)i(The)o(y)e(are)h(an)g(e)n(v)n
(olution)f(of)h(the)g(set)h(we)f(sa)o(w)h(earlier:)-2
4279 y
SDict begin H.S end
 -2 4279 a -2 4279 a
SDict begin 13 H.A end
 -2 4279 a -2 4279 a
SDict begin [/View [/XYZ H.V]/Dest (0:4008) cvn /DEST pdfmark end
 -2 4279
a -2 4289 a
SDict begin H.S end
 -2 4289 a -2 4289 a
SDict begin 13 H.A end
 -2 4289 a -2 4289 a
SDict begin [/View [/XYZ H.V]/Dest (0:4009) cvn /DEST pdfmark end
 -2
4289 a Black 396 4431 a Fe(\225)p Black 479 4431 a
SDict begin H.S end
 479
4431 a 479 4431 a
SDict begin 13 H.A end
 479 4431 a 479 4431 a
SDict begin [/View [/XYZ H.V]/Dest (0:4010) cvn /DEST pdfmark end
 479 4431 a Fj(codec_c.gsl)e(-)h
(generates)f(a)i(message)f(codec)f(for)h(a)g(gi)n(v)o(en)f(protocol.)-2
4449 y
SDict begin H.S end
 -2 4449 a -2 4449 a
SDict begin 13 H.A end
 -2 4449 a -2 4449 a
SDict begin [/View [/XYZ H.V]/Dest (0:4011) cvn /DEST pdfmark end
 -2 4449
a Black 396 4581 a Fe(\225)p Black 479 4581 a
SDict begin H.S end
 479 4581
a 479 4581 a
SDict begin 13 H.A end
 479 4581 a 479 4581 a
SDict begin [/View [/XYZ H.V]/Dest (0:4012) cvn /DEST pdfmark end
 479 4581 a Fj(serv)o(er_c.gsl)g(-)h
(generates)f(a)i(serv)o(er)e(class)i(for)f(a)h(protocol)d(and)i(state)h
(machine.)-2 4599 y
SDict begin H.S end
 -2 4599 a -2 4599 a
SDict begin 13 H.A end
 -2 4599 a -2
4599 a
SDict begin [/View [/XYZ H.V]/Dest (0:4013) cvn /DEST pdfmark end
 -2 4599 a Black 396 4730 a Fe(\225)p Black 479
4730 a
SDict begin H.S end
 479 4730 a 479 4730 a
SDict begin 13 H.A end
 479 4730 a 479 4730 a
SDict begin [/View [/XYZ H.V]/Dest (0:4014) cvn /DEST pdfmark end
 479
4730 a Fj(client_c.gsl)f(-)g(generates)f(a)i(client)f(class)h(for)f(a)g
(protocol)f(and)g(state)i(machine.)p Black 3759 5569
a Fi(298)p Black eop end
%%Page: 299 313
TeXDict begin 299 312 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.299) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4015) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)h(best)h(w)o(ay)f(to)g(learn)g(to)g(use)h(GSL)f
(code)g(generation)e(is)j(to)f(translate)g(these)h(into)f(a)g(language)
f(of)h(your)f(choice)g(and)396 180 y(mak)o(e)h(your)f(o)n(wn)h(demo)f
(protocols)g(and)g(stacks.)i(Y)-9 b(ou')o(ll)19 b(\002nd)h(it)h(f)o
(airly)f(easy)-5 b(.)19 b(FileMQ)i(itself)g(doesn')o(t)e(try)h(to)g
(support)396 288 y(multiple)g(languages.)e(It)j(could)e(b)n(ut)h(it')l
(d)g(mak)o(e)g(things)g(needlessly)f(comple)o(x.)396
562 y(The)g(FileMQ)h(architecture)e(actually)h(slices)h(into)g(tw)o(o)f
(layers.)g(There')-5 b(s)19 b(a)h(generic)e(set)j(of)e(classes)h(to)g
(handle)e(chunks,)396 670 y(directories,)h(\002les,)i(patches,)f(SASL)g
(security)-5 b(,)19 b(and)h(con\002guration)d(\002les.)k(Then,)e
(there')-5 b(s)21 b(the)f(generated)e(stack:)396 778
y(messages,)i(client,)g(and)g(serv)o(er)-5 b(.)19 b(If)i(I)f(w)o(as)h
(creating)e(a)i(ne)n(w)f(project)f(I')l(d)g(fork)h(the)g(whole)f
(FileMQ)i(project,)e(and)h(go)396 886 y(and)g(modify)f(the)h(three)f
(models:)-2 904 y
SDict begin H.S end
 -2 904 a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:4017) cvn /DEST pdfmark end

-2 904 a -2 914 a
SDict begin H.S end
 -2 914 a -2 914 a
SDict begin 13 H.A end
 -2 914 a -2 914 a
SDict begin [/View [/XYZ H.V]/Dest (0:4018) cvn /DEST pdfmark end

-2 914 a Black 396 1056 a Fe(\225)p Black 479 1056 a
SDict begin H.S end

479 1056 a 479 1056 a
SDict begin 13 H.A end
 479 1056 a 479 1056 a
SDict begin [/View [/XYZ H.V]/Dest (0:4019) cvn /DEST pdfmark end
 479 1056
a Fj(fmq_msg.xml)f(-)i(which)g(de\002nes)g(the)g(message)g(formats)-2
1074 y
SDict begin H.S end
 -2 1074 a -2 1074 a
SDict begin 13 H.A end
 -2 1074 a -2 1074 a
SDict begin [/View [/XYZ H.V]/Dest (0:4020) cvn /DEST pdfmark end
 -2 1074
a Black 396 1206 a Fe(\225)p Black 479 1206 a
SDict begin H.S end
 479 1206
a 479 1206 a
SDict begin 13 H.A end
 479 1206 a 479 1206 a
SDict begin [/View [/XYZ H.V]/Dest (0:4021) cvn /DEST pdfmark end
 479 1206 a Fj(fmq_client.xml)e(-)i
(which)g(de\002nes)g(the)g(client)g(state)h(machine,)e(API,)h(and)g
(implementation.)-2 1224 y
SDict begin H.S end
 -2 1224 a -2 1224 a
SDict begin 13 H.A end
 -2 1224
a -2 1224 a
SDict begin [/View [/XYZ H.V]/Dest (0:4022) cvn /DEST pdfmark end
 -2 1224 a Black 396 1355 a Fe(\225)p Black
479 1355 a
SDict begin H.S end
 479 1355 a 479 1355 a
SDict begin 13 H.A end
 479 1355 a 479 1355
a
SDict begin [/View [/XYZ H.V]/Dest (0:4023) cvn /DEST pdfmark end
 479 1355 a Fj(fmq_serv)o(er)-5 b(.xml)17 b(-)k(which)e(does)h(the)g
(same)h(for)e(the)i(serv)o(er)-5 b(.)-2 1539 y
SDict begin H.S end
 -2 1539
a -2 1539 a
SDict begin 13 H.A end
 -2 1539 a -2 1539 a
SDict begin [/View [/XYZ H.V]/Dest (0:4024) cvn /DEST pdfmark end
 -2 1539 a 396 1629 a
Fj(Y)c(ou')l(d)19 b(w)o(ant)h(to)h(rename)e(things,)g(to)h(a)n(v)n(oid)
g(confusion.)e(Why)i(didn')o(t)f(I)h(mak)o(e)g(the)g(reusable)f
(classes)j(into)e(a)g(separate)396 1737 y(library?)f(The)h(answer)g(is)
h(tw)o(o-fold.)e(First,)h(no-one)f(actually)g(needs)h(this)h(\(yet\).)e
(Second,)g(it')l(d)h(mak)o(e)g(things)f(more)396 1845
y(comple)o(x)g(for)g(you)h(as)g(you)g(b)n(uild)g(and)f(play)h(with)g
(FileMQ.)h(It')-5 b(s)21 b(ne)n(v)o(er)d(w)o(orth)i(adding)f(comple)o
(xity)f(to)i(solv)o(e)g(a)396 1953 y(theoretical)f(problem.)-2
2137 y
SDict begin H.S end
 -2 2137 a -2 2137 a
SDict begin 13 H.A end
 -2 2137 a -2 2137 a
SDict begin [/View [/XYZ H.V]/Dest (0:4025) cvn /DEST pdfmark end
 -2 2137
a 396 2227 a Fj(Although)g(I)h(wrote)g(FileMQ)h(in)f(C,)h(it')-5
b(s)21 b(easy)f(to)h(map)e(to)i(other)e(languages.)g(It)h(is)h(quite)f
(amazing)f(ho)n(w)h(nice)g(C)396 2335 y(becomes)g(when)f(you)g(add)h
(CZMQ')-5 b(s)21 b(generic)e(zlist)i(and)f(zhash)g(containers,)e(and)i
(class)h(style.)g(Let)f(me)g(go)g(through)396 2443 y(the)g(classes)i
(quickly:)-2 2461 y
SDict begin H.S end
 -2 2461 a -2 2461 a
SDict begin 13 H.A end
 -2 2461 a -2
2461 a
SDict begin [/View [/XYZ H.V]/Dest (0:4026) cvn /DEST pdfmark end
 -2 2461 a -2 2471 a
SDict begin H.S end
 -2 2471 a -2 2471 a
SDict begin 13 H.A end
 -2 2471
a -2 2471 a
SDict begin [/View [/XYZ H.V]/Dest (0:4027) cvn /DEST pdfmark end
 -2 2471 a Black 396 2613 a Fe(\225)p Black
479 2613 a
SDict begin H.S end
 479 2613 a 479 2613 a
SDict begin 13 H.A end
 479 2613 a 479 2613
a
SDict begin [/View [/XYZ H.V]/Dest (0:4028) cvn /DEST pdfmark end
 479 2613 a Fj(fmq_sasl:)e(encodes)f(and)h(decodes)f(a)h(SASL)h
(challenge.)e(I)h(only)g(implemented)e(the)i(PLAIN)g(mechanism,)f
(which)479 2721 y(is)i(enough)e(to)h(pro)o(v)o(e)e(the)i(concept.)-2
2739 y
SDict begin H.S end
 -2 2739 a -2 2739 a
SDict begin 13 H.A end
 -2 2739 a -2 2739 a
SDict begin [/View [/XYZ H.V]/Dest (0:4029) cvn /DEST pdfmark end
 -2 2739
a Black 396 2870 a Fe(\225)p Black 479 2870 a
SDict begin H.S end
 479 2870
a 479 2870 a
SDict begin 13 H.A end
 479 2870 a 479 2870 a
SDict begin [/View [/XYZ H.V]/Dest (0:4030) cvn /DEST pdfmark end
 479 2870 a Fj(fmq_chunk:)d(w)o(orks)
j(with)g(v)n(ariable)g(sized)g(blobs.)f(Not)i(as)g(ef)n(\002cient)e(as)
i(\330MQ')-5 b(s)21 b(messages)f(b)n(ut)h(the)o(y)e(do)h(less)479
2978 y(weirdness)g(and)g(so)g(are)g(easier)h(to)f(understand.)e(The)i
(chunk)e(class)k(has)e(methods)f(to)h(read)g(and)g(write)g(chunks)f
(from)479 3086 y(disk.)-2 3087 y
SDict begin H.S end
 -2 3087 a -2 3087 a
SDict begin 13 H.A end

-2 3087 a -2 3087 a
SDict begin [/View [/XYZ H.V]/Dest (0:4031) cvn /DEST pdfmark end
 -2 3087 a Black 396 3236 a Fe(\225)p
Black 479 3236 a
SDict begin H.S end
 479 3236 a 479 3236 a
SDict begin 13 H.A end
 479 3236 a 479
3236 a
SDict begin [/View [/XYZ H.V]/Dest (0:4032) cvn /DEST pdfmark end
 479 3236 a Fj(fmq_\002le:)g(w)o(orks)h(with)h(\002les,)g(which)e
(may)h(or)g(may)g(not)f(e)o(xist)i(on)f(disk.)f(Gi)n(v)o(es)i(you)e
(information)f(about)h(a)i(\002le)479 3344 y(\(lik)o(e)f(size\),)h
(lets)g(you)e(read)h(and)f(write)i(to)f(\002les,)h(remo)o(v)o(e)d
(\002les,)j(check)e(if)i(a)g(\002le)f(e)o(xists,)h(and)e(check)h(if)g
(a)h(\002le)g(is)479 3451 y("stable")f(\(more)f(on)h(that)h(later\).)-2
3466 y
SDict begin H.S end
 -2 3466 a -2 3466 a
SDict begin 13 H.A end
 -2 3466 a -2 3466 a
SDict begin [/View [/XYZ H.V]/Dest (0:4033) cvn /DEST pdfmark end
 -2 3466
a Black 396 3601 a Fe(\225)p Black 479 3601 a
SDict begin H.S end
 479 3601
a 479 3601 a
SDict begin 13 H.A end
 479 3601 a 479 3601 a
SDict begin [/View [/XYZ H.V]/Dest (0:4034) cvn /DEST pdfmark end
 479 3601 a Fj(fmq_dir:)e(w)o(orks)g
(with)i(directories,)e(reading)f(them)i(from)f(disk)i(and)e(comparing)f
(tw)o(o)j(directories)e(to)h(see)h(what)479 3709 y(changed.)d(When)i
(there)g(are)g(changes,)f(returns)h(a)g(list)h(of)f("patches".)-2
3727 y
SDict begin H.S end
 -2 3727 a -2 3727 a
SDict begin 13 H.A end
 -2 3727 a -2 3727 a
SDict begin [/View [/XYZ H.V]/Dest (0:4035) cvn /DEST pdfmark end
 -2 3727
a Black 396 3858 a Fe(\225)p Black 479 3858 a
SDict begin H.S end
 479 3858
a 479 3858 a
SDict begin 13 H.A end
 479 3858 a 479 3858 a
SDict begin [/View [/XYZ H.V]/Dest (0:4036) cvn /DEST pdfmark end
 479 3858 a Fj(fmq_patch:)e(w)o(orks)
i(with)g(one)f(patch,)h(which)f(really)h(just)g(says)h("create)e(this)i
(\002le")g(or)e("delete)h(this)h(\002le")f(\(referring)479
3966 y(to)h(a)f(fmq_\002le)f(item)i(each)f(time\).)-2
3984 y
SDict begin H.S end
 -2 3984 a -2 3984 a
SDict begin 13 H.A end
 -2 3984 a -2 3984 a
SDict begin [/View [/XYZ H.V]/Dest (0:4037) cvn /DEST pdfmark end
 -2 3984
a Black 396 4116 a Fe(\225)p Black 479 4116 a
SDict begin H.S end
 479 4116
a 479 4116 a
SDict begin 13 H.A end
 479 4116 a 479 4116 a
SDict begin [/View [/XYZ H.V]/Dest (0:4038) cvn /DEST pdfmark end
 479 4116 a Fj(fmq_con\002g:)e(w)o
(orks)i(with)g(con\002guration)e(data.)h(I')o(ll)i(come)e(back)h(to)g
(client)g(and)g(serv)o(er)f(con\002guration)f(later)-5
b(.)-2 4300 y
SDict begin H.S end
 -2 4300 a -2 4300 a
SDict begin 13 H.A end
 -2 4300 a -2 4300 a
SDict begin [/View [/XYZ H.V]/Dest (0:4039) cvn /DEST pdfmark end

-2 4300 a 396 4390 a Fj(Ev)o(ery)19 b(class)i(has)g(a)f(test)h(method,)
e(and)g(the)i(main)f(de)n(v)o(elopment)d(c)o(ycle)j(is)h("edit,)f
(test".)g(These)g(are)g(mostly)g(simple)396 4498 y(self)h(tests)g(b)n
(ut)f(the)o(y)g(mak)o(e)g(the)g(dif)n(ference)e(between)h(code)h(I)g
(can)g(trust.)g(and)g(code)g(I)g(kno)n(w)f(will)i(still)g(break.)e(It')
-5 b(s)21 b(a)396 4605 y(safe)g(bet)f(that)g(an)o(y)g(code)f(that)h
(isn')o(t)g(co)o(v)o(ered)e(by)i(a)h(test)g(case)f(will)h(ha)n(v)o(e)f
(undisco)o(v)o(ered)d(errors.)i(I'm)h(not)f(a)i(f)o(an)f(of)396
4713 y(e)o(xternal)f(test)i(harnesses.)f(But)h(internal)e(test)i(code)f
(that)g(you)f(write)i(as)f(you)g(write)g(your)f(functionality)-5
b(...)17 b(that')-5 b(s)21 b(lik)o(e)396 4821 y(the)f(handle)g(on)f(a)i
(knife.)p Black 3759 5569 a Fi(299)p Black eop end
%%Page: 300 314
TeXDict begin 300 313 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.300) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4040) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Y)-9 b(ou)19 b(should,)f(really)-5
b(,)19 b(be)g(able)g(to)h(read)e(the)i(source)e(code)h(and)g(rapidly)f
(understand)f(what)j(these)f(classes)i(are)e(doing.)f(If)396
180 y(you)i(can')o(t)f(read)g(the)i(code)e(happily)-5
b(,)18 b(tell)j(me.)f(If)g(you)f(w)o(ant)i(to)f(port)g(the)g(FileMQ)h
(implementation)c(into)j(other)396 288 y(languages,)f(start)h(by)g
(forking)e(the)j(whole)e(repository)g(and)g(later)i(we')o(ll)f(see)h
(if)f(it')-5 b(s)22 b(possible)e(to)g(do)g(this)g(in)h(one)396
396 y(o)o(v)o(erall)e(repo.)-2 425 y
SDict begin H.S end
 -2 425 a -2 425
a
SDict begin 13 H.A end
 -2 425 a -2 425 a
SDict begin [/View [/XYZ H.V]/Dest (0:4041) cvn /DEST pdfmark end
 -2 425 a 396 735 a Fd(6.12.6.)36
b(Pub)o(lic)e(API)1385 735 y
SDict begin H.S end
 1385 735 a 1385 735 a
SDict begin 18.72 H.A end
 1385
735 a 1385 735 a
SDict begin [/View [/XYZ H.V]/Dest (11.71.66.2) cvn /DEST pdfmark end
 1385 735 a -2 902 a
SDict begin H.S end
 -2 902 a -2 902
a
SDict begin 13 H.A end
 -2 902 a -2 902 a
SDict begin [/View [/XYZ H.V]/Dest (0:4043) cvn /DEST pdfmark end
 -2 902 a 396 1009 a Fj(The)20 b(public)f(API)i
(consists)g(of)f(tw)o(o)g(classes)h(\(as)g(we)f(sk)o(etched)g
(earlier\):)-2 1027 y
SDict begin H.S end
 -2 1027 a -2 1027 a
SDict begin 13 H.A end
 -2 1027 a -2
1027 a
SDict begin [/View [/XYZ H.V]/Dest (0:4044) cvn /DEST pdfmark end
 -2 1027 a -2 1037 a
SDict begin H.S end
 -2 1037 a -2 1037 a
SDict begin 13 H.A end
 -2 1037
a -2 1037 a
SDict begin [/View [/XYZ H.V]/Dest (0:4045) cvn /DEST pdfmark end
 -2 1037 a Black 396 1179 a Fe(\225)p Black
479 1179 a
SDict begin H.S end
 479 1179 a 479 1179 a
SDict begin 13 H.A end
 479 1179 a 479 1179
a
SDict begin [/View [/XYZ H.V]/Dest (0:4046) cvn /DEST pdfmark end
 479 1179 a Fj(fmq_client:)f(pro)o(vides)f(the)i(client)h(API,)f(with)
g(methods)f(to)i(connect)e(to)h(a)h(serv)o(er)m(,)d(con\002gure)h(the)h
(client,)g(and)479 1287 y(subscribe)g(to)g(paths.)-2
1305 y
SDict begin H.S end
 -2 1305 a -2 1305 a
SDict begin 13 H.A end
 -2 1305 a -2 1305 a
SDict begin [/View [/XYZ H.V]/Dest (0:4047) cvn /DEST pdfmark end
 -2 1305
a Black 396 1436 a Fe(\225)p Black 479 1436 a
SDict begin H.S end
 479 1436
a 479 1436 a
SDict begin 13 H.A end
 479 1436 a 479 1436 a
SDict begin [/View [/XYZ H.V]/Dest (0:4048) cvn /DEST pdfmark end
 479 1436 a Fj(fmq_serv)o(er:)e(pro)o
(vides)g(the)j(serv)o(er)e(API,)h(with)h(methods)e(to)h(bind)f(to)i(a)f
(port,)g(con\002gure)e(the)i(serv)o(er)m(,)f(and)h(publish)479
1544 y(a)h(path.)-2 1728 y
SDict begin H.S end
 -2 1728 a -2 1728 a
SDict begin 13 H.A end
 -2 1728
a -2 1728 a
SDict begin [/View [/XYZ H.V]/Dest (0:4049) cvn /DEST pdfmark end
 -2 1728 a 396 1818 a Fj(If)f(I)h(w)o(as)g(a)f(k)o(een)g
(young)e(de)n(v)o(eloper)g(eager)i(to)g(use)g(FileMQ)h(in)f(another)f
(language,)f(I')l(d)i(probably)e(spend)h(a)i(happ)o(y)396
1926 y(week)o(end)e(writing)h(a)g(binding)f(for)g(this)i(public)f(API,)
g(then)f(stick)i(it)g(in)f(a)h(subdirectory)d(of)i(the)g(\002lemq)g
(project)f(called,)396 2034 y(say)-5 b(,)20 b("bindings/",)e(and)i(mak)
o(e)g(a)g(pull)g(request.)-2 2218 y
SDict begin H.S end
 -2 2218 a -2 2218
a
SDict begin 13 H.A end
 -2 2218 a -2 2218 a
SDict begin [/View [/XYZ H.V]/Dest (0:4050) cvn /DEST pdfmark end
 -2 2218 a 396 2308 a Fj(The)g(actual)g(API)h
(methods)e(come)g(from)g(the)i(state)g(machine)e(description,)f(lik)o
(e)j(this)f(\(for)f(the)i(serv)o(er\):)-2 2409 y
SDict begin H.S end
 -2 2409
a -2 2409 a
SDict begin 11.7 H.A end
 -2 2409 a -2 2409 a
SDict begin [/View [/XYZ H.V]/Dest (0:4051) cvn /DEST pdfmark end
 -2 2409 a 396 2488 a
Fg(<method)44 b(name)g(=)h("bind">)396 2585 y(<argument)f(name)g(=)g
("endpoint")g(type)g(=)g("string")g(/>)396 2682 y(zmq_bind)g
(\(self->router,)e(endpoint\);)396 2780 y(</method>)396
2974 y(<method)i(name)g(=)h("publish">)396 3071 y(<argument)f(name)g(=)
g("location")g(type)g(=)g("string")g(/>)396 3168 y(<argument)g(name)g
(=)g("alias")g(type)g(=)h("string")e(/>)396 3265 y(mount_t)755
3278 y(*)800 3265 y(mount)h(=)g(mount_new)g(\(location,)f(alias\);)396
3362 y(zlist_append)g(\(self->mounts,)g(mount\);)396
3460 y(</method>)396 3654 y(<method)h(name)g(=)h("set)f(anonymous">)396
3751 y(<argument)g(name)g(=)g("access")g(type)g(=)h("number")e(/>)396
3848 y(//)90 b(Enable)43 b(anonymous)h(access)g(without)f(a)i(config)f
(file)396 3945 y(fmq_config_path_set)e(\(self->config,)g
("security/anonymous",)g(access?)h("1")i(:"0"\);)396
4042 y(</method>)-2 4131 y
SDict begin H.S end
 -2 4131 a -2 4131 a
SDict begin 13 H.A end
 -2 4131
a -2 4131 a
SDict begin [/View [/XYZ H.V]/Dest (0:4052) cvn /DEST pdfmark end
 -2 4131 a 396 4453 a Fd(6.12.7.)36 b(Design)f(Notes)1558
4453 y
SDict begin H.S end
 1558 4453 a 1558 4453 a
SDict begin 18.72 H.A end
 1558 4453 a 1558 4453
a
SDict begin [/View [/XYZ H.V]/Dest (11.71.67.2) cvn /DEST pdfmark end
 1558 4453 a -2 4646 a
SDict begin H.S end
 -2 4646 a -2 4646 a
SDict begin 13 H.A end
 -2 4646 a
-2 4646 a
SDict begin [/View [/XYZ H.V]/Dest (0:4054) cvn /DEST pdfmark end
 -2 4646 a 396 4727 a Fj(The)20 b(hardest)g(part)f(of)h
(making)f(FileMQ)i(w)o(asn')o(t)f(the)g(protocol)e(part,)i(b)n(ut)g
(maintaining)f(accurate)g(state)i(internally)-5 b(.)396
4835 y(An)20 b(FTP)h(or)f(HTTP)g(serv)o(er)g(is)h(essentially)f
(stateless.)h(But)g(a)g(publish/subscribe)d(serv)o(er)3011
4835 y
SDict begin H.S end
 3011 4835 a 3011 4835 a
SDict begin 13 H.A end
 3011 4835 a 3011 4835
a
SDict begin [/View [/XYZ H.V]/Dest (0:4055) cvn /DEST pdfmark end
 3011 4835 a Fi(has)i Fj(to)g(maintain)396 4943 y(subscriptions,)f(at)
i(least.)p Black 3759 5569 a Fi(300)p Black eop end
%%Page: 301 315
TeXDict begin 301 314 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.301) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4089) cvn /DEST pdfmark end
 -2 -201 a 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4056) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(So)i(I')o(ll)f(go)g(through)e(some)i(of)g(the)g
(design)g(aspects:)-2 90 y
SDict begin H.S end
 -2 90 a -2 90 a
SDict begin 13 H.A end
 -2 90 a -2
90 a
SDict begin [/View [/XYZ H.V]/Dest (0:4057) cvn /DEST pdfmark end
 -2 90 a -2 100 a
SDict begin H.S end
 -2 100 a -2 100 a
SDict begin 13 H.A end
 -2 100 a -2 100
a
SDict begin [/View [/XYZ H.V]/Dest (0:4058) cvn /DEST pdfmark end
 -2 100 a Black 396 243 a Fe(\225)p Black 479 243 a
SDict begin H.S end

479 243 a 479 243 a
SDict begin 13 H.A end
 479 243 a 479 243 a
SDict begin [/View [/XYZ H.V]/Dest (0:4059) cvn /DEST pdfmark end
 479 243 a Fj(The)g(client)g
(detects)h(if)f(the)g(serv)o(er)g(has)g(died)g(by)g(the)g(lack)g(of)g
(heartbeats)f(\(HUGZ\))h(coming)f(from)g(the)h(serv)o(er)-5
b(.)19 b(It)479 351 y(then)h(restarts)h(its)g(dialog)e(by)h(sending)f
(an)h(OHAI.)g(There')-5 b(s)20 b(no)f(timeout)h(on)g(the)g(OHAI)g
(since)h(the)f(\330MQ)479 459 y(DEALER)g(sock)o(et)h(will)f(queue)f(an)
i(outgoing)d(message)i(inde\002nitely)-5 b(.)-2 477 y
SDict begin H.S end

-2 477 a -2 477 a
SDict begin 13 H.A end
 -2 477 a -2 477 a
SDict begin [/View [/XYZ H.V]/Dest (0:4060) cvn /DEST pdfmark end
 -2 477 a Black 396
608 a Fe(\225)p Black 479 608 a
SDict begin H.S end
 479 608 a 479 608 a
SDict begin 13 H.A end
 479
608 a 479 608 a
SDict begin [/View [/XYZ H.V]/Dest (0:4061) cvn /DEST pdfmark end
 479 608 a Fj(The)20 b(serv)o(er)f(detects)i(if)f(a)h
(client)f(has)g(died)g(by)g(its)h(lack)f(of)g(response)f(\(HUGZ-OK\))g
(to)i(a)f(heartbeat.)f(In)h(that)g(case)h(it)479 716
y(deletes)g(all)f(state)h(for)f(the)g(client)g(including)f(its)i
(subscriptions.)-2 734 y
SDict begin H.S end
 -2 734 a -2 734 a
SDict begin 13 H.A end
 -2 734 a -2
734 a
SDict begin [/View [/XYZ H.V]/Dest (0:4062) cvn /DEST pdfmark end
 -2 734 a Black 396 865 a Fe(\225)p Black 479 865
a
SDict begin H.S end
 479 865 a 479 865 a
SDict begin 13 H.A end
 479 865 a 479 865 a
SDict begin [/View [/XYZ H.V]/Dest (0:4063) cvn /DEST pdfmark end
 479 865 a Fj(The)f(client)g
(API)h(holds)f(subscriptions)e(in)j(memory)d(and)i(replays)f(them)h
(when)g(it)h(has)f(connected)e(successfully)-5 b(.)479
973 y(This)21 b(means)f(the)g(called)g(can)g(subscribe)f(at)i(an)o(y)e
(time)i(\(and)e(doesn')o(t)f(care)i(when)g(connections)e(and)479
1081 y(authentication)g(actually)i(happen\).)-2 1099
y
SDict begin H.S end
 -2 1099 a -2 1099 a
SDict begin 13 H.A end
 -2 1099 a -2 1099 a
SDict begin [/View [/XYZ H.V]/Dest (0:4064) cvn /DEST pdfmark end
 -2 1099 a Black
396 1231 a Fe(\225)p Black 479 1231 a
SDict begin H.S end
 479 1231 a 479
1231 a
SDict begin 13 H.A end
 479 1231 a 479 1231 a
SDict begin [/View [/XYZ H.V]/Dest (0:4065) cvn /DEST pdfmark end
 479 1231 a Fj(The)g(serv)o(er)f(and)h
(client)g(use)h(virtual)e(paths,)h(much)f(lik)o(e)i(an)f(HTTP)g(or)g
(FTP)h(serv)o(er)-5 b(.)19 b(Y)-9 b(ou)20 b(publish)f(one)h(or)g(more)
479 1339 y("mount)f(points")h(each)g(corresponding)c(to)21
b(a)f(directory)f(on)h(the)g(serv)o(er)-5 b(.)19 b(Each)h(of)g(these)g
(maps)g(to)h(some)f(virtual)479 1446 y(path,)g(for)f(instance)h("/")h
(if)f(you)f(ha)n(v)o(e)h(only)f(one)h(mount)f(point.)g(Clients)i(then)f
(subscribe)f(to)i(virtual)e(paths,)h(and)479 1554 y(\002les)h(arri)n(v)
o(e)e(in)i(an)f(inbox)f(directory)-5 b(.)18 b(W)-7 b(e)21
b(don')o(t)e(send)g(physical)h(\002le)g(names)g(across)g(the)h(netw)o
(ork.)-2 1572 y
SDict begin H.S end
 -2 1572 a -2 1572 a
SDict begin 13 H.A end
 -2 1572 a -2 1572
a
SDict begin [/View [/XYZ H.V]/Dest (0:4066) cvn /DEST pdfmark end
 -2 1572 a Black 396 1704 a Fe(\225)p Black 479 1704
a
SDict begin H.S end
 479 1704 a 479 1704 a
SDict begin 13 H.A end
 479 1704 a 479 1704 a
SDict begin [/View [/XYZ H.V]/Dest (0:4067) cvn /DEST pdfmark end
 479 1704
a Fj(There)e(are)h(some)f(timing)h(issues:)g(if)g(the)g(serv)o(er)f(is)
i(creating)e(its)h(mount)f(points,)g(while)h(clients)g(are)f(connected)
f(and)479 1812 y(subscribing,)h(the)h(subscriptions)f(w)o(on')o(t)g
(attach)h(to)g(the)g(right)g(mount)f(points.)g(So,)i(we)f(bind)g(the)g
(serv)o(er)f(port)h(as)479 1920 y(last)h(thing.)-2 1938
y
SDict begin H.S end
 -2 1938 a -2 1938 a
SDict begin 13 H.A end
 -2 1938 a -2 1938 a
SDict begin [/View [/XYZ H.V]/Dest (0:4068) cvn /DEST pdfmark end
 -2 1938 a Black
396 2069 a Fe(\225)p Black 479 2069 a
SDict begin H.S end
 479 2069 a 479
2069 a
SDict begin 13 H.A end
 479 2069 a 479 2069 a
SDict begin [/View [/XYZ H.V]/Dest (0:4069) cvn /DEST pdfmark end
 479 2069 a Fj(Clients)g(can)f(reconnect)f
(at)h(an)o(y)g(point;)f(if)i(the)f(client)g(sends)h(OHAI,)f(that)g
(signals)g(the)g(end)g(of)g(an)o(y)f(pre)n(vious)479
2177 y(con)m(v)o(ersation)f(and)h(the)i(start)f(of)g(a)h(ne)n(w)f(one.)
f(I)i(might)e(one)h(day)f(mak)o(e)h(subscriptions)f(durable)g(so)h
(that)h(the)o(y)479 2285 y(survi)n(v)o(e)e(a)i(disconnection.)c(The)j
(client)h(stack,)f(after)f(reconnecting,)f(replays)h(an)o(y)h
(subscriptions)f(the)h(caller)479 2393 y(application)f(already)g(made.)
-2 2452 y
SDict begin H.S end
 -2 2452 a -2 2452 a
SDict begin 13 H.A end
 -2 2452 a -2 2452 a
SDict begin [/View [/XYZ H.V]/Dest (0:4070) cvn /DEST pdfmark end
 -2
2452 a 396 2763 a Fd(6.12.8.)36 b(Reliabilty)1324 2763
y
SDict begin H.S end
 1324 2763 a 1324 2763 a
SDict begin 18.72 H.A end
 1324 2763 a 1324 2763 a
SDict begin [/View [/XYZ H.V]/Dest (11.71.68.2) cvn /DEST pdfmark end
 1324
2763 a -2 2953 a
SDict begin H.S end
 -2 2953 a -2 2953 a
SDict begin 13 H.A end
 -2 2953 a -2 2953
a
SDict begin [/View [/XYZ H.V]/Dest (0:4072) cvn /DEST pdfmark end
 -2 2953 a 396 3037 a Fj(As)21 b(it)g(stands,)f(FileMQ)h(implements)e
(the)h(classic)h(\330MQ)g(publish-subscribe)c(pattern.)i(That)h(is,)h
(clients)g(recei)n(v)o(e)e(a)396 3144 y(stream)h(of)g(updates)g(b)n(ut)
g(with)g(no)g(guarantees)f(about)g(o)o(v)o(erall)g(consistenc)o(y)-5
b(.)18 b(T)-7 b(o)20 b(mak)o(e)g(FileMQ)h(reliable)f(we')l(d)f(ha)n(v)o
(e)396 3252 y(to)i(add)e(some)h(functionality:)-2 3270
y
SDict begin H.S end
 -2 3270 a -2 3270 a
SDict begin 13 H.A end
 -2 3270 a -2 3270 a
SDict begin [/View [/XYZ H.V]/Dest (0:4073) cvn /DEST pdfmark end
 -2 3270 a -2
3280 a
SDict begin H.S end
 -2 3280 a -2 3280 a
SDict begin 13 H.A end
 -2 3280 a -2 3280 a
SDict begin [/View [/XYZ H.V]/Dest (0:4074) cvn /DEST pdfmark end
 -2 3280
a Black 396 3423 a Fe(\225)p Black 479 3423 a
SDict begin H.S end
 479 3423
a 479 3423 a
SDict begin 13 H.A end
 479 3423 a 479 3423 a
SDict begin [/View [/XYZ H.V]/Dest (0:4075) cvn /DEST pdfmark end
 479 3423 a Fj(A)h(w)o(ay)f(for)g
(clients)g(to)h(request)e(all)i(patches)f(since)g(a)h(certain)e(time)i
(\(possibly)-5 b(,)18 b(all)j(patches\).)-2 3441 y
SDict begin H.S end
 -2
3441 a -2 3441 a
SDict begin 13 H.A end
 -2 3441 a -2 3441 a
SDict begin [/View [/XYZ H.V]/Dest (0:4076) cvn /DEST pdfmark end
 -2 3441 a Black
396 3572 a Fe(\225)p Black 479 3572 a
SDict begin H.S end
 479 3572 a 479
3572 a
SDict begin 13 H.A end
 479 3572 a 479 3572 a
SDict begin [/View [/XYZ H.V]/Dest (0:4077) cvn /DEST pdfmark end
 479 3572 a Fj(A)g(w)o(ay)f(for)g(the)g
(serv)o(er)f(to)i(store)f(patches)g(and)f(subscriptions)g(persistently)
-5 b(.)-2 3632 y
SDict begin H.S end
 -2 3632 a -2 3632 a
SDict begin 13 H.A end
 -2 3632 a -2 3632
a
SDict begin [/View [/XYZ H.V]/Dest (0:4078) cvn /DEST pdfmark end
 -2 3632 a 396 3942 a Fd(6.12.9.)36 b(Con\002guration)1578
3942 y
SDict begin H.S end
 1578 3942 a 1578 3942 a
SDict begin 18.72 H.A end
 1578 3942 a 1578 3942
a
SDict begin [/View [/XYZ H.V]/Dest (11.71.69.2) cvn /DEST pdfmark end
 1578 3942 a -2 4134 a
SDict begin H.S end
 -2 4134 a -2 4134 a
SDict begin 13 H.A end
 -2 4134 a
-2 4134 a
SDict begin [/View [/XYZ H.V]/Dest (0:4080) cvn /DEST pdfmark end
 -2 4134 a 396 4216 a Fj(I')l(v)o(e)19 b(written)h(man)o(y)f
(serv)o(ers,)h(lik)o(e)g(the)g(Xitami)h(web)f(serv)o(er)f(that)h(w)o
(as)h(popular)e(in)h(the)g(late)h(90')-5 b(s,)20 b(and)f(the)396
4324 y(OpenAMQ)h(messaging)f(serv)o(er)-5 b(.)19 b(Getting)h
(con\002guration)e(easy)i(and)g(ob)o(vious)e(w)o(as)j(a)g(lar)o(ge)e
(part)h(of)g(making)e(these)396 4431 y(serv)o(ers)i(fun)f(to)i(use.)-2
4598 y
SDict begin H.S end
 -2 4598 a -2 4598 a
SDict begin 13 H.A end
 -2 4598 a -2 4598 a
SDict begin [/View [/XYZ H.V]/Dest (0:4081) cvn /DEST pdfmark end
 -2 4598
a 396 4705 a Fj(W)-7 b(e)22 b(typically)d(aim)h(to)h(solv)o(e)e(a)i
(number)d(of)i(problems:)-2 4723 y
SDict begin H.S end
 -2 4723 a -2 4723
a
SDict begin 13 H.A end
 -2 4723 a -2 4723 a
SDict begin [/View [/XYZ H.V]/Dest (0:4082) cvn /DEST pdfmark end
 -2 4723 a -2 4733 a
SDict begin H.S end
 -2 4733 a -2
4733 a
SDict begin 13 H.A end
 -2 4733 a -2 4733 a
SDict begin [/View [/XYZ H.V]/Dest (0:4083) cvn /DEST pdfmark end
 -2 4733 a Black 396 4876 a
Fe(\225)p Black 479 4876 a
SDict begin H.S end
 479 4876 a 479 4876 a
SDict begin 13 H.A end
 479
4876 a 479 4876 a
SDict begin [/View [/XYZ H.V]/Dest (0:4084) cvn /DEST pdfmark end
 479 4876 a Fj(Ship)g(def)o(ault)g(con\002guration)d
(\002les)k(with)g(the)f(product.)-2 4894 y
SDict begin H.S end
 -2 4894 a
-2 4894 a
SDict begin 13 H.A end
 -2 4894 a -2 4894 a
SDict begin [/View [/XYZ H.V]/Dest (0:4085) cvn /DEST pdfmark end
 -2 4894 a Black 396 5025
a Fe(\225)p Black 479 5025 a
SDict begin H.S end
 479 5025 a 479 5025 a
SDict begin 13 H.A end
 479
5025 a 479 5025 a
SDict begin [/View [/XYZ H.V]/Dest (0:4086) cvn /DEST pdfmark end
 479 5025 a Fj(Allo)n(w)h(users)f(to)g(add)g(custom)f
(con\002guration)f(\002les)j(that)f(are)h(ne)n(v)o(er)d(o)o(v)o
(erwritten.)-2 5043 y
SDict begin H.S end
 -2 5043 a -2 5043 a
SDict begin 13 H.A end
 -2 5043 a -2
5043 a
SDict begin [/View [/XYZ H.V]/Dest (0:4087) cvn /DEST pdfmark end
 -2 5043 a Black 3759 5569 a Fi(301)p Black eop
end
%%Page: 302 316
TeXDict begin 302 315 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.302) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:4088) cvn /DEST pdfmark end
 479 72 a Fj(Allo)n(w)i(users)f(to)g
(con\002gure)f(from)g(the)h(command-line.)396 346 y(And)f(then)g(layer)
g(these)h(one)e(on)h(the)h(other)m(,)e(so)i(command-line)c(settings)k
(o)o(v)o(erride)d(custom)i(settings,)g(which)g(o)o(v)o(erride)396
454 y(def)o(ault)h(settings.)g(It)g(can)g(be)h(a)f(lot)h(of)f(w)o(ork)f
(to)h(do)g(this)h(right.)e(F)o(or)h(FileMQ)h(I')l(v)o(e)e(tak)o(en)h(a)
g(some)n(what)f(simpler)h(tack:)396 562 y(all)h(con\002guration)d(is)j
(done)e(from)g(the)h(API.)-2 746 y
SDict begin H.S end
 -2 746 a -2 746 a
SDict begin 13 H.A end

-2 746 a -2 746 a
SDict begin [/View [/XYZ H.V]/Dest (0:4090) cvn /DEST pdfmark end
 -2 746 a 396 836 a Fj(So)h(this)f(is)i(ho)n(w)d(we)i
(start)f(and)g(con\002gure)e(the)j(serv)o(er)m(,)d(for)i(e)o(xample:)-2
937 y
SDict begin H.S end
 -2 937 a -2 937 a
SDict begin 11.7 H.A end
 -2 937 a -2 937 a
SDict begin [/View [/XYZ H.V]/Dest (0:4091) cvn /DEST pdfmark end
 -2 937 a 396
1016 a Fg(server)44 b(=)h(fmq_server_new)d(\(\);)396
1114 y(fmq_server_configure)g(\(server,)h("server_test.cfg"\);)396
1211 y(fmq_server_publish)f(\(server,)i("./fmqroot/send",)e("/"\);)396
1308 y(fmq_server_publish)g(\(server,)i("./fmqroot/logs",)e("/logs"\);)
396 1405 y(fmq_server_bind)h(\(server,)g("tcp://)1832
1418 y(*)1877 1405 y(:6000"\);)-2 1583 y
SDict begin H.S end
 -2 1583 a -2
1583 a
SDict begin 13 H.A end
 -2 1583 a -2 1583 a
SDict begin [/View [/XYZ H.V]/Dest (0:4092) cvn /DEST pdfmark end
 -2 1583 a 396 1679 a Fj(W)-7
b(e)21 b(do)f(use)g(a)h(speci\002c)f(format)f(for)g(the)h(con\002g)f
(\002les,)i(which)e(is)2280 1679 y
SDict begin H.S end
 2280 1679 a 2280 1679
a
SDict begin 13 H.A end
 2280 1679 a 2280 1679 a
SDict begin [/View [/XYZ H.V]/Dest (0:4093) cvn /DEST pdfmark end
 2280 1679 a Fj(ZPL)h(\(http://rfc.zeromq.or)o
(g/spec:4\))o(,)15 b(a)20 b(minimalist)396 1787 y(syntax)g(that)g(we)h
(started)f(using)f(for)h(\330MQ)g("de)n(vices")g(a)g(fe)n(w)h(years)e
(ago,)h(b)n(ut)g(which)g(w)o(orks)g(well)g(for)g(an)o(y)f(serv)o(er:)-2
1888 y
SDict begin H.S end
 -2 1888 a -2 1888 a
SDict begin 11.7 H.A end
 -2 1888 a -2 1888 a
SDict begin [/View [/XYZ H.V]/Dest (0:4094) cvn /DEST pdfmark end
 -2 1888
a 396 1967 a Fg(#)135 b(Configure)43 b(server)h(for)g(plain)g(access)
396 2064 y(#)396 2161 y(server)576 2258 y(monitor)f(=)i(1)583
b(#)134 b(Check)44 b(mount)g(points)576 2356 y(heartbeat)f(=)i(1)493
b(#)134 b(Heartbeat)43 b(to)i(clients)396 2550 y(publish)576
2647 y(location)e(=)i(./fmqroot/logs)576 2744 y(virtual)e(=)i(/logs)396
2938 y(security)576 3036 y(echo)f(=)g(I:)h(use)f(guest/guest)f(to)i
(login)f(to)g(server)576 3133 y(#)134 b(These)44 b(are)g(SASL)g
(mechanisms)g(we)g(accept)576 3230 y(anonymous)f(=)i(0)576
3327 y(plain)f(=)g(1)755 3424 y(account)934 3521 y(login)g(=)h(guest)
934 3618 y(password)f(=)g(guest)934 3715 y(group)g(=)h(guest)755
3813 y(account)934 3910 y(login)f(=)h(super)934 4007
y(password)f(=)g(secret)934 4104 y(group)g(=)h(admin)-2
4282 y
SDict begin H.S end
 -2 4282 a -2 4282 a
SDict begin 13 H.A end
 -2 4282 a -2 4282 a
SDict begin [/View [/XYZ H.V]/Dest (0:4095) cvn /DEST pdfmark end
 -2 4282
a 396 4378 a Fj(One)20 b(cute)g(thing)g(\(which)f(seems)i(useful\))e
(the)h(generated)f(serv)o(er)g(code)h(does)g(is)h(to)f(parse)g(this)h
(con\002g)e(\002le)i(\(when)e(you)396 4486 y(use)i(the)f(fmq_serv)o
(er_con\002gure\()o(\))15 b(method\))j(and)i(e)o(x)o(ecute)f(an)o(y)g
(section)h(that)g(matches)g(an)g(API)h(method.)d(Thus)i(the)396
4594 y('publish')f(section)h(w)o(orks)g(as)h(a)f(fmq_serv)o
(er_publish\(\))15 b(method.)-2 4705 y
SDict begin H.S end
 -2 4705 a -2 4705
a
SDict begin 13 H.A end
 -2 4705 a -2 4705 a
SDict begin [/View [/XYZ H.V]/Dest (0:4096) cvn /DEST pdfmark end
 -2 4705 a Black 3759 5569 a Fi(302)p
Black eop end
%%Page: 303 317
TeXDict begin 303 316 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.303) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black -2 94 a Fh(6.13.)39 b(File)g(Stability)1204 94
y
SDict begin H.S end
 1204 94 a 1204 94 a
SDict begin 22.464 H.A end
 1204 94 a 1204 94 a
SDict begin [/View [/XYZ H.V]/Dest (11.72.1) cvn /DEST pdfmark end
 1204 94 a -2
290 a
SDict begin H.S end
 -2 290 a -2 290 a
SDict begin 13 H.A end
 -2 290 a -2 290 a
SDict begin [/View [/XYZ H.V]/Dest (0:4098) cvn /DEST pdfmark end
 -2 290 a 396
368 a Fj(It)20 b(is)h(quite)f(common)e(to)i(poll)g(a)g(directory)e(for)
i(changes)f(and)g(then)g(do)h(something)e('interesting')h(with)h(ne)n
(w)g(\002les.)g(But)396 476 y(as)h(one)f(process)g(is)h(writing)e(to)i
(a)f(\002le,)h(other)e(processes)h(ha)n(v)o(e)g(no)f(idea)i(when)e(the)
h(\002le)h(has)g(been)e(fully)h(written.)f(One)396 584
y(solution)h(is)h(to)f(add)g(a)g(second)g("indicator")e(\002le)j(which)
f(we)g(create)g(after)g(creating)f(the)h(\002rst)h(\002le.)g(This)f(is)
i(intrusi)n(v)o(e,)396 692 y(ho)n(we)n(v)o(er)-5 b(.)-2
859 y
SDict begin H.S end
 -2 859 a -2 859 a
SDict begin 13 H.A end
 -2 859 a -2 859 a
SDict begin [/View [/XYZ H.V]/Dest (0:4099) cvn /DEST pdfmark end
 -2 859 a 396
966 a Fj(There)20 b(is)h(a)f(neater)g(w)o(ay)-5 b(,)20
b(which)f(is)i(to)g(detect)f(when)f(a)i(\002le)g(is)g("stable",)f(i.e.)
g(no-one)e(is)j(writing)f(to)g(it)h(an)o(y)f(longer)-5
b(.)396 1074 y(FileMQ)21 b(does)f(this)h(by)e(checking)g(the)h
(modi\002cation)f(time)h(of)g(the)g(\002le.)h(If)f(it')-5
b(s)21 b(more)e(than)h(a)h(second)e(old,)h(then)f(the)396
1182 y(\002le)i(is)g(considered)e(stable,)h(at)h(least)f(stable)h
(enough)d(to)i(be)h(shipped)e(of)n(f)g(to)h(clients.)h(If)f(a)g
(process)g(comes)g(along)f(after)396 1290 y(\002)n(v)o(e)h(minutes)g
(and)g(appends)e(to)j(the)f(\002le,)h(it')o(ll)f(be)h(shipped)e(of)n(f)
g(again.)-2 1474 y
SDict begin H.S end
 -2 1474 a -2 1474 a
SDict begin 13 H.A end
 -2 1474 a -2 1474
a
SDict begin [/View [/XYZ H.V]/Dest (0:4100) cvn /DEST pdfmark end
 -2 1474 a 396 1564 a Fj(F)o(or)h(this)h(to)f(w)o(ork,)f(and)h(this)h
(is)g(a)g(requirement)c(for)j(an)o(y)f(application)g(hoping)g(to)h(use)
g(FileMQ)h(successfully)-5 b(,)19 b(do)h(not)396 1672
y(b)n(uf)n(fer)f(more)g(than)h(a)h(second')-5 b(s)19
b(w)o(orth)h(of)g(data)g(in)g(memory)f(before)g(writing.)g(If)h(you)f
(use)i(v)o(ery)e(lar)o(ge)g(block)g(sizes,)396 1779 y(the)h(\002le)h
(may)f(look)f(stable)i(when)e(it')-5 b(s)22 b(not.)-2
1808 y
SDict begin H.S end
 -2 1808 a -2 1808 a
SDict begin 13 H.A end
 -2 1808 a -2 1808 a
SDict begin [/View [/XYZ H.V]/Dest (0:4101) cvn /DEST pdfmark end
 -2 1808
a 359 x Fh(6.14.)39 b(T)-9 b(est)39 b(Use)g(Case)1330
2167 y
SDict begin H.S end
 1330 2167 a 1330 2167 a
SDict begin 22.464 H.A end
 1330 2167 a 1330 2167
a
SDict begin [/View [/XYZ H.V]/Dest (11.73.1) cvn /DEST pdfmark end
 1330 2167 a -2 2335 a
SDict begin H.S end
 -2 2335 a -2 2335 a
SDict begin 13 H.A end
 -2 2335 a
-2 2335 a
SDict begin [/View [/XYZ H.V]/Dest (0:4103) cvn /DEST pdfmark end
 -2 2335 a 396 2441 a Fj(T)-7 b(o)21 b(properly)d(test)j
(something)d(lik)o(e)j(FileMQ)g(we)f(need)g(a)g(test)h(case)g(that)f
(plays)g(with)h(li)n(v)o(e)f(data.)f(One)h(of)g(my)g(ongoing)396
2549 y(chores)g(is)h(to)f(manage)f(the)h(MP3)h(tracks)f(on)f(my)h
(music)g(player)m(,)f(which)h(is)h(a)f(Sansa)h(Clip)g(re\003ashed)e
(with)h(Rock)g(Box)396 2657 y(\(highly)d(recommended\).)e(As)k(I)g(do)n
(wnload)e(tracks)h(into)g(my)h(Music)f(folder)g(I)g(w)o(ant)h(to)g(cop)
o(y)f(these)g(to)h(my)f(player)m(,)f(and)396 2765 y(as)k(I)f(\002nd)g
(tracks)g(that)g(anno)o(y)e(me,)i(I)g(delete)g(them)g(in)g(the)g(Music)
g(folder)f(and)g(w)o(ant)h(those)g(gone)f(from)g(my)g(player)g(too.)-2
2949 y
SDict begin H.S end
 -2 2949 a -2 2949 a
SDict begin 13 H.A end
 -2 2949 a -2 2949 a
SDict begin [/View [/XYZ H.V]/Dest (0:4104) cvn /DEST pdfmark end
 -2 2949
a 396 3039 a Fj(This)i(is)g(kind)e(of)h(o)o(v)o(er)n(-kill)f(for)g(a)i
(po)n(werful)d(\002le)j(distrib)n(ution)e(protocol.)f(I)j(could)e
(write)h(this)h(using)f(a)g(bash)g(or)g(Perl)396 3147
y(script)g(b)n(ut)h(to)f(be)g(honest)g(the)g(hardest)f(w)o(ork)h(in)g
(FileMQ)h(w)o(as)g(the)f(directory)f(comparison)f(code,)h(and)h(I)g(w)o
(ant)g(to)396 3255 y(bene\002t)g(from)f(that.)h(So)h(I)f(put)g
(together)f(a)h(simple)g(tool)g(called)g("track")g(which)g(calls)g(the)
h(FileMQ)f(API.)h(From)e(the)396 3362 y(command)f(line)j(this)f(runs)g
(with)h(tw)o(o)f(ar)o(guments;)e(the)i(sending)f(and)h(the)g(recei)n
(ving)f(directories:)-2 3463 y
SDict begin H.S end
 -2 3463 a -2 3463 a
SDict begin 11.7 H.A end
 -2
3463 a -2 3463 a
SDict begin [/View [/XYZ H.V]/Dest (0:4105) cvn /DEST pdfmark end
 -2 3463 a 396 3543 a Fg(./track)44 b(/home/ph/Music)e
(/media/3230-6364/MUSIC)-2 3720 y
SDict begin H.S end
 -2 3720 a -2 3720 a
SDict begin 13 H.A end

-2 3720 a -2 3720 a
SDict begin [/View [/XYZ H.V]/Dest (0:4106) cvn /DEST pdfmark end
 -2 3720 a 396 3817 a Fj(The)20 b(code)g(is)h(a)f
(neat)g(e)o(xample)f(of)h(ho)n(w)g(to)g(use)h(the)f(FileMQ)g(API)h(to)f
(do)g(local)g(\002le)h(distrib)n(ution.)e(Here)h(is)h(the)f(full)396
3925 y(program,)e(minus)i(the)g(license)g(te)o(xt)g(\(it')-5
b(s)21 b(MIT/X11)e(licensed\):)-2 4026 y
SDict begin H.S end
 -2 4026 a -2
4026 a
SDict begin 11.7 H.A end
 -2 4026 a -2 4026 a
SDict begin [/View [/XYZ H.V]/Dest (0:4107) cvn /DEST pdfmark end
 -2 4026 a 396 4105 a Fg(#include)44
b("czmq.h")396 4202 y(#include)g("../include/fmq.h")396
4396 y(int)h(main)f(\(int)g(argc,)g(char)1517 4409 y(*)1562
4396 y(argv)g([]\))396 4493 y({)576 4590 y(if)g(\(argc)g(<)h(3\))f({)
755 4688 y(puts)g(\("usage:)g(track)g(original-directory)d
(tracking-directory"\);)755 4785 y(return)j(0;)576 4882
y(})576 4979 y(fmq_server_t)1158 4992 y(*)1203 4979 y(server)g(=)h
(fmq_server_new)d(\(\);)576 5076 y(fmq_server_configure)f(\(server,)j
("anonymous.cfg"\);)p Black 3759 5569 a Fi(303)p Black
eop end
%%Page: 304 318
TeXDict begin 304 317 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.304) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2917 -132 a Fi(Chapter)20 b(6.)g(The)g(Human)f(Scale)p
Black 576 72 a Fg(fmq_server_publish)41 b(\(server,)j(argv)g([1],)g
("/"\);)576 170 y(fmq_server_set_anonymous)c(\(server,)k(true\);)576
267 y(fmq_server_bind)e(\(server,)h("tcp://)2011 280
y(*)2056 267 y(:6000"\);)576 461 y(fmq_client_t)1158
474 y(*)1203 461 y(client)h(=)h(fmq_client_new)d(\(\);)576
558 y(fmq_client_connect)131 b(\(client,)44 b
("tcp://localhost:6000"\);)576 655 y(fmq_client_set_inbox)d(\(client,)j
(argv)g([2]\);)576 752 y(fmq_client_subscribe)d(\(client,)j("/"\);)576
947 y(while)g(\(!zctx_interrupted\))755 1044 y(sleep)g(\(1\);)576
1141 y(puts)g(\("interrupted"\);)576 1335 y(fmq_server_destroy)d
(\(&server\);)576 1432 y(fmq_client_destroy)g(\(&client\);)576
1530 y(return)i(0;)396 1627 y(})-2 1801 y
SDict begin H.S end
 -2 1801 a -2
1801 a
SDict begin 13 H.A end
 -2 1801 a -2 1801 a
SDict begin [/View [/XYZ H.V]/Dest (0:4108) cvn /DEST pdfmark end
 -2 1801 a 396 1901 a Fj(Note)20
b(ho)n(w)g(we)h(w)o(ork)e(with)i(physical)e(paths)h(in)g(this)h(tool.)e
(The)h(serv)o(er)g(publishes)f(the)h(physical)f(path)396
2009 y("/home/ph/Music")f(and)i(maps)g(this)g(to)h(the)f(virtual)f
(path)h("/".)h(The)e(client)i(subscribes)e(to)i("/")f(and)g(recei)n(v)o
(es)f(all)i(\002les)396 2116 y(in)g("/media/3230-6364/MUSIC".)15
b(I)20 b(could)f(use)i(an)o(y)e(structure)g(within)h(the)h(serv)o(er)e
(directory)-5 b(,)18 b(and)h(it)i(w)o(ould)f(be)396 2224
y(copied)f(f)o(aithfully)g(to)i(the)f(client')-5 b(s)20
b(inbox.)p Black 3759 5569 a Fi(304)p Black eop end
%%Page: 305 319
TeXDict begin 305 318 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.305) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:the-community) cvn /DEST pdfmark
end
 -2 -11 a 130 x Fl(Chapter)48 b(7.)f(The)h(\330MQ)h(Comm)m(unity)2644
119 y
SDict begin H.S end
 2644 119 a 2644 119 a
SDict begin 26.957 H.A end
 2644 119 a 2644 119 a
SDict begin [/View [/XYZ H.V]/Dest (12.0) cvn /DEST pdfmark end
 2644
119 a -2 375 a
SDict begin H.S end
 -2 375 a -2 375 a
SDict begin 13 H.A end
 -2 375 a -2 375 a
SDict begin [/View [/XYZ H.V]/Dest (0:4111) cvn /DEST pdfmark end
 -2
375 a 396 447 a Fj(People)20 b(sometimes)g(ask)g(what')-5
b(s)21 b(special)f(about)f(\330MQ.)i(My)f(standard)f(answer)h(is,)g
(it')-5 b(s)22 b(true)e(that)g(\330MQ)g(is)h(ar)o(guably)396
555 y(the)f(best)g(answer)g(we)g(ha)n(v)o(e)f(to)h(the)g(v)o(e)o(xing)e
(question)h(of)g("ho)n(w)h(do)f(we)h(mak)o(e)g(the)g(distrib)n(uted)f
(softw)o(are)g(that)h(the)g(21st)396 663 y(century)e(demands?")h(b)n
(ut)g(more)g(than)g(that,)h(\330MQ)g(is)h(special)e(because)g(of)h(its)
g(community)-5 b(.)17 b(This)j(is)h(ultimately)e(what)396
771 y(separates)h(the)g(w)o(olv)o(es)g(from)g(the)g(sheep.)-2
955 y
SDict begin H.S end
 -2 955 a -2 955 a
SDict begin 13 H.A end
 -2 955 a -2 955 a
SDict begin [/View [/XYZ H.V]/Dest (0:4112) cvn /DEST pdfmark end
 -2 955 a 396
1045 a Fj(There)g(are)g(three)f(main)h(open)f(source)h(patterns.)f
(One,)h(the)g(lar)o(ge)f(\002rm)i(dumping)d(code)h(to)h(break)g(the)g
(mark)o(et)f(for)396 1153 y(others.)h(This)g(is)h(the)f(Apache)g(F)o
(oundation)d(model.)j(T)-7 b(w)o(o,)20 b(tin)o(y)f(teams)i(or)f(small)g
(\002rms)h(b)n(uilding)e(their)h(dream.)f(This)396 1261
y(is)i(the)g(most)f(common)e(open)h(source)h(model,)f(and)g(it)i(can)f
(be)g(v)o(ery)g(successful)f(commercially)-5 b(.)18 b(Three,)h
(aggressi)n(v)o(e)396 1369 y(and)h(di)n(v)o(erse)f(communities)g(that)h
(sw)o(arm)g(o)o(v)o(er)f(a)i(problem)d(landscape.)h(This)h(is)i(the)e
(Linux)f(model,)g(and)h(the)g(one)f(we)396 1477 y(aspire)h(to)h(with)f
(\330MQ.)-2 1661 y
SDict begin H.S end
 -2 1661 a -2 1661 a
SDict begin 13 H.A end
 -2 1661 a -2 1661
a
SDict begin [/View [/XYZ H.V]/Dest (0:4113) cvn /DEST pdfmark end
 -2 1661 a 396 1751 a Fj(It')-5 b(s)21 b(hard)e(to)i(o)o(v)o(er)n
(-emphasize)c(the)j(po)n(wer)f(and)h(persistence)g(of)f(a)i(w)o(orking)
e(open)g(source)g(community)-5 b(.)18 b(There)h(really)396
1858 y(does)h(not)g(seem)g(to)h(be)f(a)h(better)e(w)o(ay)i(of)e(making)
g(softw)o(are)h(for)g(the)g(long)f(term.)h(Not)g(only)g(does)f(the)i
(community)396 1966 y(choose)f(the)g(best)g(problems)f(to)h(solv)o(e,)g
(it)h(solv)o(es)f(them)g(minimally)-5 b(,)18 b(carefully)-5
b(,)18 b(and)i(it)h(then)f(looks)f(after)h(these)396
2074 y(answers)g(for)g(years,)g(decades,)f(until)h(the)o(y')l(re)e(no)i
(longer)f(rele)n(v)n(ant,)g(and)g(then)h(it)h(quietly)f(puts)g(them)f
(a)o(w)o(ay)-5 b(.)-2 2258 y
SDict begin H.S end
 -2 2258 a -2 2258 a
SDict begin 13 H.A end
 -2 2258
a -2 2258 a
SDict begin [/View [/XYZ H.V]/Dest (0:4114) cvn /DEST pdfmark end
 -2 2258 a 396 2348 a Fj(T)e(o)21 b(really)e(bene\002t)h
(from)f(\330MQ,)h(you)g(need)f(to)i(understand)d(the)i(community)-5
b(.)17 b(At)k(some)f(stage)g(you')o(ll)g(w)o(ant)g(to)396
2456 y(submit)g(a)h(patch,)e(an)h(issue,)h(an)f(add-on.)e(Y)-9
b(ou)19 b(might)h(w)o(ant)g(to)h(ask)f(someone)f(for)h(help.)f(Y)-9
b(ou)20 b(will)h(probably)c(w)o(ant)k(to)396 2564 y(bet)f(a)h(part)f
(of)g(your)f(b)n(usiness)h(on)g(\330MQ,)g(and)g(when)f(I)i(tell)g(you)e
(that)h(the)g(community)e(is)k(much,)d(much)g(more)396
2672 y(important)f(than)i(the)g(compan)o(y)d(which)i(backs)h(the)f
(product,)f(e)n(v)o(en)h(though)f(I'm)h(CEO)h(of)g(that)g(compan)o(y)-5
b(,)16 b(this)21 b(should)396 2780 y(be)f(signi\002cant.)-2
2964 y
SDict begin H.S end
 -2 2964 a -2 2964 a
SDict begin 13 H.A end
 -2 2964 a -2 2964 a
SDict begin [/View [/XYZ H.V]/Dest (0:4115) cvn /DEST pdfmark end
 -2 2964
a 396 3054 a Fj(In)g(this)h(chapter)e(I'm)h(going)e(to)j(look)e(at)i
(our)e(community)f(from)h(se)n(v)o(eral)h(angles,)g(and)f(conclude)g
(by)h(e)o(xplaining)e(in)396 3162 y(detail)i(our)g(contract)f(for)h
(collaboration,)d(which)1842 3162 y
SDict begin H.S end
 1842 3162 a 1842
3162 a
SDict begin 13 H.A end
 1842 3162 a 1842 3162 a
SDict begin [/View [/XYZ H.V]/Dest (0:4116) cvn /DEST pdfmark end
 1842 3162 a Fj(we)j(call)h("C4")f
(\(http://rfc.zeromq.or)o(g/spec:16)o(\).)14 b(Y)-9 b(ou)20
b(should)f(\002nd)396 3270 y(the)h(discussion)g(useful)g(for)f(your)g
(o)n(wn)h(w)o(ork.)f(W)-7 b(e')l(v)o(e)20 b(also)h(adapted)e(the)h
(\330MQ)g(C4)h(process)f(for)f(closed)h(source)396 3378
y(projects,)g(with)g(good)f(success.)-2 3562 y
SDict begin H.S end
 -2 3562
a -2 3562 a
SDict begin 13 H.A end
 -2 3562 a -2 3562 a
SDict begin [/View [/XYZ H.V]/Dest (0:4117) cvn /DEST pdfmark end
 -2 3562 a 396 3652 a
Fj(W)-7 b(e')o(ll)22 b(co)o(v)o(er:)-2 3653 y
SDict begin H.S end
 -2 3653
a -2 3653 a
SDict begin 13 H.A end
 -2 3653 a -2 3653 a
SDict begin [/View [/XYZ H.V]/Dest (0:4118) cvn /DEST pdfmark end
 -2 3653 a -2 3663 a
SDict begin H.S end
 -2
3663 a -2 3663 a
SDict begin 13 H.A end
 -2 3663 a -2 3663 a
SDict begin [/View [/XYZ H.V]/Dest (0:4119) cvn /DEST pdfmark end
 -2 3663 a Black
396 3822 a Fe(\225)p Black 479 3822 a
SDict begin H.S end
 479 3822 a 479
3822 a
SDict begin 13 H.A end
 479 3822 a 479 3822 a
SDict begin [/View [/XYZ H.V]/Dest (0:4120) cvn /DEST pdfmark end
 479 3822 a Fj(The)e(rough)f(structure)g
(of)h(\330MQ)g(as)h(a)g(set)g(of)f(projects.)-2 3840
y
SDict begin H.S end
 -2 3840 a -2 3840 a
SDict begin 13 H.A end
 -2 3840 a -2 3840 a
SDict begin [/View [/XYZ H.V]/Dest (0:4121) cvn /DEST pdfmark end
 -2 3840 a Black
396 3971 a Fe(\225)p Black 479 3971 a
SDict begin H.S end
 479 3971 a 479
3971 a
SDict begin 13 H.A end
 479 3971 a 479 3971 a
SDict begin [/View [/XYZ H.V]/Dest (0:4122) cvn /DEST pdfmark end
 479 3971 a Fj(Why)g(we)h(use)f(the)g(LGPL)
h(and)e(not)h(the)g(BSD)h(license.)-2 3989 y
SDict begin H.S end
 -2 3989
a -2 3989 a
SDict begin 13 H.A end
 -2 3989 a -2 3989 a
SDict begin [/View [/XYZ H.V]/Dest (0:4123) cvn /DEST pdfmark end
 -2 3989 a Black 396 4121
a Fe(\225)p Black 479 4121 a
SDict begin H.S end
 479 4121 a 479 4121 a
SDict begin 13 H.A end
 479
4121 a 479 4121 a
SDict begin [/View [/XYZ H.V]/Dest (0:4124) cvn /DEST pdfmark end
 479 4121 a Fj(Ho)n(w)f(we)h(designed)e(and)g(gre)n(w)
h(the)g(\330MQ)h(community)-5 b(.)-2 4139 y
SDict begin H.S end
 -2 4139 a
-2 4139 a
SDict begin 13 H.A end
 -2 4139 a -2 4139 a
SDict begin [/View [/XYZ H.V]/Dest (0:4125) cvn /DEST pdfmark end
 -2 4139 a Black 396 4270
a Fe(\225)p Black 479 4270 a
SDict begin H.S end
 479 4270 a 479 4270 a
SDict begin 13 H.A end
 479
4270 a 479 4270 a
SDict begin [/View [/XYZ H.V]/Dest (0:4126) cvn /DEST pdfmark end
 479 4270 a Fj(The)20 b(b)n(usiness)h(that)f(backs)g
(\330MQ.)-2 4285 y
SDict begin H.S end
 -2 4285 a -2 4285 a
SDict begin 13 H.A end
 -2 4285 a -2 4285
a
SDict begin [/View [/XYZ H.V]/Dest (0:4127) cvn /DEST pdfmark end
 -2 4285 a Black 396 4420 a Fe(\225)p Black 479 4420
a
SDict begin H.S end
 479 4420 a 479 4420 a
SDict begin 13 H.A end
 479 4420 a 479 4420 a
SDict begin [/View [/XYZ H.V]/Dest (0:4128) cvn /DEST pdfmark end
 479 4420
a Fj(Who)g(o)n(wns)g(the)h(\330MQ)f(source)f(code.)-2
4435 y
SDict begin H.S end
 -2 4435 a -2 4435 a
SDict begin 13 H.A end
 -2 4435 a -2 4435 a
SDict begin [/View [/XYZ H.V]/Dest (0:4129) cvn /DEST pdfmark end
 -2 4435
a Black 396 4569 a Fe(\225)p Black 479 4569 a
SDict begin H.S end
 479 4569
a 479 4569 a
SDict begin 13 H.A end
 479 4569 a 479 4569 a
SDict begin [/View [/XYZ H.V]/Dest (0:4130) cvn /DEST pdfmark end
 479 4569 a Fj(Ho)n(w)h(to)h(mak)o(e)
e(and)h(submit)g(a)h(patch)e(to)h(\330MQ.)-2 4587 y
SDict begin H.S end
 -2
4587 a -2 4587 a
SDict begin 13 H.A end
 -2 4587 a -2 4587 a
SDict begin [/View [/XYZ H.V]/Dest (0:4131) cvn /DEST pdfmark end
 -2 4587 a Black
396 4719 a Fe(\225)p Black 479 4719 a
SDict begin H.S end
 479 4719 a 479
4719 a
SDict begin 13 H.A end
 479 4719 a 479 4719 a
SDict begin [/View [/XYZ H.V]/Dest (0:4132) cvn /DEST pdfmark end
 479 4719 a Fj(Who)g(has)h(special)f
(rights)g(to)g(mak)o(e)g(commits)g(to)g(\330MQ.)-2 4737
y
SDict begin H.S end
 -2 4737 a -2 4737 a
SDict begin 13 H.A end
 -2 4737 a -2 4737 a
SDict begin [/View [/XYZ H.V]/Dest (0:4133) cvn /DEST pdfmark end
 -2 4737 a Black
396 4868 a Fe(\225)p Black 479 4868 a
SDict begin H.S end
 479 4868 a 479
4868 a
SDict begin 13 H.A end
 479 4868 a 479 4868 a
SDict begin [/View [/XYZ H.V]/Dest (0:4134) cvn /DEST pdfmark end
 479 4868 a Fj(Ho)n(w)g(we)h(guarantee)d
(compatibility)h(with)h(old)g(code.)-2 4886 y
SDict begin H.S end
 -2 4886
a -2 4886 a
SDict begin 13 H.A end
 -2 4886 a -2 4886 a
SDict begin [/View [/XYZ H.V]/Dest (0:4135) cvn /DEST pdfmark end
 -2 4886 a Black 396 5017
a Fe(\225)p Black 479 5017 a
SDict begin H.S end
 479 5017 a 479 5017 a
SDict begin 13 H.A end
 479
5017 a 479 5017 a
SDict begin [/View [/XYZ H.V]/Dest (0:4136) cvn /DEST pdfmark end
 479 5017 a Fj(Why)g(we)h(don')o(t)d(use)j(public)e
(git)h(branches.)-2 5035 y
SDict begin H.S end
 -2 5035 a -2 5035 a
SDict begin 13 H.A end
 -2 5035
a -2 5035 a
SDict begin [/View [/XYZ H.V]/Dest (0:4137) cvn /DEST pdfmark end
 -2 5035 a Black 396 5167 a Fe(\225)p Black
479 5167 a
SDict begin H.S end
 479 5167 a 479 5167 a
SDict begin 13 H.A end
 479 5167 a 479 5167
a
SDict begin [/View [/XYZ H.V]/Dest (0:4138) cvn /DEST pdfmark end
 479 5167 a Fj(Who)g(decides)g(on)g(the)g(\330MQ)h(road-map?)-2
5185 y
SDict begin H.S end
 -2 5185 a -2 5185 a
SDict begin 13 H.A end
 -2 5185 a -2 5185 a
SDict begin [/View [/XYZ H.V]/Dest (0:4139) cvn /DEST pdfmark end
 -2 5185
a Black 3759 5569 a Fi(305)p Black eop end
%%Page: 306 320
TeXDict begin 306 319 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.306) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4159) cvn /DEST pdfmark end
 -2 -201 a 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:4140) cvn /DEST pdfmark end
 479 72 a Fj(A)h(w)o(ork)o(ed)e(e)o(xample)
g(of)h(a)g(change)f(to)i(libzmq.)-2 90 y
SDict begin H.S end
 -2 90 a -2 90
a
SDict begin 13 H.A end
 -2 90 a -2 90 a
SDict begin [/View [/XYZ H.V]/Dest (0:4141) cvn /DEST pdfmark end
 -2 90 a 360 x Fh(7.1.)39 b(Ar)m(c)o(hitecture)d(of)k
(the)f(\330MQ)f(Comm)m(unity)2759 450 y
SDict begin H.S end
 2759 450 a 2759
450 a
SDict begin 22.464 H.A end
 2759 450 a 2759 450 a
SDict begin [/View [/XYZ H.V]/Dest (12.74.1) cvn /DEST pdfmark end
 2759 450 a -2 645 a
SDict begin H.S end
 -2 645
a -2 645 a
SDict begin 13 H.A end
 -2 645 a -2 645 a
SDict begin [/View [/XYZ H.V]/Dest (0:4143) cvn /DEST pdfmark end
 -2 645 a 396 724 a Fj(Y)-9
b(ou)20 b(kno)n(w)f(that)h(\330MQ)h(is)g(an)f(LGPL-licensed)f(project.)
g(In)h(f)o(act)g(it')-5 b(s)22 b(a)e(collection)f(of)h(projects,)g(b)n
(uilt)g(around)e(the)396 831 y(core)i(library)-5 b(,)817
831 y
SDict begin H.S end
 817 831 a 817 831 a
SDict begin 13 H.A end
 817 831 a 817 831 a
SDict begin [/View [/XYZ H.V]/Dest (0:4144) cvn /DEST pdfmark end
 817 831
a Fg(libzmq)p Fj(.)20 b(I')o(ll)g(visualize)g(these)g(projects)g(as)h
(an)f(e)o(xpanding)d(galaxy:)-2 849 y
SDict begin H.S end
 -2 849 a -2 849
a
SDict begin 13 H.A end
 -2 849 a -2 849 a
SDict begin [/View [/XYZ H.V]/Dest (0:4145) cvn /DEST pdfmark end
 -2 849 a -2 859 a
SDict begin H.S end
 -2 859 a -2 859
a
SDict begin 13 H.A end
 -2 859 a -2 859 a
SDict begin [/View [/XYZ H.V]/Dest (0:4146) cvn /DEST pdfmark end
 -2 859 a Black 396 1002 a Fe(\225)p
Black 479 1002 a
SDict begin H.S end
 479 1002 a 479 1002 a
SDict begin 13 H.A end
 479 1002 a 479
1002 a
SDict begin [/View [/XYZ H.V]/Dest (0:4147) cvn /DEST pdfmark end
 479 1002 a Fj(At)k(the)f(core,)g(libzmq)f(is)i(the)f(\330MQ)h
(core)e(library)-5 b(.)19 b(It')-5 b(s)21 b(written)f(in)g(C++,)h(with)
f(a)h(lo)n(w-le)n(v)o(el)e(C)i(API.)f(The)g(code)f(is)479
1110 y(nasty)-5 b(,)20 b(mainly)f(because)h(it')-5 b(s)21
b(highly)e(optimized)g(b)n(ut)h(also)g(because)g(it')-5
b(s)21 b(written)f(in)g(C++,)h(a)g(language)d(that)i(lends)479
1218 y(itself)h(to)f(subtle)h(and)e(deep)h(nastiness.)g(Martin)g
(Sustrik)g(wrote)g(the)g(b)n(ulk)f(of)h(this)h(code)f(originally)-5
b(,)18 b(today)h(it)i(has)479 1325 y(dozens)f(of)g(people)f(who)g
(maintain)h(dif)n(ferent)e(parts)i(of)g(it.)h(Sustrik,)f(incidentally)
-5 b(,)18 b(has)i(said)h(he')l(d)e(use)h(C)h(if)g(he)f(did)479
1433 y(this)h(again,)e(and)h(has)g(started)g(a)h(re)n(write)e(in)i(C)g
(called)f("nano".)-2 1451 y
SDict begin H.S end
 -2 1451 a -2 1451 a
SDict begin 13 H.A end
 -2 1451
a -2 1451 a
SDict begin [/View [/XYZ H.V]/Dest (0:4148) cvn /DEST pdfmark end
 -2 1451 a Black 396 1583 a Fe(\225)p Black
479 1583 a
SDict begin H.S end
 479 1583 a 479 1583 a
SDict begin 13 H.A end
 479 1583 a 479 1583
a
SDict begin [/View [/XYZ H.V]/Dest (0:4149) cvn /DEST pdfmark end
 479 1583 a Fj(Around)f(libzmq)g(there)h(are)g(about)f(50)h
("bindings".)e(These)i(are)g(indi)n(vidual)f(projects)g(that)i(create)f
(higher)n(-le)n(v)o(el)479 1691 y(APIs)h(for)f(\330MQ,)g(or)g(at)g
(least)h(map)f(the)g(lo)n(w-le)n(v)o(el)f(API)i(into)f(other)f
(languages.)g(The)g(bindings)g(v)n(ary)g(in)i(quality)479
1799 y(from)e(e)o(xperimental)f(to)j(utterly)e(a)o(wesome.)g(By)i(f)o
(ar)f(the)g(most)h(a)o(wesome)e(binding)g(is)3000 1799
y
SDict begin H.S end
 3000 1799 a 3000 1799 a
SDict begin 13 H.A end
 3000 1799 a 3000 1799 a
SDict begin [/View [/XYZ H.V]/Dest (0:4150) cvn /DEST pdfmark end
 3000
1799 a Fj(PyZMQ)479 1907 y(\(https://github)m(.com/zeromq/p)o(yz)o
(mq\))o(,)c(which)k(w)o(as)i(one)f(of)g(the)g(\002rst)h(community)d
(projects)i(on)f(top)h(of)g(\330MQ.)g(If)479 2015 y(you)g(are)g(a)g
(binding)f(author)m(,)f(you)h(should)h(really)f(study)h(PyZMQ)g(and)g
(aspire)g(to)g(making)f(your)g(code)g(and)479 2122 y(community)f(as)j
(a)o(wesome.)-2 2140 y
SDict begin H.S end
 -2 2140 a -2 2140 a
SDict begin 13 H.A end
 -2 2140 a
-2 2140 a
SDict begin [/View [/XYZ H.V]/Dest (0:4151) cvn /DEST pdfmark end
 -2 2140 a Black 396 2272 a Fe(\225)p Black
479 2272 a
SDict begin H.S end
 479 2272 a 479 2272 a
SDict begin 13 H.A end
 479 2272 a 479 2272
a
SDict begin [/View [/XYZ H.V]/Dest (0:4152) cvn /DEST pdfmark end
 479 2272 a Fj(A)g(lot)f(of)g(languages)f(ha)n(v)o(e)h(multiple)f
(bindings)g(\(Erlang,)f(Ruby)-5 b(,)19 b(C#,)i(at)g(least\))f(written)g
(by)g(dif)n(ferent)e(people)i(o)o(v)o(er)479 2380 y(time,)g(or)g
(taking)g(dif)n(ferent)e(approaches.)g(W)-7 b(e)21 b(don')o(t)e(re)o
(gulate)g(these)h(in)h(an)o(y)e(w)o(ay)-5 b(.)20 b(There)f(are)h(no)g
("of)n(\002cial")479 2488 y(bindings.)f(Y)-9 b(ou)19
b(v)n(ote)h(by)g(using)g(one)g(or)f(the)i(other)m(,)d(contrib)n(uting)g
(to)j(it,)f(or)g(ignoring)e(it.)-2 2506 y
SDict begin H.S end
 -2 2506 a -2
2506 a
SDict begin 13 H.A end
 -2 2506 a -2 2506 a
SDict begin [/View [/XYZ H.V]/Dest (0:4153) cvn /DEST pdfmark end
 -2 2506 a Black 396 2637 a
Fe(\225)p Black 479 2637 a
SDict begin H.S end
 479 2637 a 479 2637 a
SDict begin 13 H.A end
 479
2637 a 479 2637 a
SDict begin [/View [/XYZ H.V]/Dest (0:4154) cvn /DEST pdfmark end
 479 2637 a Fj(On)i(top)g(of)g(the)g(bindings)f(are)h
(a)h(lot)f(of)g(projects)g(that)g(use)h(\330MQ)f(or)g(b)n(uild)g(on)g
(it.)g(See)h(the)f("Labs")g(page)f(on)h(the)479 2745
y(wiki)h(for)e(a)i(long)e(list)i(of)f(projects)g(and)g(proto-projects)d
(that)j(use)h(\330MQ)f(in)h(some)f(w)o(ay)-5 b(.)19 b(There)h(are)g
(frame)n(w)o(orks,)479 2853 y(web)g(serv)o(ers)g(lik)o(e)g(Mongrel2,)e
(brok)o(ers)h(lik)o(e)i(Majordomo,)c(and)j(enterprise)f(open)g(source)h
(tools)g(lik)o(e)g(Storm.)-2 3037 y
SDict begin H.S end
 -2 3037 a -2 3037
a
SDict begin 13 H.A end
 -2 3037 a -2 3037 a
SDict begin [/View [/XYZ H.V]/Dest (0:4155) cvn /DEST pdfmark end
 -2 3037 a 396 3127 a Fj(Libzmq,)f(most)h(of)g
(the)g(bindings,)f(and)h(some)g(of)f(the)i(outer)e(projects)h(sit)h(in)
f(the)2748 3127 y
SDict begin H.S end
 2748 3127 a 2748 3127 a
SDict begin 13 H.A end
 2748 3127 a
2748 3127 a
SDict begin [/View [/XYZ H.V]/Dest (0:4156) cvn /DEST pdfmark end
 2748 3127 a Fj(\330MQ)h(community)d("or)o(ganization")396
3235 y(\(https://github)m(.com/or)o(gan)o(ization)o(s/zerom)o(q\))c(on)
19 b(GitHub)m(.)g(This)h(or)o(ganization)d(is)j("run")f(by)h(a)g(group)
e(consisting)h(of)396 3343 y(the)h(most)h(senior)e(binding)g(authors.)g
(There')-5 b(s)19 b(v)o(ery)h(little)h(to)f(run)f(since)i(it')-5
b(s)21 b(almost)f(all)h(self-managing)d(and)h(there')-5
b(s)396 3451 y(zero)20 b(con\003ict)g(these)g(days.)-2
3635 y
SDict begin H.S end
 -2 3635 a -2 3635 a
SDict begin 13 H.A end
 -2 3635 a -2 3635 a
SDict begin [/View [/XYZ H.V]/Dest (0:4157) cvn /DEST pdfmark end
 -2 3635
a 396 3725 a Fj(iMatix,)g(my)g(\002rm,)g(plays)g(a)h(speci\002c)f(role)
g(in)g(the)g(community)-5 b(.)18 b(W)-7 b(e)21 b(o)n(wn)f(the)g
(trademarks)f(and)g(enforce)g(them)396 3833 y(discretely)-5
b(,)19 b(to)i(mak)o(e)e(sure)h(that)h(if)f(you)f(do)n(wnload)f(a)j
(package)e(calling)h(itself)g("ZeroMQ",)f(you)g(can)h(trust)h(what)f
(you)396 3941 y(are)g(getting.)g(People)f(ha)n(v)o(e)h(on)g(rare)f
(occasion)h(tried)g(to)g(hijack)g(the)g(name,)f(maybe)g(belie)n(ving)g
(that)h("free)g(softw)o(are")396 4049 y(means)g(there)g(is)h(no)f
(property)e(at)i(stak)o(e,)h(or)f(no-one)e(willing)i(to)g(defend)f(it.)
i(One)f(thing)f(you')o(ll)g(understand)g(from)g(this)396
4157 y(chapter)g(is)i(ho)n(w)f(seriously)g(we)g(tak)o(e)g(the)h
(process)e(behind)g(our)h(softw)o(are)f(\(and)h(I)g(mean)g("us")g(as)h
(a)f(community)-5 b(,)18 b(not)i(a)396 4264 y(compan)o(y\).)d(iMatix)i
(backs)g(the)g(community)f(by)g(enforcing)f(that)j(process)f(on)g(an)o
(ything)e(calling)i(itself)h("ZeroMQ")e(or)396 4372 y("\330MQ".)i(W)-7
b(e)22 b(also)e(put)g(mone)o(y)e(and)i(time)g(into)g(the)h(softw)o(are)
e(and)h(packaging)e(for)h(reasons)h(I')o(ll)h(e)o(xplain)e(later)-5
b(.)-2 4556 y
SDict begin H.S end
 -2 4556 a -2 4556 a
SDict begin 13 H.A end
 -2 4556 a -2 4556 a
SDict begin [/View [/XYZ H.V]/Dest (0:4158) cvn /DEST pdfmark end

-2 4556 a 396 4646 a Fj(It)21 b(is)g(not)f(a)g(charity)g(e)o(x)o
(ercise.)f(\330MQ)h(is)h(a)g(for)n(-pro\002t)d(project,)h(and)h(a)h(v)o
(ery)e(pro\002table)g(one.)g(The)h(pro\002ts)g(are)g(just)396
4754 y(widely)g(distrib)n(uted)f(among)g(all)i(those)f(who)g(in)m(v)o
(est)f(in)h(it.)h(It')-5 b(s)21 b(really)f(that)g(simple:)g(tak)o(e)g
(the)h(time)f(to)g(become)f(an)396 4862 y(e)o(xpert)g(in)h(\330MQ,)h
(or)e(b)n(uild)h(something)f(useful)g(on)h(top)g(of)g(\330MQ,)g(and)g
(you')o(ll)f(\002nd)h(your)f(v)n(alue)g(as)i(an)f(indi)n(vidual,)e(or)
396 4970 y(team,)i(or)g(compan)o(y)e(increasing.)h(iMatix)h(enjo)o(ys)g
(the)g(same)g(bene\002ts)g(as)h(e)n(v)o(eryone)d(else)j(in)f(the)g
(community)-5 b(.)18 b(It')-5 b(s)p Black 599 x Fi(306)p
Black eop end
%%Page: 307 321
TeXDict begin 307 320 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.307) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(win-win)g(to)g(e)n(v)o(eryone)e(e)o(xcept)h(our)g
(competitors,)g(who)h(\002nd)g(themselv)o(es)f(f)o(acing)g(a)i(threat)f
(the)o(y)f(can')o(t)h(beat)g(and)396 180 y(can')o(t)f(really)h(escape.)
g(\330MQ)g(dominates)g(the)g(future)f(w)o(orld)g(of)h(massi)n(v)o(ely)g
(distrib)n(uted)f(softw)o(are.)396 454 y(My)h(\002rm)g(doesn')o(t)f
(just)i(ha)n(v)o(e)e(the)i(community')-5 b(s)18 b(back,)h(we)i(also)f
(b)n(uilt)g(the)h(community)-5 b(.)17 b(This)j(w)o(as)h(deliberate)e(w)
o(ork;)396 562 y(in)i(the)f(original)f(\330MQ)h(white)h(paper)e(from)g
(2007)g(there)g(were)h(tw)o(o)h(projects.)e(One)h(w)o(as)h(technical,)f
(ho)n(w)f(to)i(mak)o(e)e(a)396 670 y(better)h(messaging)f(system.)h
(The)g(second)g(w)o(as)h(ho)n(w)e(to)i(b)n(uild)e(a)i(community)d(that)
i(could)g(tak)o(e)g(the)g(softw)o(are)g(to)396 778 y(through)e(to)j
(dominant)d(success.)j(Softw)o(are)e(dies,)h(b)n(ut)h(community)d
(survi)n(v)o(es.)-2 807 y
SDict begin H.S end
 -2 807 a -2 807 a
SDict begin 13 H.A end
 -2 807 a
-2 807 a
SDict begin [/View [/XYZ H.V]/Dest (0:4160) cvn /DEST pdfmark end
 -2 807 a 359 x Fh(7.2.)39 b(Ho)n(w)g(to)g(Make)f(Reall)n(y)h
(Lar)n(g)q(e)g(Ar)m(c)o(hitectures)3006 1166 y
SDict begin H.S end
 3006 1166
a 3006 1166 a
SDict begin 22.464 H.A end
 3006 1166 a 3006 1166 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.1) cvn /DEST pdfmark end
 3006 1166 a -2
1364 a
SDict begin H.S end
 -2 1364 a -2 1364 a
SDict begin 13 H.A end
 -2 1364 a -2 1364 a
SDict begin [/View [/XYZ H.V]/Dest (0:4162) cvn /DEST pdfmark end
 -2 1364
a 396 1440 a Fj(There)20 b(are,)g(it)g(has)h(been)e(said)i(\(at)f
(least)h(by)f(people)f(reading)g(this)h(sentence)g(out)g(loud\),)f(tw)o
(o)h(w)o(ays)h(to)f(mak)o(e)g(really)396 1548 y(lar)o(ge-scale)f(softw)
o(are.)h(Option)f(One)h(is)h(to)g(thro)n(w)e(massi)n(v)o(e)h(amounts)f
(of)h(mone)o(y)e(and)i(problems)f(at)h(empires)g(of)396
1655 y(smart)g(people,)f(and)h(hope)f(that)h(what)h(emer)o(ges)d(is)k
(not)d(yet)i(another)d(career)i(killer)-5 b(.)20 b(If)g(you')l(re)e(v)o
(ery)h(luck)o(y)-5 b(,)19 b(and)g(are)396 1763 y(b)n(uilding)g(on)h
(lots)h(of)f(e)o(xperience,)d(and)j(ha)n(v)o(e)g(k)o(ept)g(your)e
(teams)j(solid,)f(and)g(are)g(not)f(aiming)h(for)f(technical)396
1871 y(brilliance,)g(and)h(are)g(furthermore)d(incredibly)i(luck)o(y)-5
b(,)18 b(it)j(w)o(orks.)-2 2055 y
SDict begin H.S end
 -2 2055 a -2 2055 a
SDict begin 13 H.A end

-2 2055 a -2 2055 a
SDict begin [/View [/XYZ H.V]/Dest (0:4163) cvn /DEST pdfmark end
 -2 2055 a 396 2145 a Fj(But)g(gambling)d(with)i
(hundreds)e(of)i(millions)g(of)g(others')g(mone)o(y)e(isn')o(t)i(for)f
(e)n(v)o(eryone.)f(F)o(or)i(the)g(rest)h(of)f(us)g(who)g(w)o(ant)396
2253 y(to)h(b)n(uild)e(lar)o(ge-scale)g(softw)o(are,)h(there')-5
b(s)20 b(Option)f(T)-7 b(w)o(o,)20 b(which)g(is)h(open)e(source,)h(and)
f(more)h(speci\002cally)-5 b(,)3543 2253 y
SDict begin H.S end
 3543 2253
a 3543 2253 a
SDict begin 13 H.A end
 3543 2253 a 3543 2253 a
SDict begin [/View [/XYZ H.V]/Dest (0:4164) cvn /DEST pdfmark end
 3543 2253 a Fi(fr)m(ee)396
2361 y(softwar)m(e)p Fj(.)21 b(If)f(you')l(re)e(asking)i(ho)n(w)f(the)h
(choice)g(of)g(softw)o(are)g(license)g(is)h(rele)n(v)n(ant)e(to)h(the)h
(scale)f(of)g(the)g(softw)o(are)g(you)396 2469 y(b)n(uild,)g(that')-5
b(s)20 b(the)h(right)e(question.)-2 2653 y
SDict begin H.S end
 -2 2653 a
-2 2653 a
SDict begin 13 H.A end
 -2 2653 a -2 2653 a
SDict begin [/View [/XYZ H.V]/Dest (0:4165) cvn /DEST pdfmark end
 -2 2653 a 396 2743 a Fj(The)g(brilliant)g
(and)g(visionary)f(Eben)g(Moglen)h(once)f(said,)i(roughly)-5
b(,)16 b(that)k(a)g(free)f(softw)o(are)g(license)g(is)h(the)g(contract)
e(on)396 2851 y(which)i(a)h(community)d(b)n(uilds.)h(When)h(I)h(heard)e
(this,)h(about)g(ten)g(years)g(ago,)f(the)h(idea)g(came)g(to)h(me,)3344
2851 y
SDict begin H.S end
 3344 2851 a 3344 2851 a
SDict begin 13 H.A end
 3344 2851 a 3344 2851
a
SDict begin [/View [/XYZ H.V]/Dest (0:4166) cvn /DEST pdfmark end
 3344 2851 a Fi(can)e(we)396 2959 y(deliber)o(ately)g(gr)l(ow)i(fr)m
(ee)g(softwar)m(e)g(communities)p Fj(?)-2 3142 y
SDict begin H.S end
 -2 3142
a -2 3142 a
SDict begin 13 H.A end
 -2 3142 a -2 3142 a
SDict begin [/View [/XYZ H.V]/Dest (0:4167) cvn /DEST pdfmark end
 -2 3142 a 396 3233 a
Fj(T)-6 b(en)20 b(years)g(later)m(,)g(the)g(answer)g(is)h("yes",)f(and)
g(there)f(is)j(almost)e(a)g(science)g(to)h(it.)f(I)h(say)f("almost")g
(because)g(we)g(don')o(t)396 3341 y(yet)g(ha)n(v)o(e)g(enough)e(e)n
(vidence)h(of)h(people)f(doing)g(this)i(deliberately)d(with)j(a)f
(documented,)e(reproducible)f(process.)i(It)396 3449
y(is)i(what)g(I'm)e(trying)g(to)i(do)e(with)1372 3449
y
SDict begin H.S end
 1372 3449 a 1372 3449 a
SDict begin 13 H.A end
 1372 3449 a 1372 3449 a
SDict begin [/View [/XYZ H.V]/Dest (0:4168) cvn /DEST pdfmark end
 1372
3449 a Fj(Social)h(Architecture)f(\(http://softw)o
(areandsilicon.com/chapter)o(:2#)o(toc5)o(\).)14 b(\330MQ)396
3557 y(came)20 b(after)g(W)m(ikidot,)f(after)h(Digistan)g(and)g(after)g
(the)g(F)o(oundation)e(for)h(a)i(Free)f(Information)e(Infrastructure)f
(\(aka)j(the)396 3665 y(FFII,)g(an)h(NGO)f(that)g(\002ghts)h(against)e
(softw)o(are)h(patents\).)f(Which)h(came)g(after)g(a)h(lot)f(of)g(less)
h(successful)f(community)396 3773 y(projects)g(lik)o(e)g(Xitami)h(and)e
(Libero.)g(My)h(main)g(tak)o(ea)o(w)o(ay)f(from)h(a)g(long)g(career)f
(of)h(projects)g(of)f(e)n(v)o(ery)g(concei)n(v)n(able)396
3880 y(format)g(is:)j(if)e(you)f(w)o(ant)i(to)f(b)n(uild)g(truly)f(lar)
o(ge-scale)g(and)h(long-lasting)e(softw)o(are,)i(aim)g(to)g(b)n(uild)g
(a)h(free)f(softw)o(are)396 3988 y(community)-5 b(.)-2
4006 y
SDict begin H.S end
 -2 4006 a -2 4006 a
SDict begin 13 H.A end
 -2 4006 a -2 4006 a
SDict begin [/View [/XYZ H.V]/Dest (0:4169) cvn /DEST pdfmark end
 -2 4006
a 396 4317 a Fd(7.2.1.)36 b(The)d(Game)1305 4317 y
SDict begin H.S end
 1305
4317 a 1305 4317 a
SDict begin 18.72 H.A end
 1305 4317 a 1305 4317 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.70.2) cvn /DEST pdfmark end
 1305 4317
a -2 4484 a
SDict begin H.S end
 -2 4484 a -2 4484 a
SDict begin 13 H.A end
 -2 4484 a -2 4484 a
SDict begin [/View [/XYZ H.V]/Dest (0:4171) cvn /DEST pdfmark end
 -2
4484 a 396 4590 a Fj(Softw)o(are)20 b(is)h(my)f(b)n(usiness:)g(I)h
(code)e(to)i(eat,)f(and)g(to)g(feed)g(my)f(kids)i(and)e(to)i(mak)o(e)e
(sure)h(my)g(wife)h(doesn')o(t)d(lea)n(v)o(e)i(me)396
4698 y(for)g(someone)f(nicer)g(and)h(better)g(looking.)e(Y)-9
b(ou)20 b(see)g(the)h(challenge.)d(Of)j(course)e(I)2819
4698 y
SDict begin H.S end
 2819 4698 a 2819 4698 a
SDict begin 13 H.A end
 2819 4698 a 2819 4698
a
SDict begin [/View [/XYZ H.V]/Dest (0:4172) cvn /DEST pdfmark end
 2819 4698 a Fi(lo)o(ve)i Fj(coding)d(and)i(that)g(sensation)396
4806 y(of)g(sculpting)f(perfect)h(functionality)e(out)i(of)f(the)i(ra)o
(w)f(mass)g(of)g(possibility)-5 b(.)19 b(But)i(the)f(w)o(orld)g(doesn')
o(t)f(care)h(ho)n(w)396 4914 y(passionately)f(we)i(feel.)f(W)-7
b(e)21 b(wrest)g(our)e(li)n(ving)h(from)f(a)i(mark)o(et)e(that)h(is)h
(lar)o(gely)e(uninterested,)g(and)g(often)h(hostile)396
5022 y(when)g(it)h(does)f(notice.)f(This)h(is)i(the)e(Game,)g(and)f
(the)h(detailed)g(strate)o(gy)f(of)h(ho)n(w)g(to)g(win)h(it)f(is)i(for)
d(another)g(book,)396 5130 y(though)g(if)h(you)f(mak)o(e)h(it)h(to)f
(the)h(end)e(of)h(this)h(chapter)e(I')o(ll)h(toss)h(in)g(a)f(fe)n(w)g
(cheap)g(gimmicks.)p Black 3756 5569 a Fi(307)p Black
eop end
%%Page: 308 322
TeXDict begin 308 321 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.308) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4173) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(But)h(roughly:)d(you)h(identify)g(and)h(destro)o(y)f
(your)g(competitors,)g(you)g(de)n(v)o(elop)f(acti)n(v)o(e)i(strate)o
(gies,)g(you)f(learn)h(rapidly)-5 b(,)396 180 y(mo)o(v)o(e)19
b(quickly)-5 b(,)18 b(and)i(in)g(general)f(appreciate)g(the)h(Game)g
(as)h(a)g(constant)e(competition)g(in)h(which)g(e)n(v)o(ery)f
(participant)f(is)396 288 y(an)i(ally)-5 b(,)20 b(an)g(enemy)-5
b(,)19 b(or)h(the)g(ground)e(o)o(v)o(er)g(which)i(you)f(are)i
(\002ghting.)d(Friend,)i(foe,)f(or)h(food.)-2 317 y
SDict begin H.S end
 -2
317 a -2 317 a
SDict begin 13 H.A end
 -2 317 a -2 317 a
SDict begin [/View [/XYZ H.V]/Dest (0:4174) cvn /DEST pdfmark end
 -2 317 a 396 627 a Fd(7.2.2.)36
b(The)d(Contract)1465 627 y
SDict begin H.S end
 1465 627 a 1465 627 a
SDict begin 18.72 H.A end
 1465
627 a 1465 627 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.71.2) cvn /DEST pdfmark end
 1465 627 a -2 794 a
SDict begin H.S end
 -2 794 a -2 794
a
SDict begin 13 H.A end
 -2 794 a -2 794 a
SDict begin [/View [/XYZ H.V]/Dest (0:4176) cvn /DEST pdfmark end
 -2 794 a 396 901 a Fj(Here)20 b(is)h(a)g(story)-5
b(,)19 b(it)i(happened)d(to)i(the)h(eldest)f(brother)n(-in-la)o(w)d(of)
j(the)h(cousin)e(of)h(a)h(friend)e(of)h(mine')-5 b(s)20
b(colleague)f(at)396 1009 y(w)o(ork.)h(His)h(name)e(w)o(as,)i(and)f
(still)h(is,)g(P)o(atrick.)-2 1187 y
SDict begin H.S end
 -2 1187 a -2 1187
a
SDict begin 13 H.A end
 -2 1187 a -2 1187 a
SDict begin [/View [/XYZ H.V]/Dest (0:4177) cvn /DEST pdfmark end
 -2 1187 a 396 1283 a Fj(P)o(atrick)f(w)o(as)g(a)h
(computer)d(scientist,)i(with)g(a)g(PhD)g(in)h(adv)n(anced)c(netw)o
(ork)i(topologies.)f(He)i(spent)g(tw)o(o)g(years)g(and)f(his)396
1391 y(sa)n(vings)h(b)n(uilding)f(a)i(ne)n(w)f(product,)e(and)i(choose)
f(the)h(BSD)h(license)g(because)e(he)h(belie)n(v)o(ed)f(that)h(w)o
(ould)g(get)g(him)396 1499 y(more)g(adoption.)e(He)i(w)o(ork)o(ed)f(in)
i(his)f(attic,)h(at)g(great)e(personal)g(cost,)i(and)e(proudly)f
(published)h(his)h(w)o(ork.)g(People)396 1606 y(applauded,)e(for)i(it)g
(w)o(as)h(truly)f(f)o(antastic,)g(and)g(his)g(mailing)g(lists)h(were)f
(soon)g(ab)n(uzz)g(with)g(acti)n(vity)g(and)f(patches)h(and)396
1714 y(happ)o(y)f(chatter)-5 b(.)20 b(Man)o(y)f(companies)g(told)h(him)
g(ho)n(w)f(the)o(y)h(were)g(sa)n(ving)g(millions)g(using)g(his)g(w)o
(ork.)f(Some)h(of)g(them)396 1822 y(e)n(v)o(en)f(paid)h(him)g(for)g
(consultanc)o(y)e(and)h(training.)g(He)i(w)o(as)g(in)m(vited)e(to)h
(speak)g(at)h(conferences)d(and)h(started)i(collecting)396
1930 y(badges)e(with)h(his)g(name)f(on)g(them.)g(He)h(started)g(a)g
(small)g(b)n(usiness,)f(hired)g(a)h(friend)f(to)g(w)o(ork)g(with)h
(him,)f(and)g(dreamed)396 2038 y(of)h(making)f(it)i(big.)-2
2222 y
SDict begin H.S end
 -2 2222 a -2 2222 a
SDict begin 13 H.A end
 -2 2222 a -2 2222 a
SDict begin [/View [/XYZ H.V]/Dest (0:4178) cvn /DEST pdfmark end
 -2 2222
a 396 2312 a Fj(Then)f(one)f(day)-5 b(,)19 b(someone)g(pointed)g(him)h
(to)g(a)h(ne)n(w)f(project,)f(GPL)i(licensed,)e(which)h(had)f(fork)o
(ed)g(his)i(w)o(ork)e(and)h(w)o(as)396 2420 y(impro)o(ving)e(on)i(it.)g
(He)h(w)o(as)g(irritated)e(and)h(upset,)g(and)f(ask)o(ed)h(ho)n(w)g
(people)f(--)h(fello)n(w)g(open)f(sourcers,)g(no)h(less!)h(--)396
2528 y(w)o(ould)f(so)g(shamelessly)g(steal)h(his)g(code.)e(There)g
(were)i(long)e(ar)o(guments)f(on)i(the)g(list)h(about)f(whether)f(it)i
(w)o(as)g(e)n(v)o(en)396 2636 y(le)o(gal)f(to)g(relicense)g(their)g
(BSD)h(code)f(as)g(GPL)h(code.)e(T)l(urned)g(out,)h(it)h(w)o(as.)f(He)h
(tried)f(to)g(ignore)f(the)h(ne)n(w)g(project)g(b)n(ut)396
2744 y(then)g(he)g(soon)g(realized)f(that)h(ne)n(w)g(patches)g(coming)f
(from)g(that)h(project)2541 2744 y
SDict begin H.S end
 2541 2744 a 2541 2744
a
SDict begin 13 H.A end
 2541 2744 a 2541 2744 a
SDict begin [/View [/XYZ H.V]/Dest (0:4179) cvn /DEST pdfmark end
 2541 2744 a Fi(couldn')n(t)e(e)o(ven)h(be)h
(mer)m(g)o(ed)g(bac)n(k)i Fj(into)e(his)396 2852 y(w)o(ork!)-2
3019 y
SDict begin H.S end
 -2 3019 a -2 3019 a
SDict begin 13 H.A end
 -2 3019 a -2 3019 a
SDict begin [/View [/XYZ H.V]/Dest (0:4180) cvn /DEST pdfmark end
 -2 3019
a 396 3126 a Fj(W)-7 b(orse,)21 b(the)f(GPL)h(project)e(got)h(popular)e
(and)i(some)g(of)g(his)g(core)g(contrib)n(utors)e(made)i(\002rst)h
(small,)f(and)g(then)g(lar)o(ger)396 3234 y(patches)g(to)g(it.)h
(Again,)e(he)h(couldn')o(t)e(use)j(those)f(changes,)e(and)i(he)g(felt)h
(abandoned.)c(P)o(atrick)j(went)g(into)g(a)396 3342 y(depression,)f
(his)h(girlfriend)f(left)h(him)g(for)g(an)g(international)e(currenc)o
(y)g(dealer)i(called,)g(weirdly)-5 b(,)18 b(P)o(atrice,)i(and)g(he)396
3450 y(stopped)f(all)i(w)o(ork)f(on)f(the)i(project.)e(He)h(felt)h
(betrayed,)d(and)i(utterly)f(miserable.)g(He)i(\002red)f(his)h(friend,)
d(who)i(took)f(it)396 3557 y(rather)h(badly)f(and)g(told)h(e)n(v)o
(eryone)e(that)i(P)o(atrick)g(w)o(as)h(a)g(closet)f(banjo)f(player)-5
b(.)20 b(Finally)g(P)o(atrick)g(took)f(a)i(job)e(as)i(a)396
3665 y(project)f(manager)e(for)i(a)g(cloud)g(compan)o(y)-5
b(,)17 b(and)i(by)h(the)g(age)g(of)g(forty)-5 b(,)19
b(he)h(had)g(stopped)f(programming)d(e)n(v)o(en)k(for)f(fun.)-2
3849 y
SDict begin H.S end
 -2 3849 a -2 3849 a
SDict begin 13 H.A end
 -2 3849 a -2 3849 a
SDict begin [/View [/XYZ H.V]/Dest (0:4181) cvn /DEST pdfmark end
 -2 3849
a 396 3939 a Fj(Poor)h(P)o(atrick,)f(I)i(almost)f(felt)g(sorry)g(for)f
(him.)h(Then)f(I)i(ask)o(ed)f(him,)f("why)h(didn')o(t)e(you)h(choose)h
(the)g(GPL?")g("Because)396 4047 y(it')-5 b(s)22 b(a)e(restricti)n(v)o
(e)g(viral)g(license",)f(he)i(replied.)e(I)h(told)g(him,)g(you)f(may)h
(ha)n(v)o(e)f(a)i(PhD,)f(and)g(you)f(may)h(be)g(the)g(eldest)396
4155 y(brother)n(-in-la)o(w)e(of)i(the)g(cousin)f(of)h(a)h(friend)e(of)
h(my)g(colleague,)e(b)n(ut)i(you)g(are)g(an)g(idiot)g(and)g(Monique)e
(w)o(as)j(smart)f(to)396 4263 y(lea)n(v)o(e)g(you.)f(Y)-9
b(ou)20 b(published)f(your)f(w)o(ork)i(saying,)f("please)h(steal)h(my)f
(code)g(as)h(long)e(as)i(you)e(k)o(eep)h(this)h('please)e(steal)396
4371 y(my)h(code')f(statement)h(in)h(the)f(resulting)f(w)o(ork",)g(and)
h(when)g(people)f(did)g(e)o(xactly)h(that,)g(you)f(got)h(upset.)g(W)-7
b(orse,)20 b(you)396 4479 y(were)g(a)g(hypocrite)d(because)i(when)g
(the)o(y)g(did)g(it)h(in)g(secret,)f(you)g(were)g(happ)o(y)-5
b(,)18 b(b)n(ut)h(when)g(the)o(y)g(did)g(it)h(openly)-5
b(,)18 b(you)h(felt)396 4587 y(betrayed.)-2 4771 y
SDict begin H.S end
 -2
4771 a -2 4771 a
SDict begin 13 H.A end
 -2 4771 a -2 4771 a
SDict begin [/View [/XYZ H.V]/Dest (0:4182) cvn /DEST pdfmark end
 -2 4771 a 396 4861
a Fj(Seeing)h(your)f(hard)g(w)o(ork)h(captured)e(by)i(a)h(smarter)e
(team)i(and)e(then)h(used)g(against)f(you)h(is)h(enormously)d(painful,)
g(so)396 4969 y(why)i(e)n(v)o(en)f(mak)o(e)g(that)i(possible?)f(Ev)o
(ery)e(proprietary)g(project)h(that)i(uses)f(BSD)h(code)f(is)h
(capturing)d(it.)j(A)g(public)396 5077 y(GPL)g(fork)e(is)i(perhaps)e
(more)g(humiliating,)g(b)n(ut)h(it')-5 b(s)21 b(fully)f
(self-in\003icted.)p Black 3759 5569 a Fi(308)p Black
eop end
%%Page: 309 323
TeXDict begin 309 322 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.309) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4198) cvn /DEST pdfmark end
 -2 -201 a 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4183) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(BSD)h(is)h(lik)o(e)e(food.)f(It)h(literally)g(\(and)g
(I)g(mean)g(that)g(metaphorically\))d(whispers)j("eat)h(me")f(in)g(the)
g(little)h(v)n(oice)f(one)396 180 y(imagines)g(a)g(cube)g(of)g(cheese)g
(might)f(use)i(when)e(it')-5 b(s)22 b(sitting)e(ne)o(xt)g(to)g(an)g
(empty)f(bottle)h(of)g(Orv)n(al.)g(The)f(BSD)j(license,)396
288 y(lik)o(e)f(its)g(near)f(clone)f(MIT/X11,)g(w)o(as)i(designed)e
(speci\002cally)h(by)f(a)i(uni)n(v)o(ersity)e(\(Berk)o(ele)o(y\))f
(with)j(no)e(pro\002t)h(moti)n(v)o(e,)396 396 y(to)h(leak)f(w)o(ork)f
(and)h(ef)n(fort.)f(It)h(is)h(a)g(w)o(ay)f(to)g(push)g(subsidized)f
(technology)f(at)j(belo)n(w)e(its)j(cost)e(price,)g(a)g(dumping)e(of)
396 504 y(under)n(-priced)g(code)h(in)h(the)h(hope)e(that)h(it)h(will)g
(break)e(the)h(mark)o(et)g(for)f(others.)h(BSD)h(is)g(an)3066
504 y
SDict begin H.S end
 3066 504 a 3066 504 a
SDict begin 13 H.A end
 3066 504 a 3066 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:4184) cvn /DEST pdfmark end
 3066
504 a Fi(e)n(xcellent)h Fj(tool)e(in)g(the)396 612 y(Game,)g(b)n(ut)g
(only)g(if)g(you')l(re)e(a)j(lar)o(ge)e(well-funded)f(institution)i
(that)g(can)g(af)n(ford)e(to)j(use)f(Option)g(One.)f(The)h(Apache)396
720 y(license)h(is)g(BSD)g(in)f(a)h(suit.)-2 887 y
SDict begin H.S end
 -2
887 a -2 887 a
SDict begin 13 H.A end
 -2 887 a -2 887 a
SDict begin [/View [/XYZ H.V]/Dest (0:4185) cvn /DEST pdfmark end
 -2 887 a 396 994 a Fj(F)o(or)f(us)h
(small)f(b)n(usinesses)h(who)f(aim)g(our)f(in)m(v)o(estments)g(lik)o(e)
i(precious)e(b)n(ullets,)h(leaking)f(w)o(ork)h(and)f(ef)n(fort)g(is)396
1102 y(unacceptable.)f(Breaking)h(the)h(mark)o(et)g(is)h(great,)f(b)n
(ut)g(we)g(cannot)f(af)n(ford)g(to)h(subsidize)g(our)f(competitors.)g
(The)h(BSD)396 1210 y(netw)o(orking)e(stack)j(ended)e(up)h(putting)f(W)
m(indo)n(ws)g(on)h(the)g(Internet.)f(W)-7 b(e)21 b(cannot)e(af)n(ford)g
(battles)h(with)h(those)f(we)396 1318 y(should)f(naturally)g(be)h
(allies)h(with.)g(W)-7 b(e)21 b(cannot)e(af)n(ford)g(to)h(mak)o(e)g
(fundamental)d(b)n(usiness)k(errors)e(because)h(in)g(the)396
1426 y(end,)g(that)g(means)g(we)g(ha)n(v)o(e)g(to)g(\002re)h(people.)-2
1610 y
SDict begin H.S end
 -2 1610 a -2 1610 a
SDict begin 13 H.A end
 -2 1610 a -2 1610 a
SDict begin [/View [/XYZ H.V]/Dest (0:4186) cvn /DEST pdfmark end
 -2 1610
a 396 1700 a Fj(It)g(comes)f(do)n(wn)f(to)h(beha)n(vioral)f(economics)f
(and)i(game)f(theory)-5 b(.)2324 1700 y
SDict begin H.S end
 2324 1700 a 2324
1700 a
SDict begin 13 H.A end
 2324 1700 a 2324 1700 a
SDict begin [/View [/XYZ H.V]/Dest (0:4187) cvn /DEST pdfmark end
 2324 1700 a Fi(The)20
b(license)g(we)h(c)o(hoose)e(modi\002es)h(the)g(economics)396
1808 y(of)h(those)f(who)g(use)g(our)g(work)q Fj(.)h(In)f(the)g(Game)g
(there)g(are)g(friends,)f(foes,)h(and)g(food.)e(BSD)k(mak)o(es)e(most)g
(people)f(see)i(us)396 1916 y(as)g(lunch.)e(Closed)i(source)e(mak)o(es)
h(most)g(people)f(see)i(us)g(as)g(enemies)e(\(do)h(you)2738
1916 y
SDict begin H.S end
 2738 1916 a 2738 1916 a
SDict begin 13 H.A end
 2738 1916 a 2738 1916
a
SDict begin [/View [/XYZ H.V]/Dest (0:4188) cvn /DEST pdfmark end
 2738 1916 a Fi(lik)o(e)h Fj(paying)e(people)g(for)g(softw)o(are?\))
396 2023 y(GPL,)i(ho)n(we)n(v)o(er)m(,)c(mak)o(es)j(most)h(people,)d
(with)j(the)f(e)o(xception)e(of)i(the)g(P)o(atricks)g(of)g(the)g(w)o
(orld,)g(our)f(allies.)i(An)o(y)f(fork)396 2131 y(of)g(\330MQ)h(is)g
(license)f(compatible)f(with)h(\330MQ,)g(to)h(the)f(point)f(where)h(we)
2561 2131 y
SDict begin H.S end
 2561 2131 a 2561 2131 a
SDict begin 13 H.A end
 2561 2131 a 2561
2131 a
SDict begin [/View [/XYZ H.V]/Dest (0:4189) cvn /DEST pdfmark end
 2561 2131 a Fi(encour)o(a)o(g)o(e)f Fj(forks)g(as)i(a)g(v)n
(aluable)e(tool)h(for)396 2239 y(e)o(xperimentation.)d(Y)-8
b(es,)20 b(it)h(can)f(be)g(weird)g(to)h(see)f(someone)f(try)h(run)g(of)
n(f)f(with)h(the)h(ball)f(b)n(ut,)g(and)g(here')-5 b(s)20
b(the)g(secret,)3837 2239 y
SDict begin H.S end
 3837 2239 a 3837 2239 a
SDict begin 13 H.A end
 3837
2239 a 3837 2239 a
SDict begin [/View [/XYZ H.V]/Dest (0:4190) cvn /DEST pdfmark end
 3837 2239 a Fi(I)396 2347 y(can)g(g)o(et)g(it)h(bac)
n(k)f(any)g(time)g(I)h(want.)-2 2375 y
SDict begin H.S end
 -2 2375 a -2 2375
a
SDict begin 13 H.A end
 -2 2375 a -2 2375 a
SDict begin [/View [/XYZ H.V]/Dest (0:4191) cvn /DEST pdfmark end
 -2 2375 a 396 2686 a Fd(7.2.3.)36
b(The)d(Pr)n(ocess)1436 2686 y
SDict begin H.S end
 1436 2686 a 1436 2686
a
SDict begin 18.72 H.A end
 1436 2686 a 1436 2686 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.72.2) cvn /DEST pdfmark end
 1436 2686 a -2 2853 a
SDict begin H.S end
 -2 2853
a -2 2853 a
SDict begin 13 H.A end
 -2 2853 a -2 2853 a
SDict begin [/View [/XYZ H.V]/Dest (0:4193) cvn /DEST pdfmark end
 -2 2853 a 396 2960 a
Fj(If)20 b(you')l(v)o(e)e(accepted)h(my)h(thesis)h(up)f(to)g(no)n(w)-5
b(,)19 b(great!)h(No)n(w)-5 b(,)19 b(I')o(ll)h(e)o(xplain)f(the)i
(rough)d(process)i(by)g(which)f(we)i(actually)396 3068
y(b)n(uild)f(an)g(open)f(source)h(community)-5 b(.)17
b(This)j(w)o(as)i(ho)n(w)d(we)i(b)n(uilt)f(or)g(gre)n(w)g(or)g(gently)f
(steered)h(the)g(\330MQ)g(community)396 3176 y(into)g(e)o(xistence.)-2
3342 y
SDict begin H.S end
 -2 3342 a -2 3342 a
SDict begin 13 H.A end
 -2 3342 a -2 3342 a
SDict begin [/View [/XYZ H.V]/Dest (0:4194) cvn /DEST pdfmark end
 -2 3342
a 396 3450 a Fj(Y)-9 b(ou)20 b(recall)g(the)g(simplicity-oriented)e
(design)h(process)h(from)f(The)h(Human)f(Scale)p 0 TeXcolorgray
2815 3450 a
SDict begin H.S end
 2815 3450 a Fj(Chapter)h(6)3141 3450 y
SDict begin 13 H.L end
 3141
3450 a 3141 3450 a
SDict begin [/Subtype /Link/Dest (0:the-human-scale) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3141 3450 a Black -1 w Fj(,)h(where)e(I)i(claimed)e
(that)396 3557 y(we)i(b)n(uild)f(successfully)f(accurate)g(softw)o(are)
h(by)g(successfully)g(e)o(xploring)d(the)k(problem)d(landscape,)h
(rather)g(than)h(by)396 3665 y(sheer)g(intellectual)g(ef)n(fort.)f(K)n
(eep)h(this)g(in)h(mind.)e(No)n(w)-5 b(,)19 b(see)i(your)e(community)f
(as)j(a)g(group)d(e)o(xploring)g(that)396 3773 y(landscape)h(and)h
(sharing)f(the)h(results)h(of)f(their)g(w)o(ork.)-2 3957
y
SDict begin H.S end
 -2 3957 a -2 3957 a
SDict begin 13 H.A end
 -2 3957 a -2 3957 a
SDict begin [/View [/XYZ H.V]/Dest (0:4196) cvn /DEST pdfmark end
 -2 3957 a 396
4047 a Fj(Y)-9 b(our)19 b(goal)h(as)h(leader)f(of)g(a)g(community)e(is)
j(to)g(moti)n(v)n(ate)e(people)g(to)h(get)h(out)e(there)h(and)g(e)o
(xplore;)e(to)j(ensure)e(the)o(y)h(can)396 4155 y(do)g(so)h(safely)f
(and)f(without)h(disturbing)e(others;)i(to)g(re)n(w)o(ard)g(them)f
(when)h(the)o(y)f(mak)o(e)h(successful)g(disco)o(v)o(eries;)f(and)396
4263 y(to)i(ensure)e(the)o(y)h(share)f(their)h(kno)n(wledge)e(with)j(e)
n(v)o(eryone)c(else)k(\(and)f(not)f(because)h(we)h(ask)f(them,)f(not)h
(because)g(the)o(y)396 4371 y(feel)g(generous,)f(b)n(ut)h(because)f
(it')-5 b(s)22 b(The)e(La)o(w\).)-2 4555 y
SDict begin H.S end
 -2 4555 a
-2 4555 a
SDict begin 13 H.A end
 -2 4555 a -2 4555 a
SDict begin [/View [/XYZ H.V]/Dest (0:4197) cvn /DEST pdfmark end
 -2 4555 a 396 4645 a Fj(It)g(is)g(an)g
(iterati)n(v)o(e)e(process.)h(Y)-9 b(ou)19 b(mak)o(e)g(a)g(small)h
(product,)d(at)j(your)e(o)n(wn)h(cost,)h(b)n(ut)f(in)h(public)e(vie)n
(w)-5 b(.)19 b(Y)-9 b(ou)18 b(then)h(b)n(uild)g(a)396
4753 y(small)i(community)d(around)g(that)j(product.)d(If)i(you)f(ha)n
(v)o(e)h(a)g(small)h(b)n(ut)f(real)g(hit,)g(the)h(community)d(then)h
(helps)h(design)396 4861 y(and)g(b)n(uild)f(the)h(ne)o(xt)f(v)o
(ersion,)f(and)i(gro)n(ws)f(lar)o(ger)-5 b(.)19 b(And)g(then)g(that)h
(community)e(b)n(uilds)i(the)f(ne)o(xt)h(v)o(ersion,)e(and)h(so)h(on.)
396 4969 y(It')-5 b(s)21 b(e)n(vident)e(that)h(you)g(remain)f(part)h
(of)g(the)g(community)-5 b(,)17 b(maybe)j(e)n(v)o(en)f(a)h(majority)f
(contrib)n(utor)m(,)f(b)n(ut)i(the)g(more)p Black 3759
5569 a Fi(309)p Black eop end
%%Page: 310 324
TeXDict begin 310 323 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.310) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(control)f(you)h(try)f(to)i(assert)g(o)o(v)o(er)d(the)
j(material)e(results,)i(the)f(less)h(people)e(will)i(w)o(ant)g(to)f
(participate.)f(Plan)h(your)f(o)n(wn)396 180 y(retirement)g(well)i
(before)e(someone)g(decides)g(you)h(are)g(their)g(ne)o(xt)f(problem.)-2
209 y
SDict begin H.S end
 -2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:4198) cvn /DEST pdfmark end
 -2 209 a 396
519 a Fd(7.2.4.)36 b(Crazy)-10 b(,)34 b(Beautiful,)h(and)f(Easy)2213
519 y
SDict begin H.S end
 2213 519 a 2213 519 a
SDict begin 18.72 H.A end
 2213 519 a 2213 519 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.73.2) cvn /DEST pdfmark end
 2213
519 a -2 710 a
SDict begin H.S end
 -2 710 a -2 710 a
SDict begin 13 H.A end
 -2 710 a -2 710 a
SDict begin [/View [/XYZ H.V]/Dest (0:4200) cvn /DEST pdfmark end
 -2
710 a 396 793 a Fj(Y)-9 b(ou)19 b(need)g(a)h(goal)f(that')-5
b(s)20 b(crazy)f(and)f(simple)i(enough)d(to)j(get)g(people)e(out)h(of)g
(bed)g(in)h(the)f(morning.)e(Y)-9 b(our)19 b(community)396
901 y(has)i(to)f(attract)g(the)g(v)o(ery)g(best)g(people)f(and)h(that)g
(demands)f(something)g(special.)h(W)m(ith)g(\330MQ,)g(we)h(said)f(we)h
(were)396 1009 y(going)e(to)h(mak)o(e)g("the)g(F)o(astest.)h
(Messaging.)e(Ev)o(er)-5 b(.",)20 b(which)f(quali\002es)h(as)h(a)g
(good)e(moti)n(v)n(ator)-5 b(.)18 b(If)i(we')l(d)g(said,)g(we')l(re)396
1117 y(going)f(to)h(mak)o(e)g("a)h(smart)f(transport)f(layer)h(that')o
(ll)g(connect)f(your)g(mo)o(ving)f(pieces)i(cheaply)f(and)h(\003e)o
(xibly)f(across)396 1225 y(your)g(enterprise",)g(we')l(d)g(ha)n(v)o(e)h
(f)o(ailed.)-2 1409 y
SDict begin H.S end
 -2 1409 a -2 1409 a
SDict begin 13 H.A end
 -2 1409 a -2
1409 a
SDict begin [/View [/XYZ H.V]/Dest (0:4201) cvn /DEST pdfmark end
 -2 1409 a 396 1499 a Fj(Then)g(your)f(w)o(ork)g(must)h(be)g
(beautiful,)f(immediately)g(useful)h(and)f(attracti)n(v)o(e.)g(Y)-9
b(our)20 b(contrib)n(utors)e(are)i(users)g(who)396 1606
y(w)o(ant)h(to)f(e)o(xplore)e(just)j(a)g(little)g(be)o(yond)d(where)h
(the)o(y)h(are)g(no)n(w)-5 b(.)19 b(Mak)o(e)h(it)h(simple,)f(ele)o
(gant,)e(brutally)h(clean.)h(The)396 1714 y(e)o(xperience)e(when)i
(people)f(run)g(or)h(use)h(your)e(w)o(ork)g(should)g(be)i(an)f
(emotional)f(one.)g(The)o(y)g(should)3321 1714 y
SDict begin H.S end
 3321
1714 a 3321 1714 a
SDict begin 13 H.A end
 3321 1714 a 3321 1714 a
SDict begin [/View [/XYZ H.V]/Dest (0:4202) cvn /DEST pdfmark end
 3321 1714
a Fi(feel)i Fj(something,)396 1822 y(and)f(if)g(you)f(accurately)g
(solv)o(ed)g(e)n(v)o(en)h(just)g(one)g(big)f(problem)g(that)h(until)g
(then)g(the)o(y)f(didn')o(t)g(quite)g(realize)h(the)o(y)g(f)o(aced,)396
1930 y(you')o(ll)g(ha)n(v)o(e)f(a)i(small)f(part)g(of)g(their)g(soul.)
-2 2114 y
SDict begin H.S end
 -2 2114 a -2 2114 a
SDict begin 13 H.A end
 -2 2114 a -2 2114 a
SDict begin [/View [/XYZ H.V]/Dest (0:4203) cvn /DEST pdfmark end
 -2
2114 a 396 2204 a Fj(And)g(then,)f(easy)i(to)f(understand,)e(use,)i
(and)g(join.)f(T)-7 b(oo)20 b(man)o(y)f(projects)h(ha)n(v)o(e)f
(barriers)h(to)g(access:)h(put)f(yourself)f(in)396 2312
y(the)h(other)g(person')-5 b(s)19 b(mind)h(and)f(see)i(all)g(the)f
(reasons)g(the)o(y)f(come)h(to)g(your)f(site,)i(thinking)e("Uhm,)g
(interesting)396 2420 y(project,)g(b)n(ut...")h(and)f(then)h(lea)n(v)o
(e.)g(Y)-9 b(ou)19 b(w)o(ant)i(them)e(to)i(stay)-5 b(,)20
b(try)g(it,)g(just)h(once.)e(Use)i(GitHub)f(and)g(put)g(the)g(issue)396
2528 y(track)o(er)g(right)f(there.)-2 2712 y
SDict begin H.S end
 -2 2712
a -2 2712 a
SDict begin 13 H.A end
 -2 2712 a -2 2712 a
SDict begin [/View [/XYZ H.V]/Dest (0:4204) cvn /DEST pdfmark end
 -2 2712 a 396 2802 a
Fj(If)h(you)g(do)f(these)i(things)e(well,)i(your)e(community)f(will)j
(be)f(smart)g(b)n(ut)g(more)g(importantly)-5 b(,)17 b(will)k(be)f
(intellectually)396 2910 y(and)g(geographically)d(di)n(v)o(erse.)i
(This)h(is)i(really)d(important.)g(A)h(group)f(of)h(lik)o(e-minded)e(e)
o(xperts)h(cannot)g(e)o(xplore)g(the)396 3018 y(problem)g(landscape)g
(well.)h(The)o(y)f(tend)h(to)g(mak)o(e)g(big)g(mistak)o(es.)g(Di)n(v)o
(ersity)g(beats)g(education)f(an)o(y)g(time.)-2 3046
y
SDict begin H.S end
 -2 3046 a -2 3046 a
SDict begin 13 H.A end
 -2 3046 a -2 3046 a
SDict begin [/View [/XYZ H.V]/Dest (0:4205) cvn /DEST pdfmark end
 -2 3046 a 396
3356 a Fd(7.2.5.)36 b(Strang)q(er)-7 b(,)33 b(meet)h(Strang)q(er)2086
3356 y
SDict begin H.S end
 2086 3356 a 2086 3356 a
SDict begin 18.72 H.A end
 2086 3356 a 2086 3356
a
SDict begin [/View [/XYZ H.V]/Dest (12.75.74.2) cvn /DEST pdfmark end
 2086 3356 a -2 3549 a
SDict begin H.S end
 -2 3549 a -2 3549 a
SDict begin 13 H.A end
 -2 3549 a
-2 3549 a
SDict begin [/View [/XYZ H.V]/Dest (0:4207) cvn /DEST pdfmark end
 -2 3549 a 396 3630 a Fj(Ho)n(w)20 b(much)g(up-front)d
(agreement)i(do)h(tw)o(o)g(people)f(need)h(to)g(w)o(ork)g(together)e
(on)i(something?)f(In)h(most)396 3738 y(or)o(ganizations,)d(a)k(lot.)f
(But)h(you)e(can)h(bring)f(this)i(cost)f(do)n(wn)f(to)i(near)n(-zero,)d
(and)i(then)f(people)g(can)h(collaborate)396 3846 y(without)g(ha)n
(ving)f(e)n(v)o(er)g(met,)h(done)f(a)i(phone)e(conference,)e(meeting,)i
(or)h(b)n(usiness)h(trip)f(to)g(discuss)h(Roles)g(and)396
3954 y(Responsibilities)g(o)o(v)o(er)d(w)o(ay)j(too)e(man)o(y)g
(bottles)i(of)e(soju.)-2 4138 y
SDict begin H.S end
 -2 4138 a -2 4138 a
SDict begin 13 H.A end
 -2
4138 a -2 4138 a
SDict begin [/View [/XYZ H.V]/Dest (0:4208) cvn /DEST pdfmark end
 -2 4138 a 396 4228 a Fj(Y)-9 b(ou)20
b(need)f(well-written)h(rules)g(that)g(are)g(designed)f(by)h(c)o
(ynical)f(people)h(lik)o(e)g(me)g(to)h(force)e(strangers)g(into)h
(mutually)396 4336 y(bene\002cial)g(collaboration)e(instead)i(of)g
(con\003ict.)f(The)h(GPL)h(is)g(a)f(good)f(start.)i(GitHub)e(and)h(its)
h(fork/mer)o(ge)c(strate)o(gy)396 4444 y(is)k(a)g(good)e(follo)n(w-up.)
f(And)h(then)h(you)f(w)o(ant)i(something)d(lik)o(e)j(our)2380
4444 y
SDict begin H.S end
 2380 4444 a 2380 4444 a
SDict begin 13 H.A end
 2380 4444 a 2380 4444
a
SDict begin [/View [/XYZ H.V]/Dest (0:4209) cvn /DEST pdfmark end
 2380 4444 a Fj(C4)g(rulebook)d(\(http://rfc.zeromq.or)o(g/spe)o(c:16)
o(\))396 4552 y(to)j(control)e(ho)n(w)g(w)o(ork)h(actually)f(happens.)
-2 4736 y
SDict begin H.S end
 -2 4736 a -2 4736 a
SDict begin 13 H.A end
 -2 4736 a -2 4736 a
SDict begin [/View [/XYZ H.V]/Dest (0:4210) cvn /DEST pdfmark end
 -2
4736 a 396 4826 a Fj(C4)i(\(which)e(I)i(no)n(w)e(use)i(for)e(e)n(v)o
(ery)g(ne)n(w)h(open)f(source)h(project\))f(has)h(detailed)g(and)f
(tested)i(answers)f(to)g(a)h(lot)f(of)396 4934 y(common)e(mistak)o(es)i
(people)e(mak)o(e.)h(F)o(or)g(e)o(xample,)e(the)j(sin)g(of)f(w)o
(orking)f(of)n(f-line)g(in)h(a)h(corner)e(with)i(others)f("because)396
5042 y(it')-5 b(s)22 b(f)o(aster".)d(T)m(ransparenc)o(y)f(is)j
(essential)g(to)f(get)g(trust,)g(which)g(is)h(essential)g(to)f(get)g
(scale.)h(By)g(forcing)d(e)n(v)o(ery)h(single)396 5150
y(change)g(through)f(a)j(single)f(transparent)e(process,)i(you)f(b)n
(uild)h(real)g(trust)h(in)f(the)g(results.)p Black 3759
5569 a Fi(310)p Black eop end
%%Page: 311 325
TeXDict begin 311 324 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.311) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4211) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Another)f(cardinal)g(sin)i(that)f(man)o(y)f(open)g
(source)h(de)n(v)o(elopers)e(mak)o(e)i(is)h(to)f(place)g(themselv)o(es)
f(abo)o(v)o(e)g(others.)g("I)396 180 y(founded)f(this)j(project)e(thus)
h(my)g(intellect)g(is)h(superior)e(to)i(that)f(of)g(others".)f(It')-5
b(s)21 b(not)f(just)h(immodest)e(and)g(rude,)h(and)396
288 y(usually)g(inaccurate,)f(it')-5 b(s)21 b(also)f(poor)f(b)n
(usiness.)h(The)g(rules)g(must)h(apply)e(equally)g(to)h(e)n(v)o
(eryone,)e(without)h(distinction.)396 396 y(Y)-9 b(ou)20
b(are)g(part)g(of)g(the)g(community)-5 b(.)17 b(Y)-9
b(our)20 b(job,)f(as)i(founder)d(of)i(a)h(project,)e(is)i(not)f(to)g
(impose)g(your)e(vision)i(of)g(the)396 504 y(product)f(o)o(v)o(er)f
(others,)i(b)n(ut)g(to)g(mak)o(e)g(sure)g(the)g(rules)h(are)f(good,)e
(honest,)i(and)2683 504 y
SDict begin H.S end
 2683 504 a 2683 504 a
SDict begin 13 H.A end
 2683
504 a 2683 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:4212) cvn /DEST pdfmark end
 2683 504 a Fi(enfor)m(ced)r Fj(.)-2
533 y
SDict begin H.S end
 -2 533 a -2 533 a
SDict begin 13 H.A end
 -2 533 a -2 533 a
SDict begin [/View [/XYZ H.V]/Dest (0:4213) cvn /DEST pdfmark end
 -2 533 a 396
843 a Fd(7.2.6.)36 b(In\002nite)e(Pr)n(oper)r(ty)1646
843 y
SDict begin H.S end
 1646 843 a 1646 843 a
SDict begin 18.72 H.A end
 1646 843 a 1646 843 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.75.2) cvn /DEST pdfmark end
 1646
843 a -2 1033 a
SDict begin H.S end
 -2 1033 a -2 1033 a
SDict begin 13 H.A end
 -2 1033 a -2 1033
a
SDict begin [/View [/XYZ H.V]/Dest (0:4215) cvn /DEST pdfmark end
 -2 1033 a 396 1117 a Fj(One)20 b(of)g(the)g(saddest)h(myths)e(of)h
(the)g(kno)n(wledge)e(b)n(usiness)j(is)g(that)f(ideas)h(are)f(a)g
(sensible)h(form)e(of)h(property)-5 b(.)17 b(It')-5 b(s)396
1225 y(medie)n(v)n(al)19 b(nonsense)g(that)i(should)e(ha)n(v)o(e)g
(been)h(junk)o(ed)f(along)g(with)h(sla)n(v)o(ery)-5 b(,)19
b(b)n(ut)i(sadly)f(it')-5 b(s)21 b(still)g(making)e(too)h(man)o(y)396
1333 y(po)n(werful)f(people)g(too)h(much)f(mone)o(y)-5
b(.)-2 1517 y
SDict begin H.S end
 -2 1517 a -2 1517 a
SDict begin 13 H.A end
 -2 1517 a -2 1517 a
SDict begin [/View [/XYZ H.V]/Dest (0:4216) cvn /DEST pdfmark end

-2 1517 a 396 1606 a Fj(Ideas)20 b(are)g(cheap.)f(What)i(does)f(w)o
(ork)f(sensibly)h(as)h(property)d(is)j(the)g(hard)e(w)o(ork)g(we)i(do)f
(in)g(b)n(uilding)f(a)i(mark)o(et.)e("Y)-9 b(ou)396 1714
y(eat)21 b(what)f(you)f(kill")i(is)g(the)f(right)g(model)f(for)g
(encouraging)f(people)h(to)h(w)o(ork)g(hard.)f(Whether)g(it')-5
b(s)21 b(moral)f(authority)396 1822 y(o)o(v)o(er)f(a)i(project,)e(mone)
o(y)f(from)h(consulting,)g(or)h(the)g(sale)h(of)f(a)g(trademark)f(to)h
(some)g(lar)o(ge,)f(rich)h(\002rm:)g(if)h(you)e(mak)o(e)h(it,)396
1930 y(you)g(o)n(wn)f(it.)i(But)g(what)f(you)f(really)h(o)n(wn)f(is)j
("footf)o(all",)c(participants)i(in)g(your)f(project,)g(which)h
(ultimately)f(de\002nes)396 2038 y(your)g(po)n(wer)g(in)i(the)f(Game.)
-2 2222 y
SDict begin H.S end
 -2 2222 a -2 2222 a
SDict begin 13 H.A end
 -2 2222 a -2 2222 a
SDict begin [/View [/XYZ H.V]/Dest (0:4217) cvn /DEST pdfmark end
 -2
2222 a 396 2312 a Fj(T)-7 b(o)20 b(do)g(this)g(requires)f(in\002nite)g
(free)h(space.)f(Thankfully)-5 b(,)17 b(GitHub)i(solv)o(ed)g(this)i
(problem)d(for)h(us,)h(for)f(which)g(I)h(will)h(die)396
2420 y(a)g(grateful)e(person)g(\(there)g(are)h(man)o(y)f(reasons)h(to)g
(be)h(grateful)e(in)h(life,)g(which)g(I)g(w)o(on')o(t)f(list)j(here)d
(because)h(we)g(only)396 2528 y(ha)n(v)o(e)g(a)g(hundred)e(or)i(so)h
(pages)f(left,)g(b)n(ut)g(this)h(is)g(one)e(of)h(them\).)-2
2712 y
SDict begin H.S end
 -2 2712 a -2 2712 a
SDict begin 13 H.A end
 -2 2712 a -2 2712 a
SDict begin [/View [/XYZ H.V]/Dest (0:4218) cvn /DEST pdfmark end
 -2 2712
a 396 2802 a Fj(Y)-9 b(ou)20 b(cannot)f(scale)i(a)f(single)g(project)g
(with)g(man)o(y)f(o)n(wners)g(lik)o(e)i(you)e(can)h(scale)h(a)g
(collection)e(of)h(man)o(y)f(small)396 2910 y(projects,)h(each)f(with)i
(fe)n(wer)e(o)n(wners.)h(When)g(we)g(embrace)f(forks,)g(a)i(person)e
(can)h(become)f(an)h("o)n(wner")f(with)h(a)396 3018 y(single)g(click.)g
(No)n(w)g(the)o(y)g(just)h(ha)n(v)o(e)e(to)h(con)m(vince)f(others)g(to)
i(join,)e(by)h(demonstrating)e(their)i(unique)f(v)n(alue.)-2
3202 y
SDict begin H.S end
 -2 3202 a -2 3202 a
SDict begin 13 H.A end
 -2 3202 a -2 3202 a
SDict begin [/View [/XYZ H.V]/Dest (0:4219) cvn /DEST pdfmark end
 -2 3202
a 396 3292 a Fj(So)i(in)f(\330MQ)g(we)h(aimed)f(to)g(mak)o(e)g(it)h
(easy)f(to)g(write)h(bindings)d(on)i(top)g(of)g(the)g(core)g(library)-5
b(,)18 b(and)i(we)g(stopped)g(trying)396 3400 y(to)h(mak)o(e)e(those)h
(bindings)f(ourselv)o(es.)g(This)h(created)g(space)g(for)f(others)h(to)
g(mak)o(e)g(those,)g(become)f(their)h(o)n(wners,)f(get)396
3508 y(that)i(credit.)-2 3519 y
SDict begin H.S end
 -2 3519 a -2 3519 a
SDict begin 13 H.A end
 -2
3519 a -2 3519 a
SDict begin [/View [/XYZ H.V]/Dest (0:4220) cvn /DEST pdfmark end
 -2 3519 a 396 3846 a Fd(7.2.7.)36 b(Care)e(and)f
(Feeding)1730 3846 y
SDict begin H.S end
 1730 3846 a 1730 3846 a
SDict begin 18.72 H.A end
 1730 3846
a 1730 3846 a
SDict begin [/View [/XYZ H.V]/Dest (12.75.76.2) cvn /DEST pdfmark end
 1730 3846 a -2 4039 a
SDict begin H.S end
 -2 4039 a -2 4039
a
SDict begin 13 H.A end
 -2 4039 a -2 4039 a
SDict begin [/View [/XYZ H.V]/Dest (0:4222) cvn /DEST pdfmark end
 -2 4039 a 396 4120 a Fj(I)21 b(wish)f(a)h
(community)d(could)h(be)h(100\045)g(self-steering,)f(and)g(perhaps)g
(one)h(day)f(this)i(will)g(w)o(ork,)e(b)n(ut)i(today)e(it')-5
b(s)21 b(not)396 4228 y(the)f(case.)h(W)-7 b(e')l(re)20
b(v)o(ery)f(close)h(with)g(\330MQ,)g(b)n(ut)g(from)f(my)h(e)o
(xperience)e(a)i(community)e(needs)i(four)f(types)h(of)f(care)h(and)396
4336 y(feeding:)-2 4354 y
SDict begin H.S end
 -2 4354 a -2 4354 a
SDict begin 13 H.A end
 -2 4354
a -2 4354 a
SDict begin [/View [/XYZ H.V]/Dest (0:4223) cvn /DEST pdfmark end
 -2 4354 a -2 4364 a
SDict begin H.S end
 -2 4364 a -2 4364 a
SDict begin 13 H.A end
 -2
4364 a -2 4364 a
SDict begin [/View [/XYZ H.V]/Dest (0:4224) cvn /DEST pdfmark end
 -2 4364 a Black 396 4506 a Fe(\225)p
Black 479 4506 a
SDict begin H.S end
 479 4506 a 479 4506 a
SDict begin 13 H.A end
 479 4506 a 479
4506 a
SDict begin [/View [/XYZ H.V]/Dest (0:4225) cvn /DEST pdfmark end
 479 4506 a Fj(First,)h(simply)f(because)f(most)i(people)e(are)h
(too)g(nice,)g(we)g(need)g(some)g(kind)f(of)h(symbolic)f(leadership)g
(or)h(o)n(wners)479 4614 y(who)g(pro)o(vide)e(ultimate)i(authority)f
(in)h(case)h(of)e(con\003ict.)h(Usually)g(it')-5 b(s)21
b(the)g(founders)d(of)i(the)g(community)-5 b(.)17 b(I')l(v)o(e)479
4722 y(seen)k(it)f(w)o(ork)g(with)g(self-elected)g(groups)f(of)g
("elders",)h(b)n(ut)g(old)g(men)g(lik)o(e)g(to)h(talk)f(a)g(lot.)h(I')l
(v)o(e)e(seen)h(communities)479 4830 y(split)h(o)o(v)o(er)e(the)h
(question)f("who)h(is)h(in)f(char)o(ge?",)e(and)i(setting)g(up)g(le)o
(gal)f(entities,)i(with)f(boards,)f(and)h(such,)f(seems)479
4938 y(to)i(mak)o(e)e(such)h(ar)o(guments)e(w)o(orse,)i(not)g(better)-5
b(.)20 b(Maybe)f(because)h(there)f(seems)i(to)f(be)g(more)g(to)g
(\002ght)g(o)o(v)o(er)-5 b(.)19 b(One)h(of)479 5046 y(the)g(real)h
(bene\002ts)f(of)g(free)f(softw)o(are)h(is)h(that)g(it')-5
b(s)21 b(al)o(w)o(ays)g(remixable,)d(so)j(instead)f(of)f(\002ghting)h
(o)o(v)o(er)e(a)j(pie,)f(one)479 5154 y(simply)g(forks)f(the)i(pie.)-2
5172 y
SDict begin H.S end
 -2 5172 a -2 5172 a
SDict begin 13 H.A end
 -2 5172 a -2 5172 a
SDict begin [/View [/XYZ H.V]/Dest (0:4226) cvn /DEST pdfmark end
 -2 5172
a Black 3759 5569 a Fi(311)p Black eop end
%%Page: 312 326
TeXDict begin 312 325 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.312) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black Black 396 72 a Fe(\225)p Black 479 72 a
SDict begin H.S end
 479 72
a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:4227) cvn /DEST pdfmark end
 479 72 a Fj(Second,)f(communities)g(need)g
(li)n(ving)h(rules,)g(and)f(thus)i(the)o(y)e(need)h(a)g(la)o(wyer)g
(able)g(to)g(formulate)f(and)g(write)i(these)479 180
y(do)n(wn.)e(Rules)i(are)f(critical;)h(when)e(done)g(right,)h(the)o(y)f
(remo)o(v)o(e)f(friction.)h(When)h(done)f(wrong,)g(or)h(ne)o(glected,)e
(we)479 288 y(see)j(real)f(friction)f(and)h(ar)o(gument)e(that)i(can)g
(dri)n(v)o(e)f(a)o(w)o(ay)h(the)g(nice)g(majority)-5
b(,)19 b(lea)n(ving)g(the)i(ar)o(gumentati)n(v)o(e)16
b(core)k(in)479 396 y(char)o(ge)f(of)h(the)g(b)n(urning)e(house.)h(One)
i(thing)e(I')l(v)o(e)g(tried)h(to)g(do)g(with)g(the)h(\330MQ)f(and)g
(pre)n(vious)e(communities)h(is)479 504 y(create)h(reusable)g(rules,)f
(which)h(perhaps)f(means)h(we)h(don')o(t)d(need)i(la)o(wyers)f(as)i
(much.)-2 522 y
SDict begin H.S end
 -2 522 a -2 522 a
SDict begin 13 H.A end
 -2 522 a -2 522 a
SDict begin [/View [/XYZ H.V]/Dest (0:4228) cvn /DEST pdfmark end
 -2
522 a Black 396 654 a Fe(\225)p Black 479 654 a
SDict begin H.S end
 479 654
a 479 654 a
SDict begin 13 H.A end
 479 654 a 479 654 a
SDict begin [/View [/XYZ H.V]/Dest (0:4229) cvn /DEST pdfmark end
 479 654 a Fj(Thirdly)-5
b(,)18 b(communities)h(need)h(some)g(kind)f(of)h(\002nancial)g
(backing.)e(This)i(is)i(the)e(jagged)f(rock)g(that)h(breaks)g(most)479
762 y(ships.)g(If)h(you)e(starv)o(e)h(a)g(community)-5
b(,)18 b(it)i(becomes)g(more)f(creati)n(v)o(e)g(b)n(ut)h(the)h(core)e
(contrib)n(utors)g(b)n(urn)g(out.)h(If)g(you)479 869
y(pour)f(too)h(much)f(mone)o(y)g(into)h(it,)g(you)g(attract)g(the)g
(professionals,)f(who)g(ne)n(v)o(er)g(say)i("no",)e(and)h(the)g
(community)479 977 y(loses)h(its)g(di)n(v)o(ersity)e(and)h(creati)n
(vity)-5 b(.)19 b(If)h(you)f(create)h(a)g(fund)f(for)h(people)f(to)h
(share,)g(the)o(y)g(will)g(\002ght)g(\(bitterly\))f(o)o(v)o(er)479
1085 y(it.)i(W)m(ith)f(\330MQ)h(we)f(\(iMatix\))g(spend)f(our)h(time)g
(and)g(mone)o(y)e(on)i(mark)o(eting)f(and)g(packaging)f(\(lik)o(e)i
(this)h(book\),)479 1193 y(and)f(basic)g(care)g(-)h(b)n(ug)e(\002x)o
(es,)h(releases,)h(website.)-2 1211 y
SDict begin H.S end
 -2 1211 a -2 1211
a
SDict begin 13 H.A end
 -2 1211 a -2 1211 a
SDict begin [/View [/XYZ H.V]/Dest (0:4230) cvn /DEST pdfmark end
 -2 1211 a Black 396 1343 a Fe(\225)p
Black 479 1343 a
SDict begin H.S end
 479 1343 a 479 1343 a
SDict begin 13 H.A end
 479 1343 a 479
1343 a
SDict begin [/View [/XYZ H.V]/Dest (0:4231) cvn /DEST pdfmark end
 479 1343 a Fj(Lastly)-5 b(,)20 b(sales)h(and)f(commercial)e
(mediation.)h(There)g(is)j(a)e(natural)f(mark)o(et)h(between)f(e)o
(xpert)g(contrib)n(utors)g(and)479 1451 y(customers,)g(b)n(ut)g(both)g
(are)g(some)n(what)g(incompetent)e(at)j(talking)f(to)h(each)f(other)-5
b(.)19 b(Customers)g(assume)h(that)f(support)479 1559
y(is)i(free)e(or)g(v)o(ery)f(cheap,)h(since)g(the)h(softw)o(are)f(is)h
(free.)f(Contrib)n(utors)f(are)i(shy)f(at)h(asking)f(a)h(f)o(air)f
(rate)h(for)e(their)i(w)o(ork.)479 1667 y(It)h(mak)o(es)f(for)f(a)i
(dif)n(\002cult)f(mark)o(et.)f(A)i(gro)n(wing)d(part)i(of)g(my)g(w)o
(ork)f(and)h(my)g(\002rm')-5 b(s)20 b(pro\002ts)g(is)h(simply)f
(connecting)479 1774 y(\330MQ)h(users)f(who)g(w)o(ant)g(help,)g(with)g
(e)o(xperts)f(from)g(the)i(community)d(able)i(to)g(pro)o(vide)e(it,)j
(and)e(ensuring)g(both)479 1882 y(sides)i(are)f(happ)o(y)f(with)h(the)h
(results.)-2 2066 y
SDict begin H.S end
 -2 2066 a -2 2066 a
SDict begin 13 H.A end
 -2 2066 a -2
2066 a
SDict begin [/View [/XYZ H.V]/Dest (0:4232) cvn /DEST pdfmark end
 -2 2066 a 396 2156 a Fj(I')l(v)o(e)e(seen)i(communities)d(of)i
(brilliant)g(people)f(with)h(noble)g(goals)g(dying)e(because)i(the)g
(founders)e(got)i(some)g(or)g(all)h(of)396 2264 y(these)f(four)f
(things)g(wrong.)f(The)i(core)f(problem)f(is)j(that)f(you)e(can')o(t)h
(e)o(xpect)g(consistently)g(great)g(leadership)g(from)g(an)o(y)396
2372 y(one)h(compan)o(y)-5 b(,)17 b(person,)i(or)h(group.)e(What)j(w)o
(orks)e(today)h(often)f(w)o(on')o(t)g(w)o(ork)h(tomorro)n(w)-5
b(,)17 b(yet)j(structures)g(become)396 2480 y(more)g(solid,)g(not)f
(more)h(\003e)o(xible,)f(o)o(v)o(er)g(time.)-2 2658 y
SDict begin H.S end

-2 2658 a -2 2658 a
SDict begin 13 H.A end
 -2 2658 a -2 2658 a
SDict begin [/View [/XYZ H.V]/Dest (0:4233) cvn /DEST pdfmark end
 -2 2658 a 396
2754 a Fj(The)h(best)h(answer)e(I)i(can)f(\002nd)g(is)h(a)g(mix)f(of)f
(tw)o(o)i(things.)e(One,)h(the)g(GPL)h(and)f(its)h(guarantee)d(of)i
(remixability)-5 b(.)18 b(No)396 2862 y(matter)i(ho)n(w)g(bad)f(the)i
(authority)-5 b(,)18 b(no)h(matter)h(ho)n(w)g(much)f(the)o(y)h(try)g
(to)g(pri)n(v)n(atize)f(and)h(capture)f(the)h(community')-5
b(s)396 2970 y(w)o(ork,)20 b(if)g(it')-5 b(s)21 b(GPL)g(licensed,)e
(that)i(w)o(ork)e(can)h(w)o(alk)h(a)o(w)o(ay)e(and)h(\002nd)g(a)h
(better)e(authority)-5 b(.)18 b(Before)i(you)f(say)-5
b(,)20 b("all)h(open)396 3078 y(source)f(of)n(fers)f(this,")h(think)g
(it)h(through.)c(I)k(can)f(kill)g(a)h(BSD-licensed)f(project)f(by)h
(hiring)f(the)h(core)g(contrib)n(utors,)e(and)396 3186
y(not)i(releasing)g(an)o(y)f(ne)n(w)h(patches.)f(But)i(e)n(v)o(en)e
(with)i(a)f(billion)g(of)g(dollars)g(I)2594 3186 y
SDict begin H.S end
 2594
3186 a 2594 3186 a
SDict begin 13 H.A end
 2594 3186 a 2594 3186 a
SDict begin [/View [/XYZ H.V]/Dest (0:4234) cvn /DEST pdfmark end
 2594 3186
a Fi(cannot)g Fj(kill)h(a)f(GPL-licensed)g(project.)396
3294 y(T)-7 b(w)o(o,)20 b(the)h(philosophical)d(anarchist)h(model)h(of)
g(authority:)e(we)j(choose)e(it,)i(it)g(does)f(not)f(o)n(wn)h(us.)-2
3405 y
SDict begin H.S end
 -2 3405 a -2 3405 a
SDict begin 13 H.A end
 -2 3405 a -2 3405 a
SDict begin [/View [/XYZ H.V]/Dest (0:4235) cvn /DEST pdfmark end
 -2 3405
a 359 x Fh(7.3.)39 b(The)g(\330MQ)f(Pr)m(ocess)h(-)g(C4)1821
3764 y
SDict begin H.S end
 1821 3764 a 1821 3764 a
SDict begin 22.464 H.A end
 1821 3764 a 1821 3764
a
SDict begin [/View [/XYZ H.V]/Dest (12.76.1) cvn /DEST pdfmark end
 1821 3764 a -2 3938 a
SDict begin H.S end
 -2 3938 a -2 3938 a
SDict begin 13 H.A end
 -2 3938 a
-2 3938 a
SDict begin [/View [/XYZ H.V]/Dest (0:4237) cvn /DEST pdfmark end
 -2 3938 a 396 4038 a Fj(When)20 b(we)h(say)f(\330MQ)h(we)f
(sometimes)g(mean)g(libzmq,)f(the)h(core)g(library)-5
b(.)18 b(In)i(early)g(2012)f(we)h(synthesized)f(the)396
4146 y(libzmq)h(process)f(into)h(a)h(formal)e(protocol)f(for)i
(collaboration)e(that)i(we)h(called)f(the)2845 4146 y
SDict begin H.S end

2845 4146 a 2845 4146 a
SDict begin 13 H.A end
 2845 4146 a 2845 4146 a
SDict begin [/View [/XYZ H.V]/Dest (0:4238) cvn /DEST pdfmark end
 2845
4146 a Fj(Collecti)n(v)o(e)g(Code)g(Construction)396
4254 y(Contract)g(\(http://rfc.zeromq.or)o(g)o(/spec:16)o(\),)14
b(or)19 b(C4.)h(Y)-9 b(ou)20 b(can)f(see)i(this)f(as)h(a)f(layer)f(abo)
o(v)o(e)f(the)i(GPL.)g(In)g(f)o(act)g(libzmq)396 4362
y(doesn')o(t)f(quite)h(stick)g(to)h(C4,)f(since)g(for)g(historic)g
(reasons)g(we)g(use)h(Jira)f(instead)g(of)g(the)g(GitHub)g(issue)h
(track)o(er)-5 b(.)19 b(But)396 4470 y(apart)h(from)f(that,)h(these)h
(are)f(our)f(rules,)h(and)g(I')o(ll)g(e)o(xplain)f(the)h(reasoning)f
(behind)f(each)i(one.)-2 4654 y
SDict begin H.S end
 -2 4654 a -2 4654 a
SDict begin 13 H.A end
 -2
4654 a -2 4654 a
SDict begin [/View [/XYZ H.V]/Dest (0:4239) cvn /DEST pdfmark end
 -2 4654 a 396 4744 a Fj(C4)h(is)g(an)f(e)n(v)n
(olution)f(of)h(the)g(GitHub)1502 4744 y
SDict begin H.S end
 1502 4744 a
1502 4744 a
SDict begin 13 H.A end
 1502 4744 a 1502 4744 a
SDict begin [/View [/XYZ H.V]/Dest (0:4240) cvn /DEST pdfmark end
 1502 4744 a Fj(F)o(ork)f(+)i(Pull)f
(Model)g(\(http://help.github)m(.com/send)o(-pu)o(ll-re)o(qu)o
(ests/\).)15 b(Y)-9 b(ou)396 4852 y(may)20 b(get)g(the)g(feeling)g(I'm)
f(a)i(f)o(an)f(of)g(git)g(and)g(GitHub)m(.)f(This)h(w)o(ould)g(be)g
(accurate:)f(these)i(tw)o(o)f(tools)h(ha)n(v)o(e)e(made)h(such)396
4960 y(a)h(positi)n(v)o(e)e(impact)h(on)g(our)f(w)o(ork)h(o)o(v)o(er)f
(the)h(last)h(years,)e(and)h(especially)g(when)f(it)i(comes)f(to)h(b)n
(uilding)d(community)-5 b(.)-2 4978 y
SDict begin H.S end
 -2 4978 a -2 4978
a
SDict begin 13 H.A end
 -2 4978 a -2 4978 a
SDict begin [/View [/XYZ H.V]/Dest (0:4241) cvn /DEST pdfmark end
 -2 4978 a Black 3759 5569 a Fi(312)p
Black eop end
%%Page: 313 327
TeXDict begin 313 326 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.313) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4258) cvn /DEST pdfmark end
 -2 -201 a 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 74 a Fd(7.3.1.)36 b(Langua)o(g)q(e)1292 74
y
SDict begin H.S end
 1292 74 a 1292 74 a
SDict begin 18.72 H.A end
 1292 74 a 1292 74 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.77.2) cvn /DEST pdfmark end
 1292 74 a -2
101 a
SDict begin H.S end
 -2 101 a -2 101 a
SDict begin 13 H.A end
 -2 101 a -2 101 a
SDict begin [/View [/XYZ H.V]/Dest (0:4243) cvn /DEST pdfmark end
 -2 101 a -2
184 a
SDict begin H.S end
 -2 184 a -2 184 a
SDict begin 11.7 H.A end
 -2 184 a -2 184 a
SDict begin [/View [/XYZ H.V]/Dest (0:4244) cvn /DEST pdfmark end
 -2 184 a 479
254 a Fa(The)19 b(k)o(e)o(y)h(w)o(ords)f("MUST",)g("MUST)g(NO)m(T",)f
("REQ)o(UIRED",)h("SHALL",)f("SHALL)g(NO)m(T",)g("SHOULD",)g("SHOULD)
479 351 y(NO)m(T",)h("RECOMMENDED",)f("MA)-8 b(Y",)20
b(and)f("OPTION)m(AL")f(in)h(this)g(document)h(are)f(to)f(be)h
(interpreted)g(as)g(described)h(in)479 449 y(RFC)e(2119.)-2
616 y
SDict begin H.S end
 -2 616 a -2 616 a
SDict begin 13 H.A end
 -2 616 a -2 616 a
SDict begin [/View [/XYZ H.V]/Dest (0:4245) cvn /DEST pdfmark end
 -2 616 a 396
723 a Fj(By)j(starting)f(with)g(the)g(RFC)i(2119)d(language,)f(the)i
(C4)h(te)o(xt)f(mak)o(es)g(v)o(ery)f(clear)h(its)h(intention)e(to)i
(act)f(as)h(a)g(protocol)396 830 y(rather)f(than)f(a)i(randomly)d
(written)i(set)h(of)f(recommendations.)d(A)j(protocol)f(is)i(a)f
(contract)g(between)f(parties,)h(that)396 938 y(de\002nes)g(the)g
(rights)g(and)g(obligations)e(of)i(each)g(party)-5 b(.)19
b(These)h(can)g(be)g(peers)g(in)g(a)h(netw)o(ork.)e(The)o(y)g(can)h(be)
g(strangers)396 1046 y(w)o(orking)f(in)h(the)g(same)h(project.)-2
1230 y
SDict begin H.S end
 -2 1230 a -2 1230 a
SDict begin 13 H.A end
 -2 1230 a -2 1230 a
SDict begin [/View [/XYZ H.V]/Dest (0:4246) cvn /DEST pdfmark end
 -2 1230
a 396 1320 a Fj(I)g(think)e(C4)i(is)g(the)f(\002rst)h(time)f(an)o(yone)
f(has)h(attempted)f(to)i(codify)e(a)h(community')-5 b(s)18
b(rulebook)g(as)j(a)g(formal)e(and)396 1428 y(reusable)h(protocol)e
(spec.)i(Before,)g(our)f(rules)h(were)g(spread)g(out)f(o)o(v)o(er)g(se)
n(v)o(eral)h(wiki)g(pages,)g(and)f(quite)h(speci\002c)h(to)396
1536 y(libzmq)f(in)g(man)o(y)f(w)o(ays.)h(But)h(e)o(xperience)d
(teaches)i(us)h(that)f(the)g(more)g(formal)f(and)g(accurate)h(and)f
(reusable)h(the)396 1644 y(rules,)g(the)g(easier)h(it)g(is)g(for)e
(strangers)h(to)g(collaborate)f(up-front.)e(And)j(less)h(friction)f
(means)f(a)i(more)e(scalable)396 1752 y(community)-5
b(.)18 b(At)i(the)h(time)f(of)g(C4,)g(we)h(also)f(had)g(some)g
(disagreement)e(in)j(the)f(libzmq)f(o)o(v)o(er)g(precisely)h(what)g
(process)396 1860 y(we)h(were)f(using.)f(Not)i(e)n(v)o(eryone)c(felt)k
(bound)d(by)i(the)g(same)g(rules.)g(Let')-5 b(s)21 b(just)g(say)f(some)
g(people)f(felt)i(the)o(y)e(had)h(a)396 1968 y(special)h(status,)f
(which)g(created)f(friction)g(with)i(the)f(rest)h(of)f(the)g(community)
-5 b(.)17 b(So)k(codi\002cation)d(made)i(things)g(clear)-5
b(.)-2 2152 y
SDict begin H.S end
 -2 2152 a -2 2152 a
SDict begin 13 H.A end
 -2 2152 a -2 2152 a
SDict begin [/View [/XYZ H.V]/Dest (0:4247) cvn /DEST pdfmark end

-2 2152 a 396 2242 a Fj(It')g(s)21 b(easy)f(to)h(use)f(C4:)h(just)g
(host)f(your)f(project)g(on)h(GitHub,)f(get)i(one)e(other)h(person)f
(to)h(join,)g(and)f(open)g(the)i(\003oor)e(to)396 2350
y(pull)h(requests.)g(In)g(your)f(README,)h(put)g(a)g(link)g(to)g(C4)h
(and)f(that')-5 b(s)20 b(it.)h(W)-7 b(e')l(v)o(e)20 b(done)f(this)i(in)
f(quite)g(a)h(fe)n(w)f(projects)396 2458 y(and)g(it)h(does)f(seem)g(to)
g(w)o(ork.)g(I')l(v)o(e)f(been)g(pleasantly)h(surprised)f(a)h(fe)n(w)h
(times)f(just)h(applying)d(these)j(rules)f(to)g(my)g(o)n(wn)396
2566 y(w)o(ork,)g(lik)o(e)g(CZMQ.)g(W)-7 b(e)22 b(are)e(none)f(of)h
(us,)g(as)h(I')o(ll)g(e)o(xplain)d(later)j(in)f(this)h(chapter)m(,)d
(so)j(amazing)e(that)h(we)h(can)f(w)o(ork)396 2674 y(without)g(others.)
-2 2685 y
SDict begin H.S end
 -2 2685 a -2 2685 a
SDict begin 13 H.A end
 -2 2685 a -2 2685 a
SDict begin [/View [/XYZ H.V]/Dest (0:4248) cvn /DEST pdfmark end
 -2
2685 a 396 3012 a Fd(7.3.2.)36 b(Goals)1060 3012 y
SDict begin H.S end
 1060
3012 a 1060 3012 a
SDict begin 18.72 H.A end
 1060 3012 a 1060 3012 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.78.2) cvn /DEST pdfmark end
 1060 3012
a -2 3013 a
SDict begin H.S end
 -2 3013 a -2 3013 a
SDict begin 13 H.A end
 -2 3013 a -2 3013 a
SDict begin [/View [/XYZ H.V]/Dest (0:4250) cvn /DEST pdfmark end
 -2
3013 a -2 3097 a
SDict begin H.S end
 -2 3097 a -2 3097 a
SDict begin 11.7 H.A end
 -2 3097 a -2 3097
a
SDict begin [/View [/XYZ H.V]/Dest (0:4251) cvn /DEST pdfmark end
 -2 3097 a 479 3192 a Fa(C4)19 b(is)g(meant)g(to)g(pro)o(vide)h(a)e
(reusable)i(optimal)f(collaboration)h(model)g(for)e(open)i(source)g
(softw)o(are)f(projects.)-2 3374 y
SDict begin H.S end
 -2 3374 a -2 3374
a
SDict begin 13 H.A end
 -2 3374 a -2 3374 a
SDict begin [/View [/XYZ H.V]/Dest (0:4252) cvn /DEST pdfmark end
 -2 3374 a 396 3466 a Fj(The)h(short)g(term)g
(reason)f(for)h(writing)f(C4)i(w)o(as)g(to)f(end)g(ar)o(gument)e(o)o(v)
o(er)h(the)h(libzmq)f(contrib)n(ution)f(process.)i(The)396
3574 y(dissenters)g(went)h(of)n(f)e(else)n(where.)1413
3574 y
SDict begin H.S end
 1413 3574 a 1413 3574 a
SDict begin 13 H.A end
 1413 3574 a 1413 3574
a
SDict begin [/View [/XYZ H.V]/Dest (0:4253) cvn /DEST pdfmark end
 1413 3574 a Fj(The)h(\330MQ)h(community)d(blossomed)396
3682 y(\(https://github)m(.com/zeromq/libzm)o(q/gr)o(aph)o(s/con)o
(trib)n(uto)o(rs\),)c(smoothly)19 b(and)h(easily)-5 b(,)20
b(as)g(I')l(d)g(predicted.)e(Most)396 3790 y(people)h(were)h
(surprised,)f(b)n(ut)h(grati\002ed.)g(There')-5 b(s)19
b(been)h(no)g(real)g(criticisms)h(of)e(C4)i(e)o(xcept)e(its)i
(branching)d(polic)o(y)-5 b(,)396 3898 y(which)20 b(I')o(ll)g(come)g
(to)g(later)h(since)f(it)h(deserv)o(es)e(its)i(o)n(wn)f(discussion.)-2
4065 y
SDict begin H.S end
 -2 4065 a -2 4065 a
SDict begin 13 H.A end
 -2 4065 a -2 4065 a
SDict begin [/View [/XYZ H.V]/Dest (0:4254) cvn /DEST pdfmark end
 -2 4065
a 396 4172 a Fj(There')-5 b(s)20 b(a)h(reason)e(I'm)h(bringing)e(up)i
(history)f(here:)h(as)h(founder)d(of)h(a)i(community)-5
b(,)17 b(you)j(are)g(asking)f(people)g(to)396 4280 y(in)m(v)o(est)h(in)
g(your)f(property)-5 b(,)17 b(trademark,)i(branding.)e(In)j(return,)f
(and)h(this)g(is)h(what)g(we)f(do)g(with)g(\330MQ,)g(you)g(can)g(use)
396 4388 y(that)h(branding)c(to)k(set)g(a)f(bar)g(for)g(quality)-5
b(.)18 b(When)i(you)g(do)n(wnload)e(a)j(product)d(labeled)h(as)i
("\330MQ",)f(you)g(kno)n(w)f(that)396 4496 y(it')-5 b(s)22
b(been)d(produced)f(to)i(certain)g(standards.)f(It')-5
b(s)21 b(a)f(basic)h(rule)f(of)f(quality:)h(write)g(do)n(wn)f(your)g
(process,)h(otherwise)396 4604 y(you)g(cannot)f(impro)o(v)o(e)f(it.)i
(Our)g(processes)g(aren')o(t)f(perfect,)g(the)o(y)g(can')o(t)h(e)n(v)o
(er)f(be.)h(But)g(an)o(y)g(\003a)o(w)g(in)h(them)f(can)f(be)396
4711 y(\002x)o(ed,)h(and)f(tested.)-2 4889 y
SDict begin H.S end
 -2 4889
a -2 4889 a
SDict begin 13 H.A end
 -2 4889 a -2 4889 a
SDict begin [/View [/XYZ H.V]/Dest (0:4255) cvn /DEST pdfmark end
 -2 4889 a 396 4985 a
Fj(Making)g(C4)i(reusable)e(is)i(therefore)e(really)h(important.)e(T)-7
b(o)20 b(learn)g(more)f(about)h(the)g(best)g(possible)g(process)g(we)h
(need)396 5093 y(to)g(get)f(results)g(from)f(the)i(widest)f(range)f(of)
h(projects.)-2 5111 y
SDict begin H.S end
 -2 5111 a -2 5111 a
SDict begin 13 H.A end
 -2 5111 a -2
5111 a
SDict begin [/View [/XYZ H.V]/Dest (0:4256) cvn /DEST pdfmark end
 -2 5111 a Black 3759 5569 a Fi(313)p Black eop
end
%%Page: 314 328
TeXDict begin 314 327 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.314) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4275) cvn /DEST pdfmark end
 -2 -201 a 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4257) cvn /DEST pdfmark end
 -2
-11 a 479 72 a Fa(It)f(has)g(these)g(speci\002c)g(goals:)479
211 y(T)-6 b(o)19 b(maximize)g(the)g(scale)g(of)g(the)g(community)h
(around)h(a)d(project,)h(by)h(reducing)g(the)f(friction)f(for)h(ne)n(w)
h(Contrib)o(utors)f(and)479 308 y(creating)h(a)e(scaled)i
(participation)f(model)h(with)e(strong)i(positi)n(v)o(e)f(feedbacks;)-2
490 y
SDict begin H.S end
 -2 490 a -2 490 a
SDict begin 13 H.A end
 -2 490 a -2 490 a
SDict begin [/View [/XYZ H.V]/Dest (0:4259) cvn /DEST pdfmark end
 -2 490 a 396
582 a Fj(The)h(number)f(one)g(goal)h(is)h(size)g(and)e(health)h(of)g
(the)g(community)-5 b(.)18 b(Not)i(technical)f(quality)-5
b(,)19 b(not)h(pro\002ts,)g(not)396 690 y(performance,)d(not)i(mark)o
(et)g(share.)g(Simply)-5 b(,)19 b(number)f(of)h(people)g(who)g(contrib)
n(ute)f(to)i(the)g(project.)e(The)i(science)f(here)396
798 y(is)i(simple:)g(the)f(lar)o(ger)f(the)h(community)-5
b(,)17 b(the)j(more)g(accurate)f(the)h(results.)-2 816
y
SDict begin H.S end
 -2 816 a -2 816 a
SDict begin 13 H.A end
 -2 816 a -2 816 a
SDict begin [/View [/XYZ H.V]/Dest (0:4260) cvn /DEST pdfmark end
 -2 816 a -2 899
a
SDict begin H.S end
 -2 899 a -2 899 a
SDict begin 11.7 H.A end
 -2 899 a -2 899 a
SDict begin [/View [/XYZ H.V]/Dest (0:4261) cvn /DEST pdfmark end
 -2 899 a 479 978
a Fa(T)-6 b(o)19 b(relie)n(v)o(e)g(dependencies)i(on)f(k)o(e)o(y)f
(indi)n(viduals)h(by)g(separating)f(dif)n(ferent)g(skill)g(sets)g(so)g
(that)g(there)g(is)f(a)h(lar)o(ger)g(pool)g(of)479 1075
y(competence)i(in)e(an)o(y)g(required)h(domain;)-2 1258
y
SDict begin H.S end
 -2 1258 a -2 1258 a
SDict begin 13 H.A end
 -2 1258 a -2 1258 a
SDict begin [/View [/XYZ H.V]/Dest (0:4262) cvn /DEST pdfmark end
 -2 1258 a 396
1349 a Fj(Perhaps)g(the)g(w)o(orst)g(problem)f(we)h(f)o(aced)g(in)h
(libzmq)e(w)o(as)i(dependence)d(on)h(people)g(who)h(could)f(at)i(the)f
(same)h(time)396 1457 y(understand)d(the)j(code,)e(manage)g(GitHub)h
(branches,)e(and)i(mak)o(e)g(clean)f(releases.)i(It')-5
b(s)21 b(lik)o(e)f(looking)e(for)i(athletes)396 1565
y(who)g(can)g(run)f(both)h(marathons)e(and)i(sprint,)g(swim,)g(and)g
(also)g(lift)h(weights.)f(W)-7 b(e)21 b(humans)e(are)h(really)g(good)f
(at)396 1673 y(specialization.)g(Asking)h(us)g(to)h(be)f(really)g(good)
f(at)h(tw)o(o)h(contradictory)c(things)j(just)h(reduces)e(the)h(number)
e(of)396 1781 y(candidates)h(sharply)-5 b(,)17 b(which)i(is)h(a)g(Bad)g
(Thing)e(for)h(an)o(y)f(project.)h(W)-7 b(e)20 b(had)f(this)h(problem)d
(se)n(v)o(erely)i(in)g(libzmq)g(in)g(2009)396 1889 y(or)h(so,)g(and)g
(\002x)o(ed)g(it)h(by)e(splitting)h(the)h(role)e(of)h(maintainer)f
(into)h(tw)o(o:)h(one)e(person)g(mak)o(es)h(patches,)g(another)f
(person)396 1997 y(mak)o(es)h(releases.)-2 1998 y
SDict begin H.S end
 -2
1998 a -2 1998 a
SDict begin 13 H.A end
 -2 1998 a -2 1998 a
SDict begin [/View [/XYZ H.V]/Dest (0:4263) cvn /DEST pdfmark end
 -2 1998 a -2 2081
a
SDict begin H.S end
 -2 2081 a -2 2081 a
SDict begin 11.7 H.A end
 -2 2081 a -2 2081 a
SDict begin [/View [/XYZ H.V]/Dest (0:4264) cvn /DEST pdfmark end
 -2 2081 a 479
2177 a Fa(T)-6 b(o)19 b(allo)n(w)g(the)g(project)g(to)g(de)n(v)o(elop)h
(f)o(aster)f(and)h(more)f(accurately)-5 b(,)19 b(by)h(increasing)f(the)
g(di)n(v)o(ersity)h(of)f(the)g(decision)g(making)479
2274 y(process;)-2 2456 y
SDict begin H.S end
 -2 2456 a -2 2456 a
SDict begin 13 H.A end
 -2 2456
a -2 2456 a
SDict begin [/View [/XYZ H.V]/Dest (0:4265) cvn /DEST pdfmark end
 -2 2456 a 396 2548 a Fj(This)i(is)g(theory)-5
b(,)18 b(not)i(fully)f(pro)o(v)o(en)f(b)n(ut)i(not)g(f)o(alsi\002ed.)g
(The)g(di)n(v)o(ersity)f(of)h(the)g(community)e(and)i(number)e(of)i
(people)396 2656 y(who)g(can)g(weigh)g(into)g(discussions,)f(without)h
(fear)g(of)f(being)h(criticized)f(or)h(dismissed,)g(the)h(f)o(aster)f
(and)f(more)396 2764 y(accurately)g(the)h(softw)o(are)g(should)f(de)n
(v)o(elop,)f(Speed)i(is)h(quite)f(subjecti)n(v)o(e)f(here.)g(Going)h(v)
o(ery)f(f)o(ast)i(in)f(the)g(wrong)396 2872 y(direction)f(is)i(not)f
(just)h(useless,)g(it')-5 b(s)21 b(acti)n(v)o(ely)e(damaging)f(\(and)i
(we)g(suf)n(fered)f(a)h(lot)h(of)f(that)g(in)g(libzmq)g(before)f(we)396
2980 y(switched)h(to)h(C4\).)-2 2995 y
SDict begin H.S end
 -2 2995 a -2 2995
a
SDict begin 13 H.A end
 -2 2995 a -2 2995 a
SDict begin [/View [/XYZ H.V]/Dest (0:4266) cvn /DEST pdfmark end
 -2 2995 a -2 3078 a
SDict begin H.S end
 -2 3078 a -2
3078 a
SDict begin 11.7 H.A end
 -2 3078 a -2 3078 a
SDict begin [/View [/XYZ H.V]/Dest (0:4267) cvn /DEST pdfmark end
 -2 3078 a 479 3160 a Fa(T)-6
b(o)19 b(support)h(the)f(natural)g(life-c)o(ycle)g(of)g(project)g(v)o
(ersions)g(from)g(e)o(xperimental)h(through)g(to)f(stable,)g(by)g(allo)
n(wing)g(safe)479 3257 y(e)o(xperimentation,)h(rapid)f(f)o(ailure,)g
(and)h(isolation)f(of)g(stable)g(code;)-2 3439 y
SDict begin H.S end
 -2 3439
a -2 3439 a
SDict begin 13 H.A end
 -2 3439 a -2 3439 a
SDict begin [/View [/XYZ H.V]/Dest (0:4268) cvn /DEST pdfmark end
 -2 3439 a 396 3531 a
Fj(T)-7 b(o)21 b(be)f(honest,)f(this)i(goal)e(seems)i(to)f(be)h(f)o
(ading)e(into)h(irrele)n(v)n(ance.)e(It')-5 b(s)21 b(quite)e(an)h
(interesting)g(ef)n(fect)f(of)h(the)h(process:)396 3639
y
SDict begin H.S end
 396 3639 a 396 3639 a
SDict begin 13 H.A end
 396 3639 a 396 3639 a
SDict begin [/View [/XYZ H.V]/Dest (0:4269) cvn /DEST pdfmark end
 396 3639
a Fi(the)f(git)h(master)g(is)g(almost)f(always)g(perfectly)h(stable)p
Fj(.)e(This)i(has)f(to)h(do)e(with)i(the)f(size)h(of)f(changes,)f(and)g
(their)396 3747 y("latenc)o(y",)g(i.e.)h(the)g(time)h(between)e
(someone)g(writing)h(the)g(code,)f(and)h(someone)f(actually)g(using)h
(it)h(fully)-5 b(.)19 b(Ho)n(we)n(v)o(er)m(,)396 3855
y(people)g(still)j(e)o(xpect)d("stable")h(releases,)g(so)h(we')o(ll)f
(k)o(eep)g(this)h(goal)f(there)f(for)h(a)g(while.)-2
3873 y
SDict begin H.S end
 -2 3873 a -2 3873 a
SDict begin 13 H.A end
 -2 3873 a -2 3873 a
SDict begin [/View [/XYZ H.V]/Dest (0:4270) cvn /DEST pdfmark end
 -2 3873
a -2 3956 a
SDict begin H.S end
 -2 3956 a -2 3956 a
SDict begin 11.7 H.A end
 -2 3956 a -2 3956 a
SDict begin [/View [/XYZ H.V]/Dest (0:4271) cvn /DEST pdfmark end
 -2
3956 a 479 4035 a Fa(T)-6 b(o)19 b(reduce)h(the)f(internal)g(comple)o
(xity)h(of)e(project)i(repositories,)f(thus)g(making)h(it)e(easier)h
(for)g(Contrib)o(utors)g(to)f(participate)479 4132 y(and)i(reducing)g
(the)f(scope)h(for)f(error;)-2 4314 y
SDict begin H.S end
 -2 4314 a -2 4314
a
SDict begin 13 H.A end
 -2 4314 a -2 4314 a
SDict begin [/View [/XYZ H.V]/Dest (0:4272) cvn /DEST pdfmark end
 -2 4314 a 396 4406 a Fj(Curious)h(observ)n
(ation:)e(people)h(who)h(thri)n(v)o(e)f(in)h(comple)o(x)f(situations)h
(lik)o(e)g(to)h(create)f(comple)o(xity)e(because)h(it)i(k)o(eeps)396
4514 y(their)f(v)n(alue)g(high.)f(It')-5 b(s)21 b(the)f(Cobra)g(Ef)n
(fect)f(\(Google)g(it\).)h(Git)h(made)f(branches)e(easy)j(and)e(left)i
(us)f(with)h(the)f(all)h(too)396 4622 y(common)e(syndrome)f(of)i("git)g
(is)h(easy)f(once)g(you)f(understand)f(that)j(a)f(git)h(branch)d(is)j
(just)g(a)g(folded)e(\002)n(v)o(e-dimensional)396 4730
y(lepton)h(space)g(that)g(has)g(a)h(detached)e(history)g(with)i(no)e
(interv)o(ening)f(cache".)h(De)n(v)o(elopers)g(should)g(not)h(be)g
(made)g(to)396 4838 y(feel)g(stupid)g(by)g(their)g(tools.)g(I')l(v)o(e)
f(too)h(man)o(y)f(top-class)h(de)n(v)o(elopers)e(confused)g(by)i
(repository)e(structures,)i(to)g(accept)396 4946 y(con)m(v)o(entional)d
(wisdom)j(on)g(git)g(branches.)f(W)-7 b(e')o(ll)21 b(come)f(back)f(to)i
(dispose)e(of)h(git)h(branches)e(shortly)-5 b(,)18 b(dear)i(reader)-5
b(.)-2 4964 y
SDict begin H.S end
 -2 4964 a -2 4964 a
SDict begin 13 H.A end
 -2 4964 a -2 4964 a
SDict begin [/View [/XYZ H.V]/Dest (0:4273) cvn /DEST pdfmark end

-2 4964 a Black 3759 5569 a Fi(314)p Black eop end
%%Page: 315 329
TeXDict begin 315 328 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.315) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4274) cvn /DEST pdfmark end
 -2
-11 a 479 72 a Fa(T)-6 b(o)19 b(enforce)g(collecti)n(v)o(e)f(o)n
(wnership)i(of)e(the)h(project,)f(which)h(increases)g(economic)h
(incenti)n(v)o(e)f(to)f(Contrib)o(utors)h(and)g(reduces)479
170 y(the)g(risk)g(of)g(hijack)g(by)h(hostile)f(entities.)396
444 y Fj(Ultimately)-5 b(,)20 b(we')l(re)f(economic)g(creatures,)g(and)
g(the)i(sense)f(that)g("we)h(o)n(wn)f(this,)g(and)g(our)f(w)o(ork)h
(can)g(ne)n(v)o(er)e(be)j(used)396 552 y(against)f(us")g(mak)o(es)g(it)
g(much)f(easier)h(for)g(people)f(to)h(in)m(v)o(est)f(in)h(an)g(open)f
(source)g(project)g(lik)o(e)i(\330MQ.)f(And)f(it)i(can')o(t)e(be)396
659 y(just)i(a)g(feeling,)e(it)i(has)f(to)g(be)g(real.)g(There)g(are)g
(a)h(number)d(of)i(aspects)g(to)h(making)e(collecti)n(v)o(e)g(o)n
(wnership)f(w)o(ork,)i(we')o(ll)396 767 y(see)h(these)f(one)g(by)g(one)
f(as)i(we)g(go)f(through)e(C4.)-2 796 y
SDict begin H.S end
 -2 796 a -2 796
a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:4276) cvn /DEST pdfmark end
 -2 796 a 396 1106 a Fd(7.3.3.)36
b(Preliminaries)1478 1106 y
SDict begin H.S end
 1478 1106 a 1478 1106 a
SDict begin 18.72 H.A end
 1478
1106 a 1478 1106 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.79.2) cvn /DEST pdfmark end
 1478 1106 a -2 1107 a
SDict begin H.S end
 -2 1107 a -2
1107 a
SDict begin 13 H.A end
 -2 1107 a -2 1107 a
SDict begin [/View [/XYZ H.V]/Dest (0:4278) cvn /DEST pdfmark end
 -2 1107 a -2 1190 a
SDict begin H.S end
 -2 1190
a -2 1190 a
SDict begin 11.7 H.A end
 -2 1190 a -2 1190 a
SDict begin [/View [/XYZ H.V]/Dest (0:4279) cvn /DEST pdfmark end
 -2 1190 a 479 1286 a
Fa(The)19 b(project)g(SHALL)f(use)h(the)g(git)g(distrib)o(uted)f(re)n
(vision)i(control)f(system.)-2 1468 y
SDict begin H.S end
 -2 1468 a -2 1468
a
SDict begin 13 H.A end
 -2 1468 a -2 1468 a
SDict begin [/View [/XYZ H.V]/Dest (0:4280) cvn /DEST pdfmark end
 -2 1468 a 396 1560 a Fj(Git)i(has)g(its)g(f)o
(aults.)f(Its)h(command-line)c(API)k(is)g(horribly)d(inconsistent,)h
(and)h(it)h(has)f(a)h(comple)o(x,)d(messy)i(internal)396
1668 y(model)g(that)g(it)h(sho)o(v)o(es)e(in)h(your)f(f)o(ace)h(at)h
(the)f(slightest)h(pro)o(v)n(ocation.)c(But)k(despite)f(doing)f(its)i
(best)f(to)h(mak)o(e)e(its)j(users)396 1776 y(feel)d(stupid,)f(git)i
(does)e(its)i(job)f(really)-5 b(,)18 b(really)g(well.)h(More)g
(pragmatically)-5 b(,)16 b(I')l(v)o(e)i(found)f(that)i(if)g(you)f(stay)
i(a)o(w)o(ay)e(certain)396 1884 y(areas)j(\(branches!\),)c(people)i
(learn)h(git)g(rapidly)f(and)h(don')o(t)e(mak)o(e)i(man)o(y)f(mistak)o
(es.)h(That)g(data)g(w)o(orks)g(for)g(me.)-2 1902 y
SDict begin H.S end
 -2
1902 a -2 1902 a
SDict begin 13 H.A end
 -2 1902 a -2 1902 a
SDict begin [/View [/XYZ H.V]/Dest (0:4281) cvn /DEST pdfmark end
 -2 1902 a -2 1985
a
SDict begin H.S end
 -2 1985 a -2 1985 a
SDict begin 11.7 H.A end
 -2 1985 a -2 1985 a
SDict begin [/View [/XYZ H.V]/Dest (0:4282) cvn /DEST pdfmark end
 -2 1985 a 479
2064 a Fa(The)f(project)g(SHALL)f(be)h(hosted)h(on)f(github)m(.com)h
(or)f(equi)n(v)n(alent,)h(herein)f(called)g(the)g("Platform".)-2
2246 y
SDict begin H.S end
 -2 2246 a -2 2246 a
SDict begin 13 H.A end
 -2 2246 a -2 2246 a
SDict begin [/View [/XYZ H.V]/Dest (0:4283) cvn /DEST pdfmark end
 -2 2246
a 396 2338 a Fj(I'm)h(sure)g(one)g(day)f(some)h(lar)o(ge)f(\002rm)i
(will)g(b)n(uy)e(github)g(and)h(break)f(it,)i(and)e(another)g(platform)
g(will)i(rise)f(in)h(its)g(place.)396 2446 y(Github)f(serv)o(es)g(up)f
(a)i(near)n(-perfect)d(set)j(of)f(minimal,)f(f)o(ast,)i(simple)f
(tools.)g(I')l(v)o(e)f(thro)n(wn)g(hundreds)f(of)i(people)f(at)i(it,)
396 2554 y(and)f(the)o(y)f(all)i(stick,)f(lik)o(e)h(\003ies)g(stuck)f
(in)g(a)h(dish)f(of)g(hone)o(y)-5 b(.)-2 2572 y
SDict begin H.S end
 -2 2572
a -2 2572 a
SDict begin 13 H.A end
 -2 2572 a -2 2572 a
SDict begin [/View [/XYZ H.V]/Dest (0:4284) cvn /DEST pdfmark end
 -2 2572 a -2 2655 a
SDict begin H.S end
 -2
2655 a -2 2655 a
SDict begin 11.7 H.A end
 -2 2655 a -2 2655 a
SDict begin [/View [/XYZ H.V]/Dest (0:4285) cvn /DEST pdfmark end
 -2 2655 a 479 2734
a Fa(The)19 b(project)g(SHALL)f(use)h(the)g(Platform)f(issue)h(track)o
(er)l(.)-2 2916 y
SDict begin H.S end
 -2 2916 a -2 2916 a
SDict begin 13 H.A end
 -2 2916 a -2 2916
a
SDict begin [/View [/XYZ H.V]/Dest (0:4286) cvn /DEST pdfmark end
 -2 2916 a 396 3008 a Fj(W)-7 b(e)22 b(made)d(the)h(mistak)o(e)h(in)f
(libzmq)f(of)h(switching)g(to)g(Jira)h(\(mainly)e(because)g(a)i(no)n(w)
f(departed)e(person)h(didn')o(t)g(lik)o(e)396 3116 y(GitHub\).)g(Jira)i
(is)g(a)g(great)f(e)o(xample)e(of)i(ho)n(w)g(to)g(turn)g(something)e
(useful)i(into)g(a)h(comple)o(x)d(mess)j(because)e(the)396
3224 y(b)n(usiness)i(depends)e(on)g(selling)h(more)g("features".)f(But)
i(e)n(v)o(en)e(without)g(criticizing)h(Jira,)g(k)o(eeping)f(the)h
(issue)h(track)o(er)396 3332 y(on)f(the)g(same)h(platform)d(means)i
(one)g(less)h(UI)f(to)h(learn,)e(one)h(less)h(login,)e(and)h(inte)o
(gration)e(between)i(issues)h(and)396 3440 y(patches.)-2
3458 y
SDict begin H.S end
 -2 3458 a -2 3458 a
SDict begin 13 H.A end
 -2 3458 a -2 3458 a
SDict begin [/View [/XYZ H.V]/Dest (0:4287) cvn /DEST pdfmark end
 -2 3458
a -2 3541 a
SDict begin H.S end
 -2 3541 a -2 3541 a
SDict begin 11.7 H.A end
 -2 3541 a -2 3541 a
SDict begin [/View [/XYZ H.V]/Dest (0:4288) cvn /DEST pdfmark end
 -2
3541 a 479 3620 a Fa(The)e(project)g(SHOULD)f(ha)o(v)o(e)h(clearly)g
(documented)i(guidelines)f(for)f(code)g(style.)-2 3802
y
SDict begin H.S end
 -2 3802 a -2 3802 a
SDict begin 13 H.A end
 -2 3802 a -2 3802 a
SDict begin [/View [/XYZ H.V]/Dest (0:4289) cvn /DEST pdfmark end
 -2 3802 a 396
3894 a Fj(This)i(is)g(a)f(protocol)f(plug-in:)g(insert)h(code)f(style)i
(guidelines)e(here.)g(If)h(you)g(don')o(t)e(document)g(the)j(code)e
(style)i(you)396 4002 y(use,)f(you)g(ha)n(v)o(e)f(no)h(basis)h(e)o
(xcept)e(prejudice)g(to)h(reject)g(patches.)-2 4020 y
SDict begin H.S end

-2 4020 a -2 4020 a
SDict begin 13 H.A end
 -2 4020 a -2 4020 a
SDict begin [/View [/XYZ H.V]/Dest (0:4290) cvn /DEST pdfmark end
 -2 4020 a -2
4227 a
SDict begin H.S end
 -2 4227 a -2 4227 a
SDict begin 11.7 H.A end
 -2 4227 a -2 4227 a
SDict begin [/View [/XYZ H.V]/Dest (0:4291) cvn /DEST pdfmark end
 -2 4227
a 479 4306 a Fa(A)f("Contrib)o(utor")h(is)e(a)h(person)h(who)f(wishes)g
(to)g(pro)o(vide)h(a)f(patch,)g(being)h(a)f(set)f(of)h(commits)g(that)g
(solv)o(e)g(some)h(clearly)479 4403 y(identi\002ed)f(problem.)-2
4461 y
SDict begin H.S end
 -2 4461 a -2 4461 a
SDict begin 11.7 H.A end
 -2 4461 a -2 4461 a
SDict begin [/View [/XYZ H.V]/Dest (0:4292) cvn /DEST pdfmark end
 -2 4461
a 479 4542 a Fa(A)g("Maintainer")h(is)f(a)g(person)h(who)f(mer)o(ge)g
(patches)h(to)f(the)g(project.)g(Maintainers)g(are)g(not)g(de)n(v)o
(elopers;)h(their)f(job)g(is)g(to)479 4639 y(enforce)h(process.)-2
4821 y
SDict begin H.S end
 -2 4821 a -2 4821 a
SDict begin 13 H.A end
 -2 4821 a -2 4821 a
SDict begin [/View [/XYZ H.V]/Dest (0:4293) cvn /DEST pdfmark end
 -2 4821
a 396 4913 a Fj(No)n(w)g(to)h(de\002nitions)e(of)h(the)g(parties,)g
(and)g(the)g(splitting)g(of)g(roles)g(that)g(sa)n(v)o(ed)g(us)h(from)e
(the)h(sin)h(of)f(structural)396 5021 y(dependenc)o(y)d(on)j(rare)g
(indi)n(viduals.)e(This)j(w)o(ork)o(ed)e(well)h(in)h(libzmq,)e(b)n(ut)h
(as)h(you)e(will)i(see)g(it)g(depends)e(on)h(the)g(rest)g(of)p
Black 3759 5569 a Fi(315)p Black eop end
%%Page: 316 330
TeXDict begin 316 329 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.316) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(the)g(process.)g(C4)h(isn')o(t)e(a)i(b)n(uf)n(fet;)e
(you)h(will)h(need)e(the)h(whole)g(process)g(\(or)f(something)g(v)o
(ery)g(lik)o(e)i(it\),)f(or)g(it)h(w)o(on')o(t)396 180
y(hold)f(together)-5 b(.)-2 198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2
198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:4294) cvn /DEST pdfmark end
 -2 198 a -2 406 a
SDict begin H.S end
 -2 406 a -2 406 a
SDict begin 11.7 H.A end
 -2
406 a -2 406 a
SDict begin [/View [/XYZ H.V]/Dest (0:4295) cvn /DEST pdfmark end
 -2 406 a 479 485 a Fa(Contrib)o(utors)19
b(SHALL)f(NO)m(T)g(ha)o(v)o(e)h(commit)g(access)h(to)e(the)h
(repository)h(unless)g(the)o(y)f(are)g(also)g(Maintainers.)-2
543 y
SDict begin H.S end
 -2 543 a -2 543 a
SDict begin 11.7 H.A end
 -2 543 a -2 543 a
SDict begin [/View [/XYZ H.V]/Dest (0:4296) cvn /DEST pdfmark end
 -2 543 a 479
624 a Fa(Maintainers)h(SHALL)d(ha)o(v)o(e)i(commit)g(access)h(to)f(the)
g(repository)-5 b(.)-2 806 y
SDict begin H.S end
 -2 806 a -2 806 a
SDict begin 13 H.A end
 -2 806
a -2 806 a
SDict begin [/View [/XYZ H.V]/Dest (0:4297) cvn /DEST pdfmark end
 -2 806 a 396 898 a Fj(What)21 b(we)f(w)o(anted)g(to)g(a)n(v)
n(oid)g(w)o(as)h(people)e(pushing)g(their)h(changes)f(directly)h(to)g
(master)-5 b(.)20 b(This)h(w)o(as)g(the)f(biggest)396
1006 y(source)g(of)g(trouble)f(in)h(libzmq)f(historically:)h(lar)o(ge)f
(masses)i(of)f(ra)o(w)g(code)f(that)i(took)e(months)g(or)h(years)g(to)g
(fully)396 1114 y(stabilize.)g(W)-7 b(e)22 b(e)n(v)o(entually)c(follo)n
(wed)h(other)g(\330MQ)i(projects)e(lik)o(e)i(PyZMQ)f(in)g(using)g(pull)
g(requests.)f(W)-7 b(e)22 b(went)396 1222 y(further)m(,)c(and)i
(stipulated)g(that)1290 1222 y
SDict begin H.S end
 1290 1222 a 1290 1222
a
SDict begin 13 H.A end
 1290 1222 a 1290 1222 a
SDict begin [/View [/XYZ H.V]/Dest (0:4298) cvn /DEST pdfmark end
 1290 1222 a Fi(all)g Fj(changes)g(had)f(to)i
(follo)n(w)e(the)h(same)h(path.)e(No)h(e)o(xceptions)f(for)g("special)i
(people".)-2 1239 y
SDict begin H.S end
 -2 1239 a -2 1239 a
SDict begin 13 H.A end
 -2 1239 a -2
1239 a
SDict begin [/View [/XYZ H.V]/Dest (0:4299) cvn /DEST pdfmark end
 -2 1239 a -2 1322 a
SDict begin H.S end
 -2 1322 a -2 1322 a
SDict begin 11.7 H.A end
 -2 1322
a -2 1322 a
SDict begin [/View [/XYZ H.V]/Dest (0:4300) cvn /DEST pdfmark end
 -2 1322 a 479 1402 a Fa(Ev)o(eryone,)f(without)e
(distinction)h(or)g(discrimination,)f(SHALL)g(ha)o(v)o(e)g(an)h(equal)h
(right)e(to)h(become)g(a)g(Contrib)o(utor)f(under)i(the)479
1499 y(terms)f(of)g(this)g(contract.)-2 1666 y
SDict begin H.S end
 -2 1666
a -2 1666 a
SDict begin 13 H.A end
 -2 1666 a -2 1666 a
SDict begin [/View [/XYZ H.V]/Dest (0:4301) cvn /DEST pdfmark end
 -2 1666 a 396 1773 a
Fj(W)-7 b(e)22 b(had)d(to)i(state)g(this)f(e)o(xplicitly)-5
b(.)19 b(It)h(used)g(to)h(be)f(that)g(the)g(libzmq)g("maintainers")e(w)
o(ould)i(reject)g(patches)g(simply)396 1881 y(because)g(the)o(y)f
(didn')o(t)g(lik)o(e)h(them.)g(No)n(w)-5 b(,)19 b(that)i(may)e(sound)g
(reasonable)g(to)h(the)h(author)e(of)g(a)i(library)e(\(though)f(libzmq)
396 1989 y(w)o(as)j(not)f(written)g(by)g(an)o(y)f(one)h(person\))f(b)n
(ut)h(let')-5 b(s)21 b(remember)d(our)i(goal)f(of)h(creating)g(a)g(w)o
(ork)g(that)g(is)h(o)n(wned)e(by)h(as)396 2097 y(man)o(y)f(people)g(as)
h(possible.)f(Saying)h("I)f(don')o(t)g(lik)o(e)h(your)e(patch)i(so)g
(I'm)f(going)g(to)h(reject)f(it")i(is)g(equi)n(v)n(alent)d(to)i
(saying,)396 2204 y("I)h(claim)f(to)g(o)n(wn)g(this)g(and)g(I)h(think)e
(I'm)h(better)f(than)h(you,)f(and)h(I)g(don')o(t)f(trust)h(you".)f
(Those)h(are)g(toxic)g(messages)g(to)396 2312 y(gi)n(v)o(e)g(to)g
(others)g(who)f(are)i(thinking)d(of)i(becoming)e(your)h(co-in)m(v)o
(estors.)-2 2496 y
SDict begin H.S end
 -2 2496 a -2 2496 a
SDict begin 13 H.A end
 -2 2496 a -2 2496
a
SDict begin [/View [/XYZ H.V]/Dest (0:4302) cvn /DEST pdfmark end
 -2 2496 a 396 2586 a Fj(I)i(think)e(this)i(\002ght)f(between)f(indi)n
(vidual)g(e)o(xpertise)g(and)g(collecti)n(v)o(e)h(intelligence)f(plays)
h(out)g(in)g(other)f(areas.)h(It)396 2694 y(de\002ned)f(W)m(ikipedia,)g
(and)h(still)h(does,)f(a)h(decade)e(after)h(that)g(w)o(ork)g(surpassed)
f(an)o(ything)f(b)n(uilt)j(by)e(small)i(groups)e(of)396
2802 y(e)o(xperts.)g(F)o(or)h(me,)g(we)h(mak)o(e)e(softw)o(are)h(by)g
(synthesizing)f(kno)n(wledge,)f(much)h(as)i(we)f(mak)o(e)g(W)m
(ikipedia)f(articles.)-2 2831 y
SDict begin H.S end
 -2 2831 a -2 2831 a
SDict begin 13 H.A end
 -2
2831 a -2 2831 a
SDict begin [/View [/XYZ H.V]/Dest (0:4303) cvn /DEST pdfmark end
 -2 2831 a 396 3141 a Fd(7.3.4.)36 b(Licensing)f(and)f
(Owner)n(ship)2181 3141 y
SDict begin H.S end
 2181 3141 a 2181 3141 a
SDict begin 18.72 H.A end
 2181
3141 a 2181 3141 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.80.2) cvn /DEST pdfmark end
 2181 3141 a -2 3167 a
SDict begin H.S end
 -2 3167 a -2
3167 a
SDict begin 13 H.A end
 -2 3167 a -2 3167 a
SDict begin [/View [/XYZ H.V]/Dest (0:4305) cvn /DEST pdfmark end
 -2 3167 a -2 3250 a
SDict begin H.S end
 -2 3250
a -2 3250 a
SDict begin 11.7 H.A end
 -2 3250 a -2 3250 a
SDict begin [/View [/XYZ H.V]/Dest (0:4306) cvn /DEST pdfmark end
 -2 3250 a 479 3321 a
Fa(The)19 b(project)g(SHALL)f(use)h(the)g(GPLv3)g(or)f(a)h(v)n(ariant)h
(thereof)f(\(LGPL,)e(A)m(GPL\).)-2 3503 y
SDict begin H.S end
 -2 3503 a -2
3503 a
SDict begin 13 H.A end
 -2 3503 a -2 3503 a
SDict begin [/View [/XYZ H.V]/Dest (0:4307) cvn /DEST pdfmark end
 -2 3503 a 396 3595 a Fj(I')l(v)o(e)i
(already)g(e)o(xplained)g(ho)n(w)g(full)h(remixability)f(creates)h
(better)g(scale)h(and)e(why)h(the)g(GPL)g(and)g(its)h(v)n(ariants)f
(seems)396 3703 y(the)g(optimal)g(contract)f(for)h(remixable)e(softw)o
(are.)i(If)g(you')l(re)e(a)j(lar)o(ge)e(b)n(usiness)i(aiming)e(to)h
(dump)f(code)h(on)f(the)396 3811 y(mark)o(et,)g(you)h(w)o(on')o(t)f(w)o
(ant)h(C4,)h(b)n(ut)f(then)g(you)f(w)o(on')o(t)g(really)h(care)g(about)
f(community)f(either)-5 b(.)-2 3829 y
SDict begin H.S end
 -2 3829 a -2 3829
a
SDict begin 13 H.A end
 -2 3829 a -2 3829 a
SDict begin [/View [/XYZ H.V]/Dest (0:4308) cvn /DEST pdfmark end
 -2 3829 a -2 3912 a
SDict begin H.S end
 -2 3912 a -2
3912 a
SDict begin 11.7 H.A end
 -2 3912 a -2 3912 a
SDict begin [/View [/XYZ H.V]/Dest (0:4309) cvn /DEST pdfmark end
 -2 3912 a 479 3991 a Fa(All)18
b(contrib)o(utions)i(to)f(the)g(project)g(source)h(code)f
(\("patches"\))i(SHALL)c(use)j(the)f(same)g(license)g(as)g(the)g
(project.)-2 4173 y
SDict begin H.S end
 -2 4173 a -2 4173 a
SDict begin 13 H.A end
 -2 4173 a -2
4173 a
SDict begin [/View [/XYZ H.V]/Dest (0:4310) cvn /DEST pdfmark end
 -2 4173 a 396 4265 a Fj(This)i(remo)o(v)o(es)d(the)i(need)g(for)
f(an)o(y)h(speci\002c)g(license)h(or)e(contrib)n(ution)f(agreement)h
(for)h(patches.)f(Y)-9 b(ou)20 b(fork)f(the)h(GPL)396
4373 y(code,)g(you)f(publish)g(your)g(remix)o(ed)g(v)o(ersion)f(on)i
(github,)f(you)g(or)h(an)o(yone)e(else)j(can)f(then)g(submit)g(that)g
(as)h(a)g(patch)e(to)396 4481 y(the)g(original)f(code.)h(BSD)h(doesn')o
(t)d(allo)n(w)i(this.)h(An)o(y)e(w)o(ork)h(that)g(contains)f(BSD)i
(code)f(may)g(also)g(contain)f(unlicensed)396 4589 y(proprietary)g
(code)h(so)i(you)e(need)h(e)o(xplicit)f(action)h(from)f(the)h(author)f
(of)h(the)g(code)g(before)f(you)g(can)h(remix)f(it.)-2
4607 y
SDict begin H.S end
 -2 4607 a -2 4607 a
SDict begin 13 H.A end
 -2 4607 a -2 4607 a
SDict begin [/View [/XYZ H.V]/Dest (0:4311) cvn /DEST pdfmark end
 -2 4607
a -2 4690 a
SDict begin H.S end
 -2 4690 a -2 4690 a
SDict begin 11.7 H.A end
 -2 4690 a -2 4690 a
SDict begin [/View [/XYZ H.V]/Dest (0:4312) cvn /DEST pdfmark end
 -2
4690 a 479 4769 a Fa(All)f(patches)i(are)f(o)n(wned)h(by)g(their)e
(authors.)i(There)e(SHALL)g(NO)m(T)g(be)h(an)o(y)h(cop)o(yright)g
(assignment)g(process.)-2 4951 y
SDict begin H.S end
 -2 4951 a -2 4951 a
SDict begin 13 H.A end

-2 4951 a -2 4951 a
SDict begin [/View [/XYZ H.V]/Dest (0:4313) cvn /DEST pdfmark end
 -2 4951 a 396 5043 a Fj(Here)g(we)h(come)e(to)i
(the)f(k)o(e)o(y)g(reason)f(people)g(trust)h(their)g(in)m(v)o(estments)
f(in)i(\330MQ:)f(it')-5 b(s)21 b(logistically)f(impossible)g(to)396
5151 y(b)n(uy)g(the)g(cop)o(yrights)f(to)h(create)g(a)g(closed-source)f
(competitor)f(to)i(\330MQ.)h(iMatix)f(can')o(t)f(do)h(this)h(either)-5
b(.)20 b(And)f(the)p Black 3757 5569 a Fi(316)p Black
eop end
%%Page: 317 331
TeXDict begin 317 330 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.317) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(more)g(people)f(send)h(patches,)f(the)h(harder)f(it)i
(becomes.)e(\330MQ)i(isn')o(t)e(just)i(free)f(and)g(open)f(today)-5
b(,)18 b(this)j(speci\002c)f(rule)396 180 y(means)g(it)g(will)h(remain)
e(so)h(fore)n(v)o(er)-5 b(.)18 b(Note)i(that)g(it')-5
b(s)21 b(not)f(the)f(case)i(in)f(all)g(GPL)h(projects,)e(man)o(y)f(of)i
(which)f(still)i(ask)f(for)396 288 y(cop)o(yright)e(transfer)i(back)f
(to)i(the)f(maintainers.)-2 306 y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2
306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:4314) cvn /DEST pdfmark end
 -2 306 a -2 389 a
SDict begin H.S end
 -2 389 a -2 389 a
SDict begin 11.7 H.A end
 -2
389 a -2 389 a
SDict begin [/View [/XYZ H.V]/Dest (0:4315) cvn /DEST pdfmark end
 -2 389 a 479 468 a Fa(The)f(project)g(SHALL)f(be)h(o)n
(wned)h(collecti)n(v)o(ely)f(by)h(all)e(its)g(Contrib)o(utors.)-2
651 y
SDict begin H.S end
 -2 651 a -2 651 a
SDict begin 13 H.A end
 -2 651 a -2 651 a
SDict begin [/View [/XYZ H.V]/Dest (0:4316) cvn /DEST pdfmark end
 -2 651 a 396
742 a Fj(This)j(is)g(perhaps)e(redundant)e(b)n(ut)k(w)o(orth)e(saying:)
h(if)g(e)n(v)o(eryone)e(o)n(wns)i(their)g(patches,)f(then)h(the)g
(resulting)g(whole)f(is)396 850 y(also)i(o)n(wned)e(by)h(e)n(v)o(ery)e
(contrib)n(utor)-5 b(.)19 b(There')-5 b(s)19 b(no)h(le)o(gal)g(concept)
f(of)g(o)n(wning)g(lines)i(of)f(code:)f(the)i("w)o(ork")e(is)i(at)g
(least)396 958 y(a)g(source)e(\002le.)-2 959 y
SDict begin H.S end
 -2 959
a -2 959 a
SDict begin 13 H.A end
 -2 959 a -2 959 a
SDict begin [/View [/XYZ H.V]/Dest (0:4317) cvn /DEST pdfmark end
 -2 959 a -2 1042 a
SDict begin H.S end
 -2 1042
a -2 1042 a
SDict begin 11.7 H.A end
 -2 1042 a -2 1042 a
SDict begin [/View [/XYZ H.V]/Dest (0:4318) cvn /DEST pdfmark end
 -2 1042 a 479 1138 a
Fa(Each)g(Contrib)o(utor)g(SHALL)f(be)h(responsible)h(for)f
(identifying)g(themselv)o(es)h(in)f(the)g(project)g(Contrib)o(utor)g
(list.)-2 1321 y
SDict begin H.S end
 -2 1321 a -2 1321 a
SDict begin 13 H.A end
 -2 1321 a -2 1321
a
SDict begin [/View [/XYZ H.V]/Dest (0:4319) cvn /DEST pdfmark end
 -2 1321 a 396 1412 a Fj(I.e.)h(the)g(maintainers)f(are)h(not)g(karma)
g(accountants.)e(An)o(yone)g(who)i(w)o(ants)h(credit)f(has)g(to)g
(claim)h(it)f(themselv)o(es.)-2 1441 y
SDict begin H.S end
 -2 1441 a -2 1441
a
SDict begin 13 H.A end
 -2 1441 a -2 1441 a
SDict begin [/View [/XYZ H.V]/Dest (0:4320) cvn /DEST pdfmark end
 -2 1441 a 396 1751 a Fd(7.3.5.)36
b(P)l(atc)o(h)e(Requirements)1878 1751 y
SDict begin H.S end
 1878 1751 a
1878 1751 a
SDict begin 18.72 H.A end
 1878 1751 a 1878 1751 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.81.2) cvn /DEST pdfmark end
 1878 1751 a -2 1942
a
SDict begin H.S end
 -2 1942 a -2 1942 a
SDict begin 13 H.A end
 -2 1942 a -2 1942 a
SDict begin [/View [/XYZ H.V]/Dest (0:4322) cvn /DEST pdfmark end
 -2 1942 a 396
2025 a Fj(In)20 b(this)h(section)f(we)g(de\002ne)g(the)g(obligations)f
(of)h(the)g(contrib)n(utor:)e(speci\002cally)-5 b(,)19
b(what)h(constitutes)g(a)h("v)n(alid")e(patch,)396 2133
y(so)i(maintainers)e(ha)n(v)o(e)h(rules)g(the)o(y)f(can)h(use)h(to)f
(accept)g(or)g(reject)g(patches.)-2 2151 y
SDict begin H.S end
 -2 2151 a
-2 2151 a
SDict begin 13 H.A end
 -2 2151 a -2 2151 a
SDict begin [/View [/XYZ H.V]/Dest (0:4323) cvn /DEST pdfmark end
 -2 2151 a -2 2234 a
SDict begin H.S end
 -2
2234 a -2 2234 a
SDict begin 11.7 H.A end
 -2 2234 a -2 2234 a
SDict begin [/View [/XYZ H.V]/Dest (0:4324) cvn /DEST pdfmark end
 -2 2234 a 479 2313
a Fa(Maintainers)g(and)f(Contrib)o(utors)g(MUST)g(ha)o(v)o(e)g(a)g
(Platform)f(account)i(and)g(SHOULD)d(use)i(their)g(real)g(names)g(or)g
(a)479 2410 y(well-kno)n(wn)h(alias.)-2 2577 y
SDict begin H.S end
 -2 2577
a -2 2577 a
SDict begin 13 H.A end
 -2 2577 a -2 2577 a
SDict begin [/View [/XYZ H.V]/Dest (0:4325) cvn /DEST pdfmark end
 -2 2577 a 396 2684 a
Fj(In)g(the)g(w)o(orst)h(case)f(scenario,)g(where)f(someone)g(has)h
(submitted)g(toxic)g(code)f(\(patented,)f(or)i(o)n(wned)f(by)h(someone)
396 2792 y(else\),)h(we)f(need)g(to)g(be)g(able)g(to)g(trace)h(who)e
(and)h(when,)f(so)i(we)f(can)g(remo)o(v)o(e)f(the)h(code.)f(Asking)h
(for)f(real)h(names)g(or)g(a)396 2900 y(well-kno)n(wn)f(alias)h(is)i(a)
e(theoretical)f(strate)o(gy)h(to)g(reducing)e(the)j(risk)f(of)g(bogus)f
(patches.)g(W)-7 b(e)22 b(don')o(t)c(kno)n(w)h(if)i(this)396
3008 y(actually)f(w)o(orks)g(because)f(we)i(ha)n(v)o(en')o(t)d(had)i
(the)g(problem)e(yet.)-2 3026 y
SDict begin H.S end
 -2 3026 a -2 3026 a
SDict begin 13 H.A end
 -2
3026 a -2 3026 a
SDict begin [/View [/XYZ H.V]/Dest (0:4326) cvn /DEST pdfmark end
 -2 3026 a -2 3109 a
SDict begin H.S end
 -2 3109 a -2 3109
a
SDict begin 11.7 H.A end
 -2 3109 a -2 3109 a
SDict begin [/View [/XYZ H.V]/Dest (0:4327) cvn /DEST pdfmark end
 -2 3109 a 479 3188 a Fa(A)h(patch)g(SHOULD)f(be)h
(a)g(minimal)g(and)h(accurate)f(answer)g(to)g(e)o(xactly)h(one)f
(identi\002ed)g(and)h(agreed)f(problem.)-2 3370 y
SDict begin H.S end
 -2
3370 a -2 3370 a
SDict begin 13 H.A end
 -2 3370 a -2 3370 a
SDict begin [/View [/XYZ H.V]/Dest (0:4328) cvn /DEST pdfmark end
 -2 3370 a 396 3462
a Fj(Recall)i(the)f(Simplicity)g(Oriented)f(Design)h(pattern)g(from)f
(The)h(Human)f(Scale)p 0 TeXcolorgray 2714 3462 a
SDict begin H.S end
 2714
3462 a Fj(Chapter)g(6)3039 3462 y
SDict begin 13 H.L end
 3039 3462 a 3039 3462
a
SDict begin [/Subtype /Link/Dest (0:the-human-scale) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 3039 3462 a Black Fj(.)h(This)h(implements)e(that.)396
3570 y(One)h(clear)g(problem,)f(one)g(minimal)h(solution,)f(apply)-5
b(,)18 b(test,)j(repeat.)-2 3588 y
SDict begin H.S end
 -2 3588 a -2 3588
a
SDict begin 13 H.A end
 -2 3588 a -2 3588 a
SDict begin [/View [/XYZ H.V]/Dest (0:4330) cvn /DEST pdfmark end
 -2 3588 a -2 3671 a
SDict begin H.S end
 -2 3671 a -2
3671 a
SDict begin 11.7 H.A end
 -2 3671 a -2 3671 a
SDict begin [/View [/XYZ H.V]/Dest (0:4331) cvn /DEST pdfmark end
 -2 3671 a 479 3750 a Fa(A)e(patch)g(MUST)g
(adhere)g(to)g(the)g(code)h(style)f(guidelines)h(of)f(the)g(project)g
(if)f(these)h(are)g(de\002ned.)-2 3932 y
SDict begin H.S end
 -2 3932 a -2
3932 a
SDict begin 13 H.A end
 -2 3932 a -2 3932 a
SDict begin [/View [/XYZ H.V]/Dest (0:4332) cvn /DEST pdfmark end
 -2 3932 a 396 4024 a Fj(This)h(is)h(just)g
(sanity:)f(I')l(v)o(e)e(spent)i(time)g(cleaning)f(up)g(other)h
(peoples')e(patches)i(because)f(the)o(y)g(insisted)h(on)g(putting)f
(the)396 4132 y('else')h(beside)g(the)g('if)5 b(')20
b(instead)g(of)g(just)g(belo)n(w)g(as)h(Nature)f(intended.)e
(Consistent)i(code)g(is)h(healthier)-5 b(.)-2 4150 y
SDict begin H.S end

-2 4150 a -2 4150 a
SDict begin 13 H.A end
 -2 4150 a -2 4150 a
SDict begin [/View [/XYZ H.V]/Dest (0:4333) cvn /DEST pdfmark end
 -2 4150 a -2
4233 a
SDict begin H.S end
 -2 4233 a -2 4233 a
SDict begin 11.7 H.A end
 -2 4233 a -2 4233 a
SDict begin [/View [/XYZ H.V]/Dest (0:4334) cvn /DEST pdfmark end
 -2 4233
a 479 4312 a Fa(A)19 b(patch)g(MUST)g(adhere)g(to)g(the)g("Ev)o
(olution)h(of)f(Public)f(Contracts")i(guidelines)g(de\002ned)f(belo)n
(w)-5 b(.)-2 4494 y
SDict begin H.S end
 -2 4494 a -2 4494 a
SDict begin 13 H.A end
 -2 4494 a -2
4494 a
SDict begin [/View [/XYZ H.V]/Dest (0:4335) cvn /DEST pdfmark end
 -2 4494 a 396 4586 a Fj(Ah,)20 b(the)g(pain,)g(the)g(pain.)g
(I'm)f(not)h(speaking)f(of)h(the)g(time)g(at)h(age)f(eight)g(when)g(I)g
(stepped)f(on)h(a)h(plank)e(with)h(a)h(4-inch)396 4694
y(nail)g(protruding)c(from)i(it.)i(That)f(w)o(as)h(relati)n(v)o(ely)e
(OK.)h(I'm)g(speaking)f(of)g(2010-2011)e(when)j(we)g(had)g(multiple)396
4802 y(parallel)g(releases)h(of)e(\330MQ,)i(each)e(with)i(dif)n(ferent)
1920 4802 y
SDict begin H.S end
 1920 4802 a 1920 4802 a
SDict begin 13 H.A end
 1920 4802 a 1920
4802 a
SDict begin [/View [/XYZ H.V]/Dest (0:4336) cvn /DEST pdfmark end
 1920 4802 a Fi(incompatible)e Fj(APIs)h(or)g(wire)h(protocols.)d
(It)j(w)o(as)g(an)f(e)o(x)o(ercise)f(in)396 4910 y(bad)h(rules)g
(pointlessly)g(enforced.)e(The)h(rule)h(w)o(as)h("if)g(you)e(change)g
(the)h(API)g(or)g(protocol,)f(you)g(SHALL)h(create)g(a)396
5018 y(ne)n(w)g(major)g(v)o(ersion".)e(Gi)n(v)o(e)i(me)g(the)g(nail)h
(through)d(the)i(foot,)f(that)i(hurt)e(less.)p Black
3756 5569 a Fi(317)p Black eop end
%%Page: 318 332
TeXDict begin 318 331 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.318) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4337) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(One)g(of)g(the)g(big)g(changes)f(we)i(made)f(with)g
(C4)h(w)o(as)g(simply)e(to)i(ban,)e(outright,)g(this)h(kind)g(of)g
(sanctioned)e(sabotage.)396 180 y(Amazingly)-5 b(,)18
b(it')-5 b(s)22 b(not)d(e)n(v)o(en)h(hard.)f(W)-7 b(e)21
b(just)g(don')o(t)d(allo)n(w)i(the)h(breaking)d(of)i(e)o(xisting)f
(public)h(contracts,)f(period,)396 288 y(unless)i(e)n(v)o(eryone)c
(agrees,)j(in)g(which)g(case)g(no)g(period.)-2 306 y
SDict begin H.S end

-2 306 a -2 306 a
SDict begin 13 H.A end
 -2 306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:4338) cvn /DEST pdfmark end
 -2 306 a -2 389 a
SDict begin H.S end

-2 389 a -2 389 a
SDict begin 11.7 H.A end
 -2 389 a -2 389 a
SDict begin [/View [/XYZ H.V]/Dest (0:4339) cvn /DEST pdfmark end
 -2 389 a 479 468
a Fa(A)f(patch)g(SHALL)f(NO)m(T)g(include)i(non-tri)n(vial)f(code)h
(from)f(other)g(projects)g(unless)h(the)f(Contrib)o(utor)g(is)f(the)h
(original)g(author)479 566 y(of)g(that)g(code.)-2 732
y
SDict begin H.S end
 -2 732 a -2 732 a
SDict begin 13 H.A end
 -2 732 a -2 732 a
SDict begin [/View [/XYZ H.V]/Dest (0:4340) cvn /DEST pdfmark end
 -2 732 a 396 840
a Fj(This)i(rule)e(has)i(tw)o(o)f(ef)n(fects.)g(The)g(\002rst)h(is)g
(that)f(it)h(forces)f(people)f(to)h(mak)o(e)g(minimal)f(solutions,)h
(since)g(the)o(y)g(cannot)396 948 y(simply)g(import)f(sw)o(athes)i(of)f
(e)o(xisting)f(code.)h(In)g(the)g(cases)h(where)e(I')l(v)o(e)g(seen)i
(this)f(happen)f(to)h(projects,)g(it')-5 b(s)21 b(al)o(w)o(ays)396
1055 y(bad)f(unless)g(the)g(imported)f(code)g(is)j(v)o(ery)d(cleanly)g
(separated.)g(The)h(second)f(is)i(that)g(it)g(a)n(v)n(oids)f(license)g
(ar)o(guments.)396 1163 y(Y)-9 b(ou)20 b(write)g(the)g(patch,)g(you)f
(are)h(allo)n(wed)g(to)g(publish)f(it)i(as)g(LGPL,)f(and)g(we)g(can)g
(mer)o(ge)f(it)i(back)f(in.)g(But)g(you)g(\002nd)g(a)396
1271 y(200-line)f(code)g(fragment)g(on)g(the)i(web,)f(and)f(try)h(to)g
(paste)h(that,)f(we')o(ll)g(refuse.)-2 1289 y
SDict begin H.S end
 -2 1289
a -2 1289 a
SDict begin 13 H.A end
 -2 1289 a -2 1289 a
SDict begin [/View [/XYZ H.V]/Dest (0:4341) cvn /DEST pdfmark end
 -2 1289 a -2 1372 a
SDict begin H.S end
 -2
1372 a -2 1372 a
SDict begin 11.7 H.A end
 -2 1372 a -2 1372 a
SDict begin [/View [/XYZ H.V]/Dest (0:4342) cvn /DEST pdfmark end
 -2 1372 a 479 1451
a Fa(A)f(patch)g(MUST)g(compile)g(cleanly)h(on)f(at)g(least)f(the)h
(most)g(important)g(tar)o(get)g(platforms.)-2 1634 y
SDict begin H.S end

-2 1634 a -2 1634 a
SDict begin 13 H.A end
 -2 1634 a -2 1634 a
SDict begin [/View [/XYZ H.V]/Dest (0:4343) cvn /DEST pdfmark end
 -2 1634 a 396
1725 a Fj(This)i(is)g(probably)d(asking)h(a)i(lot)f(since)h(most)f
(contrib)n(utors)e(ha)n(v)o(e)i(only)f(one)h(platform)e(to)j(w)o(ork)e
(on.)-2 1743 y
SDict begin H.S end
 -2 1743 a -2 1743 a
SDict begin 13 H.A end
 -2 1743 a -2 1743
a
SDict begin [/View [/XYZ H.V]/Dest (0:4344) cvn /DEST pdfmark end
 -2 1743 a -2 1826 a
SDict begin H.S end
 -2 1826 a -2 1826 a
SDict begin 11.7 H.A end
 -2 1826 a -2
1826 a
SDict begin [/View [/XYZ H.V]/Dest (0:4345) cvn /DEST pdfmark end
 -2 1826 a 479 1906 a Fa(A)g("Correct)g(P)o(atch")g(is)g(one)g
(that)g(satis\002es)f(the)h(abo)o(v)o(e)h(requirements.)-2
2088 y
SDict begin H.S end
 -2 2088 a -2 2088 a
SDict begin 13 H.A end
 -2 2088 a -2 2088 a
SDict begin [/View [/XYZ H.V]/Dest (0:4346) cvn /DEST pdfmark end
 -2 2088
a 396 2180 a Fj(Just)h(in)g(case)f(it)h(w)o(asn')o(t)f(clear)m(,)f(we')
l(re)h(back)f(to)i(le)o(galese)e(and)h(de\002nitions.)-2
2208 y
SDict begin H.S end
 -2 2208 a -2 2208 a
SDict begin 13 H.A end
 -2 2208 a -2 2208 a
SDict begin [/View [/XYZ H.V]/Dest (0:4347) cvn /DEST pdfmark end
 -2 2208
a 396 2518 a Fd(7.3.6.)36 b(De)n(velopment)g(Pr)n(ocess)1973
2518 y
SDict begin H.S end
 1973 2518 a 1973 2518 a
SDict begin 18.72 H.A end
 1973 2518 a 1973 2518
a
SDict begin [/View [/XYZ H.V]/Dest (12.76.82.2) cvn /DEST pdfmark end
 1973 2518 a -2 2709 a
SDict begin H.S end
 -2 2709 a -2 2709 a
SDict begin 13 H.A end
 -2 2709 a
-2 2709 a
SDict begin [/View [/XYZ H.V]/Dest (0:4349) cvn /DEST pdfmark end
 -2 2709 a 396 2792 a Fj(In)20 b(this)h(section)f(we)g(aim)h
(to)f(describe)f(the)i(actual)f(de)n(v)o(elopment)d(process,)i(step)i
(by)f(step.)-2 2810 y
SDict begin H.S end
 -2 2810 a -2 2810 a
SDict begin 13 H.A end
 -2 2810 a -2
2810 a
SDict begin [/View [/XYZ H.V]/Dest (0:4350) cvn /DEST pdfmark end
 -2 2810 a -2 2893 a
SDict begin H.S end
 -2 2893 a -2 2893 a
SDict begin 11.7 H.A end
 -2 2893
a -2 2893 a
SDict begin [/View [/XYZ H.V]/Dest (0:4351) cvn /DEST pdfmark end
 -2 2893 a 479 2972 a Fa(Change)g(on)g(the)f(project)g
(SHALL)e(be)i(go)o(v)o(erned)i(by)e(the)g(pattern)g(of)g(accurately)h
(identifying)g(problems)f(and)h(applying)479 3069 y(minimal,)f
(accurate)g(solutions)h(to)f(these)g(problems.)-2 3252
y
SDict begin H.S end
 -2 3252 a -2 3252 a
SDict begin 13 H.A end
 -2 3252 a -2 3252 a
SDict begin [/View [/XYZ H.V]/Dest (0:4352) cvn /DEST pdfmark end
 -2 3252 a 396
3343 a Fj(This)h(is)h(a)f(blatant)f(attempt)g(to)h(ram)f(through)f
(thirty)h(years')g(softw)o(are)g(design)g(e)o(xperience.)e(It')-5
b(s)21 b(a)f(profoundly)c(simple)396 3451 y(approach)i(to)j(design:)e
(mak)o(e)h(minimal,)f(accurate)h(solutions)f(to)i(real)f(problems.)e
(Nothing)h(more)h(or)f(less.)i(Note)g(the)396 3559 y(stress)g(on)f
("accurac)o(y",)e(a)j(rare)f(b)n(ut)g(essential)h(ingredient.)d(In)i
(\330MQ)g(we)h(don')o(t)d(ha)n(v)o(e)i(feature)f(requests.)g(T)m
(reating)396 3667 y(ne)n(w)h(features)g(the)g(same)g(as)h(b)n(ugs)f
(confuses)f(ne)n(wbies.)h(But)h(this)f(process)g(w)o(orks,)g(and)f(not)
h(just)h(in)f(open)f(source.)396 3775 y(Enunciating)f(the)i(problem)f
(we')l(re)g(trying)h(to)g(solv)o(e,)f(with)i(e)n(v)o(ery)e(single)h
(change,)e(is)j(k)o(e)o(y)f(to)g(deciding)f(whether)g(the)396
3883 y(change)g(is)i(w)o(orth)f(making)f(or)h(not.)-2
3901 y
SDict begin H.S end
 -2 3901 a -2 3901 a
SDict begin 13 H.A end
 -2 3901 a -2 3901 a
SDict begin [/View [/XYZ H.V]/Dest (0:4353) cvn /DEST pdfmark end
 -2 3901
a -2 3984 a
SDict begin H.S end
 -2 3984 a -2 3984 a
SDict begin 11.7 H.A end
 -2 3984 a -2 3984 a
SDict begin [/View [/XYZ H.V]/Dest (0:4354) cvn /DEST pdfmark end
 -2
3984 a 479 4063 a Fa(T)-6 b(o)19 b(initiate)f(changes,)i(a)f(user)g
(SHALL)f(log)h(an)g(issue)g(on)h(the)f(project)g(Platform)f(issue)h
(track)o(er)l(.)-2 4245 y
SDict begin H.S end
 -2 4245 a -2 4245 a
SDict begin 13 H.A end
 -2 4245
a -2 4245 a
SDict begin [/View [/XYZ H.V]/Dest (0:4355) cvn /DEST pdfmark end
 -2 4245 a 396 4337 a Fj(This)i(is)g(meant)e(to)i(stop)f(us)
g(going)f(of)n(f-line)g(and)h(w)o(orking)e(in)j(a)f(ghetto,)f(either)h
(by)g(ourselv)o(es)f(or)h(with)g(others.)396 4445 y(Although)f(we)h
(tend)g(to)g(accept)g(pull)g(requests)g(that)g(ha)n(v)o(e)g(clear)g(ar)
o(gumentation,)c(this)21 b(rule)f(lets)h(us)g(say)f("stop")g(to)396
4553 y(confused)f(or)h(too-lar)o(ge)e(patches.)-2 4571
y
SDict begin H.S end
 -2 4571 a -2 4571 a
SDict begin 13 H.A end
 -2 4571 a -2 4571 a
SDict begin [/View [/XYZ H.V]/Dest (0:4356) cvn /DEST pdfmark end
 -2 4571 a -2
4654 a
SDict begin H.S end
 -2 4654 a -2 4654 a
SDict begin 11.7 H.A end
 -2 4654 a -2 4654 a
SDict begin [/View [/XYZ H.V]/Dest (0:4357) cvn /DEST pdfmark end
 -2 4654
a 479 4733 a Fa(The)h(user)g(SHOULD)f(write)g(the)h(issue)g(by)h
(describing)g(the)f(problem)g(the)o(y)h(f)o(ace)f(or)g(observ)o(e.)-2
4915 y
SDict begin H.S end
 -2 4915 a -2 4915 a
SDict begin 13 H.A end
 -2 4915 a -2 4915 a
SDict begin [/View [/XYZ H.V]/Dest (0:4358) cvn /DEST pdfmark end
 -2 4915
a 396 5007 a Fj("Problem:)g(we)i(need)e(feature)h(X.)g(Solution:)f(mak)
o(e)h(it")h(is)g(not)f(a)g(good)f(issue.)i("Problem:)e(user)h(cannot)f
(do)h(common)396 5115 y(tasks)h(A)g(or)f(B)h(e)o(xcept)e(by)h(using)f
(a)i(comple)o(x)d(w)o(orkaround.)f(Solution:)j(mak)o(e)f(feature)h(X")g
(is)h(a)g(decent)e(e)o(xplanation.)p Black 3759 5569
a Fi(318)p Black eop end
%%Page: 319 333
TeXDict begin 319 332 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.319) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(Since)g(e)n(v)o(eryone)e(I')l(v)o(e)h(e)n(v)o(er)h(w)
o(ork)o(ed)f(with)h(has)g(needed)f(to)i(learn)e(this,)i(it)g(seems)f(w)
o(orth)g(re-stating:)f(document)g(the)396 180 y(real)h(problem)f
(\002rst,)i(solution)e(second.)-2 198 y
SDict begin H.S end
 -2 198 a -2 198
a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:4359) cvn /DEST pdfmark end
 -2 198 a -2 281 a
SDict begin H.S end
 -2 281 a -2 281
a
SDict begin 11.7 H.A end
 -2 281 a -2 281 a
SDict begin [/View [/XYZ H.V]/Dest (0:4360) cvn /DEST pdfmark end
 -2 281 a 479 361 a Fa(The)g(user)g(SHOULD)f(seek)h
(consensus)i(on)f(the)e(accurac)o(y)j(of)d(their)h(observ)n(ation,)h
(and)g(the)f(v)n(alue)g(of)g(solving)h(the)f(problem.)-2
543 y
SDict begin H.S end
 -2 543 a -2 543 a
SDict begin 13 H.A end
 -2 543 a -2 543 a
SDict begin [/View [/XYZ H.V]/Dest (0:4361) cvn /DEST pdfmark end
 -2 543 a 396
635 a Fj(And)h(since)g(man)o(y)f(apparent)g(problems)g(are)h
(illusionary)-5 b(,)18 b(by)i(stating)g(the)g(problem)f(e)o(xplicitly)g
(we)h(gi)n(v)o(e)g(others)f(a)396 742 y(chance)g(to)i(correct)e(our)g
(logic.)h("Y)-9 b(ou')l(re)18 b(only)i(using)g(A)g(and)g(B)h(a)g(lot)f
(because)g(function)e(C)j(is)g(unreliable.)e(Solution:)396
850 y(mak)o(e)h(function)e(C)k(w)o(ork)d(properly)-5
b(.")-2 868 y
SDict begin H.S end
 -2 868 a -2 868 a
SDict begin 13 H.A end
 -2 868 a -2 868 a
SDict begin [/View [/XYZ H.V]/Dest (0:4362) cvn /DEST pdfmark end
 -2
868 a -2 951 a
SDict begin H.S end
 -2 951 a -2 951 a
SDict begin 11.7 H.A end
 -2 951 a -2 951 a
SDict begin [/View [/XYZ H.V]/Dest (0:4363) cvn /DEST pdfmark end
 -2
951 a 479 1031 a Fa(Users)19 b(SHALL)e(NO)m(T)i(log)g(feature)g
(requests,)g(ideas,)g(suggestions,)h(or)f(an)o(y)g(solutions)h(to)f
(problems)g(that)g(are)g(not)g(e)o(xplicitly)479 1128
y(documented)i(and)f(pro)o(v)n(able.)-2 1310 y
SDict begin H.S end
 -2 1310
a -2 1310 a
SDict begin 13 H.A end
 -2 1310 a -2 1310 a
SDict begin [/View [/XYZ H.V]/Dest (0:4364) cvn /DEST pdfmark end
 -2 1310 a 396 1402 a
Fj(There)g(are)g(se)n(v)o(eral)f(reasons)h(for)g(not)f(logging)g
(ideas,)h(suggestions,)f(or)h(feature)f(requests.)h(In)g(our)f(e)o
(xperience)f(these)396 1510 y(just)j(accumulate)e(in)h(the)g(issue)h
(track)o(er)f(until)g(someone)e(deletes)j(them.)e(But)i(more)e
(profoundly)-5 b(,)16 b(when)k(we)h(treat)f(all)396 1618
y(change)f(as)i(problem)e(solutions,)g(we)h(can)g(prioritize)g(tri)n
(vially)-5 b(.)19 b(Either)g(the)h(problem)f(is)i(real)f(and)g(someone)
f(w)o(ants)h(to)396 1725 y(solv)o(e)g(it,)h(no)n(w)-5
b(,)19 b(or)h(it')-5 b(s)21 b(not)f(on)g(the)g(table.)g(Thus,)f
(wish-lists)i(are)f(of)n(f)g(the)g(table.)-2 1737 y
SDict begin H.S end
 -2
1737 a -2 1737 a
SDict begin 13 H.A end
 -2 1737 a -2 1737 a
SDict begin [/View [/XYZ H.V]/Dest (0:4365) cvn /DEST pdfmark end
 -2 1737 a -2 1820
a
SDict begin H.S end
 -2 1820 a -2 1820 a
SDict begin 11.7 H.A end
 -2 1820 a -2 1820 a
SDict begin [/View [/XYZ H.V]/Dest (0:4366) cvn /DEST pdfmark end
 -2 1820 a 479
1906 a Fa(Thus,)f(the)g(release)g(history)g(of)g(the)g(project)g(SHALL)
f(be)h(a)g(list)f(of)h(meaningful)h(issues)f(logged)h(and)g(solv)o(ed.)
-2 2088 y
SDict begin H.S end
 -2 2088 a -2 2088 a
SDict begin 13 H.A end
 -2 2088 a -2 2088 a
SDict begin [/View [/XYZ H.V]/Dest (0:4367) cvn /DEST pdfmark end
 -2
2088 a 396 2180 a Fj(I')l(d)g(lo)o(v)o(e)f(the)h(GitHub)g(issue)h
(track)o(er)e(to)h(simply)g(list)i(all)e(the)h(issues)g(we)f(solv)o(ed)
f(in)i(each)f(release.)g(T)-7 b(oday)19 b(we)h(still)396
2288 y(ha)n(v)o(e)g(to)g(write)g(that)g(by)g(hand.)f(If)g(one)h(puts)g
(the)g(issue)h(number)d(in)i(each)g(commit,)f(and)g(if)h(one)g(uses)g
(the)g(GitHub)g(issue)396 2395 y(track)o(er)m(,)f(which)h(we)g(sadly)g
(don')o(t)f(yet)h(do)g(for)f(\330MQ,)i(this)f(release)h(history)e(is)i
(easier)f(to)h(produce)d(mechanically)-5 b(.)-2 2413
y
SDict begin H.S end
 -2 2413 a -2 2413 a
SDict begin 13 H.A end
 -2 2413 a -2 2413 a
SDict begin [/View [/XYZ H.V]/Dest (0:4368) cvn /DEST pdfmark end
 -2 2413 a -2
2496 a
SDict begin H.S end
 -2 2496 a -2 2496 a
SDict begin 11.7 H.A end
 -2 2496 a -2 2496 a
SDict begin [/View [/XYZ H.V]/Dest (0:4369) cvn /DEST pdfmark end
 -2 2496
a 479 2576 a Fa(T)f(o)18 b(w)o(ork)g(on)h(an)f(issue,)g(a)g(Contrib)o
(utor)g(SHALL)e(fork)i(the)g(project)g(repository)h(and)g(then)f(w)o
(ork)g(on)h(their)e(fork)o(ed)i(repository)-5 b(.)-2
2758 y
SDict begin H.S end
 -2 2758 a -2 2758 a
SDict begin 13 H.A end
 -2 2758 a -2 2758 a
SDict begin [/View [/XYZ H.V]/Dest (0:4370) cvn /DEST pdfmark end
 -2 2758
a 396 2850 a Fj(Here)20 b(we)h(e)o(xplain)e(the)h(GitHub)g(fork)f(+)h
(pull)g(request)g(model)f(so)i(that)f(ne)n(wcomers)f(only)g(ha)n(v)o(e)
h(to)g(learn)g(one)g(process)396 2957 y(\(C4\))g(in)h(order)d(to)j
(contrib)n(ute.)-2 2972 y
SDict begin H.S end
 -2 2972 a -2 2972 a
SDict begin 13 H.A end
 -2 2972
a -2 2972 a
SDict begin [/View [/XYZ H.V]/Dest (0:4371) cvn /DEST pdfmark end
 -2 2972 a -2 3055 a
SDict begin H.S end
 -2 3055 a -2 3055 a
SDict begin 11.7 H.A end
 -2
3055 a -2 3055 a
SDict begin [/View [/XYZ H.V]/Dest (0:4372) cvn /DEST pdfmark end
 -2 3055 a 479 3138 a Fa(T)-6 b(o)19
b(submit)g(a)g(patch,)g(a)g(Contrib)o(utor)g(SHALL)e(create)i(a)g
(Platform)f(pull)h(request)h(back)g(to)e(the)h(project.)-2
3320 y
SDict begin H.S end
 -2 3320 a -2 3320 a
SDict begin 13 H.A end
 -2 3320 a -2 3320 a
SDict begin [/View [/XYZ H.V]/Dest (0:4373) cvn /DEST pdfmark end
 -2 3320
a 396 3412 a Fj(GitHub)h(has)h(made)e(this)i(so)f(simple)h(that)f(we)g
(don')o(t)f(need)g(to)i(learn)e(git)i(commands)d(to)j(do)e(it,)i(for)f
(which)f(I'm)h(deeply)396 3520 y(grateful.)f(Sometimes,)h(I')o(ll)g
(tell)h(people)e(who)h(I)g(don')o(t)e(particularly)h(lik)o(e)h(that)h
(command-line)c(git)j(is)i(a)o(wesome)d(and)396 3627
y(all)i(the)o(y)f(need)f(to)h(do)g(is)h(learn)f(git')-5
b(s)21 b(internal)e(model)g(in)i(detail)f(before)f(trying)g(to)h(use)h
(it)g(on)e(real)i(w)o(ork.)e(When)h(I)g(see)396 3735
y(them)g(se)n(v)o(eral)g(months)f(later)h(the)o(y)g(look...)e(dif)n
(ferent.)-2 3753 y
SDict begin H.S end
 -2 3753 a -2 3753 a
SDict begin 13 H.A end
 -2 3753 a -2 3753
a
SDict begin [/View [/XYZ H.V]/Dest (0:4374) cvn /DEST pdfmark end
 -2 3753 a -2 3836 a
SDict begin H.S end
 -2 3836 a -2 3836 a
SDict begin 11.7 H.A end
 -2 3836 a -2
3836 a
SDict begin [/View [/XYZ H.V]/Dest (0:4375) cvn /DEST pdfmark end
 -2 3836 a 479 3916 a Fa(A)h(Contrib)o(utor)g(SHALL)e(NO)m(T)h
(commit)h(changes)i(directly)e(to)g(the)g(project.)-2
4098 y
SDict begin H.S end
 -2 4098 a -2 4098 a
SDict begin 13 H.A end
 -2 4098 a -2 4098 a
SDict begin [/View [/XYZ H.V]/Dest (0:4376) cvn /DEST pdfmark end
 -2 4098
a 396 4190 a Fj(An)o(yone)g(who)g(submits)h(a)h(patch)f(is)h(a)f
(contrib)n(utor)m(,)e(and)i(all)g(contrib)n(utors)f(follo)n(w)g(the)h
(same)h(rules.)f(No)g(special)396 4297 y(pri)n(vile)o(ges)f(to)h(the)h
(original)e(authors,)g(because)g(otherwise)h(we')l(re)f(not)h(b)n
(uilding)f(a)i(community)-5 b(,)17 b(b)n(ut)j(boosting)f(our)396
4405 y(e)o(gos.)-2 4423 y
SDict begin H.S end
 -2 4423 a -2 4423 a
SDict begin 13 H.A end
 -2 4423
a -2 4423 a
SDict begin [/View [/XYZ H.V]/Dest (0:4377) cvn /DEST pdfmark end
 -2 4423 a -2 4506 a
SDict begin H.S end
 -2 4506 a -2 4506 a
SDict begin 11.7 H.A end
 -2
4506 a -2 4506 a
SDict begin [/View [/XYZ H.V]/Dest (0:4378) cvn /DEST pdfmark end
 -2 4506 a 479 4586 a Fa(T)-6 b(o)19
b(discuss)h(a)e(patch,)i(people)f(MA)-8 b(Y)20 b(comment)f(on)h(the)f
(Platform)f(pull)h(request,)g(on)g(the)g(commit,)g(or)g(else)n(where.)
-2 4768 y
SDict begin H.S end
 -2 4768 a -2 4768 a
SDict begin 13 H.A end
 -2 4768 a -2 4768 a
SDict begin [/View [/XYZ H.V]/Dest (0:4379) cvn /DEST pdfmark end
 -2
4768 a 396 4860 a Fj(Randomly)g(distrib)n(uted)g(discussions)h(may)g
(be)g(confusing)e(if)j(you')l(re)d(w)o(alking)h(up)h(for)g(the)g
(\002rst)h(time,)f(b)n(ut)g(GitHub)396 4967 y(solv)o(es)g(this)g(for)f
(all)h(current)e(participants)h(by)g(sending)g(emails)h(to)f(those)h
(who)f(need)g(to)h(follo)n(w)e(what')-5 b(s)20 b(going)f(on.)g(W)-7
b(e)p Black 3759 5569 a Fi(319)p Black eop end
%%Page: 320 334
TeXDict begin 320 333 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.320) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(had)g(the)g(same)g(e)o(xperience)f(and)g(the)h(same)h
(solution)e(in)h(W)m(ikidot,)g(and)f(it)i(w)o(orks.)f(There')-5
b(s)20 b(no)f(e)n(vidence)g(that)396 180 y(discussing)h(in)g(dif)n
(ferent)f(places)h(has)g(an)o(y)g(ne)o(gati)n(v)o(e)e(ef)n(fect.)-2
198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:4380) cvn /DEST pdfmark end
 -2 198 a -2
281 a
SDict begin H.S end
 -2 281 a -2 281 a
SDict begin 11.7 H.A end
 -2 281 a -2 281 a
SDict begin [/View [/XYZ H.V]/Dest (0:4381) cvn /DEST pdfmark end
 -2 281 a 479
361 a Fa(T)-6 b(o)19 b(accept)h(or)e(reject)h(a)g(patch,)g(a)g
(Maintainer)h(SHALL)d(use)i(the)g(Platform)f(interf)o(ace.)-2
543 y
SDict begin H.S end
 -2 543 a -2 543 a
SDict begin 13 H.A end
 -2 543 a -2 543 a
SDict begin [/View [/XYZ H.V]/Dest (0:4382) cvn /DEST pdfmark end
 -2 543 a 396
635 a Fj(W)-7 b(orking)20 b(via)g(the)g(GitHub)g(web)g(user)g(interf)o
(ace)f(means)h(pull)g(requests)g(are)g(logged)f(as)i(issues,)f(with)h
(w)o(ork\003o)n(w)e(and)396 742 y(discussion.)h(I'm)f(sure)h(there)g
(are)g(more)g(comple)o(x)e(w)o(ays)j(to)f(w)o(ork.)f(Comple)o(xity)g
(is)i(easy)-5 b(,)20 b(it')-5 b(s)21 b(simplicity)f(that')-5
b(s)396 850 y(incredibly)19 b(hard.)-2 868 y
SDict begin H.S end
 -2 868 a
-2 868 a
SDict begin 13 H.A end
 -2 868 a -2 868 a
SDict begin [/View [/XYZ H.V]/Dest (0:4383) cvn /DEST pdfmark end
 -2 868 a -2 951 a
SDict begin H.S end
 -2 951 a
-2 951 a
SDict begin 11.7 H.A end
 -2 951 a -2 951 a
SDict begin [/View [/XYZ H.V]/Dest (0:4384) cvn /DEST pdfmark end
 -2 951 a 479 1031 a Fa(Maintainers)h(SHALL)d
(NO)m(T)i(accept)g(their)g(o)n(wn)g(patches.)-2 1213
y
SDict begin H.S end
 -2 1213 a -2 1213 a
SDict begin 13 H.A end
 -2 1213 a -2 1213 a
SDict begin [/View [/XYZ H.V]/Dest (0:4385) cvn /DEST pdfmark end
 -2 1213 a 396
1305 a Fj(There)h(w)o(as)h(a)f(rule)g(we)h(de\002ned)e(in)h(the)g(FFII)
h(years)f(ago)f(to)i(stop)f(people)f(b)n(urning)f(out:)i(no)g(less)h
(than)f(tw)o(o)g(people)g(on)396 1412 y(an)o(y)g(project.)f(One-person)
f(projects)h(tend)h(to)g(end)g(in)g(tears,)h(or)f(at)g(least)h(bitter)f
(silence.)g(W)-7 b(e)22 b(ha)n(v)o(e)d(quite)h(a)h(lot)f(of)g(data)396
1520 y(on)g(b)n(urnout,)e(why)h(it)i(happens,)e(and)h(ho)n(w)f(to)i
(pre)n(v)o(ent)d(it)j(\(e)n(v)o(en)e(cure)g(it\).)i(I')o(ll)f(e)o
(xplore)f(this)h(later)h(in)f(the)g(chapter)m(,)396 1628
y(since)h(if)f(you)f(w)o(ork)h(with)g(or)g(on)g(open)f(source)h(you)f
(need)g(to)i(be)f(a)o(w)o(are)g(of)g(the)g(risks.)g(The)g("no)g(mer)o
(ging)e(your)h(o)n(wn)396 1736 y(patch")h(rule)g(has)g(tw)o(o)g(goals.)
g(First,)h(if)f(you)g(w)o(ant)g(your)f(project)g(to)i(be)f
(C4-certi\002ed,)f(you)g(ha)n(v)o(e)h(to)g(get)g(at)h(least)g(one)396
1844 y(other)f(person)f(to)h(help.)g(If)g(no-one)e(w)o(ants)j(to)f
(help)g(you,)f(perhaps)g(you)g(need)g(to)i(rethink)e(your)g(project.)g
(Second,)396 1952 y(ha)n(ving)g(a)i(control)e(for)g(e)n(v)o(ery)g
(patch)h(mak)o(es)g(it)h(much)e(more)g(satisfying,)h(k)o(eeps)g(us)g
(more)g(focused,)e(and)i(stops)g(us)396 2060 y(breaking)f(the)h(rules)g
(because)f(we')l(re)h(in)g(a)h(hurry)-5 b(,)18 b(or)i(just)g(feeling)g
(lazy)-5 b(.)-2 2078 y
SDict begin H.S end
 -2 2078 a -2 2078 a
SDict begin 13 H.A end
 -2 2078 a
-2 2078 a
SDict begin [/View [/XYZ H.V]/Dest (0:4386) cvn /DEST pdfmark end
 -2 2078 a -2 2161 a
SDict begin H.S end
 -2 2161 a -2 2161 a
SDict begin 11.7 H.A end
 -2
2161 a -2 2161 a
SDict begin [/View [/XYZ H.V]/Dest (0:4387) cvn /DEST pdfmark end
 -2 2161 a 479 2240 a Fa(Maintainers)20
b(SHALL)d(NO)m(T)i(mak)o(e)g(v)n(alue)h(judgments)g(on)f(correct)h
(patches.)-2 2422 y
SDict begin H.S end
 -2 2422 a -2 2422 a
SDict begin 13 H.A end
 -2 2422 a -2
2422 a
SDict begin [/View [/XYZ H.V]/Dest (0:4388) cvn /DEST pdfmark end
 -2 2422 a 396 2514 a Fj(W)-7 b(e)22 b(already)d(said)h(this)h(b)
n(ut)f(it')-5 b(s)21 b(w)o(orth)f(repeating:)f(the)h(role)g(of)g
(Maintainer)f(is)i(not)f(to)g(judge)f(a)i(patch')-5 b(s)20
b(substance,)396 2622 y(only)g(its)h(technical)e(quality)-5
b(.)19 b(The)h(substanti)n(v)o(e)f(w)o(orth)h(of)f(a)i(patch)f(only)f
(emer)o(ges)g(o)o(v)o(er)g(time:)h(people)f(use)i(it,)f(and)396
2730 y(lik)o(e)h(it,)f(or)g(the)o(y)g(do)g(not.)f(And)h(if)g(no-one)f
(is)i(using)e(a)i(patch,)e(e)n(v)o(entually)g(it')o(ll)i(anno)o(y)d
(someone)h(else)i(who)f(will)396 2838 y(remo)o(v)o(e)f(it,)h(and)g
(no-one)e(will)j(complain.)-2 2856 y
SDict begin H.S end
 -2 2856 a -2 2856
a
SDict begin 13 H.A end
 -2 2856 a -2 2856 a
SDict begin [/View [/XYZ H.V]/Dest (0:4389) cvn /DEST pdfmark end
 -2 2856 a -2 2939 a
SDict begin H.S end
 -2 2939 a -2
2939 a
SDict begin 11.7 H.A end
 -2 2939 a -2 2939 a
SDict begin [/View [/XYZ H.V]/Dest (0:4390) cvn /DEST pdfmark end
 -2 2939 a 479 3018 a Fa(Maintainers)f(SHALL)
d(mer)o(ge)i(correct)g(patches)h(rapidly)-5 b(.)-2 3200
y
SDict begin H.S end
 -2 3200 a -2 3200 a
SDict begin 13 H.A end
 -2 3200 a -2 3200 a
SDict begin [/View [/XYZ H.V]/Dest (0:4391) cvn /DEST pdfmark end
 -2 3200 a 396
3292 a Fj(There)20 b(is)h(a)f(criteria)g(I)h(call)f("change)f(latenc)o
(y")g(which)h(is)h(the)f(round-trip)e(time)i(from)f(identifying)f(a)j
(problem)d(to)396 3400 y(testing)i(a)h(solution.)e(The)h(f)o(aster)g
(the)h(better)-5 b(.)19 b(If)i(maintainers)e(cannot)g(respond)f(to)j
(pull)f(requests)f(as)i(rapidly)e(as)396 3508 y(people)g(e)o(xpect,)g
(the)o(y')l(re)g(not)h(doing)f(their)g(job)h(\(or)g(the)o(y)f(need)h
(more)f(hands\).)-2 3526 y
SDict begin H.S end
 -2 3526 a -2 3526 a
SDict begin 13 H.A end
 -2 3526
a -2 3526 a
SDict begin [/View [/XYZ H.V]/Dest (0:4392) cvn /DEST pdfmark end
 -2 3526 a -2 3609 a
SDict begin H.S end
 -2 3609 a -2 3609 a
SDict begin 11.7 H.A end
 -2
3609 a -2 3609 a
SDict begin [/View [/XYZ H.V]/Dest (0:4393) cvn /DEST pdfmark end
 -2 3609 a 479 3688 a Fa(The)g(Contrib)o(utor)g(MA)-8
b(Y)19 b(tag)g(an)g(issue)h(as)e("Ready")j(after)e(making)g(a)g(pull)g
(request)h(for)e(the)h(issue.)-2 3870 y
SDict begin H.S end
 -2 3870 a -2
3870 a
SDict begin 13 H.A end
 -2 3870 a -2 3870 a
SDict begin [/View [/XYZ H.V]/Dest (0:4394) cvn /DEST pdfmark end
 -2 3870 a 396 3962 a Fj(GitHub)h(by)g(def)o
(ault)f(of)n(fers)h(the)g(usual)g(v)n(ariety)f(of)h(issues)h(b)n(ut)f
(with)h(C4)f(we)h(don')o(t)d(use)j(them.)e(Instead)h(we)g(need)g(just)
396 4070 y(tw)o(o)h(labels,)f("Ur)o(gent")e(and)i("Ready".)f(A)i
(contrib)n(utor)d(who)i(w)o(ants)h(another)d(user)i(to)h(test)g(an)f
(issue)h(can)f(then)f(label)i(it)396 4178 y(as)g("Ready".)-2
4196 y
SDict begin H.S end
 -2 4196 a -2 4196 a
SDict begin 13 H.A end
 -2 4196 a -2 4196 a
SDict begin [/View [/XYZ H.V]/Dest (0:4395) cvn /DEST pdfmark end
 -2 4196
a -2 4279 a
SDict begin H.S end
 -2 4279 a -2 4279 a
SDict begin 11.7 H.A end
 -2 4279 a -2 4279 a
SDict begin [/View [/XYZ H.V]/Dest (0:4396) cvn /DEST pdfmark end
 -2
4279 a 479 4358 a Fa(The)e(user)g(who)h(created)f(an)g(issue)g(SHOULD)f
(close)h(the)g(issue)g(after)g(checking)h(the)f(patch)h(is)e
(successful.)-2 4540 y
SDict begin H.S end
 -2 4540 a -2 4540 a
SDict begin 13 H.A end
 -2 4540 a
-2 4540 a
SDict begin [/View [/XYZ H.V]/Dest (0:4397) cvn /DEST pdfmark end
 -2 4540 a 396 4632 a Fj(When)i(one)g(person)f(opens)g(an)i
(issue,)f(and)g(another)f(w)o(orks)g(on)h(it,)h(it')-5
b(s)21 b(best)g(to)f(allo)n(w)g(the)g(original)f(person)g(close)i(the)
396 4740 y(issue.)g(That)f(acts)h(as)g(a)f(double-check)d(that)j(the)h
(issue)f(w)o(as)h(properly)d(resolv)o(ed.)-2 4758 y
SDict begin H.S end
 -2
4758 a -2 4758 a
SDict begin 13 H.A end
 -2 4758 a -2 4758 a
SDict begin [/View [/XYZ H.V]/Dest (0:4398) cvn /DEST pdfmark end
 -2 4758 a -2 4841
a
SDict begin H.S end
 -2 4841 a -2 4841 a
SDict begin 11.7 H.A end
 -2 4841 a -2 4841 a
SDict begin [/View [/XYZ H.V]/Dest (0:4399) cvn /DEST pdfmark end
 -2 4841 a 479
4920 a Fa(Maintainers)i(SHOULD)e(ask)h(for)g(impro)o(v)o(ements)h(to)e
(incorrect)i(patches)f(and)h(SHOULD)e(reject)g(incorrect)i(patches)f
(if)g(the)479 5017 y(Contrib)o(utor)g(does)h(not)f(respond)h
(constructi)n(v)o(ely)-5 b(.)p Black 3759 5569 a Fi(320)p
Black eop end
%%Page: 321 335
TeXDict begin 321 334 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.321) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4400) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Initially)g(I)g(felt)h(it)g(w)o(as)g(w)o(orth)e(mer)o
(ging)f(all)j(patches)f(no)g(matter)f(ho)n(w)h(poor)-5
b(.)19 b(There')-5 b(s)20 b(an)g(element)g(of)g(trolling)396
180 y(in)m(v)n(olv)o(ed.)e(Mer)o(ging)g(brok)o(en)h(code)g(to)i(master)
f(might,)f(I)h(felt,)h(pull)f(in)g(more)f(contrib)n(utors.)f(But)j
(people)e(were)396 288 y(uncomfortable)e(with)j(this)g(so)h(we)f
(de\002ned)f(the)h("correct)e(patch")i(rules,)f(and)h(the)f
(Maintainer')-5 b(s)20 b(role)f(in)h(checking)e(for)396
396 y(quality)-5 b(.)19 b(On)h(the)g(ne)o(gati)n(v)o(e)e(side)j(I)f
(think)g(we)g(didn')o(t)f(tak)o(e)h(some)g(interesting)g(risks)g(which)
g(could)f(ha)n(v)o(e)h(paid)f(of)n(f)h(with)396 504 y(more)g
(participants.)f(On)h(the)g(positi)n(v)o(e)f(side)i(this)g(has)f(led)g
(to)g(\330MQ)h(master)f(\(and)f(in)i(all)f(projects)g(that)g(use)h
(C4\))f(being)396 612 y(practically)f(production)f(quality)-5
b(,)19 b(practically)g(all)i(the)f(time.)-2 630 y
SDict begin H.S end
 -2
630 a -2 630 a
SDict begin 13 H.A end
 -2 630 a -2 630 a
SDict begin [/View [/XYZ H.V]/Dest (0:4401) cvn /DEST pdfmark end
 -2 630 a -2 713 a
SDict begin H.S end
 -2
713 a -2 713 a
SDict begin 11.7 H.A end
 -2 713 a -2 713 a
SDict begin [/View [/XYZ H.V]/Dest (0:4402) cvn /DEST pdfmark end
 -2 713 a 479 792 a Fa(An)o(y)g
(Contrib)o(utor)e(who)i(has)f(v)n(alue)h(judgments)g(on)f(a)g(correct)g
(patch)h(SHOULD)d(e)o(xpress)j(these)f(via)g(their)g(o)n(wn)g(patches.)
-2 974 y
SDict begin H.S end
 -2 974 a -2 974 a
SDict begin 13 H.A end
 -2 974 a -2 974 a
SDict begin [/View [/XYZ H.V]/Dest (0:4403) cvn /DEST pdfmark end
 -2 974 a
396 1066 a Fj(In)h(essence,)g(the)g(goal)g(here)g(is)h(to)f(allo)n(w)g
(users)h(to)f(try)g(patches)g(rather)f(than)h(to)g(spend)g(time)g(ar)o
(guing)e(pros)i(and)f(cons.)396 1174 y(As)i(easy)g(as)f(it)h(is)g(to)g
(mak)o(e)f(a)g(patch,)g(it')-5 b(s)21 b(as)g(easy)f(to)g(re)n(v)o(ert)f
(it)i(with)g(another)d(patch.)i(Y)-9 b(ou)19 b(might)h(think)f(this)i
(w)o(ould)396 1282 y(lead)f(to)h("patch)e(w)o(ars")i(b)n(ut)f(that)g
(hasn')o(t)f(happened.)f(W)-7 b(e')l(v)o(e)20 b(had)g(a)g(handful)f(of)
g(cases)i(in)g(libzmq)e(where)h(patches)f(by)396 1390
y(one)h(contrib)n(utor)e(were)i(killed)g(by)g(another)e(person)h(who)h
(felt)h(the)f(e)o(xperimentation)d(w)o(asn')o(t)j(going)f(in)h(the)g
(right)396 1498 y(direction.)f(It)h(is)i(easier)e(than)g(seeking)f
(up-front)f(consensus.)-2 1516 y
SDict begin H.S end
 -2 1516 a -2 1516 a
SDict begin 13 H.A end

-2 1516 a -2 1516 a
SDict begin [/View [/XYZ H.V]/Dest (0:4404) cvn /DEST pdfmark end
 -2 1516 a -2 1599 a
SDict begin H.S end
 -2 1599 a -2
1599 a
SDict begin 11.7 H.A end
 -2 1599 a -2 1599 a
SDict begin [/View [/XYZ H.V]/Dest (0:4405) cvn /DEST pdfmark end
 -2 1599 a 479 1678 a Fa(Maintainers)i(MA)-8
b(Y)19 b(commit)g(changes)h(to)f(non-source)i(documentation)g(directly)
e(to)f(the)h(project.)-2 1860 y
SDict begin H.S end
 -2 1860 a -2 1860 a
SDict begin 13 H.A end
 -2
1860 a -2 1860 a
SDict begin [/View [/XYZ H.V]/Dest (0:4406) cvn /DEST pdfmark end
 -2 1860 a 396 1952 a Fj(This)i(e)o(xit)f(allo)n(ws)g
(maintainers)f(who)h(are)g(making)f(release)h(notes)g(to)g(push)g
(those)g(without)g(ha)n(ving)f(to)h(create)g(an)396 2060
y(issue)h(which)f(w)o(ould)f(then)h(af)n(fect)g(the)g(release)g(notes,)
g(leading)f(to)h(stress)h(on)f(the)g(space)h(time)f(f)o(abric)g(and)f
(possibly)396 2168 y(in)m(v)n(oluntary)f(rerouting)g(backw)o(ards)h(in)
h(the)g(fourth)f(dimension)g(to)h(before)f(the)h(in)m(v)o(ention)e(of)i
(cold)g(beer)-5 b(.)19 b(Shudder)-5 b(.)396 2276 y(Simpler)20
b(to)g(agree)g(that)g(release)g(notes)g(aren')o(t)f(changes)g(to)i(the)
f(softw)o(are.)-2 2304 y
SDict begin H.S end
 -2 2304 a -2 2304 a
SDict begin 13 H.A end
 -2 2304
a -2 2304 a
SDict begin [/View [/XYZ H.V]/Dest (0:4407) cvn /DEST pdfmark end
 -2 2304 a 396 2614 a Fd(7.3.7.)36 b(Creating)e(Stab)o(le)g
(Releases)2153 2614 y
SDict begin H.S end
 2153 2614 a 2153 2614 a
SDict begin 18.72 H.A end
 2153 2614
a 2153 2614 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.83.2) cvn /DEST pdfmark end
 2153 2614 a -2 2807 a
SDict begin H.S end
 -2 2807 a -2 2807
a
SDict begin 13 H.A end
 -2 2807 a -2 2807 a
SDict begin [/View [/XYZ H.V]/Dest (0:4409) cvn /DEST pdfmark end
 -2 2807 a 396 2888 a Fj(F)o(or)20
b(a)h(production)c(system)k(we)f(w)o(ant)g(some)g(guarantee)f(of)h
(stability)-5 b(.)20 b(In)f(the)i(past)f(this)h(meant)f(taking)f
(unstable)g(code)396 2996 y(and)h(then)g(o)o(v)o(er)e(months)i
(hammering)e(out)h(the)i(b)n(ugs)f(and)f(f)o(aults)i(until)f(it)h(w)o
(as)g(safe)f(to)g(trust.)g(iMatix')-5 b(s)21 b(job,)f(for)f(years,)396
3104 y(has)i(been)e(to)i(do)e(this)i(to)f(libzmq,)g(turning)e(ra)o(w)i
(code)g(into)g(packages)f(by)g(allo)n(wing)h(only)f(b)n(ug)h(\002x)o
(es,)g(and)f(no)h(ne)n(w)396 3212 y(code,)g(into)f(a)i("stabilization)f
(branch".)e(It')-5 b(s)21 b(surprisingly)d(not)i(as)h(thankless)f(as)h
(it)g(sounds.)-2 3396 y
SDict begin H.S end
 -2 3396 a -2 3396 a
SDict begin 13 H.A end
 -2 3396 a
-2 3396 a
SDict begin [/View [/XYZ H.V]/Dest (0:4410) cvn /DEST pdfmark end
 -2 3396 a 396 3486 a Fj(No)n(w)-5 b(,)20 b(since)g(we)h(went)
f(full)g(speed)g(with)g(C4,)g(we')l(v)o(e)g(found)e(that)i(git)h
(master)f(of)g(libzmq)f(is)i(mostly)f(perfect,)f(most)h(of)396
3594 y(the)g(time.)h(This)f(frees)g(our)f(time)i(to)f(do)g(more)f
(interesting)h(things,)f(such)h(as)h(b)n(uilding)e(ne)n(w)h(open)f
(source)g(layers)h(on)396 3702 y(top)g(of)g(libzmq.)f(Ho)n(we)n(v)o(er)
m(,)f(people)h(still)j(w)o(ant)e(that)g(guarantee:)f(man)o(y)g(users)h
(will)h(simply)f(not)g(install)h(e)o(xcept)e(from)396
3810 y(an)h("of)n(\002cial")g(release.)g(So)g(a)h(stable)f(release)h
(today)e(means)h(tw)o(o)g(things.)g(First,)h(a)f(snapshot)f(of)h(the)h
(master)f(tak)o(en)f(at)i(a)396 3918 y(time)g(when)e(there)h(were)g(no)
g(ne)n(w)g(changes)f(for)g(a)i(while,)f(and)g(no)g(dramatic)f(open)g(b)
n(ugs.)h(Second,)f(a)h(w)o(ay)g(to)396 4026 y(\002ne-tune)f(that)h
(snapshot)g(to)g(\002x)h(the)f(critical)g(issues)h(remaining)e(in)h
(it.)-2 4210 y
SDict begin H.S end
 -2 4210 a -2 4210 a
SDict begin 13 H.A end
 -2 4210 a -2 4210
a
SDict begin [/View [/XYZ H.V]/Dest (0:4411) cvn /DEST pdfmark end
 -2 4210 a 396 4300 a Fj(This)h(is)g(the)f(process)g(we)g(e)o(xplain)f
(in)i(this)f(section.)-2 4318 y
SDict begin H.S end
 -2 4318 a -2 4318 a
SDict begin 13 H.A end
 -2
4318 a -2 4318 a
SDict begin [/View [/XYZ H.V]/Dest (0:4412) cvn /DEST pdfmark end
 -2 4318 a -2 4401 a
SDict begin H.S end
 -2 4401 a -2 4401
a
SDict begin 11.7 H.A end
 -2 4401 a -2 4401 a
SDict begin [/View [/XYZ H.V]/Dest (0:4413) cvn /DEST pdfmark end
 -2 4401 a 479 4480 a Fa(The)f(project)g(SHALL)f
(ha)o(v)o(e)h(one)g(branch)h(\("master"\))g(that)f(al)o(w)o(ays)h
(holds)f(the)g(latest)f(in-progress)i(v)o(ersion)g(and)f(SHOULD)479
4577 y(al)o(w)o(ays)h(b)o(uild.)-2 4759 y
SDict begin H.S end
 -2 4759 a -2
4759 a
SDict begin 13 H.A end
 -2 4759 a -2 4759 a
SDict begin [/View [/XYZ H.V]/Dest (0:4414) cvn /DEST pdfmark end
 -2 4759 a 396 4851 a Fj(This)g(is)h
(redundant)d(since)i(e)n(v)o(ery)e(patch)h(al)o(w)o(ays)i(b)n(uilds)e
(b)n(ut)h(it')-5 b(s)21 b(w)o(orth)e(restating.)h(If)f(the)h(master)g
(doesn')o(t)e(b)n(uild)i(\(and)396 4959 y(pass)h(its)g(tests\),)g
(someone)e(needs)h(w)o(aking)f(up.)-2 4977 y
SDict begin H.S end
 -2 4977
a -2 4977 a
SDict begin 13 H.A end
 -2 4977 a -2 4977 a
SDict begin [/View [/XYZ H.V]/Dest (0:4415) cvn /DEST pdfmark end
 -2 4977 a -2 5060 a
SDict begin H.S end
 -2
5060 a -2 5060 a
SDict begin 11.7 H.A end
 -2 5060 a -2 5060 a
SDict begin [/View [/XYZ H.V]/Dest (0:4416) cvn /DEST pdfmark end
 -2 5060 a 479 5139
a Fa(The)g(project)g(SHALL)f(NO)m(T)g(use)h(topic)g(branches)i(for)d
(an)o(y)i(reason.)f(Personal)g(forks)g(MA)-8 b(Y)20 b(use)f(topic)g
(branches.)p Black 3759 5569 a Fi(321)p Black eop end
%%Page: 322 336
TeXDict begin 322 335 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.322) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4417) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(I')o(ll)g(come)g(to)g(branches)e(soon.)h(In)h(short)f
(\(or)g("tl;dr",)h(as)g(the)o(y)f(say)h(on)g(the)g(webs\))f(branches)g
(mak)o(e)g(the)h(repository)e(too)396 180 y(comple)o(x)h(and)g
(fragile,)h(and)f(require)g(upfront)f(agreement,)h(all)h(of)g(which)g
(are)g(e)o(xpensi)n(v)o(e)e(and)i(a)n(v)n(oidable.)-2
198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:4418) cvn /DEST pdfmark end
 -2 198 a -2
406 a
SDict begin H.S end
 -2 406 a -2 406 a
SDict begin 11.7 H.A end
 -2 406 a -2 406 a
SDict begin [/View [/XYZ H.V]/Dest (0:4419) cvn /DEST pdfmark end
 -2 406 a 479
485 a Fa(T)-6 b(o)19 b(mak)o(e)g(a)g(stable)g(release)g(someone)h
(SHALL)d(fork)i(the)f(repository)i(by)f(cop)o(ying)h(it)e(and)i(thus)f
(become)h(maintainer)f(of)f(this)479 582 y(repository)-5
b(.)-2 640 y
SDict begin H.S end
 -2 640 a -2 640 a
SDict begin 11.7 H.A end
 -2 640 a -2 640 a
SDict begin [/View [/XYZ H.V]/Dest (0:4420) cvn /DEST pdfmark end
 -2 640
a 479 721 a Fa(F)o(orking)19 b(a)g(project)h(for)e(stabilization)h(MA)
-8 b(Y)19 b(be)h(done)g(unilaterally)f(and)g(without)g(agreement)h(of)f
(project)g(maintainers.)-2 903 y
SDict begin H.S end
 -2 903 a -2 903 a
SDict begin 13 H.A end
 -2
903 a -2 903 a
SDict begin [/View [/XYZ H.V]/Dest (0:4421) cvn /DEST pdfmark end
 -2 903 a 396 995 a Fj(It')-5 b(s)21 b(free)f(softw)o
(are.)f(No-one)g(has)i(a)f(monopoly)e(on)h(it.)i(If)f(you)f(think)h
(the)g(maintainers)f(aren')o(t)g(producing)f(stable)396
1103 y(releases)j(right,)e(fork)g(the)h(repository)f(and)g(do)h(it)h
(yourself.)e(F)o(orking)f(isn')o(t)i(a)h(f)o(ailure,)e(it')-5
b(s)21 b(an)f(essential)h(tool)f(for)396 1211 y(competition.)e(Y)-9
b(ou)20 b(can')o(t)f(BTW)i(do)f(this)h(with)f(branches,)f(which)h
(means)f(a)i(branch-based)c(release)k(polic)o(y)e(gi)n(v)o(es)g(the)396
1319 y(project)h(maintainers)f(a)h(monopoly)-5 b(.)17
b(And)j(that')-5 b(s)21 b(bad)e(because)h(the)o(y')o(ll)f(become)g
(lazier)h(and)g(more)f(arrogant)f(than)i(if)396 1427
y(real)g(competition)f(is)i(chasing)e(their)h(heels.)-2
1445 y
SDict begin H.S end
 -2 1445 a -2 1445 a
SDict begin 13 H.A end
 -2 1445 a -2 1445 a
SDict begin [/View [/XYZ H.V]/Dest (0:4422) cvn /DEST pdfmark end
 -2 1445
a -2 1528 a
SDict begin H.S end
 -2 1528 a -2 1528 a
SDict begin 11.7 H.A end
 -2 1528 a -2 1528 a
SDict begin [/View [/XYZ H.V]/Dest (0:4423) cvn /DEST pdfmark end
 -2
1528 a 479 1607 a Fa(Maintainers)g(of)f(the)g(stabilization)g(project)g
(SHALL)e(maintain)j(it)e(through)i(pull)f(requests)g(which)h(MA)-8
b(Y)19 b(cherry-pick)479 1704 y(patches)h(from)f(the)g(fork)o(ed)h
(project.)-2 1886 y
SDict begin H.S end
 -2 1886 a -2 1886 a
SDict begin 13 H.A end
 -2 1886 a -2
1886 a
SDict begin [/View [/XYZ H.V]/Dest (0:4424) cvn /DEST pdfmark end
 -2 1886 a 396 1978 a Fj(Perhaps)g(the)g(C4)h(process)e(should)h
(just)g(say)h(that)f(stabilization)g(projects)f(ha)n(v)o(e)h
(maintainers)f(and)h(contrib)n(utors)e(lik)o(e)396 2086
y(an)o(y)i(project.)f(That')-5 b(s)20 b(all)h(this)g(rule)e(means.)-2
2104 y
SDict begin H.S end
 -2 2104 a -2 2104 a
SDict begin 13 H.A end
 -2 2104 a -2 2104 a
SDict begin [/View [/XYZ H.V]/Dest (0:4425) cvn /DEST pdfmark end
 -2 2104
a -2 2187 a
SDict begin H.S end
 -2 2187 a -2 2187 a
SDict begin 11.7 H.A end
 -2 2187 a -2 2187 a
SDict begin [/View [/XYZ H.V]/Dest (0:4426) cvn /DEST pdfmark end
 -2
2187 a 479 2266 a Fa(A)g(patch)g(to)g(a)g(repository)h(declared)g
("stable")f(SHALL)f(be)h(accompanied)i(by)e(a)g(reproducible)i(test)d
(case.)-2 2448 y
SDict begin H.S end
 -2 2448 a -2 2448 a
SDict begin 13 H.A end
 -2 2448 a -2 2448
a
SDict begin [/View [/XYZ H.V]/Dest (0:4427) cvn /DEST pdfmark end
 -2 2448 a 396 2540 a Fj(Be)n(w)o(are)j(of)f(a)g(one-size)g(\002ts)h
(all)g(process.)e(Ne)n(w)i(code)e(does)h(not)g(need)f(the)i(same)f
(paranoia)f(as)h(code)g(which)g(people)396 2648 y(are)g(trusting)f(for)
g(production)d(use.)k(In)f(the)h(normal)e(de)n(v)o(elopment)f(process)i
(we)h(did)f(not)g(mention)g(test)h(cases.)g(There')-5
b(s)396 2756 y(a)21 b(reason)e(for)h(this.)g(While)h(I)f(lo)o(v)o(e)g
(testable)g(patches,)g(man)o(y)f(changes)g(aren')o(t)g(easily)h(or)g
(at)h(all)f(testable.)g(Ho)n(we)n(v)o(er)f(to)396 2864
y(stabilize)i(a)f(code)g(base)g(you)f(w)o(ant)i(to)f(\002x)h(only)e
(serious)h(b)n(ugs,)g(and)f(you)g(w)o(ant)i(to)f(be)g(100\045)g(sure)g
(e)n(v)o(ery)f(change)f(is)396 2972 y(accurate.)h(This)i(means)f
(before/after)e(tests)j(for)e(e)n(v)o(ery)g(change.)-2
2990 y
SDict begin H.S end
 -2 2990 a -2 2990 a
SDict begin 13 H.A end
 -2 2990 a -2 2990 a
SDict begin [/View [/XYZ H.V]/Dest (0:4428) cvn /DEST pdfmark end
 -2 2990
a -2 3073 a
SDict begin H.S end
 -2 3073 a -2 3073 a
SDict begin 11.7 H.A end
 -2 3073 a -2 3073 a
SDict begin [/View [/XYZ H.V]/Dest (0:4429) cvn /DEST pdfmark end
 -2
3073 a 479 3152 a Fa(A)g(stabilization)g(repository)h(SHOULD)d
(progress)j(through)g(these)f(phases:)h("unstable",)g("candidate",)h
("stable",)f(and)f(then)479 3249 y("le)o(gac)o(y".)h(That)f(is,)f(the)h
(def)o(ault)g(beha)o(vior)h(of)f(stabilization)g(repositories)g(is)g
(to)f(die.)-2 3431 y
SDict begin H.S end
 -2 3431 a -2 3431 a
SDict begin 13 H.A end
 -2 3431 a -2
3431 a
SDict begin [/View [/XYZ H.V]/Dest (0:4430) cvn /DEST pdfmark end
 -2 3431 a 396 3523 a Fj(This)j(may)e(be)h(o)o(v)o(er)n
(-detailed.)e(The)i(k)o(e)o(y)f(point)h(here)f(is)i(that)g(these)f
(fork)o(ed)f(stabilization)g(repositories)h(all)g(die)h(in)f(the)396
3631 y(end,)g(as)h(master)f(continues)f(to)h(e)n(v)n(olv)o(e)f(and)h
(continues)f(to)h(be)g(fork)o(ed)f(of)n(f)g(for)h(production)d
(releases.)-2 3659 y
SDict begin H.S end
 -2 3659 a -2 3659 a
SDict begin 13 H.A end
 -2 3659 a -2
3659 a
SDict begin [/View [/XYZ H.V]/Dest (0:4431) cvn /DEST pdfmark end
 -2 3659 a 396 3969 a Fd(7.3.8.)36 b(Ev)l(olution)e(of)f(Pub)o
(lic)h(Contracts)2397 3969 y
SDict begin H.S end
 2397 3969 a 2397 3969 a
SDict begin 18.72 H.A end

2397 3969 a 2397 3969 a
SDict begin [/View [/XYZ H.V]/Dest (12.76.84.2) cvn /DEST pdfmark end
 2397 3969 a -2 4137 a
SDict begin H.S end
 -2 4137
a -2 4137 a
SDict begin 13 H.A end
 -2 4137 a -2 4137 a
SDict begin [/View [/XYZ H.V]/Dest (0:4433) cvn /DEST pdfmark end
 -2 4137 a 396 4243 a
Fj(By)21 b("public)e(contracts")g(I)i(mean)e(APIs)i(and)f(protocols.)e
(Up)j(until)f(the)g(end)f(of)h(2011,)f(libzmq')-5 b(s)20
b(naturally)f(happ)o(y)396 4351 y(state)i(w)o(as)g(marred)e(by)h(brok)o
(en)e(promises)i(and)g(brok)o(en)e(contracts.)h(W)-7
b(e)22 b(stopped)d(making)f(promises)i(\(aka)396 4459
y("roadmaps"\))e(for)i(libzmq)f(completely)-5 b(,)18
b(and)i(our)f(dominant)g(theory)g(of)g(change)g(is)i(no)n(w)f(that)g
(it)h(emer)o(ges)e(carefully)396 4567 y(and)h(accurately)f(o)o(v)o(er)g
(time.)h(At)g(a)h(2012)e(Chicago)g(meetup,)g(Garrett)h(Smith)g(and)g
(Chuck)f(Remes)i(called)f(this)h(the)396 4675 y("drunk)o(en)d(stumble)i
(to)g(greatness",)f(which)h(is)h(ho)n(w)f(I)g(think)g(of)g(it)h(no)n(w)
-5 b(.)-2 4859 y
SDict begin H.S end
 -2 4859 a -2 4859 a
SDict begin 13 H.A end
 -2 4859 a -2 4859
a
SDict begin [/View [/XYZ H.V]/Dest (0:4434) cvn /DEST pdfmark end
 -2 4859 a 396 4949 a Fj(W)e(e)22 b(stopped)d(breaking)f(public)h
(contracts)h(simply)f(by)h(banning)f(the)h(practice.)f(Before)h(then)f
(it)i(had)f(been)f("OK")i(\(as)396 5057 y(in)g(we)f(did)g(it,)h(and)e
(e)n(v)o(eryone)f(complained)g(bitterly)-5 b(,)19 b(and)h(we)g(ignored)
f(them\))g(to)i(break)e(the)h(API)g(or)g(protocol)f(so)p
Black 3759 5569 a Fi(322)p Black eop end
%%Page: 323 337
TeXDict begin 323 336 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.323) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4461) cvn /DEST pdfmark end
 -2 -201 a 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(long)g(as)h(we)f(changed)e(the)j(major)e(v)o(ersion)g
(number)-5 b(.)19 b(Sounds)g(\002ne,)h(until)g(you)f(get)h(\330MQ)h(v)o
(ersion)e(2.0,)g(3.0,)g(and)h(4.0,)396 180 y(all)h(in)f(de)n(v)o
(elopment)e(at)i(the)h(same)f(time,)g(and)g(not)g(speaking)e(to)j(each)
f(other)-5 b(.)-2 198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2
198 a
SDict begin [/View [/XYZ H.V]/Dest (0:4435) cvn /DEST pdfmark end
 -2 198 a -2 281 a
SDict begin H.S end
 -2 281 a -2 281 a
SDict begin 11.7 H.A end
 -2 281 a -2
281 a
SDict begin [/View [/XYZ H.V]/Dest (0:4436) cvn /DEST pdfmark end
 -2 281 a 479 361 a Fa(All)18 b(Public)h(Contracts)g(\(APIs)f(or)h
(protocols\))h(SHOULD)d(be)j(documented.)-2 543 y
SDict begin H.S end
 -2
543 a -2 543 a
SDict begin 13 H.A end
 -2 543 a -2 543 a
SDict begin [/View [/XYZ H.V]/Dest (0:4437) cvn /DEST pdfmark end
 -2 543 a 396 635 a Fj(Y)-9
b(ou')l(d)19 b(think)g(this)i(w)o(as)g(a)g(gi)n(v)o(en)e(for)g
(professional)g(softw)o(are)g(engineers)g(b)n(ut)i(no,)e(it')-5
b(s)21 b(not.)f(So,)g(it')-5 b(s)21 b(a)g(rule.)f(Y)-9
b(ou)19 b(w)o(ant)396 742 y(C4)i(certi\002cation)e(for)h(your)f
(project,)g(you)g(mak)o(e)h(sure)g(your)f(public)g(contracts)h(are)g
(documented.)d(No)j("it')-5 b(s)21 b(speci\002ed)396
850 y(in)g(the)f(code")f(e)o(xcuses.)h(Code)g(is)h(not)f(a)g(contract.)
f(\(Y)-8 b(es,)20 b(I)h(intend)e(at)i(some)f(point)f(to)h(create)g(a)h
(C4)g(certi\002cation)396 958 y(process)f(to)g(act)h(as)g(a)f(quality)g
(indicator)f(for)g(open)g(source)h(projects.\))-2 976
y
SDict begin H.S end
 -2 976 a -2 976 a
SDict begin 13 H.A end
 -2 976 a -2 976 a
SDict begin [/View [/XYZ H.V]/Dest (0:4438) cvn /DEST pdfmark end
 -2 976 a -2 1059
a
SDict begin H.S end
 -2 1059 a -2 1059 a
SDict begin 11.7 H.A end
 -2 1059 a -2 1059 a
SDict begin [/View [/XYZ H.V]/Dest (0:4439) cvn /DEST pdfmark end
 -2 1059 a 479
1138 a Fa(All)e(Public)h(Contracts)g(SHALL)f(use)h(Semantic)g(V)-8
b(ersioning.)-2 1321 y
SDict begin H.S end
 -2 1321 a -2 1321 a
SDict begin 13 H.A end
 -2 1321 a
-2 1321 a
SDict begin [/View [/XYZ H.V]/Dest (0:4440) cvn /DEST pdfmark end
 -2 1321 a 396 1412 a Fj(This)21 b(rule)e(is)j(mainly)d(here)h
(because)f(people)g(ask)o(ed)h(for)g(it.)g(I')l(v)o(e)f(no)h(real)g(lo)
o(v)o(e)g(for)f(it,)i(since)f(Semantic)g(V)-9 b(ersioning)19
b(is)396 1520 y(what)h(led)h(to)f(the)g(so-called)g("why)f(does)h
(\330MQ)g(not)g(speak)g(to)g(itself?!")g(debacle.)f(I')l(v)o(e)g(ne)n
(v)o(er)g(seen)i(the)f(problem)e(that)396 1628 y(this)j(solv)o(ed.)e
(Something)g(about)g(runtime)g(v)n(alidation)g(of)h(library)f(v)o
(ersions,)g(or)h(some-such.)-2 1646 y
SDict begin H.S end
 -2 1646 a -2 1646
a
SDict begin 13 H.A end
 -2 1646 a -2 1646 a
SDict begin [/View [/XYZ H.V]/Dest (0:4441) cvn /DEST pdfmark end
 -2 1646 a -2 1729 a
SDict begin H.S end
 -2 1729 a -2
1729 a
SDict begin 11.7 H.A end
 -2 1729 a -2 1729 a
SDict begin [/View [/XYZ H.V]/Dest (0:4442) cvn /DEST pdfmark end
 -2 1729 a 479 1808 a Fa(All)e(Public)h
(Contracts)g(SHOULD)f(ha)o(v)o(e)h(space)h(for)e(e)o(xtensibility)h
(and)h(e)o(xperimentation.)-2 1991 y
SDict begin H.S end
 -2 1991 a -2 1991
a
SDict begin 13 H.A end
 -2 1991 a -2 1991 a
SDict begin [/View [/XYZ H.V]/Dest (0:4443) cvn /DEST pdfmark end
 -2 1991 a 396 2082 a Fj(No)n(w)-5
b(,)20 b(the)g(real)g(thing)g(is)h(that)f(public)f(contracts)1821
2082 y
SDict begin H.S end
 1821 2082 a 1821 2082 a
SDict begin 13 H.A end
 1821 2082 a 1821 2082
a
SDict begin [/View [/XYZ H.V]/Dest (0:4444) cvn /DEST pdfmark end
 1821 2082 a Fi(do)h(c)o(hang)o(e)p Fj(.)e(It')-5 b(s)21
b(not)e(about)h(not)g(changing)e(them.)h(It')-5 b(s)21
b(about)396 2190 y(changing)d(them)i(safely)-5 b(.)20
b(This)g(means)g(educating)e(\(especially)i(protocol\))e(designers)h
(to)i(create)e(that)i(space)f(up)g(front.)-2 2208 y
SDict begin H.S end
 -2
2208 a -2 2208 a
SDict begin 13 H.A end
 -2 2208 a -2 2208 a
SDict begin [/View [/XYZ H.V]/Dest (0:4445) cvn /DEST pdfmark end
 -2 2208 a -2 2291
a
SDict begin H.S end
 -2 2291 a -2 2291 a
SDict begin 11.7 H.A end
 -2 2291 a -2 2291 a
SDict begin [/View [/XYZ H.V]/Dest (0:4446) cvn /DEST pdfmark end
 -2 2291 a 479
2371 a Fa(A)f(patch)g(that)g(modi\002es)g(a)g(Public)g(Contract)g
(SHOULD)e(not)j(break)f(e)o(xisting)g(applications)h(unless)g(there)f
(is)f(prior)479 2468 y(consensus)j(on)e(the)g(v)n(alue)h(of)f(doing)h
(this.)-2 2650 y
SDict begin H.S end
 -2 2650 a -2 2650 a
SDict begin 13 H.A end
 -2 2650 a -2 2650
a
SDict begin [/View [/XYZ H.V]/Dest (0:4447) cvn /DEST pdfmark end
 -2 2650 a 396 2742 a Fj(Sometimes)g(the)g(patch)g(is)h(\002xing)e(a)i
(bad)f(API)g(that)h(no-one)d(is)j(using.)e(It')-5 b(s)21
b(a)g(freedom)d(we)j(need)e(b)n(ut)h(it)h(should)f(be)396
2850 y(based)g(on)g(consensus,)f(not)h(one)f(person')-5
b(s)20 b(dogma.)e(Ho)n(we)n(v)o(er)m(,)h(making)f(random)h(changes)g
(just)i('because')d(is)k(not)396 2957 y(good.)d(In)h(\330MQ/3.x,)f(did)
h(we)g(bene\002t)g(from)f(renaming)2063 2957 y
SDict begin H.S end
 2063 2957
a 2063 2957 a
SDict begin 13 H.A end
 2063 2957 a 2063 2957 a
SDict begin [/View [/XYZ H.V]/Dest (0:4448) cvn /DEST pdfmark end
 2063 2957 a Fg(ZMQ_NOBLOCK)g
Fj(to)2663 2957 y
SDict begin H.S end
 2663 2957 a 2663 2957 a
SDict begin 13 H.A end
 2663 2957 a
2663 2957 a
SDict begin [/View [/XYZ H.V]/Dest (0:4449) cvn /DEST pdfmark end
 2663 2957 a Fg(ZMQ_DONTWAIT)p Fj(?)f(Sure,)i(it')-5
b(s)21 b(closer)f(to)396 3065 y(the)g(POSIX)h(sock)o(et)1011
3065 y
SDict begin H.S end
 1011 3065 a 1011 3065 a
SDict begin 13 H.A end
 1011 3065 a 1011 3065
a
SDict begin [/View [/XYZ H.V]/Dest (0:4450) cvn /DEST pdfmark end
 1011 3065 a Fg(recv\(\))f Fj(call,)g(b)n(ut)g(is)i(that)e(w)o(orth)f
(breaking)g(thousands)g(of)g(applications?)g(No-one)g(e)n(v)o(er)396
3173 y(reported)g(it)i(as)f(an)h(issue.)f(T)-7 b(o)21
b(misquote)e(Stallman:)1928 3173 y
SDict begin H.S end
 1928 3173 a 1928 3173
a
SDict begin 13 H.A end
 1928 3173 a 1928 3173 a
SDict begin [/View [/XYZ H.V]/Dest (0:4451) cvn /DEST pdfmark end
 1928 3173 a Fi(your)h(fr)m(eedom)f(to)i(cr)m
(eate)f(an)g(ideal)g(world)g(stops)g(one)g(inc)o(h)g(fr)l(om)396
3281 y(my)h(application.)-2 3298 y
SDict begin H.S end
 -2 3298 a -2 3298
a
SDict begin 13 H.A end
 -2 3298 a -2 3298 a
SDict begin [/View [/XYZ H.V]/Dest (0:4452) cvn /DEST pdfmark end
 -2 3298 a -2 3381 a
SDict begin H.S end
 -2 3381 a -2
3381 a
SDict begin 11.7 H.A end
 -2 3381 a -2 3381 a
SDict begin [/View [/XYZ H.V]/Dest (0:4453) cvn /DEST pdfmark end
 -2 3381 a 479 3461 a Fa(A)e(patch)g(that)g
(introduces)h(ne)n(w)f(features)h(to)e(a)h(Public)g(Contract)g(SHOULD)f
(do)h(so)g(using)h(ne)n(w)f(names.)-2 3644 y
SDict begin H.S end
 -2 3644
a -2 3644 a
SDict begin 13 H.A end
 -2 3644 a -2 3644 a
SDict begin [/View [/XYZ H.V]/Dest (0:4454) cvn /DEST pdfmark end
 -2 3644 a 396 3735 a
Fj(W)-7 b(e)22 b(had)d(the)h(e)o(xperience)f(in)h(\330MQ)g(once)g(or)g
(twice)g(of)g(ne)n(w)g(features)g(using)f(old)h(names)g(\(or)g(w)o
(orse,)g(using)f(names)396 3843 y(that)i(were)724 3843
y
SDict begin H.S end
 724 3843 a 724 3843 a
SDict begin 13 H.A end
 724 3843 a 724 3843 a
SDict begin [/View [/XYZ H.V]/Dest (0:4455) cvn /DEST pdfmark end
 724 3843
a Fi(still)g(in)f(use)h Fj(else)n(where\).)e(\330MQ/3.0)g(had)h(a)g(ne)
n(wly)g(introduced)e("R)m(OUTER")i(sock)o(et)g(that)g(w)o(as)h(totally)
396 3951 y(dif)n(ferent)e(from)g(the)h(e)o(xisting)g(R)m(OUTER)g(sock)o
(et)g(in)g(2.x.)g(Dear)g(lord,)f(you)g(should)h(be)g(f)o(ace-palming,)d
(why?)j(The)396 4059 y(reason:)g(apparently)-5 b(,)17
b(e)n(v)o(en)j(smart)g(people)f(sometimes)h(need)f(re)o(gulation)f(to)j
(stop)f(them)g(doing)f(silly)h(things.)-2 4077 y
SDict begin H.S end
 -2 4077
a -2 4077 a
SDict begin 13 H.A end
 -2 4077 a -2 4077 a
SDict begin [/View [/XYZ H.V]/Dest (0:4456) cvn /DEST pdfmark end
 -2 4077 a -2 4160 a
SDict begin H.S end
 -2
4160 a -2 4160 a
SDict begin 11.7 H.A end
 -2 4160 a -2 4160 a
SDict begin [/View [/XYZ H.V]/Dest (0:4457) cvn /DEST pdfmark end
 -2 4160 a 479 4239
a Fa(Old)f(names)h(SHOULD)d(be)j(deprecated)g(in)f(a)f(systematic)i(f)o
(ashion)g(by)f(marking)h(ne)n(w)f(names)h(as)e("e)o(xperimental")j
(until)479 4336 y(the)o(y)f(are)e(stable,)h(then)g(marking)h(the)f(old)
g(names)h(as)f("deprecated".)-2 4519 y
SDict begin H.S end
 -2 4519 a -2 4519
a
SDict begin 13 H.A end
 -2 4519 a -2 4519 a
SDict begin [/View [/XYZ H.V]/Dest (0:4458) cvn /DEST pdfmark end
 -2 4519 a 396 4610 a Fj(This)i(life-c)o(ycle)e
(notation)g(has)h(the)g(great)g(bene\002t)g(of)g(actually)f(telling)h
(users)g(what)h(is)g(going)e(on,)g(with)h(a)h(consistent)396
4718 y(direction.)e("Experimental")f(means)i("we)g(ha)n(v)o(e)g
(introduced)d(this)k(and)f(intend)f(to)h(mak)o(e)g(it)h(stable)g(if)f
(it)h(w)o(orks".)e(Not,)396 4826 y("we)i(ha)n(v)o(e)e(introduced)f
(this)j(and)e(will)i(remo)o(v)o(e)e(it)i(at)f(an)o(y)g(time)g(if)h(we)f
(feel)g(lik)o(e)h(it".)f(One)g(assumes)h(that)f(code)g(which)396
4934 y(survi)n(v)o(es)f(more)h(than)f(one)h(patch)g(c)o(ycle)f(is)j
(meant)d(to)i(be)f(there.)f("Deprecated")g(means)g("we)i(ha)n(v)o(e)f
(replaced)e(this)j(and)396 5042 y(intend)f(to)g(remo)o(v)o(e)e(it".)-2
5043 y
SDict begin H.S end
 -2 5043 a -2 5043 a
SDict begin 13 H.A end
 -2 5043 a -2 5043 a
SDict begin [/View [/XYZ H.V]/Dest (0:4459) cvn /DEST pdfmark end
 -2 5043
a Black 3759 5569 a Fi(323)p Black eop end
%%Page: 324 338
TeXDict begin 324 337 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.324) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4460) cvn /DEST pdfmark end
 -2
-11 a 479 72 a Fa(When)f(suf)n(\002cient)g(time)g(has)g(passed,)h(old)f
(deprecated)h(names)g(SHOULD)d(be)j(mark)o(ed)g("le)o(gac)o(y")g(and)f
(e)n(v)o(entually)h(remo)o(v)o(ed.)396 346 y Fj(Which)g(in)h(theory)e
(gi)n(v)o(es)g(applications)g(time)i(to)f(mo)o(v)o(e)f(onto)g(stable)i
(ne)n(w)f(contracts)f(b)n(ut)h(without)g(risk.)g(Y)-9
b(ou)19 b(can)396 454 y(upgrade)f(\002rst,)j(mak)o(e)f(sure)g(things)g
(w)o(ork,)f(and)h(then,)f(o)o(v)o(er)g(time,)h(\002x)g(things)g(up)g
(to)g(remo)o(v)o(e)f(dependencies)f(on)396 562 y(deprecated)h(and)g(le)
o(gac)o(y)g(APIs)i(and)e(protocols.)-2 580 y
SDict begin H.S end
 -2 580 a
-2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:4462) cvn /DEST pdfmark end
 -2 580 a -2 663 a
SDict begin H.S end
 -2 663 a
-2 663 a
SDict begin 11.7 H.A end
 -2 663 a -2 663 a
SDict begin [/View [/XYZ H.V]/Dest (0:4463) cvn /DEST pdfmark end
 -2 663 a 479 742 a Fa(Old)g(names)h(SHALL)d
(NO)m(T)h(be)i(reused)f(by)h(ne)n(w)f(features.)-2 925
y
SDict begin H.S end
 -2 925 a -2 925 a
SDict begin 13 H.A end
 -2 925 a -2 925 a
SDict begin [/View [/XYZ H.V]/Dest (0:4464) cvn /DEST pdfmark end
 -2 925 a 396 1016
a Fj(Ah,)h(yes,)g(the)h(jo)o(y)f(when)f(\330MQ/3.x)h(renamed)e(the)i
(top-used)f(API)i(functions)d(\()2729 1016 y
SDict begin H.S end
 2729 1016
a 2729 1016 a
SDict begin 13 H.A end
 2729 1016 a 2729 1016 a
SDict begin [/View [/XYZ H.V]/Dest (0:4465) cvn /DEST pdfmark end
 2729 1016 a Fg(zmq_send\(\))h
Fj(and)3339 1016 y
SDict begin H.S end
 3339 1016 a 3339 1016 a
SDict begin 13 H.A end
 3339 1016
a 3339 1016 a
SDict begin [/View [/XYZ H.V]/Dest (0:4466) cvn /DEST pdfmark end
 3339 1016 a Fg(zmq_recv\(\))p Fj(\))396
1124 y(and)h(then)g(rec)o(ycled)e(the)j(old)e(names)h(for)g(ne)n(w)g
(methods)f(that)h(were)g(utterly)g(incompatible)e(\(and)h(which)h(I)g
(suspect)396 1232 y(fe)n(w)g(people)f(actually)h(use\).)g(Y)-9
b(ou)19 b(should)h(be)g(slapping)f(yourself)g(in)h(confusion)e(again,)h
(b)n(ut)h(really)-5 b(,)20 b(this)g(is)h(what)396 1340
y(happened)d(and)i(I)g(w)o(as)h(as)g(guilty)f(as)h(an)o(yone.)d(After)i
(all,)g(we)h(did)e(change)g(the)i(v)o(ersion)d(number!)h(Semantic)g(V)
-9 b(ersion)396 1448 y(FTW!!)21 b(The)e(only)h(bene\002t)g(of)f(that)i
(e)o(xperience)d(w)o(as)j(to)f(get)g(this)h(rule.)-2
1466 y
SDict begin H.S end
 -2 1466 a -2 1466 a
SDict begin 13 H.A end
 -2 1466 a -2 1466 a
SDict begin [/View [/XYZ H.V]/Dest (0:4467) cvn /DEST pdfmark end
 -2 1466
a -2 1549 a
SDict begin H.S end
 -2 1549 a -2 1549 a
SDict begin 11.7 H.A end
 -2 1549 a -2 1549 a
SDict begin [/View [/XYZ H.V]/Dest (0:4468) cvn /DEST pdfmark end
 -2
1549 a 479 1628 a Fa(When)e(old)h(names)f(are)g(remo)o(v)o(ed,)h(their)
e(implementations)i(MUST)e(pro)o(v)o(ok)o(e)j(an)e(e)o(xception)h
(\(assertion\))f(if)f(used)i(by)479 1725 y(applications.)-2
1908 y
SDict begin H.S end
 -2 1908 a -2 1908 a
SDict begin 13 H.A end
 -2 1908 a -2 1908 a
SDict begin [/View [/XYZ H.V]/Dest (0:4469) cvn /DEST pdfmark end
 -2 1908
a 396 1999 a Fj(I')l(v)o(e)f(not)h(tested)h(this)f(rule)g(to)h(be)f
(certain)f(it)i(mak)o(es)f(sense.)h(Perhaps)e(what)h(it)h(means)f(is)h
("if)g(you)e(can')o(t)g(pro)o(v)n(ok)o(e)f(a)396 2107
y(compile)i(error)f(because)g(the)h(API)h(is)g(dynamic,)d(pro)o(v)n(ok)
o(e)g(an)j(assertion".)-2 2291 y
SDict begin H.S end
 -2 2291 a -2 2291 a
SDict begin 13 H.A end

-2 2291 a -2 2291 a
SDict begin [/View [/XYZ H.V]/Dest (0:4470) cvn /DEST pdfmark end
 -2 2291 a 396 2381 a Fj(C4)g(is)g(not)f(perfect,)f
(fe)n(w)h(things)g(are.)g(The)f(process)h(for)g(changing)e(it)j
(\(Digistan')-5 b(s)20 b(COSS\))h(is)g(a)g(little)g(outdated)d(no)n(w:)
396 2489 y(it)j(relies)g(on)f(a)g(single-editor)f(w)o(ork\003o)n(w)g
(with)h(the)g(ability)g(to)h(fork,)d(b)n(ut)j(not)e(mer)o(ge.)g(This)h
(seems)h(to)f(w)o(ork)g(b)n(ut)g(it)396 2597 y(could)f(be)i(better)e
(to)i(use)f(C4)h(for)e(protocols)g(lik)o(e)i(C4.)-2 2709
y
SDict begin H.S end
 -2 2709 a -2 2709 a
SDict begin 13 H.A end
 -2 2709 a -2 2709 a
SDict begin [/View [/XYZ H.V]/Dest (0:4471) cvn /DEST pdfmark end
 -2 2709 a 359
x Fh(7.4.)39 b(W)-9 b(orked)39 b(Example)1426 3068 y
SDict begin H.S end

1426 3068 a 1426 3068 a
SDict begin 22.464 H.A end
 1426 3068 a 1426 3068 a
SDict begin [/View [/XYZ H.V]/Dest (12.77.1) cvn /DEST pdfmark end
 1426
3068 a -2 3263 a
SDict begin H.S end
 -2 3263 a -2 3263 a
SDict begin 13 H.A end
 -2 3263 a -2 3263
a
SDict begin [/View [/XYZ H.V]/Dest (0:4473) cvn /DEST pdfmark end
 -2 3263 a 396 3342 a Fj(In)486 3342 y
SDict begin H.S end
 486 3342 a 486
3342 a
SDict begin 13 H.A end
 486 3342 a 486 3342 a
SDict begin [/View [/XYZ H.V]/Dest (0:4474) cvn /DEST pdfmark end
 486 3342 a Fj(this)21 b(email)f(thread)f
(\(http://lists.zeromq.or)o(g/pipermail/zero)o(mq)o(-d)o(e)n(v/2)o(01)o
(2-)o(Octob)o(er/0)o(188)o(38)o(.h)o(tml\),)14 b(Dan)396
3450 y(Goes)21 b(asks)f(ho)n(w)g(to)g(mak)o(e)g(a)h(publisher)d(that)j
(kno)n(ws)e(when)h(a)g(ne)n(w)g(client)h(subscribes,)e(and)h(sends)g
(out)g(pre)n(vious)396 3558 y(matching)f(messages.)h(It')-5
b(s)21 b(a)g(standard)e(pub-sub)f(technique)g(called)i("last)h(v)n
(alue)f(caching".)e(No)n(w)j(o)o(v)o(er)d(a)j(1-w)o(ay)396
3665 y(transport)d(lik)o(e)i(pgm)f(\(where)f(subscribers)h(literally)g
(send)g(no)g(pack)o(ets)g(back)g(to)g(publishers\))f(this)i(can')o(t)f
(be)g(done.)f(But)396 3773 y(o)o(v)o(er)h(TCP)-9 b(,)21
b(it)g(can,)e(if)i(we)f(use)h(an)f(XPUB)h(sock)o(et)f(and)g(if)g(that)g
(sock)o(et)h(didn')o(t)d(cle)n(v)o(erly)h(\002lter)i(out)e(duplicate)
396 3881 y(subscriptions)g(to)i(reduce)e(upstream)g(traf)n(\002c.)-2
4065 y
SDict begin H.S end
 -2 4065 a -2 4065 a
SDict begin 13 H.A end
 -2 4065 a -2 4065 a
SDict begin [/View [/XYZ H.V]/Dest (0:4475) cvn /DEST pdfmark end
 -2 4065
a 396 4155 a Fj(Though)f(I'm)i(not)g(an)g(e)o(xpert)f(contrib)n(utor)f
(to)i(libzmq,)f(this)i(seems)g(a)f(fun)g(problem)e(to)j(solv)o(e.)e(Ho)
n(w)h(hard)g(could)f(it)396 4263 y(be?)h(I)h(start)f(by)g(forking)e
(the)j(libzmq)e(repository)f(to)j(my)f(o)n(wn)f(GitHub)h(account,)f
(and)g(then)h(clone)g(it)h(to)f(my)g(laptop,)396 4371
y(where)g(I)g(b)n(uild)g(it:)-2 4455 y
SDict begin H.S end
 -2 4455 a -2 4455
a
SDict begin 11.7 H.A end
 -2 4455 a -2 4455 a
SDict begin [/View [/XYZ H.V]/Dest (0:4476) cvn /DEST pdfmark end
 -2 4455 a 396 4551 a Fg(git)45
b(clone)f(git@github.com:hintjens/libzmq.git)396 4648
y(cd)h(libzmq)396 4746 y(./autogen.sh)396 4843 y(./configure)396
4940 y(make)p Black 3759 5569 a Fi(324)p Black eop end
%%Page: 325 339
TeXDict begin 325 338 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.325) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4477) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Since)g(the)h(libzmq)e(code)h(is)h(neat)f(and)f
(well-or)o(ganized)e(it)k(w)o(as)g(quite)f(easy)g(to)h(\002nd)f(the)g
(main)g(\002les)h(to)f(change)396 180 y(\(xpub)m(.cpp)d(and)j(xpub)m
(.hpp\).)c(Each)k(sock)o(et)g(type)f(has)i(its)g(o)n(wn)f(source)f
(\002le)i(and)f(class.)g(The)o(y)g(inherit)f(from)396
288 y(sock)o(et_base.cpp,)f(which)h(has)i(this)g(hook)d(for)i(sock)o
(et-speci\002c)f(options:)-2 389 y
SDict begin H.S end
 -2 389 a -2 389 a
SDict begin 11.7 H.A end

-2 389 a -2 389 a
SDict begin [/View [/XYZ H.V]/Dest (0:4478) cvn /DEST pdfmark end
 -2 389 a 396 468 a Fg(//)90 b(First,)43
b(check)h(whether)g(specific)g(socket)f(type)i(overloads)e(the)h
(option.)396 566 y(int)h(rc)f(=)h(xsetsockopt)e(\(option_,)g(optval_,)h
(optvallen_\);)396 663 y(if)h(\(rc)f(==)h(0)f(||)h(errno)f(!=)g
(EINVAL\))576 760 y(return)f(rc;)396 954 y(//)90 b(If)44
b(the)g(socket)g(type)g(doesn't)g(support)g(the)g(option,)g(pass)g(it)g
(to)396 1051 y(//)90 b(the)44 b(generic)g(option)f(parser.)396
1148 y(return)h(options.setsockopt)e(\(option_,)h(optval_,)h
(optvallen_\);)-2 1326 y
SDict begin H.S end
 -2 1326 a -2 1326 a
SDict begin 13 H.A end
 -2 1326
a -2 1326 a
SDict begin [/View [/XYZ H.V]/Dest (0:4479) cvn /DEST pdfmark end
 -2 1326 a 396 1422 a Fj(Then)20 b(I)g(check)f(where)h(the)g
(XPUB)h(sock)o(et)f(\002lters)h(out)f(duplicate)f(subscriptions,)g(in)h
(its)h(xread_acti)n(v)n(ated)d(method:)-2 1523 y
SDict begin H.S end
 -2 1523
a -2 1523 a
SDict begin 11.7 H.A end
 -2 1523 a -2 1523 a
SDict begin [/View [/XYZ H.V]/Dest (0:4480) cvn /DEST pdfmark end
 -2 1523 a 396 1603 a
Fg(bool)44 b(unique;)396 1700 y(if)h(\()576 1713 y(*)621
1700 y(data)f(==)g(0\))576 1797 y(unique)f(=)i(subscriptions.rm)d
(\(data)i(+)h(1,)f(size)h(-)f(1,)h(pipe_\);)396 1894
y(else)576 1991 y(unique)e(=)i(subscriptions.add)d(\(data)i(+)h(1,)f
(size)g(-)h(1,)g(pipe_\);)396 2185 y(//)90 b(If)44 b(the)g
(subscription)f(is)i(not)f(a)h(duplicate)e(store)h(it)h(so)f(that)g(it)
h(can)f(be)396 2283 y(//)90 b(passed)43 b(to)i(used)f(on)h(next)f(recv)
g(call.)396 2380 y(if)h(\(unique)e(&&)i(options.type)e(!=)h(ZMQ_PUB\))
576 2477 y(pending.push_back)e(\(blob_t)h(\(data,)h(size\)\);)-2
2654 y
SDict begin H.S end
 -2 2654 a -2 2654 a
SDict begin 13 H.A end
 -2 2654 a -2 2654 a
SDict begin [/View [/XYZ H.V]/Dest (0:4481) cvn /DEST pdfmark end
 -2 2654
a 396 2751 a Fj(At)21 b(this)g(stage)f(I'm)g(not)g(too)f(concerned)f
(with)j(the)f(details)g(of)g(ho)n(w)g(subscriptions.rm)e(and)i(.add)f
(w)o(ork.)g(The)h(code)396 2859 y(seems)h(ob)o(vious)d(e)o(xcept)i
(that)g("subscription")e(also)j(includes)e(unsubscription,)f(which)h
(confused)g(me)h(for)g(a)g(fe)n(w)396 2967 y(seconds.)f(If)g(there')-5
b(s)19 b(an)o(ything)e(else)j(weird)f(in)g(the)g(rm)g(and)g(add)g
(methods,)f(that')-5 b(s)19 b(a)h(separate)f(issue)g(to)h(\002x)f
(later)-5 b(.)20 b(T)m(ime)396 3075 y(to)h(mak)o(e)e(an)h(issue)h(for)f
(this)h(change.)d(I)j(head)e(o)o(v)o(er)g(to)h(the)g(zeromq.jira.com)d
(site,)k(log)f(in,)g(and)g(create)g(a)g(ne)n(w)g(entry)-5
b(.)-2 3259 y
SDict begin H.S end
 -2 3259 a -2 3259 a
SDict begin 13 H.A end
 -2 3259 a -2 3259 a
SDict begin [/View [/XYZ H.V]/Dest (0:4482) cvn /DEST pdfmark end

-2 3259 a 396 3349 a Fj(Jira)21 b(kindly)e(of)n(fers)g(me)h(the)h
(traditional)e(choice)g(between)g("b)n(ug")h(and)f("ne)n(w)h(feature")f
(and)h(I)g(spend)g(thirty)g(seconds)396 3456 y(w)o(ondering)e(where)i
(this)h(counter)n(-producti)n(v)o(e)15 b(historical)20
b(distinction)f(came)h(from.)f(Presumably)-5 b(,)18 b(the)i("we')o(ll)h
(\002x)396 3564 y(b)n(ugs)f(for)g(free)g(b)n(ut)g(you)f(pay)h(for)f(ne)
n(w)h(features")g(commercial)e(proposal,)h(which)g(stems)i(from)e(the)i
("you)e(tell)i(us)f(what)396 3672 y(you)g(w)o(ant)g(and)g(we')o(ll)g
(mak)o(e)g(it)h(for)e($X")h(model)g(of)g(softw)o(are)f(de)n(v)o
(elopment,)e(and)j(which)g(generally)e(leads)j(to)f("we)396
3780 y(spent)g(three)g(times)h($X)f(and)f(we)i(got)f(what?!")f(email)i
(Fists)g(of)f(Fury)-5 b(.)-2 3964 y
SDict begin H.S end
 -2 3964 a -2 3964
a
SDict begin 13 H.A end
 -2 3964 a -2 3964 a
SDict begin [/View [/XYZ H.V]/Dest (0:4483) cvn /DEST pdfmark end
 -2 3964 a 396 4054 a Fj(Putting)20
b(such)g(thoughts)f(aside,)h(I)g(create)1616 4054 y
SDict begin H.S end
 1616
4054 a 1616 4054 a
SDict begin 13 H.A end
 1616 4054 a 1616 4054 a
SDict begin [/View [/XYZ H.V]/Dest (0:4484) cvn /DEST pdfmark end
 1616 4054
a Fj(an)g(issue)h(#443)e(\(https://zeromq.jira.com/bro)n(wse/LIBZM)o
(Q-44)o(3\))14 b(and)396 4162 y(described)19 b(the)h(problem)f(and)g
(plausible)h(solution:)-2 4180 y
SDict begin H.S end
 -2 4180 a -2 4180 a
SDict begin 13 H.A end

-2 4180 a -2 4180 a
SDict begin [/View [/XYZ H.V]/Dest (0:4485) cvn /DEST pdfmark end
 -2 4180 a -2 4388 a
SDict begin H.S end
 -2 4388 a -2
4388 a
SDict begin 11.7 H.A end
 -2 4388 a -2 4388 a
SDict begin [/View [/XYZ H.V]/Dest (0:4486) cvn /DEST pdfmark end
 -2 4388 a 479 4467 a Fa(Problem:)f(XPUB)f
(sock)o(et)i(\002lters)e(out)h(duplicate)g(subscriptions)h
(\(deliberate)g(design\).)f(Ho)n(we)n(v)o(er)h(this)e(mak)o(es)i(it)479
4564 y(impossible)g(to)f(do)g(subscription-based)i(intelligence.)e(See)
479 4661 y(http://lists.zeromq.or)o(g/pipermail/zeromq-de)n
(v/2012-October/018838.html)24 b(for)19 b(a)g(use-case.)-2
4719 y
SDict begin H.S end
 -2 4719 a -2 4719 a
SDict begin 11.7 H.A end
 -2 4719 a -2 4719 a
SDict begin [/View [/XYZ H.V]/Dest (0:4487) cvn /DEST pdfmark end
 -2 4719
a 479 4800 a Fa(Solution:)g(mak)o(e)h(this)e(beha)o(viour)i
(con\002gurable)h(with)d(a)h(sock)o(et)h(option.)p Black
3759 5569 a Fi(325)p Black eop end
%%Page: 326 340
TeXDict begin 326 339 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.326) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4488) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(Naming)g(time.)g(The)f(API)i(sits)g(in)g
(include/zmq.h,)c(so)k(this)f(is)h(where)f(I)g(added)f(the)i(option)e
(name.)g(When)h(you)f(in)m(v)o(ent)396 180 y(a)i(concept,)e(in)h(an)g
(API)h(or)e(an)o(ywhere,)1545 180 y
SDict begin H.S end
 1545 180 a 1545 180
a
SDict begin 13 H.A end
 1545 180 a 1545 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:4489) cvn /DEST pdfmark end
 1545 180 a Fi(please)h Fj(tak)o(e)h(a)f(moment)
f(to)h(choose)g(a)g(name)g(that)g(is)h(e)o(xplicit)f(and)g(short)f(and)
396 288 y(ob)o(vious.)f(Don')o(t)h(f)o(all)i(back)f(on)f(generic)g
(names)h(which)g(need)f(additional)g(conte)o(xt)g(to)i(understand.)c(Y)
-9 b(ou)20 b(ha)n(v)o(e)f(one)396 396 y(chance)g(to)i(tell)g(the)f
(reader)f(what)h(your)f(concept)g(is,)i(and)f(does.)f(A)i(name)f(lik)o
(e)396 504 y
SDict begin H.S end
 396 504 a 396 504 a
SDict begin 13 H.A end
 396 504 a 396 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:4490) cvn /DEST pdfmark end

396 504 a Fg(ZMQ_SUBSCRIPTION_FORWARDING_FLAG)c Fj(is)21
b(terrible.)e(It)i(technically)e(kind)g(of)h(aims)g(in)h(the)f(right)g
(direction)396 612 y(b)n(ut)g(is)i(miserably)d(long)g(and)h(obscure.)e
(I)j(chose)1813 612 y
SDict begin H.S end
 1813 612 a 1813 612 a
SDict begin 13 H.A end
 1813 612
a 1813 612 a
SDict begin [/View [/XYZ H.V]/Dest (0:4491) cvn /DEST pdfmark end
 1813 612 a Fg(ZMQ_XPUB_VERBOSE)p Fj(:)d(short)i(and)f(e)o
(xplicit)h(and)f(clearly)h(an)g(on/of)n(f)396 720 y(switch)h(with)f
("of)n(f")f(being)h(the)g(def)o(ault)f(setting.)-2 904
y
SDict begin H.S end
 -2 904 a -2 904 a
SDict begin 13 H.A end
 -2 904 a -2 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:4492) cvn /DEST pdfmark end
 -2 904 a 396 994
a Fj(So,)h(time)h(to)f(add)g(a)g(pri)n(v)n(ate)g(property)e(to)i(the)g
(xpub)f(class)i(de\002nition)e(in)i(xpub)m(.hpp:)-2 1095
y
SDict begin H.S end
 -2 1095 a -2 1095 a
SDict begin 11.7 H.A end
 -2 1095 a -2 1095 a
SDict begin [/View [/XYZ H.V]/Dest (0:4493) cvn /DEST pdfmark end
 -2 1095 a 396
1174 a Fg(//)45 b(If)f(true,)g(send)g(all)h(subscription)e(messages)g
(upstream,)g(not)i(just)396 1271 y(//)g(unique)f(ones)396
1368 y(bool)g(verbose;)-2 1543 y
SDict begin H.S end
 -2 1543 a -2 1543 a
SDict begin 13 H.A end

-2 1543 a -2 1543 a
SDict begin [/View [/XYZ H.V]/Dest (0:4494) cvn /DEST pdfmark end
 -2 1543 a 396 1642 a Fj(And)20 b(then)g(lift)g
(some)g(code)g(from)f(router)-5 b(.cpp)18 b(to)i(implement)f(the)i
(xsetsock)o(opt)e(method.)f(Finally)-5 b(,)19 b(change)g(the)396
1750 y(xread_acti)n(v)n(ated)e(method)i(to)i(use)f(this)h(ne)n(w)f
(option,)e(and)i(while)g(at)h(it,)g(mak)o(e)e(that)i(test)g(on)f(sock)o
(et)g(type)f(more)396 1858 y(e)o(xplicit)h(too:)-2 1959
y
SDict begin H.S end
 -2 1959 a -2 1959 a
SDict begin 11.7 H.A end
 -2 1959 a -2 1959 a
SDict begin [/View [/XYZ H.V]/Dest (0:4495) cvn /DEST pdfmark end
 -2 1959 a 396
2038 a Fg(//)90 b(If)44 b(the)g(subscription)f(is)i(not)f(a)h
(duplicate)e(store)h(it)h(so)f(that)g(it)h(can)f(be)396
2136 y(//)90 b(passed)43 b(to)i(used)f(on)h(next)f(recv)g(call.)396
2233 y(if)h(\(options.type)d(==)j(ZMQ_XPUB)e(&&)i(\(unique)f(||)g
(verbose\)\))576 2330 y(pending.push_back)e(\(blob_t)h(\(data,)h
(size\)\);)-2 2507 y
SDict begin H.S end
 -2 2507 a -2 2507 a
SDict begin 13 H.A end
 -2 2507 a -2
2507 a
SDict begin [/View [/XYZ H.V]/Dest (0:4496) cvn /DEST pdfmark end
 -2 2507 a 396 2604 a Fj(The)20 b(thing)g(b)n(uilds)g(nicely)f
(\002rst)i(time.)f(Which)g(mak)o(es)g(me)h(a)f(little)h(suspicious,)f
(b)n(ut)g(being)f(lazy)h(and)g(jet-lagged)f(I)396 2712
y(don')o(t)g(immediately)g(mak)o(e)g(a)i(test)g(case)g(to)f(actually)g
(try)g(out)g(the)g(change.)e(The)i(process)g(doesn')o(t)f(demand)f
(that,)i(e)n(v)o(en)396 2820 y(if)h(usually)e(I')l(d)h(do)g(it)g(just)h
(to)g(catch)e(that)i(ine)n(vitable)e(10\045)h(of)g(mistak)o(es)g(we)h
(all)g(mak)o(e.)e(I)h(do)g(ho)n(we)n(v)o(er)e(document)h(this)396
2928 y(ne)n(w)h(option)f(on)h(the)1012 2928 y
SDict begin H.S end
 1012 2928
a 1012 2928 a
SDict begin 13 H.A end
 1012 2928 a 1012 2928 a
SDict begin [/View [/XYZ H.V]/Dest (0:4497) cvn /DEST pdfmark end
 1012 2928 a Fg
(doc/zmq_setsockopt.txt)d Fj(man)j(page.)f(In)h(the)g(w)o(orst)h(case)f
(I)h(added)e(a)h(patch)g(that)g(w)o(asn')o(t)396 3036
y(really)g(useful.)f(But)i(I)g(certainly)e(didn')o(t)f(break)i(an)o
(ything.)-2 3220 y
SDict begin H.S end
 -2 3220 a -2 3220 a
SDict begin 13 H.A end
 -2 3220 a -2 3220
a
SDict begin [/View [/XYZ H.V]/Dest (0:4498) cvn /DEST pdfmark end
 -2 3220 a 396 3310 a Fj(I)h(don')o(t)d(implement)h(a)i(matching)1402
3310 y
SDict begin H.S end
 1402 3310 a 1402 3310 a
SDict begin 13 H.A end
 1402 3310 a 1402 3310
a
SDict begin [/View [/XYZ H.V]/Dest (0:4499) cvn /DEST pdfmark end
 1402 3310 a Fg(zmq_getsockopt)p Fj(,)e(since)h("minimal")f(means)h
(what)g(it)h(says.)g(There')-5 b(s)19 b(no)396 3417 y(ob)o(vious)g(use)
h(case)h(for)e(getting)h(the)g(v)n(alue)f(of)h(an)g(option)f(that)i
(you)e(presumably)f(just)j(set,)g(in)f(code.)f(Symmetry)g(isn')o(t)396
3525 y(a)h(v)n(alid)g(reason)f(to)h(double)e(the)i(size)g(of)g(a)g
(patch.)f(I)h(did)f(ha)n(v)o(e)h(to)g(document)d(the)j(ne)n(w)g(option)
e(since)i(the)g(process)f(says,)396 3633 y("All)i(Public)f(Contracts)g
(SHOULD)g(be)g(documented.")-2 3800 y
SDict begin H.S end
 -2 3800 a -2 3800
a
SDict begin 13 H.A end
 -2 3800 a -2 3800 a
SDict begin [/View [/XYZ H.V]/Dest (0:4500) cvn /DEST pdfmark end
 -2 3800 a 396 3907 a Fj(Committing)f(the)i(code,)
e(I)h(push)g(the)g(patch)g(to)g(my)g(fork)o(ed)e(repository)h(\(the)h
('origin'\):)-2 4008 y
SDict begin H.S end
 -2 4008 a -2 4008 a
SDict begin 11.7 H.A end
 -2 4008 a
-2 4008 a
SDict begin [/View [/XYZ H.V]/Dest (0:4501) cvn /DEST pdfmark end
 -2 4008 a 396 4087 a Fg(git)45 b(commit)e(-a)i(-m)f("Fixed)g
(issue)g(#443")396 4185 y(git)h(push)f(origin)g(master)-2
4362 y
SDict begin H.S end
 -2 4362 a -2 4362 a
SDict begin 13 H.A end
 -2 4362 a -2 4362 a
SDict begin [/View [/XYZ H.V]/Dest (0:4502) cvn /DEST pdfmark end
 -2 4362
a 396 4459 a Fj(Switching)20 b(to)g(the)g(GitHub)g(web)g(interf)o(ace,)
f(I)i(go)e(to)i(my)f(libzmq)f(fork,)g(and)h(press)g(the)g(big)g("Pull)g
(Request")h(b)n(utton)396 4566 y(at)g(the)f(top.)g(GitHub)g(asks)g(me)h
(for)e(a)i(title,)f(so)h(I)f(enter)g("Added)f(ZMQ_XPUB_VERBOSE)h
(option".)f(I'm)g(not)h(sure)396 4674 y(why)g(it)g(asks)h(this)g(since)
f(I)h(made)e(a)i(neat)f(commit)f(message)h(b)n(ut)h(he)o(y)-5
b(,)18 b(let')-5 b(s)22 b(go)d(with)i(the)f(\003o)n(w)g(here.)-2
4858 y
SDict begin H.S end
 -2 4858 a -2 4858 a
SDict begin 13 H.A end
 -2 4858 a -2 4858 a
SDict begin [/View [/XYZ H.V]/Dest (0:4503) cvn /DEST pdfmark end
 -2 4858
a 396 4948 a Fj(This)h(mak)o(es)f(a)g(nice)g(little)h(pull)f(request)g
(with)g(tw)o(o)h(commits.)e(The)h(one)g(I')l(d)f(made)h(a)g(month)f
(ago)h(on)g(the)g(release)396 5056 y(notes,)g(to)g(prepare)f(for)h(the)
g(3.2.1)f(release)h(\(a)g(month)f(passes)i(so)f(quickly)f(when)h(you)f
(spend)h(most)g(of)g(it)h(in)f(airports\),)396 5164 y(and)f(my)h(\002x)
g(for)f(issue)h(#443)e(\(37)h(ne)n(w)h(lines)g(of)f(code\).)g(GitHub)g
(lets)h(you)f(continue)f(to)i(mak)o(e)f(commits)h(after)f(you')l(v)o(e)
p Black 3757 5569 a Fi(326)p Black eop end
%%Page: 327 341
TeXDict begin 327 340 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.327) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(kick)o(ed)g(of)n(f)f(a)i(pull)f(request.)f(The)o(y)g
(get)h(queued)f(up,)g(and)h(mer)o(ged)e(in)i(one)g(go.)g(That)g(is)h
(easy)f(b)n(ut)g(the)g(maintainer)f(may)396 180 y(refuse)h(the)g(whole)
g(b)n(undle)f(based)h(on)f(one)h(patch)g(that)g(doesn')o(t)f(look)g(v)n
(alid.)-2 364 y
SDict begin H.S end
 -2 364 a -2 364 a
SDict begin 13 H.A end
 -2 364 a -2 364 a
SDict begin [/View [/XYZ H.V]/Dest (0:4504) cvn /DEST pdfmark end
 -2
364 a 396 454 a Fj(Since)h(Dan)h(is)g(w)o(aiting)f(\(at)g(least)h(in)f
(my)g(highly)f(optimistic)h(imagination\))e(for)i(this)g(\002x,)h(I)f
(go)g(back)f(to)i(the)396 562 y(zeromq-de)n(v)c(list)k(and)e(tell)i
(him)e(I')l(v)o(e)g(made)g(the)h(patch,)f(with)h(a)g(link)g(to)g(the)g
(commit.)f(The)g(f)o(aster)h(I)g(get)g(feedback,)e(the)396
670 y(better)-5 b(.)20 b(It')-5 b(s)21 b(1am)f(in)g(South)g(K)m(orea)f
(as)i(I)g(mak)o(e)e(this)i(patch,)e(so)i(early)f(e)n(v)o(ening)e(in)i
(Europe,)f(and)g(morning)f(in)j(the)396 778 y(States.)g(Y)-9
b(ou)19 b(learn)h(to)g(count)f(timezones)g(when)g(you)g(w)o(ork)g(with)
i(people)d(across)i(the)g(w)o(orld.)f(Ian)h(is)h(in)f(a)g(conference,)
396 886 y(Mikk)o(o)f(is)i(getting)d(on)i(a)g(plane,)f(and)g(Chuck)g(is)
h(probably)e(in)h(the)h(of)n(\002ce,)f(b)n(ut)h(three)f(hours)f(later)m
(,)i(Ian)f(mer)o(ges)f(the)i(pull)396 994 y(request.)-2
1178 y
SDict begin H.S end
 -2 1178 a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:4505) cvn /DEST pdfmark end
 -2 1178
a 396 1268 a Fj(After)g(Ian)g(mer)o(ges)f(the)h(pull)g(request,)f(I)i
(re-synchronize)c(my)j(fork)f(with)h(the)g(upstream)f(libzmq)h
(repository)-5 b(.)18 b(First,)i(I)396 1376 y(add)g(a)h(')l(remote')d
(that)i(tells)h(git)g(where)e(this)i(repository)e(sits)i(\(I)f(do)g
(this)h(just)f(once)g(in)g(the)g(directory)f(where)g(I'm)396
1484 y(w)o(orking\):)-2 1585 y
SDict begin H.S end
 -2 1585 a -2 1585 a
SDict begin 11.7 H.A end
 -2
1585 a -2 1585 a
SDict begin [/View [/XYZ H.V]/Dest (0:4506) cvn /DEST pdfmark end
 -2 1585 a 396 1664 a Fg(git)45 b(remote)e(add)i
(upstream)e(git://github.com/zeromq/libzmq.git)-2 1842
y
SDict begin H.S end
 -2 1842 a -2 1842 a
SDict begin 13 H.A end
 -2 1842 a -2 1842 a
SDict begin [/View [/XYZ H.V]/Dest (0:4507) cvn /DEST pdfmark end
 -2 1842 a 396
1938 a Fj(And)20 b(then)g(I)g(pull)g(changes)f(back)h(from)f(the)h
(upstream)f(master)h(and)g(check)f(the)h(git)h(log)f(to)g
(double-check:)-2 2039 y
SDict begin H.S end
 -2 2039 a -2 2039 a
SDict begin 11.7 H.A end
 -2 2039
a -2 2039 a
SDict begin [/View [/XYZ H.V]/Dest (0:4508) cvn /DEST pdfmark end
 -2 2039 a 396 2118 a Fg(git)45 b(pull)f(--rebase)f
(upstream)h(master)396 2215 y(git)h(log)-2 2393 y
SDict begin H.S end
 -2
2393 a -2 2393 a
SDict begin 13 H.A end
 -2 2393 a -2 2393 a
SDict begin [/View [/XYZ H.V]/Dest (0:4509) cvn /DEST pdfmark end
 -2 2393 a 396 2489
a Fj(And)20 b(that)g(is)h(pretty)f(much)f(it,)i(in)f(terms)g(of)g(ho)n
(w)g(much)f(git)i(one)e(needs)h(to)g(learn)g(and)g(use)g(to)g(contrib)n
(ute)f(patches)h(to)396 2597 y(libzmq.)f(Six)i(git)f(commands)f(and)g
(some)h(clicking)g(on)g(web)g(pages.)f(Most)i(importantly)d(to)i(me)g
(as)h(a)g(naturally)e(lazy)-5 b(,)396 2705 y(stupid,)20
b(and)f(easily)i(confused)d(de)n(v)o(eloper)m(,)g(I)i(don')o(t)e(ha)n
(v)o(e)i(to)g(learn)g(git')-5 b(s)21 b(internal)e(models,)h(and)f(ne)n
(v)o(er)g(ha)n(v)o(e)h(to)g(do)396 2813 y(an)o(ything)e(in)m(v)n
(olving)g(those)i(infernal)f(engines)h(of)g(structural)f(comple)o(xity)
f(we)j(call)f("git)h(branches".)d(Ne)o(xt)i(up,)f(the)396
2921 y(attempted)g(assassination)i(of)f(git)g(branches.)f(Let')-5
b(s)20 b(li)n(v)o(e)g(dangerously!)-2 2949 y
SDict begin H.S end
 -2 2949
a -2 2949 a
SDict begin 13 H.A end
 -2 2949 a -2 2949 a
SDict begin [/View [/XYZ H.V]/Dest (0:4510) cvn /DEST pdfmark end
 -2 2949 a 359 x Fh(7.5.)39
b(Git)g(Branc)o(hes)e(Considered)g(Harmful)2581 3308
y
SDict begin H.S end
 2581 3308 a 2581 3308 a
SDict begin 22.464 H.A end
 2581 3308 a 2581 3308 a
SDict begin [/View [/XYZ H.V]/Dest (12.78.1) cvn /DEST pdfmark end
 2581
3308 a -2 3476 a
SDict begin H.S end
 -2 3476 a -2 3476 a
SDict begin 13 H.A end
 -2 3476 a -2 3476
a
SDict begin [/View [/XYZ H.V]/Dest (0:4512) cvn /DEST pdfmark end
 -2 3476 a 396 3582 a Fj(One)20 b(of)g(git')-5 b(s)21
b(most)f(popular)f(features)g(is)i(ho)n(w)f(easy)g(it)h(mak)o(es)f
(branches.)f(Almost)h(all)h(projects)e(that)i(use)f(git)h(use)396
3690 y(branches,)e(and)g(the)i(selection)f(of)f(the)i("best")f
(branching)e(strate)o(gy)h(is)i(lik)o(e)g(a)f(rite)h(of)f(passage)g
(for)f(an)h(open)f(source)396 3798 y(project.)g(V)-5
b(incent)20 b(Driessen')-5 b(s)1314 3798 y
SDict begin H.S end
 1314 3798
a 1314 3798 a
SDict begin 13 H.A end
 1314 3798 a 1314 3798 a
SDict begin [/View [/XYZ H.V]/Dest (0:4513) cvn /DEST pdfmark end
 1314 3798 a Fj(git-\003o)n(w)19
b(\(http://n)m(vie.com/posts/a-successful-git-br)o(anch)o(ing)o(-m)o
(od)o(el/\))c(is)21 b(maybe)396 3906 y(the)f(best)h(kno)n(wn.)d(It)j
(has)f('base')g(branches)f(\(master)m(,)g(de)n(v)o(elop\),)f('feature')
g(branches,)h(')l(release')g(branches,)g('hot\002x')396
4014 y(branches,)g(and)g(')-5 b(support')19 b(branches.)g(Man)o(y)g
(teams)h(ha)n(v)o(e)g(adopted)e(git-\003o)n(w)-5 b(,)19
b(which)h(e)n(v)o(en)f(has)i(git)f(e)o(xtensions)f(to)396
4122 y(support)g(it.)i(I'm)e(a)i(great)f(belie)n(v)o(er)f(in)h(popular)
e(wisdom,)i(b)n(ut)g(sometimes)g(you)f(ha)n(v)o(e)h(to)g(recognize)f
(mass)h(delusion)396 4230 y(for)g(what)g(it)h(is.)-2
4397 y
SDict begin H.S end
 -2 4397 a -2 4397 a
SDict begin 13 H.A end
 -2 4397 a -2 4397 a
SDict begin [/View [/XYZ H.V]/Dest (0:4514) cvn /DEST pdfmark end
 -2 4397
a 396 4504 a Fj(Here)f(is)h(a)g(section)f(of)g(C4)h(that)f(might)f(ha)n
(v)o(e)h(shock)o(ed)f(you)g(when)h(you)f(\002rst)i(read)f(it:)-2
4522 y
SDict begin H.S end
 -2 4522 a -2 4522 a
SDict begin 13 H.A end
 -2 4522 a -2 4522 a
SDict begin [/View [/XYZ H.V]/Dest (0:4515) cvn /DEST pdfmark end
 -2 4522
a -2 4605 a
SDict begin H.S end
 -2 4605 a -2 4605 a
SDict begin 11.7 H.A end
 -2 4605 a -2 4605 a
SDict begin [/View [/XYZ H.V]/Dest (0:4516) cvn /DEST pdfmark end
 -2
4605 a 479 4684 a Fa(The)f(project)g(SHALL)f(NO)m(T)g(use)h(topic)g
(branches)i(for)d(an)o(y)i(reason.)f(Personal)g(forks)g(MA)-8
b(Y)20 b(use)f(topic)g(branches.)-2 4866 y
SDict begin H.S end
 -2 4866 a
-2 4866 a
SDict begin 13 H.A end
 -2 4866 a -2 4866 a
SDict begin [/View [/XYZ H.V]/Dest (0:4517) cvn /DEST pdfmark end
 -2 4866 a 396 4958 a Fj(T)-7
b(o)21 b(be)f(clear)m(,)f(it')-5 b(s)924 4958 y
SDict begin H.S end
 924 4958
a 924 4958 a
SDict begin 13 H.A end
 924 4958 a 924 4958 a
SDict begin [/View [/XYZ H.V]/Dest (0:4518) cvn /DEST pdfmark end
 924 4958 a Fi(public)19
b(br)o(anc)o(hes)f(in)j(shar)m(ed)e(r)m(epositories)i
Fj(that)f(I'm)g(talking)f(about.)g(Using)h(branches)f(for)h(pri)n(v)n
(ate)396 5066 y(w)o(ork,)g(e.g.)f(to)i(w)o(ork)e(on)h(dif)n(ferent)e
(issues,)j(appears)f(to)g(w)o(ork)f(well)i(enough,)d(though)g(it')-5
b(s)22 b(more)d(comple)o(xity)f(than)i(I)p Black 3756
5569 a Fi(327)p Black eop end
%%Page: 328 342
TeXDict begin 328 341 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.328) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(personally)f(enjo)o(y)-5 b(.)19 b(T)-7
b(o)20 b(channel)f(Stallman)h(again:)1907 72 y
SDict begin H.S end
 1907 72
a 1907 72 a
SDict begin 13 H.A end
 1907 72 a 1907 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:4519) cvn /DEST pdfmark end
 1907 72 a Fi(your)g(fr)m(eedom)g(to)g
(cr)m(eate)g(comple)n(xity)g(ends)g(one)g(inc)o(h)f(fr)l(om)i(our)396
180 y(shar)m(ed)f(workspace)o(.)-2 363 y
SDict begin H.S end
 -2 363 a -2
363 a
SDict begin 13 H.A end
 -2 363 a -2 363 a
SDict begin [/View [/XYZ H.V]/Dest (0:4520) cvn /DEST pdfmark end
 -2 363 a 396 454 a Fj(Lik)o(e)g(the)h(rest)f
(of)g(C4,)h(the)f(rules)g(on)g(branches)e(are)j(not)e(accidental.)h
(The)o(y)f(came)h(from)f(our)g(e)o(xperience)f(making)396
562 y(\330MQ,)i(starting)g(when)g(Martin)g(Sustrik)g(and)f(I)i
(rethought)d(ho)n(w)h(to)i(mak)o(e)e(stable)i(releases.)f(W)-7
b(e)21 b(both)f(lo)o(v)o(e)f(and)396 670 y(appreciate)g(simplicity)h
(\(some)g(people)f(seem)h(to)h(ha)n(v)o(e)e(a)i(remarkable)d(tolerance)
h(for)h(comple)o(xity\).)d(W)-7 b(e)21 b(chatted)f(for)396
778 y(a)h(while...)e(I)i(ask)o(ed)f(him,)f("I'm)h(going)f(to)h(start)h
(making)e(a)h(stable)h(release,)f(w)o(ould)f(it)i(be)f(OK)h(for)e(me)i
(to)f(mak)o(e)g(a)396 886 y(branch)f(in)g(the)h(git)g(you')l(re)e(w)o
(orking)g(in?")i(Martin)f(didn')o(t)g(lik)o(e)h(the)f(idea.)h("OK,)g
(if)g(I)g(fork)e(the)i(repository)-5 b(,)18 b(I)i(can)f(mo)o(v)o(e)396
994 y(patches)h(from)f(your)g(repo)g(to)i(that)f(one".)f(That)h(felt)h
(much)e(better)h(to)g(both)f(of)h(us.)-2 1178 y
SDict begin H.S end
 -2 1178
a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:4521) cvn /DEST pdfmark end
 -2 1178 a 396 1268 a
Fj(The)g(response)f(from)h(man)o(y)e(in)j(the)f(\330MQ)g(community)e(w)
o(as)k(shock)d(and)h(horror)-5 b(.)18 b(People)i(felt)g(we)h(were)f
(being)f(lazy)396 1376 y(and)h(making)f(contrib)n(utors)f(w)o(ork)i
(harder)e(to)j(\002nd)f(the)g("right")f(repository)-5
b(.)18 b(Still,)j(this)g(seemed)e(simple,)h(and)g(indeed)396
1484 y(it)h(w)o(ork)o(ed)e(smoothly)-5 b(.)18 b(The)i(best)h(part)f(w)o
(as)h(that)f(we)h(each)e(w)o(ork)o(ed)g(as)i(we)g(w)o(anted)f(to.)g
(Whereas)g(before,)e(the)j(\330MQ)396 1592 y(repository)e(had)g(felt)i
(horribly)d(comple)o(x)g(\(and)i(it)h(w)o(asn')o(t)e(e)n(v)o(en)h(an)o
(ything)e(lik)o(e)i(git-\003o)n(w\),)f(this)i(felt)f(simple.)g(And)g
(it)396 1700 y(w)o(ork)o(ed.)f(The)h(only)f(do)n(wnside)g(w)o(as)i
(that)g(we)f(lost)h(a)f(single)h(uni\002ed)e(history)-5
b(.)19 b(No)n(w)-5 b(,)19 b(perhaps)g(historians)h(will)h(feel)396
1808 y(robbed,)d(b)n(ut)j(I)f(honestly)f(can')o(t)g(see)i(that)f(the)h
(historical)e(minutiae)h(of)g(who)f(changed)g(what,)h(when,)f
(including)f(e)n(v)o(ery)396 1916 y(branch)h(and)h(e)o(xperiment,)d
(are)j(w)o(orth)g(an)o(y)f(signi\002cant)h(pain)g(or)g(friction.)-2
2100 y
SDict begin H.S end
 -2 2100 a -2 2100 a
SDict begin 13 H.A end
 -2 2100 a -2 2100 a
SDict begin [/View [/XYZ H.V]/Dest (0:4522) cvn /DEST pdfmark end
 -2 2100
a 396 2190 a Fj(People)g(ha)n(v)o(e)g(gotten)f(used)h(to)g(the)g
("multiple)g(repositories")f(approach)f(in)i(ZeroMQ)f(and)h(we')l(v)o
(e)f(started)h(using)g(that)396 2297 y(in)h(other)e(projects)h(quite)f
(successfully)-5 b(.)19 b(My)h(o)n(wn)g(opinion)e(is)k(that)e(history)f
(will)i(judge)e(git)i(branches)e(and)g(patterns)396 2405
y(lik)o(e)i(git-\003o)n(w)e(as)i(a)g(comple)o(x)d(solution)i(to)g
(imaginary)e(problems)h(inherited)g(from)g(the)h(days)g(of)g(Sub)o(v)o
(ersion)e(and)396 2513 y(monolithic)h(repositories.)-2
2697 y
SDict begin H.S end
 -2 2697 a -2 2697 a
SDict begin 13 H.A end
 -2 2697 a -2 2697 a
SDict begin [/View [/XYZ H.V]/Dest (0:4523) cvn /DEST pdfmark end
 -2 2697
a 396 2787 a Fj(More)h(profoundly)-5 b(,)16 b(and)k(perhaps)e(this)j
(is)g(why)f(the)g(majority)f(seems)i(to)f(be)g("wrong":)f(I)h(think)g
(the)g(the)g(branches)f(vs.)396 2895 y(forks)h(ar)o(gument)d(is)22
b(really)d(a)i(deeper)e(design)h(vs.)g(e)n(v)n(olv)o(e)f(ar)o(gument)f
(about)h(ho)n(w)h(to)g(mak)o(e)g(softw)o(are)g(optimally)-5
b(.)18 b(I')o(ll)396 3003 y(address)i(that)g(deeper)f(ar)o(gument)f(in)
i(the)h(ne)o(xt)e(section.)h(F)o(or)g(no)n(w)-5 b(,)19
b(I')o(ll)h(try)g(to)g(be)h(scienti\002c)f(about)f(my)h(irrational)f
(hate)396 3111 y(of)h(branches,)f(by)h(looking)e(at)j(a)f(number)f(of)h
(criteria,)f(and)h(compare)e(branches)h(and)h(forks)f(in)i(each)e(one.)
-2 3129 y
SDict begin H.S end
 -2 3129 a -2 3129 a
SDict begin 13 H.A end
 -2 3129 a -2 3129 a
SDict begin [/View [/XYZ H.V]/Dest (0:4524) cvn /DEST pdfmark end
 -2
3129 a 396 3439 a Fd(7.5.1.)36 b(Simplicity)f(vs.)f(Comple)n(xity)2166
3439 y
SDict begin H.S end
 2166 3439 a 2166 3439 a
SDict begin 18.72 H.A end
 2166 3439 a 2166 3439
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.85.2) cvn /DEST pdfmark end
 2166 3439 a -2 3630 a
SDict begin H.S end
 -2 3630 a -2 3630 a
SDict begin 13 H.A end
 -2 3630 a
-2 3630 a
SDict begin [/View [/XYZ H.V]/Dest (0:4526) cvn /DEST pdfmark end
 -2 3630 a -2 3630 a
SDict begin H.S end
 -2 3630 a -2 3630 a
SDict begin 13 H.A end
 -2
3630 a -2 3630 a
SDict begin [/View [/XYZ H.V]/Dest (0:4527) cvn /DEST pdfmark end
 -2 3630 a 396 3713 a Fi(The)21 b(simpler)-9
b(,)20 b(the)g(better)-9 b(.)-2 3896 y
SDict begin H.S end
 -2 3896 a -2 3896
a
SDict begin 13 H.A end
 -2 3896 a -2 3896 a
SDict begin [/View [/XYZ H.V]/Dest (0:4528) cvn /DEST pdfmark end
 -2 3896 a 396 3987 a Fj(There)20
b(is)h(no)f(inherent)e(reason)i(branches)f(are)h(more)f(comple)o(x)g
(than)g(forks.)g(Ho)n(we)n(v)o(er)m(,)f(git-\003o)n(w)i(uses)3414
3987 y
SDict begin H.S end
 3414 3987 a 3414 3987 a
SDict begin 13 H.A end
 3414 3987 a 3414 3987
a
SDict begin [/View [/XYZ H.V]/Dest (0:4529) cvn /DEST pdfmark end
 3414 3987 a Fi(\002ve)g(types)g Fj(of)396 4095 y(branch,)f(whereas)g
(C4)i(uses)g(tw)o(o)f(types)g(of)g(fork)f(\(de)n(v)o(elopment,)e(and)j
(stable\))g(and)f(one)h(branch)f(\(master\).)396 4203
y(Circumstantial)h(e)n(vidence)f(is)i(thus)f(that)g(branches)f(lead)h
(to)g(more)g(comple)o(xity)e(than)i(forks.)f(F)o(or)h(ne)n(w)g(users,)g
(it)h(is)396 4311 y(de\002nitely)-5 b(,)19 b(and)h(we')l(v)o(e)f
(measured)g(this)h(in)h(practice,)e(easier)h(to)h(learn)f(to)g(w)o(ork)
f(with)i(man)o(y)e(repositories)g(and)h(no)396 4419 y(branches)f(e)o
(xcept)g(master)-5 b(.)-2 4447 y
SDict begin H.S end
 -2 4447 a -2 4447 a
SDict begin 13 H.A end

-2 4447 a -2 4447 a
SDict begin [/View [/XYZ H.V]/Dest (0:4530) cvn /DEST pdfmark end
 -2 4447 a 396 4757 a Fd(7.5.2.)36
b(Chang)q(e)e(Latenc)o(y)1650 4757 y
SDict begin H.S end
 1650 4757 a 1650
4757 a
SDict begin 18.72 H.A end
 1650 4757 a 1650 4757 a
SDict begin [/View [/XYZ H.V]/Dest (12.78.86.2) cvn /DEST pdfmark end
 1650 4757 a -2 4950 a
SDict begin H.S end

-2 4950 a -2 4950 a
SDict begin 13 H.A end
 -2 4950 a -2 4950 a
SDict begin [/View [/XYZ H.V]/Dest (0:4532) cvn /DEST pdfmark end
 -2 4950 a -2
4950 a
SDict begin H.S end
 -2 4950 a -2 4950 a
SDict begin 13 H.A end
 -2 4950 a -2 4950 a
SDict begin [/View [/XYZ H.V]/Dest (0:4533) cvn /DEST pdfmark end
 -2 4950
a 396 5031 a Fi(The)21 b(smaller)f(and)g(mor)m(e)g(r)o(apid)f(the)i
(delivery)-5 b(,)20 b(the)g(better)-9 b(.)p Black 3759
5569 a(328)p Black eop end
%%Page: 329 343
TeXDict begin 329 342 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.329) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4534) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(De)n(v)o(elopment)e(branches)h(seem)h(to)h(correlate)
e(strongly)g(with)h(lar)o(ge,)f(slo)n(w)-5 b(,)20 b(risk)o(y)f(deli)n
(v)o(eries.)g("Sorry)-5 b(,)19 b(I)h(ha)n(v)o(e)g(to)396
180 y(mer)o(ge)f(this)i(branch)d(before)h(we)i(can)f(test)h(the)f(ne)n
(w)g(v)o(ersion")f(signals)h(a)h(breakdo)n(wn)c(in)k(process.)e(It')-5
b(s)21 b(certainly)e(not)396 288 y(ho)n(w)h(C4)h(w)o(orks,)e(which)h
(is)h(by)f(focusing)e(tightly)i(on)g(indi)n(vidual)e(problems)h(and)h
(their)g(minimal)f(solutions.)396 396 y(Allo)n(wing)h(branches)e(in)j
(de)n(v)o(elopment)c(raises)k(change)e(latenc)o(y)-5
b(.)18 b(F)o(orks)i(ha)n(v)o(e)g(a)g(dif)n(ferent)f(outcome:)g(it')-5
b(s)21 b(up)f(to)g(the)396 504 y(fork)o(er)f(to)h(ensure)g(his)g
(changes)g(mer)o(ge)e(cleanly)-5 b(,)19 b(and)h(to)g(k)o(eep)g(them)g
(simple)g(so)g(the)o(y)g(w)o(on')o(t)f(be)h(rejected.)-2
533 y
SDict begin H.S end
 -2 533 a -2 533 a
SDict begin 13 H.A end
 -2 533 a -2 533 a
SDict begin [/View [/XYZ H.V]/Dest (0:4535) cvn /DEST pdfmark end
 -2 533 a 396
843 a Fd(7.5.3.)36 b(Learning)e(Cur)q(ve)1606 843 y
SDict begin H.S end
 1606
843 a 1606 843 a
SDict begin 18.72 H.A end
 1606 843 a 1606 843 a
SDict begin [/View [/XYZ H.V]/Dest (12.78.87.2) cvn /DEST pdfmark end
 1606 843 a -2
1035 a
SDict begin H.S end
 -2 1035 a -2 1035 a
SDict begin 13 H.A end
 -2 1035 a -2 1035 a
SDict begin [/View [/XYZ H.V]/Dest (0:4537) cvn /DEST pdfmark end
 -2 1035
a -2 1035 a
SDict begin H.S end
 -2 1035 a -2 1035 a
SDict begin 13 H.A end
 -2 1035 a -2 1035 a
SDict begin [/View [/XYZ H.V]/Dest (0:4538) cvn /DEST pdfmark end
 -2
1035 a 396 1117 a Fi(The)21 b(smoother)e(the)i(learning)e(curve)o(,)h
(the)g(better)-9 b(.)-2 1300 y
SDict begin H.S end
 -2 1300 a -2 1300 a
SDict begin 13 H.A end
 -2
1300 a -2 1300 a
SDict begin [/View [/XYZ H.V]/Dest (0:4539) cvn /DEST pdfmark end
 -2 1300 a 396 1391 a Fj(Evidence)19
b(de\002nitely)g(sho)n(ws)i(that)f(learning)f(to)h(use)g(git)h
(branches)e(is)i(comple)o(x.)d(F)o(or)i(some)g(people)f(this)i(is)g
(OK.)f(F)o(or)396 1499 y(most)g(de)n(v)o(elopers,)e(e)n(v)o(ery)h(c)o
(ycle)h(spent)g(learning)f(git)h(is)h(a)g(c)o(ycle)f(lost)g(on)g(more)f
(producti)n(v)o(e)f(things.)h(I')l(v)o(e)g(been)h(told)396
1606 y(se)n(v)o(eral)g(times,)g(by)g(dif)n(ferent)f(people,)f(that)j(I)
f(do)g(not)g(lik)o(e)g(branches)f(because)g(I)i("ne)n(v)o(er)e
(properly)f(learned)h(git".)h(That)396 1714 y(is)h(f)o(air)g(b)n(ut)f
(it)h(is)g(a)f(criticism)h(of)f(the)g(tool,)g(not)f(the)i(human.)-2
1737 y
SDict begin H.S end
 -2 1737 a -2 1737 a
SDict begin 13 H.A end
 -2 1737 a -2 1737 a
SDict begin [/View [/XYZ H.V]/Dest (0:4540) cvn /DEST pdfmark end
 -2 1737
a 396 2053 a Fd(7.5.4.)36 b(Cost)d(of)h(F)n(ailure)1563
2053 y
SDict begin H.S end
 1563 2053 a 1563 2053 a
SDict begin 18.72 H.A end
 1563 2053 a 1563 2053
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.88.2) cvn /DEST pdfmark end
 1563 2053 a -2 2220 a
SDict begin H.S end
 -2 2220 a -2 2220 a
SDict begin 13 H.A end
 -2 2220 a
-2 2220 a
SDict begin [/View [/XYZ H.V]/Dest (0:4542) cvn /DEST pdfmark end
 -2 2220 a -2 2220 a
SDict begin H.S end
 -2 2220 a -2 2220 a
SDict begin 13 H.A end
 -2
2220 a -2 2220 a
SDict begin [/View [/XYZ H.V]/Dest (0:4543) cvn /DEST pdfmark end
 -2 2220 a 396 2327 a Fi(The)21 b(lower)f(the)h(cost)f
(of)g(failur)m(e)o(,)h(the)f(better)-9 b(.)-2 2510 y
SDict begin H.S end

-2 2510 a -2 2510 a
SDict begin 13 H.A end
 -2 2510 a -2 2510 a
SDict begin [/View [/XYZ H.V]/Dest (0:4544) cvn /DEST pdfmark end
 -2 2510 a 396
2601 a Fj(Branches)20 b(demand)f(more)g(perfection)f(from)h(de)n(v)o
(elopers)f(since)j(mistak)o(es)f(potentially)f(af)n(fect)h(others.)f
(This)i(raises)396 2709 y(the)f(cost)h(of)f(f)o(ailure.)f(F)o(orks)h
(mak)o(e)g(f)o(ailure)f(e)o(xtremely)g(cheap)g(since)h(literally)h
(nothing)d(that)i(happens)f(in)h(a)h(fork)e(can)396 2817
y(af)n(fect)h(others)g(not)f(using)h(that)g(fork.)-2
2845 y
SDict begin H.S end
 -2 2845 a -2 2845 a
SDict begin 13 H.A end
 -2 2845 a -2 2845 a
SDict begin [/View [/XYZ H.V]/Dest (0:4545) cvn /DEST pdfmark end
 -2 2845
a 396 3155 a Fd(7.5.5.)36 b(Upfr)n(ont)c(Coor)n(dination)1932
3155 y
SDict begin H.S end
 1932 3155 a 1932 3155 a
SDict begin 18.72 H.A end
 1932 3155 a 1932 3155
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.89.2) cvn /DEST pdfmark end
 1932 3155 a -2 3346 a
SDict begin H.S end
 -2 3346 a -2 3346 a
SDict begin 13 H.A end
 -2 3346 a
-2 3346 a
SDict begin [/View [/XYZ H.V]/Dest (0:4547) cvn /DEST pdfmark end
 -2 3346 a -2 3346 a
SDict begin H.S end
 -2 3346 a -2 3346 a
SDict begin 13 H.A end
 -2
3346 a -2 3346 a
SDict begin [/View [/XYZ H.V]/Dest (0:4548) cvn /DEST pdfmark end
 -2 3346 a 396 3429 a Fi(The)21 b(less)g(need)e(for)i
(upfr)l(ont)e(coor)m(dination,)f(the)i(better)-9 b(.)-2
3612 y
SDict begin H.S end
 -2 3612 a -2 3612 a
SDict begin 13 H.A end
 -2 3612 a -2 3612 a
SDict begin [/View [/XYZ H.V]/Dest (0:4549) cvn /DEST pdfmark end
 -2 3612
a 396 3703 a Fj(Y)g(ou)20 b(can)g(do)g(a)g(hostile)g(fork.)f(Y)-9
b(ou)20 b(cannot)f(do)h(a)g(hostile)g(branch.)f(Branches)h(depend)e(on)
i(upfront)e(coordination,)396 3811 y(which)i(is)h(e)o(xpensi)n(v)o(e)d
(and)i(fragile.)f(One)h(person)f(can)h(v)o(eto)g(the)g(desires)g(of)g
(a)h(whole)e(group.)g(In)h(the)g(\330MQ)396 3919 y(community)e(for)i(e)
o(xample)f(we)h(were)g(unable)f(to)i(agree)e(on)h(a)h(git)f(branching)e
(model)h(for)h(a)g(year)-5 b(.)20 b(W)-7 b(e)21 b(solv)o(ed)f(that)g
(by)396 4027 y(using)g(forking)e(instead.)i(The)g(problem)e(went)i(a)o
(w)o(ay)-5 b(.)-2 4055 y
SDict begin H.S end
 -2 4055 a -2 4055 a
SDict begin 13 H.A end
 -2 4055
a -2 4055 a
SDict begin [/View [/XYZ H.V]/Dest (0:4550) cvn /DEST pdfmark end
 -2 4055 a 396 4365 a Fd(7.5.6.)36 b(Scalability)1318
4365 y
SDict begin H.S end
 1318 4365 a 1318 4365 a
SDict begin 18.72 H.A end
 1318 4365 a 1318 4365
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.90.2) cvn /DEST pdfmark end
 1318 4365 a -2 4556 a
SDict begin H.S end
 -2 4556 a -2 4556 a
SDict begin 13 H.A end
 -2 4556 a
-2 4556 a
SDict begin [/View [/XYZ H.V]/Dest (0:4552) cvn /DEST pdfmark end
 -2 4556 a -2 4556 a
SDict begin H.S end
 -2 4556 a -2 4556 a
SDict begin 13 H.A end
 -2
4556 a -2 4556 a
SDict begin [/View [/XYZ H.V]/Dest (0:4553) cvn /DEST pdfmark end
 -2 4556 a 396 4639 a Fi(The)21 b(mor)m(e)f(you)f(can)h
(scale)g(a)h(pr)l(oject,)f(the)g(better)-9 b(.)-2 4822
y
SDict begin H.S end
 -2 4822 a -2 4822 a
SDict begin 13 H.A end
 -2 4822 a -2 4822 a
SDict begin [/View [/XYZ H.V]/Dest (0:4554) cvn /DEST pdfmark end
 -2 4822 a 396
4913 a Fj(The)20 b(strong)f(assumption)g(in)i(all)g(branch)d(strate)o
(gies)i(is)h(that)g(the)f(repository)2643 4913 y
SDict begin H.S end
 2643
4913 a 2643 4913 a
SDict begin 13 H.A end
 2643 4913 a 2643 4913 a
SDict begin [/View [/XYZ H.V]/Dest (0:4555) cvn /DEST pdfmark end
 2643 4913
a Fi(is)h Fj(the)g(project.)e(But)h(there)g(is)h(a)g(limit)g(to)396
5021 y(ho)n(w)e(man)o(y)f(people)h(you)f(can)i(get)f(in)h(agreement)d
(to)j(w)o(ork)f(together)f(in)i(one)f(repository)-5 b(.)17
b(As)j(I)f(e)o(xplained,)f(the)h(cost)h(of)396 5129 y(upfront)e
(coordination)g(can)i(become)f(f)o(atal.)h(A)h(more)e(realistic)i
(project)e(scales)i(by)f(allo)n(wing)f(an)o(yone)f(to)j(start)f(their)p
Black 3759 5569 a Fi(329)p Black eop end
%%Page: 330 344
TeXDict begin 330 343 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.330) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(o)n(wn)g(repositories,)f(and)g(ensuring)g(these)h
(can)g(w)o(ork)g(together)-5 b(.)19 b(A)i(project)e(lik)o(e)h(\330MQ)h
(has)f(dozens)g(of)g(repositories.)396 180 y(F)o(orking)f(looks)g(more)
h(scalable)g(than)g(branching.)-2 209 y
SDict begin H.S end
 -2 209 a -2 209
a
SDict begin 13 H.A end
 -2 209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:4556) cvn /DEST pdfmark end
 -2 209 a 396 519 a Fd(7.5.7.)36 b(Surprise)d(and)h
(Expectations)2235 519 y
SDict begin H.S end
 2235 519 a 2235 519 a
SDict begin 18.72 H.A end
 2235 519
a 2235 519 a
SDict begin [/View [/XYZ H.V]/Dest (12.78.91.2) cvn /DEST pdfmark end
 2235 519 a -2 710 a
SDict begin H.S end
 -2 710 a -2 710 a
SDict begin 13 H.A end
 -2
710 a -2 710 a
SDict begin [/View [/XYZ H.V]/Dest (0:4558) cvn /DEST pdfmark end
 -2 710 a -2 710 a
SDict begin H.S end
 -2 710 a -2 710 a
SDict begin 13 H.A end
 -2
710 a -2 710 a
SDict begin [/View [/XYZ H.V]/Dest (0:4559) cvn /DEST pdfmark end
 -2 710 a 396 793 a Fi(The)21 b(less)g(surprising)o(,)f
(the)g(better)-9 b(.)-2 976 y
SDict begin H.S end
 -2 976 a -2 976 a
SDict begin 13 H.A end
 -2 976
a -2 976 a
SDict begin [/View [/XYZ H.V]/Dest (0:4560) cvn /DEST pdfmark end
 -2 976 a 396 1067 a Fj(People)20 b(e)o(xpect)f(branches)g
(and)h(\002nd)g(forks)f(to)h(be)g(uncommon)e(and)h(thus)i(confusing.)d
(This)i(is)h(the)f(one)g(aspect)g(where)396 1175 y(branches)f(win.)h
(If)g(you)f(use)i(branches,)d(a)j(single)f(patch)g(will)h(ha)n(v)o(e)e
(the)h(same)h(commit)e(hash)h(tag,)g(whereas)g(across)396
1283 y(forks)g(the)g(patch)f(will)i(ha)n(v)o(e)f(dif)n(ferent)e(hash)i
(tags.)h(That)f(mak)o(es)g(it)h(harder)d(to)j(track)e(patches)h(as)h
(the)o(y)f(cross)g(forks,)396 1391 y(true.)g(But)h(seriously)-5
b(,)1043 1391 y
SDict begin H.S end
 1043 1391 a 1043 1391 a
SDict begin 13 H.A end
 1043 1391 a 1043
1391 a
SDict begin [/View [/XYZ H.V]/Dest (0:4561) cvn /DEST pdfmark end
 1043 1391 a Fi(having)19 b(to)i(tr)o(ac)n(k)f(he)n(xadecimal)f
(hash)g(ta)o(gs)i(is)g(not)f(a)g(featur)m(e)p Fj(.)g(It')-5
b(s)20 b(a)h(b)n(ug.)e(Sometimes)h(better)396 1499 y(w)o(ays)h(of)f(w)o
(orking)e(just)j(are)f(surprising)f(at)i(\002rst.)-2
1527 y
SDict begin H.S end
 -2 1527 a -2 1527 a
SDict begin 13 H.A end
 -2 1527 a -2 1527 a
SDict begin [/View [/XYZ H.V]/Dest (0:4562) cvn /DEST pdfmark end
 -2 1527
a 396 1837 a Fd(7.5.8.)36 b(Economics)f(of)e(P)l(ar)r(ticipation)2267
1837 y
SDict begin H.S end
 2267 1837 a 2267 1837 a
SDict begin 18.72 H.A end
 2267 1837 a 2267 1837
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.92.2) cvn /DEST pdfmark end
 2267 1837 a -2 2028 a
SDict begin H.S end
 -2 2028 a -2 2028 a
SDict begin 13 H.A end
 -2 2028 a
-2 2028 a
SDict begin [/View [/XYZ H.V]/Dest (0:4564) cvn /DEST pdfmark end
 -2 2028 a -2 2028 a
SDict begin H.S end
 -2 2028 a -2 2028 a
SDict begin 13 H.A end
 -2
2028 a -2 2028 a
SDict begin [/View [/XYZ H.V]/Dest (0:4565) cvn /DEST pdfmark end
 -2 2028 a 396 2111 a Fi(The)21 b(mor)m(e)f(tangible)f
(the)h(r)m(e)o(war)m(ds,)g(the)g(better)-9 b(.)-2 2294
y
SDict begin H.S end
 -2 2294 a -2 2294 a
SDict begin 13 H.A end
 -2 2294 a -2 2294 a
SDict begin [/View [/XYZ H.V]/Dest (0:4566) cvn /DEST pdfmark end
 -2 2294 a 396
2385 a Fj(People)20 b(lik)o(e)g(to)h(o)n(wn)e(their)h(w)o(ork,)g(and)f
(get)i(credit)e(for)h(it.)h(This)f(is)h(much)e(easier)i(with)f(forks)f
(than)h(with)g(branches.)396 2493 y(F)o(orks)g(create)g(more)f
(competition,)f(in)j(a)f(healthy)f(w)o(ay)-5 b(,)20 b(while)g(branches)
f(suppress)g(competition)g(and)g(force)h(people)396 2601
y(to)h(collaborate)d(and)i(share)g(credit.)f(This)i(sounds)e(positi)n
(v)o(e)g(b)n(ut)i(in)f(my)g(e)o(xperience)e(it)j(de-moti)n(v)n(ates)d
(people.)h(A)396 2709 y(branch)g(isn')o(t)h(a)g(product)f(you)g(can)h
("o)n(wn",)f(whereas)h(a)h(fork)e(can)h(be.)-2 2737 y
SDict begin H.S end

-2 2737 a -2 2737 a
SDict begin 13 H.A end
 -2 2737 a -2 2737 a
SDict begin [/View [/XYZ H.V]/Dest (0:4567) cvn /DEST pdfmark end
 -2 2737 a 396
3047 a Fd(7.5.9.)36 b(Rob)n(ustness)f(in)e(Con\003ict)2027
3047 y
SDict begin H.S end
 2027 3047 a 2027 3047 a
SDict begin 18.72 H.A end
 2027 3047 a 2027 3047
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.93.2) cvn /DEST pdfmark end
 2027 3047 a -2 3215 a
SDict begin H.S end
 -2 3215 a -2 3215 a
SDict begin 13 H.A end
 -2 3215 a
-2 3215 a
SDict begin [/View [/XYZ H.V]/Dest (0:4569) cvn /DEST pdfmark end
 -2 3215 a -2 3215 a
SDict begin H.S end
 -2 3215 a -2 3215 a
SDict begin 13 H.A end
 -2
3215 a -2 3215 a
SDict begin [/View [/XYZ H.V]/Dest (0:4570) cvn /DEST pdfmark end
 -2 3215 a 396 3321 a Fi(The)21 b(mor)m(e)f(a)g(model)g
(can)f(survive)i(con\003ict,)e(the)h(better)-9 b(.)-2
3504 y
SDict begin H.S end
 -2 3504 a -2 3504 a
SDict begin 13 H.A end
 -2 3504 a -2 3504 a
SDict begin [/View [/XYZ H.V]/Dest (0:4571) cvn /DEST pdfmark end
 -2 3504
a 396 3595 a Fj(Lik)o(e)20 b(it)h(or)f(not,)g(people)f(\002ght)h(o)o(v)
o(er)f(e)o(go,)g(status,)h(beliefs,)g(and)g(theories)g(of)f(the)i(w)o
(orld.)e(Challenge)g(is)j(a)e(necessary)396 3703 y(part)g(of)g
(science.)f(If)h(your)f(or)o(ganizational)d(model)k(depends)e(on)i
(agreement,)e(you)h(w)o(on')o(t)g(survi)n(v)o(e)f(the)i(\002rst)h(real)
f(\002ght.)396 3811 y(Branches)g(do)g(not)g(survi)n(v)o(e)e(real)j(ar)o
(guments)d(and)h(\002ghts.)h(Whereas)h(forks)e(can)h(be)g(hostile,)g
(and)g(still)h(bene\002t)f(all)396 3919 y(parties.)g(And)g(this)h(is)g
(indeed)e(ho)n(w)g(free)h(softw)o(are)g(w)o(orks.)-2
3947 y
SDict begin H.S end
 -2 3947 a -2 3947 a
SDict begin 13 H.A end
 -2 3947 a -2 3947 a
SDict begin [/View [/XYZ H.V]/Dest (0:4572) cvn /DEST pdfmark end
 -2 3947
a 396 4257 a Fd(7.5.10.)36 b(Guarantees)f(of)e(Isolation)2122
4257 y
SDict begin H.S end
 2122 4257 a 2122 4257 a
SDict begin 18.72 H.A end
 2122 4257 a 2122 4257
a
SDict begin [/View [/XYZ H.V]/Dest (12.78.94.2) cvn /DEST pdfmark end
 2122 4257 a -2 4425 a
SDict begin H.S end
 -2 4425 a -2 4425 a
SDict begin 13 H.A end
 -2 4425 a
-2 4425 a
SDict begin [/View [/XYZ H.V]/Dest (0:4574) cvn /DEST pdfmark end
 -2 4425 a -2 4425 a
SDict begin H.S end
 -2 4425 a -2 4425 a
SDict begin 13 H.A end
 -2
4425 a -2 4425 a
SDict begin [/View [/XYZ H.V]/Dest (0:4575) cvn /DEST pdfmark end
 -2 4425 a 396 4531 a Fi(The)21 b(str)l(ong)o(er)f(the)
g(isolation)g(between)g(pr)l(oduction)e(code)h(and)h(e)n(xperiment,)f
(the)i(better)-9 b(.)-2 4714 y
SDict begin H.S end
 -2 4714 a -2 4714 a
SDict begin 13 H.A end
 -2
4714 a -2 4714 a
SDict begin [/View [/XYZ H.V]/Dest (0:4576) cvn /DEST pdfmark end
 -2 4714 a 396 4805 a Fj(People)20 b(mak)o(e)g(mistak)o
(es.)g(I')l(v)o(e)f(seen)h(e)o(xperimental)e(code)i(pushed)f(to)h
(mainline)f(production)f(by)i(error)-5 b(.)19 b(I')l(v)o(e)g(seen)396
4913 y(people)g(mak)o(e)h(bad)g(panic)f(changes)g(under)g(stress.)i
(But)g(the)f(real)g(f)o(ault)g(is)i(in)e(allo)n(wing)f(tw)o(o)i
(entirely)e(separate)396 5021 y(generations)g(of)h(product)e(to)i(e)o
(xist)h(in)f(the)g(same)h(protected)d(space.)i(If)g(you)g(can)g(push)f
(to)h(random-branch-x)c(you)j(can)396 5129 y(push)h(to)g(master)-5
b(.)20 b(Branches)g(do)g(not)g(guarantee)e(isolation)i(of)g(production)
d(critical)k(code.)e(F)o(orks)h(do.)-2 5158 y
SDict begin H.S end
 -2 5158
a -2 5158 a
SDict begin 13 H.A end
 -2 5158 a -2 5158 a
SDict begin [/View [/XYZ H.V]/Dest (0:4577) cvn /DEST pdfmark end
 -2 5158 a Black 3759
5569 a Fi(330)p Black eop end
%%Page: 331 345
TeXDict begin 331 344 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.331) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 77 a Fd(7.5.11.)36 b(Visibility)1285 77 y
SDict begin H.S end
 1285
77 a 1285 77 a
SDict begin 18.72 H.A end
 1285 77 a 1285 77 a
SDict begin [/View [/XYZ H.V]/Dest (12.78.95.2) cvn /DEST pdfmark end
 1285 77 a -2 267 a
SDict begin H.S end

-2 267 a -2 267 a
SDict begin 13 H.A end
 -2 267 a -2 267 a
SDict begin [/View [/XYZ H.V]/Dest (0:4579) cvn /DEST pdfmark end
 -2 267 a -2 267 a
SDict begin H.S end

-2 267 a -2 267 a
SDict begin 13 H.A end
 -2 267 a -2 267 a
SDict begin [/View [/XYZ H.V]/Dest (0:4580) cvn /DEST pdfmark end
 -2 267 a 396 351
a Fi(The)21 b(mor)m(e)f(visible)g(our)g(work,)h(the)f(better)-9
b(.)-2 527 y
SDict begin H.S end
 -2 527 a -2 527 a
SDict begin 13 H.A end
 -2 527 a -2 527 a
SDict begin [/View [/XYZ H.V]/Dest (0:4581) cvn /DEST pdfmark end
 -2 527
a 396 625 a Fj(F)o(orks)20 b(ha)n(v)o(e)f(w)o(atchers,)h(issues,)h(a)g
(README,)f(a)g(wiki.)g(Branches)g(ha)n(v)o(e)g(none)f(of)h(these.)g
(People)g(try)g(forks,)f(b)n(uild)396 733 y(them,)h(break)f(them,)h
(patch)f(them.)h(Branches)f(sit)j(there)d(until)h(someone)f(remembers)g
(to)h(w)o(ork)g(on)f(them.)h(F)o(orks)g(ha)n(v)o(e)396
840 y(do)n(wnloads)f(and)g(tarballs.)h(Branches)g(do)g(not.)f(When)h
(we)h(look)e(for)h(self-or)o(ganization,)c(the)k(more)g(visible)g(and)
396 948 y(declarati)n(v)o(e)f(the)h(problems,)f(the)h(f)o(aster)g(and)g
(more)f(accurately)g(we)i(can)f(w)o(ork.)-2 977 y
SDict begin H.S end
 -2
977 a -2 977 a
SDict begin 13 H.A end
 -2 977 a -2 977 a
SDict begin [/View [/XYZ H.V]/Dest (0:4582) cvn /DEST pdfmark end
 -2 977 a 396 1287 a
Fd(7.5.12.)36 b(Conc)n(lusions)1508 1287 y
SDict begin H.S end
 1508 1287
a 1508 1287 a
SDict begin 18.72 H.A end
 1508 1287 a 1508 1287 a
SDict begin [/View [/XYZ H.V]/Dest (12.78.96.2) cvn /DEST pdfmark end
 1508 1287 a -2
1454 a
SDict begin H.S end
 -2 1454 a -2 1454 a
SDict begin 13 H.A end
 -2 1454 a -2 1454 a
SDict begin [/View [/XYZ H.V]/Dest (0:4584) cvn /DEST pdfmark end
 -2 1454
a 396 1561 a Fj(In)20 b(this)h(section)f(I')l(v)o(e)f(listed)i(a)f
(series)h(of)f(ar)o(guments,)e(most)i(of)g(which)g(came)f(from)h(fello)
n(w)f(team)i(members.)d(Here')-5 b(s)396 1669 y(ho)n(w)20
b(it)h(seems)f(to)h(break)e(do)n(wn:)g(git)i(v)o(eterans)e(insist)i
(that)f(branches)f(are)h(the)g(w)o(ay)h(to)f(w)o(ork,)f(whereas)h(ne)n
(wcomers)396 1777 y(tend)g(to)g(feel)h(intimidated)e(when)g(ask)o(ed)h
(to)g(na)n(vigate)f(git)i(branches.)d(Git)j(is)g(not)f(an)g(easy)h
(tool)f(to)g(master)-5 b(.)20 b(What)396 1885 y(we')l(v)o(e)f(disco)o
(v)o(ered,)f(accidentally)-5 b(,)18 b(is)k(that)e(when)f(you)h(stop)g
(using)f(branches)2693 1885 y
SDict begin H.S end
 2693 1885 a 2693 1885 a
SDict begin 13 H.A end

2693 1885 a 2693 1885 a
SDict begin [/View [/XYZ H.V]/Dest (0:4585) cvn /DEST pdfmark end
 2693 1885 a Fi(at)i(all)p Fj(,)f(git)g(becomes)
g(tri)n(vial)g(to)g(use.)g(It)396 1993 y(literally)g(comes)g(do)n(wn)f
(to)i(six)f(commands)f(\(clone,)g(remote,)g(commit,)g(log,)h(push,)f
(and)h(pull\).)f(Furthermore,)f(a)396 2100 y(branch-free)g(process)h
(actually)h(w)o(orks,)g(we')l(v)o(e)f(used)h(it)h(for)e(a)i(couple)e
(of)h(years)g(no)n(w)-5 b(,)19 b(and)g(no)h(visible)g(do)n(wnside)396
2208 y(e)o(xcept)f(surprise)h(to)g(the)h(v)o(eterans,)e(and)g(gro)n
(wth)g(of)h("single")g(projects)f(o)o(v)o(er)g(multiple)h
(repositories.)-2 2392 y
SDict begin H.S end
 -2 2392 a -2 2392 a
SDict begin 13 H.A end
 -2 2392
a -2 2392 a
SDict begin [/View [/XYZ H.V]/Dest (0:4586) cvn /DEST pdfmark end
 -2 2392 a 396 2482 a Fj(If)g(you)g(can')o(t)f(use)h(forks,)
f(perhaps)g(because)h(your)f(\002rm)h(doesn')o(t)f(trust)h(github')-5
b(s)19 b(pri)n(v)n(ate)g(repositories,)g(then)h(you)396
2590 y(perhaps)f(topic)h(branches)f(\(one)g(per)h(issue\))g(will)h(w)o
(ork.)f(Y)-9 b(ou')o(ll)19 b(still)i(suf)n(fer)f(the)g(costs)h(of)f
(getting)f(upfront)396 2698 y(consensus,)g(lo)n(w)i(competiti)n(v)o
(eness,)d(and)h(risk)i(of)f(human)e(error)-5 b(.)-2 2810
y
SDict begin H.S end
 -2 2810 a -2 2810 a
SDict begin 13 H.A end
 -2 2810 a -2 2810 a
SDict begin [/View [/XYZ H.V]/Dest (0:4587) cvn /DEST pdfmark end
 -2 2810 a 359
x Fh(7.6.)39 b(The)g(Myth)f(of)i(Intellig)q(ent)e(Design)2321
3169 y
SDict begin H.S end
 2321 3169 a 2321 3169 a
SDict begin 22.464 H.A end
 2321 3169 a 2321 3169
a
SDict begin [/View [/XYZ H.V]/Dest (12.79.1) cvn /DEST pdfmark end
 2321 3169 a -2 3367 a
SDict begin H.S end
 -2 3367 a -2 3367 a
SDict begin 13 H.A end
 -2 3367 a
-2 3367 a
SDict begin [/View [/XYZ H.V]/Dest (0:4589) cvn /DEST pdfmark end
 -2 3367 a 396 3443 a Fj(The)20 b(dominant)f(theory)f(of)i
(design)g(is)h(that)f(you)g(tak)o(e)g(smart,)g(creati)n(v)o(e)f(people)
g(and)h(mone)o(y)-5 b(,)18 b(and)h(produce)f(amazing)396
3551 y(products.)h(The)h(smarter)f(the)h(people,)f(the)i(better)e(the)i
(results.)f(I'm)f(going)g(to)i(claim)f(that)g(theory)f(is)i(bogus,)e(a)
i(myth)396 3659 y(based)f(on)g(magical)f(thinking)g(that)h(treats)h
(the)f("in)m(v)o(ention")e(as)j(a)f(product)f(of)g(indi)n(vidual)g("in)
m(v)o(entor")f(minds.)h(As)i(an)396 3767 y(alternati)n(v)o(e)e(I')o(ll)
i(present)e(the)h(Theory)f(of)h(Heuristic)g(Inno)o(v)n(ation,)d(which)i
(states)j(roughly)c(that)i(we)g(do)g(not)g(in)m(v)o(ent)396
3874 y(solutions,)g(we)g(disco)o(v)o(er)f(them,)g(and)h(that)g(disco)o
(v)o(ery)e(process)i(can)g(be)g(highly)f(automated.)-2
4058 y
SDict begin H.S end
 -2 4058 a -2 4058 a
SDict begin 13 H.A end
 -2 4058 a -2 4058 a
SDict begin [/View [/XYZ H.V]/Dest (0:4590) cvn /DEST pdfmark end
 -2 4058
a 396 4148 a Fj(Presenting)h(\330MQ)g(at)h(the)f(Mix-IT)f(conference)f
(in)i(L)-5 b(yon)20 b(in)g(early)g(2012,)e(I)j(w)o(as)g(ask)o(ed)f(se)n
(v)o(eral)f(times)i(for)f(the)396 4256 y("road-map".)c(My)i(answer)h(w)
o(as,)g(There)e(is)j(no)e(road-map,)e(and)i(road-maps)e(are)j(bad)f
(for)g(se)n(v)o(eral)g(reasons.)f(First,)i(the)o(y)396
4364 y(mak)o(e)h(promises)g(we)g(can)g(rarely)f(k)o(eep,)h(which)g
(causes)g(problems)f(for)g(our)h(users.)g(Second,)f(the)o(y)g(claim)h
(territory)396 4472 y(and)g(mak)o(e)g(it)h(harder)d(for)i(others)g(to)g
(participate.)f(Lastly)-5 b(,)20 b(the)o(y)f(preempt)g(the)h(thinking)f
(process)g(of)h(the)g(community)-5 b(.)396 4580 y(The)20
b(audience)f(didn')o(t)g(really)g(lik)o(e)i(my)f(answer)-5
b(.)20 b(So)g(un-French.)e(Softw)o(are)h(engineers)g(don')o(t)g(lik)o
(e)h(the)h(notion)e(that)396 4688 y(po)n(werful,)f(ef)n(fecti)n(v)o(e)h
(solutions)h(can)g(come)f(into)h(e)o(xistence)g(without)f(an)h
(intelligent)g(designer)f(acti)n(v)o(ely)g(thinking)396
4796 y(things)h(through.)e(And)h(yet)h(no-one)f(in)h(that)g(room)f(w)o
(ould)g(question)g(e)n(v)n(olution.)g(A)h(strange)g(iron)o(y)-5
b(,)18 b(and)h(one)h(I)g(w)o(anted)396 4904 y(to)h(e)o(xplore)d
(further)h(as)i(it)g(underpins)d(the)i(direction)f(the)h(\330MQ)h
(community)d(has)i(tak)o(en)g(o)o(v)o(er)e(the)j(last)g(year)e(or)h
(so.)p Black 3759 5569 a Fi(331)p Black eop end
%%Page: 332 346
TeXDict begin 332 345 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.332) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4591) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(In)g(the)g(dominant)f(theory)-5 b(,)18
b(brilliant)i(indi)n(viduals)e(re\003ect)j(on)e(lar)o(ge)h(problem)e
(sets)j(and)f(then)g(carefully)f(and)g(precisely)396
180 y(create)h(a)h(solution.)e(Sometimes)h(the)o(y)f(will)i(ha)n(v)o(e)
f("eureka")e(moments)i(where)f(the)o(y)h("get")g(brilliantly)f(simple)
396 288 y(answers)h(to)h(whole)e(lar)o(ge)h(problem)e(sets.)j(The)f(in)
m(v)o(entor)m(,)d(and)j(the)g(process)g(of)g(in)m(v)o(ention)e(are)i
(rare,)f(precious,)g(and)396 396 y(can)h(command)e(a)j(monopoly)-5
b(.)17 b(History)j(is)h(full)f(of)g(such)g(heroic)f(indi)n(viduals.)f
(W)-7 b(e)22 b(o)n(we)e(them)g(our)f(modern)f(w)o(orld.)-2
580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:4592) cvn /DEST pdfmark end
 -2 580 a 396
670 a Fj(Looking)g(closer)m(,)i(ho)n(we)n(v)o(er)m(,)d(the)k(f)o(acts)f
(don')o(t)f(match.)g(History)h(doesn')o(t)f(sho)n(w)h(lone)f(in)m(v)o
(entors.)f(It)j(sho)n(ws)f(luck)o(y)396 778 y(people)f(who)h(steal)g
(or)g(claim)g(o)n(wnership)f(of)g(ideas)i(that)f(are)g(being)f(w)o(ork)
o(ed)g(on)g(by)h(man)o(y)-5 b(.)18 b(It)i(sho)n(ws)g(brilliant)g
(people)396 886 y(striking)g(luck)o(y)f(once,)g(and)h(then)f(spending)g
(decades)g(on)h(fruitless)g(and)g(pointless)g(quests.)g(The)g(best)g
(kno)n(wn)396 994 y(lar)o(ge-scale)f(in)m(v)o(entors)f(lik)o(e)j
(Thomas)e(Edison)g(were)h(in)h(f)o(act)f(just)h(v)o(ery)e(good)g(at)h
(systematic)h(broad)d(research)i(done)396 1102 y(by)g(lar)o(ge)f
(teams.)h(It')-5 b(s)21 b(lik)o(e)g(claiming)e(that)h(Ste)n(v)o(e)g
(Jobs)h(in)m(v)o(ented)d(e)n(v)o(ery)h(de)n(vice)g(made)h(by)f(Apple.)h
(It)g(is)h(a)g(nice)f(myth,)396 1210 y(good)f(for)h(mark)o(eting,)e(b)n
(ut)i(utterly)g(useless)h(as)g(practical)e(science.)-2
1394 y
SDict begin H.S end
 -2 1394 a -2 1394 a
SDict begin 13 H.A end
 -2 1394 a -2 1394 a
SDict begin [/View [/XYZ H.V]/Dest (0:4593) cvn /DEST pdfmark end
 -2 1394
a 396 1484 a Fj(Recent)i(history)-5 b(,)18 b(much)i(better)f
(documented)f(and)i(less)h(easy)f(to)g(manipulate,)f(sho)n(ws)h(this)h
(well.)f(The)g(Internet)f(is)396 1592 y(surely)h(one)g(of)f(the)i(most)
f(inno)o(v)n(ati)n(v)o(e)e(and)h(f)o(ast-mo)o(ving)f(areas)i(of)g
(technology)-5 b(,)17 b(and)j(one)g(of)g(the)g(best)g(documented.)396
1700 y(It)h(has)f(no)g(in)m(v)o(entor)-5 b(.)18 b(Instead)i(it)g(has)h
(a)g(massi)n(v)o(e)e(economy)g(of)g(people)h(who)f(ha)n(v)o(e)h
(carefully)f(and)g(progressi)n(v)o(ely)396 1808 y(solv)o(ed)h(a)g(long)
g(series)g(of)g(immediate)g(problems,)e(documented)g(their)i(answers,)f
(and)h(made)g(those)g(a)n(v)n(ailable)f(to)i(all.)396
1916 y(The)f(inno)o(v)n(ati)n(v)o(e)e(nature)h(of)h(the)g(Internet)f
(comes)h(not)g(from)f(a)i(small,)f(select)h(band)e(of)h(Einsteins.)g
(It)g(comes)g(from)396 2023 y(RFCs)i(an)o(yone)d(can)g(use)i(and)f
(impro)o(v)o(e,)d(made)j(by)g(hundreds)e(and)h(thousands)g(of)h(smart,)
g(b)n(ut)g(not)g(uniquely)f(smart,)396 2131 y(indi)n(viduals.)g(It)h
(comes)g(from)f(open)g(source)h(softw)o(are)g(an)o(yone)e(can)i(use)g
(and)g(impro)o(v)o(e.)e(It)i(comes)g(from)f(sharing,)396
2239 y(scale)i(of)f(community)-5 b(,)17 b(and)j(the)g(continuous)e
(accretion)h(of)h(good)f(solutions)h(and)f(disposal)h(of)g(bad)g(ones.)
-2 2423 y
SDict begin H.S end
 -2 2423 a -2 2423 a
SDict begin 13 H.A end
 -2 2423 a -2 2423 a
SDict begin [/View [/XYZ H.V]/Dest (0:4594) cvn /DEST pdfmark end
 -2
2423 a 396 2513 a Fj(Here)g(thus)g(is)i(my)d("Theory)g(of)h(Heuristic)g
(Inno)o(v)n(ation":)-2 2531 y
SDict begin H.S end
 -2 2531 a -2 2531 a
SDict begin 13 H.A end
 -2
2531 a -2 2531 a
SDict begin [/View [/XYZ H.V]/Dest (0:4595) cvn /DEST pdfmark end
 -2 2531 a -2 2541 a
SDict begin H.S end
 -2 2541 a -2 2541
a
SDict begin 13 H.A end
 -2 2541 a -2 2541 a
SDict begin [/View [/XYZ H.V]/Dest (0:4596) cvn /DEST pdfmark end
 -2 2541 a Black 463 2684 a Fj(1.)p
Black 546 2684 a
SDict begin H.S end
 546 2684 a 546 2684 a
SDict begin 13 H.A end
 546 2684 a 546
2684 a
SDict begin [/View [/XYZ H.V]/Dest (0:4597) cvn /DEST pdfmark end
 546 2684 a Fj(There)f(is)i(an)f(in\002nite)g(problem/solution)d
(terrain.)-2 2701 y
SDict begin H.S end
 -2 2701 a -2 2701 a
SDict begin 13 H.A end
 -2 2701 a -2
2701 a
SDict begin [/View [/XYZ H.V]/Dest (0:4598) cvn /DEST pdfmark end
 -2 2701 a Black 463 2833 a Fj(2.)p Black 546 2833
a
SDict begin H.S end
 546 2833 a 546 2833 a
SDict begin 13 H.A end
 546 2833 a 546 2833 a
SDict begin [/View [/XYZ H.V]/Dest (0:4599) cvn /DEST pdfmark end
 546 2833
a Fj(This)j(terrain)g(changes)f(o)o(v)o(er)f(time)j(according)d(to)i(e)
o(xternal)f(conditions.)-2 2851 y
SDict begin H.S end
 -2 2851 a -2 2851 a
SDict begin 13 H.A end

-2 2851 a -2 2851 a
SDict begin [/View [/XYZ H.V]/Dest (0:4600) cvn /DEST pdfmark end
 -2 2851 a Black 463 2982 a Fj(3.)p
Black 546 2982 a
SDict begin H.S end
 546 2982 a 546 2982 a
SDict begin 13 H.A end
 546 2982 a 546
2982 a
SDict begin [/View [/XYZ H.V]/Dest (0:4601) cvn /DEST pdfmark end
 546 2982 a Fj(W)-7 b(e)21 b(can)f(only)f(accurately)g(percei)n
(v)o(e)g(problems)g(we)h(are)g(close)h(to.)-2 3000 y
SDict begin H.S end

-2 3000 a -2 3000 a
SDict begin 13 H.A end
 -2 3000 a -2 3000 a
SDict begin [/View [/XYZ H.V]/Dest (0:4602) cvn /DEST pdfmark end
 -2 3000 a Black
463 3132 a Fj(4.)p Black 546 3132 a
SDict begin H.S end
 546 3132 a 546 3132
a
SDict begin 13 H.A end
 546 3132 a 546 3132 a
SDict begin [/View [/XYZ H.V]/Dest (0:4603) cvn /DEST pdfmark end
 546 3132 a Fj(W)-7 b(e)21 b(can)f(rank)f(the)i
(cost/bene\002t)e(economics)g(of)h(problems)f(using)g(a)i(mark)o(et)e
(for)h(solutions.)-2 3150 y
SDict begin H.S end
 -2 3150 a -2 3150 a
SDict begin 13 H.A end
 -2 3150
a -2 3150 a
SDict begin [/View [/XYZ H.V]/Dest (0:4604) cvn /DEST pdfmark end
 -2 3150 a Black 463 3281 a Fj(5.)p Black
546 3281 a
SDict begin H.S end
 546 3281 a 546 3281 a
SDict begin 13 H.A end
 546 3281 a 546 3281
a
SDict begin [/View [/XYZ H.V]/Dest (0:4605) cvn /DEST pdfmark end
 546 3281 a Fj(There)f(is)i(an)f(optimal)g(solution)f(to)h(an)o(y)g
(solv)n(able)f(problem.)-2 3299 y
SDict begin H.S end
 -2 3299 a -2 3299 a
SDict begin 13 H.A end

-2 3299 a -2 3299 a
SDict begin [/View [/XYZ H.V]/Dest (0:4606) cvn /DEST pdfmark end
 -2 3299 a Black 463 3431 a Fj(6.)p
Black 546 3431 a
SDict begin H.S end
 546 3431 a 546 3431 a
SDict begin 13 H.A end
 546 3431 a 546
3431 a
SDict begin [/View [/XYZ H.V]/Dest (0:4607) cvn /DEST pdfmark end
 546 3431 a Fj(W)-7 b(e)21 b(can)f(approach)e(this)j(optimal)e
(solution)h(heuristically)-5 b(,)18 b(and)i(mechanically)-5
b(.)-2 3449 y
SDict begin H.S end
 -2 3449 a -2 3449 a
SDict begin 13 H.A end
 -2 3449 a -2 3449 a
SDict begin [/View [/XYZ H.V]/Dest (0:4608) cvn /DEST pdfmark end

-2 3449 a Black 463 3580 a Fj(7.)p Black 546 3580 a
SDict begin H.S end
 546
3580 a 546 3580 a
SDict begin 13 H.A end
 546 3580 a 546 3580 a
SDict begin [/View [/XYZ H.V]/Dest (0:4609) cvn /DEST pdfmark end
 546 3580 a Fj(Our)20
b(intelligence)f(can)h(mak)o(e)f(this)i(process)f(f)o(aster)g(b)n(ut)g
(does)g(not)g(replace)g(it.)-2 3764 y
SDict begin H.S end
 -2 3764 a -2 3764
a
SDict begin 13 H.A end
 -2 3764 a -2 3764 a
SDict begin [/View [/XYZ H.V]/Dest (0:4610) cvn /DEST pdfmark end
 -2 3764 a 396 3854 a Fj(It')-5
b(s)21 b(an)f(approximation.)d(Feel)k(free)f(to)g(send)g(me)g(patches.)
f(There)h(are)g(a)h(fe)n(w)f(tak)o(ea)o(w)o(ays)f(from)g(this:)-2
3872 y
SDict begin H.S end
 -2 3872 a -2 3872 a
SDict begin 13 H.A end
 -2 3872 a -2 3872 a
SDict begin [/View [/XYZ H.V]/Dest (0:4611) cvn /DEST pdfmark end
 -2 3872
a -2 3882 a
SDict begin H.S end
 -2 3882 a -2 3882 a
SDict begin 13 H.A end
 -2 3882 a -2 3882 a
SDict begin [/View [/XYZ H.V]/Dest (0:4612) cvn /DEST pdfmark end
 -2
3882 a Black 396 4024 a Fe(\225)p Black 479 4024 a
SDict begin H.S end
 479
4024 a 479 4024 a
SDict begin 13 H.A end
 479 4024 a 479 4024 a
SDict begin [/View [/XYZ H.V]/Dest (0:4613) cvn /DEST pdfmark end
 479 4024 a 479
4024 a
SDict begin H.S end
 479 4024 a 479 4024 a
SDict begin 13 H.A end
 479 4024 a 479 4024 a
SDict begin [/View [/XYZ H.V]/Dest (0:4614) cvn /DEST pdfmark end
 479
4024 a Fi(Individual)f(cr)m(eativity)j(matter)o(s)g(less)g(than)e(pr)l
(ocess.)i Fj(Smarter)e(people)g(may)h(w)o(ork)g(f)o(aster)g(b)n(ut)g
(the)o(y)g(may)f(w)o(ork)h(in)479 4132 y(the)g(wrong)f(direction.)g
(It')-5 b(s)21 b(the)f(collecti)n(v)o(e)f(vision)h(of)g(reality)g(that)
g(k)o(eeps)g(us)h(honest)e(and)h(rele)n(v)n(ant.)-2 4150
y
SDict begin H.S end
 -2 4150 a -2 4150 a
SDict begin 13 H.A end
 -2 4150 a -2 4150 a
SDict begin [/View [/XYZ H.V]/Dest (0:4615) cvn /DEST pdfmark end
 -2 4150 a Black
396 4282 a Fe(\225)p Black 479 4282 a
SDict begin H.S end
 479 4282 a 479
4282 a
SDict begin 13 H.A end
 479 4282 a 479 4282 a
SDict begin [/View [/XYZ H.V]/Dest (0:4616) cvn /DEST pdfmark end
 479 4282 a 479 4282 a
SDict begin H.S end
 479
4282 a 479 4282 a
SDict begin 13 H.A end
 479 4282 a 479 4282 a
SDict begin [/View [/XYZ H.V]/Dest (0:4617) cvn /DEST pdfmark end
 479 4282 a Fi(W)-8
b(e)21 b(don')n(t)e(need)g(r)l(oad-maps)g(if)i(we)g(have)f(a)g(good)f
(pr)l(ocess.)h Fj(Functionality)f(will)i(emer)o(ge)d(and)i(e)n(v)n(olv)
o(e)f(o)o(v)o(er)g(time)479 4390 y(as)i(solutions)f(compete)f(for)g
(mark)o(et)h(share.)-2 4408 y
SDict begin H.S end
 -2 4408 a -2 4408 a
SDict begin 13 H.A end
 -2
4408 a -2 4408 a
SDict begin [/View [/XYZ H.V]/Dest (0:4618) cvn /DEST pdfmark end
 -2 4408 a Black 396 4539 a Fe(\225)p
Black 479 4539 a
SDict begin H.S end
 479 4539 a 479 4539 a
SDict begin 13 H.A end
 479 4539 a 479
4539 a
SDict begin [/View [/XYZ H.V]/Dest (0:4619) cvn /DEST pdfmark end
 479 4539 a 479 4539 a
SDict begin H.S end
 479 4539 a 479 4539 a
SDict begin 13 H.A end
 479
4539 a 479 4539 a
SDict begin [/View [/XYZ H.V]/Dest (0:4620) cvn /DEST pdfmark end
 479 4539 a Fi(W)-8 b(e)21 b(don')n(t)e(in)m(vent)g
(solutions,)h(so)g(muc)o(h)g(as)g(disco)o(ver)g(them.)g
Fj(All)h(sympathies)e(to)i(the)f(creati)n(v)o(e)f(soul.)h(It')-5
b(s)21 b(just)g(an)479 4647 y(information)d(processing)h(machine)g
(that)h(lik)o(es)h(to)f(polish)g(its)h(o)n(wn)f(e)o(go)f(and)h(collect)
g(karma.)-2 4665 y
SDict begin H.S end
 -2 4665 a -2 4665 a
SDict begin 13 H.A end
 -2 4665 a -2 4665
a
SDict begin [/View [/XYZ H.V]/Dest (0:4621) cvn /DEST pdfmark end
 -2 4665 a Black 396 4796 a Fe(\225)p Black 479 4796
a
SDict begin H.S end
 479 4796 a 479 4796 a
SDict begin 13 H.A end
 479 4796 a 479 4796 a
SDict begin [/View [/XYZ H.V]/Dest (0:4622) cvn /DEST pdfmark end
 479 4796
a 479 4796 a
SDict begin H.S end
 479 4796 a 479 4796 a
SDict begin 13 H.A end
 479 4796 a 479 4796
a
SDict begin [/View [/XYZ H.V]/Dest (0:4623) cvn /DEST pdfmark end
 479 4796 a Fi(Intellig)o(ence)f(is)i(a)g(social)f(ef)o(fect,)f
(though)g(it)i(feels)g(per)o(sonal.)e Fj(A)i(person)e(cut-of)n(f)f
(from)h(others)h(e)n(v)o(entually)e(stops)479 4904 y(thinking.)h(W)-7
b(e)21 b(can)f(neither)f(collect)h(problems)f(nor)h(measure)f
(solutions)h(without)f(other)g(people.)-2 4922 y
SDict begin H.S end
 -2 4922
a -2 4922 a
SDict begin 13 H.A end
 -2 4922 a -2 4922 a
SDict begin [/View [/XYZ H.V]/Dest (0:4624) cvn /DEST pdfmark end
 -2 4922 a Black 396 5054
a Fe(\225)p Black 479 5054 a
SDict begin H.S end
 479 5054 a 479 5054 a
SDict begin 13 H.A end
 479
5054 a 479 5054 a
SDict begin [/View [/XYZ H.V]/Dest (0:4625) cvn /DEST pdfmark end
 479 5054 a 479 5054 a
SDict begin H.S end
 479 5054 a 479
5054 a
SDict begin 13 H.A end
 479 5054 a 479 5054 a
SDict begin [/View [/XYZ H.V]/Dest (0:4626) cvn /DEST pdfmark end
 479 5054 a Fi(The)i(size)g(and)e(diver)o
(sity)i(of)f(the)h(community)e(is)i(a)f(k)o(e)n(y)g(factor)-9
b(.)20 b Fj(Lar)o(ger)m(,)e(more)h(di)n(v)o(erse)g(communities)g
(collect)h(more)479 5162 y(rele)n(v)n(ant)f(problems,)g(and)g(solv)o(e)
h(them)g(more)f(accurately)-5 b(,)19 b(and)g(do)h(this)h(f)o(aster)m(,)
f(than)f(a)i(small)g(e)o(xpert)d(group.)p Black 3759
5569 a Fi(332)p Black eop end
%%Page: 333 347
TeXDict begin 333 346 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.333) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4627) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(People)g(ha)n(v)o(e)g(pointed)e(out)i(that)h
(hill-climbing)d(algorithms)h(\(what)h(this)g(is,)h(essentially\))f(ha)
n(v)o(e)g(kno)n(wn)e(limitations.)396 180 y(One)i(gets)h(stuck)f(on)g
(local)g(peaks,)f(mainly)-5 b(.)19 b(But)i(this)g(is)g(nonetheless)e
(ho)n(w)g(life)i(itself)g(w)o(orks:)f(collecting)f(tin)o(y)396
288 y(incremental)g(impro)o(v)o(ements)e(o)o(v)o(er)i(long)g(periods)h
(of)g(time.)g(There)f(is)i(no)f(intelligent)f(designer)-5
b(.)20 b(W)-7 b(e)21 b(reduce)e(the)h(risk)396 396 y(of)g(local)g
(peaks)g(by)g(spreading)e(out)i(widely)g(across)g(the)g(landscape)g(b)n
(ut)g(it)h(is)g(some)n(what)e(moot.)g(The)h(limitations)396
504 y(aren')o(t)f(optional,)g(the)o(y)g(are)h(physical)f(la)o(ws.)i
(The)f(theory)f(says,)2264 504 y
SDict begin H.S end
 2264 504 a 2264 504
a
SDict begin 13 H.A end
 2264 504 a 2264 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:4628) cvn /DEST pdfmark end
 2264 504 a Fi(this)i(is)g(how)f(inno)o(vation)e
(r)m(eally)j(works,)f(so)h(better)396 612 y(embr)o(ace)f(it)h(and)e
(work)i(with)f(it,)h(than)e(try)i(to)g(work)g(on)e(the)i(basis)f(of)g
(belief)12 b Fj(.)-2 795 y
SDict begin H.S end
 -2 795 a -2 795 a
SDict begin 13 H.A end
 -2 795 a
-2 795 a
SDict begin [/View [/XYZ H.V]/Dest (0:4629) cvn /DEST pdfmark end
 -2 795 a 396 886 a Fj(And)20 b(in)g(f)o(act)h(once)e(you)g
(see)i(all)g(inno)o(v)n(ation)d(as)j(more)e(or)h(less)h(successful)f
(hill-climbing,)e(you)h(realize)i(why)e(some)396 994
y(teams)h(and)g(companies)e(and)i(products)e(get)i(stuck)g(in)g(a)g(ne)
n(v)o(er)n(-ne)n(v)o(er)d(land)j(of)f(diminishing)f(prospects.)h(The)o
(y)g(simply)396 1102 y(don')o(t)g(ha)n(v)o(e)g(the)i(di)n(v)o(ersity)e
(and)g(collecti)n(v)o(e)g(intelligence)h(to)g(\002nd)g(better)g(hills)g
(to)h(climb)m(.)e(When)h(Nokia)g(killed)g(their)396 1210
y(open)f(source)h(projects,)f(the)o(y)h(cut)g(their)g(o)n(wn)f(throat.)
-2 1238 y
SDict begin H.S end
 -2 1238 a -2 1238 a
SDict begin 13 H.A end
 -2 1238 a -2 1238 a
SDict begin [/View [/XYZ H.V]/Dest (0:4630) cvn /DEST pdfmark end
 -2
1238 a 359 x Fh(7.7.)39 b(Burnout)837 1597 y
SDict begin H.S end
 837 1597
a 837 1597 a
SDict begin 22.464 H.A end
 837 1597 a 837 1597 a
SDict begin [/View [/XYZ H.V]/Dest (12.80.1) cvn /DEST pdfmark end
 837 1597 a -2 1765
a
SDict begin H.S end
 -2 1765 a -2 1765 a
SDict begin 13 H.A end
 -2 1765 a -2 1765 a
SDict begin [/View [/XYZ H.V]/Dest (0:4632) cvn /DEST pdfmark end
 -2 1765 a 396
1871 a Fj(The)20 b(\330MQ)h(community)d(has)i(been)f(and)h(still)h(is)h
(hea)n(vily)d(dependent)f(on)i(pro-bono)d(indi)n(vidual)h(ef)n(forts.)i
(I')l(d)f(lik)o(e)h(to)396 1979 y(think)g(that)g(e)n(v)o(eryone)e(w)o
(as)j(compensated)d(in)i(some)g(w)o(ay)h(for)e(their)h(contrib)n
(utions,)e(and)i(I)g(belie)n(v)o(e)f(that)i(with)f(\330MQ,)396
2087 y(contrib)n(uting)e(means)i(gaining)f(e)o(xpertise)g(in)h(an)g(e)o
(xtraordinarily)d(v)n(aluable)i(technology)-5 b(,)17
b(which)j(means)g(impro)o(v)o(ed)396 2195 y(professional)f(options.)-2
2379 y
SDict begin H.S end
 -2 2379 a -2 2379 a
SDict begin 13 H.A end
 -2 2379 a -2 2379 a
SDict begin [/View [/XYZ H.V]/Dest (0:4633) cvn /DEST pdfmark end
 -2 2379
a 396 2469 a Fj(Ho)n(we)n(v)o(er)g(not)h(all)h(projects)e(will)i(be)f
(so)h(luck)o(y)e(and)g(if)i(you)e(w)o(ork)h(with)g(or)g(in)g(open)f
(source)h(you)f(should)g(understand)396 2577 y(the)h(risk)h(of)f(b)n
(urnout)e(that)i(v)n(olunteers)f(f)o(ace.)h(This)h(applies)f(to)g(all)h
(pro-bono)c(communities.)h(In)i(this)h(section)f(I')o(ll)396
2685 y(e)o(xplain)f(what)h(causes)h(b)n(urnout,)d(ho)n(w)i(to)g
(recognize)e(it,)j(ho)n(w)f(to)g(pre)n(v)o(ent)e(it,)j(and)f(\(if)g(it)
h(happens\))d(ho)n(w)i(to)g(try)g(to)h(treat)396 2793
y(it.)g(Disclaimer:)f(I'm)g(not)g(a)g(psychiatrist)g(and)f(this)i
(article)f(is)h(based)f(on)g(my)g(o)n(wn)g(e)o(xperiences)e(of)i(w)o
(orking)e(in)396 2901 y(pro-bono)f(conte)o(xts)j(for)f(the)h(last)h(20)
f(years,)g(including)e(free)i(softw)o(are)g(projects,)f(and)h(NGOs)h
(such)f(as)h(the)3567 2901 y
SDict begin H.S end
 3567 2901 a 3567 2901 a
SDict begin 13 H.A end

3567 2901 a 3567 2901 a
SDict begin [/View [/XYZ H.V]/Dest (0:4634) cvn /DEST pdfmark end
 3567 2901 a Fj(FFII)396 3009
y(\(http://www)-5 b(.f)n(\002i.or)o(g\).)-2 3193 y
SDict begin H.S end
 -2
3193 a -2 3193 a
SDict begin 13 H.A end
 -2 3193 a -2 3193 a
SDict begin [/View [/XYZ H.V]/Dest (0:4635) cvn /DEST pdfmark end
 -2 3193 a 396 3283
a Fj(In)20 b(a)h(pro-bono)c(conte)o(xt)i(we')l(re)g(e)o(xpected)g(to)h
(w)o(ork)g(without)f(direct)h(or)g(ob)o(vious)e(economic)h(incenti)n(v)
o(e.)g(That)g(is,)i(we)396 3391 y(sacri\002ce)g(f)o(amily)e(life,)i
(professional)d(adv)n(ancement,)g(free)h(time,)h(and)g(health)g(in)g
(order)f(to)h(accomplish)f(some)h(goal)396 3499 y(we)g(ha)n(v)o(e)f
(decided)g(to)h(accomplish.)e(In)h(an)o(y)g(project,)g(we)h(need)f
(some)g(kind)g(of)h(re)n(w)o(ard)e(to)i(mak)o(e)f(it)i(w)o(orth)e
(continuing)396 3607 y(each)h(day)-5 b(.)19 b(In)h(most)g(pro-bono)d
(projects)j(the)g(re)n(w)o(ards)g(are)g(v)o(ery)f(indirect,)g
(super\002cially)g(not)h(economical)f(at)h(all.)396 3714
y(Mostly)-5 b(,)20 b(we)g(do)g(things)g(because)f(people)g(say)-5
b(,)20 b("he)o(y)-5 b(,)19 b(great!")g(Karma)h(is)h(a)f(po)n(werful)f
(moti)n(v)n(ator)-5 b(.)-2 3898 y
SDict begin H.S end
 -2 3898 a -2 3898 a
SDict begin 13 H.A end

-2 3898 a -2 3898 a
SDict begin [/View [/XYZ H.V]/Dest (0:4636) cvn /DEST pdfmark end
 -2 3898 a 396 3988 a Fj(Ho)n(we)n(v)o(er)m(,)18
b(we)j(are)f(economic)f(beings,)g(and)g(sooner)h(or)f(later)m(,)h(if)h
(a)f(project)g(costs)g(us)h(a)g(great)e(deal)h(and)g(does)g(not)396
4096 y(bring)f(economic)g(re)n(w)o(ards)g(of)h(some)g(kind)g(\(mone)o
(y)-5 b(,)17 b(f)o(ame,)j(a)g(ne)n(w)g(job,...\))f(we)i(start)f(to)h
(suf)n(fer)-5 b(.)19 b(At)i(a)f(certain)g(stage)h(it)396
4204 y(seems)g(our)e(subconscious)g(simply)h(gets)g(disgusted,)f(and)h
(says,)g("enough)e(is)k(enough!")17 b(and)j(refuses)g(to)g(go)g(an)o(y)
396 4312 y(further)-5 b(.)19 b(If)h(we)h(try)f(to)g(force)f(ourselv)o
(es,)g(we)i(can)f(literally)g(get)g(sick.)-2 4496 y
SDict begin H.S end
 -2
4496 a -2 4496 a
SDict begin 13 H.A end
 -2 4496 a -2 4496 a
SDict begin [/View [/XYZ H.V]/Dest (0:4637) cvn /DEST pdfmark end
 -2 4496 a 396 4586
a Fj(This)h(is)g(what)f(I)g(call)h("b)n(urnout",)d(though)g(the)i(term)
g(is)h(also)g(used)f(for)f(other)h(kinds)g(of)f(e)o(xhaustion.)f(T)-7
b(oo)20 b(much)396 4694 y(in)m(v)o(estment)f(on)h(a)g(project,)f(with)i
(too)f(little)h(economic)d(re)n(w)o(ard,)h(for)h(too)g(long.)f(W)-7
b(e)21 b(are)f(great)g(at)h(manipulating)396 4802 y(ourselv)o(es,)e
(and)h(others,)f(and)h(this)h(is)g(often)e(part)h(of)g(the)g(process)g
(that)g(leads)g(to)h(b)n(urnout.)d(W)-7 b(e)21 b(tell)g(ourselv)o(es)e
(that)h(it')-5 b(s)396 4910 y(for)20 b(a)g(good)f(cause,)h(that)g(the)h
(other)e(guy)g(is)i(doing)e(OK,)i(so)f(we)h(should)e(be)h(able)g(to)h
(as)f(well.)p Black 3759 5569 a Fi(333)p Black eop end
%%Page: 334 348
TeXDict begin 334 347 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.334) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4638) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(When)g(I)h(got)f(b)n(urnt)f(out)h(on)g(open)f(source)
g(projects)h(lik)o(e)g(Xitami,)g(I)h(remember)d(clearly)i(ho)n(w)f(I)i
(felt.)f(I)g(simply)396 180 y(stopped)f(w)o(orking)g(on)h(it,)g
(refused)f(to)i(answer)e(an)o(y)h(more)f(emails,)h(and)g(told)g(people)
f(to)h(for)o(get)f(about)g(it.)i(Y)-9 b(ou)19 b(can)h(tell)396
288 y(when)f(someone')-5 b(s)19 b(b)n(urnt)g(out.)g(The)o(y)f(go)h(of)n
(f-line,)f(and)h(e)n(v)o(eryone)e(starts)j(saying,)f("he')-5
b(s)20 b(acting)f(strange...)f(depressed,)396 396 y(or)i(tired...")-2
563 y
SDict begin H.S end
 -2 563 a -2 563 a
SDict begin 13 H.A end
 -2 563 a -2 563 a
SDict begin [/View [/XYZ H.V]/Dest (0:4639) cvn /DEST pdfmark end
 -2 563 a 396
670 a Fj(Diagnosis)g(is)h(simple.)f(Has)h(someone)e(w)o(ork)o(ed)g(a)i
(lot)f(on)g(a)g(project)g(that)g(w)o(as)h(not)f(paying)f(back)g(in)h
(an)o(y)g(w)o(ay?)g(Did)396 778 y(she)h(mak)o(e)e(e)o(xceptional)g
(sacri\002ces?)h(Did)g(he)h(lose)f(or)g(abandon)e(his)j(job)f(or)f
(studies)i(to)f(do)g(the)g(project?)f(If)h(you')l(re)396
886 y(answering)f("yes",)h(it')-5 b(s)21 b(b)n(urnout.)-2
1070 y
SDict begin H.S end
 -2 1070 a -2 1070 a
SDict begin 13 H.A end
 -2 1070 a -2 1070 a
SDict begin [/View [/XYZ H.V]/Dest (0:4640) cvn /DEST pdfmark end
 -2 1070
a 396 1160 a Fj(There)e(are)h(three)f(simple)h(techniques)e(I')l(v)o(e)
g(de)n(v)o(eloped)g(o)o(v)o(er)g(the)i(years)f(to)h(reduce)e(the)i
(risk)g(of)f(b)n(urnout)f(in)i(the)g(teams)396 1268 y(I)h(w)o(ork)e
(with:)-2 1269 y
SDict begin H.S end
 -2 1269 a -2 1269 a
SDict begin 13 H.A end
 -2 1269 a -2 1269
a
SDict begin [/View [/XYZ H.V]/Dest (0:4641) cvn /DEST pdfmark end
 -2 1269 a -2 1279 a
SDict begin H.S end
 -2 1279 a -2 1279 a
SDict begin 13 H.A end
 -2 1279 a -2
1279 a
SDict begin [/View [/XYZ H.V]/Dest (0:4642) cvn /DEST pdfmark end
 -2 1279 a Black 396 1438 a Fe(\225)p Black 479
1438 a
SDict begin H.S end
 479 1438 a 479 1438 a
SDict begin 13 H.A end
 479 1438 a 479 1438 a
SDict begin [/View [/XYZ H.V]/Dest (0:4643) cvn /DEST pdfmark end
 479
1438 a 479 1438 a
SDict begin H.S end
 479 1438 a 479 1438 a
SDict begin 13 H.A end
 479 1438 a 479
1438 a
SDict begin [/View [/XYZ H.V]/Dest (0:4644) cvn /DEST pdfmark end
 479 1438 a Fi(No-one)g(is)j(irr)m(eplaceable)o(.)c
Fj(W)-7 b(orking)19 b(solo)i(on)e(a)i(critical)f(or)g(popular)e
(project)i(--)g(the)g(concentration)e(of)479 1546 y(responsibility)h
(on)h(one)g(person)f(who)g(cannot)g(set)i(their)f(o)n(wn)g(limits)h(--)
f(is)h(probably)d(the)i(main)g(f)o(actor)-5 b(.)20 b(It')-5
b(s)21 b(a)479 1654 y(management)d(truism:)i(if)h(someone)e(in)h(your)f
(or)o(ganization)e(is)k(irreplaceable,)d(get)i(rid)g(of)g(him)g(or)g
(her)-5 b(.)-2 1672 y
SDict begin H.S end
 -2 1672 a -2 1672 a
SDict begin 13 H.A end
 -2 1672 a -2
1672 a
SDict begin [/View [/XYZ H.V]/Dest (0:4645) cvn /DEST pdfmark end
 -2 1672 a Black 396 1803 a Fe(\225)p Black 479
1803 a
SDict begin H.S end
 479 1803 a 479 1803 a
SDict begin 13 H.A end
 479 1803 a 479 1803 a
SDict begin [/View [/XYZ H.V]/Dest (0:4646) cvn /DEST pdfmark end
 479
1803 a 479 1803 a
SDict begin H.S end
 479 1803 a 479 1803 a
SDict begin 13 H.A end
 479 1803 a 479
1803 a
SDict begin [/View [/XYZ H.V]/Dest (0:4647) cvn /DEST pdfmark end
 479 1803 a Fi(W)d(e)21 b(need)f(day)g(jobs)g(to)g(pay)g(the)g
(bills.)g Fj(This)h(can)f(be)g(hard)f(b)n(ut)h(seems)h(necessary)-5
b(.)19 b(Getting)h(mone)o(y)e(from)479 1911 y(some)n(where)h(else)i
(mak)o(es)f(it)h(much)e(easier)h(to)h(sustain)f(a)h(sacri\002cial)f
(project.)-2 1929 y
SDict begin H.S end
 -2 1929 a -2 1929 a
SDict begin 13 H.A end
 -2 1929 a -2
1929 a
SDict begin [/View [/XYZ H.V]/Dest (0:4648) cvn /DEST pdfmark end
 -2 1929 a Black 396 2061 a Fe(\225)p Black 479
2061 a
SDict begin H.S end
 479 2061 a 479 2061 a
SDict begin 13 H.A end
 479 2061 a 479 2061 a
SDict begin [/View [/XYZ H.V]/Dest (0:4649) cvn /DEST pdfmark end
 479
2061 a 479 2061 a
SDict begin H.S end
 479 2061 a 479 2061 a
SDict begin 13 H.A end
 479 2061 a 479
2061 a
SDict begin [/View [/XYZ H.V]/Dest (0:4650) cvn /DEST pdfmark end
 479 2061 a Fi(T)-8 b(eac)o(h)20 b(people)f(about)g(b)n(urnout.)g
Fj(This)h(should)f(IMO)i(be)f(a)g(basic)h(course)e(in)h(colle)o(ges)g
(and)g(uni)n(v)o(ersities,)f(as)479 2169 y(pro-bono)e(w)o(ork)j
(becomes)f(a)i(more)e(common)f(w)o(ay)j(for)e(young)g(people)g(to)h(e)o
(xperiment)e(professionally)-5 b(.)-2 2353 y
SDict begin H.S end
 -2 2353
a -2 2353 a
SDict begin 13 H.A end
 -2 2353 a -2 2353 a
SDict begin [/View [/XYZ H.V]/Dest (0:4651) cvn /DEST pdfmark end
 -2 2353 a 396 2443 a
Fj(When)20 b(someone)f(is)i(w)o(orking)d(alone)i(on)g(a)g(critical)g
(project,)f(you)2333 2443 y
SDict begin H.S end
 2333 2443 a 2333 2443 a
SDict begin 13 H.A end
 2333
2443 a 2333 2443 a
SDict begin [/View [/XYZ H.V]/Dest (0:4652) cvn /DEST pdfmark end
 2333 2443 a Fi(know)h Fj(the)o(y)g(are)g(going)e
(blo)n(w)i(their)g(fuses)g(sooner)f(or)396 2551 y(later)-5
b(.)21 b(It')-5 b(s)21 b(actually)e(f)o(airly)h(predictable:)f
(something)f(lik)o(e)j(18-36)d(months)h(depending)f(on)i(the)g(indi)n
(vidual)f(and)g(ho)n(w)396 2659 y(much)g(economic)g(stress)i(the)o(y)f
(f)o(ace)g(in)g(their)g(pri)n(v)n(ate)f(li)n(v)o(es.)h(I')l(v)o(e)f
(not)h(seen)h(an)o(yone)d(b)n(urn-out)g(after)i(half)g(a)g(year)m(,)f
(nor)396 2767 y(last)i(\002)n(v)o(e)f(years)g(in)h(a)f(unre)n(w)o
(arding)e(project.)-2 2951 y
SDict begin H.S end
 -2 2951 a -2 2951 a
SDict begin 13 H.A end
 -2 2951
a -2 2951 a
SDict begin [/View [/XYZ H.V]/Dest (0:4653) cvn /DEST pdfmark end
 -2 2951 a 396 3041 a Fj(There)i(is)h(a)f(simple)h(cure)e
(for)h(b)n(urnout)e(which)i(w)o(orks)g(in)g(at)h(least)g(some)f(cases:)
h(get)f(paid)g(decently)f(for)g(your)g(w)o(ork.)396 3148
y(Ho)n(we)n(v)o(er)g(this)i(pretty)e(much)g(destro)o(ys)h(the)g
(freedom)f(of)g(mo)o(v)o(ement)f(\(across)i(that)g(in\002nite)g
(problem)f(landscape\))396 3256 y(that)i(the)f(v)n(olunteer)e(enjo)o
(ys.)-2 3285 y
SDict begin H.S end
 -2 3285 a -2 3285 a
SDict begin 13 H.A end
 -2 3285 a -2 3285
a
SDict begin [/View [/XYZ H.V]/Dest (0:4654) cvn /DEST pdfmark end
 -2 3285 a 359 x Fh(7.8.)39 b(P)l(atterns)e(f)m(or)j(The)f(Game)1810
3644 y
SDict begin H.S end
 1810 3644 a 1810 3644 a
SDict begin 22.464 H.A end
 1810 3644 a 1810 3644
a
SDict begin [/View [/XYZ H.V]/Dest (12.81.1) cvn /DEST pdfmark end
 1810 3644 a -2 3812 a
SDict begin H.S end
 -2 3812 a -2 3812 a
SDict begin 13 H.A end
 -2 3812 a
-2 3812 a
SDict begin [/View [/XYZ H.V]/Dest (0:4656) cvn /DEST pdfmark end
 -2 3812 a 396 3918 a Fj(I')o(ll)21 b(end)e(this)i(code-free)d
(chapter)h(with)i(a)f(series)h(of)f(patterns)g(for)f(success)i(in)f
(softw)o(are)g(engineering.)d(The)o(y)j(aim)g(to)396
4026 y(capture)f(the)i(essence)f(of)g(what)g(di)n(vides)f(glorious)g
(success)i(from)e(tragic)h(f)o(ailure.)f(The)o(y)h(were)g(described)e
(as)396 4134 y("religious)h(maniacal)h(dogma")f(by)g(a)i(manager)m(,)d
(and)i("an)o(ything)e(else)i(w)o(ould)g(be)g(ef)n(\002ng)f(insane")h
(by)g(a)h(colleague,)d(in)396 4242 y(a)j(single)e(day)-5
b(.)19 b(F)o(or)h(me,)f(the)o(y)h(are)f(science.)h(But)g(treat)g(the)g
(Lazy)g(Perfectionist)f(and)g(others)h(as)g(tools)g(to)g(use,)g
(sharpen,)396 4350 y(and)g(thro)n(w)f(a)o(w)o(ay)h(if)h(something)d
(better)i(comes)g(along.)-2 4368 y
SDict begin H.S end
 -2 4368 a -2 4368
a
SDict begin 13 H.A end
 -2 4368 a -2 4368 a
SDict begin [/View [/XYZ H.V]/Dest (0:4657) cvn /DEST pdfmark end
 -2 4368 a 396 4678 a Fd(7.8.1.)36
b(The)d(Lazy)h(P)l(erf)o(ectionist)1991 4678 y
SDict begin H.S end
 1991 4678
a 1991 4678 a
SDict begin 18.72 H.A end
 1991 4678 a 1991 4678 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.97.2) cvn /DEST pdfmark end
 1991 4678 a -2
4868 a
SDict begin H.S end
 -2 4868 a -2 4868 a
SDict begin 13 H.A end
 -2 4868 a -2 4868 a
SDict begin [/View [/XYZ H.V]/Dest (0:4659) cvn /DEST pdfmark end
 -2 4868
a -2 4868 a
SDict begin H.S end
 -2 4868 a -2 4868 a
SDict begin 13 H.A end
 -2 4868 a -2 4868 a
SDict begin [/View [/XYZ H.V]/Dest (0:4660) cvn /DEST pdfmark end
 -2
4868 a 396 4952 a Fi(Ne)o(ver)21 b(design)f(anything)e(that')m(s)h(not)
h(a)h(pr)m(ecise)f(minimal)g(answer)h(to)f(a)g(pr)l(oblem)g(we)h(can)e
(identify)h(and)g(have)f(to)396 5060 y(solve)o(.)p Black
3759 5569 a(334)p Black eop end
%%Page: 335 349
TeXDict begin 335 348 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.335) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4661) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)g(Lazy)g(Perfectionist)f(spends)h(his)h(idle)f
(time)g(observing)e(others)i(and)g(identifying)e(problems)h(that)h(are)
g(w)o(orth)396 180 y(solving.)f(He)i(looks)e(for)h(agreement)f(on)g
(those)h(problems,)f(al)o(w)o(ays)i(asking,)e("what)h(is)h(the)3057
180 y
SDict begin H.S end
 3057 180 a 3057 180 a
SDict begin 13 H.A end
 3057 180 a 3057 180 a
SDict begin [/View [/XYZ H.V]/Dest (0:4662) cvn /DEST pdfmark end
 3057
180 a Fi(r)m(eal)g Fj(problem".)d(Then)h(he)396 288 y(mo)o(v)o(es,)g
(precisely)g(and)g(minimally)-5 b(,)18 b(to)i(b)n(uild,)f(or)h(get)g
(others)f(to)h(b)n(uild,)f(a)h(usable)g(answer)f(to)h(one)f(problem.)f
(He)i(uses,)396 396 y(or)g(gets)h(others)e(to)i(use)f(those)g
(solutions.)f(And)h(he)g(repeats)g(this)h(until)f(there)g(are)g(no)g
(problems)e(left)j(to)f(solv)o(e,)g(or)g(time)396 504
y(or)g(mone)o(y)f(runs)g(out.)-2 533 y
SDict begin H.S end
 -2 533 a -2 533
a
SDict begin 13 H.A end
 -2 533 a -2 533 a
SDict begin [/View [/XYZ H.V]/Dest (0:4663) cvn /DEST pdfmark end
 -2 533 a 396 843 a Fd(7.8.2.)36 b(The)d(Bene)n(v)l
(olent)k(T)-7 b(yrant)2005 843 y
SDict begin H.S end
 2005 843 a 2005 843
a
SDict begin 18.72 H.A end
 2005 843 a 2005 843 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.98.2) cvn /DEST pdfmark end
 2005 843 a -2 1033 a
SDict begin H.S end
 -2 1033
a -2 1033 a
SDict begin 13 H.A end
 -2 1033 a -2 1033 a
SDict begin [/View [/XYZ H.V]/Dest (0:4665) cvn /DEST pdfmark end
 -2 1033 a -2 1033 a
SDict begin H.S end
 -2
1033 a -2 1033 a
SDict begin 13 H.A end
 -2 1033 a -2 1033 a
SDict begin [/View [/XYZ H.V]/Dest (0:4666) cvn /DEST pdfmark end
 -2 1033 a 396 1117
a Fi(The)21 b(contr)l(ol)e(of)i(a)f(lar)m(g)o(e)g(for)m(ce)g(is)i(the)e
(same)g(principle)g(as)g(the)g(contr)l(ol)g(of)h(a)f(fe)o(w)h(men:)e
(it)i(is)h(mer)m(ely)e(a)g(question)f(of)396 1225 y(dividing)g(up)h
(their)h(number)o(s.)e Fj(--)h(Sun)g(Tzu)-2 1408 y
SDict begin H.S end
 -2
1408 a -2 1408 a
SDict begin 13 H.A end
 -2 1408 a -2 1408 a
SDict begin [/View [/XYZ H.V]/Dest (0:4667) cvn /DEST pdfmark end
 -2 1408 a 396 1499
a Fj(The)g(Bene)n(v)n(olent)f(T)-7 b(yrant)20 b(di)n(vides)f(lar)o(ge)g
(problems)g(into)h(smaller)g(ones)g(and)g(thro)n(ws)g(them)f(at)i
(groups)e(to)h(focus)g(on.)396 1606 y(He)h(brok)o(ers)e(contracts)g
(between)h(these)g(groups,)e(in)j(the)f(form)f(of)h(APIs)h(and)e
(unprotocols.)f(The)i(Bene)n(v)n(olent)f(T)-7 b(yrant)396
1714 y(constructs)20 b(a)g(supply)f(chain)h(that)g(starts)h(with)g
(problems,)d(and)i(results)g(in)h(usable)f(solutions.)f(He)i(is)g
(ruthless)f(about)396 1822 y(ho)n(w)g(the)g(supply)f(chain)h(w)o(orks,)
f(b)n(ut)i(does)f(not)f(tell)i(people)e(on)h(what)g(to)h(w)o(ork,)e
(nor)g(ho)n(w)h(to)g(do)g(their)g(w)o(ork.)-2 1851 y
SDict begin H.S end

-2 1851 a -2 1851 a
SDict begin 13 H.A end
 -2 1851 a -2 1851 a
SDict begin [/View [/XYZ H.V]/Dest (0:4668) cvn /DEST pdfmark end
 -2 1851 a 396
2161 a Fd(7.8.3.)36 b(The)d(Ear)r(th)h(and)f(Sky)1773
2161 y
SDict begin H.S end
 1773 2161 a 1773 2161 a
SDict begin 18.72 H.A end
 1773 2161 a 1773 2161
a
SDict begin [/View [/XYZ H.V]/Dest (12.81.99.2) cvn /DEST pdfmark end
 1773 2161 a -2 2352 a
SDict begin H.S end
 -2 2352 a -2 2352 a
SDict begin 13 H.A end
 -2 2352 a
-2 2352 a
SDict begin [/View [/XYZ H.V]/Dest (0:4670) cvn /DEST pdfmark end
 -2 2352 a -2 2352 a
SDict begin H.S end
 -2 2352 a -2 2352 a
SDict begin 13 H.A end
 -2
2352 a -2 2352 a
SDict begin [/View [/XYZ H.V]/Dest (0:4671) cvn /DEST pdfmark end
 -2 2352 a 396 2435 a Fi(The)21 b(ideal)e(team)h
(consists)h(of)g(two)f(sides:)h(one)e(writing)i(code)o(,)e(and)h(one)f
(pr)l(o)o(viding)g(feedbac)n(k.)-2 2618 y
SDict begin H.S end
 -2 2618 a -2
2618 a
SDict begin 13 H.A end
 -2 2618 a -2 2618 a
SDict begin [/View [/XYZ H.V]/Dest (0:4672) cvn /DEST pdfmark end
 -2 2618 a 396 2709 a Fj(The)h(Earth)g(and)f
(Sk)o(y)h(w)o(ork)g(together)e(as)j(a)g(whole,)e(in)i(close)f
(proximity)-5 b(,)18 b(b)n(ut)i(the)o(y)f(communicate)f(formally)h
(through)396 2817 y(an)h(issue)h(tracking.)e(Sk)o(y)g(seeks)i(out)f
(problems,)e(from)i(others)f(and)h(from)f(their)h(o)n(wn)g(use)g(of)g
(the)g(product,)e(and)i(feeds)396 2925 y(these)h(to)f(Earth.)f(Earth)h
(rapidly)f(answers)h(with)g(testable)h(solutions.)e(Earth)h(and)f(Sk)o
(y)h(can)g(w)o(ork)g(through)e(dozens)h(of)396 3033 y(issues)i(in)g(a)f
(day)-5 b(.)19 b(Sk)o(y)h(talks)h(to)f(other)f(users,)h(and)g(Earth)g
(talks)g(to)h(other)e(de)n(v)o(elopers.)f(Earth)h(and)h(Sk)o(y)g(may)f
(be)i(tw)o(o)396 3140 y(people,)e(or)h(tw)o(o)g(small)h(groups.)-2
3169 y
SDict begin H.S end
 -2 3169 a -2 3169 a
SDict begin 13 H.A end
 -2 3169 a -2 3169 a
SDict begin [/View [/XYZ H.V]/Dest (0:4673) cvn /DEST pdfmark end
 -2 3169
a 396 3479 a Fd(7.8.4.)36 b(The)d(Open)h(Door)1592 3479
y
SDict begin H.S end
 1592 3479 a 1592 3479 a
SDict begin 18.72 H.A end
 1592 3479 a 1592 3479 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.100.2) cvn /DEST pdfmark
end
 1592
3479 a -2 3670 a
SDict begin H.S end
 -2 3670 a -2 3670 a
SDict begin 13 H.A end
 -2 3670 a -2 3670
a
SDict begin [/View [/XYZ H.V]/Dest (0:4675) cvn /DEST pdfmark end
 -2 3670 a -2 3670 a
SDict begin H.S end
 -2 3670 a -2 3670 a
SDict begin 13 H.A end
 -2 3670 a -2
3670 a
SDict begin [/View [/XYZ H.V]/Dest (0:4676) cvn /DEST pdfmark end
 -2 3670 a 396 3753 a Fi(The)21 b(accur)o(acy)d(of)j(knowledg)o
(e)e(comes)h(fr)l(om)h(diver)o(sity)-5 b(.)-2 3936 y
SDict begin H.S end

-2 3936 a -2 3936 a
SDict begin 13 H.A end
 -2 3936 a -2 3936 a
SDict begin [/View [/XYZ H.V]/Dest (0:4677) cvn /DEST pdfmark end
 -2 3936 a 396
4027 a Fj(The)20 b(Open)g(Door)f(accepts)h(contrib)n(utions)e(from)i
(almost)g(an)o(yone.)e(He)i(does)g(not)g(ar)o(gue)f(quality)g(or)h
(direction,)396 4135 y(instead)g(allo)n(wing)f(others)h(to)g(ar)o(gue)f
(that)h(and)g(so)h(get)f(more)f(engaged.)f(He)i(calculates)h(that)f(e)n
(v)o(en)f(a)i(troll)f(will)h(bring)396 4243 y(more)f(di)n(v)o(erse)f
(opinion)f(to)j(the)f(group.)e(He)j(lets)g(the)f(group)e(form)h(its)j
(opinion)c(about)h(what)i(goes)e(into)h(stable)h(code,)396
4351 y(and)f(he)g(enforces)f(this)i(opinion)d(with)j(help)e(of)h(a)h
(Bene)n(v)n(olent)e(T)-7 b(yrant.)-2 4379 y
SDict begin H.S end
 -2 4379 a
-2 4379 a
SDict begin 13 H.A end
 -2 4379 a -2 4379 a
SDict begin [/View [/XYZ H.V]/Dest (0:4678) cvn /DEST pdfmark end
 -2 4379 a 396 4689 a Fd(7.8.5.)36
b(The)d(Laughing)i(Clo)n(wn)1902 4689 y
SDict begin H.S end
 1902 4689 a 1902
4689 a
SDict begin 18.72 H.A end
 1902 4689 a 1902 4689 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.101.2) cvn /DEST pdfmark
end
 1902 4689 a -2 4882 a
SDict begin H.S end

-2 4882 a -2 4882 a
SDict begin 13 H.A end
 -2 4882 a -2 4882 a
SDict begin [/View [/XYZ H.V]/Dest (0:4680) cvn /DEST pdfmark end
 -2 4882 a -2
4882 a
SDict begin H.S end
 -2 4882 a -2 4882 a
SDict begin 13 H.A end
 -2 4882 a -2 4882 a
SDict begin [/View [/XYZ H.V]/Dest (0:4681) cvn /DEST pdfmark end
 -2 4882
a 396 4963 a Fi(P)-7 b(erfection)20 b(pr)m(ecludes)g(participation.)p
Black 3759 5569 a(335)p Black eop end
%%Page: 336 350
TeXDict begin 336 349 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.336) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4703) cvn /DEST pdfmark end
 -2 -201 a 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4682) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)g(Laughing)e(Clo)n(wn,)i(often)f(acting)h(as)h
(the)f(Happ)o(y)f(F)o(ailure,)h(mak)o(es)g(no)g(claim)g(to)g(high)g
(competence.)e(Instead)h(his)396 180 y(antics)i(and)e(b)n(umbling)g
(attempts)h(pro)o(v)n(ok)o(e)e(others)i(into)g(rescuing)f(him)h(from)f
(his)h(o)n(wn)g(tragedy)-5 b(.)18 b(Someho)n(w)396 288
y(ho)n(we)n(v)o(er)m(,)g(he)i(al)o(w)o(ays)h(identi\002es)f(the)g
(right)g(problems)e(to)j(solv)o(e.)e(People)h(are)g(so)h(b)n(usy)f(pro)
o(ving)d(him)j(wrong)f(the)o(y)396 396 y(don')o(t)g(realize)h(the)o(y')
l(re)e(doing)h(v)n(aluable)g(w)o(ork.)-2 425 y
SDict begin H.S end
 -2 425
a -2 425 a
SDict begin 13 H.A end
 -2 425 a -2 425 a
SDict begin [/View [/XYZ H.V]/Dest (0:4683) cvn /DEST pdfmark end
 -2 425 a 396 735 a Fd(7.8.6.)36
b(The)d(Mindful)h(General)1877 735 y
SDict begin H.S end
 1877 735 a 1877
735 a
SDict begin 18.72 H.A end
 1877 735 a 1877 735 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.102.2) cvn /DEST pdfmark
end
 1877 735 a -2 902 a
SDict begin H.S end
 -2 902
a -2 902 a
SDict begin 13 H.A end
 -2 902 a -2 902 a
SDict begin [/View [/XYZ H.V]/Dest (0:4685) cvn /DEST pdfmark end
 -2 902 a -2 902 a
SDict begin H.S end
 -2 902
a -2 902 a
SDict begin 13 H.A end
 -2 902 a -2 902 a
SDict begin [/View [/XYZ H.V]/Dest (0:4686) cvn /DEST pdfmark end
 -2 902 a 396 1009 a Fi(Mak)o(e)21
b(no)e(plans.)h(Set)g(goals,)f(de)o(velop)g(str)o(ate)m(gies)h(and)f
(tactics.)-2 1192 y
SDict begin H.S end
 -2 1192 a -2 1192 a
SDict begin 13 H.A end
 -2 1192 a -2
1192 a
SDict begin [/View [/XYZ H.V]/Dest (0:4687) cvn /DEST pdfmark end
 -2 1192 a 396 1283 a Fj(The)h(Mindful)f(General)h(operates)f(in)
h(unkno)n(wn)e(territory)-5 b(,)18 b(solving)h(problems)g(that)h(are)h
(hidden)d(until)i(the)o(y)g(are)396 1391 y(nearby)-5
b(.)18 b(Thus)i(he)g(mak)o(es)g(no)g(plans,)g(b)n(ut)g(seeks)h
(opportunities,)c(then)j(e)o(xploits)f(them)h(rapidly)f(and)h
(accurately)-5 b(.)18 b(He)396 1499 y(de)n(v)o(elops)h(tactics)i(and)e
(strate)o(gies)h(in)h(the)f(\002eld,)g(and)g(teaches)g(these)g(to)h
(his)f(men)g(so)g(the)o(y)g(can)g(mo)o(v)o(e)f(independently)-5
b(,)396 1606 y(and)20 b(together)-5 b(.)-2 1635 y
SDict begin H.S end
 -2
1635 a -2 1635 a
SDict begin 13 H.A end
 -2 1635 a -2 1635 a
SDict begin [/View [/XYZ H.V]/Dest (0:4688) cvn /DEST pdfmark end
 -2 1635 a 396 1945
a Fd(7.8.7.)36 b(The)d(Social)i(Engineer)1871 1945 y
SDict begin H.S end

1871 1945 a 1871 1945 a
SDict begin 18.72 H.A end
 1871 1945 a 1871 1945 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.103.2) cvn /DEST pdfmark
end
 1871
1945 a -2 2138 a
SDict begin H.S end
 -2 2138 a -2 2138 a
SDict begin 13 H.A end
 -2 2138 a -2 2138
a
SDict begin [/View [/XYZ H.V]/Dest (0:4690) cvn /DEST pdfmark end
 -2 2138 a -2 2138 a
SDict begin H.S end
 -2 2138 a -2 2138 a
SDict begin 13 H.A end
 -2 2138 a -2
2138 a
SDict begin [/View [/XYZ H.V]/Dest (0:4691) cvn /DEST pdfmark end
 -2 2138 a 396 2219 a Fi(If)21 b(you)e(know)h(the)h(enemy)e(and)h
(know)g(your)o(self)o(,)g(you)g(need)f(not)h(fear)h(the)f(r)m(esult)h
(of)f(a)g(hundr)m(ed)f(battles.)g Fj(--)i(Sun)e(Tzu)-2
2402 y
SDict begin H.S end
 -2 2402 a -2 2402 a
SDict begin 13 H.A end
 -2 2402 a -2 2402 a
SDict begin [/View [/XYZ H.V]/Dest (0:4692) cvn /DEST pdfmark end
 -2 2402
a 396 2493 a Fj(The)h(Social)g(Engineer)f(reads)h(the)g(hearts)g(and)g
(minds)f(of)h(those)g(he)g(w)o(orks)g(with)h(and)e(for)-5
b(.)20 b(He)h(asks,)f(of)g(e)n(v)o(eryone,)396 2601 y("what)g(mak)o(es)
g(this)h(person)e(angry)-5 b(,)18 b(insecure,)h(ar)o(gumentati)n(v)o
(e,)e(calm,)j(happ)o(y?")f(He)h(studies)h(their)e(moods)h(and)396
2709 y(dispositions.)g(W)m(ith)g(this)h(kno)n(wledge)d(he)i(can)g
(encourage)e(those)i(who)f(are)i(useful,)e(and)h(discourage)e(those)i
(who)g(are)396 2817 y(not.)g(The)g(Social)g(Engineer)f(ne)n(v)o(er)f
(acts)j(on)f(his)h(o)n(wn)e(emotions.)-2 2845 y
SDict begin H.S end
 -2 2845
a -2 2845 a
SDict begin 13 H.A end
 -2 2845 a -2 2845 a
SDict begin [/View [/XYZ H.V]/Dest (0:4693) cvn /DEST pdfmark end
 -2 2845 a 396 3155 a
Fd(7.8.8.)36 b(The)d(Constant)i(Gar)n(dener)2055 3155
y
SDict begin H.S end
 2055 3155 a 2055 3155 a
SDict begin 18.72 H.A end
 2055 3155 a 2055 3155 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.104.2) cvn /DEST pdfmark
end
 2055
3155 a -2 3323 a
SDict begin H.S end
 -2 3323 a -2 3323 a
SDict begin 13 H.A end
 -2 3323 a -2 3323
a
SDict begin [/View [/XYZ H.V]/Dest (0:4695) cvn /DEST pdfmark end
 -2 3323 a -2 3323 a
SDict begin H.S end
 -2 3323 a -2 3323 a
SDict begin 13 H.A end
 -2 3323 a -2
3323 a
SDict begin [/View [/XYZ H.V]/Dest (0:4696) cvn /DEST pdfmark end
 -2 3323 a 396 3429 a Fi(He)21 b(will)g(win)g(whose)f(army)h(is)g
(animated)d(by)j(the)f(same)g(spirit)h(thr)l(oughout)d(all)j(its)g(r)o
(anks.)f Fj(--)g(Sun)g(Tzu)-2 3612 y
SDict begin H.S end
 -2 3612 a -2 3612
a
SDict begin 13 H.A end
 -2 3612 a -2 3612 a
SDict begin [/View [/XYZ H.V]/Dest (0:4697) cvn /DEST pdfmark end
 -2 3612 a 396 3703 a Fj(The)g(Constant)g
(Gardener)f(gro)n(ws)g(a)i(process)f(from)f(a)h(small)h(seed,)f(step)h
(by)e(step)i(as)g(more)e(people)g(come)h(into)g(the)396
3811 y(project.)f(He)i(mak)o(es)f(e)n(v)o(ery)f(change)g(for)g(a)i
(precise)f(reason,)f(with)h(agreement)f(from)g(e)n(v)o(eryone.)e(He)k
(ne)n(v)o(er)e(imposes)h(a)396 3919 y(process)g(from)f(abo)o(v)o(e)g(b)
n(ut)h(lets)h(others)f(come)f(to)i(consensus,)e(then)g(he)i(enforces)d
(that)j(consensus.)e(In)h(this)h(w)o(ay)396 4027 y(e)n(v)o(eryone)d(o)n
(wns)i(the)g(process)g(together)f(and)g(by)h(o)n(wning)f(it,)h(the)o(y)
g(are)g(attached)f(to)i(it.)-2 4055 y
SDict begin H.S end
 -2 4055 a -2 4055
a
SDict begin 13 H.A end
 -2 4055 a -2 4055 a
SDict begin [/View [/XYZ H.V]/Dest (0:4698) cvn /DEST pdfmark end
 -2 4055 a 396 4365 a Fd(7.8.9.)36
b(The)d(Rolling)i(Stone)1745 4365 y
SDict begin H.S end
 1745 4365 a 1745
4365 a
SDict begin 18.72 H.A end
 1745 4365 a 1745 4365 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.105.2) cvn /DEST pdfmark
end
 1745 4365 a -2 4558 a
SDict begin H.S end

-2 4558 a -2 4558 a
SDict begin 13 H.A end
 -2 4558 a -2 4558 a
SDict begin [/View [/XYZ H.V]/Dest (0:4700) cvn /DEST pdfmark end
 -2 4558 a -2
4558 a
SDict begin H.S end
 -2 4558 a -2 4558 a
SDict begin 13 H.A end
 -2 4558 a -2 4558 a
SDict begin [/View [/XYZ H.V]/Dest (0:4701) cvn /DEST pdfmark end
 -2 4558
a 396 4639 a Fi(After)21 b(cr)l(ossing)f(a)h(river)-9
b(,)20 b(you)g(should)f(g)o(et)i(far)f(away)g(fr)l(om)h(it.)g
Fj(--)f(Sun)g(Tzu)-2 4822 y
SDict begin H.S end
 -2 4822 a -2 4822 a
SDict begin 13 H.A end
 -2 4822
a -2 4822 a
SDict begin [/View [/XYZ H.V]/Dest (0:4702) cvn /DEST pdfmark end
 -2 4822 a 396 4913 a Fj(The)g(Rolling)g(Stone)g(accepts)g
(his)h(o)n(wn)e(mortality)g(and)h(transience.)f(He)i(has)f(no)g
(attachment)f(to)h(his)h(past)f(w)o(ork.)g(He)396 5021
y(accepts)g(that)h(all)f(that)h(we)f(mak)o(e)g(is)h(destined)f(for)f
(the)h(trash)h(can,)e(it)i(is)g(just)g(a)g(matter)f(of)f(time.)i(W)m
(ith)f(precise,)p Black 3757 5569 a Fi(336)p Black eop
end
%%Page: 337 351
TeXDict begin 337 350 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.337) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 72 a Fj(minimal)g(in)m(v)o(estments,)e(he)j(can)f(mo)o(v)o(e)
e(rapidly)h(a)o(w)o(ay)h(from)f(the)h(past)h(and)f(stay)g(focused)f(on)
h(the)g(present)g(and)f(near)396 180 y(future.)g(Abo)o(v)o(e)g(all)h
(he)h(has)f(no)g(e)o(go)f(and)h(no)g(pride)f(to)h(be)g(hurt)g(by)g(the)
g(actions)g(of)g(others.)-2 209 y
SDict begin H.S end
 -2 209 a -2 209 a
SDict begin 13 H.A end
 -2
209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:4703) cvn /DEST pdfmark end
 -2 209 a 396 519 a Fd(7.8.10.)36 b(The)e(Pirate)f(Gang)
1711 519 y
SDict begin H.S end
 1711 519 a 1711 519 a
SDict begin 18.72 H.A end
 1711 519 a 1711 519
a
SDict begin [/View [/XYZ H.V]/Dest (12.81.106.2) cvn /DEST pdfmark
end
 1711 519 a -2 712 a
SDict begin H.S end
 -2 712 a -2 712 a
SDict begin 13 H.A end
 -2 712 a -2 712
a
SDict begin [/View [/XYZ H.V]/Dest (0:4705) cvn /DEST pdfmark end
 -2 712 a -2 712 a
SDict begin H.S end
 -2 712 a -2 712 a
SDict begin 13 H.A end
 -2 712 a -2 712
a
SDict begin [/View [/XYZ H.V]/Dest (0:4706) cvn /DEST pdfmark end
 -2 712 a 396 793 a Fi(Code)o(,)20 b(lik)o(e)h(all)f(knowledg)o(e)o(,)
f(works)i(best)g(as)g(collective)e(--)h(not)g(private)g(--)g(pr)l
(operty)-5 b(.)-2 976 y
SDict begin H.S end
 -2 976 a -2 976 a
SDict begin 13 H.A end
 -2 976 a -2
976 a
SDict begin [/View [/XYZ H.V]/Dest (0:4707) cvn /DEST pdfmark end
 -2 976 a 396 1067 a Fj(The)20 b(Pirate)h(Gang)e(or)o(ganizes)f
(freely)h(around)g(problems.)f(It)j(accepts)f(authority)e(insof)o(ar)i
(as)h(authority)d(pro)o(vides)396 1175 y(goals)i(and)g(resources.)f
(The)h(Pirate)g(Gang)g(o)n(wns)g(and)f(shares)i(all)f(it)h(mak)o(es:)f
(e)n(v)o(ery)f(w)o(ork)h(is)h(fully)e(remixable)g(by)396
1283 y(others)h(in)g(the)g(Pirate)h(Gang.)e(The)h(gang)f(mo)o(v)o(es)g
(rapidly)g(as)i(ne)n(w)f(problems)e(emer)o(ge,)h(and)g(is)j(quick)d(to)
h(abandon)e(old)396 1391 y(solutions)i(if)g(those)g(stop)h(being)e
(rele)n(v)n(ant.)g(No)h(persons)f(or)h(groups)f(can)h(monopolize)e(an)o
(y)h(part)h(of)g(the)g(supply)f(chain.)-2 1419 y
SDict begin H.S end
 -2 1419
a -2 1419 a
SDict begin 13 H.A end
 -2 1419 a -2 1419 a
SDict begin [/View [/XYZ H.V]/Dest (0:4708) cvn /DEST pdfmark end
 -2 1419 a 396 1729 a
Fd(7.8.11.)36 b(The)e(Flash)g(Mob)1632 1729 y
SDict begin H.S end
 1632 1729
a 1632 1729 a
SDict begin 18.72 H.A end
 1632 1729 a 1632 1729 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.107.2) cvn /DEST pdfmark
end
 1632 1729 a -2
1897 a
SDict begin H.S end
 -2 1897 a -2 1897 a
SDict begin 13 H.A end
 -2 1897 a -2 1897 a
SDict begin [/View [/XYZ H.V]/Dest (0:4710) cvn /DEST pdfmark end
 -2 1897
a -2 1897 a
SDict begin H.S end
 -2 1897 a -2 1897 a
SDict begin 13 H.A end
 -2 1897 a -2 1897 a
SDict begin [/View [/XYZ H.V]/Dest (0:4711) cvn /DEST pdfmark end
 -2
1897 a 396 2003 a Fi(W)-8 b(ater)21 b(shapes)f(its)h(cour)o(se)f(accor)
m(ding)f(to)h(the)g(natur)m(e)g(of)g(the)g(gr)l(ound)f(o)o(ver)i(whic)o
(h)f(it)g(\003ows.)h Fj(--)f(Sun)g(Tzu)-2 2186 y
SDict begin H.S end
 -2 2186
a -2 2186 a
SDict begin 13 H.A end
 -2 2186 a -2 2186 a
SDict begin [/View [/XYZ H.V]/Dest (0:4712) cvn /DEST pdfmark end
 -2 2186 a 396 2277 a
Fj(The)g(Flash)h(Mob)e(comes)h(together)f(in)h(space)h(and)e(time)i(as)
f(needed,)f(then)h(disperses)g(as)h(soon)e(as)i(the)o(y)f(can.)g
(Physical)396 2385 y(closeness)h(is)g(essential)f(for)g(high-bandwidth)
c(communications.)i(But)j(o)o(v)o(er)d(time)j(it)g(creates)f(technical)
f(ghettos,)396 2493 y(where)h(Earth)f(gets)i(separated)e(from)g(Sk)o(y)
-5 b(.)19 b(The)h(Flash)h(Mob)e(tends)h(to)h(collect)f(a)h(lot)f(of)g
(frequent)e(\003ier)j(miles.)-2 2521 y
SDict begin H.S end
 -2 2521 a -2 2521
a
SDict begin 13 H.A end
 -2 2521 a -2 2521 a
SDict begin [/View [/XYZ H.V]/Dest (0:4713) cvn /DEST pdfmark end
 -2 2521 a 396 2831 a Fd(7.8.12.)36
b(The)e(Canar)q(y)h(W)-5 b(atc)o(her)1946 2831 y
SDict begin H.S end
 1946
2831 a 1946 2831 a
SDict begin 18.72 H.A end
 1946 2831 a 1946 2831 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.108.2) cvn /DEST pdfmark
end
 1946 2831
a -2 3022 a
SDict begin H.S end
 -2 3022 a -2 3022 a
SDict begin 13 H.A end
 -2 3022 a -2 3022 a
SDict begin [/View [/XYZ H.V]/Dest (0:4715) cvn /DEST pdfmark end
 -2
3022 a -2 3022 a
SDict begin H.S end
 -2 3022 a -2 3022 a
SDict begin 13 H.A end
 -2 3022 a -2 3022
a
SDict begin [/View [/XYZ H.V]/Dest (0:4716) cvn /DEST pdfmark end
 -2 3022 a 396 3105 a Fi(P)e(ain)20 b(is)h(not,)f(g)o(ener)o(ally)-5
b(,)19 b(a)i(Good)e(Sign.)-2 3288 y
SDict begin H.S end
 -2 3288 a -2 3288
a
SDict begin 13 H.A end
 -2 3288 a -2 3288 a
SDict begin [/View [/XYZ H.V]/Dest (0:4717) cvn /DEST pdfmark end
 -2 3288 a 396 3379 a Fj(The)h(Canary)g(W)-7
b(atcher)20 b(measures)g(the)g(quality)f(of)h(an)g(or)o(ganization)d
(by)j(the)g(their)g(o)n(wn)g(pain)f(le)n(v)o(el,)h(and)g(the)396
3487 y(observ)o(ed)e(pain)i(le)n(v)o(els)g(of)g(those)g(he)g(w)o(orks)g
(with.)g(He)h(brings)e(ne)n(w)h(participants)f(into)h(e)o(xisting)g(or)
o(ganizations)d(so)396 3595 y(the)o(y)j(can)g(e)o(xpress)f(the)h(ra)o
(w)g(pain)g(of)g(the)g(innocent.)f(He)h(may)g(use)g(alcohol)g(to)g(get)
g(others)g(to)g(v)o(erbalize)f(their)h(pain)396 3703
y(points.)g(He)g(asks)h(others,)e(and)h(himself,)g("are)g(you)f(happ)o
(y)g(in)h(this)h(process,)e(and)h(if)g(not,)g(why)f(not?")h(When)g(an)
396 3811 y(or)o(ganization)d(causes)k(pain)e(in)i(himself)e(or)h
(others,)g(he)g(treats)g(that)h(as)g(a)f(problem)f(to)h(be)g(\002x)o
(ed.)g(People)f(should)g(feel)396 3919 y(jo)o(y)h(in)h(their)f(w)o
(ork.)-2 3947 y
SDict begin H.S end
 -2 3947 a -2 3947 a
SDict begin 13 H.A end
 -2 3947 a -2 3947
a
SDict begin [/View [/XYZ H.V]/Dest (0:4718) cvn /DEST pdfmark end
 -2 3947 a 396 4257 a Fd(7.8.13.)36 b(The)e(Hangman)1584
4257 y
SDict begin H.S end
 1584 4257 a 1584 4257 a
SDict begin 18.72 H.A end
 1584 4257 a 1584 4257
a
SDict begin [/View [/XYZ H.V]/Dest (12.81.109.2) cvn /DEST pdfmark
end
 1584 4257 a -2 4450 a
SDict begin H.S end
 -2 4450 a -2 4450 a
SDict begin 13 H.A end
 -2 4450 a
-2 4450 a
SDict begin [/View [/XYZ H.V]/Dest (0:4720) cvn /DEST pdfmark end
 -2 4450 a -2 4450 a
SDict begin H.S end
 -2 4450 a -2 4450 a
SDict begin 13 H.A end
 -2
4450 a -2 4450 a
SDict begin [/View [/XYZ H.V]/Dest (0:4721) cvn /DEST pdfmark end
 -2 4450 a 396 4531 a Fi(Ne)o(ver)21
b(interrupt)f(other)o(s)g(when)g(the)n(y)g(ar)m(e)g(making)g(mistak)o
(es.)-2 4714 y
SDict begin H.S end
 -2 4714 a -2 4714 a
SDict begin 13 H.A end
 -2 4714 a -2 4714
a
SDict begin [/View [/XYZ H.V]/Dest (0:4722) cvn /DEST pdfmark end
 -2 4714 a 396 4805 a Fj(The)g(Hangman)f(kno)n(ws)g(that)h(we)h(learn)
f(only)f(by)h(making)f(mistak)o(es,)h(and)g(he)g(gi)n(v)o(es)f(others)h
(copious)f(rope)g(with)396 4913 y(which)h(to)g(learn.)g(He)g(only)g
(pulls)g(the)g(rope)f(gently)-5 b(,)19 b(when)h(it')-5
b(s)21 b(time.)f(A)h(little)g(tug)f(to)g(remind)f(the)h(other)f(of)h
(their)396 5021 y(precarious)f(position.)g(Allo)n(wing)g(others)h(to)g
(learn)g(by)g(f)o(ailure)f(gi)n(v)o(es)h(the)g(good)f(reason)g(to)i
(stay)-5 b(,)20 b(and)f(the)i(bad)e(e)o(xcuse)396 5129
y(to)i(lea)n(v)o(e.)e(The)h(Hangman)f(is)i(endlessly)f(patient,)f
(because)h(there)f(is)j(no)d(shortcut)h(to)g(the)g(learning)f(process.)
-2 5158 y
SDict begin H.S end
 -2 5158 a -2 5158 a
SDict begin 13 H.A end
 -2 5158 a -2 5158 a
SDict begin [/View [/XYZ H.V]/Dest (0:4723) cvn /DEST pdfmark end
 -2
5158 a Black 3756 5569 a Fi(337)p Black eop end
%%Page: 338 352
TeXDict begin 338 351 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.338) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2769 -132 a Fi(Chapter)20 b(7.)g(The)h(\330MQ)f(Community)p
Black 396 77 a Fd(7.8.14.)36 b(The)e(Historian)1558 77
y
SDict begin H.S end
 1558 77 a 1558 77 a
SDict begin 18.72 H.A end
 1558 77 a 1558 77 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.110.2) cvn /DEST pdfmark
end
 1558 77 a -2
244 a
SDict begin H.S end
 -2 244 a -2 244 a
SDict begin 13 H.A end
 -2 244 a -2 244 a
SDict begin [/View [/XYZ H.V]/Dest (0:4725) cvn /DEST pdfmark end
 -2 244 a -2
244 a
SDict begin H.S end
 -2 244 a -2 244 a
SDict begin 13 H.A end
 -2 244 a -2 244 a
SDict begin [/View [/XYZ H.V]/Dest (0:4726) cvn /DEST pdfmark end
 -2 244 a 396
351 a Fi(K)m(eeping)20 b(the)g(public)f(r)m(ecor)m(d)h(may)g(be)g
(tedious,)g(b)n(ut)g(it')m(s)h(the)f(only)f(way)i(to)f(pr)m(e)o(vent)g
(collusion.)-2 534 y
SDict begin H.S end
 -2 534 a -2 534 a
SDict begin 13 H.A end
 -2 534 a -2 534
a
SDict begin [/View [/XYZ H.V]/Dest (0:4727) cvn /DEST pdfmark end
 -2 534 a 396 625 a Fj(The)g(Historian)g(forces)f(discussion)h(into)g
(the)g(public)g(vie)n(w)-5 b(,)19 b(to)h(pre)n(v)o(ent)f(collusion)g
(to)h(o)n(wn)g(areas)g(of)g(w)o(ork.)f(The)396 733 y(Pirate)i(Gang)e
(depends)g(on)h(full)g(and)g(equal)f(communications)f(that)i(do)g(not)g
(depend)e(on)i(momentary)e(presence.)396 840 y(No-one)h(really)h(reads)
g(the)g(archi)n(v)o(es,)f(b)n(ut)h(the)g(simply)g(possibility)g(stops)g
(most)g(ab)n(uses.)h(The)e(Historian)h(encourages)396
948 y(the)g(right)g(tool)g(for)g(the)g(job:)g(email)g(for)f(transient)h
(discussions,)g(IRC)h(for)f(chatter)m(,)f(wikis)h(for)g(kno)n(wledge,)e
(issue)396 1056 y(tracking)h(for)h(recording)e(opportunities.)-2
1085 y
SDict begin H.S end
 -2 1085 a -2 1085 a
SDict begin 13 H.A end
 -2 1085 a -2 1085 a
SDict begin [/View [/XYZ H.V]/Dest (0:4728) cvn /DEST pdfmark end
 -2 1085
a 396 1395 a Fd(7.8.15.)36 b(The)e(Pr)n(o)n(v)l(ocateur)1730
1395 y
SDict begin H.S end
 1730 1395 a 1730 1395 a
SDict begin 18.72 H.A end
 1730 1395 a 1730 1395
a
SDict begin [/View [/XYZ H.V]/Dest (12.81.111.2) cvn /DEST pdfmark
end
 1730 1395 a -2 1562 a
SDict begin H.S end
 -2 1562 a -2 1562 a
SDict begin 13 H.A end
 -2 1562 a
-2 1562 a
SDict begin [/View [/XYZ H.V]/Dest (0:4730) cvn /DEST pdfmark end
 -2 1562 a -2 1562 a
SDict begin H.S end
 -2 1562 a -2 1562 a
SDict begin 13 H.A end
 -2
1562 a -2 1562 a
SDict begin [/View [/XYZ H.V]/Dest (0:4731) cvn /DEST pdfmark end
 -2 1562 a 396 1669 a Fi(When)20 b(a)g(man)g(knows)g
(he)g(is)i(to)e(be)g(hang)o(ed)e(in)j(a)f(fortnight,)f(it)i(concentr)o
(ates)e(his)i(mind)e(wonderfully)-5 b(.)20 b Fj(--)g(Samuel)396
1777 y(Johnson)-2 1944 y
SDict begin H.S end
 -2 1944 a -2 1944 a
SDict begin 13 H.A end
 -2 1944
a -2 1944 a
SDict begin [/View [/XYZ H.V]/Dest (0:4732) cvn /DEST pdfmark end
 -2 1944 a 396 2051 a Fj(The)g(Pro)o(v)n(ocateur)e(creates)i
(deadlines,)f(enemies,)h(and)g(the)g(occasional)f(impossibility)-5
b(.)19 b(T)-6 b(eams)20 b(w)o(ork)g(best)g(when)396 2159
y(the)o(y)g(don')o(t)e(ha)n(v)o(e)i(time)g(for)g(the)g(crap.)f
(Deadlines)h(bring)f(people)g(together)g(and)h(focus)f(the)h(collecti)n
(v)o(e)g(mind.)f(An)396 2267 y(e)o(xternal)g(enemy)g(can)h(mo)o(v)o(e)f
(a)i(passi)n(v)o(e)e(team)i(into)f(action.)f(The)h(Pro)o(v)n(ocateur)e
(ne)n(v)o(er)h(tak)o(es)h(the)g(deadline)f(too)396 2374
y(seriously)-5 b(.)19 b(The)h(product)e(is)1233 2374
y
SDict begin H.S end
 1233 2374 a 1233 2374 a
SDict begin 13 H.A end
 1233 2374 a 1233 2374 a
SDict begin [/View [/XYZ H.V]/Dest (0:4733) cvn /DEST pdfmark end
 1233
2374 a Fi(always)i Fj(ready)f(to)h(ship.)g(But)h(he)f(gently)f(reminds)
h(the)g(team)g(of)g(the)g(stak)o(es:)h(f)o(ail,)f(and)g(we)396
2482 y(all)h(look)e(for)h(other)f(jobs.)-2 2511 y
SDict begin H.S end
 -2
2511 a -2 2511 a
SDict begin 13 H.A end
 -2 2511 a -2 2511 a
SDict begin [/View [/XYZ H.V]/Dest (0:4734) cvn /DEST pdfmark end
 -2 2511 a 396 2821
a Fd(7.8.16.)36 b(The)e(Mystic)1412 2821 y
SDict begin H.S end
 1412 2821
a 1412 2821 a
SDict begin 18.72 H.A end
 1412 2821 a 1412 2821 a
SDict begin [/View [/XYZ H.V]/Dest (12.81.112.2) cvn /DEST pdfmark
end
 1412 2821 a -2
3012 a
SDict begin H.S end
 -2 3012 a -2 3012 a
SDict begin 13 H.A end
 -2 3012 a -2 3012 a
SDict begin [/View [/XYZ H.V]/Dest (0:4736) cvn /DEST pdfmark end
 -2 3012
a -2 3012 a
SDict begin H.S end
 -2 3012 a -2 3012 a
SDict begin 13 H.A end
 -2 3012 a -2 3012 a
SDict begin [/View [/XYZ H.V]/Dest (0:4737) cvn /DEST pdfmark end
 -2
3012 a 396 3095 a Fi(When)20 b(people)f(ar)m(gue)h(or)g(complain,)f
(just)h(write)i(them)e(a)g(Sun)f(Tzu)i(quotation)d Fj(--)i(Mikk)o(o)g
(K)m(oppanen)-2 3279 y
SDict begin H.S end
 -2 3279 a -2 3279 a
SDict begin 13 H.A end
 -2 3279 a
-2 3279 a
SDict begin [/View [/XYZ H.V]/Dest (0:4738) cvn /DEST pdfmark end
 -2 3279 a 396 3369 a Fj(The)g(Mystic)h(ne)n(v)o(er)d(ar)o
(gues)h(directly)-5 b(.)19 b(He)i(kno)n(ws)e(that)h(to)h(ar)o(gue)d
(with)j(an)f(emotional)f(person)g(only)g(creates)h(more)396
3477 y(emotion.)f(Instead)g(he)i(side-steps)f(the)g(discussion.)f(It')
-5 b(s)21 b(hard)f(to)g(be)g(angry)f(at)i(a)f(Chinese)g(general,)f
(especially)h(when)396 3585 y(he)g(has)h(been)e(dead)h(for)f(2,400)g
(years.)h(The)f(Mystic)i(plays)f(Hangman)e(when)i(people)f(insist)i(on)
f(the)g(right)g(to)g(get)g(it)396 3693 y(wrong.)p Black
3759 5569 a Fi(338)p Black eop end
%%Page: 339 353
TeXDict begin 339 352 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.339) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:moving-pieces) cvn /DEST pdfmark
end
 -2 -11 a 126 x Fl(Chapter)48 b(8.)f(A)i(Univer)m(se)e(of)h(Mo)m(ving)
g(Pieces)3236 115 y
SDict begin H.S end
 3236 115 a 3236 115 a
SDict begin 26.957 H.A end
 3236 115 a
3236 115 a
SDict begin [/View [/XYZ H.V]/Dest (13.0) cvn /DEST pdfmark end
 3236 115 a -2 373 a
SDict begin H.S end
 -2 373 a -2 373 a
SDict begin 13 H.A end
 -2 373
a -2 373 a
SDict begin [/View [/XYZ H.V]/Dest (0:4741) cvn /DEST pdfmark end
 -2 373 a 396 443 a Fj(So)21 b(f)o(ar)f(in)g(this)h(book)e
(I')l(v)o(e)g(aimed)g(to)i(tak)o(e)f(you)f(though)g(a)h(journe)o(y)e
(of)i(understanding)d(\330MQ)k(in)f(its)h(man)o(y)e(aspects.)396
551 y(By)i(no)n(w)f(you)f(may)h(ha)n(v)o(e)f(started)h(to)h(b)n(uild)e
(your)g(o)n(wn)h(products)f(using)g(the)i(techniques)d(I)j(e)o
(xplained,)d(and)h(others)396 659 y(you')l(v)o(e)e(\002gured)i(out)g
(yourself.)f(Y)-9 b(ou)19 b(will)h(start)g(to)g(f)o(ace)f(questions)g
(about)f(to)i(mak)o(e)f(these)h(products)e(w)o(ork)h(in)g(the)h(real)
396 767 y(w)o(orld.)-2 933 y
SDict begin H.S end
 -2 933 a -2 933 a
SDict begin 13 H.A end
 -2 933
a -2 933 a
SDict begin [/View [/XYZ H.V]/Dest (0:4742) cvn /DEST pdfmark end
 -2 933 a 396 1041 a Fj(But)h(what)f(is)h(that)g("real)f(w)o
(orld"?)f(My)h(vie)n(w)g(is)h(that)g(it)f(is)i(becoming)c(a)i(w)o(orld)
g(of)g(e)n(v)o(er)f(increasing)g(numbers)g(of)396 1149
y(mo)o(ving)f(pieces.)i(Some)g(people)f(use)i(the)f(phrase)g(the)g
("Internet)f(of)g(Things",)g(suggesting)g(that)i(we')o(ll)f(see)h(a)g
(ne)n(w)396 1256 y(cate)o(gory)e(of)h(de)n(vices)f(that)h(are)h(more)e
(numerous)f(b)n(ut)i(rather)g(stupider)f(than)h(our)f(current)g(smart)h
(phones)f(and)h(tablets)396 1364 y(and)g(laptops)g(and)f(serv)o(ers.)h
(Ho)n(we)n(v)o(er)m(,)e(I)i(don')o(t)f(think)g(the)h(data)g(points)g
(this)h(w)o(ay)f(at)h(all.)f(Y)-8 b(es,)20 b(more)g(and)f(more)396
1472 y(de)n(vices,)h(b)n(ut)g(the)o(y')l(re)e(not)i(stupid)g(at)h(all.)
f(The)o(y')l(re)e(smart)j(and)e(po)n(werful)g(and)g(getting)h(more)f
(so)i(all)f(the)g(time.)-2 1656 y
SDict begin H.S end
 -2 1656 a -2 1656 a
SDict begin 13 H.A end

-2 1656 a -2 1656 a
SDict begin [/View [/XYZ H.V]/Dest (0:4743) cvn /DEST pdfmark end
 -2 1656 a 396 1746 a Fj(The)g(mechanism)f(at)i(w)o
(ork)e(is)i(something)e(I)h(call)h("Cost)g(Gra)n(vity")f(and)f(it)i
(has)g(the)f(ef)n(fect)f(of)h(cutting)g(the)g(cost)g(of)396
1854 y(technology)e(by)i(half)g(e)n(v)o(ery)e(18-24)h(months.)g(Or)m(,)
h(put)g(another)e(w)o(ay)-5 b(,)20 b(our)f(global)h(computing)d
(capacity)j(doubles)396 1962 y(e)n(v)o(ery)f(tw)o(o)i(years,)e(o)o(v)o
(er)g(and)h(o)o(v)o(er)e(and)i(o)o(v)o(er)-5 b(.)19 b(The)h(future)f
(is)i(\002lled)g(with)f(trillions)g(of)g(de)n(vices)g(that)g(are)g
(fully)396 2070 y(po)n(werful)f(multi-core)f(computers:)h(the)o(y)g
(don')o(t)g(run)g(some)h(cut-do)n(wn)f("operating)f(system)i(for)g
(things")f(b)n(ut)i(full)396 2178 y(operating)e(systems)h(and)g(full)g
(applications.)-2 2362 y
SDict begin H.S end
 -2 2362 a -2 2362 a
SDict begin 13 H.A end
 -2 2362
a -2 2362 a
SDict begin [/View [/XYZ H.V]/Dest (0:4744) cvn /DEST pdfmark end
 -2 2362 a 396 2452 a Fj(And)g(this)h(is)g(the)f(w)o(orld)g
(we')l(re)f(aiming)h(at)g(with)h(\330MQ.)f(When)g(we)g(talk)h(of)f
("scale")g(we)h(don')o(t)d(mean)i(hundreds)e(of)396 2560
y(computers,)h(or)h(e)n(v)o(en)f(thousands.)f(Think)h(of)h(clouds)g(of)
g(tin)o(y)f(smart)i(and)e(perhaps)g(self-replicating)g(machines)396
2668 y(surrounding)e(e)n(v)o(ery)i(person,)g(\002lling)h(e)n(v)o(ery)f
(space,)h(co)o(v)o(ering)e(e)n(v)o(ery)g(w)o(all,)j(\002lling)f(the)g
(cracks)g(and)g(e)n(v)o(entually)-5 b(,)396 2776 y(becoming)18
b(so)j(much)e(a)i(part)f(of)g(us)g(that)g(we)h(get)f(them)g(before)f
(birth)g(and)h(the)o(y)g(follo)n(w)f(us)i(to)f(death.)-2
2960 y
SDict begin H.S end
 -2 2960 a -2 2960 a
SDict begin 13 H.A end
 -2 2960 a -2 2960 a
SDict begin [/View [/XYZ H.V]/Dest (0:4745) cvn /DEST pdfmark end
 -2 2960
a 396 3050 a Fj(These)g(clouds)g(of)g(tin)o(y)f(machines)h(talk)g(to)g
(each)g(other)m(,)f(all)i(the)f(time,)g(o)o(v)o(er)f(short-range)f
(wireless)j(links,)f(using)f(the)396 3158 y(Internet)g(Protocol.)g(The)
o(y)g(create)h(mesh)g(netw)o(orks,)f(pass)i(information)d(and)h(tasks)i
(around)d(lik)o(e)j(nerv)n(ous)e(signals.)396 3266 y(The)o(y)g(augment)
g(our)g(memory)-5 b(,)18 b(vision,)i(e)n(v)o(ery)f(aspect)h(of)g(our)f
(communications,)f(and)h(physical)g(functions.)g(And)g(it')-5
b(s)396 3373 y(\330MQ)21 b(that)f(po)n(wers)f(their)h(con)m(v)o
(ersations)e(and)i(e)n(v)o(ents)f(and)h(e)o(xchanges)e(of)i(w)o(ork)g
(and)f(information.)-2 3558 y
SDict begin H.S end
 -2 3558 a -2 3558 a
SDict begin 13 H.A end
 -2
3558 a -2 3558 a
SDict begin [/View [/XYZ H.V]/Dest (0:4746) cvn /DEST pdfmark end
 -2 3558 a 396 3647 a Fj(No)n(w)-5 b(,)20
b(to)g(mak)o(e)g(e)n(v)o(en)f(a)i(thin)f(imitation)f(of)h(this)h(come)e
(true)h(today)-5 b(,)19 b(we)h(need)g(to)g(solv)o(e)g(a)h(set)g(of)e
(technical)h(problems)396 3755 y(\(ho)n(w)g(do)f(peers)h(disco)o(v)o
(er)f(each)h(other)m(,)e(ho)n(w)i(do)g(the)o(y)f(talk)i(to)f(e)o
(xisting)f(netw)o(orks)h(lik)o(e)g(the)g(W)-7 b(eb,)21
b(ho)n(w)f(do)f(the)o(y)396 3863 y(protect)h(the)g(information)e(the)o
(y)h(carry)-5 b(,)19 b(ho)n(w)g(do)h(we)h(track)e(and)h(monitor)f
(them,)g(to)i(get)f(some)g(idea)g(of)g(what)g(the)o(y')l(re)396
3971 y(doing\).)f(Then)g(we)h(need)g(to)g(do)g(what)g(most)g(engineers)
f(for)o(get)g(about:)g(package)g(this)i(solution)e(into)h(a)h(frame)n
(w)o(ork)396 4079 y(that)g(is)g(dead)e(easy)h(for)g(ordinary)e(de)n(v)o
(elopers)g(to)i(use.)-2 4263 y
SDict begin H.S end
 -2 4263 a -2 4263 a
SDict begin 13 H.A end
 -2
4263 a -2 4263 a
SDict begin [/View [/XYZ H.V]/Dest (0:4747) cvn /DEST pdfmark end
 -2 4263 a 396 4353 a Fj(This)h(is)g(what)f(we')o(ll)g
(attempt)g(in)h(this)f(chapter:)f(to)i(b)n(uild)f(a)g(frame)n(w)o(ork)e
(for)i(distrib)n(uted)f(applications,)g(as)i(an)f(API,)396
4461 y(protocols,)f(and)g(implementations.)f(It')-5 b(s)21
b(not)f(a)h(small)f(challenge)f(b)n(ut)i(I')l(v)o(e)e(claimed)g(often)g
(that)i(\330MQ)f(mak)o(es)g(such)396 4569 y(problems)f(simple,)h(so)h
(let')-5 b(s)21 b(see)f(if)h(that')-5 b(s)21 b(still)g(true.)-2
4753 y
SDict begin H.S end
 -2 4753 a -2 4753 a
SDict begin 13 H.A end
 -2 4753 a -2 4753 a
SDict begin [/View [/XYZ H.V]/Dest (0:4748) cvn /DEST pdfmark end
 -2 4753
a 396 4843 a Fj(W)-7 b(e')o(ll)22 b(co)o(v)o(er:)-2 4844
y
SDict begin H.S end
 -2 4844 a -2 4844 a
SDict begin 13 H.A end
 -2 4844 a -2 4844 a
SDict begin [/View [/XYZ H.V]/Dest (0:4749) cvn /DEST pdfmark end
 -2 4844 a -2
4854 a
SDict begin H.S end
 -2 4854 a -2 4854 a
SDict begin 13 H.A end
 -2 4854 a -2 4854 a
SDict begin [/View [/XYZ H.V]/Dest (0:4750) cvn /DEST pdfmark end
 -2 4854
a Black 396 5013 a Fe(\225)p Black 479 5013 a
SDict begin H.S end
 479 5013
a 479 5013 a
SDict begin 13 H.A end
 479 5013 a 479 5013 a
SDict begin [/View [/XYZ H.V]/Dest (0:4751) cvn /DEST pdfmark end
 479 5013 a Fj(Building)e(a)g(basic)h
(frame)n(w)o(ork)d(for)h(distrib)n(uted)h(computing.)-2
5031 y
SDict begin H.S end
 -2 5031 a -2 5031 a
SDict begin 13 H.A end
 -2 5031 a -2 5031 a
SDict begin [/View [/XYZ H.V]/Dest (0:4752) cvn /DEST pdfmark end
 -2 5031
a Black 3759 5569 a Fi(339)p Black eop end
%%Page: 340 354
TeXDict begin 340 353 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.340) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 94 a Fh(8.1.)39 b(Design)f(f)m(or)h(The)g
(Real)g(W)-9 b(orld)2059 94 y
SDict begin H.S end
 2059 94 a 2059 94 a
SDict begin 22.464 H.A end
 2059
94 a 2059 94 a
SDict begin [/View [/XYZ H.V]/Dest (13.82.1) cvn /DEST pdfmark end
 2059 94 a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2
292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:4754) cvn /DEST pdfmark end
 -2 292 a 396 368 a Fj(Whether)20 b(we')l(re)f
(connecting)f(a)j(roomful)d(of)i(mobile)g(de)n(vices)f(o)o(v)o(er)g(W)m
(iFi,)i(or)f(a)h(cluster)f(of)g(virtual)f(box)o(es)g(o)o(v)o(er)396
476 y(simulated)h(Ethernet,)f(we)h(will)h(hit)g(the)f(same)g(kinds)g
(of)g(problems.)e(These)i(are:)-2 494 y
SDict begin H.S end
 -2 494 a -2 494
a
SDict begin 13 H.A end
 -2 494 a -2 494 a
SDict begin [/View [/XYZ H.V]/Dest (0:4755) cvn /DEST pdfmark end
 -2 494 a -2 504 a
SDict begin H.S end
 -2 504 a -2 504
a
SDict begin 13 H.A end
 -2 504 a -2 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:4756) cvn /DEST pdfmark end
 -2 504 a Black 396 646 a Fe(\225)p
Black 479 646 a
SDict begin H.S end
 479 646 a 479 646 a
SDict begin 13 H.A end
 479 646 a 479 646
a
SDict begin [/View [/XYZ H.V]/Dest (0:4757) cvn /DEST pdfmark end
 479 646 a 479 646 a
SDict begin H.S end
 479 646 a 479 646 a
SDict begin 13 H.A end
 479 646 a 479
646 a
SDict begin [/View [/XYZ H.V]/Dest (0:4758) cvn /DEST pdfmark end
 479 646 a Fi(Disco)o(very)h Fj(-)f(ho)n(w)g(do)g(we)g(learn)g
(about)f(other)g(nodes)h(on)g(the)g(netw)o(ork?)f(Do)h(we)h(use)f(a)h
(disco)o(v)o(ery)d(service,)479 754 y(centralized)h(mediation,)g(or)h
(some)g(kind)f(of)h(broadcast)f(beacon?)-2 766 y
SDict begin H.S end
 -2 766
a -2 766 a
SDict begin 13 H.A end
 -2 766 a -2 766 a
SDict begin [/View [/XYZ H.V]/Dest (0:4759) cvn /DEST pdfmark end
 -2 766 a Black 396 904 a
Fe(\225)p Black 479 904 a
SDict begin H.S end
 479 904 a 479 904 a
SDict begin 13 H.A end
 479 904
a 479 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:4760) cvn /DEST pdfmark end
 479 904 a 479 904 a
SDict begin H.S end
 479 904 a 479 904 a
SDict begin 13 H.A end
 479
904 a 479 904 a
SDict begin [/View [/XYZ H.V]/Dest (0:4761) cvn /DEST pdfmark end
 479 904 a Fi(Pr)m(esence)h Fj(-)h(ho)n(w)e(do)h(we)h
(track)e(when)h(other)f(nodes)h(come)f(and)h(go?)g(Do)g(we)g(use)h
(some)f(kind)f(of)h(central)479 1012 y(re)o(gistration)f(service,)h(or)
f(heartbeating)g(or)h(beacons?)-2 1029 y
SDict begin H.S end
 -2 1029 a -2
1029 a
SDict begin 13 H.A end
 -2 1029 a -2 1029 a
SDict begin [/View [/XYZ H.V]/Dest (0:4762) cvn /DEST pdfmark end
 -2 1029 a Black 396 1161 a
Fe(\225)p Black 479 1161 a
SDict begin H.S end
 479 1161 a 479 1161 a
SDict begin 13 H.A end
 479
1161 a 479 1161 a
SDict begin [/View [/XYZ H.V]/Dest (0:4763) cvn /DEST pdfmark end
 479 1161 a 479 1161 a
SDict begin H.S end
 479 1161 a 479
1161 a
SDict begin 13 H.A end
 479 1161 a 479 1161 a
SDict begin [/View [/XYZ H.V]/Dest (0:4764) cvn /DEST pdfmark end
 479 1161 a Fi(Connectivity)g
Fj(-)g(ho)n(w)g(do)g(we)g(actually)g(connect)f(one)g(node)g(to)i
(another?)d(Do)j(we)f(use)h(local)f(netw)o(orking,)479
1269 y(wide-area)f(netw)o(orking,)f(or)i(do)g(we)g(use)h(a)f(central)g
(message)g(brok)o(er)f(to)h(do)g(the)g(forw)o(arding?)-2
1287 y
SDict begin H.S end
 -2 1287 a -2 1287 a
SDict begin 13 H.A end
 -2 1287 a -2 1287 a
SDict begin [/View [/XYZ H.V]/Dest (0:4765) cvn /DEST pdfmark end
 -2 1287
a Black 396 1418 a Fe(\225)p Black 479 1418 a
SDict begin H.S end
 479 1418
a 479 1418 a
SDict begin 13 H.A end
 479 1418 a 479 1418 a
SDict begin [/View [/XYZ H.V]/Dest (0:4766) cvn /DEST pdfmark end
 479 1418 a 479 1418
a
SDict begin H.S end
 479 1418 a 479 1418 a
SDict begin 13 H.A end
 479 1418 a 479 1418 a
SDict begin [/View [/XYZ H.V]/Dest (0:4767) cvn /DEST pdfmark end
 479 1418
a Fi(P)-7 b(oint-to-point)18 b(messa)o(ging)h Fj(-)i(ho)n(w)e(do)h(we)h
(send)f(a)g(message)g(from)f(one)h(node)f(to)i(another?)d(Do)i(we)h
(send)f(this)h(to)479 1526 y(the)f(node')-5 b(s)20 b(netw)o(ork)f
(address,)g(or)h(do)g(we)h(use)f(some)g(indirect)g(addressing)e(via)j
(a)f(centralized)f(message)h(brok)o(er?)-2 1544 y
SDict begin H.S end
 -2
1544 a -2 1544 a
SDict begin 13 H.A end
 -2 1544 a -2 1544 a
SDict begin [/View [/XYZ H.V]/Dest (0:4768) cvn /DEST pdfmark end
 -2 1544 a Black
396 1676 a Fe(\225)p Black 479 1676 a
SDict begin H.S end
 479 1676 a 479
1676 a
SDict begin 13 H.A end
 479 1676 a 479 1676 a
SDict begin [/View [/XYZ H.V]/Dest (0:4769) cvn /DEST pdfmark end
 479 1676 a 479 1676 a
SDict begin H.S end
 479
1676 a 479 1676 a
SDict begin 13 H.A end
 479 1676 a 479 1676 a
SDict begin [/View [/XYZ H.V]/Dest (0:4770) cvn /DEST pdfmark end
 479 1676 a Fi(Gr)l(oup)g(messa)
o(ging)g Fj(-)g(ho)n(w)g(do)f(we)i(send)f(a)g(message)g(from)g(one)f
(node)g(to)i(a)f(group)f(of)h(others?)f(Do)h(we)h(w)o(ork)f(via)479
1784 y(centralized)f(message)h(brok)o(er)m(,)e(or)i(do)g(we)h(use)f(a)h
(publish-subscribe)c(model)i(lik)o(e)i(\330MQ?)-2 1802
y
SDict begin H.S end
 -2 1802 a -2 1802 a
SDict begin 13 H.A end
 -2 1802 a -2 1802 a
SDict begin [/View [/XYZ H.V]/Dest (0:4771) cvn /DEST pdfmark end
 -2 1802 a Black
396 1933 a Fe(\225)p Black 479 1933 a
SDict begin H.S end
 479 1933 a 479
1933 a
SDict begin 13 H.A end
 479 1933 a 479 1933 a
SDict begin [/View [/XYZ H.V]/Dest (0:4772) cvn /DEST pdfmark end
 479 1933 a 479 1933 a
SDict begin H.S end
 479
1933 a 479 1933 a
SDict begin 13 H.A end
 479 1933 a 479 1933 a
SDict begin [/View [/XYZ H.V]/Dest (0:4773) cvn /DEST pdfmark end
 479 1933 a Fi(T)-8
b(esting)21 b(and)e(simulation)h Fj(-)g(ho)n(w)g(do)f(we)i(simulate)f
(lar)o(ge)f(numbers)g(of)h(nodes)f(so)i(we)f(can)g(test)h(performance)
479 2041 y(properly?)d(Do)i(we)h(ha)n(v)o(e)f(to)g(b)n(uy)g(tw)o(o)g
(dozen)f(Android)f(tablets,)j(or)f(can)g(we)g(use)h(pure)e(softw)o(are)
h(simulation?)-2 2059 y
SDict begin H.S end
 -2 2059 a -2 2059 a
SDict begin 13 H.A end
 -2 2059 a
-2 2059 a
SDict begin [/View [/XYZ H.V]/Dest (0:4774) cvn /DEST pdfmark end
 -2 2059 a Black 396 2190 a Fe(\225)p Black
479 2190 a
SDict begin H.S end
 479 2190 a 479 2190 a
SDict begin 13 H.A end
 479 2190 a 479 2190
a
SDict begin [/View [/XYZ H.V]/Dest (0:4775) cvn /DEST pdfmark end
 479 2190 a 479 2190 a
SDict begin H.S end
 479 2190 a 479 2190 a
SDict begin 13 H.A end
 479 2190
a 479 2190 a
SDict begin [/View [/XYZ H.V]/Dest (0:4776) cvn /DEST pdfmark end
 479 2190 a Fi(Distrib)n(uted)g(Lo)o(g)o(ging)e
Fj(-)i(ho)n(w)f(do)g(we)h(track)f(what)g(this)h(cloud)f(of)g(nodes)g
(is)h(doing)e(so)i(we)g(can)f(detect)h(performance)479
2298 y(problems)f(and)h(f)o(ailures?)f(Do)i(we)f(create)g(a)h(main)f
(logging)e(service,)i(or)g(do)f(we)i(allo)n(w)f(e)n(v)o(ery)f(de)n
(vice)g(to)i(log)e(the)479 2406 y(w)o(orld)h(around)e(it?)-2
2407 y
SDict begin H.S end
 -2 2407 a -2 2407 a
SDict begin 13 H.A end
 -2 2407 a -2 2407 a
SDict begin [/View [/XYZ H.V]/Dest (0:4777) cvn /DEST pdfmark end
 -2 2407
a Black 396 2556 a Fe(\225)p Black 479 2556 a
SDict begin H.S end
 479 2556
a 479 2556 a
SDict begin 13 H.A end
 479 2556 a 479 2556 a
SDict begin [/View [/XYZ H.V]/Dest (0:4778) cvn /DEST pdfmark end
 479 2556 a 479 2556
a
SDict begin H.S end
 479 2556 a 479 2556 a
SDict begin 13 H.A end
 479 2556 a 479 2556 a
SDict begin [/View [/XYZ H.V]/Dest (0:4779) cvn /DEST pdfmark end
 479 2556
a Fi(F)l(ile)j(tr)o(ansfer)h Fj(-)f(ho)n(w)e(do)h(we)h(send)f(\002les)h
(from)e(one)h(node)f(to)h(another?)f(Do)h(we)h(use)f(serv)o(er)n
(-centric)e(protocols)h(lik)o(e)479 2664 y(FTP)i(or)f(HTTP)-9
b(,)20 b(or)g(do)g(we)g(use)h(decentralized)d(protocols)h(lik)o(e)h
(FILEMQ?)-2 2682 y
SDict begin H.S end
 -2 2682 a -2 2682 a
SDict begin 13 H.A end
 -2 2682 a -2 2682
a
SDict begin [/View [/XYZ H.V]/Dest (0:4780) cvn /DEST pdfmark end
 -2 2682 a Black 396 2813 a Fe(\225)p Black 479 2813
a
SDict begin H.S end
 479 2813 a 479 2813 a
SDict begin 13 H.A end
 479 2813 a 479 2813 a
SDict begin [/View [/XYZ H.V]/Dest (0:4781) cvn /DEST pdfmark end
 479 2813
a 479 2813 a
SDict begin H.S end
 479 2813 a 479 2813 a
SDict begin 13 H.A end
 479 2813 a 479 2813
a
SDict begin [/View [/XYZ H.V]/Dest (0:4782) cvn /DEST pdfmark end
 479 2813 a Fi(State)g(sync)o(hr)l(onization)e Fj(-)j(ho)n(w)e(do)h
(we)h(ensure)e(that)h(man)o(y)f(nodes)h(recei)n(v)o(e)f(the)h(same)h
(unique)d(stream)i(of)g(e)n(v)o(ents?)479 2921 y(Do)g(we)h(send)f(e)n
(v)o(ents)g(via)g(single)g(central)f(point,)h(or)g(do)f(we)i(use)f(a)h
(distrib)n(uted)e(e)n(v)o(entually)g(consistent)g(model?)-2
2939 y
SDict begin H.S end
 -2 2939 a -2 2939 a
SDict begin 13 H.A end
 -2 2939 a -2 2939 a
SDict begin [/View [/XYZ H.V]/Dest (0:4783) cvn /DEST pdfmark end
 -2 2939
a Black 396 3070 a Fe(\225)p Black 479 3070 a
SDict begin H.S end
 479 3070
a 479 3070 a
SDict begin 13 H.A end
 479 3070 a 479 3070 a
SDict begin [/View [/XYZ H.V]/Dest (0:4784) cvn /DEST pdfmark end
 479 3070 a 479 3070
a
SDict begin H.S end
 479 3070 a 479 3070 a
SDict begin 13 H.A end
 479 3070 a 479 3070 a
SDict begin [/View [/XYZ H.V]/Dest (0:4785) cvn /DEST pdfmark end
 479 3070
a Fi(Security)h Fj(-)h(ho)n(w)e(do)h(we)g(protect)g(the)g
(con\002dentiality)e(of)i(information,)e(and)i(mak)o(e)f(sure)h(people)
f(are)i(who)e(the)o(y)479 3178 y(claim)i(to)f(be?)g(Do)g(we)h(use)f(a)h
(centralised)e(trust)h(netw)o(ork,)f(or)h(do)g(we)g(use)h(use)f(some)g
(kind)g(of)g(distrib)n(uted)f(k)o(e)o(y)479 3286 y(management?)-2
3304 y
SDict begin H.S end
 -2 3304 a -2 3304 a
SDict begin 13 H.A end
 -2 3304 a -2 3304 a
SDict begin [/View [/XYZ H.V]/Dest (0:4786) cvn /DEST pdfmark end
 -2 3304
a Black 396 3436 a Fe(\225)p Black 479 3436 a
SDict begin H.S end
 479 3436
a 479 3436 a
SDict begin 13 H.A end
 479 3436 a 479 3436 a
SDict begin [/View [/XYZ H.V]/Dest (0:4787) cvn /DEST pdfmark end
 479 3436 a 479 3436
a
SDict begin H.S end
 479 3436 a 479 3436 a
SDict begin 13 H.A end
 479 3436 a 479 3436 a
SDict begin [/View [/XYZ H.V]/Dest (0:4788) cvn /DEST pdfmark end
 479 3436
a Fi(Bridging)g Fj(-)i(ho)n(w)e(do)h(we)h(connect)e(our)g(netw)o(orks)g
(across)i(the)f(Internet?)f(Do)h(we)g(use)h(the)f(cloud)f(as)i(our)f
(central)479 3544 y(point)g(for)f(all)i(messaging)e(or)h(do)g(we)h
(create)f(bridges)f(that)h(join)g(groups)f(to)h(other)f(groups?)-2
3728 y
SDict begin H.S end
 -2 3728 a -2 3728 a
SDict begin 13 H.A end
 -2 3728 a -2 3728 a
SDict begin [/View [/XYZ H.V]/Dest (0:4789) cvn /DEST pdfmark end
 -2 3728
a 396 3818 a Fj(If)h(we)h(can)f(solv)o(e)g(these)g(dozen)f(problems)g
(reasonably)f(well,)j(we)f(get)g(something)f(lik)o(e)i(a)f(frame)n(w)o
(ork)e(for)i(what)g(I)396 3926 y(might)g(call)g("Really)h(Cool)f
(Distrib)n(uted)g(Applications",)e(or)i(as)h(my)f(grandkids)e(call)j
(it,)g("the)f(softw)o(are)f(our)h(w)o(orld)396 4034 y(runs)g(on".)-2
4200 y
SDict begin H.S end
 -2 4200 a -2 4200 a
SDict begin 13 H.A end
 -2 4200 a -2 4200 a
SDict begin [/View [/XYZ H.V]/Dest (0:4790) cvn /DEST pdfmark end
 -2 4200
a 396 4307 a Fj(Y)-9 b(ou)20 b(should)f(ha)n(v)o(e)h(guessed)f(from)g
(my)h(rhetorical)f(questions)h(that)g(there)g(are)g(tw)o(o)g(broad)f
(directions)g(we)i(can)f(go.)396 4415 y(One)g(is)g(to)g(centralize)e(e)
n(v)o(erything.)f(The)i(other)g(is)h(to)g(distrib)n(ute)f(e)n(v)o
(erything.)d(I'm)j(going)f(to)i(bet)f(on)g(decentralization.)396
4523 y(If)h(you)g(w)o(ant)g(centralization,)e(you)i(don')o(t)e(really)i
(need)f(\330MQ;)i(there)f(are)g(other)f(options)g(you)h(can)g(use.)-2
4707 y
SDict begin H.S end
 -2 4707 a -2 4707 a
SDict begin 13 H.A end
 -2 4707 a -2 4707 a
SDict begin [/View [/XYZ H.V]/Dest (0:4791) cvn /DEST pdfmark end
 -2 4707
a 396 4797 a Fj(So)h(v)o(ery)e(roughly)-5 b(,)17 b(here')-5
b(s)20 b(the)g(story)-5 b(.)20 b(One,)f(the)i(number)d(of)i(mo)o(ving)e
(pieces)i(increases)g(e)o(xponentially)e(o)o(v)o(er)h(time)396
4905 y(\(doubles)g(e)n(v)o(ery)g(24)h(months\).)e(T)-7
b(w)o(o,)20 b(these)h(pieces)f(stop)g(using)g(wires)g(since)h(dragging)
d(cables)i(e)n(v)o(erywhere)e(gets)396 5013 y
SDict begin H.S end
 396 5013
a 396 5013 a
SDict begin 13 H.A end
 396 5013 a 396 5013 a
SDict begin [/View [/XYZ H.V]/Dest (0:4792) cvn /DEST pdfmark end
 396 5013 a Fi(r)m(eally)j
Fj(boring.)d(Three,)h(future)g(applications)g(run)g(across)i(clusters)f
(of)g(these)g(pieces)h(using)e(the)h(Bene)n(v)n(olent)g(T)-7
b(yrant)396 5121 y(pattern)20 b(from)f(The)h(\330MQ)g(Community)p
0 TeXcolorgray 1593 5121 a
SDict begin H.S end
 1593 5121 a Fj(Chapter)d(7)1916
5121 y
SDict begin 13 H.L end
 1916 5121 a 1916 5121 a
SDict begin [/Subtype /Link/Dest (0:the-community) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1916 5121 a Black Fj(.)j(F)o(our)m(,)f
(today)g(it')-5 b(s)22 b(really)d(dif)n(\002cult,)h(nay)f(still)j
(rather)d(impossible,)p Black 3759 5569 a Fi(340)p Black
eop end
%%Page: 341 355
TeXDict begin 341 354 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.341) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:4803) cvn /DEST pdfmark end
 -2 -201 a 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)
o(ving)g(Pieces)p Black 396 72 a Fj(to)h(b)n(uild)e(such)h
(applications.)f(Fi)n(v)o(e,)h(let')-5 b(s)21 b(mak)o(e)f(it)h(cheap)e
(and)h(easy)g(using)g(all)g(the)h(techniques)d(and)i(tools)g(we')l(v)o
(e)396 180 y(b)n(uilt)h(up.)e(Six,)h(partay!)-2 209 y
SDict begin H.S end

-2 209 a -2 209 a
SDict begin 13 H.A end
 -2 209 a -2 209 a
SDict begin [/View [/XYZ H.V]/Dest (0:4794) cvn /DEST pdfmark end
 -2 209 a 359 x Fh(8.2.)39
b(The)g(Secret)f(Lif)o(e)h(of)g(WiFi)1822 568 y
SDict begin H.S end
 1822
568 a 1822 568 a
SDict begin 22.464 H.A end
 1822 568 a 1822 568 a
SDict begin [/View [/XYZ H.V]/Dest (13.83.1) cvn /DEST pdfmark end
 1822 568 a -2
736 a
SDict begin H.S end
 -2 736 a -2 736 a
SDict begin 13 H.A end
 -2 736 a -2 736 a
SDict begin [/View [/XYZ H.V]/Dest (0:4796) cvn /DEST pdfmark end
 -2 736 a 396
842 a Fj(The)20 b(future)f(is)i(clearly)f(wireless,)g(and)g(while)g
(man)o(y)f(big)h(b)n(usinesses)h(li)n(v)o(e)f(by)g(concentrating)d
(data)j(in)h(their)f(clouds,)396 950 y(the)g(future)f(doesn')o(t)g
(look)h(quite)f(so)i(centralized.)e(The)g(de)n(vices)h(at)h(the)f
(edges)g(of)g(our)f(netw)o(orks)g(get)i(smarter)e(e)n(v)o(ery)396
1058 y(year)m(,)g(not)h(dumber)-5 b(.)19 b(The)o(y')l(re)f(hungry)g
(for)h(w)o(ork)h(and)g(information)d(to)k(digest)f(and)f(pro\002t)h
(from.)f(And)h(the)o(y)f(don')o(t)396 1166 y(drag)h(cables)g(around,)e
(e)o(xcept)h(once)h(a)g(night)g(for)f(po)n(wer)-5 b(.)19
b(It')-5 b(s)21 b(all)g(wireless,)g(and)e(more)h(and)f(more,)g
(802.11-branded)396 1274 y(W)m(iFi)i(of)f(dif)n(ferent)f(alphabetical)g
(\003a)n(v)n(ors.)-2 1292 y
SDict begin H.S end
 -2 1292 a -2 1292 a
SDict begin 13 H.A end
 -2 1292
a -2 1292 a
SDict begin [/View [/XYZ H.V]/Dest (0:4797) cvn /DEST pdfmark end
 -2 1292 a 396 1602 a Fd(8.2.1.)36 b(Wh)n(y)d(Mesh)h(isn't)g
(Here)g(Y)-10 b(et)2105 1602 y
SDict begin H.S end
 2105 1602 a 2105 1602
a
SDict begin 18.72 H.A end
 2105 1602 a 2105 1602 a
SDict begin [/View [/XYZ H.V]/Dest (13.83.113.2) cvn /DEST pdfmark
end
 2105 1602 a -2 1792 a
SDict begin H.S end
 -2 1792
a -2 1792 a
SDict begin 13 H.A end
 -2 1792 a -2 1792 a
SDict begin [/View [/XYZ H.V]/Dest (0:4799) cvn /DEST pdfmark end
 -2 1792 a 396 1876 a
Fj(As)21 b(such)f(a)h(vital)f(part)g(of)g(our)f(future,)g(W)m(iFi)i
(has)g(a)f(big)g(problem)f(that')-5 b(s)20 b(not)g(often)f(discussed)h
(b)n(ut)h(which)e(an)o(yone)396 1984 y(betting)h(on)f(it)i(needs)f(to)g
(be)h(a)o(w)o(are)e(of.)h(The)g(phone)f(companies)f(of)i(the)h(w)o
(orld)e(ha)n(v)o(e)h(b)n(uilt)g(themselv)o(es)g(nice)396
2092 y(pro\002table)f(mobile)h(phone)e(cartels)j(in)f(nearly)f(e)n(v)o
(ery)g(country)g(with)h(a)g(functioning)e(go)o(v)o(ernment,)f(based)i
(on)396 2199 y(con)m(vincing)f(go)o(v)o(ernments)f(that)j(without)g
(monopoly)d(rights)j(to)g(airw)o(a)n(v)o(es)g(and)g(ideas,)g(the)g(w)o
(orld)g(w)o(ould)f(f)o(all)i(apart.)396 2307 y(T)-6 b(echnically)h(,)19
b(we)h(call)h(this)f("re)o(gulatory)e(capture")h(and)h("patents",)f(b)n
(ut)h(in)h(f)o(act)f(it')-5 b(s)21 b(just)g(a)g(form)e(of)h(blackmail)f
(and)396 2415 y(corruption.)f(If)i(you,)f(the)h(state,)h(gi)n(v)o(e)e
(me,)h(a)h(b)n(usiness,)f(the)g(right)g(to)g(o)o(v)o(erchar)o(ge)d(and)
i(tax)h(the)h(mark)o(et,)e(and)g(ban)h(all)396 2523 y(real)g
(competitors,)f(I')o(ll)h(gi)n(v)o(e)g(you)f(5\045.)h(Not)h(enough?)d
(Ho)n(w)i(about)f(10\045?)h(OK,)g(15\045)g(plus)g(snacks.)g(If)g(you)f
(refuse,)396 2631 y(we)i(pull)f(service.)-2 2815 y
SDict begin H.S end
 -2
2815 a -2 2815 a
SDict begin 13 H.A end
 -2 2815 a -2 2815 a
SDict begin [/View [/XYZ H.V]/Dest (0:4800) cvn /DEST pdfmark end
 -2 2815 a 396 2905
a Fj(But)h(W)m(iFi)g(snuck)f(past)g(this,)h(borro)n(wing)c(unlicensed)i
(airspace)h(and)f(riding)g(on)h(the)g(back)g(of)g(the)g(open)f(and)396
3013 y(unpatented)f(and)i(remarkably)e(inno)o(v)n(ati)n(v)o(e)f
(Internet)i(protocol)g(stack.)h(So)g(today)g(we)g(ha)n(v)o(e)g(the)g
(curious)f(situation)396 3121 y(where)h(it)h(costs)g(me)f(se)n(v)o
(eral)f(Euro)g(a)i(minute)e(to)i(call)f(from)g(Seoul)f(to)i(Brussels)g
(if)f(I)h(use)f(the)g(state-back)o(ed)396 3229 y(infrastructure)e(that)
j(we')l(v)o(e)e(subsidized)g(o)o(v)o(er)g(decades,)g(b)n(ut)h(nothing)f
(at)h(all)h(if)g(I)f(can)g(\002nd)g(an)g(unre)o(gulated)e(W)m(iFi)396
3337 y(access)i(point.)f(Oh,)g(and)g(I)g(can)h(do)f(video,)f(and)h
(send)g(\002les,)h(and)f(photos,)f(and)h(do)n(wnload)e(entire)i(home)g
(mo)o(vies)f(all)i(for)396 3445 y(the)g(same)h(amazing)e(price)g(point)
h(of)g(precisely)f(zero)h(point)f(zero)h(zero)g(\(in)g(an)o(y)f
(currenc)o(y)f(you)h(lik)o(e\).)h(God)g(help)f(me)h(if)396
3553 y(I)h(try)f(to)g(send)g(just)h(one)e(photo)g(home)g(using)h(the)g
(service)g(I)h(actually)e(pay)h(for)-5 b(.)20 b(That)f(w)o(ould)h(cost)
g(me)h(more)e(than)h(the)396 3661 y(camera)g(I)g(took)f(it)i(on.)-2
3828 y
SDict begin H.S end
 -2 3828 a -2 3828 a
SDict begin 13 H.A end
 -2 3828 a -2 3828 a
SDict begin [/View [/XYZ H.V]/Dest (0:4801) cvn /DEST pdfmark end
 -2 3828
a 396 3935 a Fj(It)g(is)g(the)f(price)g(we)g(pay)g(for)g(ha)n(ving)f
(tolerated)g(the)h("trust)g(us,)h(we')l(re)e(the)h(e)o(xperts")g
(patent)f(system)i(for)e(so)i(long.)e(But)396 4043 y(more)h(than)f
(that,)h(it')-5 b(s)22 b(a)e(massi)n(v)o(e)g(economic)f(incenti)n(v)o
(e)g(to)h(chunks)f(of)h(the)g(technology)e(sector)i(--)g(and)f
(especially)396 4150 y(chipset)h(mak)o(ers)f(who)h(o)n(wn)f(patents)h
(on)f(the)h(anti-Internet)e(GSM,)i(GPRS,)h(3G,)f(and)f(L)-8
b(TE)20 b(stacks,)g(and)f(who)h(treat)g(the)396 4258
y(telcos)h(as)g(prime)e(clients)i(--)f(to)g(acti)n(v)o(ely)f(throttle)h
(W)m(iFi)h(de)n(v)o(elopment.)c(And)j(of)g(course)f(it')-5
b(s)21 b(these)g(\002rms)f(that)h(b)n(ulk)396 4366 y(out)f(the)g(IEEE)g
(committees)f(that)i(de\002ne)e(W)m(iFi.)-2 4533 y
SDict begin H.S end
 -2
4533 a -2 4533 a
SDict begin 13 H.A end
 -2 4533 a -2 4533 a
SDict begin [/View [/XYZ H.V]/Dest (0:4802) cvn /DEST pdfmark end
 -2 4533 a 396 4640
a Fj(The)h(reason)g(for)f(this)i(rant)f(against)f(la)o(wyer)n(-dri)n(v)
o(en)e("inno)o(v)n(ation")h(is)j(to)f(steer)h(your)e(thinking)f(into)i
("what)g(if)h(W)m(iFi)396 4748 y(w)o(as)g(really)f(free?")g(Because)g
(this)h(will)g(happen)d(one)i(day)-5 b(,)19 b(not)h(too)f(f)o(ar)i(of)n
(f,)e(and)g(it')-5 b(s)22 b(w)o(orth)d(betting)h(on.)f(W)-7
b(e')o(ll)22 b(see)396 4856 y(se)n(v)o(eral)e(things)g(happen.)e
(First,)j(much)e(more)g(aggressi)n(v)o(e)g(use)h(of)g(airspace)g
(especially)g(for)f(near)n(-distance)396 4964 y(communications)f(where)
h(there)h(is)h(no)f(risk)g(of)g(interference.)e(Secondly)-5
b(,)18 b(big)i(capacity)g(impro)o(v)o(ements)d(as)k(we)f(learn)p
Black 3759 5569 a Fi(341)p Black eop end
%%Page: 342 356
TeXDict begin 342 355 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.342) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 72 a Fj(to)h(use)f(more)f(airspace)h(in)g
(parallel.)g(Thirdly)-5 b(,)18 b(acceleration)h(of)h(the)g
(standardization)e(process.)i(Lastly)-5 b(,)19 b(broader)396
180 y(support)g(in)h(de)n(vices)g(for)g(really)f(interesting)h
(connecti)n(vity)-5 b(.)396 454 y(Right)21 b(no)n(w)e(streaming)g(a)i
(mo)o(vie)e(from)g(your)g(phone)g(to)h(your)f(TV)i(is)g(considered)d
("leading)h(edge".)g(This)i(is)396 562 y(ridiculous.)e(Let')-5
b(s)21 b(get)f(truly)f(ambitious.)g(Ho)n(w)i(about)e(a)h(stadium)g(of)g
(people)f(w)o(atching)g(a)i(game,)e(sharing)g(photos)396
670 y(and)h(HD)h(video)e(with)h(each)g(other)f(in)i(real)f(time,)g
(creating)f(an)h(ad-hoc)f(e)n(v)o(ent)g(that)i(literally)f(saturates)g
(the)g(airspace)396 778 y(with)h(a)f(digital)g(frenzy)-5
b(.)18 b(I)j(should)e(be)h(able)g(to)g(collect)h(terabytes)e(of)h
(imagery)f(from)g(those)h(around)e(me,)i(in)h(an)f(hour)-5
b(.)396 886 y(Why)20 b(does)g(this)h(ha)n(v)o(e)e(to)i(go)e(through)f
(T)-7 b(witter)21 b(or)f(F)o(acebook)e(and)i(that)g(tin)o(y)g(e)o
(xpensi)n(v)o(e)e(mobile)h(data)h(connection?)396 994
y(Ho)n(w)g(about)g(a)g(home)f(with)i(hundreds)d(of)i(de)n(vices)f(all)i
(talking)f(to)g(each)g(other)f(o)o(v)o(er)g(mesh,)h(so)g(when)g
(someone)f(rings)396 1102 y(the)h(doorbell,)d(the)j(porch)e(lights)i
(stream)f(video)g(through)e(to)j(your)e(phone)g(or)h(TV?)h(Ho)n(w)f
(about)g(a)h(car)f(that)h(can)f(talk)h(to)396 1210 y(your)f(phone)g
(and)g(play)h(your)f(dubstep)g(playlist)h Fi(without)g(you)g(plug)o
(ging)e(in)i(wir)m(es)p Fj(.)-2 1394 y
SDict begin H.S end
 -2 1394 a -2 1394
a
SDict begin 13 H.A end
 -2 1394 a -2 1394 a
SDict begin [/View [/XYZ H.V]/Dest (0:4805) cvn /DEST pdfmark end
 -2 1394 a 396 1484 a Fj(Why)-5
b(,)19 b(in)i(2012,)d(and)i(to)g(get)g(more)g(serious,)g(is)h(our)e
(digital)h(society)g(in)g(the)h(hands)e(of)h(central)g(points)f(that)i
(are)396 1592 y(monitored,)d(censored,)h(logged,)f(used)i(to)g(track)g
(who)g(we)g(talk)h(to,)f(collect)g(e)n(vidence)f(against)g(us,)h(and)g
(then)g(shut)396 1700 y(do)n(wn)f(when)h(the)g(authorities)f(decide)h
(we)g(ha)n(v)o(e)g(too)g(much)f(free)h(speech?)f(The)h(loss)h(of)f(pri)
n(v)n(ac)o(y)e(we')l(re)i(li)n(ving)396 1808 y(through)e(is)i(only)f(a)
h(problem)e(when)h(it')-5 b(s)21 b(one-sided,)d(b)n(ut)i(then)f(the)g
(problem)f(is)j(calamitous.)e(A)h(truly)f(wireless)h(w)o(orld)396
1916 y(w)o(ould)g(bypass)f(all)i(central)f(censorship.)f(It')-5
b(s)20 b(ho)n(w)g(the)g(Internet)f(w)o(as)i(designed,)e(and)g(it')-5
b(s)22 b(quite)e(feasible.)396 2023 y(T)-6 b(echnically)h(.)-2
2052 y
SDict begin H.S end
 -2 2052 a -2 2052 a
SDict begin 13 H.A end
 -2 2052 a -2 2052 a
SDict begin [/View [/XYZ H.V]/Dest (0:4806) cvn /DEST pdfmark end
 -2 2052
a 396 2362 a Fd(8.2.2.)36 b(Some)d(Ph)n(ysics)1535 2362
y
SDict begin H.S end
 1535 2362 a 1535 2362 a
SDict begin 18.72 H.A end
 1535 2362 a 1535 2362 a
SDict begin [/View [/XYZ H.V]/Dest (13.83.114.2) cvn /DEST pdfmark
end
 1535
2362 a -2 2553 a
SDict begin H.S end
 -2 2553 a -2 2553 a
SDict begin 13 H.A end
 -2 2553 a -2 2553
a
SDict begin [/View [/XYZ H.V]/Dest (0:4808) cvn /DEST pdfmark end
 -2 2553 a 396 2636 a Fj(Nai)n(v)o(e)20 b(de)n(v)o(elopers)e(of)i
(distrib)n(uted)f(softw)o(are)h(treat)g(the)g(netw)o(ork)f(as)i
(in\002nitely)f(f)o(ast)h(and)e(perfectly)g(reliable.)h(While)396
2744 y(this)h(is)g(approximately)c(true)j(for)g(simple)g(applications)f
(o)o(v)o(er)g(Ethernet,)g(W)m(iFi)i(rapidly)e(pro)o(v)o(es)f(the)j(dif)
n(ference)396 2852 y(between)f(magical)f(thinking)g(and)g(science.)h
(That)g(is,)h(W)m(iFi)g(breaks)f(so)g(easily)h(and)e(dramatically)g
(under)g(stress)i(that)f(I)396 2960 y(sometimes)g(w)o(onder)f(ho)n(w)h
(an)o(yone)e(w)o(ould)h(dare)h(use)h(it)f(for)g(real)g(w)o(ork.)g(The)f
(ceiling)h(mo)o(v)o(es)f(up,)h(as)h(W)m(iFi)g(gets)396
3068 y(better)m(,)e(b)n(ut)i(ne)n(v)o(er)e(f)o(ast)h(enough)e(to)j
(stop)f(us)h(hitting)e(it.)-2 3252 y
SDict begin H.S end
 -2 3252 a -2 3252
a
SDict begin 13 H.A end
 -2 3252 a -2 3252 a
SDict begin [/View [/XYZ H.V]/Dest (0:4809) cvn /DEST pdfmark end
 -2 3252 a 396 3342 a Fj(T)-7 b(o)21
b(understand)d(ho)n(w)h(W)m(iFi)i(performs)e(technically)g(you)g(need)h
(to)g(understand)e(a)j(basic)f(la)o(w)h(of)e(physics:)h(the)g(po)n(wer)
396 3450 y(required)f(to)h(connect)f(tw)o(o)h(points)g(increases)g
(according)e(to)j(the)f(square)f(of)h(the)g(distance.)g(People)g(who)f
(gro)n(w)h(up)f(in)396 3557 y(lar)o(ger)g(houses)h(ha)n(v)o(e)f(e)o
(xponentially)f(louder)h(v)n(oices,)h(as)h(I)f(learned)f(in)i(Dallas.)f
(F)o(or)g(a)h(W)m(iFi)g(netw)o(ork)e(this)h(means)396
3665 y(that)h(as)f(tw)o(o)h(radios)f(get)g(further)e(apart,)i(the)o(y)f
(ha)n(v)o(e)h(to)g(either)g(use)h(more)e(po)n(wer)m(,)f(or)i(lo)n(wer)g
(their)g(signal)g(rate.)-2 3849 y
SDict begin H.S end
 -2 3849 a -2 3849 a
SDict begin 13 H.A end

-2 3849 a -2 3849 a
SDict begin [/View [/XYZ H.V]/Dest (0:4810) cvn /DEST pdfmark end
 -2 3849 a 396 3939 a Fj(There')-5
b(s)20 b(only)f(so)i(much)e(po)n(wer)g(you)h(can)g(pull)g(out)f(of)h(a)
h(battery)e(before)g(users)h(treat)h(the)f(de)n(vice)f(as)i(hopelessly)
396 4047 y(brok)o(en.)d(So)j(though)d(a)j(W)m(iFi)g(netw)o(ork)e(may)h
(be)g(rated)g(at)g(some)g(speed,)g(the)g(real)g(bit)h(rate)f(between)f
(the)h(access)h(point)396 4155 y(\(AP\))f(and)g(a)h(client)f(depends)f
(on)g(ho)n(w)h(f)o(ar)g(apart)g(the)g(tw)o(o)h(are.)e(As)i(you)f(mo)o
(v)o(e)e(your)h(W)m(iFi-enabled)g(phone)g(a)o(w)o(ay)396
4263 y(from)g(the)i(AP)-9 b(,)20 b(the)g(tw)o(o)h(radios)e(trying)g(to)
i(talk)f(to)g(each)g(other)g(will)h(\002rst)f(increase)g(their)g(po)n
(wer)f(b)n(ut)i(then)e(reduce)396 4371 y(their)h(bit)h(rate.)-2
4538 y
SDict begin H.S end
 -2 4538 a -2 4538 a
SDict begin 13 H.A end
 -2 4538 a -2 4538 a
SDict begin [/View [/XYZ H.V]/Dest (0:4811) cvn /DEST pdfmark end
 -2 4538
a 396 4645 a Fj(This)g(ef)n(fect)e(has)i(some)f(consequences)e(we)i
(need)g(to)g(be)g(a)o(w)o(are)g(of)g(if)h(we)f(w)o(ant)h(to)f(b)n(uild)
g(rob)n(ust)f(distrib)n(uted)396 4753 y(applications)g(that)i(don')o(t)
d(dangle)h(wires)i(behind)d(them)i(lik)o(e)h(puppets:)-2
4771 y
SDict begin H.S end
 -2 4771 a -2 4771 a
SDict begin 13 H.A end
 -2 4771 a -2 4771 a
SDict begin [/View [/XYZ H.V]/Dest (0:4812) cvn /DEST pdfmark end
 -2 4771
a -2 4781 a
SDict begin H.S end
 -2 4781 a -2 4781 a
SDict begin 13 H.A end
 -2 4781 a -2 4781 a
SDict begin [/View [/XYZ H.V]/Dest (0:4813) cvn /DEST pdfmark end
 -2
4781 a Black 396 4923 a Fe(\225)p Black 479 4923 a
SDict begin H.S end
 479
4923 a 479 4923 a
SDict begin 13 H.A end
 479 4923 a 479 4923 a
SDict begin [/View [/XYZ H.V]/Dest (0:4814) cvn /DEST pdfmark end
 479 4923 a Fj(If)f(you)g(ha)n
(v)o(e)f(a)i(group)d(of)i(de)n(vices)g(talking)f(to)i(an)f(AP)-9
b(,)20 b(when)g(the)g(AP)h(is)g(talking)e(to)i(the)f(slo)n(west)h(de)n
(vice,)e(the)479 5031 y
SDict begin H.S end
 479 5031 a 479 5031 a
SDict begin 13 H.A end
 479 5031
a 479 5031 a
SDict begin [/View [/XYZ H.V]/Dest (0:4815) cvn /DEST pdfmark end
 479 5031 a Fi(whole)h(network)h(has)f(to)g(wait)q
Fj(.)h(It')-5 b(s)21 b(lik)o(e)f(ha)n(ving)f(to)i(repeat)e(a)i(jok)o(e)
f(at)h(a)f(party)g(to)g(the)g(designated)f(dri)n(v)o(er)m(,)f(who)i
(has)479 5139 y(no)g(sense)h(of)f(humor)m(,)e(is)j(still)g(fully)f(and)
f(tragically)h(sober)m(,)f(and)g(has)i(in)f(an)o(y)f(case)i(a)g(poor)e
(grasp)g(of)h(the)g(language.)-2 5157 y
SDict begin H.S end
 -2 5157 a -2
5157 a
SDict begin 13 H.A end
 -2 5157 a -2 5157 a
SDict begin [/View [/XYZ H.V]/Dest (0:4816) cvn /DEST pdfmark end
 -2 5157 a Black 3759 5569
a Fi(342)p Black eop end
%%Page: 343 357
TeXDict begin 343 356 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.343) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:4817) cvn /DEST pdfmark end
 479 72 a
Fj(If)g(you)g(use)g(unicast)g(TCP)h(and)f(send)g(a)g(message)g(to)h
(multiple)e(de)n(vices,)h(the)g(AP)h(must)f(send)g(the)g(pack)o(ets)g
(to)g(each)479 180 y(de)n(vice)g(separately)-5 b(,)18
b(Y)-8 b(es,)21 b(you)e(kne)n(w)g(this,)i(it')-5 b(s)21
b(also)g(ho)n(w)e(Ethernet)g(w)o(orks.)h(But)h(no)n(w)e(understand)f
(that)j(one)479 288 y(distant)f(\(or)g(lo)n(w-po)n(wered\))d(de)n(vice)
j(means)g(e)n(v)o(erything)d(w)o(aits)k(for)f(that)g(slo)n(west)h(de)n
(vice)e(to)i(catch)e(up.)-2 306 y
SDict begin H.S end
 -2 306 a -2 306 a
SDict begin 13 H.A end
 -2
306 a -2 306 a
SDict begin [/View [/XYZ H.V]/Dest (0:4818) cvn /DEST pdfmark end
 -2 306 a Black 396 438 a Fe(\225)p Black
479 438 a
SDict begin H.S end
 479 438 a 479 438 a
SDict begin 13 H.A end
 479 438 a 479 438 a
SDict begin [/View [/XYZ H.V]/Dest (0:4819) cvn /DEST pdfmark end
 479
438 a Fj(If)h(you)g(use)g(multicast)g(or)g(broadcast)f(\(which)g(w)o
(ork)h(the)g(same,)g(in)h(most)f(cases\),)g(the)g(AP)h(will)g(send)f
(single)479 546 y(pack)o(ets)g(to)h(the)f(whole)f(netw)o(ork)g(at)i
(once,)e(which)h(is)h(a)o(wesome,)e(b)n(ut)i(it)f(will)h(do)f(it)h(at)g
(the)f(slo)n(west)h(possible)f(bit)479 654 y(rate)g(\(usually)g
(1Mbps\).)f(Y)-9 b(ou)19 b(can)h(adjust)g(this)h(rate)f(manually)f(in)h
(some)g(APs.)h(That)f(just)h(reduces)e(the)h(reach)g(of)479
762 y(your)f(AP)-9 b(.)21 b(Y)-9 b(ou)19 b(can)h(also)h(b)n(uy)e(more)h
(e)o(xpensi)n(v)o(e)e(APs)j(that)f(ha)n(v)o(e)g(a)h(little)g(more)e
(intelligence)g(and)h(will)h(\002gure)e(out)479 869 y(the)h(highest)g
(bit)h(rate)f(the)o(y)f(can)h(safely)g(use.)g(Y)-9 b(ou)20
b(can)g(also)g(use)h(enterprise)e(APs)i(with)f(IGMP)h(\(Internet)d
(Group)479 977 y(Management)g(Protocol\))h(support)g(and)h(\330MQ')-5
b(s)21 b(PGM)f(transport)f(to)h(send)g(only)g(to)g(subscribed)f
(clients.)h(I')l(d)g(not)479 1085 y(ho)n(we)n(v)o(er)e(bet)j(on)e(such)
h(APs)i(being)d(widely)h(a)n(v)n(ailable,)f(e)n(v)o(er)-5
b(.)-2 1269 y
SDict begin H.S end
 -2 1269 a -2 1269 a
SDict begin 13 H.A end
 -2 1269 a -2 1269 a
SDict begin [/View [/XYZ H.V]/Dest (0:4820) cvn /DEST pdfmark end

-2 1269 a 396 1359 a Fj(As)21 b(you)f(try)g(to)g(put)g(more)f(de)n
(vices)h(onto)f(an)h(AP)-9 b(,)21 b(performance)c(rapidly)i(gets)h(w)o
(orse)h(to)f(the)g(point)g(where)f(adding)396 1467 y(one)h(more)f(de)n
(vice)h(can)g(break)f(the)h(whole)g(netw)o(ork,)e(for)i(e)n(v)o
(eryone.)d(Man)o(y)j(APs)h(solv)o(e)f(this)g(by)g(randomly)396
1575 y(disconnecting)e(clients)j(when)e(the)o(y)h(reach)f(some)h
(limit,)h(four)e(to)h(eight)g(de)n(vices)g(for)f(a)i(mobile)e(hotspot,)
g(30-50)396 1683 y(de)n(vices)h(for)f(a)i(consumer)e(AP)-9
b(,)20 b(perhaps)f(100)g(de)n(vices)h(for)f(an)i(enterprise)e(AP)-9
b(.)-2 1711 y
SDict begin H.S end
 -2 1711 a -2 1711 a
SDict begin 13 H.A end
 -2 1711 a -2 1711 a
SDict begin [/View [/XYZ H.V]/Dest (0:4821) cvn /DEST pdfmark end

-2 1711 a 396 2022 a Fd(8.2.3.)36 b(What')-7 b(s)34 b(the)f(Current)g
(Status?)2262 2022 y
SDict begin H.S end
 2262 2022 a 2262 2022 a
SDict begin 18.72 H.A end
 2262 2022
a 2262 2022 a
SDict begin [/View [/XYZ H.V]/Dest (13.83.115.2) cvn /DEST pdfmark
end
 2262 2022 a -2 2189 a
SDict begin H.S end
 -2 2189 a -2 2189
a
SDict begin 13 H.A end
 -2 2189 a -2 2189 a
SDict begin [/View [/XYZ H.V]/Dest (0:4823) cvn /DEST pdfmark end
 -2 2189 a 396 2296 a Fj(Despite)21
b(its)g(uncomfortable)c(role)j(as)h(enterprise)e(technology)e(that)k
(someho)n(w)e(escaped)g(into)h(the)g(wild,)g(W)m(iFi)h(is)396
2403 y(already)e(useful)h(for)g(more)f(than)h(getting)f(a)i(free)e(Sk)o
(ype)g(call.)i(It')-5 b(s)21 b(not)f(ideal)g(b)n(ut)g(it)h(w)o(orks)f
(well)g(enough)f(to)h(let)h(us)396 2511 y(solv)o(e)f(some)g
(interesting)f(problems.)g(Let)h(me)g(gi)n(v)o(e)g(you)f(a)i(rapid)e
(status)i(report.)-2 2695 y
SDict begin H.S end
 -2 2695 a -2 2695 a
SDict begin 13 H.A end
 -2 2695
a -2 2695 a
SDict begin [/View [/XYZ H.V]/Dest (0:4824) cvn /DEST pdfmark end
 -2 2695 a 396 2785 a Fj(First,)g(point-to-point)c(v)o
(ersus)j(access)g(point-to-client.)e(T)m(raditional)h(W)m(iFi)i(is)g
(all)g(AP-client.)f(Ev)o(ery)e(pack)o(et)i(has)g(to)396
2893 y(go)g(from)f(client)h(A)h(to)f(AP)-9 b(,)21 b(thence)e(to)i
(client)f(B.)h(Y)-9 b(ou)19 b(cut)i(your)d(bandwidth)h(by)h(50\045)f(b)
n(ut)i(that')-5 b(s)20 b(only)g(half)g(the)396 3001 y(problem.)e(I)j(e)
o(xplained)d(about)h(the)i(in)m(v)o(erse)e(po)n(wer)g(la)o(w)-5
b(.)19 b(If)i(A)f(and)g(B)h(are)f(v)o(ery)f(close)i(together)d(b)n(ut)j
(both)e(f)o(ar)h(from)396 3109 y(the)g(AP)-9 b(,)21 b(the)o(y')o(ll)e
(both)h(be)g(using)f(a)i(lo)n(w)f(bit)h(rate.)f(Imagine)f(your)f(AP)j
(is)g(in)g(the)f(garage,)e(and)i(you')l(re)e(in)j(the)f(li)n(ving)396
3217 y(room)f(trying)g(to)i(stream)f(video)f(from)g(your)g(phone)g(to)h
(your)f(TV)-11 b(.)21 b(Good)e(luck!)-2 3401 y
SDict begin H.S end
 -2 3401
a -2 3401 a
SDict begin 13 H.A end
 -2 3401 a -2 3401 a
SDict begin [/View [/XYZ H.V]/Dest (0:4825) cvn /DEST pdfmark end
 -2 3401 a 396 3491 a
Fj(There)h(is)h(an)f(old)g("ad-hoc")e(mode)h(that)i(lets)g(A)f(and)g(B)
h(talk)f(to)h(each)f(other)f(b)n(ut)h(it')-5 b(s)22 b(w)o(ay)e(too)g
(slo)n(w)g(for)g(an)o(ything)e(fun,)396 3599 y(and)i(of)g(course,)f
(it')-5 b(s)21 b(disabled)f(on)g(all)g(mobile)g(chipsets.)g(Actually)-5
b(,)19 b(it')-5 b(s)21 b(disabled)f(in)g(the)g(top-secret)f(dri)n(v)o
(ers)g(that)h(the)396 3707 y(chipset)f(mak)o(ers)g(kindly)g(pro)o(vide)
e(to)j(hardw)o(are)e(mak)o(ers.)g(There)h(is)h(a)g(ne)n(w)f("T)l
(unneled)f(Direct)i(Link)e(Setup")h(\(TDLS\))396 3815
y(protocol)g(that)h(lets)h(tw)o(o)g(de)n(vices)e(create)h(a)h(direct)f
(link,)f(using)h(an)g(AP)h(for)e(disco)o(v)o(ery)f(b)n(ut)j(not)f(for)f
(traf)n(\002c.)h(And)396 3923 y(there')-5 b(s)20 b(a)h("5G")f(W)m(iFi)h
(standard)e(\(it')-5 b(s)21 b(a)g(mark)o(eting)d(term,)i(so)g(goes)g
(in)h(quotes\))e(that)h(boosts)g(link)g(speeds)g(to)h(a)396
4031 y(gigabit.)e(TDLS)h(and)g(5G)g(together)f(mak)o(e)h(HD)g(mo)o(vie)
f(streaming)h(from)f(your)g(phone)f(to)j(your)e(TV)h(a)h(plausible)396
4139 y(reality)-5 b(.)19 b(I)i(assume)f(TDLS)g(will)h(be)f(restricted)g
(in)g(v)n(arious)g(w)o(ays)g(so)h(as)g(to)f(placate)g(the)g(telcos.)-2
4323 y
SDict begin H.S end
 -2 4323 a -2 4323 a
SDict begin 13 H.A end
 -2 4323 a -2 4323 a
SDict begin [/View [/XYZ H.V]/Dest (0:4826) cvn /DEST pdfmark end
 -2 4323
a 396 4413 a Fj(Lastly)-5 b(,)19 b(we)h(sa)o(w)g(standardization)e(of)h
(the)h(802.11s)e(mesh)h(protocol)f(in)i(2012,)e(after)h(a)h(remarkably)
e(speedy)g(ten)i(years)396 4521 y(or)g(so)h(of)f(w)o(ork.)f(Mesh)h
(remo)o(v)o(es)f(the)h(access)h(point)e(completely)-5
b(,)18 b(at)j(least)g(in)f(the)g(imaginary)f(future)g(where)g(it)i(e)o
(xists)396 4628 y(and)f(is)h(widely)e(used.)h(De)n(vices)f(talk)i(to)f
(each)f(other)g(directly)-5 b(,)19 b(and)g(maintain)h(little)g(routing)
f(tables)h(of)g(neighbors)e(that)396 4736 y(let)j(them)f(forw)o(ard)f
(pack)o(ets.)g(Imagine)g(the)h(AP)h(softw)o(are)f(embedded)e(into)i(e)n
(v)o(ery)f(de)n(vice)g(b)n(ut)h(smart)g(enough)f(\(it')-5
b(s)396 4844 y(not)20 b(as)h(impressi)n(v)o(e)e(as)i(it)g(sounds\))e
(to)h(do)g(multiple)g(hops.)-2 5028 y
SDict begin H.S end
 -2 5028 a -2 5028
a
SDict begin 13 H.A end
 -2 5028 a -2 5028 a
SDict begin [/View [/XYZ H.V]/Dest (0:4827) cvn /DEST pdfmark end
 -2 5028 a 396 5118 a Fj(No-one)f(who)h(is)h
(making)e(mone)o(y)f(from)h(the)i(mobile)e(data)h(e)o(xtortion)e(rack)o
(et)i(w)o(ants)h(to)f(see)h(802.11s)d(a)n(v)n(ailable,)p
Black 3759 5569 a Fi(343)p Black eop end
%%Page: 344 358
TeXDict begin 344 357 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.344) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 72 a Fj(because)g(city-wide)f(mesh)h(is)h
(such)f(a)h(nightmare)d(for)i(the)g(bottom)f(line,)h(so)h(it')-5
b(s)21 b(happening)d(as)i(slo)n(wly)h(as)f(possible.)396
180 y(The)g(only)f(lar)o(ge)h(or)o(ganization)d(with)j(the)g(po)n(wer)f
(\(and,)g(I)i(assume)f(the)g(surf)o(ace-to-surf)o(ace)d(missiles\))k
(to)g(get)f(mesh)396 288 y(technology)e(into)i(wide)g(use)g(is)i(the)e
(US)h(Army)-5 b(.)18 b(But)j(mesh)f(will)h(emer)o(ge)e(and)g(I')l(d)h
(bet)g(on)g(802.11s)e(being)h(widely)396 396 y(a)n(v)n(ailable)h(in)g
(consumer)f(electronics)g(by)h(2020)f(or)h(so.)-2 580
y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:4828) cvn /DEST pdfmark end
 -2 580 a 396 670
a Fj(Second,)f(if)i(we)f(don')o(t)f(ha)n(v)o(e)g(point-to-point,)e(ho)n
(w)j(f)o(ar)g(can)g(we)g(trust)h(APs)g(today?)e(W)-7
b(ell,)21 b(if)g(you)e(go)h(to)g(a)h(Starb)n(ucks)396
778 y(in)g(the)f(USA)h(and)e(try)h(the)g(\330MQ)h(Hello)f(W)-7
b(orld)20 b(e)o(xample)f(using)h(tw)o(o)g(laptops)g(connected)e(via)i
(the)h(free)e(W)m(iFi,)i(you')o(ll)396 886 y(\002nd)e(the)o(y)f(cannot)
g(connect.)f(Why?)h(W)-7 b(ell,)20 b(the)f(answer)g(is)g(in)g(the)g
(name:)f("attwi\002".)i(A)-9 b(T&T)18 b(is)h(a)h(good)d(old)i
(incumbent)396 994 y(telco)h(that)h(hates)f(W)m(iFi)h(and)f(presumably)
e(pro)o(vides)g(the)j(service)e(cheaply)g(to)i(Starb)n(ucks)e(and)h
(others)g(so)g(that)396 1102 y(independents)e(can')o(t)h(get)i(into)e
(the)i(mark)o(et.)e(But)i(an)o(y)e(access)i(point)e(you)h(b)n(uy)f
(will)i(support)e(client-to-AP-to-client)396 1210 y(access,)i(and)e
(outside)h(the)g(USA)h(I')l(v)o(e)e(ne)n(v)o(er)g(found)f(a)j(public)e
(AP)i(lock)o(ed-do)n(wn)c(the)k(A)-9 b(T&T)19 b(w)o(ay)-5
b(.)-2 1394 y
SDict begin H.S end
 -2 1394 a -2 1394 a
SDict begin 13 H.A end
 -2 1394 a -2 1394 a
SDict begin [/View [/XYZ H.V]/Dest (0:4829) cvn /DEST pdfmark end

-2 1394 a 396 1484 a Fj(Third,)19 b(performance.)e(The)j(AP)h(is)g
(clearly)f(a)g(bottleneck;)f(you)g(cannot)g(get)i(better)e(than)h(half)
g(of)g(its)h(adv)o(ertised)396 1592 y(speed)f(e)n(v)o(en)f(if)i(you)e
(put)h(A)h(and)e(B)i(literally)f(beside)g(the)g(AP)-9
b(.)21 b(W)-7 b(orse,)20 b(if)h(there)f(are)g(other)f(APs)i(in)g(the)f
(same)g(airspace,)396 1700 y(the)o(y')o(ll)g(shout)f(each)h(other)g
(out.)f(In)h(my)g(home,)f(W)m(iFi)i(barely)e(w)o(orks)h(at)h(all)g
(because)e(the)h(neighbors)f(tw)o(o)h(houses)396 1808
y(do)n(wn)f(ha)n(v)o(e)h(an)g(AP)h(which)f(the)o(y')l(v)o(e)e
(ampli\002ed.)h(Ev)o(en)g(on)h(a)g(dif)n(ferent)f(channel)g(it)i
(interferes)e(with)h(our)g(home)f(W)m(iFi.)396 1916 y(In)h(the)g(cafe)g
(where)g(I'm)g(sitting)g(no)n(w)g(there)f(are)h(o)o(v)o(er)f(a)i(dozen)
e(netw)o(orks.)g(Realistically)-5 b(,)20 b(as)h(long)e(as)i(we')l(re)
396 2023 y(dependent)d(on)i(AP-based)g(W)m(iFi,)g(we')l(re)g(subject)g
(to)g(random)f(interference)f(and)i(unpredictable)d(performance.)-2
2208 y
SDict begin H.S end
 -2 2208 a -2 2208 a
SDict begin 13 H.A end
 -2 2208 a -2 2208 a
SDict begin [/View [/XYZ H.V]/Dest (0:4830) cvn /DEST pdfmark end
 -2 2208
a 396 2297 a Fj(F)o(ourth,)i(battery)g(life.)h(There')-5
b(s)20 b(no)g(inherent)f(reason)g(that)h(W)m(iFi,)h(when)f(idle,)g(is)h
(hungrier)d(than)i(Bluetooth,)f(for)396 2405 y(e)o(xample.)g(The)o(y)g
(use)h(the)h(same)f(radios)g(and)f(lo)n(w-le)n(v)o(el)g(framing.)g(The)
g(main)h(dif)n(ference)e(is)j(tuning)e(and)h(in)g(the)396
2513 y(protocols.)f(F)o(or)h(wireless)g(po)n(wer)n(-sa)n(ving)f(to)h(w)
o(ork)g(well,)g(de)n(vices)g(ha)n(v)o(e)f(to)i(mostly)e(sleep,)i(and)e
(beacon)g(out)h(to)g(other)396 2621 y(de)n(vices)g(only)f(once)h(e)n(v)
o(ery)f(so)h(often.)f(F)o(or)h(this)h(to)f(w)o(ork,)f(the)o(y)h(need)f
(to)i(synchronize)d(their)i(clocks.)f(This)i(happens)396
2729 y(properly)d(for)i(the)g(mobile)f(phone)g(part,)h(which)f(is)j
(why)d(my)h(old)g(\003ip)g(phone)f(can)h(run)f(\002)n(v)o(e)h(days)g
(on)g(a)g(char)o(ge.)f(When)396 2837 y(W)m(iFi)i(is)h(w)o(orking,)c(it)
j(will)g(use)f(more)g(po)n(wer)-5 b(.)19 b(Current)g(po)n(wer)g
(ampli\002er)h(technology)e(is)j(also)f(inef)n(\002cient,)f(meaning)396
2945 y(you)h(dra)o(w)f(a)i(lot)f(more)f(ener)o(gy)g(from)g(your)g
(battery)g(than)h(you)f(pump)g(into)h(the)g(air)g(\(the)g(w)o(aste)h
(turns)f(into)g(a)h(hot)396 3053 y(phone\).)d(Po)n(wer)i(ampli\002ers)g
(are)g(impro)o(ving)e(as)i(people)g(focus)f(more)g(on)h(mobile)g(W)m
(iFi.)-2 3237 y
SDict begin H.S end
 -2 3237 a -2 3237 a
SDict begin 13 H.A end
 -2 3237 a -2 3237
a
SDict begin [/View [/XYZ H.V]/Dest (0:4831) cvn /DEST pdfmark end
 -2 3237 a 396 3327 a Fj(Lastly)-5 b(,)20 b(mobile)f(access)i(points.)
f(If)g(we)g(can')o(t)f(trust)i(centralized)e(APs,)i(and)e(if)i(our)e
(de)n(vices)h(are)g(smart)g(enough)e(to)j(run)396 3435
y(full)f(operating)f(systems,)h(can')o(t)f(we)i(mak)o(e)f(them)f(w)o
(ork)h(as)h(APs?)g(I'm)2478 3435 y
SDict begin H.S end
 2478 3435 a 2478 3435
a
SDict begin 13 H.A end
 2478 3435 a 2478 3435 a
SDict begin [/View [/XYZ H.V]/Dest (0:4832) cvn /DEST pdfmark end
 2478 3435 a Fi(so)f(glad)i
Fj(you)d(ask)o(ed)h(that)g(question.)f(Y)-8 b(es,)20
b(we)396 3543 y(can,)g(and)g(it)h(w)o(orks)e(quite)h(nicely)-5
b(.)19 b(Especially)h(since)g(you)f(can)h(switch)h(this)g(on)e(and)h
(of)n(f)g(in)g(softw)o(are,)f(on)h(a)h(modern)396 3651
y(OS)g(lik)o(e)g(Android.)d(Again,)h(the)h(villains)g(of)g(the)g(peace)
g(are)g(the)g(US)h(telcos,)f(who)g(mostly)g(detest)g(this)h(feature)e
(and)396 3759 y(kill)i(it)g(or)f(cripple)f(it)i(on)f(the)g(phones)f
(the)o(y)g(control.)g(Smarter)h(telcos)g(realize)g(that)g(it')-5
b(s)22 b(a)e(w)o(ay)g(to)h(amplify)e(their)h("last)396
3867 y(mile")h(and)e(bring)g(higher)n(-v)n(alue)f(products)g(to)j(more)
e(users,)h(b)n(ut)g(crooks)g(don')o(t)e(compete)h(on)h(smarts.)-2
3895 y
SDict begin H.S end
 -2 3895 a -2 3895 a
SDict begin 13 H.A end
 -2 3895 a -2 3895 a
SDict begin [/View [/XYZ H.V]/Dest (0:4833) cvn /DEST pdfmark end
 -2 3895
a 396 4205 a Fd(8.2.4.)36 b(Conc)n(lusions)1442 4205
y
SDict begin H.S end
 1442 4205 a 1442 4205 a
SDict begin 18.72 H.A end
 1442 4205 a 1442 4205 a
SDict begin [/View [/XYZ H.V]/Dest (13.83.116.2) cvn /DEST pdfmark
end
 1442
4205 a -2 4373 a
SDict begin H.S end
 -2 4373 a -2 4373 a
SDict begin 13 H.A end
 -2 4373 a -2 4373
a
SDict begin [/View [/XYZ H.V]/Dest (0:4835) cvn /DEST pdfmark end
 -2 4373 a 396 4479 a Fj(W)m(iFi)21 b(is)h(not)d(Ethernet)g(and)h
(although)e(I)j(belie)n(v)o(e)e(future)g(\330MQ)h(applications)f(will)i
(ha)n(v)o(e)f(a)h(v)o(ery)e(important)396 4587 y(decentralized)g
(wireless)h(presence,)f(it')-5 b(s)22 b(not)d(going)g(to)i(be)f(an)g
(easy)g(road.)f(Much)h(of)g(the)g(basic)g(reliability)g(and)396
4695 y(capacity)g(that)g(you)f(e)o(xpect)g(from)h(Ethernet)f(is)i
(missing.)f(When)g(you)f(run)g(a)i(distrib)n(uted)e(application)g(o)o
(v)o(er)g(W)m(iFi)i(you)396 4803 y(ha)n(v)o(e)f(to)g(allo)n(w)g(for)g
(frequent)e(timeouts,)i(random)e(latencies,)i(arbitrary)f
(disconnections,)f(whole)h(interf)o(aces)h(going)396
4911 y(do)n(wn)f(and)h(coming)f(up,)g(and)h(so)h(on.)p
Black 3759 5569 a Fi(344)p Black eop end
%%Page: 345 359
TeXDict begin 345 358 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.345) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4836) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(The)g(technological)e(e)n(v)n
(olution)h(of)h(wireless)h(netw)o(orking)d(is)j(best)f(described)f(as)i
("slo)n(w)f(and)g(jo)o(yless".)g(Applications)396 180
y(and)g(frame)n(w)o(orks)e(that)j(try)f(to)g(e)o(xploit)f
(decentralized)f(wireless)j(are)f(mostly)g(absent)g(or)g(poor)-5
b(.)19 b(The)h(only)f(e)o(xisting)396 288 y(open)g(source)h(frame)n(w)o
(ork)e(for)h(proximity)g(netw)o(orking)f(is)2138 288
y
SDict begin H.S end
 2138 288 a 2138 288 a
SDict begin 13 H.A end
 2138 288 a 2138 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:4837) cvn /DEST pdfmark end
 2138 288
a Fj(AllJo)o(yn)i(\(https://www)-5 b(.alljo)o(yn.or)o(g\),)15
b(from)k(Qualcomm.)396 396 y(But)i(with)f(\330MQ)h(we)f(pro)o(v)o(ed)e
(that)i(the)h(inertia)f(and)f(decrepit)g(incompetence)f(of)i(e)o
(xisting)g(players)f(w)o(as)i(no)f(reason)396 504 y(for)g(us)g(to)h
(sit)g(still.)g(When)f(we)h(accurately)e(understand)f(problems,)g(we)j
(can)f(solv)o(e)f(them.)h(What)h(we)f(imagine,)f(we)396
612 y(can)h(mak)o(e)g(real.)-2 706 y
SDict begin H.S end
 -2 706 a -2 706
a
SDict begin 13 H.A end
 -2 706 a -2 706 a
SDict begin [/View [/XYZ H.V]/Dest (0:4838) cvn /DEST pdfmark end
 -2 706 a 377 x Fh(8.3.)39 b(Disco)m(ver)q(y)963
1083 y
SDict begin H.S end
 963 1083 a 963 1083 a
SDict begin 22.464 H.A end
 963 1083 a 963 1083 a
SDict begin [/View [/XYZ H.V]/Dest (13.84.1) cvn /DEST pdfmark end
 963
1083 a -2 1278 a
SDict begin H.S end
 -2 1278 a -2 1278 a
SDict begin 13 H.A end
 -2 1278 a -2 1278
a
SDict begin [/View [/XYZ H.V]/Dest (0:4840) cvn /DEST pdfmark end
 -2 1278 a 396 1357 a Fj(One)20 b(of)g(the)g(great)g(things)g(about)f
(short-range)f(wireless)j(is)g(the)f(proximity)-5 b(.)18
b(W)m(iFi)j(maps)f(closely)g(to)g(the)g(physical)396
1465 y(space,)g(which)g(maps)g(closely)g(to)g(ho)n(w)g(we)g(naturally)f
(or)o(ganize.)f(In)i(f)o(act)g(the)g(Internet)f(is)i(quite)f(abstract)g
(and)g(this)396 1572 y(confuses)g(a)g(lot)h(of)e(people)h(who)f(kind)h
(of)g("get")g(it)g(b)n(ut)h(in)f(f)o(act)g(don')o(t)f(really)-5
b(.)19 b(W)m(ith)h(W)m(iFi)i(we)e(ha)n(v)o(e)g(technical)396
1680 y(connecti)n(vity)e(that)j(is)g(potentially)e(super)n(-tangible.)f
(Y)-9 b(ou)19 b(see)i(what)f(you)f(get)i(and)e(you)g(get)i(what)f(you)f
(see.)i(T)-7 b(angible)396 1788 y(means)20 b(easy)g(to)h(understand)d
(and)h(that)i(should)e(mean)g(lo)o(v)o(e)h(from)f(users)h(instead)g(of)
g(the)g(typical)g(frustration)f(and)396 1896 y(quiet)h(hate.)-2
2080 y
SDict begin H.S end
 -2 2080 a -2 2080 a
SDict begin 13 H.A end
 -2 2080 a -2 2080 a
SDict begin [/View [/XYZ H.V]/Dest (0:4841) cvn /DEST pdfmark end
 -2 2080
a 396 2170 a Fj(Proximity)f(is)i(the)g(k)o(e)o(y)-5 b(.)18
b(W)-7 b(e)22 b(ha)n(v)o(e)d(a)i(b)n(unch)e(of)h(W)m(iFi)h(radios)f(in)
g(room,)f(happily)g(beaconing)f(to)i(each)g(other)-5
b(.)19 b(F)o(or)h(lots)396 2278 y(of)g(applications)f(it)i(mak)o(es)f
(sense)h(that)f(the)o(y)f(can)h(\002nd)g(each)g(other)g(and)f(start)i
(chatting,)e(without)g(an)o(y)h(user)g(input.)396 2386
y(After)g(all,)h(most)f(real)g(w)o(orld)g(data)g(isn')o(t)g(pri)n(v)n
(ate,)f(it')-5 b(s)21 b(just)g(highly)e(localized.)-2
2570 y
SDict begin H.S end
 -2 2570 a -2 2570 a
SDict begin 13 H.A end
 -2 2570 a -2 2570 a
SDict begin [/View [/XYZ H.V]/Dest (0:4842) cvn /DEST pdfmark end
 -2 2570
a 396 2660 a Fj(As)i(a)g(\002rst)g(step)f(to)n(w)o(ards)g(\330MQ-based)
f(proximity)f(netw)o(orking,)g(let')-5 b(s)21 b(look)f(at)g(ho)n(w)g
(to)g(do)g(disco)o(v)o(ery)-5 b(.)18 b(There)h(e)o(xist)396
2768 y(libraries)h(that)g(do)g(this.)h(I)f(don')o(t)f(lik)o(e)h(them.)g
(The)o(y)f(seem)h(too)g(comple)o(x)e(and)i(too)g(speci\002c)g(and)g
(someho)n(w)f(to)h(date)396 2876 y(from)f(a)i(prehistoric)e(era)h
(before)f(people)g(realized)g(that)i(distrib)n(uted)e(computing)f
(could)h(be)3092 2876 y
SDict begin H.S end
 3092 2876 a 3092 2876 a
SDict begin 13 H.A end
 3092
2876 a 3092 2876 a
SDict begin [/View [/XYZ H.V]/Dest (0:4843) cvn /DEST pdfmark end
 3092 2876 a Fi(fundamentally)f(simple)p
Fj(.)-2 2894 y
SDict begin H.S end
 -2 2894 a -2 2894 a
SDict begin 13 H.A end
 -2 2894 a -2 2894
a
SDict begin [/View [/XYZ H.V]/Dest (0:4844) cvn /DEST pdfmark end
 -2 2894 a 396 3204 a Fd(8.3.1.)36 b(Preemptive)e(Disco)n(ver)q(y)i(o)
n(ver)d(Ra)n(w)h(Soc)n(kets)3025 3204 y
SDict begin H.S end
 3025 3204 a 3025
3204 a
SDict begin 18.72 H.A end
 3025 3204 a 3025 3204 a
SDict begin [/View [/XYZ H.V]/Dest (13.84.117.2) cvn /DEST pdfmark
end
 3025 3204 a -2 3395 a
SDict begin H.S end

-2 3395 a -2 3395 a
SDict begin 13 H.A end
 -2 3395 a -2 3395 a
SDict begin [/View [/XYZ H.V]/Dest (0:4846) cvn /DEST pdfmark end
 -2 3395 a 396
3478 a Fj(I'm)20 b(in)g(a)h(hotel)f(room)f(in)h(Gangnam,)e(Seoul,)i
(with)g(a)h(4G)f(wireless)h(hotspot,)e(a)i(Linux)e(laptop,)g(and)g(an)i
(couple)e(of)396 3586 y(Android)g(phones.)f(The)i(phones)f(and)h
(laptop)f(are)h(talking)g(to)g(the)g(hotspot.)f(The)2762
3586 y
SDict begin H.S end
 2762 3586 a 2762 3586 a
SDict begin 13 H.A end
 2762 3586 a 2762 3586
a
SDict begin [/View [/XYZ H.V]/Dest (0:4847) cvn /DEST pdfmark end
 2762 3586 a Fg(ifconfig)h Fj(command)e(says)i(my)g(IP)396
3694 y(address)g(is)h(192.168.1.2.)16 b(Let)k(me)h(try)f(some)1741
3694 y
SDict begin H.S end
 1741 3694 a 1741 3694 a
SDict begin 13 H.A end
 1741 3694 a 1741 3694
a
SDict begin [/View [/XYZ H.V]/Dest (0:4848) cvn /DEST pdfmark end
 1741 3694 a Fg(ping)g Fj(commands.)e(DHCP)j(serv)o(ers)f(tend)f(to)i
(dish)f(out)g(addresses)g(in)396 3802 y(sequence,)f(so)i(my)e(phones)g
(are)i(probably)c(close)k(by)-5 b(,)19 b(numerically)f(speaking:)-2
3903 y
SDict begin H.S end
 -2 3903 a -2 3903 a
SDict begin 11.7 H.A end
 -2 3903 a -2 3903 a
SDict begin [/View [/XYZ H.V]/Dest (0:4849) cvn /DEST pdfmark end
 -2 3903
a 396 3982 a Fg($)45 b(ping)f(192.168.1.1)396 4079 y(PING)g
(192.168.1.1)f(\(192.168.1.1\))g(56\(84\))h(bytes)g(of)g(data.)396
4176 y(64)h(bytes)f(from)g(192.168.1.1:)f(icmp_req=1)g(ttl=64)h
(time=376)f(ms)396 4273 y(64)i(bytes)f(from)g(192.168.1.1:)f
(icmp_req=2)g(ttl=64)h(time=358)f(ms)396 4370 y(64)i(bytes)f(from)g
(192.168.1.1:)f(icmp_req=4)g(ttl=64)h(time=167)f(ms)396
4468 y(^C)396 4565 y(---)i(192.168.1.1)e(ping)h(statistics)f(---)396
4662 y(3)i(packets)f(transmitted,)e(2)j(received,)e(33\045)i(packet)f
(loss,)g(time)g(2001ms)396 4759 y(rtt)h(min/avg/max/mdev)d(=)i
(358.077/367.522/376.967/9.445)c(ms)-2 4937 y
SDict begin H.S end
 -2 4937
a -2 4937 a
SDict begin 13 H.A end
 -2 4937 a -2 4937 a
SDict begin [/View [/XYZ H.V]/Dest (0:4850) cvn /DEST pdfmark end
 -2 4937 a 396 5033 a
Fj(F)o(ound)19 b(one!)g(150-300)f(msec)i(round-trip)e(latenc)o(y)-5
b(...)18 b(that')-5 b(s)20 b(a)h(surprisingly)d(high)i(\002gure,)f
(something)g(to)h(k)o(eep)g(in)396 5141 y(mind)g(for)f(later)-5
b(.)21 b(No)n(w)f(I)g(ping)g(myself,)f(just)i(to)f(try)g(to)g(double)f
(check)h(things:)p Black 3759 5569 a Fi(345)p Black eop
end
%%Page: 346 360
TeXDict begin 346 359 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.346) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4851) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fg($)45 b(ping)f(192.168.1.2)396
170 y(PING)g(192.168.1.2)f(\(192.168.1.2\))g(56\(84\))h(bytes)g(of)g
(data.)396 267 y(64)h(bytes)f(from)g(192.168.1.2:)f(icmp_req=1)g
(ttl=64)h(time=0.054)f(ms)396 364 y(64)i(bytes)f(from)g(192.168.1.2:)f
(icmp_req=2)g(ttl=64)h(time=0.055)f(ms)396 461 y(64)i(bytes)f(from)g
(192.168.1.2:)f(icmp_req=3)g(ttl=64)h(time=0.061)f(ms)396
558 y(^C)396 655 y(---)i(192.168.1.2)e(ping)h(statistics)f(---)396
752 y(3)i(packets)f(transmitted,)e(3)j(received,)e(0\045)i(packet)f
(loss,)g(time)g(1998ms)396 850 y(rtt)h(min/avg/max/mdev)d(=)i
(0.054/0.056/0.061/0.009)d(ms)-2 1027 y
SDict begin H.S end
 -2 1027 a -2
1027 a
SDict begin 13 H.A end
 -2 1027 a -2 1027 a
SDict begin [/View [/XYZ H.V]/Dest (0:4852) cvn /DEST pdfmark end
 -2 1027 a 396 1124 a Fj(The)20
b(response)f(time)i(is)g(a)f(bit)h(f)o(aster)f(no)n(w)-5
b(,)19 b(which)h(is)h(what)f(we')l(d)g(e)o(xpect.)f(Let')-5
b(s)20 b(try)g(the)h(ne)o(xt)e(couple)g(of)h(addresses:)-2
1225 y
SDict begin H.S end
 -2 1225 a -2 1225 a
SDict begin 11.7 H.A end
 -2 1225 a -2 1225 a
SDict begin [/View [/XYZ H.V]/Dest (0:4853) cvn /DEST pdfmark end
 -2 1225
a 396 1304 a Fg($)45 b(ping)f(192.168.1.3)396 1401 y(PING)g
(192.168.1.3)f(\(192.168.1.3\))g(56\(84\))h(bytes)g(of)g(data.)396
1498 y(64)h(bytes)f(from)g(192.168.1.3:)f(icmp_req=1)g(ttl=64)h
(time=291)f(ms)396 1595 y(64)i(bytes)f(from)g(192.168.1.3:)f
(icmp_req=2)g(ttl=64)h(time=271)f(ms)396 1692 y(64)i(bytes)f(from)g
(192.168.1.3:)f(icmp_req=3)g(ttl=64)h(time=132)f(ms)396
1789 y(^C)396 1887 y(---)i(192.168.1.3)e(ping)h(statistics)f(---)396
1984 y(3)i(packets)f(transmitted,)e(3)j(received,)e(0\045)i(packet)f
(loss,)g(time)g(2001ms)396 2081 y(rtt)h(min/avg/max/mdev)d(=)i
(132.781/231.914/291.851/70.609)c(ms)-2 2258 y
SDict begin H.S end
 -2 2258
a -2 2258 a
SDict begin 13 H.A end
 -2 2258 a -2 2258 a
SDict begin [/View [/XYZ H.V]/Dest (0:4854) cvn /DEST pdfmark end
 -2 2258 a 396 2355 a
Fj(That')-5 b(s)21 b(the)f(second)f(phone,)g(with)h(the)g(same)g(kind)g
(of)g(latenc)o(y)f(as)i(the)f(\002rst)h(one.)e(Let')-5
b(s)21 b(continue,)e(see)h(if)h(there)f(are)396 2463
y(an)o(y)g(other)f(de)n(vices)h(connected)e(to)i(the)h(hotspot:)-2
2564 y
SDict begin H.S end
 -2 2564 a -2 2564 a
SDict begin 11.7 H.A end
 -2 2564 a -2 2564 a
SDict begin [/View [/XYZ H.V]/Dest (0:4855) cvn /DEST pdfmark end
 -2 2564
a 396 2643 a Fg($)45 b(ping)f(192.168.1.4)396 2740 y(PING)g
(192.168.1.4)f(\(192.168.1.4\))g(56\(84\))h(bytes)g(of)g(data.)396
2837 y(^C)396 2934 y(---)h(192.168.1.4)e(ping)h(statistics)f(---)396
3031 y(3)i(packets)f(transmitted,)e(0)j(received,)e(100\045)i(packet)e
(loss,)h(time)h(2016ms)-2 3209 y
SDict begin H.S end
 -2 3209 a -2 3209 a
SDict begin 13 H.A end

-2 3209 a -2 3209 a
SDict begin [/View [/XYZ H.V]/Dest (0:4856) cvn /DEST pdfmark end
 -2 3209 a 396 3305 a Fj(And)20 b(that)g(is)h(it.)g
(No)n(w)-5 b(,)1065 3305 y
SDict begin H.S end
 1065 3305 a 1065 3305 a
SDict begin 13 H.A end
 1065
3305 a 1065 3305 a
SDict begin [/View [/XYZ H.V]/Dest (0:4857) cvn /DEST pdfmark end
 1065 3305 a Fg(ping)20 b Fj(uses)g(ra)o(w)g(IP)h
(sock)o(ets)f(to)h(send)e(ICMP_ECHO)i(messages.)f(The)g(useful)f(thing)
h(about)396 3413 y(ICMP_ECHO)h(is)g(that)f(it)h(gets)f(a)h(response)e
(from)g(an)o(y)h(IP)g(stack)h(that)f(has)g(not)g(been)g(deliberately)e
(had)i(echo)396 3521 y(switched)g(of)n(f.)f(That')-5
b(s)21 b(still)g(a)g(common)d(practice)i(on)f(corporate)g(websites)h
(who)g(fear)g(the)g(old)g("ping)f(of)h(death")396 3629
y(e)o(xploit)f(where)h(malformed)e(messages)i(could)g(crash)g(the)g
(machine.)-2 3813 y
SDict begin H.S end
 -2 3813 a -2 3813 a
SDict begin 13 H.A end
 -2 3813 a -2
3813 a
SDict begin [/View [/XYZ H.V]/Dest (0:4858) cvn /DEST pdfmark end
 -2 3813 a 396 3903 a Fj(I)h(call)f(this)726 3903
y
SDict begin H.S end
 726 3903 a 726 3903 a
SDict begin 13 H.A end
 726 3903 a 726 3903 a
SDict begin [/View [/XYZ H.V]/Dest (0:4859) cvn /DEST pdfmark end
 726 3903
a Fi(pr)m(e-emptive)f(disco)o(very)h Fj(since)h(it)g(doesn')o(t)d(tak)o
(e)i(an)o(y)g(cooperation)e(from)h(the)h(de)n(vice.)f(W)-7
b(e)21 b(don')o(t)e(rely)h(on)396 4011 y(an)o(y)g(cooperation)d(from)j
(the)g(phones)f(to)h(see)h(them)f(sitting)g(there;)g(as)h(long)e(as)i
(the)o(y')l(re)d(not)i(acti)n(v)o(ely)g(ignoring)e(us,)i(we)396
4119 y(can)g(see)h(them.)-2 4286 y
SDict begin H.S end
 -2 4286 a -2 4286
a
SDict begin 13 H.A end
 -2 4286 a -2 4286 a
SDict begin [/View [/XYZ H.V]/Dest (0:4860) cvn /DEST pdfmark end
 -2 4286 a 396 4393 a Fj(Y)-9 b(ou)20
b(might)f(ask)i(why)e(this)i(is)g(useful.)e(W)-7 b(e)22
b(don')o(t)c(kno)n(w)h(that)i(the)f(peers)g(responding)e(to)i
(ICMP_ECHO)g(run)g(\330MQ,)396 4501 y(that)h(the)o(y)e(are)h
(interested)g(in)g(talking)f(to)i(us,)f(that)g(the)o(y)g(ha)n(v)o(e)f
(an)o(y)h(services)g(we)h(can)f(use,)g(or)g(e)n(v)o(en)f(what)h(kind)f
(of)396 4609 y(de)n(vice)h(the)o(y)f(are.)h(Ho)n(we)n(v)o(er)m(,)e(kno)
n(wing)g(that)j(there')-5 b(s)1971 4609 y
SDict begin H.S end
 1971 4609 a
1971 4609 a
SDict begin 13 H.A end
 1971 4609 a 1971 4609 a
SDict begin [/View [/XYZ H.V]/Dest (0:4861) cvn /DEST pdfmark end
 1971 4609 a Fi(something)19
b Fj(on)h(address)f(192.168.1.3)d(is)21 b(already)f(useful.)f(W)-7
b(e)396 4717 y(also)21 b(kno)n(w)e(ho)n(w)h(f)o(ar)g(a)o(w)o(ay)f(the)i
(de)n(vice)e(is,)i(relati)n(v)o(ely)-5 b(,)18 b(we)j(kno)n(w)e(ho)n(w)h
(man)o(y)f(de)n(vices)g(are)h(on)g(the)g(netw)o(ork,)f(and)h(we)396
4825 y(kno)n(w)f(the)i(rough)d(state)j(of)f(the)g(netw)o(ork)f(\(as)i
(in,)f(good,)e(poor)m(,)h(or)h(terrible\).)p Black 3757
5569 a Fi(346)p Black eop end
%%Page: 347 361
TeXDict begin 347 360 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.347) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4862) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(It)h(isn')o(t)f(e)n(v)o(en)f(hard)g
(to)h(create)g(ICMP_ECHO)h(messages)f(and)g(send)f(them.)h(A)h(fe)n(w)f
(dozen)f(lines)h(of)g(code,)g(and)f(we)396 180 y(could)g(use)i(\330MQ)f
(multithreading)e(to)i(do)g(this)h(in)f(parallel)g(for)g(addresses)f
(stretching)h(out)f(abo)o(v)o(e)g(and)h(belo)n(w)f(our)396
288 y(o)n(wn)h(IP)g(address.)g(Could)g(be)g(kind)f(of)h(fun.)-2
455 y
SDict begin H.S end
 -2 455 a -2 455 a
SDict begin 13 H.A end
 -2 455 a -2 455 a
SDict begin [/View [/XYZ H.V]/Dest (0:4863) cvn /DEST pdfmark end
 -2 455 a 396
562 a Fj(Ho)n(we)n(v)o(er)m(,)e(sadly)-5 b(,)20 b(there')-5
b(s)20 b(a)g(f)o(atal)h(\003a)o(w)f(in)h(my)f(idea)g(of)g(using)f
(ICMP_ECHO)h(to)h(disco)o(v)o(er)d(de)n(vices.)i(T)-7
b(o)20 b(open)f(a)i(ra)o(w)396 670 y(IP)g(sock)o(et)f(requires)f(root)h
(pri)n(vile)o(ges)e(on)i(a)h(POSIX)f(box.)f(It)i(stops)f(rogue)f
(programs)f(getting)i(data)g(meant)g(for)f(others.)396
778 y(W)-7 b(e)22 b(can)e(get)g(the)g(po)n(wer)f(to)i(open)e(ra)o(w)h
(sock)o(ets)g(on)g(Linux)f(by)h(gi)n(ving)e(sudo)i(pri)n(vile)o(ges)f
(to)h(our)g(command)e(\(ping)h(has)396 886 y(the)h(so-called)g(')-5
b(stick)o(y)20 b(bit')g(set\).)g(On)h(a)f(mobile)g(OS)g(lik)o(e)h
(Android,)d(it)j(requires)e(root)h(access,)g(i.e.)g(rooting)f(the)h
(phone)396 994 y(or)f(tablet.)f(That')-5 b(s)19 b(out)g(of)f(the)h
(question)e(for)i(most)f(people)g(and)g(so)h(ICMP_ECHO)g(is)h(out)e(of)
h(reach)f(for)g(most)h(de)n(vices.)-2 1178 y
SDict begin H.S end
 -2 1178
a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:4864) cvn /DEST pdfmark end
 -2 1178 a -2 1178 a
SDict begin H.S end
 -2
1178 a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:4865) cvn /DEST pdfmark end
 -2 1178 a 396 1268
a Fi(Expletive)h(deleted!)f Fj(Let')-5 b(s)21 b(try)f(something)f(in)h
(user)g(space.)g(The)g(ne)o(xt)f(step)i(most)f(people)f(tak)o(e)h(is)h
(UDP)g(multicast)f(or)396 1376 y(broadcast.)f(Let')-5
b(s)21 b(follo)n(w)e(that)h(trail.)-2 1387 y
SDict begin H.S end
 -2 1387
a -2 1387 a
SDict begin 13 H.A end
 -2 1387 a -2 1387 a
SDict begin [/View [/XYZ H.V]/Dest (0:4866) cvn /DEST pdfmark end
 -2 1387 a 396 1714 a
Fd(8.3.2.)36 b(Cooperative)f(Disco)n(ver)q(y)g(using)f(UDP)g(Br)n
(oadcasts)3341 1714 y
SDict begin H.S end
 3341 1714 a 3341 1714 a
SDict begin 18.72 H.A end
 3341 1714
a 3341 1714 a
SDict begin [/View [/XYZ H.V]/Dest (13.84.118.2) cvn /DEST pdfmark
end
 3341 1714 a -2 1907 a
SDict begin H.S end
 -2 1907 a -2 1907
a
SDict begin 13 H.A end
 -2 1907 a -2 1907 a
SDict begin [/View [/XYZ H.V]/Dest (0:4868) cvn /DEST pdfmark end
 -2 1907 a 396 1988 a Fj(Multicast)21
b(tends)f(to)g(be)g(seen)g(as)h(more)f(modern)e(and)i("better")f(than)h
(broadcast.)f(In)h(IPv6,)f(broadcast)g(doesn')o(t)f(w)o(ork)396
2096 y(at)j(all:)g(you)e(ha)n(v)o(e)h(to)g(al)o(w)o(ays)h(use)f
(broadcast.)f(Nonetheless,)g(all)i(IPv4)e(local)i(netw)o(ork)e(disco)o
(v)o(ery)f(protocols)g(end)i(up)396 2204 y(using)g(UDP)h(broadcast)e
(an)o(yho)n(w)-5 b(.)17 b(The)j(reasons:)g(broadcast)f(and)g(multicast)
i(end)e(up)h(w)o(orking)f(much)g(the)h(same,)396 2312
y(e)o(xcept)f(broadcast)g(is)i(simpler)f(and)g(less)h(risk)o(y)-5
b(.)19 b(Multicast)i(is)g(seen)f(by)g(netw)o(ork)f(admins)g(as)i(kind)f
(of)g(dangerous,)d(as)396 2420 y(it)k(can)f(leak)g(o)o(v)o(er)f(netw)o
(ork)g(se)o(gments.)-2 2604 y
SDict begin H.S end
 -2 2604 a -2 2604 a
SDict begin 13 H.A end
 -2
2604 a -2 2604 a
SDict begin [/View [/XYZ H.V]/Dest (0:4869) cvn /DEST pdfmark end
 -2 2604 a 396 2694 a Fj(If)h(you)g(ne)n(v)o(er)e(used)
i(UDP)-9 b(,)21 b(you')o(ll)e(disco)o(v)o(er)g(it')-5
b(s)21 b(quite)f(a)g(nice)g(protocol.)e(In)i(some)g(w)o(ays)h(it)g
(reminds)e(us)i(of)f(\330MQ,)396 2802 y(sending)f(whole)h(messages)g
(to)h(peers)f(using)f(a)i(tw)o(o)f(dif)n(ferent)f(patterns:)g
(one-to-one,)f(and)h(one-to-man)o(y)-5 b(.)16 b(The)k(main)396
2910 y(problems)f(with)h(UDP)h(are)f(that)h(\(a\))f(the)g(POSIX)g(sock)
o(et)g(API)h(w)o(as)g(designed)e(for)g(uni)n(v)o(ersal)g(\003e)o
(xibility)h(not)396 3018 y(simplicity)-5 b(,)20 b(\(b\))f(UDP)i
(messages)f(are)g(limited)g(for)g(practical)g(purposes)e(to)j(about)e
(512)g(bytes,)h(and)g(\(c\))g(when)f(you)396 3126 y(start)i(to)f(use)h
(UDP)g(for)e(real)h(data,)g(you)f(\002nd)h(that)h(a)f(lot)h(of)f
(messages)g(get)g(dropped,)e(especially)h(as)i(infrastructure)396
3234 y(tends)f(to)h(f)o(a)n(v)n(or)e(TCP)i(o)o(v)o(er)e(UDP)-9
b(.)-2 3401 y
SDict begin H.S end
 -2 3401 a -2 3401 a
SDict begin 13 H.A end
 -2 3401 a -2 3401 a
SDict begin [/View [/XYZ H.V]/Dest (0:4870) cvn /DEST pdfmark end

-2 3401 a 396 3508 a Fj(Here)20 b(is)h(a)g(minimal)f(ping)f(program)f
(that)i(uses)h(UDP)g(instead)f(of)g(ICMP_ECHO:)-2 3526
y
SDict begin H.S end
 -2 3526 a -2 3526 a
SDict begin 13 H.A end
 -2 3526 a -2 3526 a
SDict begin [/View [/XYZ H.V]/Dest (0:udpping1-php) cvn /DEST pdfmark
end
 -2 3526 a 396
3709 a Fk(Example)h(8-1.)e(UDP)h(disco)o(v)o(ery)-5 b(,)20
b(model)h(1)f(\(udpping1.php\))-2 3809 y
SDict begin H.S end
 -2 3809 a -2
3809 a
SDict begin 11.7 H.A end
 -2 3809 a -2 3809 a
SDict begin [/View [/XYZ H.V]/Dest (0:4873) cvn /DEST pdfmark end
 -2 3809 a 396 3889 a Fg(\(This)44
b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
4067 y
SDict begin H.S end
 -2 4067 a -2 4067 a
SDict begin 13 H.A end
 -2 4067 a -2 4067 a
SDict begin [/View [/XYZ H.V]/Dest (0:4874) cvn /DEST pdfmark end
 -2 4067
a 396 4163 a Fj(This)21 b(code)e(uses)i(a)f(single)h(sock)o(et)f(to)g
(broadcast)f(1-byte)g(messages)h(and)g(recei)n(v)o(e)f(an)o(ything)f
(that)i(other)g(nodes)f(are)396 4271 y(broadcasting.)f(When)i(I)g(run)g
(it,)h(it)f(sho)n(ws)h(just)f(one)g(node,)f(which)h(is)h(itself:)-2
4372 y
SDict begin H.S end
 -2 4372 a -2 4372 a
SDict begin 11.7 H.A end
 -2 4372 a -2 4372 a
SDict begin [/View [/XYZ H.V]/Dest (0:4875) cvn /DEST pdfmark end
 -2 4372
a 396 4451 a Fg(Pinging)44 b(peers...)396 4548 y(Found)g(peer)g
(192.168.1.2:9999)396 4645 y(Pinging)g(peers...)396 4743
y(Found)g(peer)g(192.168.1.2:9999)-2 4920 y
SDict begin H.S end
 -2 4920 a
-2 4920 a
SDict begin 13 H.A end
 -2 4920 a -2 4920 a
SDict begin [/View [/XYZ H.V]/Dest (0:4876) cvn /DEST pdfmark end
 -2 4920 a 396 5017 a Fj(If)20
b(I)h(switch)f(of)n(f)g(all)g(netw)o(orking)f(and)g(try)h(again,)f
(sending)g(a)i(message)f(f)o(ails,)g(as)h(I')l(d)f(e)o(xpect:)p
Black 3756 5569 a Fi(347)p Black eop end
%%Page: 348 362
TeXDict begin 348 361 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.348) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4877) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fg(Pinging)44 b(peers...)396
170 y(sendto:)g(Network)g(is)g(unreachable)-2 337 y
SDict begin H.S end
 -2
337 a -2 337 a
SDict begin 13 H.A end
 -2 337 a -2 337 a
SDict begin [/View [/XYZ H.V]/Dest (0:4878) cvn /DEST pdfmark end
 -2 337 a 396 444 a Fj(W)-7
b(orking)20 b(on)f(the)i(basis)f(of)1208 444 y
SDict begin H.S end
 1208 444
a 1208 444 a
SDict begin 13 H.A end
 1208 444 a 1208 444 a
SDict begin [/View [/XYZ H.V]/Dest (0:4879) cvn /DEST pdfmark end
 1208 444 a Fi(solve)h(the)f(pr)l
(oblems)g(curr)m(ently)g(aiming)f(at)i(your)f(thr)l(oat)q
Fj(,)g(let')-5 b(s)21 b(\002x)f(the)h(most)f(ur)o(gent)396
552 y(issues)h(in)g(this)f(\002rst)h(model.)e(These)h(issues)i(are:)-2
553 y
SDict begin H.S end
 -2 553 a -2 553 a
SDict begin 13 H.A end
 -2 553 a -2 553 a
SDict begin [/View [/XYZ H.V]/Dest (0:4880) cvn /DEST pdfmark end
 -2 553 a -2
563 a
SDict begin H.S end
 -2 563 a -2 563 a
SDict begin 13 H.A end
 -2 563 a -2 563 a
SDict begin [/View [/XYZ H.V]/Dest (0:4881) cvn /DEST pdfmark end
 -2 563 a Black
396 722 a Fe(\225)p Black 479 722 a
SDict begin H.S end
 479 722 a 479 722
a
SDict begin 13 H.A end
 479 722 a 479 722 a
SDict begin [/View [/XYZ H.V]/Dest (0:4882) cvn /DEST pdfmark end
 479 722 a Fj(Using)e(the)h(255.255.255.25)o(5)15
b(broadcast)k(address)g(is)i(a)g(bit)g(dubious.)d(On)i(the)g(one)g
(hand,)f(this)i(broadcast)e(address)479 830 y(means)h(precisely)g
("send)f(to)i(all)g(nodes)e(on)h(the)g(local)g(netw)o(ork,)f(and)h
(don')o(t)e(forw)o(ard".)g(Ho)n(we)n(v)o(er)m(,)g(if)j(you)e(ha)n(v)o
(e)479 938 y(se)n(v)o(eral)h(interf)o(aces)f(\(wired)h(Ethernet,)f(W)m
(iFi\))h(then)g(broadcasts)f(will)i(go)f(out)g(on)g(your)f(def)o(ault)g
(route)g(only)-5 b(,)19 b(and)479 1045 y(via)h(just)h(one)f(interf)o
(ace.)f(What)i(we)f(w)o(ant)g(to)h(do)f(is)h(either)e(send)h(our)g
(broadcast)f(on)g(each)h(interf)o(ace')-5 b(s)20 b(broadcast)479
1153 y(address,)g(or)g(\002nd)g(the)g(W)m(iFi)h(interf)o(ace)e(and)h
(its)h(broadcast)e(address.)-2 1165 y
SDict begin H.S end
 -2 1165 a -2 1165
a
SDict begin 13 H.A end
 -2 1165 a -2 1165 a
SDict begin [/View [/XYZ H.V]/Dest (0:4883) cvn /DEST pdfmark end
 -2 1165 a Black 396 1303 a Fe(\225)p
Black 479 1303 a
SDict begin H.S end
 479 1303 a 479 1303 a
SDict begin 13 H.A end
 479 1303 a 479
1303 a
SDict begin [/View [/XYZ H.V]/Dest (0:4884) cvn /DEST pdfmark end
 479 1303 a Fj(Lik)o(e)h(man)o(y)f(aspects)i(of)f(sock)o(et)g
(programming,)c(getting)k(information)d(on)j(netw)o(ork)f(interf)o
(aces)h(is)h(not)f(portable.)479 1411 y(Do)g(we)h(w)o(ant)f(to)h(write)
f(non-portable)d(code)j(in)g(our)f(applications?)g(No,)h(this)h(is)g
(better)f(hidden)f(in)h(a)h(library)-5 b(.)-2 1429 y
SDict begin H.S end

-2 1429 a -2 1429 a
SDict begin 13 H.A end
 -2 1429 a -2 1429 a
SDict begin [/View [/XYZ H.V]/Dest (0:4885) cvn /DEST pdfmark end
 -2 1429 a Black
396 1560 a Fe(\225)p Black 479 1560 a
SDict begin H.S end
 479 1560 a 479
1560 a
SDict begin 13 H.A end
 479 1560 a 479 1560 a
SDict begin [/View [/XYZ H.V]/Dest (0:4886) cvn /DEST pdfmark end
 479 1560 a Fj(There')g(s)20
b(no)g(handling)e(for)i(errors)f(e)o(xcept)g("abort",)g(which)h(is)h
(too)f(brutal)f(for)h(transient)f(problems)g(lik)o(e)i("your)479
1668 y(W)m(iFi)g(is)h(switched)d(of)n(f".)h(The)f(code)h(should)f
(distinguish)g(between)h(soft)g(errors)f(\(ignore)g(and)g(retry\))h
(and)f(hard)479 1776 y(errors)h(\(assert\).)-2 1791 y
SDict begin H.S end

-2 1791 a -2 1791 a
SDict begin 13 H.A end
 -2 1791 a -2 1791 a
SDict begin [/View [/XYZ H.V]/Dest (0:4887) cvn /DEST pdfmark end
 -2 1791 a Black
396 1926 a Fe(\225)p Black 479 1926 a
SDict begin H.S end
 479 1926 a 479
1926 a
SDict begin 13 H.A end
 479 1926 a 479 1926 a
SDict begin [/View [/XYZ H.V]/Dest (0:4888) cvn /DEST pdfmark end
 479 1926 a Fj(The)g(code)g(needs)f(to)i
(kno)n(w)e(its)i(o)n(wn)f(IP)g(address)g(and)g(ignore)f(beacons)g(that)
h(it)h(sent)f(out.)g(Lik)o(e)g(\002nding)f(the)479 2033
y(broadcast)g(address,)h(this)g(requires)g(inspecting)f(the)h(a)n(v)n
(ailable)g(interf)o(aces.)-2 2217 y
SDict begin H.S end
 -2 2217 a -2 2217
a
SDict begin 13 H.A end
 -2 2217 a -2 2217 a
SDict begin [/View [/XYZ H.V]/Dest (0:4889) cvn /DEST pdfmark end
 -2 2217 a 396 2307 a Fj(The)g(simplest)h(answer)f
(to)g(these)g(issues)h(is)g(to)g(push)e(the)i(UDP)f(code)g(into)g(a)g
(separate)g(library)f(that)i(pro)o(vided)c(a)k(clean)396
2415 y(API,)g(lik)o(e)f(this:)-2 2510 y
SDict begin H.S end
 -2 2510 a -2
2510 a
SDict begin 11.7 H.A end
 -2 2510 a -2 2510 a
SDict begin [/View [/XYZ H.V]/Dest (0:4890) cvn /DEST pdfmark end
 -2 2510 a 396 2596 a Fg(//)90
b(Constructor)396 2693 y(static)44 b(udp_t)979 2706 y(*)576
2790 y(udp_new)f(\(int)h(port_nbr\);)396 2984 y(//)90
b(Destructor)396 3081 y(static)44 b(void)576 3178 y(udp_destroy)f
(\(udp_t)1427 3191 y(**)1517 3178 y(self_p\);)396 3373
y(//)90 b(Returns)43 b(UDP)i(socket)e(handle)396 3470
y(static)h(int)576 3567 y(udp_handle)f(\(udp_t)1383 3580
y(*)1428 3567 y(self\);)396 3761 y(//)90 b(Send)44 b(message)f(using)h
(UDP)h(broadcast)396 3858 y(static)f(void)576 3955 y(udp_send)f
(\(udp_t)1293 3968 y(*)1338 3955 y(self,)h(byte)1831
3968 y(*)1876 3955 y(buffer,)f(size_t)h(length\);)396
4150 y(//)90 b(Receive)43 b(message)h(from)g(UDP)g(broadcast)396
4247 y(static)g(ssize_t)576 4344 y(udp_recv)f(\(udp_t)1293
4357 y(*)1338 4344 y(self,)h(byte)1831 4357 y(*)1876
4344 y(buffer,)f(size_t)h(length\);)-2 4522 y
SDict begin H.S end
 -2 4522
a -2 4522 a
SDict begin 13 H.A end
 -2 4522 a -2 4522 a
SDict begin [/View [/XYZ H.V]/Dest (0:4891) cvn /DEST pdfmark end
 -2 4522 a 396 4618 a
Fj(Here)20 b(is)h(the)g(ref)o(actored)d(UDP)j(ping)e(program)f(that)j
(calls)f(this)h(library)-5 b(,)19 b(which)g(is)i(much)f(cleaner)f(and)h
(nicer:)-2 4636 y
SDict begin H.S end
 -2 4636 a -2 4636 a
SDict begin 13 H.A end
 -2 4636 a -2 4636
a
SDict begin [/View [/XYZ H.V]/Dest (0:udpping2-php) cvn /DEST pdfmark
end
 -2 4636 a Black 3759 5569 a Fi(348)p Black eop end
%%Page: 349 363
TeXDict begin 349 362 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.349) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 72 a Fk(Example)h(8-2.)e(UDP)h(disco)o(v)o
(ery)-5 b(,)20 b(model)h(2)f(\(udpping2.php\))-2 172
y
SDict begin H.S end
 -2 172 a -2 172 a
SDict begin 11.7 H.A end
 -2 172 a -2 172 a
SDict begin [/View [/XYZ H.V]/Dest (0:4894) cvn /DEST pdfmark end
 -2 172 a 396 253
a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h(PHP\))
-2 430 y
SDict begin H.S end
 -2 430 a -2 430 a
SDict begin 13 H.A end
 -2 430 a -2 430 a
SDict begin [/View [/XYZ H.V]/Dest (0:4895) cvn /DEST pdfmark end
 -2 430 a
396 527 a Fj(The)20 b(library)-5 b(,)19 b(udplib,)f(hides)i(a)h(lot)f
(of)g(the)g(unpleasant)f(code)h(\(which)f(will)i(become)e(uglier)g(we)i
(mak)o(e)f(this)g(w)o(ork)g(on)396 635 y(more)g(systems\).)g(I'm)f(not)
h(going)f(to)h(print)g(that)g(code)g(here.)f(Y)-9 b(ou)20
b(can)g(read)f(it)2688 635 y
SDict begin H.S end
 2688 635 a 2688 635 a
SDict begin 13 H.A end
 2688
635 a 2688 635 a
SDict begin [/View [/XYZ H.V]/Dest (0:4896) cvn /DEST pdfmark end
 2688 635 a Fj(in)i(the)f(repository)396
742 y(\(https://github)m(.com/imatix/zguide/blo)o(b/m)o(aster/e)o(x)o
(amp)o(les/C/udp)o(lib)m(.c)o(\).)-2 926 y
SDict begin H.S end
 -2 926 a -2
926 a
SDict begin 13 H.A end
 -2 926 a -2 926 a
SDict begin [/View [/XYZ H.V]/Dest (0:4897) cvn /DEST pdfmark end
 -2 926 a 396 1016 a Fj(No)n(w)-5
b(,)20 b(there)f(are)i(more)e(problems)g(sizing)h(us)g(up)g(and)g(w)o
(ondering)e(if)i(the)o(y)g(can)g(mak)o(e)f(lunch)h(out)g(of)f(us.)i
(First,)g(IPv4)396 1124 y(v)o(ersus)f(IPv6)f(and)h(multicast)g(vs.)h
(broadcast.)d(In)i(IPv6,)g(broadcast)e(doesn')o(t)h(e)o(xist)h(at)h
(all;)g(one)f(uses)g(multicast.)g(From)396 1232 y(my)g(e)o(xperience)e
(with)j(W)m(iFi,)f(IPv4)g(multicast)g(and)g(broadcast)f(w)o(ork)g
(identically)h(e)o(xcept)f(that)h(multicast)g(breaks)g(in)396
1340 y(some)g(situations)g(where)g(broadcast)f(w)o(orks)h(\002ne.)g
(Some)g(access)g(points)g(do)g(not)g(forw)o(ard)e(multicast)j(pack)o
(ets.)e(When)396 1448 y(you)h(ha)n(v)o(e)f(a)i(de)n(vice)e(\(e.g.)g(a)i
(tablet\))f(that)g(acts)h(as)g(a)g(mobile)e(AP)-9 b(,)20
b(then)g(it')-5 b(s)21 b(possible)f(it)h(w)o(on')o(t)e(get)i(multicast)
f(pack)o(ets.)396 1556 y(Meaning,)f(it)i(w)o(on')o(t)e(see)i(other)e
(peers)h(on)g(the)g(netw)o(ork.)-2 1740 y
SDict begin H.S end
 -2 1740 a -2
1740 a
SDict begin 13 H.A end
 -2 1740 a -2 1740 a
SDict begin [/View [/XYZ H.V]/Dest (0:4898) cvn /DEST pdfmark end
 -2 1740 a 396 1830 a Fj(The)g(simplest)h
(plausible)e(solution)h(is)h(simply)e(to)i(ignore)e(IPv6)g(for)h(no)n
(w)-5 b(,)19 b(and)g(use)i(broadcast.)e(A)h(perhaps)f(smarter)396
1938 y(solution)h(w)o(ould)f(be)h(to)h(use)f(multicast,)g(and)g(deal)g
(with)g(asymmetric)f(beacons)g(if)i(the)o(y)e(happen.)-2
2122 y
SDict begin H.S end
 -2 2122 a -2 2122 a
SDict begin 13 H.A end
 -2 2122 a -2 2122 a
SDict begin [/View [/XYZ H.V]/Dest (0:4899) cvn /DEST pdfmark end
 -2 2122
a 396 2212 a Fj(W)-7 b(e')o(ll)22 b(stick)e(with)h(stupid)e(and)h
(simple)g(for)g(no)n(w)-5 b(.)19 b(There')-5 b(s)19 b(al)o(w)o(ays)i
(time)f(to)h(mak)o(e)e(it)i(more)f(comple)o(x.)-2 2240
y
SDict begin H.S end
 -2 2240 a -2 2240 a
SDict begin 13 H.A end
 -2 2240 a -2 2240 a
SDict begin [/View [/XYZ H.V]/Dest (0:4900) cvn /DEST pdfmark end
 -2 2240 a 396
2550 a Fd(8.3.3.)36 b(Multiple)e(Nodes)g(on)f(One)h(De)n(vice)2438
2550 y
SDict begin H.S end
 2438 2550 a 2438 2550 a
SDict begin 18.72 H.A end
 2438 2550 a 2438 2550
a
SDict begin [/View [/XYZ H.V]/Dest (13.84.119.2) cvn /DEST pdfmark
end
 2438 2550 a -2 2741 a
SDict begin H.S end
 -2 2741 a -2 2741 a
SDict begin 13 H.A end
 -2 2741 a
-2 2741 a
SDict begin [/View [/XYZ H.V]/Dest (0:4902) cvn /DEST pdfmark end
 -2 2741 a 396 2824 a Fj(So)20 b(we)g(can)g(disco)o(v)o(er)e
(nodes)h(on)g(the)h(W)m(iFi)h(netw)o(ork,)d(as)i(long)f(as)i(the)o(y')l
(re)d(sending)g(out)i(beacons)f(as)h(we)g(e)o(xpect.)f(So)h(I)396
2932 y(try)g(to)h(test)g(with)f(tw)o(o)g(processes.)g(But)h(when)e(I)i
(run)e(udpping2)f(twice,)i(the)g(second)g(instance)f(complains)g
("'Address)396 3040 y(already)g(in)i(use')f(on)g(bind")f(and)g(e)o
(xits.)i(Oh,)e(right.)h(UDP)h(and)e(TCP)i(both)f(return)f(an)h(error)f
(if)h(you)g(try)g(to)g(bind)f(tw)o(o)396 3148 y(dif)n(ferent)g(sock)o
(ets)h(to)g(the)h(same)f(port.)f(This)i(is)g(right.)e(The)h(semantics)g
(of)g(tw)o(o)h(readers)e(on)h(one)f(sock)o(et)h(w)o(ould)g(be)396
3256 y(weird)g(to)g(say)h(the)f(least.)h(Odd/e)n(v)o(en)d(bytes?)i(Y)-9
b(ou)19 b(get)i(all)f(the)h(1s,)f(I)g(get)h(all)f(the)h(0')-5
b(s?)-2 3440 y
SDict begin H.S end
 -2 3440 a -2 3440 a
SDict begin 13 H.A end
 -2 3440 a -2 3440
a
SDict begin [/View [/XYZ H.V]/Dest (0:4903) cvn /DEST pdfmark end
 -2 3440 a 396 3530 a Fj(Ho)n(we)n(v)o(er)m(,)18 b(a)i(quick)e(check)h
(of)g(stack)o(o)o(v)o(er\003o)n(w)e(and)i(some)h(memory)d(of)j(a)g
(sock)o(et)f(option)f(called)h(SO_REUSEADDR)396 3638
y(turns)h(up)g(gold.)f(If)h(I)g(use)h(that,)f(I)g(can)g(bind)g(se)n(v)o
(eral)f(processes)h(to)g(the)h(same)f(UDP)h(port,)e(and)h(the)o(y)f
(will)i(all)g(recei)n(v)o(e)396 3746 y(an)o(y)f(message)g(arri)n(ving)e
(on)i(that)g(port.)g(It')-5 b(s)20 b(almost)h(as)f(if)h(the)f(guys)g
(who)f(designed)g(this)i(were)f(reading)f(my)h(mind!)396
3854 y(\(That')-5 b(s)20 b(w)o(ay)g(more)g(plausible)f(than)h(maybe)f
(I'm)h(rein)m(v)o(enting)d(the)j(wheel.\))-2 4038 y
SDict begin H.S end
 -2
4038 a -2 4038 a
SDict begin 13 H.A end
 -2 4038 a -2 4038 a
SDict begin [/View [/XYZ H.V]/Dest (0:4904) cvn /DEST pdfmark end
 -2 4038 a 396 4128
a Fj(A)h(quick)e(test)i(sho)n(ws)f(that)h(SO_REUSADDR)g(w)o(orks)e(as)i
(promised.)e(This)h(is)h(great)f(because)g(the)g(ne)o(xt)f(thing)h(I)g
(w)o(ant)396 4236 y(to)h(do)e(is)j(design)d(an)h(API)h(and)e(then)h
(start)h(dozens)e(of)h(nodes)f(to)i(see)g(them)e(disco)o(v)o(ering)f
(each)i(other)-5 b(.)19 b(It)i(w)o(ould)e(be)396 4344
y(really)h(cumbersome)e(to)i(ha)n(v)o(e)g(to)g(test)h(each)f(node)f(on)
h(a)h(separate)f(de)n(vice.)f(And)g(when)h(we)h(get)f(to)g(testing)g
(ho)n(w)g(real)396 4452 y(traf)n(\002c)g(beha)n(v)o(es)f(on)h(a)h(lar)o
(ge,)e(\003ak)o(y)g(netw)o(ork,)g(the)h(tw)o(o)h(alternati)n(v)o(es)e
(are)h(simulation)f(or)h(temporary)e(insanity)-5 b(.)-2
4636 y
SDict begin H.S end
 -2 4636 a -2 4636 a
SDict begin 13 H.A end
 -2 4636 a -2 4636 a
SDict begin [/View [/XYZ H.V]/Dest (0:4905) cvn /DEST pdfmark end
 -2 4636
a 396 4726 a Fj(And)20 b(I)g(speak)g(from)f(e)o(xperience:)f(we)j
(were,)f(this)h(summer)m(,)d(testing)i(on)g(dozens)g(of)f(de)n(vices)h
(at)h(once.)e(It)i(tak)o(es)f(about)396 4834 y(an)g(hour)f(to)i(set-up)
e(a)i(full)f(test)h(run,)e(and)h(you)f(need)h(a)g(space)g(shielded)g
(from)f(W)m(iFi)i(interference)d(if)j(you)e(w)o(ant)h(an)o(y)396
4941 y(kind)g(of)g(reproducibility)d(\(unless)j(your)f(test)i(case)f
(is)h("pro)o(v)o(e)e(that)h(interference)e(kills)j(W)m(iFi)g(netw)o
(orks)e(f)o(aster)i(than)396 5049 y(Orv)n(al)f(can)g(kill)g(a)h
(thirst".)p Black 3759 5569 a Fi(349)p Black eop end
%%Page: 350 364
TeXDict begin 350 363 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.350) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4906) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(If)g(I)h(w)o(as)g(a)f(wizz)h
(Android)d(de)n(v)o(eloper)g(with)i(a)h(free)f(week)o(end)f(I')l(d)g
(immediately)g(\(as)i(in,)f(it)h(w)o(ould)e(tak)o(e)h(me)h(tw)o(o)396
180 y(days\))f(port)f(this)i(code)f(to)g(my)g(phone)e(and)i(get)g(it)h
(sending)e(beacons)g(to)i(my)f(PC.)h(But)f(sometimes)g(lazy)g(is)h
(more)396 288 y(pro\002table.)e(I)804 288 y
SDict begin H.S end
 804 288 a
804 288 a
SDict begin 13 H.A end
 804 288 a 804 288 a
SDict begin [/View [/XYZ H.V]/Dest (0:4907) cvn /DEST pdfmark end
 804 288 a Fi(lik)o(e)i
Fj(my)f(Linux)f(laptop.)g(I)i(lik)o(e)f(being)f(able)h(to)h(start)f(a)h
(dozen)e(threads)h(from)f(one)g(process,)h(and)f(ha)n(v)o(e)396
396 y(each)h(thread)f(acting)h(lik)o(e)g(an)h(independent)c(node.)i(I)h
(lik)o(e)h(not)f(ha)n(ving)f(to)h(w)o(ork)g(in)g(a)h(real)f(F)o(araday)
f(cage)h(when)f(I)i(can)396 504 y(simulate)f(one)g(on)g(my)g(laptop.)-2
533 y
SDict begin H.S end
 -2 533 a -2 533 a
SDict begin 13 H.A end
 -2 533 a -2 533 a
SDict begin [/View [/XYZ H.V]/Dest (0:4908) cvn /DEST pdfmark end
 -2 533 a 396
843 a Fd(8.3.4.)36 b(Designing)f(the)e(API)1751 843 y
SDict begin H.S end

1751 843 a 1751 843 a
SDict begin 18.72 H.A end
 1751 843 a 1751 843 a
SDict begin [/View [/XYZ H.V]/Dest (13.84.120.2) cvn /DEST pdfmark
end
 1751 843
a -2 1035 a
SDict begin H.S end
 -2 1035 a -2 1035 a
SDict begin 13 H.A end
 -2 1035 a -2 1035 a
SDict begin [/View [/XYZ H.V]/Dest (0:4910) cvn /DEST pdfmark end
 -2
1035 a 396 1117 a Fj(I'm)20 b(going)f(to)h(run)g(N)g(nodes)g(on)f(a)i
(de)n(vice,)e(and)h(the)o(y)f(are)h(going)f(to)i(ha)n(v)o(e)e(to)i
(disco)o(v)o(er)d(each)i(other)m(,)f(and)g(also)396 1225
y(disco)o(v)o(er)g(a)h(b)n(unch)f(of)h(other)g(nodes)f(out)h(there)g
(on)f(the)i(local)f(netw)o(ork.)f(I)h(can)g(use)g(UDP)h(for)f(local)g
(disco)o(v)o(ery)e(as)j(well)396 1333 y(as)g(remote)e(disco)o(v)o(ery)
-5 b(.)18 b(It')-5 b(s)21 b(ar)o(guably)d(not)h(as)i(ef)n(\002cient)f
(as)h(using,)e(e.g.,)h(the)g(\330MQ)g(inproc://)f(transport,)g(b)n(ut)h
(has)h(the)396 1440 y(great)f(adv)n(antage)e(that)j(the)f(e)o(xact)f
(same)i(code)e(will)i(w)o(ork)f(in)g(simulation)f(and)h(in)g(real)h
(deplo)o(yment.)-2 1624 y
SDict begin H.S end
 -2 1624 a -2 1624 a
SDict begin 13 H.A end
 -2 1624
a -2 1624 a
SDict begin [/View [/XYZ H.V]/Dest (0:4911) cvn /DEST pdfmark end
 -2 1624 a 396 1714 a Fj(If)f(I)h(ha)n(v)o(e)e(multiple)h
(nodes)f(on)h(one)g(de)n(vice,)f(we)h(clearly)g(can')o(t)f(use)i(the)f
(IP)g(address)g(and)g(port)f(number)g(as)i(node)396 1822
y(address.)f(I)g(need)g(some)g(logical)f(node)h(identi\002er)-5
b(.)19 b(Ar)o(guably)-5 b(,)17 b(the)k(node)e(identi\002er)g(only)h
(has)g(to)h(be)f(unique)e(within)396 1930 y(the)i(conte)o(xt)f(of)h
(the)h(de)n(vice.)e(My)h(mind)f(\002lls)j(with)e(comple)o(x)e(stuf)n(f)
i(I)h(could)e(mak)o(e,)g(lik)o(e)i(supernodes)d(that)i(sit)i(on)d(real)
396 2038 y(UDP)i(ports)f(and)f(forw)o(ard)g(messages)i(to)f(internal)f
(nodes.)g(I)i(hit)f(my)g(head)g(on)f(the)i(table)f(until)g(the)g(idea)g
(of)3536 2038 y
SDict begin H.S end
 3536 2038 a 3536 2038 a
SDict begin 13 H.A end
 3536 2038 a 3536
2038 a
SDict begin [/View [/XYZ H.V]/Dest (0:4912) cvn /DEST pdfmark end
 3536 2038 a Fi(in)m(venting)396 2146 y(ne)o(w)h(concepts)e
Fj(lea)n(v)o(es)h(it.)-2 2329 y
SDict begin H.S end
 -2 2329 a -2 2329 a
SDict begin 13 H.A end
 -2
2329 a -2 2329 a
SDict begin [/View [/XYZ H.V]/Dest (0:4913) cvn /DEST pdfmark end
 -2 2329 a 396 2420 a Fj(Experience)e(tells)k(us)e
(that)g(W)m(iFi)i(does)e(things)f(lik)o(e)i(disappear)e(and)g(reappear)
g(while)h(applications)f(are)h(running.)396 2528 y(Users)h(click)f(on)g
(things.)f(Which)i(does)f(interesting)f(things)h(lik)o(e)g(change)f
(the)h(IP)h(address)e(halfw)o(ay)h(through)e(a)396 2636
y(session.)j(W)-7 b(e)21 b(cannot)e(depend)g(on)g(IP)i(addresses,)f
(nor)f(on)h(established)f(connections)g(\(in)h(the)g(TCP)h(f)o
(ashion\).)e(W)-7 b(e)396 2744 y(need)20 b(some)g(long-lasting)e
(addressing)h(mechanism)g(that)h(survi)n(v)o(es)f(interf)o(aces)h(and)g
(connections)e(being)h(torn)h(do)n(wn,)396 2852 y(and)g(then)g
(recreated.)-2 3019 y
SDict begin H.S end
 -2 3019 a -2 3019 a
SDict begin 13 H.A end
 -2 3019 a -2
3019 a
SDict begin [/View [/XYZ H.V]/Dest (0:4914) cvn /DEST pdfmark end
 -2 3019 a 396 3126 a Fj(Here')-5 b(s)21 b(the)f(simplest)g
(solution)g(I)g(can)g(see:)h(we)g(gi)n(v)o(e)e(e)n(v)o(ery)g(node)g(a)i
(UUID,)f(and)f(specify)h(that)g(nodes,)f(represented)396
3234 y(by)h(their)g(UUIDs,)g(can)g(appear)f(or)h(reappear)f(at)h
(certain)g(IP)h(address:port)d(endpoints,)h(and)g(then)h(disappear)f
(again.)396 3342 y(W)-7 b(e')o(ll)22 b(deal)e(with)g(reco)o(v)o(ery)e
(from)h(lost)i(messages)f(later)-5 b(.)20 b(A)h(UUID)f(is)h(16)f
(bytes.)g(So)g(if)h(I)f(ha)n(v)o(e)g(100)f(nodes)h(on)f(a)i(W)m(iFi)396
3450 y(netw)o(ork)e(that')-5 b(s)21 b(\(double)d(it)j(for)f(other)f
(random)g(stuf)n(f\))g(3,200)g(bytes)h(a)g(second)g(of)f(beacon)g(data)
h(that)h(the)f(air)g(has)h(to)396 3557 y(carry)f(just)g(for)g(disco)o
(v)o(ery)e(and)i(presence.)e(Seems)j(acceptable.)-2 3742
y
SDict begin H.S end
 -2 3742 a -2 3742 a
SDict begin 13 H.A end
 -2 3742 a -2 3742 a
SDict begin [/View [/XYZ H.V]/Dest (0:4915) cvn /DEST pdfmark end
 -2 3742 a 396
3831 a Fj(Back)g(to)f(concepts.)f(W)-7 b(e)21 b(do)f(need)g(some)g
(names)f(for)h(our)f(API.)i(At)g(the)f(least)h(we)f(need)g(a)g(w)o(ay)h
(to)f(distinguish)396 3939 y(between)g(the)g(node)f(object)h(that)g(is)
h("us",)f(and)g(node)f(objects)h(that)g(are)g(our)g(peers.)f(W)-7
b(e')o(ll)22 b(be)e(doing)f(things)g(lik)o(e)396 4047
y(creating)g(an)i("us")f(and)g(then)f(asking)h(it)h(ho)n(w)e(man)o(y)g
(peers)h(it)h(kno)n(ws)f(about)f(and)g(who)h(the)o(y)g(are.)g(The)f
(term)h("peer")g(is)396 4155 y(clear)g(enough.)-2 4339
y
SDict begin H.S end
 -2 4339 a -2 4339 a
SDict begin 13 H.A end
 -2 4339 a -2 4339 a
SDict begin [/View [/XYZ H.V]/Dest (0:4916) cvn /DEST pdfmark end
 -2 4339 a 396
4429 a Fj(From)g(the)g(de)n(v)o(eloper)e(point)h(of)h(vie)n(w)-5
b(,)20 b(a)g(node)f(\(the)h(application\))f(needs)g(a)i(w)o(ay)f(to)h
(talk)f(to)g(the)h(outside)e(w)o(orld.)g(Let')-5 b(s)396
4537 y(borro)n(w)19 b(a)h(term)g(from)f(netw)o(orking)f(and)i(call)h
(this)f(an)h("interf)o(ace".)d(The)i(interf)o(ace)g(represents)f(us)i
(to)f(the)g(rest)h(of)f(the)396 4645 y(w)o(orld)g(and)g(presents)f(the)
i(rest)f(of)g(the)g(w)o(orld)g(to)g(us,)h(as)f(a)h(set)g(of)f(other)f
(peers.)h(It)h(automatically)d(does)i(whate)n(v)o(er)396
4753 y(disco)o(v)o(ery)e(it)j(has)g(to.)f(When)g(we)g(w)o(ant)h(to)f
(talk)g(to)h(a)f(peer)m(,)f(we)i(get)f(the)g(interf)o(ace)g(to)g(do)g
(that)g(for)g(us.)g(And)g(when)f(a)396 4861 y(peer)h(talks)g(to)h(us,)f
(it')-5 b(s)21 b(the)g(interf)o(ace)e(that)h(deli)n(v)o(ers)g(us)g(the)
g(message.)-2 5045 y
SDict begin H.S end
 -2 5045 a -2 5045 a
SDict begin 13 H.A end
 -2 5045 a -2
5045 a
SDict begin [/View [/XYZ H.V]/Dest (0:4917) cvn /DEST pdfmark end
 -2 5045 a 396 5135 a Fj(This)h(seems)f(lik)o(e)h(a)f(clean)g
(API)h(design.)e(Ho)n(w)h(about)f(the)i(internals?)-2
5153 y
SDict begin H.S end
 -2 5153 a -2 5153 a
SDict begin 13 H.A end
 -2 5153 a -2 5153 a
SDict begin [/View [/XYZ H.V]/Dest (0:4918) cvn /DEST pdfmark end
 -2 5153
a -2 5163 a
SDict begin H.S end
 -2 5163 a -2 5163 a
SDict begin 13 H.A end
 -2 5163 a -2 5163 a
SDict begin [/View [/XYZ H.V]/Dest (0:4919) cvn /DEST pdfmark end
 -2
5163 a Black 3759 5569 a Fi(350)p Black eop end
%%Page: 351 365
TeXDict begin 351 364 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.351) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:4920) cvn /DEST pdfmark end
 479 72 a
Fj(The)g(interf)o(ace)f(has)i(to)f(be)g(multithreaded,)e(so)j(that)f
(one)g(thread)f(can)h(do)g(I/O)g(in)g(the)h(background,)16
b(while)k(the)479 180 y(fore)o(ground)d(API)j(talks)h(to)f(the)g
(application.)f(W)-7 b(e)21 b(used)f(this)h(design)e(in)i(the)f(Clone)g
(and)g(Freelance)f(client)h(APIs.)-2 198 y
SDict begin H.S end
 -2 198 a -2
198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:4921) cvn /DEST pdfmark end
 -2 198 a Black 396 330 a Fe(\225)p
Black 479 330 a
SDict begin H.S end
 479 330 a 479 330 a
SDict begin 13 H.A end
 479 330 a 479 330
a
SDict begin [/View [/XYZ H.V]/Dest (0:4922) cvn /DEST pdfmark end
 479 330 a Fj(The)g(interf)o(ace)f(background)e(thread)i(does)h(the)h
(disco)o(v)o(ery)d(b)n(usiness;)i(bind)f(to)i(the)f(UDP)h(port,)e(send)
h(out)g(UDP)479 438 y(beacons,)f(and)h(recei)n(v)o(e)f(beacons.)-2
450 y
SDict begin H.S end
 -2 450 a -2 450 a
SDict begin 13 H.A end
 -2 450 a -2 450 a
SDict begin [/View [/XYZ H.V]/Dest (0:4923) cvn /DEST pdfmark end
 -2 450 a Black
396 587 a Fe(\225)p Black 479 587 a
SDict begin H.S end
 479 587 a 479 587
a
SDict begin 13 H.A end
 479 587 a 479 587 a
SDict begin [/View [/XYZ H.V]/Dest (0:4924) cvn /DEST pdfmark end
 479 587 a Fj(W)-7 b(e)22 b(need)d(to)h(at)h
(least)g(send)f(UUIDs)h(in)f(the)g(beacon)f(message)h(so)h(that)f(we)g
(can)g(distinguish)g(our)f(o)n(wn)h(beacons)479 695 y(from)f(those)h
(of)g(our)g(peers.)-2 713 y
SDict begin H.S end
 -2 713 a -2 713 a
SDict begin 13 H.A end
 -2 713
a -2 713 a
SDict begin [/View [/XYZ H.V]/Dest (0:4925) cvn /DEST pdfmark end
 -2 713 a Black 396 845 a Fe(\225)p Black 479
845 a
SDict begin H.S end
 479 845 a 479 845 a
SDict begin 13 H.A end
 479 845 a 479 845 a
SDict begin [/View [/XYZ H.V]/Dest (0:4926) cvn /DEST pdfmark end
 479 845
a Fj(W)-7 b(e)22 b(need)d(to)h(track)g(peers)g(that)g(appear)m(,)f(and)
g(that)i(disappear)-5 b(.)19 b(F)o(or)h(this)g(I')o(ll)h(use)f(a)h
(hash)f(table)g(that)g(stores)h(all)479 953 y(kno)n(wn)e(peers,)h(and)f
(e)o(xpire)g(peers)h(after)g(some)g(timeout.)-2 970 y
SDict begin H.S end

-2 970 a -2 970 a
SDict begin 13 H.A end
 -2 970 a -2 970 a
SDict begin [/View [/XYZ H.V]/Dest (0:4927) cvn /DEST pdfmark end
 -2 970 a Black 396
1102 a Fe(\225)p Black 479 1102 a
SDict begin H.S end
 479 1102 a 479 1102
a
SDict begin 13 H.A end
 479 1102 a 479 1102 a
SDict begin [/View [/XYZ H.V]/Dest (0:4928) cvn /DEST pdfmark end
 479 1102 a Fj(W)-7 b(e)22 b(need)d(a)i(w)o(ay)f
(to)g(report)f(peers)h(and)g(e)n(v)o(ents)f(to)i(the)f(caller)-5
b(.)20 b(Here)g(we)h(get)f(into)g(a)h(juic)o(y)e(question.)g(Ho)n(w)h
(does)g(a)479 1210 y(background)d(I/O)j(thread)g(tell)g(a)h(fore)o
(ground)16 b(API)21 b(thread)e(that)h(stuf)n(f)g(is)h(happening?)d
(Callbacks)i(maybe?)3630 1210 y
SDict begin H.S end
 3630 1210 a 3630 1210
a
SDict begin 13 H.A end
 3630 1210 a 3630 1210 a
SDict begin [/View [/XYZ H.V]/Dest (0:4929) cvn /DEST pdfmark end
 3630 1210 a Fi(Hec)n(k)479
1318 y(no.)g Fj(W)-7 b(e')o(ll)21 b(use)g(\330MQ)f(messages,)g(of)g
(course.)-2 1502 y
SDict begin H.S end
 -2 1502 a -2 1502 a
SDict begin 13 H.A end
 -2 1502 a -2 1502
a
SDict begin [/View [/XYZ H.V]/Dest (0:4930) cvn /DEST pdfmark end
 -2 1502 a 396 1592 a Fj(The)g(third)g(iteration)f(of)h(the)g(UDP)h
(ping)e(program)f(is)k(e)n(v)o(en)d(simpler)h(and)f(more)h(beautiful)f
(than)g(the)h(second.)f(The)396 1700 y(main)h(body)-5
b(,)18 b(in)j(C,)f(is)i(just)e(ten)h(lines)f(of)g(code.)-2
1718 y
SDict begin H.S end
 -2 1718 a -2 1718 a
SDict begin 13 H.A end
 -2 1718 a -2 1718 a
SDict begin [/View [/XYZ H.V]/Dest (0:udpping3-php) cvn /DEST pdfmark
end
 -2 1718
a 396 1901 a Fk(Example)h(8-3.)e(UDP)h(disco)o(v)o(ery)-5
b(,)20 b(model)h(3)f(\(udpping3.php\))-2 2001 y
SDict begin H.S end
 -2 2001
a -2 2001 a
SDict begin 11.7 H.A end
 -2 2001 a -2 2001 a
SDict begin [/View [/XYZ H.V]/Dest (0:4933) cvn /DEST pdfmark end
 -2 2001 a 396 2081 a
Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h(PHP\))-2
2259 y
SDict begin H.S end
 -2 2259 a -2 2259 a
SDict begin 13 H.A end
 -2 2259 a -2 2259 a
SDict begin [/View [/XYZ H.V]/Dest (0:4934) cvn /DEST pdfmark end
 -2 2259
a 396 2355 a Fj(The)20 b(interf)o(ace)f(code)h(should)f(be)h(f)o
(amiliar)g(if)g(you')l(v)o(e)e(studied)i(ho)n(w)g(we)g(mak)o(e)g
(multithreaded)e(API)i(classes:)-2 2373 y
SDict begin H.S end
 -2 2373 a -2
2373 a
SDict begin 13 H.A end
 -2 2373 a -2 2373 a
SDict begin [/View [/XYZ H.V]/Dest (0:interface-php) cvn /DEST pdfmark
end
 -2 2373 a 396 2556 a Fk(Example)h(8-4.)e
(UDP)h(ping)h(interface)e(\(interface.php\))-2 2656 y
SDict begin H.S end

-2 2656 a -2 2656 a
SDict begin 11.7 H.A end
 -2 2656 a -2 2656 a
SDict begin [/View [/XYZ H.V]/Dest (0:4937) cvn /DEST pdfmark end
 -2 2656 a 396
2737 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f(into)h
(PHP\))-2 2914 y
SDict begin H.S end
 -2 2914 a -2 2914 a
SDict begin 13 H.A end
 -2 2914 a -2 2914
a
SDict begin [/View [/XYZ H.V]/Dest (0:4938) cvn /DEST pdfmark end
 -2 2914 a 396 3011 a Fj(When)20 b(I)h(run)e(this)i(in)f(tw)o(o)h
(windo)n(ws,)e(it)i(reports)e(one)h(peer)f(joining)g(the)i(netw)o(ork.)
d(I)j(kill)f(that)h(peer)e(and)h(a)g(fe)n(w)396 3119
y(seconds)g(later)g(it)h(tells)g(me)f(the)h(peer)e(left:)-2
3220 y
SDict begin H.S end
 -2 3220 a -2 3220 a
SDict begin 11.7 H.A end
 -2 3220 a -2 3220 a
SDict begin [/View [/XYZ H.V]/Dest (0:4939) cvn /DEST pdfmark end
 -2 3220
a 396 3299 a Fg(--------------------------------------)396
3396 y([006])44 b(JOINED)396 3493 y([032])g
(418E98D4B7184844B7D5E0EE5691084C)396 3590 y
(--------------------------------------)396 3687 y([004])g(LEFT)396
3784 y([032])g(418E98D4B7184844B7D5E0EE5691084C)-2 3959
y
SDict begin H.S end
 -2 3959 a -2 3959 a
SDict begin 13 H.A end
 -2 3959 a -2 3959 a
SDict begin [/View [/XYZ H.V]/Dest (0:4940) cvn /DEST pdfmark end
 -2 3959 a 396
4058 a Fj(What')-5 b(s)21 b(nice)e(about)g(a)h(\330MQ-message)f(based)g
(API)h(is)g(that)g(I)g(can)f(wrap)g(this)h(an)o(y)f(w)o(ay)h(I)g(lik)o
(e.)f(F)o(or)g(instance,)g(turning)396 4166 y(it)i(into)f(callbacks)g
(if)g(I)h(really)e(w)o(ant)i(those.)f(I)g(can)g(also)g(trace)h(all)f
(acti)n(vity)g(on)g(the)g(API)h(v)o(ery)e(easily)-5 b(.)-2
4350 y
SDict begin H.S end
 -2 4350 a -2 4350 a
SDict begin 13 H.A end
 -2 4350 a -2 4350 a
SDict begin [/View [/XYZ H.V]/Dest (0:4941) cvn /DEST pdfmark end
 -2 4350
a 396 4440 a Fj(Some)20 b(notes)g(about)f(tuning.)g(On)h(Ethernet,)f
(\002)n(v)o(e)h(seconds)g(\(the)g(e)o(xpiry)e(time)j(I)f(used)g(in)g
(this)h(code\))e(seems)i(lik)o(e)f(a)h(lot.)396 4548
y(On)f(a)h(badly)e(stressed)i(W)m(iFi)g(netw)o(ork)e(you)g(can)h(get)h
(ping)e(latencies)h(of)g(30)g(seconds)f(or)h(more.)f(If)h(you)g(use)g
(a)396 4656 y(too-aggressi)n(v)o(e)e(v)n(alue)h(for)h(the)g(e)o(xpiry)
-5 b(,)18 b(you')o(ll)h(disconnect)g(nodes)h(that)g(are)g(still)h
(there.)f(On)g(the)g(other)g(side,)g(end)396 4764 y(user)g
(applications)f(e)o(xpect)h(a)g(certain)g(li)n(v)o(eliness.)g(If)g(it)h
(tak)o(es)f(30)g(seconds)g(to)g(report)f(that)h(a)h(node)e(has)h(gone,)
f(users)396 4872 y(will)i(get)f(anno)o(yed.)p Black 3759
5569 a Fi(351)p Black eop end
%%Page: 352 366
TeXDict begin 352 365 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.352) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4942) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(A)h(decent)e(strate)o(gy)h(is)h(to)
f(detect)g(and)g(report)f(disappeared)f(nodes)i(rapidly)-5
b(,)18 b(b)n(ut)i(only)f(delete)h(them)g(after)g(a)h(longer)396
180 y(interv)n(al.)e(V)-5 b(isually)g(,)20 b(a)g(node)g(w)o(ould)f(be)h
(green)f(when)h(it')-5 b(s)21 b(ali)n(v)o(e,)f(then)g(gray)f(for)g(a)i
(while)f(as)h(it)g(went)f(out)g(of)g(reach,)396 288 y(then)g(\002nally)
g(disappear)-5 b(.)19 b(W)-7 b(e')l(re)20 b(not)g(doing)f(this)i(no)n
(w)-5 b(,)19 b(b)n(ut)h(will)h(do)f(it)h(in)f(the)g(real)g
(implementation)e(of)i(the)396 396 y(as-yet-unnamed)d(frame)n(w)o(ork)h
(we')l(re)i(making.)-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580
a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:4943) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(As)h(we)g(will)g(also)f(see)h(later)m
(,)f(we)g(ha)n(v)o(e)g(to)g(treat)h(an)o(y)e(input)g(from)h(a)g(node,)f
(not)h(just)h(UDP)f(beacons,)f(as)i(a)g(sign)f(of)g(life.)396
778 y(UDP)h(may)f(get)g(squashed)f(when)g(there')-5 b(s)20
b(a)g(lot)h(of)f(TCP)g(traf)n(\002c.)g(This)g(is)h(perhaps)e(the)h
(main)g(reason)f(we')l(re)h(not)f(using)396 886 y(an)h(e)o(xisting)g
(UDP)h(disco)o(v)o(ery)d(library:)h(we)h(ha)n(v)o(e)g(to)g(inte)o
(grate)f(this)i(tightly)f(with)g(our)f(\330MQ)i(messaging)e(for)h(it)h
(to)396 994 y(w)o(ork.)-2 1005 y
SDict begin H.S end
 -2 1005 a -2 1005 a
SDict begin 13 H.A end

-2 1005 a -2 1005 a
SDict begin [/View [/XYZ H.V]/Dest (0:4944) cvn /DEST pdfmark end
 -2 1005 a 396 1333 a Fd(8.3.5.)36
b(More)c(about)i(UDP)1658 1333 y
SDict begin H.S end
 1658 1333 a 1658 1333
a
SDict begin 18.72 H.A end
 1658 1333 a 1658 1333 a
SDict begin [/View [/XYZ H.V]/Dest (13.84.121.2) cvn /DEST pdfmark
end
 1658 1333 a -2 1500 a
SDict begin H.S end
 -2 1500
a -2 1500 a
SDict begin 13 H.A end
 -2 1500 a -2 1500 a
SDict begin [/View [/XYZ H.V]/Dest (0:4946) cvn /DEST pdfmark end
 -2 1500 a 396 1606 a
Fj(So)21 b(we)f(ha)n(v)o(e)g(disco)o(v)o(ery)e(and)i(presence)f(w)o
(orking)f(o)o(v)o(er)h(UDP)i(IPv4)f(broadcasts.)e(It')-5
b(s)21 b(not)f(ideal,)g(b)n(ut)g(it)h(w)o(orks)f(for)396
1714 y(the)g(local)h(netw)o(orks)e(we)h(ha)n(v)o(e)g(today)-5
b(.)19 b(Ho)n(we)n(v)o(er)f(we)j(can')o(t)e(use)h(UDP)h(for)f(real)g(w)
o(ork,)f(not)h(without)g(additional)e(w)o(ork)396 1822
y(to)j(mak)o(e)e(it)i(reliable.)f(There')-5 b(s)19 b(a)i(jok)o(e)f
(about)f(UDP)i(b)n(ut)f(sometimes)g(you')o(ll)f(get)i(it,)f(and)g
(sometimes)g(you)f(w)o(on')o(t.)-2 2006 y
SDict begin H.S end
 -2 2006 a -2
2006 a
SDict begin 13 H.A end
 -2 2006 a -2 2006 a
SDict begin [/View [/XYZ H.V]/Dest (0:4947) cvn /DEST pdfmark end
 -2 2006 a 396 2096 a Fj(W)-7
b(e')o(ll)22 b(stick)e(to)h(TCP)g(for)e(all)i(one-to-one)c(messaging.)i
(There)h(is)h(one)e(more)h(use-case)g(for)f(UDP)i(after)f(disco)o(v)o
(ery)-5 b(,)396 2204 y(which)20 b(is)g(multicast)g(\002le)h(distrib)n
(ution.)d(I')o(ll)i(e)o(xplain)f(why)g(and)g(ho)n(w)-5
b(,)19 b(then)g(shelv)o(e)g(that)h(for)f(another)g(day)-5
b(.)18 b(The)i(why)f(is)396 2312 y(simple:)i(what)f(we)g(call)h
("social)f(netw)o(orks")f(is)i(just)g(augmented)d(culture.)h(W)-7
b(e)22 b(create)e(culture)f(by)h(sharing,)f(and)g(this)396
2420 y(means)h(more)g(and)f(more,)g(sharing)g(w)o(orks)h(that)h(we)f
(mak)o(e)g(or)g(remix.)f(Photos,)h(documents,)e(contracts,)h(tweets.)i
(The)396 2528 y(clouds)f(of)g(de)n(vices)f(we')l(re)h(aiming)f(to)n(w)o
(ards)h(do)g(more)f(of)h(this,)h(not)e(less.)-2 2712
y
SDict begin H.S end
 -2 2712 a -2 2712 a
SDict begin 13 H.A end
 -2 2712 a -2 2712 a
SDict begin [/View [/XYZ H.V]/Dest (0:4948) cvn /DEST pdfmark end
 -2 2712 a 396
2802 a Fj(No)n(w)-5 b(,)20 b(there)f(are)i(tw)o(o)f(principal)f
(patterns)g(for)h(sharing)f(content.)g(One)h(is)h(the)g("pubsub")d
(pattern)h(where)h(one)f(node)396 2910 y(sends)h(out)g(content)g(to)g
(a)g(set)h(of)f(other)g(nodes,)f(at)i(the)f(same)g(time.)g(Second)g(is)
h(the)f("late)g(joiner")g(pattern,)f(where)g(a)396 3018
y(node)g(arri)n(v)o(es)h(some)n(what)f(later)h(and)g(w)o(ants)h(to)f
(catch)g(up)g(to)g(the)g(con)m(v)o(ersation.)d(W)-7 b(e)22
b(can)e(deal)g(with)g(the)g(late)h(joiner)396 3126 y(using)f(TCP)h
(unicast.)e(But)i(doing)e(TCP)h(unicast)g(to)h(a)f(group)e(of)i
(clients)g(at)h(the)f(same)g(time)h(has)f(some)g(disadv)n(antages.)396
3234 y(First,)h(it)g(can)f(be)g(slo)n(wer)g(than)g(multicast.)g
(Second,)f(it')-5 b(s)21 b(unf)o(air)e(since)i(some)f(will)g(get)h(the)
f(content)f(before)g(others.)-2 3418 y
SDict begin H.S end
 -2 3418 a -2 3418
a
SDict begin 13 H.A end
 -2 3418 a -2 3418 a
SDict begin [/View [/XYZ H.V]/Dest (0:4949) cvn /DEST pdfmark end
 -2 3418 a 396 3508 a Fj(Before)h(you)f(jump)h(of)
n(f)f(to)h(design)g(a)h(UDP)f(multicast)h(protocol,)d(realize)i(that)g
(it')-5 b(s)21 b(not)f(a)h(simple)f(calculation.)f(When)396
3616 y(you)h(send)f(a)i(multicast)f(pack)o(et,)g(the)g(W)m(iFi)h
(access)g(point)e(uses)i(a)g(lo)n(w)f(bit)g(rate,)g(to)h(ensure)e(that)
h(e)n(v)o(en)f(the)i(furthest)396 3724 y(de)n(vices)f(will)h(get)f(it)h
(safely)-5 b(.)19 b(Most)i(normal)e(APs)i(don')o(t)d(do)i(the)g(ob)o
(vious)f(optimization,)f(which)i(is)h(to)f(measure)g(the)396
3831 y(distance)g(of)g(the)g(furthest)g(de)n(vice)f(and)h(use)g(that)g
(bit)h(rate.)f(Instead)f(the)o(y)h(just)g(use)h(a)f(\002x)o(ed)g(v)n
(alue.)f(So)i(if)f(you)f(ha)n(v)o(e)h(a)396 3939 y(fe)n(w)g(de)n
(vices,)g(close)g(to)h(the)f(AP)-9 b(,)20 b(multicast)g(will)h(be)f
(insanely)g(slo)n(w)-5 b(.)20 b(But)g(if)h(you)e(ha)n(v)o(e)h(a)g
(roomful)f(of)h(de)n(vices)f(which)396 4047 y(all)i(w)o(ant)f(to)h(get)
f(the)g(ne)o(xt)g(chapter)f(of)h(the)g(te)o(xtbook,)e(multicast)i(can)g
(be)g(insanely)f(ef)n(fecti)n(v)o(e.)-2 4231 y
SDict begin H.S end
 -2 4231
a -2 4231 a
SDict begin 13 H.A end
 -2 4231 a -2 4231 a
SDict begin [/View [/XYZ H.V]/Dest (0:4950) cvn /DEST pdfmark end
 -2 4231 a 396 4321 a
Fj(The)h(curv)o(es)f(cross)i(around)d(6-12)h(de)n(vices)g(depending)f
(on)i(the)g(netw)o(ork.)e(Y)-9 b(ou)20 b(could)f(in)h(theory)f(measure)
h(the)g(curv)o(es)396 4429 y(in)h(real-time)e(and)h(create)g(an)g
(adapti)n(v)o(e)e(protocol.)h(That)h(w)o(ould)f(be)h(cool)g(b)n(ut)g
(probably)e(too)i(hard)f(for)h(e)n(v)o(en)f(the)396 4537
y(smartest)i(of)f(us.)-2 4704 y
SDict begin H.S end
 -2 4704 a -2 4704 a
SDict begin 13 H.A end
 -2
4704 a -2 4704 a
SDict begin [/View [/XYZ H.V]/Dest (0:4951) cvn /DEST pdfmark end
 -2 4704 a 396 4811 a Fj(If)g(you)g(do)f(sit)j(do)n(wn)
d(and)g(sk)o(etch)h(out)g(a)h(UDP)g(multicast)f(protocol,)e(realize)i
(that)g(you)g(need)f(a)i(channel)e(for)g(reco)o(v)o(ery)-5
b(,)396 4919 y(to)21 b(get)f(lost)g(pack)o(ets.)g(Y)-9
b(ou')l(d)18 b(probably)g(w)o(ant)i(to)h(do)e(this)i(o)o(v)o(er)e(TCP)
-9 b(,)20 b(using)g(\330MQ.)g(F)o(or)g(no)n(w)-5 b(,)18
b(ho)n(we)n(v)o(er)m(,)g(we')o(ll)i(for)o(get)396 5027
y(about)f(multicast)i(UDP)-9 b(,)20 b(and)g(assume)g(all)h(traf)n
(\002c)f(goes)f(o)o(v)o(er)g(TCP)-9 b(.)-2 5138 y
SDict begin H.S end
 -2
5138 a -2 5138 a
SDict begin 13 H.A end
 -2 5138 a -2 5138 a
SDict begin [/View [/XYZ H.V]/Dest (0:4952) cvn /DEST pdfmark end
 -2 5138 a Black
3759 5569 a Fi(352)p Black eop end
%%Page: 353 367
TeXDict begin 353 366 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.353) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 94 a Fh(8.4.)39 b(Spinning)f(off)h(a)g
(Librar)q(y)g(Pr)m(oject)2286 94 y
SDict begin H.S end
 2286 94 a 2286 94
a
SDict begin 22.464 H.A end
 2286 94 a 2286 94 a
SDict begin [/View [/XYZ H.V]/Dest (13.85.1) cvn /DEST pdfmark end
 2286 94 a -2 292 a
SDict begin H.S end
 -2 292 a -2
292 a
SDict begin 13 H.A end
 -2 292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:4954) cvn /DEST pdfmark end
 -2 292 a 396 368 a Fj(At)21 b(this)g(stage)f
(ho)n(we)n(v)o(er)m(,)e(the)i(code)f(is)j(gro)n(wing)c(lar)o(ger)h
(than)h(an)g(e)o(xample)e(should)i(be,)g(so)g(it')-5
b(s)21 b(time)g(to)f(create)g(a)396 476 y(proper)f(GitHub)h(project.)f
(It')-5 b(s)20 b(a)h(rule:)f(b)n(uild)g(your)f(projects)g(in)i(public)e
(vie)n(w)-5 b(,)19 b(and)h(tell)h(people)e(about)g(them)h(as)h(you)396
584 y(go,)f(so)g(your)f(mark)o(eting)g(and)h(community)e(b)n(uilding)g
(starts)j(on)f(day)g(1.)g(I')o(ll)g(w)o(alk)h(through)d(what)i(this)g
(in)m(v)n(olv)o(es.)f(I)396 692 y(e)o(xplained)g(in)h(The)g(\330MQ)g
(Community)p 0 TeXcolorgray 1587 692 a
SDict begin H.S end
 1587 692 a Fj(Chapter)e(7)1911
692 y
SDict begin 13 H.L end
 1911 692 a 1911 692 a
SDict begin [/Subtype /Link/Dest (0:the-community) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1911 692 a Black 20 w Fj(about)h(gro)n
(wing)f(communities)h(around)f(projects.)i(W)-7 b(e)21
b(need)f(a)396 800 y(fe)n(w)g(things:)-2 818 y
SDict begin H.S end
 -2 818
a -2 818 a
SDict begin 13 H.A end
 -2 818 a -2 818 a
SDict begin [/View [/XYZ H.V]/Dest (0:4956) cvn /DEST pdfmark end
 -2 818 a -2 828 a
SDict begin H.S end
 -2 828
a -2 828 a
SDict begin 13 H.A end
 -2 828 a -2 828 a
SDict begin [/View [/XYZ H.V]/Dest (0:4957) cvn /DEST pdfmark end
 -2 828 a Black 396 970 a
Fe(\225)p Black 479 970 a
SDict begin H.S end
 479 970 a 479 970 a
SDict begin 13 H.A end
 479 970
a 479 970 a
SDict begin [/View [/XYZ H.V]/Dest (0:4958) cvn /DEST pdfmark end
 479 970 a Fj(A)h(name.)-2 971 y
SDict begin H.S end
 -2 971 a
-2 971 a
SDict begin 13 H.A end
 -2 971 a -2 971 a
SDict begin [/View [/XYZ H.V]/Dest (0:4959) cvn /DEST pdfmark end
 -2 971 a Black 396 1119 a
Fe(\225)p Black 479 1119 a
SDict begin H.S end
 479 1119 a 479 1119 a
SDict begin 13 H.A end
 479
1119 a 479 1119 a
SDict begin [/View [/XYZ H.V]/Dest (0:4960) cvn /DEST pdfmark end
 479 1119 a Fj(A)g(slogan.)-2 1137 y
SDict begin H.S end

-2 1137 a -2 1137 a
SDict begin 13 H.A end
 -2 1137 a -2 1137 a
SDict begin [/View [/XYZ H.V]/Dest (0:4961) cvn /DEST pdfmark end
 -2 1137 a Black
396 1269 a Fe(\225)p Black 479 1269 a
SDict begin H.S end
 479 1269 a 479
1269 a
SDict begin 13 H.A end
 479 1269 a 479 1269 a
SDict begin [/View [/XYZ H.V]/Dest (0:4962) cvn /DEST pdfmark end
 479 1269 a Fj(A)g(public)e(github)g
(repository)-5 b(.)-2 1287 y
SDict begin H.S end
 -2 1287 a -2 1287 a
SDict begin 13 H.A end
 -2 1287
a -2 1287 a
SDict begin [/View [/XYZ H.V]/Dest (0:4963) cvn /DEST pdfmark end
 -2 1287 a Black 396 1418 a Fe(\225)p Black
479 1418 a
SDict begin H.S end
 479 1418 a 479 1418 a
SDict begin 13 H.A end
 479 1418 a 479 1418
a
SDict begin [/View [/XYZ H.V]/Dest (0:4964) cvn /DEST pdfmark end
 479 1418 a Fj(A)21 b(README)f(that)h(links)f(to)g(the)g(C4)h
(process.)-2 1436 y
SDict begin H.S end
 -2 1436 a -2 1436 a
SDict begin 13 H.A end
 -2 1436 a -2
1436 a
SDict begin [/View [/XYZ H.V]/Dest (0:4965) cvn /DEST pdfmark end
 -2 1436 a Black 396 1568 a Fe(\225)p Black 479
1568 a
SDict begin H.S end
 479 1568 a 479 1568 a
SDict begin 13 H.A end
 479 1568 a 479 1568 a
SDict begin [/View [/XYZ H.V]/Dest (0:4966) cvn /DEST pdfmark end
 479
1568 a Fj(License)f(\002les.)-2 1569 y
SDict begin H.S end
 -2 1569 a -2 1569
a
SDict begin 13 H.A end
 -2 1569 a -2 1569 a
SDict begin [/View [/XYZ H.V]/Dest (0:4967) cvn /DEST pdfmark end
 -2 1569 a Black 396 1717 a Fe(\225)p
Black 479 1717 a
SDict begin H.S end
 479 1717 a 479 1717 a
SDict begin 13 H.A end
 479 1717 a 479
1717 a
SDict begin [/View [/XYZ H.V]/Dest (0:4968) cvn /DEST pdfmark end
 479 1717 a Fj(An)g(issue)h(track)o(er)-5 b(.)-2
1718 y
SDict begin H.S end
 -2 1718 a -2 1718 a
SDict begin 13 H.A end
 -2 1718 a -2 1718 a
SDict begin [/View [/XYZ H.V]/Dest (0:4969) cvn /DEST pdfmark end
 -2 1718
a Black 396 1867 a Fe(\225)p Black 479 1867 a
SDict begin H.S end
 479 1867
a 479 1867 a
SDict begin 13 H.A end
 479 1867 a 479 1867 a
SDict begin [/View [/XYZ H.V]/Dest (0:4970) cvn /DEST pdfmark end
 479 1867 a Fj(T)e(w)o(o)21
b(maintainers.)-2 1868 y
SDict begin H.S end
 -2 1868 a -2 1868 a
SDict begin 13 H.A end
 -2 1868
a -2 1868 a
SDict begin [/View [/XYZ H.V]/Dest (0:4971) cvn /DEST pdfmark end
 -2 1868 a Black 396 2016 a Fe(\225)p Black
479 2016 a
SDict begin H.S end
 479 2016 a 479 2016 a
SDict begin 13 H.A end
 479 2016 a 479 2016
a
SDict begin [/View [/XYZ H.V]/Dest (0:4972) cvn /DEST pdfmark end
 479 2016 a Fj(A)g(\002rst)g(bootstrap)e(v)o(ersion.)-2
2200 y
SDict begin H.S end
 -2 2200 a -2 2200 a
SDict begin 13 H.A end
 -2 2200 a -2 2200 a
SDict begin [/View [/XYZ H.V]/Dest (0:4973) cvn /DEST pdfmark end
 -2 2200
a 396 2290 a Fj(The)h(name)g(and)f(slogan)g(\002rst.)i(The)f
(trademarks)f(of)h(the)g(21st)g(century)f(are)h(domain)f(names.)g(So)i
(the)f(\002rst)h(thing)e(I)i(do)396 2398 y(when)f(spinning)f(of)n(f)g
(a)i(project)e(is)i(to)f(look)g(for)f(a)i(domain)e(name)g(that)i(might)
e(w)o(ork.)h(Quite)g(randomly)-5 b(,)17 b(one)j(of)g(our)396
2506 y(old)g(messaging)f(products)g(w)o(as)i(called)f("Zyre")f(and)h(I)
g(ha)n(v)o(e)g(the)g(domain)f(names)h(for)f(it.)i(So,)f(the)h("ZeroMQ)
396 2614 y(Realtime)g(Experience")d(project,)h(which)h(is)h(a)f
(terribly)f(forced)g(construction)g(b)n(ut)h(more)f(or)h(less)h
(accurate.)e(W)-7 b(e)22 b(are)396 2722 y(aiming)e(to)g(create)g(a)h
(frame)n(w)o(ork)d(for)h(real)h(time)h(e)o(xperiences)d(\(sharing)h
(games,)g(photos,)g(stories\))h(o)o(v)o(er)f(\330MQ.)-2
2906 y
SDict begin H.S end
 -2 2906 a -2 2906 a
SDict begin 13 H.A end
 -2 2906 a -2 2906 a
SDict begin [/View [/XYZ H.V]/Dest (0:4974) cvn /DEST pdfmark end
 -2 2906
a 396 2996 a Fj(I'm)h(some)n(what)f(shy)h(about)f(pushing)g(ne)n(w)h
(projects)f(into)h(the)h(\330MQ)f(community)e(too)i(aggressi)n(v)o(ely)
-5 b(,)18 b(and)h(normally)396 3104 y(w)o(ould)h(start)g(a)h(project)e
(in)i(either)f(my)f(personal)g(account)g(or)h(the)g(iMatix)h(or)o
(ganization.)16 b(But)21 b(we')l(v)o(e)e(learned)g(that)396
3212 y(mo)o(ving)f(projects)i(after)g(the)o(y)f(become)g(popular)g(is)i
(counter)n(-producti)n(v)o(e.)15 b(My)20 b(predictions)f(of)h(a)g
(future)f(\002lled)i(with)396 3320 y(mo)o(ving)d(pieces)j(are)f(either)
g(v)n(alid,)f(or)h(wrong.)f(If)h(this)g(chapter)g(is)h(v)n(alid,)e(we)i
(might)e(as)i(well)g(launch)e(this)i(as)g(a)f(\330MQ)396
3427 y(project)f(from)g(the)h(start.)h(If)f(it')-5 b(s)21
b(wrong,)d(we)i(can)g(delete)g(the)g(repository)e(later)i(or)g(let)h
(it)f(sink)g(to)h(the)f(bottom)e(of)i(a)h(long)396 3535
y(list)h(of)d(for)o(gotten)f(starts.)-2 3719 y
SDict begin H.S end
 -2 3719
a -2 3719 a
SDict begin 13 H.A end
 -2 3719 a -2 3719 a
SDict begin [/View [/XYZ H.V]/Dest (0:4975) cvn /DEST pdfmark end
 -2 3719 a 396 3809 a
Fj(Start)j(with)f(the)g(basics.)h(The)f(protocol)e(\(UDP)j(and)e
(\330MQ/TCP\))i(will)g(be)f(ZRE)g(and)g(the)g(project)f(will)i(be)g
(ZyRE,)396 3917 y(with)g(dif)n(ferent)d(capitalization)h(to)i(reduce)e
(confusion)f(with)i(the)g(old)g(project.)f(I)i(need)e(a)i(second)e
(maintainer)m(,)f(so)396 4025 y(in)m(vite)i(my)g(friend)f(Dong)g(Min)h
(\(the)g(K)m(orean)f(hack)o(er)g(behind)g(JeroMQ,)h(a)g(pure-Ja)n(v)n
(a)f(\330MQ)h(stack\))g(to)h(join.)e(He')-5 b(s)396 4133
y(been)20 b(w)o(orking)e(on)i(v)o(ery)f(similar)i(ideas)f(so)h(is)g
(enthusiastic.)e(W)-7 b(e)22 b(discuss)e(this)h(and)e(we)i(get)f(the)g
(idea)h(of)e(b)n(uilding)396 4241 y(ZyRE)h(on)g(top)g(of)g(JeroMQ)g(as)
h(well)f(as)h(on)f(top)g(of)g(CZMQ)g(and)g(libzmq.)f(This)i(w)o(ould)e
(mak)o(e)h(it)h(a)f(lot)h(easier)f(to)g(run)396 4349
y(ZyRE)g(on)f(Android.)e(It)j(w)o(ould)e(also)i(gi)n(v)o(e)f(us)g(tw)o
(o)h(fully)f(separate)g(implementations)e(from)h(the)i(start,)g(al)o(w)
o(ays)f(a)h(good)396 4457 y(thing)g(for)f(a)i(protocol.)-2
4641 y
SDict begin H.S end
 -2 4641 a -2 4641 a
SDict begin 13 H.A end
 -2 4641 a -2 4641 a
SDict begin [/View [/XYZ H.V]/Dest (0:4976) cvn /DEST pdfmark end
 -2 4641
a 396 4731 a Fj(So)g(we)f(tak)o(e)g(the)h(FileMQ)f(project)g(I)g(b)n
(uilt)g(in)h(The)f(Human)f(Scale)p 0 TeXcolorgray 2338
4731 a
SDict begin H.S end
 2338 4731 a Fj(Chapter)g(6)2663 4731 y
SDict begin 13 H.L end
 2663 4731
a 2663 4731 a
SDict begin [/Subtype /Link/Dest (0:the-human-scale) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2663 4731 a Black 20 w Fj(as)i(a)g(template)f(for)f(a)i
(ne)n(w)f(GitHub)396 4839 y(project.)f(The)h(GNU)h(autoconf)d(tools)i
(are)g(quite)g(decent)g(b)n(ut)g(ha)n(v)o(e)f(a)i(painful)e(syntax.)g
(It')-5 b(s)21 b(easiest)g(to)g(cop)o(y)e(e)o(xisting)396
4947 y(project)h(\002les,)g(and)g(modify)f(them.)g(The)h(FileMQ)h
(project)e(b)n(uilds)h(a)h(library)-5 b(,)18 b(has)j(test)g(tools,)f
(license)g(\002les,)h(man)396 5055 y(pages,)f(and)f(so)i(on.)f(It')-5
b(s)20 b(not)g(too)g(lar)o(ge)f(so)i(it')-5 b(s)21 b(a)g(good)e
(starting)g(point.)p Black 3759 5569 a Fi(353)p Black
eop end
%%Page: 354 368
TeXDict begin 354 367 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.354) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:4978) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(I)h(put)f(together)e(a)j(README)f
(to)h(summarize)e(the)h(goals)g(of)g(the)g(project)f(and)h(point)f(to)i
(C4.)f(The)g(issue)h(track)o(er)e(is)396 180 y(enabled)g(by)h(def)o
(ault)f(on)h(ne)n(w)g(GitHub)g(projects,)f(so)i(once)e(we')l(v)o(e)h
(pushed)f(the)h(UDP)h(ping)e(code)g(as)i(a)g(\002rst)g(v)o(ersion,)396
288 y(we')l(re)f(ready)f(to)h(go.)g(Ho)n(we)n(v)o(er)e(it')-5
b(s)22 b(al)o(w)o(ays)e(good)f(to)i(recruit)e(more)g(maintainers,)g(so)
i(I)f(create)g(an)g(issue)h("Call)g(for)396 396 y(maintainers")e(that)i
(says:)-2 414 y
SDict begin H.S end
 -2 414 a -2 414 a
SDict begin 13 H.A end
 -2 414 a -2 414 a
SDict begin [/View [/XYZ H.V]/Dest (0:4979) cvn /DEST pdfmark end
 -2
414 a -2 497 a
SDict begin H.S end
 -2 497 a -2 497 a
SDict begin 11.7 H.A end
 -2 497 a -2 497 a
SDict begin [/View [/XYZ H.V]/Dest (0:4980) cvn /DEST pdfmark end
 -2
497 a 479 576 a Fa(If)d(you')l(d)i(lik)o(e)e(to)g(help)h(click)f(that)h
(lo)o(v)o(ely)f(green)h("Mer)o(ge)h(Pull)d(Request")i(b)o(utton,)g(and)
g(get)f(eternal)g(karma,)h(add)g(a)f(comment)479 674
y(con\002rming)i(that)f(you')l(v)o(e)h(read)f(and)h(understand)g(the)f
(C4)g(process)h(at)f(http://rfc.zeromq.or)o(g/spec:16.)-2
856 y
SDict begin H.S end
 -2 856 a -2 856 a
SDict begin 13 H.A end
 -2 856 a -2 856 a
SDict begin [/View [/XYZ H.V]/Dest (0:4981) cvn /DEST pdfmark end
 -2 856 a 396
948 a Fj(Finally)-5 b(,)20 b(I)g(change)f(the)h(issue)h(track)o(er)e
(labels.)i(GitHub)e(by)h(def)o(ault)g(of)n(fers)f(the)h(usual)g(v)n
(ariety)f(of)h(issue)h(types)f(b)n(ut)396 1055 y(with)h(C4)f(we)h(don')
o(t)d(use)j(them.)e(Instead)h(we)g(need)g(just)h(tw)o(o)f(labels)h
(\("Ur)o(gent",)c(in)k(red,)e(and)h("Ready",)f(in)i(black\).)-2
1084 y
SDict begin H.S end
 -2 1084 a -2 1084 a
SDict begin 13 H.A end
 -2 1084 a -2 1084 a
SDict begin [/View [/XYZ H.V]/Dest (0:4982) cvn /DEST pdfmark end
 -2 1084
a 359 x Fh(8.5.)39 b(P)-6 b(oint-to-point)36 b(Messa)o(ging)1994
1443 y
SDict begin H.S end
 1994 1443 a 1994 1443 a
SDict begin 22.464 H.A end
 1994 1443 a 1994 1443
a
SDict begin [/View [/XYZ H.V]/Dest (13.86.1) cvn /DEST pdfmark end
 1994 1443 a -2 1641 a
SDict begin H.S end
 -2 1641 a -2 1641 a
SDict begin 13 H.A end
 -2 1641 a
-2 1641 a
SDict begin [/View [/XYZ H.V]/Dest (0:4984) cvn /DEST pdfmark end
 -2 1641 a 396 1717 a Fj(I'm)20 b(going)f(to)h(tak)o(e)g(the)h
(last)g(UDP)f(ping)g(program)e(and)h(b)n(uild)h(a)h(point-to-point)c
(messaging)i(layer)h(on)g(top)g(of)f(that.)396 1825 y(Our)h(goal)g(is)h
(that)f(we)h(can)f(detect)g(peers)g(as)h(the)o(y)e(join)h(and)g(lea)n
(v)o(e)g(the)g(netw)o(ork,)f(that)h(we)h(can)f(send)f(messages)i(to)396
1933 y(them,)f(and)f(that)i(we)f(can)g(get)g(replies.)g(It)h(is)g(a)g
(non-tri)n(vial)d(problem)g(to)j(solv)o(e)e(and)h(tak)o(es)h(Min)f(and)
f(me)i(tw)o(o)f(days)g(to)396 2041 y(get)g(a)h("hello)f(w)o(orld")f(v)o
(ersion)g(w)o(orking.)-2 2225 y
SDict begin H.S end
 -2 2225 a -2 2225 a
SDict begin 13 H.A end
 -2
2225 a -2 2225 a
SDict begin [/View [/XYZ H.V]/Dest (0:4985) cvn /DEST pdfmark end
 -2 2225 a 396 2315 a Fj(W)-7 b(e)22
b(had)d(to)i(solv)o(e)e(a)i(number)d(of)i(issues:)-2
2316 y
SDict begin H.S end
 -2 2316 a -2 2316 a
SDict begin 13 H.A end
 -2 2316 a -2 2316 a
SDict begin [/View [/XYZ H.V]/Dest (0:4986) cvn /DEST pdfmark end
 -2 2316
a -2 2326 a
SDict begin H.S end
 -2 2326 a -2 2326 a
SDict begin 13 H.A end
 -2 2326 a -2 2326 a
SDict begin [/View [/XYZ H.V]/Dest (0:4987) cvn /DEST pdfmark end
 -2
2326 a Black 396 2485 a Fe(\225)p Black 479 2485 a
SDict begin H.S end
 479
2485 a 479 2485 a
SDict begin 13 H.A end
 479 2485 a 479 2485 a
SDict begin [/View [/XYZ H.V]/Dest (0:4988) cvn /DEST pdfmark end
 479 2485 a Fj(What)h
(information)d(to)i(send)g(in)g(the)g(UDP)h(beacon,)e(and)h(ho)n(w)f
(to)i(format)e(it.)-2 2497 y
SDict begin H.S end
 -2 2497 a -2 2497 a
SDict begin 13 H.A end
 -2 2497
a -2 2497 a
SDict begin [/View [/XYZ H.V]/Dest (0:4989) cvn /DEST pdfmark end
 -2 2497 a Black 396 2634 a Fe(\225)p Black
479 2634 a
SDict begin H.S end
 479 2634 a 479 2634 a
SDict begin 13 H.A end
 479 2634 a 479 2634
a
SDict begin [/View [/XYZ H.V]/Dest (0:4990) cvn /DEST pdfmark end
 479 2634 a Fj(What)i(\330MQ)f(sock)o(et)g(types)g(to)h(use)f(to)g
(interconnect)f(nodes.)-2 2652 y
SDict begin H.S end
 -2 2652 a -2 2652 a
SDict begin 13 H.A end

-2 2652 a -2 2652 a
SDict begin [/View [/XYZ H.V]/Dest (0:4991) cvn /DEST pdfmark end
 -2 2652 a Black 396 2784 a Fe(\225)p
Black 479 2784 a
SDict begin H.S end
 479 2784 a 479 2784 a
SDict begin 13 H.A end
 479 2784 a 479
2784 a
SDict begin [/View [/XYZ H.V]/Dest (0:4992) cvn /DEST pdfmark end
 479 2784 a Fj(What)i(\330MQ)f(messages)h(to)f(send,)g(and)f(ho)n
(w)h(to)g(format)f(them.)-2 2802 y
SDict begin H.S end
 -2 2802 a -2 2802
a
SDict begin 13 H.A end
 -2 2802 a -2 2802 a
SDict begin [/View [/XYZ H.V]/Dest (0:4993) cvn /DEST pdfmark end
 -2 2802 a Black 396 2933 a Fe(\225)p
Black 479 2933 a
SDict begin H.S end
 479 2933 a 479 2933 a
SDict begin 13 H.A end
 479 2933 a 479
2933 a
SDict begin [/View [/XYZ H.V]/Dest (0:4994) cvn /DEST pdfmark end
 479 2933 a Fj(Ho)n(w)h(to)h(send)f(a)g(message)g(to)h(a)f
(speci\002c)h(node.)-2 2951 y
SDict begin H.S end
 -2 2951 a -2 2951 a
SDict begin 13 H.A end
 -2
2951 a -2 2951 a
SDict begin [/View [/XYZ H.V]/Dest (0:4995) cvn /DEST pdfmark end
 -2 2951 a Black 396 3083 a Fe(\225)p
Black 479 3083 a
SDict begin H.S end
 479 3083 a 479 3083 a
SDict begin 13 H.A end
 479 3083 a 479
3083 a
SDict begin [/View [/XYZ H.V]/Dest (0:4996) cvn /DEST pdfmark end
 479 3083 a Fj(Ho)n(w)f(to)h(kno)n(w)e(the)h(sender)g(of)f(an)o
(y)h(message)g(so)g(we)h(could)e(send)h(a)h(reply)-5
b(.)-2 3101 y
SDict begin H.S end
 -2 3101 a -2 3101 a
SDict begin 13 H.A end
 -2 3101 a -2 3101 a
SDict begin [/View [/XYZ H.V]/Dest (0:4997) cvn /DEST pdfmark end

-2 3101 a Black 396 3232 a Fe(\225)p Black 479 3232 a
SDict begin H.S end

479 3232 a 479 3232 a
SDict begin 13 H.A end
 479 3232 a 479 3232 a
SDict begin [/View [/XYZ H.V]/Dest (0:4998) cvn /DEST pdfmark end
 479 3232
a Fj(Ho)n(w)20 b(to)h(reco)o(v)o(er)d(from)h(lost)i(UDP)g(beacons.)-2
3233 y
SDict begin H.S end
 -2 3233 a -2 3233 a
SDict begin 13 H.A end
 -2 3233 a -2 3233 a
SDict begin [/View [/XYZ H.V]/Dest (0:4999) cvn /DEST pdfmark end
 -2 3233
a Black 396 3382 a Fe(\225)p Black 479 3382 a
SDict begin H.S end
 479 3382
a 479 3382 a
SDict begin 13 H.A end
 479 3382 a 479 3382 a
SDict begin [/View [/XYZ H.V]/Dest (0:5000) cvn /DEST pdfmark end
 479 3382 a Fj(Ho)n(w)f(to)h(a)n(v)n
(oid)f(o)o(v)o(erloading)c(the)21 b(netw)o(ork)e(with)h(beacons.)-2
3566 y
SDict begin H.S end
 -2 3566 a -2 3566 a
SDict begin 13 H.A end
 -2 3566 a -2 3566 a
SDict begin [/View [/XYZ H.V]/Dest (0:5001) cvn /DEST pdfmark end
 -2 3566
a 396 3655 a Fj(I')o(ll)h(e)o(xplain)e(these)h(in)g(enough)e(detail)j
(that)f(you)f(understand)f(why)i(we)g(made)g(each)g(choice)f(we)i(did,)
e(with)i(some)f(code)396 3763 y(fragments)f(to)h(illustrate.)g(W)-7
b(e)22 b(tagged)d(this)i(code)e(as)1946 3763 y
SDict begin H.S end
 1946 3763
a 1946 3763 a
SDict begin 13 H.A end
 1946 3763 a 1946 3763 a
SDict begin [/View [/XYZ H.V]/Dest (0:5002) cvn /DEST pdfmark end
 1946 3763 a Fj(v)o(ersion)g
(0.1.0)396 3871 y(\(https://github)m(.com/zeromq/zyr)o(e/zipb)o(all/v0)
o(.1.)o(0\))14 b(so)21 b(you)e(can)h(look)g(at)g(the)g(code:)g(most)g
(of)g(the)g(hard)g(w)o(ork)f(is)396 3979 y(done)g(in)i(zre_interf)o
(ace.c.)-2 3989 y
SDict begin H.S end
 -2 3989 a -2 3989 a
SDict begin 13 H.A end
 -2 3989 a -2 3989
a
SDict begin [/View [/XYZ H.V]/Dest (0:5003) cvn /DEST pdfmark end
 -2 3989 a 396 4307 a Fd(8.5.1.)36 b(UDP)d(Beacon)i(Framing)1950
4307 y
SDict begin H.S end
 1950 4307 a 1950 4307 a
SDict begin 18.72 H.A end
 1950 4307 a 1950 4307
a
SDict begin [/View [/XYZ H.V]/Dest (13.86.122.2) cvn /DEST pdfmark
end
 1950 4307 a -2 4500 a
SDict begin H.S end
 -2 4500 a -2 4500 a
SDict begin 13 H.A end
 -2 4500 a
-2 4500 a
SDict begin [/View [/XYZ H.V]/Dest (0:5005) cvn /DEST pdfmark end
 -2 4500 a 396 4581 a Fj(Sending)19 b(UUIDs)i(across)f(the)g
(netw)o(ork)f(is)i(the)f(bare)g(minimum)f(for)g(a)i(logical)f
(addressing)f(scheme.)g(Ho)n(we)n(v)o(er)g(we)396 4689
y(ha)n(v)o(e)h(a)g(fe)n(w)h(more)e(aspects)h(to)h(get)f(w)o(orking)f
(before)f(this)j(will)g(w)o(ork)f(in)g(real)g(use:)-2
4707 y
SDict begin H.S end
 -2 4707 a -2 4707 a
SDict begin 13 H.A end
 -2 4707 a -2 4707 a
SDict begin [/View [/XYZ H.V]/Dest (0:5006) cvn /DEST pdfmark end
 -2 4707
a -2 4717 a
SDict begin H.S end
 -2 4717 a -2 4717 a
SDict begin 13 H.A end
 -2 4717 a -2 4717 a
SDict begin [/View [/XYZ H.V]/Dest (0:5007) cvn /DEST pdfmark end
 -2
4717 a Black 396 4859 a Fe(\225)p Black 479 4859 a
SDict begin H.S end
 479
4859 a 479 4859 a
SDict begin 13 H.A end
 479 4859 a 479 4859 a
SDict begin [/View [/XYZ H.V]/Dest (0:5008) cvn /DEST pdfmark end
 479 4859 a Fj(W)-7
b(e)22 b(need)d(some)h(protocol)f(identi\002cation)g(so)h(that)g(we)h
(can)f(check)f(for)m(,)g(and)h(reject)g(in)m(v)n(alid)f(pack)o(ets.)-2
4877 y
SDict begin H.S end
 -2 4877 a -2 4877 a
SDict begin 13 H.A end
 -2 4877 a -2 4877 a
SDict begin [/View [/XYZ H.V]/Dest (0:5009) cvn /DEST pdfmark end
 -2 4877
a Black 396 5009 a Fe(\225)p Black 479 5009 a
SDict begin H.S end
 479 5009
a 479 5009 a
SDict begin 13 H.A end
 479 5009 a 479 5009 a
SDict begin [/View [/XYZ H.V]/Dest (0:5010) cvn /DEST pdfmark end
 479 5009 a Fj(W)-7
b(e)22 b(need)d(some)h(v)o(ersion)f(information)f(so)i(that)h(we)f(can)
g(change)f(this)i(protocol)d(o)o(v)o(er)h(time.)-2 5027
y
SDict begin H.S end
 -2 5027 a -2 5027 a
SDict begin 13 H.A end
 -2 5027 a -2 5027 a
SDict begin [/View [/XYZ H.V]/Dest (0:5011) cvn /DEST pdfmark end
 -2 5027 a Black
396 5158 a Fe(\225)p Black 479 5158 a
SDict begin H.S end
 479 5158 a 479
5158 a
SDict begin 13 H.A end
 479 5158 a 479 5158 a
SDict begin [/View [/XYZ H.V]/Dest (0:5012) cvn /DEST pdfmark end
 479 5158 a Fj(W)-7 b(e)22
b(need)d(to)h(tell)h(other)f(nodes)f(ho)n(w)h(to)g(reach)g(us)g(via)g
(TCP)-9 b(,)21 b(i.e.)f(a)h(\330MQ)f(port)g(the)o(y)f(can)h(talk)g(to)h
(us)f(on.)p Black 3759 5569 a Fi(354)p Black eop end
%%Page: 355 369
TeXDict begin 355 368 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.355) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5013) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Let')-5 b(s)21 b(start)g(with)f
(the)g(beacon)f(message)h(format.)f(W)-7 b(e)21 b(probably)d(w)o(ant)j
(a)f(\002x)o(ed)g(protocol)e(header)h(that)i(will)g(ne)n(v)o(er)396
180 y(change)e(in)h(future)f(v)o(ersions,)g(and)h(a)h(body)e(that)h
(depends)f(on)g(the)i(v)o(ersion\()p 0 TeXcolorgray 2596
180 a
SDict begin H.S end
 2596 180 a Fj(Figure)c(8-1)2943 180 y
SDict begin 13 H.L end
 2943 180
a 2943 180 a
SDict begin [/Subtype /Link/Dest (0:figure-72) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 2943 180 a Black -1 w Fj(\).)-2 198 y
SDict begin H.S end
 -2
198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-72) cvn /DEST pdfmark
end
 -2 198 a 396 382 a Fk(Figur)o(e)j
(8-1.)f(ZRE)i(disco)o(v)o(ery)f(message)-2 482 y
SDict begin H.S end
 -2 482
a -2 482 a
SDict begin 13 H.A end
 -2 482 a -2 482 a
SDict begin [/View [/XYZ H.V]/Dest (0:5017) cvn /DEST pdfmark end
 -2 482 a 396 1573 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396
1573 a @beginspecial 0 @llx -126 @lly 410 @urx 0 @ury
4100 @rwi @setspecial
%%BeginDocument: images/fig72.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -126 410 0
%%HiResBoundingBox: 0.0 -126.0 410.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
28.00029945373535 -38.000301361083984 moveto
28.00029945373535 -66.00029754638672 lineto
66.00029754638672 -66.00029754638672 lineto
66.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
70.00029754638672 -38.000301361083984 moveto
70.00029754638672 -66.00029754638672 lineto
106.00029754638672 -66.00029754638672 lineto
106.00029754638672 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
110.00029754638672 -38.000301361083984 moveto
110.00029754638672 -66.00029754638672 lineto
146.00030517578125 -66.00029754638672 lineto
146.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
150.00030517578125 -38.000301361083984 moveto
150.00030517578125 -66.00029754638672 lineto
218.00030517578125 -66.00029754638672 lineto
218.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
248.00030517578125 -38.000301361083984 moveto
248.00030517578125 -66.00029754638672 lineto
316.00030517578125 -66.00029754638672 lineto
316.00030517578125 -38.000301361083984 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
320.00030517578125 -38.000301361083984 moveto
320.00030517578125 -66.00029754638672 lineto
388.00030517578125 -66.00029754638672 lineto
388.00030517578125 -38.000301361083984 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
25.0 -35.0 moveto
25.0 -63.0 lineto
63.0 -63.0 lineto
63.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
1.0 setlinewidth
1 setlinecap
[] 0 setdash
newpath
25.0 -35.0 moveto
25.0 -63.0 lineto
63.0 -63.0 lineto
63.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
67.0 -35.0 moveto
67.0 -63.0 lineto
103.0 -63.0 lineto
103.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
67.0 -35.0 moveto
67.0 -63.0 lineto
103.0 -63.0 lineto
103.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
107.0 -35.0 moveto
107.0 -63.0 lineto
143.0 -63.0 lineto
143.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
107.0 -35.0 moveto
107.0 -63.0 lineto
143.0 -63.0 lineto
143.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
147.0 -35.0 moveto
147.0 -63.0 lineto
215.0 -63.0 lineto
215.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
147.0 -35.0 moveto
147.0 -63.0 lineto
215.0 -63.0 lineto
215.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
245.0 -35.0 moveto
245.0 -63.0 lineto
313.0 -63.0 lineto
313.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
245.0 -35.0 moveto
245.0 -63.0 lineto
313.0 -63.0 lineto
313.0 -35.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
317.0 -35.0 moveto
317.0 -63.0 lineto
385.0 -63.0 lineto
385.0 -35.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
317.0 -35.0 moveto
317.0 -63.0 lineto
385.0 -63.0 lineto
385.0 -35.0 lineto
closepath
stroke
/Helvetica findfont
15 scalefont setfont
42.0 -54.0 moveto
(Z ) show
82.0 -54.0 moveto
(R ) show
123.0 -54.0 moveto
(E ) show
161.0 -54.0 moveto
(%x01) show
262.0 -54.0 moveto
(UUID) show
333.0 -54.0 moveto
(port) show
91.0 -96.0 moveto
(Header) show
301.0 -96.0 moveto
(Body) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 1573 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 1573 a -2 1739 a
SDict begin H.S end
 -2 1739
a -2 1739 a
SDict begin 13 H.A end
 -2 1739 a -2 1739 a
SDict begin [/View [/XYZ H.V]/Dest (0:5020) cvn /DEST pdfmark end
 -2 1739 a 396 1847 a
Fj(The)g(v)o(ersion)f(can)h(be)g(a)h(1-byte)e(counter)f(starting)i(at)h
(1.)f(The)g(UUID)g(is)h(16)f(bytes,)g(and)f(the)i(port)e(is)i(a)g
(2-byte)e(port)396 1955 y(number)m(,)f(since)i(UDP)h(nicely)f(tells)h
(us)g(the)f(sender')-5 b(s)20 b(IP)g(address)g(for)f(e)n(v)o(ery)g
(message)h(we)h(recei)n(v)o(e.)e(This)h(gi)n(v)o(es)g(us)g(a)396
2063 y(22-byte)f(frame.)-2 2247 y
SDict begin H.S end
 -2 2247 a -2 2247 a
SDict begin 13 H.A end

-2 2247 a -2 2247 a
SDict begin [/View [/XYZ H.V]/Dest (0:5021) cvn /DEST pdfmark end
 -2 2247 a 396 2337 a Fj(The)h(C)h(language)e(\(and)
g(a)i(fe)n(w)f(others)f(lik)o(e)i(Erlang\))e(mak)o(e)g(it)i(simple)f
(to)h(read)e(and)h(write)g(binary)f(structures.)h(W)-7
b(e)396 2445 y(de\002ne)20 b(the)g(beacon)f(frame)g(structure:)-2
2529 y
SDict begin H.S end
 -2 2529 a -2 2529 a
SDict begin 11.7 H.A end
 -2 2529 a -2 2529 a
SDict begin [/View [/XYZ H.V]/Dest (0:5022) cvn /DEST pdfmark end
 -2 2529
a 396 2625 a Fg(#define)44 b(BEACON_PROTOCOL)222 b("ZRE")396
2722 y(#define)44 b(BEACON_VERSION)267 b(0x01)396 2916
y(typedef)44 b(struct)g({)576 3014 y(byte)g(protocol)f([3];)576
3111 y(byte)h(version;)576 3208 y(uuid_t)f(uuid;)576
3305 y(uint16_t)g(port;)396 3402 y(})i(beacon_t;)-2 3578
y
SDict begin H.S end
 -2 3578 a -2 3578 a
SDict begin 13 H.A end
 -2 3578 a -2 3578 a
SDict begin [/View [/XYZ H.V]/Dest (0:5023) cvn /DEST pdfmark end
 -2 3578 a 396
3676 a Fj(Which)20 b(mak)o(es)g(sending)f(and)h(recei)n(ving)f(beacons)
g(quite)h(simple.)g(Here)g(is)h(ho)n(w)e(we)i(send)f(a)h(beacon,)d
(using)i(the)396 3784 y(zre_udp)e(class)k(to)e(do)g(the)g(non-portable)
d(netw)o(ork)i(calls:)-2 3885 y
SDict begin H.S end
 -2 3885 a -2 3885 a
SDict begin 11.7 H.A end
 -2
3885 a -2 3885 a
SDict begin [/View [/XYZ H.V]/Dest (0:5024) cvn /DEST pdfmark end
 -2 3885 a 396 3964 a Fg(//)90 b(Beacon)43
b(object)396 4061 y(beacon_t)h(beacon;)396 4256 y(//)90
b(Format)43 b(beacon)h(fields)396 4353 y(beacon.protocol)f([0])h(=)h
('Z';)396 4450 y(beacon.protocol)e([1])h(=)h('R';)396
4547 y(beacon.protocol)e([2])h(=)h('E';)396 4644 y(beacon.version)e(=)h
(BEACON_VERSION;)396 4741 y(memcpy)g(\(beacon.uuid,)f(self->uuid,)g
(sizeof)h(\(uuid_t\)\);)396 4838 y(beacon.port)f(=)i(htons)f
(\(self->port\);)396 5033 y(//)90 b(Broadcast)43 b(the)h(beacon)g(to)h
(anyone)e(who)i(is)f(listening)396 5130 y(zre_udp_send)f(\(self->udp,)g
(\(byte)1786 5143 y(*)1831 5130 y(\))i(&beacon,)e(sizeof)h
(\(beacon_t\)\);)p Black 3759 5569 a Fi(355)p Black eop
end
%%Page: 356 370
TeXDict begin 356 369 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.356) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5025) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(When)g(we)h(recei)n(v)o(e)e(a)i
(beacon)d(we)j(need)e(to)i(guard)e(against)g(bogus)g(data.)h(W)-7
b(e')l(re)20 b(not)g(going)f(to)i(be)f(paranoid)e(against,)396
180 y(for)i(e)o(xample,)e(denial-of-service)g(attacks.)i(W)-7
b(e)21 b(just)g(w)o(ant)f(to)g(mak)o(e)g(sure)g(we')l(re)g(not)g(going)
e(to)j(crash)f(when)f(a)i(bad)396 288 y(ZRE)g(implementation)d(sends)i
(us)h(erroneous)d(frames.)-2 472 y
SDict begin H.S end
 -2 472 a -2 472 a
SDict begin 13 H.A end

-2 472 a -2 472 a
SDict begin [/View [/XYZ H.V]/Dest (0:5026) cvn /DEST pdfmark end
 -2 472 a 396 562 a Fj(T)-7 b(o)21 b(v)n(alidate)e(a)i
(frame)e(we)i(check)e(its)i(size)g(and)f(header)-5 b(.)19
b(If)h(those)g(are)g(OK,)h(we)f(assume)g(the)g(body)f(is)i(usable.)f
(When)396 670 y(we)g(get)f(a)h(UUID)g(that)f(isn')o(t)g(ourselv)o(es)f
(\(recall,)h(we')o(ll)h(get)f(our)g(o)n(wn)g(UDP)h(broadcasts)e
(back\),)g(we)i(can)f(treat)g(this)h(as)g(a)396 778 y(peer:)-2
879 y
SDict begin H.S end
 -2 879 a -2 879 a
SDict begin 11.7 H.A end
 -2 879 a -2 879 a
SDict begin [/View [/XYZ H.V]/Dest (0:5027) cvn /DEST pdfmark end
 -2 879 a 396
958 a Fg(//)90 b(Get)44 b(beacon)g(frame)g(from)g(network)396
1055 y(beacon_t)g(beacon;)396 1153 y(ssize_t)g(size)g(=)h(zre_udp_recv)
e(\(self->udp,)g(\(byte)2459 1166 y(*)2504 1153 y(\))h(&beacon,)g
(sizeof)f(\(beacon_t\)\);)396 1347 y(//)90 b(Basic)44
b(validation)f(on)h(the)h(frame)396 1444 y(if)g(\(size)f(!=)g(sizeof)g
(\(beacon_t\))396 1541 y(||)90 b(beacon.protocol)42 b([0])i(!=)h('Z')
396 1638 y(||)90 b(beacon.protocol)42 b([1])i(!=)h('R')396
1735 y(||)90 b(beacon.protocol)42 b([2])i(!=)h('E')396
1833 y(||)90 b(beacon.version)42 b(!=)j(BEACON_VERSION\))576
1930 y(return)e(0;)673 b(//)89 b(Ignore)44 b(invalid)f(beacons)396
2124 y(//)90 b(If)44 b(we)h(got)f(a)h(UUID)f(and)g(it's)g(not)h(our)f
(own)g(beacon,)g(we)g(have)h(a)f(peer)396 2221 y(if)h(\(memcmp)e
(\(beacon.uuid,)g(self->uuid,)g(sizeof)h(\(uuid_t\)\)\))f({)576
2318 y(char)800 2331 y(*)845 2318 y(identity)g(=)i(s_uuid_str)e
(\(beacon.uuid\);)576 2415 y(s_require_peer)f(\(self,)i(identity,)755
2512 y(zre_udp_from)f(\(self->udp\),)g(ntohs)h(\(beacon.port\)\);)576
2610 y(free)g(\(identity\);)396 2707 y(})-2 2798 y
SDict begin H.S end
 -2
2798 a -2 2798 a
SDict begin 13 H.A end
 -2 2798 a -2 2798 a
SDict begin [/View [/XYZ H.V]/Dest (0:5028) cvn /DEST pdfmark end
 -2 2798 a 396 3118
a Fd(8.5.2.)36 b(T)-10 b(rue)33 b(P)l(eer)h(Connectivity)i(\(Harmon)n
(y)e(P)l(attern\))3088 3118 y
SDict begin H.S end
 3088 3118 a 3088 3118 a
SDict begin 18.72 H.A end

3088 3118 a 3088 3118 a
SDict begin [/View [/XYZ H.V]/Dest (13.86.123.2) cvn /DEST pdfmark
end
 3088 3118 a -2 3309 a
SDict begin H.S end
 -2 3309
a -2 3309 a
SDict begin 13 H.A end
 -2 3309 a -2 3309 a
SDict begin [/View [/XYZ H.V]/Dest (0:5030) cvn /DEST pdfmark end
 -2 3309 a 396 3392 a
Fj(Since)20 b(\330MQ)h(is)g(designed)e(to)h(mak)o(e)g(distrib)n(uted)f
(messaging)h(easy)-5 b(,)19 b(people)g(often)h(ask)g(ho)n(w)g(to)g
(interconnect)e(a)j(set)396 3500 y(of)e(true)g(peers)g(\(as)h(compared)
e(to)h(ob)o(vious)f(clients)h(and)g(serv)o(ers\).)f(It)i(is)g(a)g
(thorn)o(y)e(question)g(and)h(\330MQ)g(doesn')o(t)f(really)396
3608 y(pro)o(vide)g(a)j(single)f(clear)g(answer)-5 b(.)-2
3792 y
SDict begin H.S end
 -2 3792 a -2 3792 a
SDict begin 13 H.A end
 -2 3792 a -2 3792 a
SDict begin [/View [/XYZ H.V]/Dest (0:5031) cvn /DEST pdfmark end
 -2 3792
a 396 3882 a Fj(TCP)c(,)21 b(which)e(is)j(the)e(most)g(commonly-used)d
(transport)i(in)h(\330MQ,)g(is)h(not)f(symmetric;)g(one)f(side)i(must)f
(bind)f(and)h(one)396 3990 y(must)g(connect)f(and)h(though)e(\330MQ)j
(tries)g(to)f(be)g(neutral)f(about)h(this,)g(it')-5 b(s)21
b(not.)f(When)g(you)f(connect,)g(you)g(create)h(an)396
4098 y(outgoing)e(message)i(pipe.)g(When)g(you)f(bind,)g(you)g(do)h
(not.)g(When)g(there)g(is)h(no)e(pipe,)h(you)f(cannot)g(write)i
(messages)396 4205 y(\(\330MQ)f(will)h(return)e(EA)m(GAIN\).)-2
4386 y
SDict begin H.S end
 -2 4386 a -2 4386 a
SDict begin 13 H.A end
 -2 4386 a -2 4386 a
SDict begin [/View [/XYZ H.V]/Dest (0:5032) cvn /DEST pdfmark end
 -2 4386
a 396 4479 a Fj(De)n(v)o(elopers)g(who)g(study)h(\330MQ)h(and)e(then)h
(try)g(to)g(create)g(N-to-N)g(connections)e(between)h(sets)j(of)e
(equal)f(peers)h(often)396 4587 y(try)g(a)h(R)m(OUTER-to-R)m(OUTER)e
(\003o)n(w)-5 b(.)20 b(It')-5 b(s)21 b(ob)o(vious)d(why:)h(each)h(peer)
g(needs)g(to)g(address)g(a)g(set)h(of)f(peers,)g(which)396
4695 y(requires)f(R)m(OUTER.)i(It)f(usually)g(ends)g(with)g(a)h
(plainti)n(v)o(e)e(email)h(to)g(the)g(list.)-2 4879 y
SDict begin H.S end

-2 4879 a -2 4879 a
SDict begin 13 H.A end
 -2 4879 a -2 4879 a
SDict begin [/View [/XYZ H.V]/Dest (0:5033) cvn /DEST pdfmark end
 -2 4879 a 396
4969 a Fj(My)g(conclusion)f(after)h(trying)f(se)n(v)o(eral)g(times)i
(from)e(dif)n(ferent)g(angles)h(is)h(that)f(R)m(OUTER-to-R)m(OUTER)f
(does)h(not)396 5077 y(w)o(ork.)g(At)g(a)h(minimum,)d(because)i(one)g
(peer)f(must)h(bind)g(and)f(one)h(must)g(connect,)f(meaning)g(the)h
(architecture)f(is)i(not)p Black 3757 5569 a Fi(356)p
Black eop end
%%Page: 357 371
TeXDict begin 357 370 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.357) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:5070) cvn /DEST pdfmark end
 -2 -201 a 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)
o(ving)g(Pieces)p Black 396 72 a Fj(symmetrical.)f(But)i(also)f
(because)g(you)f(simply)h(can')o(t)f(tell)i(when)f(you)f(are)h(allo)n
(wed)g(to)g(safely)g(send)g(a)h(message)f(to)g(a)396
180 y(peer)-5 b(.)20 b(It')-5 b(s)21 b(Catch-22:)e(you)g(can)h(talk)h
(to)f(a)h(peer)e(after)h(it')-5 b(s)21 b(talk)o(ed)f(to)h(you.)e(But)h
(the)h(peer)e(can')o(t)g(talk)i(to)f(you)f(until)396
288 y(you')l(v)o(e)f(talk)o(ed)i(to)g(it.)h(One)f(side)h(or)f(the)g
(other)f(will)i(be)f(losing)g(messages)g(and)g(thus)g(has)g(to)h(retry)
-5 b(,)19 b(which)g(means)h(the)396 396 y(peers)g(cannot)f(be)h(equal.)
-2 580 y
SDict begin H.S end
 -2 580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:5034) cvn /DEST pdfmark end
 -2 580 a
396 670 a Fj(I'm)g(going)f(to)h(e)o(xplain)f(the)h(Harmon)o(y)e
(pattern,)h(which)h(solv)o(es)g(this)h(problem,)d(and)i(which)f(we)i
(use)f(in)h(ZyRE.)-2 854 y
SDict begin H.S end
 -2 854 a -2 854 a
SDict begin 13 H.A end
 -2 854 a
-2 854 a
SDict begin [/View [/XYZ H.V]/Dest (0:5035) cvn /DEST pdfmark end
 -2 854 a 396 944 a Fj(W)-7 b(e)22 b(w)o(ant)e(a)h(guarantee)d
(that)i(when)g(a)g(peer)g("appears")f(on)h(our)f(netw)o(ork,)g(we)i
(can)f(talk)g(to)g(it)h(safely)-5 b(,)20 b(without)f(\330MQ)396
1052 y(dropping)f(messages.)i(F)o(or)g(this,)g(we)h(ha)n(v)o(e)e(to)i
(use)f(a)h(DEALER)f(or)g(PUSH)h(sock)o(et)f(which)3061
1052 y
SDict begin H.S end
 3061 1052 a 3061 1052 a
SDict begin 13 H.A end
 3061 1052 a 3061 1052
a
SDict begin [/View [/XYZ H.V]/Dest (0:5036) cvn /DEST pdfmark end
 3061 1052 a Fi(connects)g(out)g(to)g(the)g(peer)396
1160 y Fj(so)h(that)f(e)n(v)o(en)f(if)i(that)f(connection)e(tak)o(es)j
(some)f(non-zero)d(time,)k(there)e(is)i(immediately)e(a)i(pipe,)e(and)h
(\330MQ)g(will)396 1268 y(accept)g(outgoing)e(messages.)-2
1452 y
SDict begin H.S end
 -2 1452 a -2 1452 a
SDict begin 13 H.A end
 -2 1452 a -2 1452 a
SDict begin [/View [/XYZ H.V]/Dest (0:5037) cvn /DEST pdfmark end
 -2 1452
a 396 1542 a Fj(A)j(DEALER)f(sock)o(et)g(cannot)f(address)h(multiple)g
(peers)f(indi)n(vidually)-5 b(.)18 b(But)j(if)f(we)h(ha)n(v)o(e)e(one)h
(DEALER)g(per)g(peer)m(,)396 1650 y(and)g(we)g(connect)f(that)i(DEALER)
f(to)g(the)g(peer)m(,)g(we)g(can)g(safely)g(send)g(messages)g(to)h(a)f
(peer)g(as)h(soon)e(as)i(we')l(v)o(e)396 1758 y(connected)e(to)h(it.)-2
1925 y
SDict begin H.S end
 -2 1925 a -2 1925 a
SDict begin 13 H.A end
 -2 1925 a -2 1925 a
SDict begin [/View [/XYZ H.V]/Dest (0:5038) cvn /DEST pdfmark end
 -2 1925
a 396 2032 a Fj(No)n(w)-5 b(,)20 b(the)g(ne)o(xt)f(problem)g(is)i(to)f
(kno)n(w)f(who)h(sent)h(us)f(a)h(particular)e(message.)h(W)-7
b(e)21 b(need)e(a)i(reply)e(address,)h(that)g(is)h(the)396
2140 y(UUID)f(of)g(the)h(node)e(who)g(sent)i(an)o(y)e(gi)n(v)o(en)g
(message.)h(DEALER)g(can')o(t)f(do)h(this)h(unless)f(we)h(pre\002x)e(e)
n(v)o(ery)g(single)396 2248 y(message)h(with)h(that)f(16-byte)e(UUID,)i
(which)g(w)o(ould)f(be)i(w)o(asteful.)f(R)m(OUTER)g(does,)g(if)g(we)h
(set)g(the)f(identity)396 2356 y(properly)e(before)h(connecting)f(to)i
(the)h(router)-5 b(.)-2 2540 y
SDict begin H.S end
 -2 2540 a -2 2540 a
SDict begin 13 H.A end
 -2
2540 a -2 2540 a
SDict begin [/View [/XYZ H.V]/Dest (0:5039) cvn /DEST pdfmark end
 -2 2540 a 396 2630 a Fj(And)20 b(so)h(the)f(Harmon)o
(y)e(pattern)h(comes)h(do)n(wn)f(to:)-2 2648 y
SDict begin H.S end
 -2 2648
a -2 2648 a
SDict begin 13 H.A end
 -2 2648 a -2 2648 a
SDict begin [/View [/XYZ H.V]/Dest (0:5040) cvn /DEST pdfmark end
 -2 2648 a -2 2658 a
SDict begin H.S end
 -2
2658 a -2 2658 a
SDict begin 13 H.A end
 -2 2658 a -2 2658 a
SDict begin [/View [/XYZ H.V]/Dest (0:5041) cvn /DEST pdfmark end
 -2 2658 a Black
396 2800 a Fe(\225)p Black 479 2800 a
SDict begin H.S end
 479 2800 a 479
2800 a
SDict begin 13 H.A end
 479 2800 a 479 2800 a
SDict begin [/View [/XYZ H.V]/Dest (0:5042) cvn /DEST pdfmark end
 479 2800 a Fj(One)h(R)m(OUTER)h(sock)o(et)
f(that)g(we)h(bind)e(to)h(a)h(transient)f(port,)f(which)h(we)g
(broadcast)f(in)h(our)g(beacons.)-2 2818 y
SDict begin H.S end
 -2 2818 a
-2 2818 a
SDict begin 13 H.A end
 -2 2818 a -2 2818 a
SDict begin [/View [/XYZ H.V]/Dest (0:5043) cvn /DEST pdfmark end
 -2 2818 a Black 396 2949
a Fe(\225)p Black 479 2949 a
SDict begin H.S end
 479 2949 a 479 2949 a
SDict begin 13 H.A end
 479
2949 a 479 2949 a
SDict begin [/View [/XYZ H.V]/Dest (0:5044) cvn /DEST pdfmark end
 479 2949 a Fj(One)g(DEALER)h(sock)o(et)1219
2949 y
SDict begin H.S end
 1219 2949 a 1219 2949 a
SDict begin 13 H.A end
 1219 2949 a 1219 2949
a
SDict begin [/View [/XYZ H.V]/Dest (0:5045) cvn /DEST pdfmark end
 1219 2949 a Fi(per)f(peer)i Fj(that)e(we)h(connect)e(to)h(the)h
(peer')-5 b(s)20 b(R)m(OUTER)g(sock)o(et.)-2 2967 y
SDict begin H.S end
 -2
2967 a -2 2967 a
SDict begin 13 H.A end
 -2 2967 a -2 2967 a
SDict begin [/View [/XYZ H.V]/Dest (0:5046) cvn /DEST pdfmark end
 -2 2967 a Black
396 3099 a Fe(\225)p Black 479 3099 a
SDict begin H.S end
 479 3099 a 479
3099 a
SDict begin 13 H.A end
 479 3099 a 479 3099 a
SDict begin [/View [/XYZ H.V]/Dest (0:5047) cvn /DEST pdfmark end
 479 3099 a Fj(Reading)g(from)f(our)g(R)m
(OUTER)i(sock)o(et.)-2 3117 y
SDict begin H.S end
 -2 3117 a -2 3117 a
SDict begin 13 H.A end
 -2
3117 a -2 3117 a
SDict begin [/View [/XYZ H.V]/Dest (0:5048) cvn /DEST pdfmark end
 -2 3117 a Black 396 3248 a Fe(\225)p
Black 479 3248 a
SDict begin H.S end
 479 3248 a 479 3248 a
SDict begin 13 H.A end
 479 3248 a 479
3248 a
SDict begin [/View [/XYZ H.V]/Dest (0:5049) cvn /DEST pdfmark end
 479 3248 a Fj(Writing)f(to)h(the)f(peer')-5 b(s)20
b(DEALER)g(sock)o(et.)-2 3432 y
SDict begin H.S end
 -2 3432 a -2 3432 a
SDict begin 13 H.A end
 -2
3432 a -2 3432 a
SDict begin [/View [/XYZ H.V]/Dest (0:5050) cvn /DEST pdfmark end
 -2 3432 a 396 3522 a Fj(Ne)o(xt)g(problem)f(is)i(that)
f(disco)o(v)o(ery)e(isn')o(t)i(neatly)g(synchronized.)d(W)-7
b(e)21 b(can)f(get)g(the)h(\002rst)f(beacon)f(from)h(a)g(peer)3631
3522 y
SDict begin H.S end
 3631 3522 a 3631 3522 a
SDict begin 13 H.A end
 3631 3522 a 3631 3522
a
SDict begin [/View [/XYZ H.V]/Dest (0:5051) cvn /DEST pdfmark end
 3631 3522 a Fi(after)396 3630 y Fj(we)h(start)g(to)f(recei)n(v)o(e)f
(messages)h(from)f(it.)i(A)g(message)f(comes)g(in)g(on)g(the)g(R)m
(OUTER)h(sock)o(et)f(and)f(has)i(a)f(nice)g(UUID)396
3738 y(attached)g(to)g(it.)h(But)f(no)g(physical)f(IP)i(address)f(and)f
(port.)g(W)-7 b(e)22 b(ha)n(v)o(e)d(to)i(force)e(disco)o(v)o(ery)f(o)o
(v)o(er)h(TCP)-9 b(.)20 b(T)-7 b(o)21 b(do)f(this,)g(our)396
3846 y(\002rst)h(command)d(to)j(an)o(y)e(ne)n(w)h(peer)g(we)g(connect)f
(to)i(is)g(an)f(OHAI)g(command)e(with)j(our)e(IP)i(address)e(and)h
(port.)f(This)396 3954 y(ensure)h(that)g(the)g(recei)n(v)o(er)f
(connects)g(back)h(to)g(us)h(before)d(trying)h(to)i(send)f(us)g(an)o(y)
g(command.)-2 4138 y
SDict begin H.S end
 -2 4138 a -2 4138 a
SDict begin 13 H.A end
 -2 4138 a -2
4138 a
SDict begin [/View [/XYZ H.V]/Dest (0:5052) cvn /DEST pdfmark end
 -2 4138 a 396 4228 a Fj(Breaking)f(this)i(do)n(wn)e(into)h
(steps:)-2 4246 y
SDict begin H.S end
 -2 4246 a -2 4246 a
SDict begin 13 H.A end
 -2 4246 a -2 4246
a
SDict begin [/View [/XYZ H.V]/Dest (0:5053) cvn /DEST pdfmark end
 -2 4246 a -2 4256 a
SDict begin H.S end
 -2 4256 a -2 4256 a
SDict begin 13 H.A end
 -2 4256 a -2
4256 a
SDict begin [/View [/XYZ H.V]/Dest (0:5054) cvn /DEST pdfmark end
 -2 4256 a Black 396 4398 a Fe(\225)p Black 479
4398 a
SDict begin H.S end
 479 4398 a 479 4398 a
SDict begin 13 H.A end
 479 4398 a 479 4398 a
SDict begin [/View [/XYZ H.V]/Dest (0:5055) cvn /DEST pdfmark end
 479
4398 a Fj(If)g(we)h(recei)n(v)o(e)e(a)i(UDP)f(beacon)f(we)i(connect)e
(to)h(the)g(peer)-5 b(.)-2 4416 y
SDict begin H.S end
 -2 4416 a -2 4416 a
SDict begin 13 H.A end

-2 4416 a -2 4416 a
SDict begin [/View [/XYZ H.V]/Dest (0:5056) cvn /DEST pdfmark end
 -2 4416 a Black 396 4547 a Fe(\225)p
Black 479 4547 a
SDict begin H.S end
 479 4547 a 479 4547 a
SDict begin 13 H.A end
 479 4547 a 479
4547 a
SDict begin [/View [/XYZ H.V]/Dest (0:5057) cvn /DEST pdfmark end
 479 4547 a Fj(W)e(e)22 b(read)d(messages)i(from)e(our)g(R)m
(OUTER)i(sock)o(et,)e(and)h(each)g(message)g(comes)g(with)g(the)g(UUID)
h(of)f(the)g(sender)-5 b(.)-2 4565 y
SDict begin H.S end
 -2 4565 a -2 4565
a
SDict begin 13 H.A end
 -2 4565 a -2 4565 a
SDict begin [/View [/XYZ H.V]/Dest (0:5058) cvn /DEST pdfmark end
 -2 4565 a Black 396 4697 a Fe(\225)p
Black 479 4697 a
SDict begin H.S end
 479 4697 a 479 4697 a
SDict begin 13 H.A end
 479 4697 a 479
4697 a
SDict begin [/View [/XYZ H.V]/Dest (0:5059) cvn /DEST pdfmark end
 479 4697 a Fj(If)20 b(it')-5 b(s)22 b(an)e(OHAI)g(message)g(we)h
(connect)e(back)g(to)h(that)h(peer)e(if)i(not)f(already)f(connected)f
(to)i(it.)-2 4715 y
SDict begin H.S end
 -2 4715 a -2 4715 a
SDict begin 13 H.A end
 -2 4715 a -2
4715 a
SDict begin [/View [/XYZ H.V]/Dest (0:5060) cvn /DEST pdfmark end
 -2 4715 a Black 396 4846 a Fe(\225)p Black 479
4846 a
SDict begin H.S end
 479 4846 a 479 4846 a
SDict begin 13 H.A end
 479 4846 a 479 4846 a
SDict begin [/View [/XYZ H.V]/Dest (0:5061) cvn /DEST pdfmark end
 479
4846 a Fj(If)g(it')-5 b(s)22 b(an)o(y)d(other)g(message,)h(we)1449
4846 y
SDict begin H.S end
 1449 4846 a 1449 4846 a
SDict begin 13 H.A end
 1449 4846 a 1449 4846
a
SDict begin [/View [/XYZ H.V]/Dest (0:5062) cvn /DEST pdfmark end
 1449 4846 a Fi(must)i Fj(already)d(be)h(connected)e(to)j(the)f(peer)g
(\(a)g(good)f(place)h(for)f(an)h(assertion\).)-2 4864
y
SDict begin H.S end
 -2 4864 a -2 4864 a
SDict begin 13 H.A end
 -2 4864 a -2 4864 a
SDict begin [/View [/XYZ H.V]/Dest (0:5063) cvn /DEST pdfmark end
 -2 4864 a Black
396 4996 a Fe(\225)p Black 479 4996 a
SDict begin H.S end
 479 4996 a 479
4996 a
SDict begin 13 H.A end
 479 4996 a 479 4996 a
SDict begin [/View [/XYZ H.V]/Dest (0:5064) cvn /DEST pdfmark end
 479 4996 a Fj(W)-7 b(e)21
b(send)f(messages)f(to)h(each)g(peer)f(using)g(a)h(dedicated)e(per)n
(-peer)h(DEALER)g(sock)o(et,)h(which)3249 4996 y
SDict begin H.S end
 3249
4996 a 3249 4996 a
SDict begin 13 H.A end
 3249 4996 a 3249 4996 a
SDict begin [/View [/XYZ H.V]/Dest (0:5065) cvn /DEST pdfmark end
 3249 4996
a Fi(must)h Fj(be)f(connected.)-2 5014 y
SDict begin H.S end
 -2 5014 a -2
5014 a
SDict begin 13 H.A end
 -2 5014 a -2 5014 a
SDict begin [/View [/XYZ H.V]/Dest (0:5066) cvn /DEST pdfmark end
 -2 5014 a Black 396 5145 a
Fe(\225)p Black 479 5145 a
SDict begin H.S end
 479 5145 a 479 5145 a
SDict begin 13 H.A end
 479
5145 a 479 5145 a
SDict begin [/View [/XYZ H.V]/Dest (0:5067) cvn /DEST pdfmark end
 479 5145 a Fj(When)g(we)h(connect)e(to)h(a)h(peer)e
(we)i(also)f(tell)h(our)f(application)e(that)j(the)f(peer)g(e)o(xists.)
-2 5163 y
SDict begin H.S end
 -2 5163 a -2 5163 a
SDict begin 13 H.A end
 -2 5163 a -2 5163 a
SDict begin [/View [/XYZ H.V]/Dest (0:5068) cvn /DEST pdfmark end
 -2
5163 a Black 3756 5569 a Fi(357)p Black eop end
%%Page: 358 372
TeXDict begin 358 371 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.358) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black Black 396 72 a Fe(\225)p Black
479 72 a
SDict begin H.S end
 479 72 a 479 72 a
SDict begin 13 H.A end
 479 72 a 479 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:5069) cvn /DEST pdfmark end
 479 72 a
Fj(Ev)o(ery)f(time)h(we)h(get)f(a)h(message)f(from)f(a)i(peer)m(,)e(we)
h(treat)h(that)f(as)h(a)f(heartbeat)f(\(it')-5 b(s)21
b(ali)n(v)o(e\).)396 346 y(If)f(we)h(were)f(not)g(using)f(UDP)i(b)n(ut)
f(some)g(other)g(disco)o(v)o(ery)e(mechanism,)h(I')l(d)g(still)i(use)g
(the)f(Harmon)o(y)e(pattern)h(for)h(a)396 454 y(true)g(peer)g(netw)o
(ork:)f(one)g(R)m(OUTER)i(for)f(input)f(from)g(all)i(peers,)f(and)f
(one)h(DEALER)g(per)g(peer)f(for)h(output.)f(Bind)396
562 y(the)h(R)m(OUTER,)h(connect)e(the)h(DEALER,)g(and)f(start)i(each)f
(con)m(v)o(ersation)d(with)k(an)f(OHAI)g(equi)n(v)n(alent)f(that)h(pro)
o(vides)396 670 y(the)g(return)f(IP)i(address)f(and)f(port.)h(Y)-9
b(ou)19 b(w)o(ould)h(need)f(some)h(e)o(xternal)f(mechanism)g(to)h
(bootstrap)f(each)h(connection.)-2 699 y
SDict begin H.S end
 -2 699 a -2
699 a
SDict begin 13 H.A end
 -2 699 a -2 699 a
SDict begin [/View [/XYZ H.V]/Dest (0:5071) cvn /DEST pdfmark end
 -2 699 a 396 1009 a Fd(8.5.3.)36
b(Detecting)f(Disappearances)2220 1009 y
SDict begin H.S end
 2220 1009 a
2220 1009 a
SDict begin 18.72 H.A end
 2220 1009 a 2220 1009 a
SDict begin [/View [/XYZ H.V]/Dest (13.86.124.2) cvn /DEST pdfmark
end
 2220 1009 a -2 1201
a
SDict begin H.S end
 -2 1201 a -2 1201 a
SDict begin 13 H.A end
 -2 1201 a -2 1201 a
SDict begin [/View [/XYZ H.V]/Dest (0:5073) cvn /DEST pdfmark end
 -2 1201 a 396
1283 a Fj(Heartbeating)19 b(sounds)g(simple)h(b)n(ut)h(it')-5
b(s)21 b(not.)e(UDP)i(pack)o(ets)f(get)g(dropped)e(when)i(there')-5
b(s)20 b(a)g(lot)h(of)f(TCP)h(traf)n(\002c,)f(so)g(if)396
1391 y(we)h(depend)d(on)i(UDP)h(beacons)e(we')o(ll)i(get)f(f)o(alse)g
(disconnections.)e(TCP)j(traf)n(\002c)f(can)g(be)h(delayed)e(for)g
(\002)n(v)o(e,)h(ten,)g(30)396 1499 y(seconds)g(if)g(the)h(netw)o(ork)e
(is)i(really)e(b)n(usy)-5 b(.)20 b(So)g(if)h(we)f(kill)h(peers)f(when)f
(the)o(y)h(go)f(quiet,)h(we')o(ll)h(ha)n(v)o(e)e(f)o(alse)396
1606 y(disconnections.)-2 1773 y
SDict begin H.S end
 -2 1773 a -2 1773 a
SDict begin 13 H.A end

-2 1773 a -2 1773 a
SDict begin [/View [/XYZ H.V]/Dest (0:5074) cvn /DEST pdfmark end
 -2 1773 a 396 1880 a Fj(Since)h(UDP)h(beacons)e
(aren')o(t)g(reliable,)h(it')-5 b(s)21 b(tempting)e(to)h(add)g(in)g
(TCP)h(beacons.)e(After)h(all,)h(TCP)g(will)g(deli)n(v)o(er)e(them)396
1988 y(reliably)-5 b(.)19 b(One)h(little)h(problem.)d(Imagine)h(you)g
(ha)n(v)o(e)h(100)f(nodes)h(on)g(a)g(netw)o(ork,)f(and)h(each)f(node)h
(sends)g(a)g(TCP)396 2096 y(beacon)f(once)h(a)g(second.)f(Each)h
(beacon)f(is)i(22)f(bytes)g(not)g(counting)e(TCP')-5
b(s)21 b(framing)e(o)o(v)o(erhead.)e(That)j(is)h(100)f(*)g(99)g(*)396
2204 y(22)g(bytes)g(per)g(second,)f(or)h(217,000)d(bytes/second)i(just)
i(for)e(heartbeating.)f(That')-5 b(s)20 b(about)g(1-2\045)f(of)h(a)h
(typical)f(W)m(iFi)396 2312 y(netw)o(ork')-5 b(s)20 b(ideal)g(capacity)
-5 b(,)19 b(which)g(sounds)h(OK.)g(But)h(when)e(a)i(netw)o(ork)e(is)i
(stressed,)f(or)g(\002ghting)f(other)h(netw)o(orks)396
2420 y(for)g(airspace,)f(that)i(e)o(xtra)e(200K)g(a)i(second)e(will)i
(break)e(what')-5 b(s)21 b(left.)f(UDP)h(broadcasts)e(are)h(at)h(least)
g(lo)n(w)f(cost.)-2 2604 y
SDict begin H.S end
 -2 2604 a -2 2604 a
SDict begin 13 H.A end
 -2 2604
a -2 2604 a
SDict begin [/View [/XYZ H.V]/Dest (0:5075) cvn /DEST pdfmark end
 -2 2604 a 396 2694 a Fj(So)h(what)f(we)g(do)g(is)h(switch)g
(to)f(TCP)h(heartbeats)f(only)f(when)g(a)i(speci\002c)f(peer)g(hasn')o
(t)f(sent)i(us)f(an)o(y)g(UDP)h(beacons)e(in)396 2802
y(a)i(while.)f(And)g(then,)f(we)i(send)f(TCP)h(heartbeats)e(only)g(to)i
(that)f(one)g(peer)-5 b(.)19 b(If)h(the)h(peer)e(continues)g(to)i(be)f
(silent,)g(we)396 2910 y(conclude)f(it')-5 b(s)21 b(gone)e(a)o(w)o(ay)
-5 b(.)19 b(If)h(the)h(peer)e(comes)h(back,)f(with)i(a)f(dif)n(ferent)f
(IP)h(address)g(and/or)f(port,)g(we)i(ha)n(v)o(e)e(to)396
3018 y(disconnect)g(our)h(DEALER)g(sock)o(et)g(and)f(reconnect)g(to)h
(the)g(ne)n(w)g(port.)-2 3202 y
SDict begin H.S end
 -2 3202 a -2 3202 a
SDict begin 13 H.A end
 -2
3202 a -2 3202 a
SDict begin [/View [/XYZ H.V]/Dest (0:5076) cvn /DEST pdfmark end
 -2 3202 a 396 3292 a Fj(This)h(gi)n(v)o(es)e(us)i(a)g
(set)f(of)g(states)i(for)d(each)h(peer)m(,)f(though)f(at)j(this)g
(stage)f(the)g(code)g(doesn')o(t)f(use)h(a)h(formal)e(state)396
3400 y(machine:)-2 3401 y
SDict begin H.S end
 -2 3401 a -2 3401 a
SDict begin 13 H.A end
 -2 3401
a -2 3401 a
SDict begin [/View [/XYZ H.V]/Dest (0:5077) cvn /DEST pdfmark end
 -2 3401 a -2 3411 a
SDict begin H.S end
 -2 3411 a -2 3411 a
SDict begin 13 H.A end
 -2
3411 a -2 3411 a
SDict begin [/View [/XYZ H.V]/Dest (0:5078) cvn /DEST pdfmark end
 -2 3411 a Black 396 3570 a Fe(\225)p
Black 479 3570 a
SDict begin H.S end
 479 3570 a 479 3570 a
SDict begin 13 H.A end
 479 3570 a 479
3570 a
SDict begin [/View [/XYZ H.V]/Dest (0:5079) cvn /DEST pdfmark end
 479 3570 a Fj(Peer)i(visible)f(thanks)f(to)i(UDP)f(beacon)f
(\(we)h(connect)f(using)h(IP)h(address)e(and)h(port)g(from)f(beacon\))
-2 3588 y
SDict begin H.S end
 -2 3588 a -2 3588 a
SDict begin 13 H.A end
 -2 3588 a -2 3588 a
SDict begin [/View [/XYZ H.V]/Dest (0:5080) cvn /DEST pdfmark end
 -2
3588 a Black 396 3719 a Fe(\225)p Black 479 3719 a
SDict begin H.S end
 479
3719 a 479 3719 a
SDict begin 13 H.A end
 479 3719 a 479 3719 a
SDict begin [/View [/XYZ H.V]/Dest (0:5081) cvn /DEST pdfmark end
 479 3719 a Fj(Peer)i(visible)f
(thanks)f(to)i(OHAI)f(command)e(\(we)i(connect)f(using)h(IP)g(address)g
(and)g(port)f(from)g(command\))-2 3737 y
SDict begin H.S end
 -2 3737 a -2
3737 a
SDict begin 13 H.A end
 -2 3737 a -2 3737 a
SDict begin [/View [/XYZ H.V]/Dest (0:5082) cvn /DEST pdfmark end
 -2 3737 a Black 396 3869 a
Fe(\225)p Black 479 3869 a
SDict begin H.S end
 479 3869 a 479 3869 a
SDict begin 13 H.A end
 479
3869 a 479 3869 a
SDict begin [/View [/XYZ H.V]/Dest (0:5083) cvn /DEST pdfmark end
 479 3869 a Fj(Peer)i(seems)f(ali)n(v)o(e)g(\(we)g
(got)g(a)h(UDP)g(beacon)d(or)i(command)f(o)o(v)o(er)f(TCP)j(recently\))
-2 3887 y
SDict begin H.S end
 -2 3887 a -2 3887 a
SDict begin 13 H.A end
 -2 3887 a -2 3887 a
SDict begin [/View [/XYZ H.V]/Dest (0:5084) cvn /DEST pdfmark end
 -2
3887 a Black 396 4018 a Fe(\225)p Black 479 4018 a
SDict begin H.S end
 479
4018 a 479 4018 a
SDict begin 13 H.A end
 479 4018 a 479 4018 a
SDict begin [/View [/XYZ H.V]/Dest (0:5085) cvn /DEST pdfmark end
 479 4018 a Fj(Peer)g(seems)f
(quiet)g(\(no)f(acti)n(vity)h(in)h(some)f(time,)g(so)g(we)h(send)f(a)g
(HUGZ)h(command\))-2 4036 y
SDict begin H.S end
 -2 4036 a -2 4036 a
SDict begin 13 H.A end
 -2 4036
a -2 4036 a
SDict begin [/View [/XYZ H.V]/Dest (0:5086) cvn /DEST pdfmark end
 -2 4036 a Black 396 4168 a Fe(\225)p Black
479 4168 a
SDict begin H.S end
 479 4168 a 479 4168 a
SDict begin 13 H.A end
 479 4168 a 479 4168
a
SDict begin [/View [/XYZ H.V]/Dest (0:5087) cvn /DEST pdfmark end
 479 4168 a Fj(Peer)g(has)f(disappeared)e(\(no)i(reply)f(to)h(our)g
(HUGZ)g(commands,)e(so)j(we)f(destro)o(y)g(peer\))-2
4352 y
SDict begin H.S end
 -2 4352 a -2 4352 a
SDict begin 13 H.A end
 -2 4352 a -2 4352 a
SDict begin [/View [/XYZ H.V]/Dest (0:5088) cvn /DEST pdfmark end
 -2 4352
a 396 4442 a Fj(There')-5 b(s)20 b(one)g(remaining)e(scenario)h(we)i
(didn')o(t)e(address)g(in)i(the)f(code)f(at)i(this)g(stage.)f(It')-5
b(s)21 b(possible)f(for)f(a)i(peer)e(to)396 4550 y(change)g(IP)i
(addresses)f(and)f(ports)h(without)f(actually)h(triggering)e(a)j
(disappearance)d(e)n(v)o(ent.)h(F)o(or)h(e)o(xample)f(if)h(the)g(user)
396 4658 y(switches)h(of)n(f)e(W)m(iFi)j(and)d(then)h(switches)h(it)g
(back)e(on,)h(then)f(the)h(the)h(access)f(point)g(can)g(assign)g(the)g
(peer)g(a)h(ne)n(w)f(IP)396 4765 y(address.)g(W)-7 b(e')o(ll)21
b(need)f(to)g(handle)f(a)i(disappeared)d(W)m(iFi)j(interf)o(ace)e(on)h
(our)g(node)f(by)g(unbinding)f(the)i(R)m(OUTER)396 4873
y(sock)o(et)g(and)g(rebinding)e(it)j(when)e(we)i(can.)f(Since)g(this)h
(is)g(not)f(central)f(to)i(the)f(design)f(no)n(w)-5 b(,)19
b(I)i(decide)e(to)i(log)e(an)i(issue)396 4981 y(on)f(the)g(GitHub)g
(track)o(er)f(and)h(lea)n(v)o(e)g(it)h(for)f(a)g(rain)o(y)f(day)-5
b(.)-2 5093 y
SDict begin H.S end
 -2 5093 a -2 5093 a
SDict begin 13 H.A end
 -2 5093 a -2 5093 a
SDict begin [/View [/XYZ H.V]/Dest (0:5089) cvn /DEST pdfmark end

-2 5093 a Black 3759 5569 a Fi(358)p Black eop end
%%Page: 359 373
TeXDict begin 359 372 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.359) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 94 a Fh(8.6.)39 b(Gr)m(oup)f(Messa)o(ging)
1487 94 y
SDict begin H.S end
 1487 94 a 1487 94 a
SDict begin 22.464 H.A end
 1487 94 a 1487 94 a
SDict begin [/View [/XYZ H.V]/Dest (13.87.1) cvn /DEST pdfmark end
 1487
94 a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2 292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:5091) cvn /DEST pdfmark end
 -2
292 a 396 368 a Fj(Group)19 b(messaging)g(is)j(a)e(common)e(and)i(v)o
(ery)f(useful)h(pattern.)f(The)h(concept)f(is)i(simple:)f(instead)g(of)
g(talking)f(to)i(a)396 476 y(single)f(node,)f(you)h(talk)g(to)g(a)h
("group")d(of)i(nodes.)f(The)h(group)e(is)k(just)e(a)h(name,)e(a)i
(string)f(that)g(you)f(agree)h(on)g(in)g(the)396 584
y(application.)f(It')-5 b(s)21 b(precisely)e(lik)o(e)h(using)g(the)g
(publish-subscribe)e(pre\002x)o(es)h(in)i(PUB)g(and)e(SUB)j(sock)o
(ets.)e(In)g(f)o(act)g(the)396 692 y(only)g(reason)f(I)h(say)h("group)d
(messaging")h(and)h(not)g("pub-sub")e(is)j(to)f(pre)n(v)o(ent)f
(confusion,)f(since)i(we')l(re)g(not)f(going)g(to)396
800 y(use)i(PUB/SUB)g(sock)o(ets)g(for)e(this.)-2 967
y
SDict begin H.S end
 -2 967 a -2 967 a
SDict begin 13 H.A end
 -2 967 a -2 967 a
SDict begin [/View [/XYZ H.V]/Dest (0:5092) cvn /DEST pdfmark end
 -2 967 a 396 1074
a Fj(PUB/SUB)j(w)o(ould)e(almost)g(w)o(ork.)f(But)i(we')l(v)o(e)e(just)
i(done)e(such)h(a)g(lot)h(of)f(w)o(ork)f(to)i(solv)o(e)e(the)i(late)f
(joiner)g(problem.)396 1182 y(Applications)f(are)h(ine)n(vitably)f
(going)g(to)h(w)o(ait)h(for)f(peers)g(to)g(arri)n(v)o(e)f(before)g
(sending)g(messages)h(to)h(groups,)d(so)j(we)396 1290
y(ha)n(v)o(e)f(to)g(b)n(uild)g(on)g(the)g(Harmon)o(y)e(pattern)h
(rather)h(than)f(start)i(again)e(beside)h(it.)-2 1474
y
SDict begin H.S end
 -2 1474 a -2 1474 a
SDict begin 13 H.A end
 -2 1474 a -2 1474 a
SDict begin [/View [/XYZ H.V]/Dest (0:5093) cvn /DEST pdfmark end
 -2 1474 a 396
1564 a Fj(Let')-5 b(s)21 b(look)e(at)i(the)f(operations)f(we)i(w)o(ant)
f(to)g(do)g(on)g(groups:)-2 1582 y
SDict begin H.S end
 -2 1582 a -2 1582
a
SDict begin 13 H.A end
 -2 1582 a -2 1582 a
SDict begin [/View [/XYZ H.V]/Dest (0:5094) cvn /DEST pdfmark end
 -2 1582 a -2 1592 a
SDict begin H.S end
 -2 1592 a -2
1592 a
SDict begin 13 H.A end
 -2 1592 a -2 1592 a
SDict begin [/View [/XYZ H.V]/Dest (0:5095) cvn /DEST pdfmark end
 -2 1592 a Black 396 1734 a
Fe(\225)p Black 479 1734 a
SDict begin H.S end
 479 1734 a 479 1734 a
SDict begin 13 H.A end
 479
1734 a 479 1734 a
SDict begin [/View [/XYZ H.V]/Dest (0:5096) cvn /DEST pdfmark end
 479 1734 a Fj(W)-7 b(e)22 b(w)o(ant)e(to)g(join)g
(and)g(lea)n(v)o(e)g(groups.)-2 1752 y
SDict begin H.S end
 -2 1752 a -2 1752
a
SDict begin 13 H.A end
 -2 1752 a -2 1752 a
SDict begin [/View [/XYZ H.V]/Dest (0:5097) cvn /DEST pdfmark end
 -2 1752 a Black 396 1883 a Fe(\225)p
Black 479 1883 a
SDict begin H.S end
 479 1883 a 479 1883 a
SDict begin 13 H.A end
 479 1883 a 479
1883 a
SDict begin [/View [/XYZ H.V]/Dest (0:5098) cvn /DEST pdfmark end
 479 1883 a Fj(W)-7 b(e)22 b(w)o(ant)e(to)g(kno)n(w)f(what)i
(other)e(nodes)g(are)i(in)f(an)o(y)f(gi)n(v)o(en)g(group.)-2
1901 y
SDict begin H.S end
 -2 1901 a -2 1901 a
SDict begin 13 H.A end
 -2 1901 a -2 1901 a
SDict begin [/View [/XYZ H.V]/Dest (0:5099) cvn /DEST pdfmark end
 -2 1901
a Black 396 2033 a Fe(\225)p Black 479 2033 a
SDict begin H.S end
 479 2033
a 479 2033 a
SDict begin 13 H.A end
 479 2033 a 479 2033 a
SDict begin [/View [/XYZ H.V]/Dest (0:5100) cvn /DEST pdfmark end
 479 2033 a Fj(W)-7
b(e)22 b(w)o(ant)e(to)g(send)g(a)h(message)f(to)g(\(all)h(nodes)e(in\))
h(a)h(group.)-2 2217 y
SDict begin H.S end
 -2 2217 a -2 2217 a
SDict begin 13 H.A end
 -2 2217 a
-2 2217 a
SDict begin [/View [/XYZ H.V]/Dest (0:5101) cvn /DEST pdfmark end
 -2 2217 a 396 2307 a Fj(Which)f(look)g(f)o(amiliar)f(to)i(an)
o(yone)d(who')-5 b(s)20 b(used)g(Internet)f(Relay)i(Chat,)f(e)o(xcept)f
(we)i(ha)n(v)o(e)e(no)h(serv)o(er)-5 b(.)20 b(Ev)o(ery)e(node)396
2415 y(will)j(need)f(to)g(k)o(eep)g(track)f(of)h(what)g(each)g(group)f
(represents.)g(This)h(information)e(will)j(not)f(al)o(w)o(ays)g(be)h
(fully)396 2523 y(consistent)f(across)g(the)h(netw)o(ork)e(b)n(ut)h(it)
h(will)g(be)f(close)g(enough.)-2 2707 y
SDict begin H.S end
 -2 2707 a -2
2707 a
SDict begin 13 H.A end
 -2 2707 a -2 2707 a
SDict begin [/View [/XYZ H.V]/Dest (0:5102) cvn /DEST pdfmark end
 -2 2707 a 396 2796 a Fj(Our)f(interf)o(ace)g
(will)h(track)f(a)g(set)i(of)e(groups)f(\(each)g(an)i(object\).)e
(These)h(are)g(all)h(the)f(kno)n(wn)f(groups)g(with)i(one)f(or)g(more)
396 2904 y(member)g(node,)g(e)o(xcluding)f(ourselv)o(es.)g(W)-7
b(e')o(ll)22 b(track)d(nodes)h(as)g(the)o(y)g(lea)n(v)o(e)g(and)f(join)
h(groups.)f(Since)h(nodes)f(can)h(join)396 3012 y(the)g(netw)o(ork)f
(at)i(an)o(y)f(time,)g(we)g(ha)n(v)o(e)g(to)g(tell)h(ne)n(w)f(peers)g
(what)g(groups)f(we')l(re)g(in.)h(When)h(a)f(peer)g(disappears,)f(we')o
(ll)396 3120 y(remo)o(v)o(e)g(it)h(from)g(all)g(groups)f(we)i(kno)n(w)e
(about.)-2 3304 y
SDict begin H.S end
 -2 3304 a -2 3304 a
SDict begin 13 H.A end
 -2 3304 a -2 3304
a
SDict begin [/View [/XYZ H.V]/Dest (0:5103) cvn /DEST pdfmark end
 -2 3304 a 396 3394 a Fj(This)i(gi)n(v)o(es)e(us)i(some)f(ne)n(w)g
(protocol)e(commands:)-2 3412 y
SDict begin H.S end
 -2 3412 a -2 3412 a
SDict begin 13 H.A end
 -2
3412 a -2 3412 a
SDict begin [/View [/XYZ H.V]/Dest (0:5104) cvn /DEST pdfmark end
 -2 3412 a -2 3422 a
SDict begin H.S end
 -2 3422 a -2 3422
a
SDict begin 13 H.A end
 -2 3422 a -2 3422 a
SDict begin [/View [/XYZ H.V]/Dest (0:5105) cvn /DEST pdfmark end
 -2 3422 a Black 396 3564 a Fe(\225)p
Black 479 3564 a
SDict begin H.S end
 479 3564 a 479 3564 a
SDict begin 13 H.A end
 479 3564 a 479
3564 a
SDict begin [/View [/XYZ H.V]/Dest (0:5106) cvn /DEST pdfmark end
 479 3564 a Fj(JOIN)j(-)f(we)h(send)f(this)g(to)h(all)g(peers)f
(when)f(we)i(join)f(a)g(group.)-2 3582 y
SDict begin H.S end
 -2 3582 a -2
3582 a
SDict begin 13 H.A end
 -2 3582 a -2 3582 a
SDict begin [/View [/XYZ H.V]/Dest (0:5107) cvn /DEST pdfmark end
 -2 3582 a Black 396 3714 a
Fe(\225)p Black 479 3714 a
SDict begin H.S end
 479 3714 a 479 3714 a
SDict begin 13 H.A end
 479
3714 a 479 3714 a
SDict begin [/View [/XYZ H.V]/Dest (0:5108) cvn /DEST pdfmark end
 479 3714 a Fj(LEA)-11 b(VE)20 b(-)g(we)h(send)f(this)
h(to)f(all)h(peers)f(when)f(we)i(lea)n(v)o(e)f(a)g(group.)-2
3898 y
SDict begin H.S end
 -2 3898 a -2 3898 a
SDict begin 13 H.A end
 -2 3898 a -2 3898 a
SDict begin [/View [/XYZ H.V]/Dest (0:5109) cvn /DEST pdfmark end
 -2 3898
a 396 3988 a Fj(Plus,)h(we)f(add)g(a)h('groups')d(\002eld)i(to)g(the)h
(\002rst)g(command)d(we)i(send)g(\(renamed)e(from)i(OHAI)g(to)g(HELLO)g
(at)h(this)f(point)396 4096 y(because)g(I)g(need)g(a)g(lar)o(ger)f(le)o
(xicon)g(of)h(command)e(v)o(erbs\).)-2 4280 y
SDict begin H.S end
 -2 4280
a -2 4280 a
SDict begin 13 H.A end
 -2 4280 a -2 4280 a
SDict begin [/View [/XYZ H.V]/Dest (0:5110) cvn /DEST pdfmark end
 -2 4280 a 396 4370 a
Fj(Lastly)-5 b(,)20 b(let')-5 b(s)21 b(add)f(a)g(w)o(ay)h(for)e(peers)h
(to)g(double-check)d(the)k(accurac)o(y)d(of)i(their)g(group)e(data.)i
(The)g(risk)g(is)h(that)g(we)396 4478 y(miss)g(one)f(of)g(the)g(abo)o
(v)o(e)f(messages.)h(Though)e(we)i(are)g(using)g(Harmon)o(y)e(to)i(a)n
(v)n(oid)g(the)h(typical)e(message)h(loss)h(at)396 4586
y(startup,)f(it')-5 b(s)21 b(w)o(orth)f(being)f(paranoid.)f(F)o(or)i
(no)n(w)-5 b(,)19 b(all)h(we)h(need)f(is)h(a)f(w)o(ay)h(to)f(detect)g
(such)g(a)g(f)o(ailure.)g(W)-7 b(e')o(ll)21 b(deal)f(with)396
4694 y(reco)o(v)o(ery)e(later)m(,)i(if)g(the)g(problem)f(actually)g
(happens.)-2 4878 y
SDict begin H.S end
 -2 4878 a -2 4878 a
SDict begin 13 H.A end
 -2 4878 a -2
4878 a
SDict begin [/View [/XYZ H.V]/Dest (0:5111) cvn /DEST pdfmark end
 -2 4878 a 396 4968 a Fj(I')o(ll)i(use)f(the)g(UDP)h(beacon)e
(for)g(this.)i(What)g(we)f(w)o(ant)g(is)i(a)e(rolling)f(counter)g(that)
h(simply)g(tells)h(ho)n(w)f(man)o(y)f(join)h(and)396
5075 y(lea)n(v)o(e)g(operations)f(\("transitions"\))g(there)g(ha)n(v)o
(e)h(been)f(for)h(a)h(node.)e(It)h(starts)h(at)g(0)f(and)g(increments)f
(for)g(each)h(group)p Black 3759 5569 a Fi(359)p Black
eop end
%%Page: 360 374
TeXDict begin 360 373 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.360) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 72 a Fj(we)h(join)f(or)g(lea)n(v)o(e.)f(W)-7
b(e)22 b(can)e(use)g(a)h(minimal)e(1-byte)g(v)n(alue)h(since)g(that)g
(will)h(catch)f(all)h(f)o(ailures)f(e)o(xcept)f(the)396
180 y(astronomically)f(rare)i("we)h(lost)f(precisely)g(256)f(messages)h
(in)h(a)f(ro)n(w")g(f)o(ailure)g(\(this)g(is)h(the)f(one)g(that)g(hits)
h(during)e(the)396 288 y(\002rst)i(demo\).)d(W)-7 b(e)20
b(will)h(also)f(put)f(the)h(transitions)f(counter)f(into)h(the)h(JOIN,)
g(LEA)-11 b(VE,)18 b(and)h(HELLO)h(commands.)d(And)396
396 y(to)k(try)f(to)g(pro)o(v)n(ok)o(e)e(the)i(problem,)e(we')o(ll)j
(test)g(by)f(joining/lea)n(ving)e(se)n(v)o(eral)h(hundred)f(groups,)h
(with)h(a)h(high-w)o(ater)396 504 y(mark)f(set)h(to)f(10)g(or)g(so.)-2
671 y
SDict begin H.S end
 -2 671 a -2 671 a
SDict begin 13 H.A end
 -2 671 a -2 671 a
SDict begin [/View [/XYZ H.V]/Dest (0:5112) cvn /DEST pdfmark end
 -2 671 a 396
778 a Fj(T)m(ime)g(to)h(choose)e(v)o(erbs)g(for)h(the)g(group)f
(messaging.)g(W)-7 b(e)21 b(need)e(a)i(command)d(that)j(means)e("talk)i
(to)f(one)g(peer")f(and)396 886 y(one)h(that)g(means)g("talk)g(to)h
(man)o(y)e(peers".)g(After)h(some)g(attempts,)g(my)g(best)g(choices)g
(are)g("WHISPER")h(and)396 994 y("SHOUT",)f(and)g(this)h(is)g(what)f
(the)g(code)g(uses.)g(The)g(SHOUT)g(command)f(needs)g(to)i(tell)g(the)f
(user)g(the)g(group)e(name,)396 1102 y(as)j(well)g(as)g(the)f(sender)f
(peer)-5 b(.)-2 1286 y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286 a
-2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:5113) cvn /DEST pdfmark end
 -2 1286 a 396 1376 a Fj(Since)20 b(groups)f(are)h(lik)o(e)h
(publish-subscribe,)c(you)i(might)h(be)g(tempted)f(to)i(use)f(this)h
(to)f(broadcast)f(the)h(JOIN)h(and)396 1484 y(LEA)-11
b(VE)19 b(commands)f(as)i(well,)g(perhaps)e(by)h(creating)f(a)i
("global")e(group)g(that)i(all)g(nodes)e(join.)h(My)h(advice)e(is)j(to)
e(k)o(eep)396 1592 y(groups)g(purely)f(as)i(user)n(-space)f(concepts)g
(for)g(tw)o(o)h(reasons.)f(First,)h(ho)n(w)g(do)f(you)g(join)g(the)h
(global)f(group)f(if)i(you)e(need)396 1700 y(the)i(global)g(group)e(to)
i(send)g(out)g(a)h(JOIN)f(command?)e(Second,)h(it)i(creates)f(special)g
(cases)h(\(')l(reserv)o(ed)d(names'\))h(which)396 1808
y(are)h(messy)-5 b(.)-2 1992 y
SDict begin H.S end
 -2 1992 a -2 1992 a
SDict begin 13 H.A end
 -2
1992 a -2 1992 a
SDict begin [/View [/XYZ H.V]/Dest (0:5114) cvn /DEST pdfmark end
 -2 1992 a 396 2082 a Fj(It')g(s)21 b(simpler)f(just)h
(to)f(send)g(JOINs)h(and)e(LEA)-11 b(VEs)20 b(e)o(xplicitly)g(to)g(all)
h(connected)d(peers,)i(period.)-2 2266 y
SDict begin H.S end
 -2 2266 a -2
2266 a
SDict begin 13 H.A end
 -2 2266 a -2 2266 a
SDict begin [/View [/XYZ H.V]/Dest (0:5115) cvn /DEST pdfmark end
 -2 2266 a 396 2356 a Fj(I'm)g(not)g(going)f
(to)h(w)o(ork)g(through)e(the)i(implementation)e(of)i(group)e
(messaging)h(in)i(detail)f(since)g(it')-5 b(s)22 b(f)o(airly)d
(pedantic)396 2464 y(and)h(not)g(e)o(xciting.)f(The)g(data)h
(structures)g(for)g(group)e(and)i(peer)f(management)f(aren')o(t)h
(optimal)h(b)n(ut)g(the)o(y')l(re)396 2571 y(w)o(orkable.)f(W)-7
b(e)21 b(need:)-2 2572 y
SDict begin H.S end
 -2 2572 a -2 2572 a
SDict begin 13 H.A end
 -2 2572
a -2 2572 a
SDict begin [/View [/XYZ H.V]/Dest (0:5116) cvn /DEST pdfmark end
 -2 2572 a -2 2582 a
SDict begin H.S end
 -2 2582 a -2 2582 a
SDict begin 13 H.A end
 -2
2582 a -2 2582 a
SDict begin [/View [/XYZ H.V]/Dest (0:5117) cvn /DEST pdfmark end
 -2 2582 a Black 396 2742 a Fe(\225)p
Black 479 2742 a
SDict begin H.S end
 479 2742 a 479 2742 a
SDict begin 13 H.A end
 479 2742 a 479
2742 a
SDict begin [/View [/XYZ H.V]/Dest (0:5118) cvn /DEST pdfmark end
 479 2742 a Fj(A)g(list)g(of)f(groups)f(for)g(our)h(interf)o
(ace,)f(which)h(we)g(can)g(send)g(to)g(ne)n(w)g(peers)g(in)h(a)f(HELLO)
g(command;)-2 2760 y
SDict begin H.S end
 -2 2760 a -2 2760 a
SDict begin 13 H.A end
 -2 2760 a -2
2760 a
SDict begin [/View [/XYZ H.V]/Dest (0:5119) cvn /DEST pdfmark end
 -2 2760 a Black 396 2891 a Fe(\225)p Black 479
2891 a
SDict begin H.S end
 479 2891 a 479 2891 a
SDict begin 13 H.A end
 479 2891 a 479 2891 a
SDict begin [/View [/XYZ H.V]/Dest (0:5120) cvn /DEST pdfmark end
 479
2891 a Fj(A)h(hash)f(of)g(groups)f(for)g(other)g(peers,)h(which)g(we)g
(update)f(with)i(information)d(from)h(HELLO,)g(JOIN,)i(and)e(LEA)-11
b(VE)479 2999 y(commands;)-2 3011 y
SDict begin H.S end
 -2 3011 a -2 3011
a
SDict begin 13 H.A end
 -2 3011 a -2 3011 a
SDict begin [/View [/XYZ H.V]/Dest (0:5121) cvn /DEST pdfmark end
 -2 3011 a Black 396 3148 a Fe(\225)p
Black 479 3148 a
SDict begin H.S end
 479 3148 a 479 3148 a
SDict begin 13 H.A end
 479 3148 a 479
3148 a
SDict begin [/View [/XYZ H.V]/Dest (0:5122) cvn /DEST pdfmark end
 479 3148 a Fj(A)21 b(hash)f(of)g(peers)g(for)f(each)h(group,)e
(which)i(we)h(update)e(with)h(the)g(same)h(three)e(commands.)-2
3332 y
SDict begin H.S end
 -2 3332 a -2 3332 a
SDict begin 13 H.A end
 -2 3332 a -2 3332 a
SDict begin [/View [/XYZ H.V]/Dest (0:5123) cvn /DEST pdfmark end
 -2 3332
a 396 3422 a Fj(At)i(this)g(stage)f(I'm)g(starting)g(to)g(get)g(pretty)
g(happ)o(y)e(with)j(the)f(binary)f(serialization)g(\(our)g(codec)h
(generator)e(from)h(The)396 3530 y(Human)g(Scale)p 0
TeXcolorgray 841 3530 a
SDict begin H.S end
 841 3530 a Fj(Chapter)h(6)1167
3530 y
SDict begin 13 H.L end
 1167 3530 a 1167 3530 a
SDict begin [/Subtype /Link/Dest (0:the-human-scale) cvn/H /I/Border
[0 0 0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1167 3530 a Black -1 w
Fj(\),)h(which)e(handles)h(lists)h(and)f(dictionaries)f(as)i(well)g(as)
f(strings)h(and)e(inte)o(gers.)-2 3714 y
SDict begin H.S end
 -2 3714 a -2
3714 a
SDict begin 13 H.A end
 -2 3714 a -2 3714 a
SDict begin [/View [/XYZ H.V]/Dest (0:5125) cvn /DEST pdfmark end
 -2 3714 a 396 3804 a Fj(This)i(v)o(ersion)e
(is)i(tagged)e(in)h(the)g(repository)f(as)i(v0.2.0)d(and)i(you)f(can)
2452 3804 y
SDict begin H.S end
 2452 3804 a 2452 3804 a
SDict begin 13 H.A end
 2452 3804 a 2452
3804 a
SDict begin [/View [/XYZ H.V]/Dest (0:5126) cvn /DEST pdfmark end
 2452 3804 a Fj(do)n(wnload)f(the)i(tarball)396
3912 y(\(https://github)m(.com/zeromq/zyr)o(e/tags\))14
b(if)21 b(you)e(w)o(ant)i(to)f(check)f(what)h(the)h(code)e(look)o(ed)g
(lik)o(e)h(at)h(this)g(stage.)-2 3941 y
SDict begin H.S end
 -2 3941 a -2
3941 a
SDict begin 13 H.A end
 -2 3941 a -2 3941 a
SDict begin [/View [/XYZ H.V]/Dest (0:5127) cvn /DEST pdfmark end
 -2 3941 a 359 x Fh(8.7.)39
b(T)-9 b(esting)38 b(and)h(Sim)m(ulation)1846 4300 y
SDict begin H.S end

1846 4300 a 1846 4300 a
SDict begin 22.464 H.A end
 1846 4300 a 1846 4300 a
SDict begin [/View [/XYZ H.V]/Dest (13.88.1) cvn /DEST pdfmark end
 1846
4300 a -2 4332 a
SDict begin H.S end
 -2 4332 a -2 4332 a
SDict begin 13 H.A end
 -2 4332 a -2 4332
a
SDict begin [/View [/XYZ H.V]/Dest (0:5129) cvn /DEST pdfmark end
 -2 4332 a 396 4628 a Fd(8.7.1.)d(On)d(Asser)r(tions)1546
4628 y
SDict begin H.S end
 1546 4628 a 1546 4628 a
SDict begin 18.72 H.A end
 1546 4628 a 1546 4628
a
SDict begin [/View [/XYZ H.V]/Dest (13.88.125.2) cvn /DEST pdfmark
end
 1546 4628 a -2 4795 a
SDict begin H.S end
 -2 4795 a -2 4795 a
SDict begin 13 H.A end
 -2 4795 a
-2 4795 a
SDict begin [/View [/XYZ H.V]/Dest (0:5131) cvn /DEST pdfmark end
 -2 4795 a 396 4902 a Fj(The)20 b(proper)f(use)h(of)g
(assertions)g(is)h(one)f(of)g(the)g(hallmarks)f(of)h(a)h(professional)d
(programmer)-5 b(.)p Black 3759 5569 a Fi(360)p Black
eop end
%%Page: 361 375
TeXDict begin 361 374 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.361) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5132) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Our)g(con\002rmation)e(bias)j(as)g
(creators)e(mak)o(es)h(it)h(hard)e(to)i(test)g(our)e(w)o(ork)h
(properly)-5 b(.)17 b(W)-7 b(e)21 b(tend)f(to)h(write)f(tests)h(to)g
(pro)o(v)o(e)396 180 y(the)f(code)g(w)o(orks,)g(rather)f(than)h(trying)
f(to)h(pro)o(v)o(e)e(it)j(doesn')o(t.)e(There)g(are)h(man)o(y)f
(reasons)h(for)f(this.)i(W)-7 b(e)21 b(pretend)e(to)396
288 y(ourselv)o(es)g(and)g(others)g(that)h(we)g(can)g(be)g(\(could)e
(be\))i(perfect,)e(when)h(in)h(f)o(act)g(we)g(consistently)f(mak)o(e)h
(mistak)o(es.)f(Bugs)396 396 y(in)i(code)e(are)h(seen)h(as)f("bad",)g
(rather)f(than)h("ine)n(vitable",)e(so)j(psychologically)c(we)k(w)o
(ant)f(to)h(see)f(fe)n(wer)g(of)g(them,)f(not)396 504
y(unco)o(v)o(er)f(more)h(of)h(them.)g("He)g(writes)h(perfect)e(code")g
(is)j(a)e(compliment)f(rather)g(than)h(a)g(euphemism)f(for)g("he)h(ne)n
(v)o(er)396 612 y(tak)o(es)h(risks)f(so)h(his)g(code)e(is)i(as)g
(boring)e(and)g(hea)n(vily)h(used)g(as)h(cold)e(spaghetti".)-2
796 y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:5133) cvn /DEST pdfmark end
 -2 796 a 396
886 a Fj(Some)h(cultures)g(teach)g(us)g(to)h(aspire)f(to)g(perfection,)
e(and)i(punish)f(mistak)o(es,)h(in)g(education)f(and)h(w)o(ork,)f
(which)h(mak)o(es)396 994 y(this)h(attitude)f(w)o(orse.)g(T)-7
b(o)20 b(accept)g(that)g(we')l(re)g(f)o(allible,)g(and)f(then)h(to)g
(learn)g(ho)n(w)g(to)g(turn)g(that)g(into)g(pro\002t)f(rather)h(than)
396 1102 y(shame)g(is)h(one)f(of)g(the)g(hardest)g(intellectual)f(e)o
(x)o(ercises,)h(in)g(an)o(y)f(profession.)g(W)-7 b(e)21
b(le)n(v)o(erage)e(our)g(f)o(allibilities)i(by)396 1210
y(w)o(orking)e(with)h(others,)g(and)f(by)h(challenging)e(our)i(o)n(wn)f
(w)o(ork)h(sooner)m(,)e(not)i(later)-5 b(.)-2 1394 y
SDict begin H.S end

-2 1394 a -2 1394 a
SDict begin 13 H.A end
 -2 1394 a -2 1394 a
SDict begin [/View [/XYZ H.V]/Dest (0:5134) cvn /DEST pdfmark end
 -2 1394 a 396
1484 a Fj(One)20 b(trick)g(that)h(mak)o(es)f(it)h(easier)f(is)h(to)f
(use)h(assertions.)f(Assertions)g(are)g(not)g(a)h(form)e(of)h(error)f
(handling.)f(The)o(y)h(are)396 1592 y(e)o(x)o(ecutable)g(theories)g(of)
h(f)o(act.)g(The)g(code)g(asserts,)g("at)h(this)g(point,)e(such)h(and)f
(such)h(must)h(be)f(true")f(and)h(if)h(the)396 1700 y(assertion)f(f)o
(ails,)h(the)f(code)g(kills)g(itself.)-2 1878 y
SDict begin H.S end
 -2 1878
a -2 1878 a
SDict begin 13 H.A end
 -2 1878 a -2 1878 a
SDict begin [/View [/XYZ H.V]/Dest (0:5135) cvn /DEST pdfmark end
 -2 1878 a 396 1974 a
Fj(The)f(f)o(aster)h(you)f(can)g(pro)o(v)o(e)f(code)h(incorrect,)f(the)
h(f)o(aster)h(and)f(more)g(accurately)f(you)h(can)g(\002x)h(it.)g
(Belie)n(ving)f(that)g(code)396 2082 y(w)o(orks)g(and)h(pro)o(ving)d
(that)i(it)i(beha)n(v)o(es)d(as)j(e)o(xpected)d(is)i(less)h(science,)e
(and)g(more)g(magical)g(thinking.)f(It')-5 b(s)20 b(f)o(ar)f(better)h
(to)396 2190 y(be)g(able)g(to)h(say)-5 b(,)20 b("libzmq)f(has)h(\002)n
(v)o(e)g(hundred)e(assertions)i(and)g(despite)g(all)h(my)e(ef)n(forts,)
h(not)f(one)h(of)g(them)g(f)o(ails".)-2 2374 y
SDict begin H.S end
 -2 2374
a -2 2374 a
SDict begin 13 H.A end
 -2 2374 a -2 2374 a
SDict begin [/View [/XYZ H.V]/Dest (0:5136) cvn /DEST pdfmark end
 -2 2374 a 396 2464 a
Fj(So)h(the)f(ZyRE)g(code)f(base)i(is)g(scattered)f(with)g(assertions,)
g(and)g(particularly)e(a)j(couple)e(on)h(the)g(code)f(that)i(deals)f
(with)396 2571 y(the)g(state)g(of)f(peers.)g(This)h(is)g(the)g(hardest)
f(aspect)g(to)h(get)f(right:)g(peers)g(need)g(to)h(track)f(each)g
(other)g(and)g(e)o(xchange)e(state)396 2679 y(accurately)-5
b(,)18 b(or)i(things)g(stop)g(w)o(orking.)f(The)g(algorithms)g(depends)
g(on)h(asynchronous)d(messages)k(\003ying)e(around)f(and)396
2787 y(I'm)i(pretty)f(sure)h(the)h(initial)f(design)g(has)g(\003a)o
(ws.)h(The)o(y)e(al)o(w)o(ays)h(do.)-2 2971 y
SDict begin H.S end
 -2 2971
a -2 2971 a
SDict begin 13 H.A end
 -2 2971 a -2 2971 a
SDict begin [/View [/XYZ H.V]/Dest (0:5137) cvn /DEST pdfmark end
 -2 2971 a 396 3061 a
Fj(And)g(as)h(I)f(test)h(the)g(original)e(ZyRE)h(code)f(by)h(starting)g
(and)f(stopping)g(instances)h(of)g(zre_ping)e(by)i(hand,)f(e)n(v)o(ery)
g(so)396 3169 y(often)h(I)g(get)g(an)g(assertion)g(f)o(ailure.)g
(Running)e(by)i(hand)f(doesn')o(t)g(reproduce)f(these)i(often)f
(enough,)f(so)j(let')-5 b(s)21 b(mak)o(e)f(a)396 3277
y(proper)f(tester)h(tool.)-2 3305 y
SDict begin H.S end
 -2 3305 a -2 3305
a
SDict begin 13 H.A end
 -2 3305 a -2 3305 a
SDict begin [/View [/XYZ H.V]/Dest (0:5138) cvn /DEST pdfmark end
 -2 3305 a 396 3616 a Fd(8.7.2.)36
b(On)d(Up-fr)n(ont)f(T)-7 b(esting)1847 3616 y
SDict begin H.S end
 1847 3616
a 1847 3616 a
SDict begin 18.72 H.A end
 1847 3616 a 1847 3616 a
SDict begin [/View [/XYZ H.V]/Dest (13.88.126.2) cvn /DEST pdfmark
end
 1847 3616 a -2
3808 a
SDict begin H.S end
 -2 3808 a -2 3808 a
SDict begin 13 H.A end
 -2 3808 a -2 3808 a
SDict begin [/View [/XYZ H.V]/Dest (0:5140) cvn /DEST pdfmark end
 -2 3808
a 396 3890 a Fj(Being)20 b(able)g(to)h(fully)e(test)i(the)g(real)f
(beha)n(vior)e(of)i(indi)n(vidual)f(components)f(in)i(the)g(laboratory)
e(can)i(mak)o(e)g(a)h(10x)e(or)396 3998 y(100x)g(dif)n(ference)f(to)j
(the)f(cost)g(of)g(your)f(project.)g(That)h(con\002rmation)e(bias)j
(engineers)e(ha)n(v)o(e)g(to)i(their)e(o)n(wn)h(w)o(ork)396
4105 y(mak)o(es)g(upfront)e(testing)j(incredibly)d(pro\002table,)h(and)
g(late-stage)h(testing)g(incredibly)f(e)o(xpensi)n(v)o(e.)-2
4289 y
SDict begin H.S end
 -2 4289 a -2 4289 a
SDict begin 13 H.A end
 -2 4289 a -2 4289 a
SDict begin [/View [/XYZ H.V]/Dest (0:5141) cvn /DEST pdfmark end
 -2 4289
a 396 4379 a Fj(I')o(ll)i(tell)f(you)g(a)g(short)g(story)g(about)f(a)i
(project)e(we)i(w)o(ork)o(ed)e(on)h(in)g(the)g(late)h(1990')-5
b(s.)19 b(W)-7 b(e)21 b(pro)o(vided)d(the)i(softw)o(are,)f(and)396
4487 y(other)h(teams)g(the)g(hardw)o(are,)f(for)g(a)i(f)o(actory)e
(automation)f(project.)h(Three)h(or)g(four)f(teams)h(brought)e(their)i
(e)o(xperts)396 4595 y(on-site,)g(which)f(w)o(as)i(a)g(remote)e(f)o
(actory)g(\(funn)o(y)f(ho)n(w)i(the)g(polluting)f(f)o(actories)g(are)i
(al)o(w)o(ays)f(in)h(remote)e(border)396 4703 y(country\).)-2
4887 y
SDict begin H.S end
 -2 4887 a -2 4887 a
SDict begin 13 H.A end
 -2 4887 a -2 4887 a
SDict begin [/View [/XYZ H.V]/Dest (0:5142) cvn /DEST pdfmark end
 -2 4887
a 396 4977 a Fj(One)h(of)g(these)h(teams,)f(a)g(\002rm)h(specializing)e
(in)h(industrial)g(automation,)e(b)n(uilt)i(tick)o(et)h(machines:)e
(kiosks,)h(and)396 5085 y(softw)o(are)g(to)g(run)g(on)g(them.)f
(Nothing)g(unusual:)g(swipe)i(a)f(badge,)f(choose)g(an)h(option,)f
(recei)n(v)o(e)g(a)i(tick)o(et.)f(The)o(y)p Black 3759
5569 a Fi(361)p Black eop end
%%Page: 362 376
TeXDict begin 362 375 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.362) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 72 a Fj(assembled)g(tw)o(o)g(of)g(these)h
(kiosks,)e(on-site,)h(each)g(week)g(bringing)e(some)i(more)f(bits)i
(and)e(pieces.)h(T)m(ick)o(et)h(printers,)396 180 y(monitor)e(screens,)
h(special)g(k)o(e)o(ypads)f(from)g(Israel.)h(The)g(stuf)n(f)g(had)f(to)
i(be)f(resistant)g(against)g(dust)g(since)g(the)g(kiosks)396
288 y(sat)h(outside.)f(Nothing)f(w)o(ork)o(ed.)f(The)i(screens)g(were)g
(unreadable)e(in)j(the)f(sun.)g(The)g(tick)o(et)g(printers)f
(continually)396 396 y(jammed)h(and)f(misprinted.)g(The)h(internals)f
(of)h(the)g(kiosk)g(were)g(just)h(sat)g(on)f(w)o(ooden)e(shelving.)h
(The)h(kiosk)g(softw)o(are)396 504 y(crashed)f(re)o(gularly)-5
b(.)17 b(It)j(w)o(as)h(comedic)d(e)o(xcept)h(that)h(the)f(project)g
(really)-5 b(,)2503 504 y
SDict begin H.S end
 2503 504 a 2503 504 a
SDict begin 13 H.A end
 2503
504 a 2503 504 a
SDict begin [/View [/XYZ H.V]/Dest (0:5143) cvn /DEST pdfmark end
 2503 504 a Fi(r)m(eally)20 b Fj(had)f(to)h(w)o(ork)f
(and)g(so)h(we)g(spent)g(weeks)396 612 y(and)g(then)g(months)f(on-site)
h(helping)e(the)j(other)e(teams)h(deb)n(ug)f(their)h(bits)h(and)f
(pieces)g(until)g(it)h(w)o(ork)o(ed.)-2 796 y
SDict begin H.S end
 -2 796
a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:5144) cvn /DEST pdfmark end
 -2 796 a 396 886 a Fj(A)g(year)f(later)m
(,)f(a)i(second)e(f)o(actory)-5 b(,)19 b(and)g(the)h(same)h(story)-5
b(.)19 b(By)i(this)f(time)h(the)f(client)g(w)o(as)h(getting)f
(impatient.)f(So)h(when)396 994 y(the)o(y)g(came)g(to)g(the)g(third)g
(and)f(lar)o(gest)h(f)o(actory)-5 b(,)18 b(a)j(year)f(later)m(,)f(we)i
(jumped)e(up)h(and)f(said,)h("please)h(let)f(us)h(mak)o(e)f(the)396
1102 y(kiosks)g(and)g(the)g(softw)o(are)g(and)f(e)n(v)o(erything".)-2
1286 y
SDict begin H.S end
 -2 1286 a -2 1286 a
SDict begin 13 H.A end
 -2 1286 a -2 1286 a
SDict begin [/View [/XYZ H.V]/Dest (0:5145) cvn /DEST pdfmark end
 -2 1286
a 396 1376 a Fj(So)i(we)f(made)g(a)g(detailed)g(design)g(for)f(the)h
(softw)o(are)g(and)g(hardw)o(are)f(and)g(found)g(suppliers)g(for)h(all)
g(the)h(pieces.)f(It)396 1484 y(took)g(us)g(three)g(months)f(to)i
(search)e(the)i(Internet)d(for)i(each)g(component,)d(and)j(another)f
(tw)o(o)h(months)f(to)i(get)f(them)396 1592 y(assembled)g(into)g
(stainless-steel)h(bricks)e(each)h(weighing)f(about)g(twenty)h(kilos.)g
(These)g(bricks)g(were)g(60cm)f(square)396 1700 y(and)h(20cm)f(deep,)g
(with)i(a)f(lar)o(ge)g(\003at-screen)f(panel)h(behind)e(unbreakable)g
(glass,)i(and)g(tw)o(o)h(connectors:)d(one)i(for)396
1808 y(po)n(wer)m(,)f(one)g(for)h(Ethernet.)f(Y)-9 b(ou)19
b(loaded)h(up)f(the)h(paper)g(bin)f(with)i(enough)d(for)i(six)g
(months,)f(then)h(scre)n(wed)g(the)g(brick)396 1916 y(into)g(a)h
(housing,)d(and)i(it)h(automatically)e(booted,)f(found)g(its)k(DNS)e
(serv)o(er)m(,)f(loaded)g(its)j(Linux)d(OS)h(and)g(then)396
2023 y(application)f(softw)o(are.)g(It)i(connected)d(to)j(the)f(real)g
(serv)o(er)m(,)f(and)g(sho)n(wed)h(the)g(main)g(menu.)f(Y)-9
b(ou)19 b(got)h(access)h(to)f(the)396 2131 y(con\002guration)e(screens)
i(by)g(swiping)f(a)i(special)f(badge)f(and)h(then)g(entering)e(a)j
(code.)-2 2315 y
SDict begin H.S end
 -2 2315 a -2 2315 a
SDict begin 13 H.A end
 -2 2315 a -2 2315
a
SDict begin [/View [/XYZ H.V]/Dest (0:5146) cvn /DEST pdfmark end
 -2 2315 a 396 2405 a Fj(The)f(softw)o(are)g(w)o(as)h(portable)e(so)h
(we)h(could)e(test)i(that)f(as)h(we)g(wrote)f(it,)g(and)g(as)h(we)f
(collected)g(the)g(pieces)g(from)g(our)396 2513 y(suppliers)g(we)g(k)o
(ept)g(one)g(of)g(each)g(so)g(we)h(had)e(a)i(disassembled)f(kiosk)f(to)
i(play)e(with.)h(When)g(we)h(got)f(our)f(\002nished)396
2621 y(kiosks,)h(the)o(y)f(all)i(w)o(ork)o(ed)e(immediately)-5
b(.)19 b(W)-7 b(e)21 b(shipped)e(them)h(to)g(the)g(client,)g(who)g
(plugged)e(them)i(into)g(their)396 2729 y(housing,)f(switched)h(them)f
(on,)h(and)g(went)g(to)g(b)n(usiness.)g(W)-7 b(e)22 b(spent)e(a)g(week)
g(or)g(so)h(on)e(site,)i(and)f(in)g(ten)g(years,)g(one)396
2837 y(kiosk)g(brok)o(e)f(\(the)h(screen)g(died,)f(and)h(w)o(as)h
(replaced\).)-2 3021 y
SDict begin H.S end
 -2 3021 a -2 3021 a
SDict begin 13 H.A end
 -2 3021 a
-2 3021 a
SDict begin [/View [/XYZ H.V]/Dest (0:5147) cvn /DEST pdfmark end
 -2 3021 a 396 3111 a Fj(Lesson)f(is,)h(test)g(up-front)d(so)j
(that)f(when)f(you)h(plug)f(the)h(thing)g(in,)g(you)f(kno)n(w)g
(precisely)h(ho)n(w)f(it')-5 b(s)22 b(going)d(to)h(beha)n(v)o(e.)396
3219 y(If)g(you)g(ha)n(v)o(en')o(t)e(tested)i(it)h(up-front,)d(you')l
(re)g(going)h(to)h(be)h(spending)d(weeks)i(and)g(months)f(in)i(the)f
(\002eld,)g(ironing)e(out)396 3327 y(problems)h(that)h(should)f(ne)n(v)
o(er)g(ha)n(v)o(e)h(been)f(there.)-2 3355 y
SDict begin H.S end
 -2 3355 a
-2 3355 a
SDict begin 13 H.A end
 -2 3355 a -2 3355 a
SDict begin [/View [/XYZ H.V]/Dest (0:5148) cvn /DEST pdfmark end
 -2 3355 a 396 3665 a Fd(8.7.3.)36
b(The)d(ZyRE)h(T)-7 b(ester)1664 3665 y
SDict begin H.S end
 1664 3665 a 1664
3665 a
SDict begin 18.72 H.A end
 1664 3665 a 1664 3665 a
SDict begin [/View [/XYZ H.V]/Dest (13.88.127.2) cvn /DEST pdfmark
end
 1664 3665 a -2 3856 a
SDict begin H.S end

-2 3856 a -2 3856 a
SDict begin 13 H.A end
 -2 3856 a -2 3856 a
SDict begin [/View [/XYZ H.V]/Dest (0:5150) cvn /DEST pdfmark end
 -2 3856 a 396
3939 a Fj(During)19 b(manual)g(testing)i(I)f(did)g(hit)g(an)g
(assertion)g(rarely)-5 b(.)19 b(It)h(then)g(disappeared.)e(Since)i(I)h
(don')o(t)d(belie)n(v)o(e)i(in)g(magic,)396 4047 y(that)h(means)e(the)i
(code)e(is)i(still)h(wrong)d(some)n(where.)f(So,)i(ne)o(xt)g(step)g(is)
h(hea)n(vy-duty)d(testing)i(of)g(the)g(ZyRE)g(0.2.0)f(code)396
4155 y(to)i(try)f(to)g(break)f(its)i(assertions,)f(and)g(get)g(a)h
(good)e(idea)h(of)f(ho)n(w)h(it)h(will)g(beha)n(v)o(e)e(in)h(the)h
(\002eld.)-2 4339 y
SDict begin H.S end
 -2 4339 a -2 4339 a
SDict begin 13 H.A end
 -2 4339 a -2
4339 a
SDict begin [/View [/XYZ H.V]/Dest (0:5151) cvn /DEST pdfmark end
 -2 4339 a 396 4429 a Fj(W)-7 b(e)22 b(packaged)c(the)i(disco)o
(v)o(ery)e(and)i(messaging)f(functionality)f(as)j(an)f('interf)o(ace')f
(object)g(that)i(the)f(main)g(program)396 4537 y(creates,)g(w)o(orks)g
(with,)g(and)g(then)g(destro)o(ys.)f(W)-7 b(e)21 b(don')o(t)e(use)h(an)
o(y)g(global)f(v)n(ariables.)g(This)h(mak)o(es)g(it)h(easy)g(to)f
(start)396 4645 y(lar)o(ge)f(numbers)g(of)h(interf)o(aces)g(and)f
(simulate)h(real)h(acti)n(vity)-5 b(,)19 b(all)i(within)e(one)h
(process.)g(And)f(if)i(there')-5 b(s)20 b(one)g(thing)396
4753 y(we')l(v)o(e)f(learned)h(from)f(writing)g(lots)i(of)f(e)o
(xamples,)f(it')-5 b(s)21 b(that)f(\330MQ')-5 b(s)21
b(ability)f(to)g(orchestrate)f(multiple)h(threads)f(in)i(a)396
4861 y(single)f(process)g(is)961 4861 y
SDict begin H.S end
 961 4861 a 961
4861 a
SDict begin 13 H.A end
 961 4861 a 961 4861 a
SDict begin [/View [/XYZ H.V]/Dest (0:5152) cvn /DEST pdfmark end
 961 4861 a Fi(muc)o(h)g
Fj(easier)g(to)g(w)o(ork)g(with)g(than)g(multiple)f(processes.)-2
5045 y
SDict begin H.S end
 -2 5045 a -2 5045 a
SDict begin 13 H.A end
 -2 5045 a -2 5045 a
SDict begin [/View [/XYZ H.V]/Dest (0:5153) cvn /DEST pdfmark end
 -2 5045
a 396 5135 a Fj(The)h(\002rst)h(v)o(ersion)e(of)h(the)g(tester)h
(consists)f(of)g(a)h(main)f(thread)f(which)h(starts)h(and)e(stops)i(a)f
(set)h(of)f(child)g(threads,)f(each)p Black 3759 5569
a Fi(362)p Black eop end
%%Page: 363 377
TeXDict begin 363 376 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.363) cvn /DEST pdfmark end
 -611 -810 a Black
Black -2 -201 a
SDict begin H.S end
 -2 -201 a -2 -201 a
SDict begin 13 H.A end
 -2 -201 a -2 -201
a
SDict begin [/View [/XYZ H.V]/Dest (0:5173) cvn /DEST pdfmark end
 -2 -201 a 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)
o(ving)g(Pieces)p Black 396 72 a Fj(running)e(one)i(interf)o(ace,)f
(each)h(with)g(a)h(R)m(OUTER,)f(DEALER,)g(and)g(UDP)h(sock)o(et)f
(\('R',)f('D',)h(and)g('U')g(in)g(the)396 180 y(diagram\)\()p
0 TeXcolorgray 726 180 a
SDict begin H.S end
 726 180 a Fj(Figure)d(8-2)1073
180 y
SDict begin 13 H.L end
 1073 180 a 1073 180 a
SDict begin [/Subtype /Link/Dest (0:figure-73) cvn/H /I/Border [0 0
0]BorderArrayPatch/Color [1 0 0] H.B /ANN pdfmark end
 1073 180 a Black -1 w Fj(\).)-2
198 y
SDict begin H.S end
 -2 198 a -2 198 a
SDict begin 13 H.A end
 -2 198 a -2 198 a
SDict begin [/View [/XYZ H.V]/Dest (0:figure-73) cvn /DEST pdfmark
end
 -2 198 a 396
382 a Fk(Figur)o(e)j(8-2.)f(ZyRE)i(T)-8 b(ester)21 b(T)-8
b(ool)-2 482 y
SDict begin H.S end
 -2 482 a -2 482 a
SDict begin 13 H.A end
 -2 482 a -2 482 a
SDict begin [/View [/XYZ H.V]/Dest (0:5157) cvn /DEST pdfmark end
 -2
482 a 396 2323 a
 currentpoint currentpoint translate 1 1 scale neg exch neg exch translate
 396 2323 a @beginspecial 0 @llx -216
@lly 390 @urx 0 @ury 3900 @rwi @setspecial
%%BeginDocument: images/fig73.eps
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -216 390 0
%%HiResBoundingBox: 0.0 -216.0 390.0 0.0
%%Creator: DitaaEps
%%EndComments
%%BeginProlog
%%EndProlog
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
160.80018615722656 -23.800180435180664 moveto
160.80018615722656 -50.80017852783203 lineto
226.80018615722656 -50.80017852783203 lineto
226.80018615722656 -23.800180435180664 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -104.80017852783203 moveto
16.800180435180664 -131.80018615722656 lineto
88.80017852783203 -131.80018615722656 lineto
88.80017852783203 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
112.80017852783203 -104.80017852783203 moveto
112.80017852783203 -131.80018615722656 lineto
184.80018615722656 -131.80018615722656 lineto
184.80018615722656 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
208.80018615722656 -104.80017852783203 moveto
208.80018615722656 -131.80018615722656 lineto
280.8001708984375 -131.80018615722656 lineto
280.8001708984375 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
304.8001708984375 -104.80017852783203 moveto
304.8001708984375 -131.80018615722656 lineto
376.8001708984375 -131.80018615722656 lineto
376.8001708984375 -104.80017852783203 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -158.80018615722656 moveto
16.800180435180664 -176.80018615722656 lineto
88.80017852783203 -176.80018615722656 lineto
88.80017852783203 -158.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
16.800180435180664 -176.80018615722656 moveto
16.800180435180664 -194.80018615722656 lineto
38.80017852783203 -194.80018615722656 lineto
38.80017852783203 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
41.80017852783203 -176.80018615722656 moveto
41.80017852783203 -194.80018615722656 lineto
62.80017852783203 -194.80018615722656 lineto
62.80017852783203 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
65.80017852783203 -176.80018615722656 moveto
65.80017852783203 -194.80018615722656 lineto
88.80017852783203 -194.80018615722656 lineto
88.80017852783203 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
112.80017852783203 -158.80018615722656 moveto
112.80017852783203 -176.80018615722656 lineto
184.80018615722656 -176.80018615722656 lineto
184.80018615722656 -158.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
112.80017852783203 -176.80018615722656 moveto
112.80017852783203 -194.80018615722656 lineto
134.80018615722656 -194.80018615722656 lineto
134.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
137.80018615722656 -176.80018615722656 moveto
137.80018615722656 -194.80018615722656 lineto
158.80018615722656 -194.80018615722656 lineto
158.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
161.80018615722656 -176.80018615722656 moveto
161.80018615722656 -194.80018615722656 lineto
184.80018615722656 -194.80018615722656 lineto
184.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
208.80018615722656 -158.80018615722656 moveto
208.80018615722656 -176.80018615722656 lineto
280.8001708984375 -176.80018615722656 lineto
280.8001708984375 -158.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
208.80018615722656 -176.80018615722656 moveto
208.80018615722656 -194.80018615722656 lineto
230.80018615722656 -194.80018615722656 lineto
230.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
233.80018615722656 -176.80018615722656 moveto
233.80018615722656 -194.80018615722656 lineto
254.80018615722656 -194.80018615722656 lineto
254.80018615722656 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
257.8001708984375 -176.80018615722656 moveto
257.8001708984375 -194.80018615722656 lineto
280.8001708984375 -194.80018615722656 lineto
280.8001708984375 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
304.8001708984375 -158.80018615722656 moveto
304.8001708984375 -176.80018615722656 lineto
376.8001708984375 -176.80018615722656 lineto
376.8001708984375 -158.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
304.8001708984375 -176.80018615722656 moveto
304.8001708984375 -194.80018615722656 lineto
326.8001708984375 -194.80018615722656 lineto
326.8001708984375 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
329.8001708984375 -176.80018615722656 moveto
329.8001708984375 -194.80018615722656 lineto
350.8001708984375 -194.80018615722656 lineto
350.8001708984375 -176.80018615722656 lineto
closepath
fill
0.5882352941176471 0.5882352941176471 0.5882352941176471 setrgbcolor
newpath
353.8001708984375 -176.80018615722656 moveto
353.8001708984375 -194.80018615722656 lineto
376.8001708984375 -194.80018615722656 lineto
376.8001708984375 -176.80018615722656 lineto
closepath
fill
1.0 1.0 1.0 setrgbcolor
newpath
159.0 -22.0 moveto
159.0 -49.0 lineto
225.0 -49.0 lineto
225.0 -22.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
0.6 setlinewidth
1 setlinecap
[] 0 setdash
newpath
159.0 -22.0 moveto
159.0 -49.0 lineto
225.0 -49.0 lineto
225.0 -22.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -103.0 moveto
15.0 -130.0 lineto
87.0 -130.0 lineto
87.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -103.0 moveto
15.0 -130.0 lineto
87.0 -130.0 lineto
87.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
111.0 -103.0 moveto
111.0 -130.0 lineto
183.0 -130.0 lineto
183.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
111.0 -103.0 moveto
111.0 -130.0 lineto
183.0 -130.0 lineto
183.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -103.0 moveto
207.0 -130.0 lineto
279.0 -130.0 lineto
279.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -103.0 moveto
207.0 -130.0 lineto
279.0 -130.0 lineto
279.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
303.0 -103.0 moveto
303.0 -130.0 lineto
375.0 -130.0 lineto
375.0 -103.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
303.0 -103.0 moveto
303.0 -130.0 lineto
375.0 -130.0 lineto
375.0 -103.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -157.0 moveto
15.0 -175.0 lineto
87.0 -175.0 lineto
87.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -157.0 moveto
15.0 -175.0 lineto
87.0 -175.0 lineto
87.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
15.0 -175.0 moveto
15.0 -193.0 lineto
37.0 -193.0 lineto
37.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
15.0 -175.0 moveto
15.0 -193.0 lineto
37.0 -193.0 lineto
37.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
40.0 -175.0 moveto
40.0 -193.0 lineto
61.0 -193.0 lineto
61.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
40.0 -175.0 moveto
40.0 -193.0 lineto
61.0 -193.0 lineto
61.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
64.0 -175.0 moveto
64.0 -193.0 lineto
87.0 -193.0 lineto
87.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
64.0 -175.0 moveto
64.0 -193.0 lineto
87.0 -193.0 lineto
87.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
111.0 -157.0 moveto
111.0 -175.0 lineto
183.0 -175.0 lineto
183.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
111.0 -157.0 moveto
111.0 -175.0 lineto
183.0 -175.0 lineto
183.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
111.0 -175.0 moveto
111.0 -193.0 lineto
133.0 -193.0 lineto
133.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
111.0 -175.0 moveto
111.0 -193.0 lineto
133.0 -193.0 lineto
133.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
136.0 -175.0 moveto
136.0 -193.0 lineto
157.0 -193.0 lineto
157.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
136.0 -175.0 moveto
136.0 -193.0 lineto
157.0 -193.0 lineto
157.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
160.0 -175.0 moveto
160.0 -193.0 lineto
183.0 -193.0 lineto
183.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
160.0 -175.0 moveto
160.0 -193.0 lineto
183.0 -193.0 lineto
183.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -157.0 moveto
207.0 -175.0 lineto
279.0 -175.0 lineto
279.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -157.0 moveto
207.0 -175.0 lineto
279.0 -175.0 lineto
279.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
207.0 -175.0 moveto
207.0 -193.0 lineto
229.0 -193.0 lineto
229.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
207.0 -175.0 moveto
207.0 -193.0 lineto
229.0 -193.0 lineto
229.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
232.0 -175.0 moveto
232.0 -193.0 lineto
253.0 -193.0 lineto
253.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
232.0 -175.0 moveto
232.0 -193.0 lineto
253.0 -193.0 lineto
253.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
256.0 -175.0 moveto
256.0 -193.0 lineto
279.0 -193.0 lineto
279.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
256.0 -175.0 moveto
256.0 -193.0 lineto
279.0 -193.0 lineto
279.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
303.0 -157.0 moveto
303.0 -175.0 lineto
375.0 -175.0 lineto
375.0 -157.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
303.0 -157.0 moveto
303.0 -175.0 lineto
375.0 -175.0 lineto
375.0 -157.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
303.0 -175.0 moveto
303.0 -193.0 lineto
325.0 -193.0 lineto
325.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
303.0 -175.0 moveto
303.0 -193.0 lineto
325.0 -193.0 lineto
325.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
328.0 -175.0 moveto
328.0 -193.0 lineto
349.0 -193.0 lineto
349.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
328.0 -175.0 moveto
328.0 -193.0 lineto
349.0 -193.0 lineto
349.0 -175.0 lineto
closepath
stroke
1.0 1.0 1.0 setrgbcolor
newpath
352.0 -175.0 moveto
352.0 -193.0 lineto
375.0 -193.0 lineto
375.0 -175.0 lineto
closepath
fill
0.0 0.0 0.0 setrgbcolor
newpath
352.0 -175.0 moveto
352.0 -193.0 lineto
375.0 -193.0 lineto
375.0 -175.0 lineto
closepath
stroke
newpath
51.0 -130.0 moveto
51.0 -148.0 lineto
stroke
newpath
147.0 -130.0 moveto
147.0 -148.0 lineto
stroke
newpath
243.0 -130.0 moveto
243.0 -148.0 lineto
stroke
newpath
339.0 -130.0 moveto
339.0 -148.0 lineto
stroke
newpath
48.0 -90.0 moveto
51.0 -99.0 lineto
54.0 -90.0 lineto
closepath
fill
newpath
144.0 -90.0 moveto
147.0 -99.0 lineto
150.0 -90.0 lineto
closepath
fill
newpath
240.0 -90.0 moveto
243.0 -99.0 lineto
246.0 -90.0 lineto
closepath
fill
newpath
336.0 -90.0 moveto
339.0 -99.0 lineto
342.0 -90.0 lineto
closepath
fill
newpath
48.0 -144.0 moveto
51.0 -153.0 lineto
54.0 -144.0 lineto
closepath
fill
newpath
144.0 -144.0 moveto
147.0 -153.0 lineto
150.0 -144.0 lineto
closepath
fill
newpath
240.0 -144.0 moveto
243.0 -153.0 lineto
246.0 -144.0 lineto
closepath
fill
newpath
336.0 -144.0 moveto
339.0 -153.0 lineto
342.0 -144.0 lineto
closepath
fill
newpath
195.0 -49.0 moveto
195.0 -76.0 lineto
stroke
newpath
51.0 -94.0 moveto
51.0 -81.0 lineto
51.0 -77.66666666666667 52.0 -76.0 54.0 -76.0 curveto
147.0 -76.0 lineto
147.0 -76.0 lineto
stroke
newpath
147.0 -94.0 moveto
147.0 -76.0 lineto
stroke
newpath
243.0 -94.0 moveto
243.0 -76.0 lineto
stroke
newpath
339.0 -94.0 moveto
339.0 -81.0 lineto
339.0 -77.66666666666667 338.0 -76.0 336.0 -76.0 curveto
243.0 -76.0 lineto
243.0 -76.0 lineto
stroke
/Helvetica findfont
9 scalefont setfont
181.0 -35.0 moveto
(Main) show
176.0 -44.0 moveto
(thread) show
30.0 -116.0 moveto
(Child) show
30.0 -125.0 moveto
(thread) show
126.0 -116.0 moveto
(Child) show
126.0 -125.0 moveto
(thread) show
222.0 -116.0 moveto
(Child) show
222.0 -125.0 moveto
(thread) show
318.0 -116.0 moveto
(Child) show
318.0 -125.0 moveto
(thread) show
29.0 -170.0 moveto
(Interface) show
125.0 -170.0 moveto
(Interface) show
221.0 -170.0 moveto
(Interface) show
317.0 -170.0 moveto
(Interface) show
25.0 -188.0 moveto
(R ) show
49.0 -188.0 moveto
(D ) show
73.0 -188.0 moveto
(U ) show
121.0 -188.0 moveto
(R ) show
145.0 -188.0 moveto
(D ) show
169.0 -188.0 moveto
(U ) show
217.0 -188.0 moveto
(R ) show
241.0 -188.0 moveto
(D ) show
265.0 -188.0 moveto
(U ) show
313.0 -188.0 moveto
(R ) show
337.0 -188.0 moveto
(D ) show
361.0 -188.0 moveto
(U ) show
showpage
%%Trailer
%%EOF

%%EndDocument
 @endspecial 396 2323 a
 currentpoint currentpoint translate 1 1 div 1 1 div scale neg exch
neg exch translate
 396 2323 a -2 2489 a
SDict begin H.S end
 -2 2489
a -2 2489 a
SDict begin 13 H.A end
 -2 2489 a -2 2489 a
SDict begin [/View [/XYZ H.V]/Dest (0:5160) cvn /DEST pdfmark end
 -2 2489 a 396 2597 a
Fj(The)20 b(nice)g(thing)g(is)h(that)f(when)g(I)g(am)g(connected)f(to)h
(a)h(W)m(iFi)g(access)f(point,)g(all)g(ZyRE)h(traf)n(\002c)e(\(e)n(v)o
(en)g(between)h(tw)o(o)396 2705 y(interf)o(aces)g(in)g(the)g(same)h
(process\))e(goes)h(across)g(the)h(AP)-9 b(.)20 b(This)g(means)g(I)h
(can)f(fully)f(stress)i(test)g(an)o(y)f(W)m(iFi)396 2813
y(infrastructure)e(with)j(just)f(a)h(couple)e(of)h(PCs)i(running)c(in)i
(a)h(room.)d(It')-5 b(s)21 b(hard)e(to)i(emphasize)e(ho)n(w)h(v)n
(aluable)f(this)h(is:)i(if)396 2921 y(we)f(had)e(b)n(uilt)h(ZyRE)g(as,)
h(say)-5 b(,)20 b(a)g(dedicated)f(service)h(for)f(Android,)f(we')l(d)i
(literally)g(need)f(dozens)g(of)h(Android)e(tablets)396
3029 y(or)i(phones)f(to)h(do)g(an)o(y)g(lar)o(ge-scale)e(testing.)i
(Kiosks,)h(and)e(all)i(that.)-2 3213 y
SDict begin H.S end
 -2 3213 a -2 3213
a
SDict begin 13 H.A end
 -2 3213 a -2 3213 a
SDict begin [/View [/XYZ H.V]/Dest (0:5161) cvn /DEST pdfmark end
 -2 3213 a 396 3303 a Fj(The)f(focus)g(is)h(no)n
(w)e(on)h(breaking)e(the)j(current)e(code,)g(trying)g(to)h(pro)o(v)o(e)
f(it)h(wrong.)f(There')-5 b(s)3078 3303 y
SDict begin H.S end
 3078 3303 a
3078 3303 a
SDict begin 13 H.A end
 3078 3303 a 3078 3303 a
SDict begin [/View [/XYZ H.V]/Dest (0:5162) cvn /DEST pdfmark end
 3078 3303 a Fi(no)20
b(point)h Fj(at)f(this)h(stage)f(in)396 3411 y(testing)g(ho)n(w)g(well)
h(it)g(runs,)e(ho)n(w)h(f)o(ast)h(it)g(is,)f(ho)n(w)g(much)f(memory)g
(it)i(uses,)f(or)g(an)o(ything)e(else.)j(W)-7 b(e')o(ll)21
b(w)o(ork)f(up)f(to)396 3519 y(trying)g(\(and)h(f)o(ailing\))f(to)h
(break)f(each)h(indi)n(vidual)f(functionality)f(b)n(ut)i(\002rst,)h(we)
f(try)g(to)h(break)e(some)h(of)g(the)g(core)396 3627
y(assertions)g(I')l(v)o(e)f(put)h(into)g(the)g(code.)-2
3811 y
SDict begin H.S end
 -2 3811 a -2 3811 a
SDict begin 13 H.A end
 -2 3811 a -2 3811 a
SDict begin [/View [/XYZ H.V]/Dest (0:5163) cvn /DEST pdfmark end
 -2 3811
a 396 3901 a Fj(These)g(are:)-2 3902 y
SDict begin H.S end
 -2 3902 a -2 3902
a
SDict begin 13 H.A end
 -2 3902 a -2 3902 a
SDict begin [/View [/XYZ H.V]/Dest (0:5164) cvn /DEST pdfmark end
 -2 3902 a -2 3912 a
SDict begin H.S end
 -2 3912 a -2
3912 a
SDict begin 13 H.A end
 -2 3912 a -2 3912 a
SDict begin [/View [/XYZ H.V]/Dest (0:5165) cvn /DEST pdfmark end
 -2 3912 a Black 396 4071 a
Fe(\225)p Black 479 4071 a
SDict begin H.S end
 479 4071 a 479 4071 a
SDict begin 13 H.A end
 479
4071 a 479 4071 a
SDict begin [/View [/XYZ H.V]/Dest (0:5166) cvn /DEST pdfmark end
 479 4071 a Fj(The)g(\002rst)h(command)d(that)j(an)o
(y)e(node)g(recei)n(v)o(es)h(from)f(a)h(peer)g(MUST)g(be)g("HELLO".)g
(In)g(other)f(w)o(ords,)h(messages)479 4179 y
SDict begin H.S end
 479 4179
a 479 4179 a
SDict begin 13 H.A end
 479 4179 a 479 4179 a
SDict begin [/View [/XYZ H.V]/Dest (0:5167) cvn /DEST pdfmark end
 479 4179 a Fi(cannot)h
Fj(be)f(lost)g(during)f(the)h(peer)n(-to-peer)e(connection)g(process.)
-2 4197 y
SDict begin H.S end
 -2 4197 a -2 4197 a
SDict begin 13 H.A end
 -2 4197 a -2 4197 a
SDict begin [/View [/XYZ H.V]/Dest (0:5168) cvn /DEST pdfmark end
 -2
4197 a Black 396 4328 a Fe(\225)p Black 479 4328 a
SDict begin H.S end
 479
4328 a 479 4328 a
SDict begin 13 H.A end
 479 4328 a 479 4328 a
SDict begin [/View [/XYZ H.V]/Dest (0:5169) cvn /DEST pdfmark end
 479 4328 a Fj(The)i(state)h
(each)f(node)f(each)h(node)f(calculates)h(for)g(its)h(peers)f(matches)g
(the)g(state)h(each)f(peer)f(calculates)h(for)g(itself.)479
4436 y(In)g(other)g(w)o(ords,)f(again,)g(no)h(messages)g(are)g(lost)h
(in)f(the)h(netw)o(ork.)-2 4454 y
SDict begin H.S end
 -2 4454 a -2 4454 a
SDict begin 13 H.A end

-2 4454 a -2 4454 a
SDict begin [/View [/XYZ H.V]/Dest (0:5170) cvn /DEST pdfmark end
 -2 4454 a Black 396 4585 a Fe(\225)p
Black 479 4585 a
SDict begin H.S end
 479 4585 a 479 4585 a
SDict begin 13 H.A end
 479 4585 a 479
4585 a
SDict begin [/View [/XYZ H.V]/Dest (0:5171) cvn /DEST pdfmark end
 479 4585 a Fj(When)f(my)g(application)f(sends)h(a)h(message)f
(to)g(a)h(peer)m(,)e(we)h(ha)n(v)o(e)g(a)h(connection)d(to)i(that)g
(peer)-5 b(.)20 b(In)g(other)f(w)o(ords,)h(the)479 4693
y(application)f(only)g("sees")i(a)g(peer)e(after)h(we)h(ha)n(v)o(e)e
(established)h(a)h(\330MQ)f(connection)e(to)j(it.)-2
4877 y
SDict begin H.S end
 -2 4877 a -2 4877 a
SDict begin 13 H.A end
 -2 4877 a -2 4877 a
SDict begin [/View [/XYZ H.V]/Dest (0:5172) cvn /DEST pdfmark end
 -2 4877
a 396 4967 a Fj(W)m(ith)g(\330MQ,)f(there)g(are)g(se)n(v)o(eral)f
(cases)i(we)g(may)f(lose)g(messages.)g(One)g(is)h(when)f(the)g("late)h
(joiner")e(syndrome.)f(T)-7 b(w)o(o)396 5075 y(is)21
b(when)e(we)h(close)g(sock)o(ets)g(without)f(sending)g(e)n(v)o
(erything.)e(Three)i(is)i(when)e(we)h(o)o(v)o(er\003o)n(w)e(the)i
(high-w)o(ater)e(mark)h(on)p Black 3759 5569 a Fi(363)p
Black eop end
%%Page: 364 378
TeXDict begin 364 377 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.364) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 72 a Fj(a)h(R)m(OUTER)f(or)g(PUB)i(sock)o
(et.)d(F)o(our)h(is)h(when)e(we)i(use)f(an)h(unkno)n(wn)c(address)j
(with)g(a)h(R)m(OUTER)f(sock)o(et.)396 346 y(No)n(w)-5
b(,)20 b(I)g Fi(think)h Fj(Harmon)o(y)d(gets)j(around)d(all)j(these)f
(potential)g(cases.)g(But)h(we')l(re)f(also)g(adding)f(UDP)i(to)f(the)g
(mix.)g(So)396 454 y(the)g(\002rst)h(v)o(ersion)e(of)h(the)g(tester)h
(simulates)f(an)h(unstable)e(and)h(dynamic)e(netw)o(ork,)h(where)h
(nodes)f(come)h(and)f(go)396 562 y(randomly)-5 b(.)18
b(It')-5 b(s)20 b(here)g(that)g(things)g(will)h(break.)-2
746 y
SDict begin H.S end
 -2 746 a -2 746 a
SDict begin 13 H.A end
 -2 746 a -2 746 a
SDict begin [/View [/XYZ H.V]/Dest (0:5175) cvn /DEST pdfmark end
 -2 746 a 396
836 a Fj(Here)f(is)h(the)g(main)e(thread)h(of)g(the)g(tester)m(,)g
(which)f(manages)h(a)g(pool)g(of)g(100)f(threads,)g(starting)h(and)g
(stopping)e(each)396 944 y(one)i(randomly)-5 b(.)17 b(Ev)o(ery)i(~750)g
(msecs)i(it)g(either)f(starts)h(or)e(stops)i(one)f(random)e(thread.)h
(W)-7 b(e)21 b(randomize)d(the)j(timing)e(so)396 1052
y(that)i(threads)e(aren')o(t)g(all)i(synchronized.)c(After)j(a)g(fe)n
(w)h(minutes)e(we)i(ha)n(v)o(e)e(an)i(a)n(v)o(erage)d(of)i(50)g
(threads)g(happily)396 1160 y(chatting)g(to)g(each)g(other)f(lik)o(e)i
(K)m(orean)e(teenagers)g(in)h(Gangnam)f(subw)o(ay)g(station:)-2
1261 y
SDict begin H.S end
 -2 1261 a -2 1261 a
SDict begin 11.7 H.A end
 -2 1261 a -2 1261 a
SDict begin [/View [/XYZ H.V]/Dest (0:5176) cvn /DEST pdfmark end
 -2 1261
a 396 1340 a Fg(int)45 b(main)f(\(int)g(argc,)g(char)1517
1353 y(*)1562 1340 y(argv)g([]\))396 1437 y({)576 1534
y(//)89 b(Initialize)43 b(context)h(for)g(talking)g(to)g(tasks)576
1632 y(zctx_t)889 1645 y(*)934 1632 y(ctx)h(=)f(zctx_new)g(\(\);)576
1729 y(zctx_set_linger)e(\(ctx,)i(100\);)576 1923 y(//)89
b(Get)44 b(number)g(of)h(interfaces)e(to)h(simulate,)g(default)f(100)
576 2020 y(int)h(max_interface)f(=)h(100;)576 2117 y(int)g
(nbr_interfaces)e(=)j(0;)576 2214 y(if)f(\(argc)g(>)h(1\))755
2312 y(max_interface)e(=)h(atoi)g(\(argv)g([1]\);)576
2506 y(//)89 b(We)44 b(address)g(interfaces)f(as)i(an)f(array)g(of)h
(pipes)576 2603 y(void)800 2616 y(**)890 2603 y(pipes)e(=)i(zmalloc)f
(\(sizeof)f(\(void)2234 2616 y(*)2279 2603 y(\))2369
2616 y(*)2459 2603 y(max_interface\);)576 2797 y(//)89
b(We)44 b(will)h(randomly)e(start)h(and)g(stop)h(interface)e(threads)
576 2894 y(while)h(\(!zctx_interrupted\))d({)755 2992
y(uint)j(index)g(=)h(randof)f(\(max_interface\);)755
3089 y(//)89 b(Toggle)44 b(interface)f(thread)755 3186
y(if)h(\(pipes)g([index]\))g({)934 3283 y(zstr_send)g(\(pipes)f
([index],)h("STOP"\);)934 3380 y(zsocket_destroy)f(\(ctx,)h(pipes)g
([index]\);)934 3477 y(pipes)g([index])g(=)h(NULL;)934
3574 y(zclock_log)e(\("I:)i(Stopped)e(interface)h(\(\045d)g
(running\)",)f(--nbr_interfaces\);)755 3671 y(})755 3769
y(else)h({)934 3866 y(pipes)g([index])g(=)h(zthread_fork)d(\(ctx,)i
(interface_task,)f(NULL\);)934 3963 y(zclock_log)g(\("I:)i(Started)e
(interface)h(\(\045d)g(running\)",)f(++nbr_interfaces\);)755
4060 y(})755 4157 y(//)89 b(Sleep)44 b(~750)g(msecs)g(randomly)g(so)g
(we)h(smooth)f(out)g(activity)755 4254 y(zclock_sleep)f(\(randof)g
(\(500\))h(+)h(500\);)576 4351 y(})576 4449 y(zctx_destroy)d(\(&ctx\);)
576 4546 y(return)h(0;)396 4643 y(})-2 4817 y
SDict begin H.S end
 -2 4817
a -2 4817 a
SDict begin 13 H.A end
 -2 4817 a -2 4817 a
SDict begin [/View [/XYZ H.V]/Dest (0:5177) cvn /DEST pdfmark end
 -2 4817 a 396 4917 a
Fj(Note)20 b(that)h(we)f(maintain)g(a)g('pipe')f(to)i(each)e(child)h
(thread)f(\(CZMQ)i(creates)f(the)g(pipe)g(automatically)f(when)g(we)i
(use)396 5025 y(the)f(zthread_fork\(\))d(method\).)h(It')-5
b(s)21 b(via)f(this)h(pipe)e(that)i(we)f(tell)h(child)f(threads)f(to)i
(stop,)f(when)f(it')-5 b(s)22 b(time)e(for)f(them)h(to)396
5133 y(lea)n(v)o(e.)g(The)g(child)g(threads)f(do)h(the)g(follo)n(wing)f
(\(I'm)g(switching)h(to)g(pseudo-code)d(for)j(clarity\):)p
Black 3759 5569 a Fi(364)p Black eop end
%%Page: 365 379
TeXDict begin 365 378 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.365) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5178) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fg(create)44 b(an)h(interface)396
170 y(while)f(true:)576 267 y(poll)g(on)g(pipe)g(to)h(parent,)f(and)g
(on)g(interface)576 364 y(if)g(parent)g(sent)g(us)h(a)f(message:)755
461 y(break)576 558 y(if)g(interface)f(sent)i(us)f(a)h(message:)755
655 y(if)f(message)g(is)h(ENTER:)934 752 y(send)f(a)h(WHISPER)f(to)g
(the)h(new)f(peer)755 850 y(if)g(message)g(is)h(EXIT:)934
947 y(send)f(a)h(WHISPER)f(to)g(the)h(departed)e(peer)755
1044 y(if)h(message)g(is)h(WHISPER:)934 1141 y(send)f(back)h(a)f
(WHISPER)g(1/2)g(of)h(the)f(time)755 1238 y(if)g(message)g(is)h(SHOUT:)
934 1335 y(send)f(back)h(a)f(WHISPER)g(1/3)g(of)h(the)f(time)934
1432 y(send)g(back)h(a)f(SHOUT)g(1/3)h(of)f(the)g(time)576
1530 y(once)g(per)g(second:)755 1627 y(join)g(or)h(leave)f(one)g(of)g
(10)h(random)f(groups)396 1724 y(destroy)g(interface)-2
1818 y
SDict begin H.S end
 -2 1818 a -2 1818 a
SDict begin 13 H.A end
 -2 1818 a -2 1818 a
SDict begin [/View [/XYZ H.V]/Dest (0:5179) cvn /DEST pdfmark end
 -2 1818
a 396 2135 a Fd(8.7.4.)36 b(T)-7 b(est)33 b(Results)1430
2135 y
SDict begin H.S end
 1430 2135 a 1430 2135 a
SDict begin 18.72 H.A end
 1430 2135 a 1430 2135
a
SDict begin [/View [/XYZ H.V]/Dest (13.88.128.2) cvn /DEST pdfmark
end
 1430 2135 a -2 2302 a
SDict begin H.S end
 -2 2302 a -2 2302 a
SDict begin 13 H.A end
 -2 2302 a
-2 2302 a
SDict begin [/View [/XYZ H.V]/Dest (0:5181) cvn /DEST pdfmark end
 -2 2302 a 396 2409 a Fj(Y)-8 b(es,)21 b(we)f(brok)o(e)f(the)h
(code.)g(Se)n(v)o(eral)f(times,)h(in)h(f)o(act.)f(This)g(w)o(as)h
(satisfying.)f(I')o(ll)g(w)o(ork)g(through)e(the)i(dif)n(ferent)e
(things)396 2517 y(we)j(found.)-2 2684 y
SDict begin H.S end
 -2 2684 a -2
2684 a
SDict begin 13 H.A end
 -2 2684 a -2 2684 a
SDict begin [/View [/XYZ H.V]/Dest (0:5182) cvn /DEST pdfmark end
 -2 2684 a 396 2791 a Fj(Getting)f(nodes)g
(to)g(agree)f(on)h(consistent)g(group)e(status)j(w)o(as)g(the)g(most)f
(dif)n(\002cult.)f(Ev)o(ery)g(node)g(needs)h(to)g(track)g(the)396
2899 y(group)f(membership)f(of)i(the)g(whole)g(netw)o(ork,)e(as)j(I)g
(already)e(e)o(xplained)f(in)i(the)h(section)f("Group)e(Messaging".)396
3007 y(Group)h(messaging)g(is)j(a)e(publish-subscribe)e(pattern.)h
(JOINs)i(and)e(LEA)-11 b(VEs)20 b(are)g(analogous)f(to)h(')-5
b(subscribe')19 b(and)396 3115 y('unsubscribe')f(messages.)i(It')-5
b(s)21 b(essential)g(none)e(of)h(these)g(e)n(v)o(er)f(get)h(lost,)h(or)
f(we')o(ll)g(\002nd)g(nodes)g(dropping)d(randomly)396
3222 y(of)n(f)j(groups.)-2 3407 y
SDict begin H.S end
 -2 3407 a -2 3407 a
SDict begin 13 H.A end

-2 3407 a -2 3407 a
SDict begin [/View [/XYZ H.V]/Dest (0:5183) cvn /DEST pdfmark end
 -2 3407 a 396 3496 a Fj(So)h(each)e(node)h(counts)f
(the)h(total)g(number)f(of)h(JOINs)g(and)g(LEA)-11 b(VEs)20
b(it')-5 b(s)21 b(e)n(v)o(er)e(done,)g(and)h(broadcasts)f(this)i
(status)f(\(as)396 3604 y(1-byte)f(rolling)g(counter\))g(in)h(its)h
(UDP)g(beacon.)e(Other)g(nodes)h(pick)g(up)f(the)i(status,)f(compare)f
(it)i(to)f(their)g(o)n(wn)396 3712 y(calculations,)f(and)h(if)g(there')
-5 b(s)21 b(a)f(dif)n(ference,)e(the)i(code)g(asserts.)-2
3890 y
SDict begin H.S end
 -2 3890 a -2 3890 a
SDict begin 13 H.A end
 -2 3890 a -2 3890 a
SDict begin [/View [/XYZ H.V]/Dest (0:5184) cvn /DEST pdfmark end
 -2 3890
a 396 3986 a Fj(First)h(problem)e(w)o(as)i(that)f(UDP)h(beacons)e(get)h
(delayed)f(randomly)-5 b(,)18 b(so)i(the)o(y')l(re)f(useless)i(for)e
(carrying)f(the)j(status.)396 4094 y(When)f(a)h(beacons)e(arri)n(v)o
(es)g(late,)i(the)f(status)h(is)g(inaccurate)e(and)h(we)g(get)g(a)h('f)
o(alse)f(ne)o(gati)n(v)o(e'.)e(T)-7 b(o)20 b(\002x)g(this)h(we)g(mo)o
(v)o(ed)396 4202 y(the)f(status)h(information)d(into)i(the)g(JOIN)h
(and)e(LEA)-11 b(VE)20 b(commands.)e(W)-7 b(e)22 b(also)e(added)f(it)i
(to)f(the)h(HELLO)e(command.)396 4310 y(The)h(logic)g(then)g(becomes:)
-2 4328 y
SDict begin H.S end
 -2 4328 a -2 4328 a
SDict begin 13 H.A end
 -2 4328 a -2 4328 a
SDict begin [/View [/XYZ H.V]/Dest (0:5185) cvn /DEST pdfmark end
 -2
4328 a -2 4338 a
SDict begin H.S end
 -2 4338 a -2 4338 a
SDict begin 13 H.A end
 -2 4338 a -2 4338
a
SDict begin [/View [/XYZ H.V]/Dest (0:5186) cvn /DEST pdfmark end
 -2 4338 a Black 396 4480 a Fe(\225)p Black 479 4480
a
SDict begin H.S end
 479 4480 a 479 4480 a
SDict begin 13 H.A end
 479 4480 a 479 4480 a
SDict begin [/View [/XYZ H.V]/Dest (0:5187) cvn /DEST pdfmark end
 479 4480
a Fj(Get)h(initial)f(status)h(for)f(a)g(peer)g(from)f(its)i(HELLO)f
(command.)-2 4498 y
SDict begin H.S end
 -2 4498 a -2 4498 a
SDict begin 13 H.A end
 -2 4498 a -2
4498 a
SDict begin [/View [/XYZ H.V]/Dest (0:5188) cvn /DEST pdfmark end
 -2 4498 a Black 396 4630 a Fe(\225)p Black 479
4630 a
SDict begin H.S end
 479 4630 a 479 4630 a
SDict begin 13 H.A end
 479 4630 a 479 4630 a
SDict begin [/View [/XYZ H.V]/Dest (0:5189) cvn /DEST pdfmark end
 479
4630 a Fj(When)g(getting)g(a)g(JOIN)h(or)f(LEA)-11 b(VE)19
b(from)h(a)g(peer)m(,)f(increment)g(the)h(status)h(counter)-5
b(.)-2 4648 y
SDict begin H.S end
 -2 4648 a -2 4648 a
SDict begin 13 H.A end
 -2 4648 a -2 4648 a
SDict begin [/View [/XYZ H.V]/Dest (0:5190) cvn /DEST pdfmark end

-2 4648 a Black 396 4779 a Fe(\225)p Black 479 4779 a
SDict begin H.S end

479 4779 a 479 4779 a
SDict begin 13 H.A end
 479 4779 a 479 4779 a
SDict begin [/View [/XYZ H.V]/Dest (0:5191) cvn /DEST pdfmark end
 479 4779
a Fj(Check)20 b(that)g(the)h(ne)n(w)f(status)h(counter)d(matches)i(the)
g(v)n(alue)g(in)g(the)g(JOIN)h(or)f(LEA)-11 b(VE)19 b(command)-2
4780 y
SDict begin H.S end
 -2 4780 a -2 4780 a
SDict begin 13 H.A end
 -2 4780 a -2 4780 a
SDict begin [/View [/XYZ H.V]/Dest (0:5192) cvn /DEST pdfmark end
 -2 4780
a Black 396 4929 a Fe(\225)p Black 479 4929 a
SDict begin H.S end
 479 4929
a 479 4929 a
SDict begin 13 H.A end
 479 4929 a 479 4929 a
SDict begin [/View [/XYZ H.V]/Dest (0:5193) cvn /DEST pdfmark end
 479 4929 a Fj(If)h(it)h(doesn')o(t,)
e(assert.)p Black 3759 5569 a Fi(365)p Black eop end
%%Page: 366 380
TeXDict begin 366 379 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.366) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5194) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Ne)o(xt)g(problem)f(we)h(got)g(w)o
(as)h(that)f(messages)h(were)f(arri)n(ving)e(une)o(xpectedly)f(on)j(ne)
n(w)g(connections.)e(The)i(Harmon)o(y)396 180 y(pattern)g(connects,)f
(then)g(sends)i(HELLO)e(as)i(the)f(\002rst)h(command.)d(This)j(means)f
(the)g(recei)n(ving)e(peer)i(should)f(al)o(w)o(ays)396
288 y(get)h(HELLO)g(as)h(the)f(\002rst)h(command)e(from)g(a)h(ne)n(w)g
(peer)-5 b(.)20 b(W)-7 b(e)21 b(were)g(seeing)e(PING,)i(JOIN,)f(and)g
(other)f(commands)396 396 y(arri)n(ving.)-2 580 y
SDict begin H.S end
 -2
580 a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:5195) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(This)i(turned)e
(out)g(to)i(be)f(due)f(to)i(CZMQ')-5 b(s)21 b(ephemeral)d(port)i
(logic.)f(An)i(ephemeral)d(port)i(is)h(just)f(a)h(dynamically)396
778 y(assigned)f(port)f(that)i(a)f(service)g(can)g(get)g(rather)g(than)
f(asking)h(for)g(a)g(\002x)o(ed)g(port)f(number)-5 b(.)19
b(A)i(POSIX)f(system)h(usually)396 886 y(assigns)g(ephemeral)d(ports)i
(in)h(the)f(range)f(0xC000)g(to)h(0xFFFF)-7 b(.)20 b(CZMQ')-5
b(s)21 b(logic)f(is)h(to)g(look)e(for)h(a)g(free)g(port)g(in)g(this)396
994 y(range,)f(bind)h(to)g(that,)g(and)g(return)f(the)h(port)f(number)g
(to)h(the)g(calller)-5 b(.)-2 1178 y
SDict begin H.S end
 -2 1178 a -2 1178
a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:5196) cvn /DEST pdfmark end
 -2 1178 a 396 1268 a Fj(Which)20
b(sounds)g(\002ne,)g(until)g(you)f(get)h(one)g(node)f(stopping)g(and)g
(another)g(node)g(starting,)h(close)g(together)m(,)f(and)g(the)396
1376 y(ne)n(w)h(node)f(getting)h(the)g(port)g(number)e(of)i(the)g(old)g
(node.)f(Remember)g(that)h(\330MQ)h(tries)f(to)h(re-establish)e(a)i
(brok)o(en)396 1484 y(connection.)d(So)i(when)g(the)g(\002rst)h(node)e
(stopped,)g(its)i(peers)f(w)o(ould)f(retry)h(to)g(connect.)f(When)g
(the)i(ne)n(w)f(node)f(appears)396 1592 y(on)h(that)g(same)h(port,)e
(suddenly)f(all)j(the)f(peers)g(connect)f(to)i(it,)f(and)g(start)h
(chatting)e(lik)o(e)h(the)o(y')l(re)f(old)h(b)n(uddies.)-2
1776 y
SDict begin H.S end
 -2 1776 a -2 1776 a
SDict begin 13 H.A end
 -2 1776 a -2 1776 a
SDict begin [/View [/XYZ H.V]/Dest (0:5197) cvn /DEST pdfmark end
 -2 1776
a 396 1866 a Fj(It')-5 b(s)21 b(a)g(general)e(problem)f(that)j(af)n
(fects)f(an)o(y)f(lar)o(ger)n(-scale)g(dynamic)f(\330MQ)j(application.)
d(There)i(are)g(a)g(number)f(of)396 1974 y(plausible)h(answers.)g(One)g
(is)h(to)f(not)g(reuse)g(ephemeral)f(ports,)g(which)h(is)h(easier)f
(said)h(than)f(done)f(when)g(you)h(ha)n(v)o(e)396 2082
y(multiple)g(processes)g(on)f(one)h(system.)g(Another)f(solution)g(w)o
(ould)g(be)h(to)h(select)f(a)h(random)d(port)i(each)g(time,)g(which)f
(at)396 2190 y(least)i(reduces)e(the)i(risk)f(of)g(hitting)g(a)g
(just-freed)f(port.)g(This)i(brings)e(the)h(risk)g(of)g(a)h(garbage)d
(connection)g(do)n(wn)h(to)396 2297 y(perhaps)g(1/1000)g(b)n(ut)h(it')
-5 b(s)21 b(still)g(there.)f(Perhaps)g(the)g(best)g(solution)g(is)h(to)
f(accept)g(that)g(this)h(can)f(happen,)e(understand)396
2405 y(the)i(causes,)h(and)e(deal)h(with)h(it)g(on)e(the)i(application)
d(le)n(v)o(el.)-2 2589 y
SDict begin H.S end
 -2 2589 a -2 2589 a
SDict begin 13 H.A end
 -2 2589
a -2 2589 a
SDict begin [/View [/XYZ H.V]/Dest (0:5198) cvn /DEST pdfmark end
 -2 2589 a 396 2679 a Fj(W)-7 b(e)22 b(ha)n(v)o(e)d(a)i
(stateful)f(protocol)e(that)j(al)o(w)o(ays)f(starts)h(with)g(a)f(HELLO)
g(command.)e(W)-7 b(e)21 b(kno)n(w)f(that)g(it')-5 b(s)21
b(possible)f(for)396 2787 y(peers)g(to)h(connect)d(to)j(us,)f(thinking)
f(we')l(re)g(an)h(e)o(xisting)g(node)f(that)h(went)g(a)o(w)o(ay)g(and)g
(came)g(back,)f(and)h(send)g(us)g(other)396 2895 y(commands.)f(Step)h
(one)g(is)h(when)e(we)i(disco)o(v)o(er)d(a)j(ne)n(w)f(peer)m(,)f(to)h
(destro)o(y)g(an)o(y)f(e)o(xisting)h(peer)f(connected)f(to)j(the)f
(same)396 3003 y(endpoint.)e(It')-5 b(s)21 b(not)f(a)h(full)f(answer)g
(b)n(ut)g(it')-5 b(s)21 b(polite,)f(at)g(least.)h(Step)f(tw)o(o)h(is)g
(to)f(ignore)f(an)o(ything)f(coming)h(in)i(from)e(a)396
3111 y(ne)n(w)h(peer)g(until)g(that)g(peer)g(says)h(HELLO.)-2
3295 y
SDict begin H.S end
 -2 3295 a -2 3295 a
SDict begin 13 H.A end
 -2 3295 a -2 3295 a
SDict begin [/View [/XYZ H.V]/Dest (0:5199) cvn /DEST pdfmark end
 -2 3295
a 396 3385 a Fj(This)f(doesn')o(t)e(require)g(an)o(y)h(change)f(to)i
(the)f(protocol)f(b)n(ut)i(it)g(has)g(to)f(be)h(speci\002ed)f(in)h(the)
f(protocol)f(when)h(we)h(come)f(to)396 3493 y(it:)i(due)f(to)g(the)g(w)
o(ay)h(\330MQ)f(connections)e(w)o(ork,)i(it')-5 b(s)21
b(possible)f(to)g(recei)n(v)o(e)f(une)o(xpected)f(commands)g(from)i(a)
396 3601 y
SDict begin H.S end
 396 3601 a 396 3601 a
SDict begin 13 H.A end
 396 3601 a 396 3601
a
SDict begin [/View [/XYZ H.V]/Dest (0:5200) cvn /DEST pdfmark end
 396 3601 a Fi(well-behaving)e Fj(peer)i(and)g(there)f(is)j(no)d(w)o
(ay)i(to)f(return)f(an)h(error)f(code,)g(or)h(otherwise)g(tell)h(that)f
(peer)g(to)g(reset)g(its)396 3709 y(connection.)e(Thus,)i(a)g(peer)g
(must)g(discard)g(an)o(y)f(command)f(from)h(a)i(peer)f(until)g(it)h
(recei)n(v)o(es)e(HELLO.)-2 3893 y
SDict begin H.S end
 -2 3893 a -2 3893
a
SDict begin 13 H.A end
 -2 3893 a -2 3893 a
SDict begin [/View [/XYZ H.V]/Dest (0:5201) cvn /DEST pdfmark end
 -2 3893 a 396 3983 a Fj(In)h(f)o(act,)g(if)h(you)
e(dra)o(w)h(this)g(on)g(a)h(piece)f(of)g(paper)f(and)g(think)h(it)h
(through,)c(you')o(ll)j(see)g(that)h(you)e(ne)n(v)o(er)g(get)h(a)h
(HELLO)396 4091 y(from)e(such)h(a)h(connection.)d(The)i(peer)f(will)i
(send)f(PINGs)h(and)f(JOINs)g(and)g(LEA)-11 b(VEs)20
b(and)g(then)f(e)n(v)o(entually)g(time-out)396 4199 y(and)h(close,)g
(as)h(it)g(f)o(ails)g(to)f(get)g(an)o(y)g(heartbeats)f(back)h(from)f
(us.)-2 4383 y
SDict begin H.S end
 -2 4383 a -2 4383 a
SDict begin 13 H.A end
 -2 4383 a -2 4383
a
SDict begin [/View [/XYZ H.V]/Dest (0:5202) cvn /DEST pdfmark end
 -2 4383 a 396 4473 a Fj(Y)-9 b(ou')o(ll)20 b(also)g(see)h(that)f
(there')-5 b(s)20 b(no)g(risk)h(of)e(confusion,)f(no)i(w)o(ay)g(for)g
(commands)e(from)i(tw)o(o)g(peers)g(to)g(get)h(mix)o(ed)e(into)396
4581 y(a)i(single)f(stream)g(on)g(our)f(DEALER)h(sock)o(et.)-2
4765 y
SDict begin H.S end
 -2 4765 a -2 4765 a
SDict begin 13 H.A end
 -2 4765 a -2 4765 a
SDict begin [/View [/XYZ H.V]/Dest (0:5203) cvn /DEST pdfmark end
 -2 4765
a 396 4855 a Fj(When)g(you)g(are)g(satis\002ed)h(this)f(w)o(orks,)g
(we')l(re)f(ready)h(to)g(mo)o(v)o(e)f(on.)g(This)i(v)o(ersion)e(is)i
(tagged)e(in)h(the)g(repository)f(as)396 4962 y(v0.3.0)g(and)g(you)h
(can)1046 4962 y
SDict begin H.S end
 1046 4962 a 1046 4962 a
SDict begin 13 H.A end
 1046 4962 a
1046 4962 a
SDict begin [/View [/XYZ H.V]/Dest (0:5204) cvn /DEST pdfmark end
 1046 4962 a Fj(do)n(wnload)f(the)h(tarball)g
(\(https://github)m(.com/zeromq/zy)o(re/tag)o(s\))15
b(if)20 b(you)g(w)o(ant)g(to)g(check)g(what)396 5070
y(the)g(code)g(look)o(ed)f(lik)o(e)h(at)h(this)g(stage.)p
Black 3757 5569 a Fi(366)p Black eop end
%%Page: 367 381
TeXDict begin 367 380 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.367) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5205) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(Note)g(that)h(doing)e(hea)n(vy)g
(simulation)g(of)h(lots)h(of)f(nodes)f(will)i(probably)d(cause)i(your)f
(process)h(to)g(run)g(out)g(of)f(\002le)396 180 y(handles,)g(gi)n(ving)
g(an)h(assertion)g(f)o(ailure)g(in)g(libzmq.)f(I)i(raised)f(the)g(per)n
(-process)f(limit)h(to)h(30,000)d(by)i(running)e(\(on)h(my)396
288 y(Linux)g(box\):)-2 386 y
SDict begin H.S end
 -2 386 a -2 386 a
SDict begin 11.7 H.A end
 -2 386
a -2 386 a
SDict begin [/View [/XYZ H.V]/Dest (0:5206) cvn /DEST pdfmark end
 -2 386 a 396 468 a Fg(ulimit)44 b(-n)h(30000)-2
553 y
SDict begin H.S end
 -2 553 a -2 553 a
SDict begin 13 H.A end
 -2 553 a -2 553 a
SDict begin [/View [/XYZ H.V]/Dest (0:5207) cvn /DEST pdfmark end
 -2 553 a 396
880 a Fd(8.7.5.)36 b(T)-10 b(racing)34 b(Activity)1614
880 y
SDict begin H.S end
 1614 880 a 1614 880 a
SDict begin 18.72 H.A end
 1614 880 a 1614 880 a
SDict begin [/View [/XYZ H.V]/Dest (13.88.129.2) cvn /DEST pdfmark
end
 1614
880 a -2 1072 a
SDict begin H.S end
 -2 1072 a -2 1072 a
SDict begin 13 H.A end
 -2 1072 a -2 1072
a
SDict begin [/View [/XYZ H.V]/Dest (0:5209) cvn /DEST pdfmark end
 -2 1072 a 396 1154 a Fj(T)-7 b(o)21 b(deb)n(ug)e(the)h(kinds)f(of)h
(problems)f(we)i(sa)o(w)f(here,)g(we)g(need)g(e)o(xtensi)n(v)o(e)f
(logging.)f(There')-5 b(s)19 b(a)i(lot)g(happening)c(in)396
1262 y(parallel)j(b)n(ut)g(e)n(v)o(ery)f(problem)f(can)i(be)h(traced)e
(do)n(wn)g(to)i(a)f(speci\002c)h(e)o(xchange)d(between)h(tw)o(o)i
(nodes,)e(consisting)g(of)h(a)396 1369 y(set)h(of)f(e)n(v)o(ents)g
(that)g(happen)f(in)h(strict)h(sequence.)d(W)-7 b(e)22
b(kno)n(w)d(ho)n(w)h(to)g(mak)o(e)g(v)o(ery)f(sophisticated)g(logging)f
(b)n(ut)j(as)396 1477 y(usual)f(it')-5 b(s)22 b(wiser)e(to)g(mak)o(e)g
(just)h(what)f(we)h(need,)e(no)h(more.)f(W)-7 b(e)21
b(ha)n(v)o(e)f(to)g(capture:)-2 1495 y
SDict begin H.S end
 -2 1495 a -2 1495
a
SDict begin 13 H.A end
 -2 1495 a -2 1495 a
SDict begin [/View [/XYZ H.V]/Dest (0:5210) cvn /DEST pdfmark end
 -2 1495 a -2 1505 a
SDict begin H.S end
 -2 1505 a -2
1505 a
SDict begin 13 H.A end
 -2 1505 a -2 1505 a
SDict begin [/View [/XYZ H.V]/Dest (0:5211) cvn /DEST pdfmark end
 -2 1505 a Black 396 1648 a
Fe(\225)p Black 479 1648 a
SDict begin H.S end
 479 1648 a 479 1648 a
SDict begin 13 H.A end
 479
1648 a 479 1648 a
SDict begin [/View [/XYZ H.V]/Dest (0:5212) cvn /DEST pdfmark end
 479 1648 a Fj(T)m(ime)g(and)g(date)g(for)g(each)g(e)n
(v)o(ent.)-2 1649 y
SDict begin H.S end
 -2 1649 a -2 1649 a
SDict begin 13 H.A end
 -2 1649 a -2
1649 a
SDict begin [/View [/XYZ H.V]/Dest (0:5213) cvn /DEST pdfmark end
 -2 1649 a Black 396 1797 a Fe(\225)p Black 479
1797 a
SDict begin H.S end
 479 1797 a 479 1797 a
SDict begin 13 H.A end
 479 1797 a 479 1797 a
SDict begin [/View [/XYZ H.V]/Dest (0:5214) cvn /DEST pdfmark end
 479
1797 a Fj(In)g(which)g(node)f(the)h(e)n(v)o(ent)f(occurred.)-2
1798 y
SDict begin H.S end
 -2 1798 a -2 1798 a
SDict begin 13 H.A end
 -2 1798 a -2 1798 a
SDict begin [/View [/XYZ H.V]/Dest (0:5215) cvn /DEST pdfmark end
 -2 1798
a Black 396 1946 a Fe(\225)p Black 479 1946 a
SDict begin H.S end
 479 1946
a 479 1946 a
SDict begin 13 H.A end
 479 1946 a 479 1946 a
SDict begin [/View [/XYZ H.V]/Dest (0:5216) cvn /DEST pdfmark end
 479 1946 a Fj(The)h(peer)g(node,)f
(if)h(an)o(y)-5 b(.)-2 1964 y
SDict begin H.S end
 -2 1964 a -2 1964 a
SDict begin 13 H.A end
 -2
1964 a -2 1964 a
SDict begin [/View [/XYZ H.V]/Dest (0:5217) cvn /DEST pdfmark end
 -2 1964 a Black 396 2096 a Fe(\225)p
Black 479 2096 a
SDict begin H.S end
 479 2096 a 479 2096 a
SDict begin 13 H.A end
 479 2096 a 479
2096 a
SDict begin [/View [/XYZ H.V]/Dest (0:5218) cvn /DEST pdfmark end
 479 2096 a Fj(What)21 b(the)f(e)n(v)o(ent)f(w)o(as)i(\(e.g.)f
(which)f(command)f(arri)n(v)o(ed\).)-2 2114 y
SDict begin H.S end
 -2 2114
a -2 2114 a
SDict begin 13 H.A end
 -2 2114 a -2 2114 a
SDict begin [/View [/XYZ H.V]/Dest (0:5219) cvn /DEST pdfmark end
 -2 2114 a Black 396 2245
a Fe(\225)p Black 479 2245 a
SDict begin H.S end
 479 2245 a 479 2245 a
SDict begin 13 H.A end
 479
2245 a 479 2245 a
SDict begin [/View [/XYZ H.V]/Dest (0:5220) cvn /DEST pdfmark end
 479 2245 a Fj(Ev)o(ent)h(data,)h(if)h(an)o(y)-5
b(.)-2 2429 y
SDict begin H.S end
 -2 2429 a -2 2429 a
SDict begin 13 H.A end
 -2 2429 a -2 2429 a
SDict begin [/View [/XYZ H.V]/Dest (0:5221) cvn /DEST pdfmark end

-2 2429 a 396 2519 a Fj(The)19 b(v)o(ery)g(simplest)g(technique)f(is)j
(to)e(print)g(the)g(necessary)g(information)e(to)j(the)f(console,)f
(with)i(a)g(timestamp.)f(That')-5 b(s)396 2627 y(the)20
b(approach)f(I)h(used.)g(Then)f(it')-5 b(s)21 b(simple)f(to)h(\002nd)f
(the)g(nodes)f(af)n(fected)g(by)h(a)h(f)o(ailure,)e(\002lter)i(the)f
(log)g(\002le)h(for)e(only)396 2735 y(messages)i(referring)d(to)i
(them,)g(and)f(see)i(e)o(xactly)e(what)h(happened.)-2
2764 y
SDict begin H.S end
 -2 2764 a -2 2764 a
SDict begin 13 H.A end
 -2 2764 a -2 2764 a
SDict begin [/View [/XYZ H.V]/Dest (0:5222) cvn /DEST pdfmark end
 -2 2764
a 396 3074 a Fd(8.7.6.)36 b(Dealing)f(with)e(Bloc)n(ked)i(P)l(eer)n(s)
2281 3074 y
SDict begin H.S end
 2281 3074 a 2281 3074 a
SDict begin 18.72 H.A end
 2281 3074 a 2281
3074 a
SDict begin [/View [/XYZ H.V]/Dest (13.88.130.2) cvn /DEST pdfmark
end
 2281 3074 a -2 3266 a
SDict begin H.S end
 -2 3266 a -2 3266 a
SDict begin 13 H.A end
 -2 3266
a -2 3266 a
SDict begin [/View [/XYZ H.V]/Dest (0:5224) cvn /DEST pdfmark end
 -2 3266 a 396 3348 a Fj(In)20 b(an)o(y)g
(performance-sensiti)n(v)o(e)c(\330MQ)k(architecture)f(you)g(need)h(to)
g(solv)o(e)g(the)g(problem)e(of)i(\003o)n(w)h(control.)d(Y)-9
b(ou)396 3456 y(cannot)19 b(simply)h(send)g(unlimited)f(messages)h(to)h
(a)f(sock)o(et)g(and)g(hope)f(for)h(the)g(best.)g(At)h(the)f(one)g(e)o
(xtreme,)f(you)g(can)396 3563 y(e)o(xhaust)g(memory)-5
b(.)18 b(This)j(is)g(a)f(classic)h(f)o(ailure)f(pattern)f(for)h(a)h
(message)f(brok)o(er:)e(one)i(slo)n(w)g(client)h(stops)f(recei)n(ving)
396 3671 y(messages;)h(the)f(brok)o(er)e(starts)j(to)g(queue)e(them,)g
(and)h(e)n(v)o(entually)e(e)o(xhausts)i(memory)e(and)i(the)g(whole)g
(process)f(dies.)396 3779 y(At)i(the)f(other)g(e)o(xtreme,)e(the)i
(sock)o(et)h(drops)e(messages,)h(or)g(blocks,)f(as)i(you)e(hit)i(the)f
(high-w)o(ater)e(mark.)-2 3963 y
SDict begin H.S end
 -2 3963 a -2 3963 a
SDict begin 13 H.A end

-2 3963 a -2 3963 a
SDict begin [/View [/XYZ H.V]/Dest (0:5225) cvn /DEST pdfmark end
 -2 3963 a 396 4053 a Fj(W)m(ith)j(ZyRE)f(we)g(w)o
(ant)h(to)f(distrib)n(ute)g(messages)g(to)g(a)h(set)g(of)f(peers,)g
(and)f(we)i(w)o(ant)f(to)h(do)e(this)i(f)o(airly)-5 b(.)19
b(Using)h(a)h(single)396 4161 y(R)m(O)m(TER)g(sock)o(et)f(for)f(output)
g(w)o(ould)h(be)g(problematic)e(since)i(an)o(y)g(one)f(block)o(ed)g
(peer)h(w)o(ould)f(block)h(outgoing)e(traf)n(\002c)396
4269 y(to)j(all)f(peers.)g(TCP)h(does)f(ha)n(v)o(e)g(good)e(algorithms)
h(for)h(spreading)e(the)j(netw)o(ork)e(capacity)g(across)h(a)h(set)g
(of)396 4377 y(connections.)d(And)i(we')l(re)g(using)f(a)i(separate)f
(DEALER)g(sock)o(et)g(to)g(talk)h(to)f(each)g(peer)m(,)f(so)h(in)h
(theory)e(each)396 4485 y(DEALER)h(sock)o(et)h(will)f(send)g(its)i
(queued)c(messages)i(in)h(the)f(background)d(reasonably)h(f)o(airly)-5
b(.)-2 4669 y
SDict begin H.S end
 -2 4669 a -2 4669 a
SDict begin 13 H.A end
 -2 4669 a -2 4669 a
SDict begin [/View [/XYZ H.V]/Dest (0:5226) cvn /DEST pdfmark end

-2 4669 a 396 4759 a Fj(The)20 b(normal)f(beha)n(vior)g(of)h(a)g
(DEALER)g(sock)o(et)g(that)h(hits)f(its)i(high-w)o(ater)c(mark)i(is)h
(to)f(block.)f(This)h(is)i(usually)d(ideal,)396 4867
y(b)n(ut)h(it')-5 b(s)20 b(a)g(problem)e(for)h(us)h(here.)f(Our)g
(current)f(interf)o(ace)h(design)g(uses)h(one)f(thread)g(that)g
(distrib)n(utes)h(messages)f(to)h(all)396 4975 y(peers.)g(If)g(one)g
(of)g(those)g(send)f(calls)i(were)f(to)h(block,)e(all)i(output)e(w)o
(ould)g(block.)p Black 3756 5569 a Fi(367)p Black eop
end
%%Page: 368 382
TeXDict begin 368 381 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.368) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2
-11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5227) cvn /DEST pdfmark end
 -2 -11 a 396 72 a Fj(There)g(are)g(a)g(fe)n(w)g(options)
g(to)g(a)n(v)n(oid)g(blocking.)e(One)i(is)h(to)g(use)2270
72 y
SDict begin H.S end
 2270 72 a 2270 72 a
SDict begin 13 H.A end
 2270 72 a 2270 72 a
SDict begin [/View [/XYZ H.V]/Dest (0:5228) cvn /DEST pdfmark end
 2270 72
a Fg(zmq_poll\(\))e Fj(on)h(the)g(whole)g(set)h(of)f(DEALER)396
180 y(sock)o(ets,)g(and)g(only)f(write)i(to)f(sock)o(ets)g(that)h(are)f
(ready)-5 b(.)18 b(I)j(don')o(t)d(lik)o(e)j(this)f(for)g(a)h(couple)e
(of)h(reasons.)f(First,)i(the)396 288 y(DEALER)f(sock)o(et)h(is)g
(hidden)d(inside)i(the)h(peer)e(class,)i(and)f(it)h(is)g(cleaner)e(to)i
(allo)n(w)f(each)g(class)h(to)f(handle)f(this)396 396
y(opaquely)-5 b(.)18 b(Second,)h(what)h(do)g(we)g(do)g(with)g(messages)
h(we)f(can')o(t)f(yet)i(deli)n(v)o(er)e(to)h(a)h(DEALER)f(sock)o(et?)g
(Where)g(do)396 504 y(we)h(queue)e(them?)g(Third,)g(it)i(seems)g(to)f
(be)h(side-stepping)d(the)i(issue.)h(If)f(a)g(peer)g(is)h(really)f(so)h
(b)n(usy)e(it)i(can')o(t)f(read)f(its)396 612 y(messages,)h(something)f
(is)i(wrong.)e(Most)h(lik)o(ely)-5 b(,)20 b(it')-5 b(s)21
b(dead.)-2 796 y
SDict begin H.S end
 -2 796 a -2 796 a
SDict begin 13 H.A end
 -2 796 a -2 796 a
SDict begin [/View [/XYZ H.V]/Dest (0:5229) cvn /DEST pdfmark end

-2 796 a 396 886 a Fj(So)g(no)e(polling)h(for)f(output.)g(The)h(second)
f(option)g(is)i(to)f(use)h(one)e(thread)h(per)f(peer)-5
b(.)20 b(I)h(quite)e(lik)o(e)i(the)f(idea)g(of)g(this,)396
994 y(since)h(it)g(\002ts)g(into)f(the)g(\330MQ)g(design)g(pattern)f
(of)h("do)g(one)f(thing)h(in)g(one)g(thread".)f(But)h(this)h(is)g
(going)e(to)i(create)e(a)3750 994 y
SDict begin H.S end
 3750 994 a 3750 994
a
SDict begin 13 H.A end
 3750 994 a 3750 994 a
SDict begin [/View [/XYZ H.V]/Dest (0:5230) cvn /DEST pdfmark end
 3750 994 a Fi(lot)396 1102 y
Fj(of)h(threads)g(\(square)f(of)h(the)g(number)e(of)i(nodes)g(we)g
(start\))h(in)f(the)g(simulation,)f(and)h(we')l(re)f(already)h(running)
e(out)h(of)396 1210 y(\002le)i(handles.)-2 1377 y
SDict begin H.S end
 -2
1377 a -2 1377 a
SDict begin 13 H.A end
 -2 1377 a -2 1377 a
SDict begin [/View [/XYZ H.V]/Dest (0:5231) cvn /DEST pdfmark end
 -2 1377 a 396 1484
a Fj(A)g(third)f(option)f(is)i(to)f(use)g(a)h(non-blocking)c(send.)i
(This)i(is)g(nicer)e(and)h(it')-5 b(s)21 b(the)g(solution)e(I)h
(choose.)f(W)-7 b(e)22 b(can)e(then)396 1592 y(pro)o(vide)e(each)i
(peer)g(with)g(a)h(reasonable)e(outgoing)f(queue)h(\(the)g(HWM\))i(and)
f(if)g(that)g(gets)h(full,)f(treat)g(it)h(as)g(a)f(f)o(atal)396
1700 y(error)f(on)h(that)g(peer)-5 b(.)20 b(This)h(will)g(w)o(ork)e
(for)h(smaller)g(messages.)g(If)g(we')l(re)f(sending)h(lar)o(ge)f
(chunks)g(--)h(e.g.)f(for)h(\002le)396 1808 y(transfer)g(--)g(we')o(ll)
g(need)g(a)g(credit-based)f(\003o)n(w)h(control)f(on)h(top.)-2
1992 y
SDict begin H.S end
 -2 1992 a -2 1992 a
SDict begin 13 H.A end
 -2 1992 a -2 1992 a
SDict begin [/View [/XYZ H.V]/Dest (0:5232) cvn /DEST pdfmark end
 -2 1992
a 396 2082 a Fj(First)h(step)g(therefore)d(is)j(to)g(pro)o(v)o(e)d(to)i
(ourselv)o(es)f(that)i(we)f(can)g(turn)g(the)g(normal)f(blocking)f
(DEALER)i(sock)o(et)g(into)g(a)396 2190 y(non-blocking)d(sock)o(et.)j
(This)g(e)o(xample)f(creates)h(a)h(normal)e(DEALER)h(sock)o(et,)g
(connects)f(it)i(to)f(some)g(endpoint)e(\(so)396 2297
y(there')-5 b(s)20 b(an)g(outgoing)e(pipe)i(and)g(the)g(sock)o(et)g
(will)h(accept)f(messages\),)g(sets)h(the)f(high-w)o(ater)f(mark)g(to)h
(four)m(,)f(and)g(then)396 2405 y(sets)j(the)e(send)g(timeout)f(to)i
(zero:)-2 2406 y
SDict begin H.S end
 -2 2406 a -2 2406 a
SDict begin 13 H.A end
 -2 2406 a -2 2406
a
SDict begin [/View [/XYZ H.V]/Dest (0:eagain-php) cvn /DEST pdfmark
end
 -2 2406 a 396 2607 a Fk(Example)g(8-5.)e(Checking)h(EA)-5
b(GAIN)22 b(on)e(DEALER)i(sock)o(et)e(\(eagain.php\))-2
2707 y
SDict begin H.S end
 -2 2707 a -2 2707 a
SDict begin 11.7 H.A end
 -2 2707 a -2 2707 a
SDict begin [/View [/XYZ H.V]/Dest (0:5235) cvn /DEST pdfmark end
 -2 2707
a 396 2787 a Fg(\(This)44 b(example)g(still)g(needs)g(translation)f
(into)h(PHP\))-2 2964 y
SDict begin H.S end
 -2 2964 a -2 2964 a
SDict begin 13 H.A end
 -2 2964 a
-2 2964 a
SDict begin [/View [/XYZ H.V]/Dest (0:5236) cvn /DEST pdfmark end
 -2 2964 a 396 3061 a Fj(When)20 b(we)h(run)e(this,)i(we)f
(send)g(four)f(messages)i(successfully)e(\(the)o(y)g(go)h(no)n(where,)e
(the)j(sock)o(et)f(just)g(queues)g(them\),)396 3169 y(and)g(then)g(we)g
(get)g(a)h(nice)f(EA)m(GAIN)g(error:)-2 3270 y
SDict begin H.S end
 -2 3270
a -2 3270 a
SDict begin 11.7 H.A end
 -2 3270 a -2 3270 a
SDict begin [/View [/XYZ H.V]/Dest (0:5237) cvn /DEST pdfmark end
 -2 3270 a 396 3349 a
Fg(Sending)44 b(message)g(0)396 3446 y(Sending)g(message)g(1)396
3543 y(Sending)g(message)g(2)396 3640 y(Sending)g(message)g(3)396
3737 y(Sending)g(message)g(4)396 3835 y(Resource)g(temporarily)f
(unavailable)-2 4012 y
SDict begin H.S end
 -2 4012 a -2 4012 a
SDict begin 13 H.A end
 -2 4012 a
-2 4012 a
SDict begin [/View [/XYZ H.V]/Dest (0:5238) cvn /DEST pdfmark end
 -2 4012 a 396 4109 a Fj(Ne)o(xt)20 b(step)h(is)g(to)f(decide)
g(what)g(a)g(reasonable)f(high)g(w)o(ater)i(mark)e(w)o(ould)h(be)g(for)
f(a)i(peer)-5 b(.)20 b(ZyRE)g(is)h(meant)f(for)f(human)396
4217 y(interactions,)g(that)h(is)i(applications)d(which)g(chat)h(at)h
(a)g(lo)n(w)f(frequenc)o(y)-5 b(.)17 b(Perhaps)i(tw)o(o)i(games,)e(or)h
(a)g(shared)g(dra)o(wing)396 4324 y(program.)e(I')l(d)h(e)o(xpect)h(a)g
(hundred)e(messages)i(per)g(second)f(to)i(be)f(quite)g(a)g(lot.)h(Our)e
("peer)h(is)h(really)f(dead")f(timeout)h(is)396 4432
y(10)g(seconds.)f(So)i(a)f(high-w)o(ater)f(mark)g(of)h(1,000)f(seems)i
(f)o(air)-5 b(.)-2 4616 y
SDict begin H.S end
 -2 4616 a -2 4616 a
SDict begin 13 H.A end
 -2 4616
a -2 4616 a
SDict begin [/View [/XYZ H.V]/Dest (0:5239) cvn /DEST pdfmark end
 -2 4616 a 396 4706 a Fj(Rather)20 b(than)g(set)h(a)g(\002x)
o(ed)e(HWM,)i(or)f(use)g(the)g(def)o(ault)g(\(which)f(randomly)f(also)j
(happens)d(to)j(be)f(1,000\))e(we)j(calculate)396 4814
y(it)g(as)g(100)e(*)i(the)f(timeout.)f(Here')-5 b(s)21
b(ho)n(w)e(we)i(con\002gure)d(a)j(ne)n(w)f(DEALER)g(sock)o(et)g(for)f
(a)i(peer:)-2 4915 y
SDict begin H.S end
 -2 4915 a -2 4915 a
SDict begin 11.7 H.A end
 -2 4915 a -2
4915 a
SDict begin [/View [/XYZ H.V]/Dest (0:5240) cvn /DEST pdfmark end
 -2 4915 a 396 4994 a Fg(//)90 b(Create)43 b(new)i(outgoing)e
(socket)h(\(drop)g(any)g(messages)g(in)g(transit\))396
5092 y(self->mailbox)f(=)i(zsocket_new)e(\(self->ctx,)g(ZMQ_DEALER\);)p
Black 3759 5569 a Fi(368)p Black eop end
%%Page: 369 383
TeXDict begin 369 382 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.369) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 396 170 a Fg(//)90 b(Set)44 b(our)g(caller)g
('From')g(identity)f(so)i(that)f(receiving)f(node)i(knows)396
267 y(//)90 b(who)44 b(each)g(message)g(came)g(from.)396
364 y(zsocket_set_identity)e(\(self->mailbox,)g(reply_to\);)396
558 y(//)90 b(Set)44 b(a)h(high-water)e(mark)h(that)g(allows)g(for)g
(reasonable)f(activity)396 655 y(zsocket_set_sndhwm)f(\(self->mailbox,)
g(PEER_EXPIRED)2548 668 y(*)2638 655 y(100\);)396 850
y(//)90 b(Send)44 b(messages)f(immediately)g(or)i(return)f(EAGAIN)396
947 y(zsocket_set_sndtimeo)e(\(self->mailbox,)g(0\);)396
1141 y(//)90 b(Connect)43 b(through)h(to)g(peer)h(node)396
1238 y(zsocket_connect)e(\(self->mailbox,)f("tcp://\045s",)h
(endpoint\);)-2 1416 y
SDict begin H.S end
 -2 1416 a -2 1416 a
SDict begin 13 H.A end
 -2 1416 a
-2 1416 a
SDict begin [/View [/XYZ H.V]/Dest (0:5241) cvn /DEST pdfmark end
 -2 1416 a 396 1512 a Fj(And)20 b(\002nally)-5
b(,)19 b(what)h(do)g(we)h(do)f(when)f(we)i(get)f(an)g(EA)m(GAIN)g(on)f
(a)i(peer?)f(W)-7 b(e)21 b(don')o(t)d(need)i(to)g(go)g(through)e(all)j
(the)396 1620 y(w)o(ork)f(of)g(destro)o(ying)e(the)i(peer)g(since)g
(the)h(interf)o(ace)e(will)i(do)f(this)g(automatically)f(if)i(it)f
(doesn')o(t)f(get)h(an)o(y)g(message)396 1728 y(from)f(the)h(peer)f
(within)h(the)f(e)o(xpiry)g(timeout.)f(Just)j(dropping)c(the)j(last)h
(message)e(seems)i(v)o(ery)d(weak)i(-)g(it)g(will)h(gi)n(v)o(e)e(the)
396 1836 y(recei)n(ving)g(peer)h(gaps.)-2 2020 y
SDict begin H.S end
 -2 2020
a -2 2020 a
SDict begin 13 H.A end
 -2 2020 a -2 2020 a
SDict begin [/View [/XYZ H.V]/Dest (0:5242) cvn /DEST pdfmark end
 -2 2020 a 396 2110 a
Fj(I')l(d)g(rather)f(a)i(more)e(brutal)g(response.)g(Brutal)i(is)g
(good)e(because)g(it)i(forces)f(the)g(design)f(to)i(a)f("good")f(or)h
("bad")396 2218 y(decision)g(rather)f(than)h(a)g(fuzzy)g("should)f(w)o
(ork)g(b)n(ut)h(to)h(be)f(honest)f(there)h(are)g(a)h(lot)f(of)g(edge)g
(cases)h(so)f(let')-5 b(s)21 b(w)o(orry)396 2326 y(about)e(it)i
(later".)f(Destro)o(y)g(the)g(sock)o(et,)g(disconnect)f(the)h(peer)m(,)
f(and)h(stop)g(sending)f(an)o(ything)f(to)i(it.)h(The)f(peer)g(will)396
2434 y(e)n(v)o(entually)f(ha)n(v)o(e)g(to)i(reconnect)d(and)i
(re-initialize)f(an)o(y)g(state.)i(It')-5 b(s)21 b(kind)e(of)h(an)g
(assertion)g(that)h(100)e(messages)h(a)396 2542 y(second)g(is)h(enough)
d(for)h(an)o(yone.)f(So,)j(in)f(the)g(zre_peer_send)d(method:)-2
2643 y
SDict begin H.S end
 -2 2643 a -2 2643 a
SDict begin 11.7 H.A end
 -2 2643 a -2 2643 a
SDict begin [/View [/XYZ H.V]/Dest (0:5243) cvn /DEST pdfmark end
 -2 2643
a 396 2722 a Fg(int)396 2819 y(zre_peer_send)43 b(\(zre_peer_t)1562
2832 y(*)1607 2819 y(self,)h(zre_msg_t)2324 2832 y(**)2414
2819 y(msg_p\))396 2916 y({)576 3013 y(assert)f(\(self\);)576
3110 y(if)h(\(self->connected\))e({)755 3207 y(if)i(\(zre_msg_send)f
(\(msg_p,)h(self->mailbox\))e(&&)j(errno)f(==)g(EAGAIN\))g({)934
3305 y(zre_peer_disconnect)e(\(self\);)934 3402 y(return)i(-1;)755
3499 y(})576 3596 y(})576 3693 y(return)f(0;)396 3790
y(})-2 3964 y
SDict begin H.S end
 -2 3964 a -2 3964 a
SDict begin 13 H.A end
 -2 3964 a -2 3964 a
SDict begin [/View [/XYZ H.V]/Dest (0:5244) cvn /DEST pdfmark end

-2 3964 a 396 4064 a Fj(Where)20 b(the)g(disconnect)f(method)g(looks)h
(lik)o(e)g(this:)-2 4148 y
SDict begin H.S end
 -2 4148 a -2 4148 a
SDict begin 11.7 H.A end
 -2 4148
a -2 4148 a
SDict begin [/View [/XYZ H.V]/Dest (0:5245) cvn /DEST pdfmark end
 -2 4148 a 396 4244 a Fg(void)396 4341 y
(zre_peer_disconnect)42 b(\(zre_peer_t)1831 4354 y(*)1876
4341 y(self\))396 4439 y({)576 4536 y(//)89 b(If)44 b(connected,)g
(destroy)f(socket)h(and)g(drop)h(all)f(pending)g(messages)576
4633 y(assert)f(\(self\);)576 4730 y(if)h(\(self->connected\))e({)755
4827 y(zsocket_destroy)g(\(self->ctx,)h(self->mailbox\);)755
4924 y(free)h(\(self->endpoint\);)755 5021 y(self->endpoint)e(=)j
(NULL;)755 5119 y(self->connected)d(=)j(false;)p Black
3759 5569 a Fi(369)p Black eop end
%%Page: 370 384
TeXDict begin 370 383 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.370) cvn /DEST pdfmark end
 -611 -810 a Black
Black 2541 -132 a Fi(Chapter)19 b(8.)h(A)h(Univer)o(se)g(of)f(Mo)o
(ving)g(Pieces)p Black 576 72 a Fg(})396 170 y(})-2 344
y
SDict begin H.S end
 -2 344 a -2 344 a
SDict begin 13 H.A end
 -2 344 a -2 344 a
SDict begin [/View [/XYZ H.V]/Dest (0:5246) cvn /DEST pdfmark end
 -2 344 a 369 x
Fh(8.8.)39 b(More)g(Coming)e(Soon)1593 713 y
SDict begin H.S end
 1593 713
a 1593 713 a
SDict begin 22.464 H.A end
 1593 713 a 1593 713 a
SDict begin [/View [/XYZ H.V]/Dest (13.89.1) cvn /DEST pdfmark end
 1593 713 a -2 911
a
SDict begin H.S end
 -2 911 a -2 911 a
SDict begin 13 H.A end
 -2 911 a -2 911 a
SDict begin [/View [/XYZ H.V]/Dest (0:5248) cvn /DEST pdfmark end
 -2 911 a 396 987
a Fj(In)20 b(the)g(rest)h(of)f(this)h(chapter)e(we')o(ll)h(de)n(v)o
(elop)f(a)h(distrib)n(uted)f(logging)g(service)h(as)h(a)f(ZyRE)g
(application,)f(and)g(we')o(ll)396 1095 y(complete)g(the)i(rest)f(of)g
(the)g(ZyRE)g(frame)n(w)o(ork:)f(\002le)h(transfer)m(,)f(security)-5
b(,)19 b(state)i(synchronization.)p Black 3759 5569 a
Fi(370)p Black eop end
%%Page: 371 385
TeXDict begin 371 384 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.371) cvn /DEST pdfmark end
 -611 -810 a Black
Black Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11
a
SDict begin [/View [/XYZ H.V]/Dest (0:postface) cvn /DEST pdfmark end
 -2 -11 a 126 x Fl(Chapter)48 b(9.)f(P)-7 b(ostface)1598
115 y
SDict begin H.S end
 1598 115 a 1598 115 a
SDict begin 26.957 H.A end
 1598 115 a 1598 115 a
SDict begin [/View [/XYZ H.V]/Dest (14.0) cvn /DEST pdfmark end
 1598
115 a -2 204 a
SDict begin H.S end
 -2 204 a -2 204 a
SDict begin 13 H.A end
 -2 204 a -2 204 a
SDict begin [/View [/XYZ H.V]/Dest (0:5251) cvn /DEST pdfmark end
 -2
204 a 342 x Fh(9.1.)39 b(T)-11 b(ales)38 b(fr)m(om)h(Out)g(There)1707
546 y
SDict begin H.S end
 1707 546 a 1707 546 a
SDict begin 22.464 H.A end
 1707 546 a 1707 546 a
SDict begin [/View [/XYZ H.V]/Dest (14.90.1) cvn /DEST pdfmark end
 1707
546 a -2 714 a
SDict begin H.S end
 -2 714 a -2 714 a
SDict begin 13 H.A end
 -2 714 a -2 714 a
SDict begin [/View [/XYZ H.V]/Dest (0:5253) cvn /DEST pdfmark end
 -2
714 a 396 820 a Fj(I)21 b(ask)o(ed)f(some)g(of)g(the)g(contrib)n(utors)
e(to)i(the)h(Guide)e(to)i(tell)g(us)f(what)g(the)o(y)g(were)g(doing)f
(with)h(\330MQ.)g(Here)g(are)g(their)396 928 y(stories.)-2
929 y
SDict begin H.S end
 -2 929 a -2 929 a
SDict begin 13 H.A end
 -2 929 a -2 929 a
SDict begin [/View [/XYZ H.V]/Dest (0:5254) cvn /DEST pdfmark end
 -2 929 a 396
1256 a Fd(9.1.1.)36 b(Rob)d(Ga)o(gnon')-7 b(s)34 b(Stor)q(y)1877
1256 y
SDict begin H.S end
 1877 1256 a 1877 1256 a
SDict begin 18.72 H.A end
 1877 1256 a 1877 1256
a
SDict begin [/View [/XYZ H.V]/Dest (14.90.131.2) cvn /DEST pdfmark
end
 1877 1256 a -2 1449 a
SDict begin H.S end
 -2 1449 a -2 1449 a
SDict begin 13 H.A end
 -2 1449 a
-2 1449 a
SDict begin [/View [/XYZ H.V]/Dest (0:5256) cvn /DEST pdfmark end
 -2 1449 a 396 1530 a Fj("W)-7 b(e)21 b(use)g(\330MQ)f(to)h
(assist)g(in)g(aggre)o(gating)c(thousands)i(of)g(e)n(v)o(ents)h
(occurring)e(e)n(v)o(ery)h(minute)g(across)h(our)g(global)396
1638 y(netw)o(ork)f(of)h(telecommunications)e(serv)o(ers)h(so)i(that)f
(we)h(can)f(accurately)f(report)g(and)g(monitor)g(for)g(situations)i
(that)396 1746 y(require)e(our)h(attention.)f(\330MQ)h(made)g(the)g(de)
n(v)o(elopment)d(of)j(the)g(system)h(not)f(only)f(easier)m(,)h(b)n(ut)g
(f)o(aster)g(to)h(de)n(v)o(elop,)396 1854 y(and)f(more)f(rob)n(ust)h
(and)g(f)o(ault-tolerant)e(than)i(we)g(had)g(originally)e(planned)h(in)
h(our)g(original)f(design.)-2 2038 y
SDict begin H.S end
 -2 2038 a -2 2038
a
SDict begin 13 H.A end
 -2 2038 a -2 2038 a
SDict begin [/View [/XYZ H.V]/Dest (0:5257) cvn /DEST pdfmark end
 -2 2038 a 396 2128 a Fj("W)-7 b(e')l(re)20
b(able)h(to)f(easily)g(add)g(and)g(remo)o(v)o(e)e(clients)i(from)g(the)
g(netw)o(ork)f(without)g(the)h(loss)h(of)f(an)o(y)g(message.)f(If)h(we)
396 2236 y(need)g(to)g(enhance)f(the)h(serv)o(er)f(portion)g(of)h(our)f
(system,)h(we)h(can)f(stop)g(and)g(restart)g(it)h(as)g(well,)f(without)
g(ha)n(ving)f(to)396 2344 y(w)o(orry)g(about)h(stopping)e(all)j(of)f
(the)g(clients)h(\002rst.)g(The)e(b)n(uilt-in)h(b)n(uf)n(fering)e(of)i
(\330MQ)g(mak)o(es)g(this)h(all)g(possible.")-2 2372
y
SDict begin H.S end
 -2 2372 a -2 2372 a
SDict begin 13 H.A end
 -2 2372 a -2 2372 a
SDict begin [/View [/XYZ H.V]/Dest (0:5258) cvn /DEST pdfmark end
 -2 2372 a 396
2682 a Fd(9.1.2.)36 b(T)-10 b(om)34 b(v)n(an)f(Leeuwen')-7
b(s)36 b(Stor)q(y)2186 2682 y
SDict begin H.S end
 2186 2682 a 2186 2682 a
SDict begin 18.72 H.A end

2186 2682 a 2186 2682 a
SDict begin [/View [/XYZ H.V]/Dest (14.90.132.2) cvn /DEST pdfmark
end
 2186 2682 a -2 2873 a
SDict begin H.S end
 -2 2873
a -2 2873 a
SDict begin 13 H.A end
 -2 2873 a -2 2873 a
SDict begin [/View [/XYZ H.V]/Dest (0:5260) cvn /DEST pdfmark end
 -2 2873 a 396 2956 a
Fj("I)21 b(w)o(as)g(looking)d(for)i(creating)f(some)h(kind)f(of)h
(service)g(b)n(us)g(connecting)e(all)j(kinds)f(of)g(services)g
(together)-5 b(.)19 b(There)396 3064 y(were)h(already)f(some)h
(products)f(that)h(implemented)f(a)h(brok)o(er)m(,)e(b)n(ut)j(the)o(y)e
(did)h(not)g(ha)n(v)o(e)f(the)i(functionality)d(I)396
3172 y(w)o(anted/needed.)g(By)i(accident)f(I)h(stumbled)f(upon)f
(\330MQ)i(which)f(is)i(a)o(wesome.)e(It')-5 b(s)20 b(v)o(ery)f
(lightweight,)f(lean,)i(simple)396 3280 y(and)g(easy)g(to)h(follo)n(w)e
(since)h(the)h(zguide)e(is)i(v)o(ery)e(complete)g(and)h(reads)f(v)o
(ery)h(well.)g(I')l(v)o(e)f(actually)h(implemented)e(the)396
3388 y(T)m(itanic)i(pattern)f(and)g(the)g(Majordomo)f(brok)o(er)g(with)
i(some)f(additions)g(\(client/w)o(ork)o(er)f(authentication)f(and)i(w)o
(ork)o(ers)396 3496 y(sending)g(a)i(catalog)e(e)o(xplaining)f(what)j
(the)o(y)e(pro)o(vide)f(and)i(ho)n(w)g(the)o(y)f(should)g(be)h
(addressed\).)-2 3680 y
SDict begin H.S end
 -2 3680 a -2 3680 a
SDict begin 13 H.A end
 -2 3680 a
-2 3680 a
SDict begin [/View [/XYZ H.V]/Dest (0:5261) cvn /DEST pdfmark end
 -2 3680 a 396 3770 a Fj("The)g(beautiful)f(thing)g(about)h
(\330MQ)g(is)h(the)f(f)o(act)h(that)f(it)h(is)g(a)g(library)e(and)g
(not)h(an)g(application.)f(Y)-9 b(ou)19 b(can)h(mold)g(it)396
3878 y(ho)n(we)n(v)o(er)e(you)i(lik)o(e)g(and)g(it)h(simply)f(puts)g
(boring)e(things)i(lik)o(e)g(queuing,)e(reconnecting,)g(tcp)i(sock)o
(ets)g(and)g(such)g(to)g(the)396 3985 y(background,)d(making)i(sure)h
(you)f(can)h(concentrate)e(on)i(what)g(is)h(important)e(for)h(you.)f
(I')l(v)o(e)g(implemented)f(all)j(kinds)396 4093 y(of)f(w)o(ork)o
(ers/clients)f(and)h(the)g(brok)o(er)e(in)i(Ruby)-5 b(,)19
b(because)h(that)g(is)h(the)f(main)f(language)g(we)h(use)g(for)g(de)n
(v)o(elopment,)d(b)n(ut)396 4201 y(also)k(some)f(php)f(clients)i(to)f
(connect)f(to)h(the)g(b)n(us)h(from)e(e)o(xisting)g(php)h(webapps.)f(W)
-7 b(e)21 b(use)f(this)h(service)f(b)n(us)h(for)e(cloud)396
4309 y(services)h(connecting)e(all)j(kinds)f(of)g(platform)f(de)n
(vices)g(to)i(a)f(service)g(b)n(us)g(e)o(xposing)f(functionality)f(for)
h(automation.)-2 4493 y
SDict begin H.S end
 -2 4493 a -2 4493 a
SDict begin 13 H.A end
 -2 4493 a
-2 4493 a
SDict begin [/View [/XYZ H.V]/Dest (0:5262) cvn /DEST pdfmark end
 -2 4493 a 396 4583 a Fj("\330MQ)i(is)g(v)o(ery)e(easy)h(to)g
(understand)e(and)i(if)h(you)e(spend)g(a)i(day)f(in)g(the)g(zguide,)f
(you')o(ll)g(ha)n(v)o(e)h(good)f(kno)n(wledge)f(of)396
4691 y(ho)n(w)i(it)h(w)o(orks.)e(I'm)h(a)h(netw)o(ork)e(engineer)m(,)f
(not)i(a)g(softw)o(are)g(de)n(v)o(eloper)m(,)d(b)n(ut)j(managed)f(to)h
(create)g(a)h(v)o(ery)e(nice)396 4799 y(solution)h(for)f(our)h
(automation)e(needs!)h(\330MQ:)i(Thank)e(you)g(v)o(ery)g(much!")-2
4827 y
SDict begin H.S end
 -2 4827 a -2 4827 a
SDict begin 13 H.A end
 -2 4827 a -2 4827 a
SDict begin [/View [/XYZ H.V]/Dest (0:5263) cvn /DEST pdfmark end
 -2 4827
a Black 3759 5569 a Fi(371)p Black eop end
%%Page: 372 386
TeXDict begin 372 385 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.372) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3228 -132 a Fi(Chapter)20 b(9.)g(P)-7 b(ostface)p
Black 396 77 a Fd(9.1.3.)36 b(Mic)o(hael)e(Jakl')-7 b(s)36
b(Stor)q(y)1865 77 y
SDict begin H.S end
 1865 77 a 1865 77 a
SDict begin 18.72 H.A end
 1865 77 a 1865
77 a
SDict begin [/View [/XYZ H.V]/Dest (14.90.133.2) cvn /DEST pdfmark
end
 1865 77 a -2 267 a
SDict begin H.S end
 -2 267 a -2 267 a
SDict begin 13 H.A end
 -2 267 a -2
267 a
SDict begin [/View [/XYZ H.V]/Dest (0:5265) cvn /DEST pdfmark end
 -2 267 a 396 351 a Fj("W)-7 b(e)21 b(use)g(\330MQ)f(for)g
(distrib)n(uting)f(millions)h(of)g(documents)e(per)i(day)g(in)g(our)f
(distrib)n(uted)h(processing)f(pipeline.)g(W)-7 b(e)396
459 y(started)20 b(out)g(with)h(big)e(message)h(queuing)f(brok)o(ers)g
(that)h(had)g(their)f(o)n(wn)h(respecti)n(v)o(e)f(issues)i(and)f
(problems.)e(In)i(the)396 566 y(quest)g(of)g(simplifying)f(our)g
(architecture,)g(we)h(chose)g(\330MQ)g(to)h(do)f(the)g(wiring.)f(So)h
(f)o(ar)h(it)f(had)g(a)h(huge)e(impact)h(in)396 674 y(ho)n(w)g(our)f
(architecture)g(scales)i(and)f(ho)n(w)f(easy)i(it)f(is)i(to)e
(change/mo)o(v)o(e)d(the)j(components.)e(The)i(plethora)e(of)i
(language)396 782 y(bindings)f(lets)i(us)g(choose)e(the)h(right)g(tool)
g(for)f(the)h(job)g(without)g(sacri\002cing)f(interoperability)f(in)i
(our)g(system.)g(W)-7 b(e)396 890 y(don')o(t)19 b(use)h(a)h(lot)f(of)g
(sock)o(ets)g(\(less)h(than)f(10)g(in)g(our)g(whole)f(application\),)f
(b)n(ut)j(that')-5 b(s)20 b(all)h(we)g(needed)e(to)h(split)h(a)f(huge)
396 998 y(monolithic)f(application)g(into)g(small)i(independent)d
(parts.)-2 1182 y
SDict begin H.S end
 -2 1182 a -2 1182 a
SDict begin 13 H.A end
 -2 1182 a -2 1182
a
SDict begin [/View [/XYZ H.V]/Dest (0:5266) cvn /DEST pdfmark end
 -2 1182 a 396 1272 a Fj("All)j(in)f(all,)h(\330MQ)f(lets)h(me)g(k)o
(eep)e(my)h(sanity)g(and)g(helps)g(my)g(customers)f(to)h(stay)h(within)
f(b)n(udget.")-2 1301 y
SDict begin H.S end
 -2 1301 a -2 1301 a
SDict begin 13 H.A end
 -2 1301 a
-2 1301 a
SDict begin [/View [/XYZ H.V]/Dest (0:5267) cvn /DEST pdfmark end
 -2 1301 a 396 1611 a Fd(9.1.4.)36 b(V)-7 b(adim)33
b(Shalts')-7 b(s)35 b(Stor)q(y)1905 1611 y
SDict begin H.S end
 1905 1611
a 1905 1611 a
SDict begin 18.72 H.A end
 1905 1611 a 1905 1611 a
SDict begin [/View [/XYZ H.V]/Dest (14.90.134.2) cvn /DEST pdfmark
end
 1905 1611 a -2
1801 a
SDict begin H.S end
 -2 1801 a -2 1801 a
SDict begin 13 H.A end
 -2 1801 a -2 1801 a
SDict begin [/View [/XYZ H.V]/Dest (0:5269) cvn /DEST pdfmark end
 -2 1801
a 396 1885 a Fj("I)21 b(am)f(team)g(leader)f(in)i(the)f(compan)o(y)e
(ActF)o(ore)o(x,)g(which)i(de)n(v)o(elops)f(softw)o(are)g(for)h
(\002nancial)g(mark)o(ets.)f(Due)h(to)h(the)396 1993
y(nature)e(of)h(our)g(domain,)e(we)j(need)e(to)i(process)f(lar)o(ge)f
(v)n(olumes)g(of)h(prices)g(quickly)-5 b(.)18 b(In)i(addition,)f(it')-5
b(s)21 b(e)o(xtremely)396 2100 y(critical)g(to)f(minimize)f(latenc)o(y)
h(in)g(processing)f(orders)g(and)h(prices.)f(Achie)n(v)o(e)g(a)i(high)e
(throughput)f(is)j(not)f(enough.)396 2208 y(Ev)o(erything)e(must)i(be)g
(handled)f(in)h(a)h(soft)f(real-time)f(with)i(a)f(predictable)f(ultra)h
(lo)n(w)g(latenc)o(y)f(per)h(price.)g(The)g(system)396
2316 y(consists)h(of)f(multiple)f(components)f(which)i(e)o(xchanging)d
(messages.)j(Each)g(price)g(can)g(tak)o(e)g(a)h(lot)f(of)g(processing)
396 2424 y(stages,)h(each)f(of)f(which)h(increases)g(total)g(latenc)o
(y)-5 b(.)19 b(As)i(a)g(consequence,)c(lo)n(w)k(and)e(predictable)g
(latenc)o(y)g(of)396 2532 y(messaging)h(between)f(components)f(becomes)
h(a)i(k)o(e)o(y)e(f)o(actor)h(of)g(our)f(architecture.)-2
2716 y
SDict begin H.S end
 -2 2716 a -2 2716 a
SDict begin 13 H.A end
 -2 2716 a -2 2716 a
SDict begin [/View [/XYZ H.V]/Dest (0:5270) cvn /DEST pdfmark end
 -2 2716
a 396 2806 a Fj("W)-7 b(e)21 b(in)m(v)o(estigated)e(dif)n(ferent)f
(solutions)i(to)g(\002nd)g(suitable)g(for)g(our)f(needs.)g(W)-7
b(e)22 b(tried)e(dif)n(ferent)e(message)i(brok)o(ers)396
2914 y(\(RabbitMQ,)g(Acti)n(v)o(eMQ)f(Apollo,)g(Kafka\),)g(b)n(ut)h(f)o
(ailed)g(to)h(reach)e(a)i(lo)n(w)f(and)g(predictable)e(latenc)o(y)i
(with)g(an)o(y)f(of)396 3022 y(them.)h(In)g(the)g(end,)f(we)i(ha)n(v)o
(e)e(chosen)h(ZeroMQ)f(used)h(in)g(conjunction)e(with)i(ZooK)n(eeper)f
(for)g(service)h(disco)o(v)o(ery)-5 b(.)396 3130 y(Comple)o(x)19
b(coordination)f(with)i(ZeroMQ)f(requires)g(a)i(relati)n(v)o(ely)e(lar)
o(ge)g(ef)n(fort)g(and)h(a)h(good)d(understanding,)f(as)k(a)396
3238 y(result)f(of)g(the)g(natural)g(comple)o(xity)e(of)h
(multi-threading.)e(W)-7 b(e)22 b(found)c(that)i(e)o(xternal)f(agent)h
(lik)o(e)g(ZooK)n(eeper)e(is)j(better)396 3346 y(choice)f(for)f
(service)h(disco)o(v)o(ery)e(and)i(coordination)d(while)j(ZeroMQ)g(can)
g(be)g(used)g(primary)e(for)i(simple)g(messaging.)396
3454 y(ZeroMQ)g(perfectly)e(\002t)j(into)f(our)g(architecture.)e(It)j
(allo)n(wed)e(us)i(to)f(achie)n(v)o(e)f(the)h(desired)g(latenc)o(y)f
(using)h(minimal)396 3562 y(ef)n(forts.)f(It)i(sa)n(v)o(ed)e(us)i(from)
e(a)h(bottleneck)f(in)h(the)g(processing)f(of)h(messages)g(and)f(made)h
(processing)e(time)j(v)o(ery)e(stable)396 3670 y(and)h(predictable.)-2
3854 y
SDict begin H.S end
 -2 3854 a -2 3854 a
SDict begin 13 H.A end
 -2 3854 a -2 3854 a
SDict begin [/View [/XYZ H.V]/Dest (0:5271) cvn /DEST pdfmark end
 -2 3854
a 396 3944 a Fj("I)h(can)f(decidedly)e(recommend)g(ZeroMQ)h(for)h
(solutions)f(where)h(lo)n(w)g(latenc)o(y)f(is)i(important.")-2
4055 y
SDict begin H.S end
 -2 4055 a -2 4055 a
SDict begin 13 H.A end
 -2 4055 a -2 4055 a
SDict begin [/View [/XYZ H.V]/Dest (0:5272) cvn /DEST pdfmark end
 -2 4055
a 359 x Fh(9.2.)39 b(Ho)n(w)g(the)g(Guide)f(Happened)2015
4414 y
SDict begin H.S end
 2015 4414 a 2015 4414 a
SDict begin 22.464 H.A end
 2015 4414 a 2015 4414
a
SDict begin [/View [/XYZ H.V]/Dest (14.91.1) cvn /DEST pdfmark end
 2015 4414 a -2 4610 a
SDict begin H.S end
 -2 4610 a -2 4610 a
SDict begin 13 H.A end
 -2 4610 a
-2 4610 a
SDict begin [/View [/XYZ H.V]/Dest (0:5274) cvn /DEST pdfmark end
 -2 4610 a 396 4688 a Fj(When)20 b(I)h(set)g(out)f(to)g(write)
g(the)g(Guide,)g(we)g(were)g(still)i(debating)d(the)h(pros)f(and)h
(cons)g(of)g(forks)f(and)h(pull)g(requests)g(in)396 4796
y(the)g(\330MQ)h(community)-5 b(.)17 b(T)-7 b(oday)i(,)19
b(for)g(what)i(it')-5 b(s)21 b(w)o(orth,)e(this)i(ar)o(gument)d(seems)i
(settled:)h(the)f("liberal")g(polic)o(y)f(which)396 4904
y(we)i(adopted)d(for)i(libzmq)f(in)i(early)e(2012)g(brok)o(e)g(our)h
(dependenc)o(y)d(on)i(a)i(single)f(prime)g(author)m(,)e(and)i(opened)e
(the)396 5012 y(\003oor)i(to)g(dozens)f(of)h(ne)n(w)g(contrib)n(utors.)
e(More)i(profoundly)-5 b(,)16 b(it)21 b(allo)n(wed)f(us)g(to)g(mo)o(v)o
(e)f(to)i(a)f(gently)f(or)o(ganic)396 5120 y(e)n(v)n(olutionary)f
(model,)h(v)o(ery)g(dif)n(ferent)g(from)g(the)h(older)f(forced-march)e
(model.)p Black 3759 5569 a Fi(372)p Black eop end
%%Page: 373 387
TeXDict begin 373 386 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.373) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3228 -132 a Fi(Chapter)20 b(9.)g(P)-7 b(ostface)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5275) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(The)20 b(reason)g(I)g(w)o(as)h(con\002dent)e(this)h
(w)o(ould)g(w)o(ork)f(w)o(as)j(that)e(our)f(w)o(ork)h(on)g(the)g(Guide)
f(had,)h(for)f(a)i(year)f(or)g(more,)396 180 y(sho)n(wn)g(the)g(w)o(ay)
-5 b(.)20 b(T)m(rue,)f(the)h(te)o(xt)g(is)h(my)f(o)n(wn)g(w)o(ork,)f
(which)h(is)h(perhaps)e(as)i(it)g(should)e(be.)h(Writing)g(is)h(not)396
288 y(programming.)c(When)j(we)g(write,)g(we)h(tell)g(a)f(story)g(and)g
(one)g(doesn')o(t)e(w)o(ant)j(dif)n(ferent)d(v)n(oices)i(telling)g(one)
g(tale,)g(it)396 396 y(feels)h(strange.)-2 580 y
SDict begin H.S end
 -2 580
a -2 580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:5276) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(F)o(or)f(me)g(the)h
(real)f(long-term)e(v)n(alue)h(of)h(the)h(Guide)e(is)i(the)g
(repository)d(of)i(e)o(xamples:)f(about)g(65,000)f(lines)j(of)f(code)f
(in)396 778 y(24)h(dif)n(ferent)f(languages.)f(It')-5
b(s)21 b(partly)e(about)h(making)e(\330MQ)j(accessible)f(to)h(more)e
(people.)g(People)g(already)h(refer)f(to)396 886 y(the)h(Python)g(and)f
(PHP)i(e)o(xample)e(repositories)g(--)h(tw)o(o)h(of)e(the)i(most)f
(complete)f(--)h(when)g(the)o(y)f(w)o(ant)h(to)h(tell)g(others)396
994 y(ho)n(w)f(to)g(learn)g(\330MQ.)g(But)h(it')-5 b(s)21
b(also)g(about)e(learning)g(programming)d(languages.)-2
1178 y
SDict begin H.S end
 -2 1178 a -2 1178 a
SDict begin 13 H.A end
 -2 1178 a -2 1178 a
SDict begin [/View [/XYZ H.V]/Dest (0:5277) cvn /DEST pdfmark end
 -2 1178
a 396 1268 a Fj(Here')-5 b(s)21 b(a)f(loop)g(of)g(code)f(in)h(Tcl:)-2
1369 y
SDict begin H.S end
 -2 1369 a -2 1369 a
SDict begin 11.7 H.A end
 -2 1369 a -2 1369 a
SDict begin [/View [/XYZ H.V]/Dest (0:5278) cvn /DEST pdfmark end
 -2 1369
a 396 1448 a Fg(while)44 b({1})h({)576 1545 y(#)f(Process)g(all)g
(parts)g(of)h(the)f(message)576 1642 y(zmq)g(message)g(message)576
1740 y(frontend)f(recv_msg)h(message)576 1837 y(set)g(more)g([frontend)
f(getsockopt)h(RCVMORE])576 1934 y(backend)f(send_msg)h(message)f
([expr)h({$more?"SNDMORE":""}])576 2031 y(message)f(close)576
2128 y(if)h({!$more})g({)755 2225 y(break)g(;)h(#)f(Last)g(message)g
(part)576 2322 y(})396 2420 y(})-2 2594 y
SDict begin H.S end
 -2 2594 a -2
2594 a
SDict begin 13 H.A end
 -2 2594 a -2 2594 a
SDict begin [/View [/XYZ H.V]/Dest (0:5279) cvn /DEST pdfmark end
 -2 2594 a 396 2693 a Fj(And)20
b(the)g(same)h(loop)e(in)h(Lua:)-2 2794 y
SDict begin H.S end
 -2 2794 a -2
2794 a
SDict begin 11.7 H.A end
 -2 2794 a -2 2794 a
SDict begin [/View [/XYZ H.V]/Dest (0:5280) cvn /DEST pdfmark end
 -2 2794 a 396 2874 a Fg(while)44
b(true)g(do)576 2971 y(--)89 b(Process)44 b(all)g(parts)g(of)g(the)h
(message)576 3068 y(local)f(msg)g(=)h(frontend:recv\(\))576
3165 y(if)f(\(frontend:getopt\(zmq.RCVMORE\))c(==)45
b(1\))f(then)755 3262 y(backend:send\(msg,)e(zmq.SNDMORE\))576
3359 y(else)755 3456 y(backend:send\(msg,)g(0\))755 3554
y(break;)268 b(--)89 b(Last)44 b(message)g(part)576 3651
y(end)396 3748 y(end)-2 3915 y
SDict begin H.S end
 -2 3915 a -2 3915 a
SDict begin 13 H.A end
 -2
3915 a -2 3915 a
SDict begin [/View [/XYZ H.V]/Dest (0:5281) cvn /DEST pdfmark end
 -2 3915 a 396 4022 a Fj(And)20 b(this)h(particular)e
(e)o(xample)f(\(rrbrok)o(er\))g(is)j(in)f(C#,)g(C++,)h(CL,)g(Clojure,)e
(Erlang,)g(F#,)h(Go,)g(Hask)o(ell,)g(Hax)o(e,)g(Ja)n(v)n(a,)396
4130 y(Lua,)g(Node.js,)f(Perl,)i(PHP)-9 b(,)20 b(Python,)f(Ruby)-5
b(,)19 b(Scala,)h(Tcl,)g(and)g(of)g(course)f(C.)i(This)g(code)e(base,)h
(all)h(licensed)f(as)h(open)396 4238 y(source)f(under)f(the)h(MIT/X11,)
e(may)i(form)f(the)i(basis)f(for)g(other)f(books,)g(or)h(projects.)-2
4422 y
SDict begin H.S end
 -2 4422 a -2 4422 a
SDict begin 13 H.A end
 -2 4422 a -2 4422 a
SDict begin [/View [/XYZ H.V]/Dest (0:5282) cvn /DEST pdfmark end
 -2 4422
a 396 4512 a Fj(But)h(what)f(this)h(collection)e(of)h(translations)g
(says)g(most)g(profoundly)d(is)k(this:)g(the)f(language)f(you)g(choose)
g(is)i(a)g(detail,)396 4620 y(e)n(v)o(en)e(a)i(distraction.)e(The)h(po)
n(wer)f(of)h(\330MQ)g(lies)i(in)e(the)g(patterns)g(it)h(gi)n(v)o(es)e
(you)h(and)f(lets)i(you)f(b)n(uild,)f(and)h(these)396
4728 y(transcend)f(the)h(comings)f(and)h(goings)f(of)h(languages.)f(My)
h(goal)g(as)g(a)h(softw)o(are)f(and)f(social)i(architect)e(is)j(to)e(b)
n(uild)396 4835 y(structures)g(that)g(can)g(last)h(generations.)d
(There)i(seems)g(no)g(point)g(in)g(aiming)f(for)h(mere)g(decades.)-2
4864 y
SDict begin H.S end
 -2 4864 a -2 4864 a
SDict begin 13 H.A end
 -2 4864 a -2 4864 a
SDict begin [/View [/XYZ H.V]/Dest (0:5283) cvn /DEST pdfmark end
 -2 4864
a Black 3759 5569 a Fi(373)p Black eop end
%%Page: 374 388
TeXDict begin 374 387 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.374) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3228 -132 a Fi(Chapter)20 b(9.)g(P)-7 b(ostface)p
Black -2 94 a Fh(9.3.)39 b(Remo)m(ving)e(Friction)1535
94 y
SDict begin H.S end
 1535 94 a 1535 94 a
SDict begin 22.464 H.A end
 1535 94 a 1535 94 a
SDict begin [/View [/XYZ H.V]/Dest (14.92.1) cvn /DEST pdfmark end
 1535 94
a -2 292 a
SDict begin H.S end
 -2 292 a -2 292 a
SDict begin 13 H.A end
 -2 292 a -2 292 a
SDict begin [/View [/XYZ H.V]/Dest (0:5285) cvn /DEST pdfmark end
 -2 292
a 396 368 a Fj(I')o(ll)21 b(e)o(xplain)e(the)h(technical)f(tool)h
(chain)g(we)g(used)g(in)h(terms)f(of)g(the)g(friction)f(we)i(remo)o(v)o
(ed.)c(W)m(ith)k(the)f(Guide)g(we')l(re)396 476 y(telling)g(a)h(story)f
(and)f(the)h(goal)g(is)h(to)g(reach)e(as)i(man)o(y)e(people)g(as)i
(possible,)f(as)h(cheaply)e(and)g(smoothly)g(as)i(we)g(can.)-2
660 y
SDict begin H.S end
 -2 660 a -2 660 a
SDict begin 13 H.A end
 -2 660 a -2 660 a
SDict begin [/View [/XYZ H.V]/Dest (0:5286) cvn /DEST pdfmark end
 -2 660 a 396
750 a Fj(The)f(core)g(idea)g(w)o(as)h(to)f(host)g(the)h(Guide)e(on)h
(github)f(and)h(mak)o(e)f(it)i(easy)g(for)e(an)o(yone)f(to)j(contrib)n
(ute.)d(It)j(turned)e(out)g(to)396 858 y(be)h(more)g(comple)o(x)e(than)
i(that,)g(ho)n(we)n(v)o(er)-5 b(.)-2 1042 y
SDict begin H.S end
 -2 1042 a
-2 1042 a
SDict begin 13 H.A end
 -2 1042 a -2 1042 a
SDict begin [/View [/XYZ H.V]/Dest (0:5287) cvn /DEST pdfmark end
 -2 1042 a 396 1132 a Fj(Let')g(s)21
b(start)g(with)f(the)g(di)n(vision)g(of)g(labor)-5 b(.)19
b(I'm)h(a)g(good)f(writer)h(and)g(can)g(produce)e(endless)i(amounts)f
(of)h(decent)g(te)o(xt)396 1240 y(quickly)-5 b(.)18 b(But)j(what)f(w)o
(as)h(impossible)f(for)f(me)i(w)o(as)g(to)f(pro)o(vide)e(the)i(e)o
(xamples)f(in)i(other)e(languages.)g(Since)h(the)g(core)396
1348 y(\330MQ)h(API)f(is)h(in)g(C,)g(it)f(seemed)g(logical)g(to)g
(write)h(the)f(original)f(e)o(xamples)g(in)h(C.)h(Also,)g(C)g(is)g(a)f
(neutral)g(choice;)f(it')-5 b(s)396 1456 y(perhaps)19
b(the)h(only)g(language)e(that)j(doesn')o(t)d(create)i(strong)f
(emotions.)-2 1640 y
SDict begin H.S end
 -2 1640 a -2 1640 a
SDict begin 13 H.A end
 -2 1640 a -2
1640 a
SDict begin [/View [/XYZ H.V]/Dest (0:5288) cvn /DEST pdfmark end
 -2 1640 a 396 1730 a Fj(Ho)n(w)h(to)h(encourage)d(people)h(to)h
(mak)o(e)g(translations)f(of)h(the)g(e)o(xamples?)f(W)-7
b(e)22 b(tried)e(a)g(fe)n(w)g(approaches)f(and)g(\002nally)396
1838 y(what)h(w)o(ork)o(ed)f(best)i(w)o(as)g(to)f(of)n(fer)f(a)i
("choose)e(your)g(language")f(link)i(on)g(e)n(v)o(ery)f(single)h(e)o
(xample,)f(in)h(the)g(te)o(xt,)g(which)396 1946 y(took)g(people)f
(either)h(to)g(the)g(translation,)f(or)h(to)g(a)h(page)e(e)o(xplaining)
f(ho)n(w)i(the)o(y)g(could)f(contrib)n(ute.)f(The)i(w)o(ay)g(it)396
2053 y(usually)g(w)o(orks)g(is)h(that)f(as)h(people)e(learn)h(\330MQ)g
(in)h(their)f(preferred)d(language,)i(the)o(y)g(contrib)n(ute)g(a)i
(handful)d(of)396 2161 y(translations,)i(or)f(\002x)o(es)i(to)f(the)g
(e)o(xisting)g(ones.)-2 2345 y
SDict begin H.S end
 -2 2345 a -2 2345 a
SDict begin 13 H.A end
 -2
2345 a -2 2345 a
SDict begin [/View [/XYZ H.V]/Dest (0:5289) cvn /DEST pdfmark end
 -2 2345 a 396 2435 a Fj(At)h(the)f(same)h(time)f(I)g
(noticed)g(a)g(fe)n(w)g(people)f(quite)h(determinedly)e(translating)
2755 2435 y
SDict begin H.S end
 2755 2435 a 2755 2435 a
SDict begin 13 H.A end
 2755 2435 a 2755
2435 a
SDict begin [/View [/XYZ H.V]/Dest (0:5290) cvn /DEST pdfmark end
 2755 2435 a Fi(e)o(very)j(single)f Fj(e)o(xample.)e(This)j(w)o
(as)396 2543 y(mainly)f(binding)e(authors)h(who)h(realized)g(that)g
(the)g(e)o(xamples)f(were)h(a)h(great)e(w)o(ay)i(to)f(encourage)e
(people)h(to)h(use)h(their)396 2651 y(bindings.)e(F)o(or)h(their)g(ef)n
(forts,)f(I)h(e)o(xtended)e(the)i(scripts)h(to)f(produce)f
(language-speci\002c)e(v)o(ersions)i(of)h(the)h(Guide.)396
2759 y(Instead)f(of)g(including)e(the)i(C)h(code,)f(we')l(d)f(include)g
(the)i(Python,)d(or)i(PHP)h(code.)f(Lua)f(and)h(Hax)o(e)g(also)g(got)g
(their)396 2867 y(dedicated)f(Guides.)-2 3034 y
SDict begin H.S end
 -2 3034
a -2 3034 a
SDict begin 13 H.A end
 -2 3034 a -2 3034 a
SDict begin [/View [/XYZ H.V]/Dest (0:5291) cvn /DEST pdfmark end
 -2 3034 a 396 3141 a
Fj(Once)h(we)h(ha)n(v)o(e)e(an)h(idea)h(of)e(who)h(w)o(orks)g(on)g
(what,)g(we)g(kno)n(w)f(ho)n(w)h(to)g(structure)g(the)g(w)o(ork)f
(itself.)i(It')-5 b(s)21 b(clear)f(that)g(to)396 3249
y(write)g(and)g(test)g(an)g(e)o(xample,)e(what)i(you)f(w)o(ant)h(to)g
(w)o(ork)f(on)g(is)2245 3249 y
SDict begin H.S end
 2245 3249 a 2245 3249
a
SDict begin 13 H.A end
 2245 3249 a 2245 3249 a
SDict begin [/View [/XYZ H.V]/Dest (0:5292) cvn /DEST pdfmark end
 2245 3249 a Fi(sour)m(ce)h(code)p
Fj(.)f(So)h(we)g(import)f(this)h(source)f(code)g(when)396
3357 y(we)i(b)n(uild)f(the)g(Guide,)f(and)h(that')-5
b(s)21 b(ho)n(w)e(we)i(mak)o(e)e(language-speci\002c)f(v)o(ersions.)-2
3541 y
SDict begin H.S end
 -2 3541 a -2 3541 a
SDict begin 13 H.A end
 -2 3541 a -2 3541 a
SDict begin [/View [/XYZ H.V]/Dest (0:5293) cvn /DEST pdfmark end
 -2 3541
a 396 3631 a Fj(I)j(lik)o(e)f(to)g(write)h(in)f(a)h(plain)f(te)o(xt)g
(format.)e(It')-5 b(s)21 b(f)o(ast)g(and)f(w)o(orks)g(well)g(with)h
(source)e(control)g(systems)i(lik)o(e)f(git.)g(Since)396
3739 y(the)g(main)g(platform)f(for)h(our)f(websites)i(is)g(W)m(ikidot,)
e(I)h(write)h(using)e(W)m(ikidot')-5 b(s)20 b(v)o(ery)f(readable)g
(markup)g(format.)-2 3923 y
SDict begin H.S end
 -2 3923 a -2 3923 a
SDict begin 13 H.A end
 -2 3923
a -2 3923 a
SDict begin [/View [/XYZ H.V]/Dest (0:5294) cvn /DEST pdfmark end
 -2 3923 a 396 4013 a Fj(At)i(least)g(in)f(the)h(\002rst)f
(chapters,)g(it)h(w)o(as)g(important)d(to)j(dra)o(w)e(pictures)h(to)g
(e)o(xplain)f(the)h(\003o)n(w)g(of)g(messages)h(between)396
4121 y(peers.)f(I)g(found)f(Ditaa,)h(a)h(lo)o(v)o(ely)e(tool)h(that)g
(che)n(ws)g(up)g(line-dra)o(wings)e(and)h(spits)i(out)f(ele)o(gant)f
(graphics.)g(Ha)n(ving)g(the)396 4229 y(graphics)g(in)i(the)f(te)o(xt,)
g(as)h(te)o(xt,)e(mak)o(es)h(it)h(remarkably)d(easy)i(to)h(w)o(ork.)-2
4413 y
SDict begin H.S end
 -2 4413 a -2 4413 a
SDict begin 13 H.A end
 -2 4413 a -2 4413 a
SDict begin [/View [/XYZ H.V]/Dest (0:5295) cvn /DEST pdfmark end
 -2 4413
a 396 4503 a Fj(By)f(no)n(w)g(you')o(ll)e(realize)i(that)f(the)h(Guide)
f(toolchain)g(is)h(highly)f(customized,)f(though)g(it)i(uses)g(a)g(lot)
g(of)g(e)o(xternal)e(tools.)396 4611 y(All)j(are)f(a)n(v)n(ailable)g
(on)g(Ub)n(untu,)f(which)g(is)i(a)g(merc)o(y)-5 b(,)18
b(and)i(the)g(whole)g(toolchain)f(is)i(in)f(the)g(Guide)g(repository)e
(in)j(the)396 4718 y(bin)f(subdirectory)-5 b(.)-2 4902
y
SDict begin H.S end
 -2 4902 a -2 4902 a
SDict begin 13 H.A end
 -2 4902 a -2 4902 a
SDict begin [/View [/XYZ H.V]/Dest (0:5296) cvn /DEST pdfmark end
 -2 4902 a 396
4992 a Fj(Let')g(s)21 b(w)o(alk)f(through)e(the)j(editing)e(and)h
(publishing)e(process.)h(Here)i(is)g(ho)n(w)e(we)i(produce)d(the)i
(online)g(v)o(ersion:)p Black 3759 5569 a Fi(374)p Black
eop end
%%Page: 375 389
TeXDict begin 375 388 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.375) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3228 -132 a Fi(Chapter)20 b(9.)g(P)-7 b(ostface)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 11.7 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5297) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fg(bin/mkguide)-2 250 y
SDict begin H.S end
 -2 250 a -2 250
a
SDict begin 13 H.A end
 -2 250 a -2 250 a
SDict begin [/View [/XYZ H.V]/Dest (0:5298) cvn /DEST pdfmark end
 -2 250 a 396 346 a Fj(Which)20 b(w)o(orks)g(as)h
(follo)n(ws:)-2 347 y
SDict begin H.S end
 -2 347 a -2 347 a
SDict begin 13 H.A end
 -2 347 a -2 347
a
SDict begin [/View [/XYZ H.V]/Dest (0:5299) cvn /DEST pdfmark end
 -2 347 a -2 357 a
SDict begin H.S end
 -2 357 a -2 357 a
SDict begin 13 H.A end
 -2 357 a -2 357
a
SDict begin [/View [/XYZ H.V]/Dest (0:5300) cvn /DEST pdfmark end
 -2 357 a Black 396 517 a Fe(\225)p Black 479 517 a
SDict begin H.S end

479 517 a 479 517 a
SDict begin 13 H.A end
 479 517 a 479 517 a
SDict begin [/View [/XYZ H.V]/Dest (0:5301) cvn /DEST pdfmark end
 479 517 a Fj(The)f(original)f
(te)o(xt)h(sits)i(in)e(a)h(series)f(of)g(te)o(xt)g(\002les)i(\(one)d
(per)h(chapter\).)-2 535 y
SDict begin H.S end
 -2 535 a -2 535 a
SDict begin 13 H.A end
 -2 535 a
-2 535 a
SDict begin [/View [/XYZ H.V]/Dest (0:5302) cvn /DEST pdfmark end
 -2 535 a Black 396 666 a Fe(\225)p Black 479
666 a
SDict begin H.S end
 479 666 a 479 666 a
SDict begin 13 H.A end
 479 666 a 479 666 a
SDict begin [/View [/XYZ H.V]/Dest (0:5303) cvn /DEST pdfmark end
 479 666
a Fj(The)g(e)o(xamples)f(sit)i(in)g(the)f(e)o(xamples)f(subdirectory)-5
b(,)17 b(classi\002ed)k(per)f(language.)-2 684 y
SDict begin H.S end
 -2 684
a -2 684 a
SDict begin 13 H.A end
 -2 684 a -2 684 a
SDict begin [/View [/XYZ H.V]/Dest (0:5304) cvn /DEST pdfmark end
 -2 684 a Black 396 816 a
Fe(\225)p Black 479 816 a
SDict begin H.S end
 479 816 a 479 816 a
SDict begin 13 H.A end
 479 816
a 479 816 a
SDict begin [/View [/XYZ H.V]/Dest (0:5305) cvn /DEST pdfmark end
 479 816 a Fj(W)-7 b(e)22 b(tak)o(e)e(the)g(te)o(xt,)g(and)g
(processes)f(this)i(into)f(a)h(set)g(of)f(W)m(ikidot-ready)d(\002les.)k
(It)g(does)f(this)g(for)g(each)g(of)g(the)479 923 y(languages)f(that)h
(get)h(their)e(o)n(wn)h(Guide)g(v)o(ersion.)-2 941 y
SDict begin H.S end

-2 941 a -2 941 a
SDict begin 13 H.A end
 -2 941 a -2 941 a
SDict begin [/View [/XYZ H.V]/Dest (0:5306) cvn /DEST pdfmark end
 -2 941 a Black 396
1073 a Fe(\225)p Black 479 1073 a
SDict begin H.S end
 479 1073 a 479 1073
a
SDict begin 13 H.A end
 479 1073 a 479 1073 a
SDict begin [/View [/XYZ H.V]/Dest (0:5307) cvn /DEST pdfmark end
 479 1073 a Fj(W)-7 b(e)22 b(e)o(xtract)d(the)h
(graphics)f(and)h(calls)h(Ditaa)f(on)g(each)g(one)g(to)g(produce)e
(image)i(\002les,)h(which)e(it)i(stores)g(in)f(the)479
1181 y(images)g(subdirectory)-5 b(.)-2 1199 y
SDict begin H.S end
 -2 1199
a -2 1199 a
SDict begin 13 H.A end
 -2 1199 a -2 1199 a
SDict begin [/View [/XYZ H.V]/Dest (0:5308) cvn /DEST pdfmark end
 -2 1199 a Black 396 1330
a Fe(\225)p Black 479 1330 a
SDict begin H.S end
 479 1330 a 479 1330 a
SDict begin 13 H.A end
 479
1330 a 479 1330 a
SDict begin [/View [/XYZ H.V]/Dest (0:5309) cvn /DEST pdfmark end
 479 1330 a Fj(W)e(e)22 b(e)o(xtract)d(inline)h
(listings)h(\(which)e(are)h(not)g(translated\))f(and)h(stores)g(these)h
(in)f(the)g(listings)h(subdirectory)-5 b(.)-2 1348 y
SDict begin H.S end

-2 1348 a -2 1348 a
SDict begin 13 H.A end
 -2 1348 a -2 1348 a
SDict begin [/View [/XYZ H.V]/Dest (0:5310) cvn /DEST pdfmark end
 -2 1348 a Black
396 1480 a Fe(\225)p Black 479 1480 a
SDict begin H.S end
 479 1480 a 479
1480 a
SDict begin 13 H.A end
 479 1480 a 479 1480 a
SDict begin [/View [/XYZ H.V]/Dest (0:5311) cvn /DEST pdfmark end
 479 1480 a Fj(W)e(e)22 b(use)e(p)o
(ygmentize)e(on)i(each)g(e)o(xample)f(and)g(listing)i(to)f(create)g(a)h
(mark)o(ed-up)c(page)j(in)g(W)m(ikidot)g(format.)-2 1498
y
SDict begin H.S end
 -2 1498 a -2 1498 a
SDict begin 13 H.A end
 -2 1498 a -2 1498 a
SDict begin [/View [/XYZ H.V]/Dest (0:5312) cvn /DEST pdfmark end
 -2 1498 a Black
396 1629 a Fe(\225)p Black 479 1629 a
SDict begin H.S end
 479 1629 a 479
1629 a
SDict begin 13 H.A end
 479 1629 a 479 1629 a
SDict begin [/View [/XYZ H.V]/Dest (0:5313) cvn /DEST pdfmark end
 479 1629 a Fj(W)-7 b(e)22
b(upload)c(all)j(changed)e(\002les)i(to)f(the)g(Guide)g(wiki)g(using)g
(the)g(W)m(ikidot)g(API.)-2 1813 y
SDict begin H.S end
 -2 1813 a -2 1813
a
SDict begin 13 H.A end
 -2 1813 a -2 1813 a
SDict begin [/View [/XYZ H.V]/Dest (0:5314) cvn /DEST pdfmark end
 -2 1813 a 396 1903 a Fj(Doing)g(this)g(from)f
(scratch)h(tak)o(es)h(a)f(while.)g(So)h(we)f(store)h(the)f(SHA1)g
(signatures)f(of)h(e)n(v)o(ery)f(image,)h(listing,)g(e)o(xample,)396
2011 y(and)g(te)o(xt)g(\002le,)h(and)e(only)h(process)f(and)h(upload)f
(changes,)g(and)g(that)i(mak)o(es)f(it)g(easy)h(to)f(publish)f(a)i(ne)n
(w)f(v)o(ersion)f(of)h(the)396 2119 y(Guide)g(when)g(people)f(mak)o(e)g
(ne)n(w)h(contrib)n(utions.)-2 2303 y
SDict begin H.S end
 -2 2303 a -2 2303
a
SDict begin 13 H.A end
 -2 2303 a -2 2303 a
SDict begin [/View [/XYZ H.V]/Dest (0:5315) cvn /DEST pdfmark end
 -2 2303 a 396 2393 a Fj(T)-7 b(o)21
b(produce)d(the)i(PDF)h(and)f(Epub)f(formats)g(we)i(do)e(this:)-2
2494 y
SDict begin H.S end
 -2 2494 a -2 2494 a
SDict begin 11.7 H.A end
 -2 2494 a -2 2494 a
SDict begin [/View [/XYZ H.V]/Dest (0:5316) cvn /DEST pdfmark end
 -2 2494
a 396 2573 a Fg(bin/mkpdfs)-2 2751 y
SDict begin H.S end
 -2 2751 a -2 2751
a
SDict begin 13 H.A end
 -2 2751 a -2 2751 a
SDict begin [/View [/XYZ H.V]/Dest (0:5317) cvn /DEST pdfmark end
 -2 2751 a 396 2847 a Fj(Which)h(w)o(orks)g(as)h
(follo)n(ws:)-2 2848 y
SDict begin H.S end
 -2 2848 a -2 2848 a
SDict begin 13 H.A end
 -2 2848 a
-2 2848 a
SDict begin [/View [/XYZ H.V]/Dest (0:5318) cvn /DEST pdfmark end
 -2 2848 a -2 2858 a
SDict begin H.S end
 -2 2858 a -2 2858 a
SDict begin 13 H.A end
 -2
2858 a -2 2858 a
SDict begin [/View [/XYZ H.V]/Dest (0:5319) cvn /DEST pdfmark end
 -2 2858 a Black 396 3017 a Fe(\225)p
Black 479 3017 a
SDict begin H.S end
 479 3017 a 479 3017 a
SDict begin 13 H.A end
 479 3017 a 479
3017 a
SDict begin [/View [/XYZ H.V]/Dest (0:5320) cvn /DEST pdfmark end
 479 3017 a Fj(W)-7 b(e)22 b(use)e(the)g(mkbook)e(script)i(on)g
(all)h(the)f(input)g(\002les)h(to)f(produce)e(a)j(DocBook)e(output.)-2
3035 y
SDict begin H.S end
 -2 3035 a -2 3035 a
SDict begin 13 H.A end
 -2 3035 a -2 3035 a
SDict begin [/View [/XYZ H.V]/Dest (0:5321) cvn /DEST pdfmark end
 -2 3035
a Black 396 3167 a Fe(\225)p Black 479 3167 a
SDict begin H.S end
 479 3167
a 479 3167 a
SDict begin 13 H.A end
 479 3167 a 479 3167 a
SDict begin [/View [/XYZ H.V]/Dest (0:5322) cvn /DEST pdfmark end
 479 3167 a Fj(W)-7
b(e)22 b(push)d(the)h(DocBook)f(format)g(through)g(docbook2ps)e(and)i
(ps2pdf)g(to)h(create)g(clean)g(PDFs,)h(in)g(each)e(language.)-2
3185 y
SDict begin H.S end
 -2 3185 a -2 3185 a
SDict begin 13 H.A end
 -2 3185 a -2 3185 a
SDict begin [/View [/XYZ H.V]/Dest (0:5323) cvn /DEST pdfmark end
 -2 3185
a Black 396 3316 a Fe(\225)p Black 479 3316 a
SDict begin H.S end
 479 3316
a 479 3316 a
SDict begin 13 H.A end
 479 3316 a 479 3316 a
SDict begin [/View [/XYZ H.V]/Dest (0:5324) cvn /DEST pdfmark end
 479 3316 a Fj(W)-7
b(e)22 b(push)d(the)h(DocBook)f(format)g(though)g(db2epub)f(to)i
(create)g(Epub)f(books,)g(and)g(in)i(each)f(language.)-2
3334 y
SDict begin H.S end
 -2 3334 a -2 3334 a
SDict begin 13 H.A end
 -2 3334 a -2 3334 a
SDict begin [/View [/XYZ H.V]/Dest (0:5325) cvn /DEST pdfmark end
 -2 3334
a Black 396 3466 a Fe(\225)p Black 479 3466 a
SDict begin H.S end
 479 3466
a 479 3466 a
SDict begin 13 H.A end
 479 3466 a 479 3466 a
SDict begin [/View [/XYZ H.V]/Dest (0:5326) cvn /DEST pdfmark end
 479 3466 a Fj(W)-7
b(e)22 b(upload)c(the)j(PDFs)g(to)f(the)g(Guide)g(wiki)g(using)g(the)g
(W)m(ikidot)g(API.)-2 3650 y
SDict begin H.S end
 -2 3650 a -2 3650 a
SDict begin 13 H.A end
 -2 3650
a -2 3650 a
SDict begin [/View [/XYZ H.V]/Dest (0:5327) cvn /DEST pdfmark end
 -2 3650 a 396 3740 a Fj(It')-5 b(s)21 b(important,)d(when)i
(you)f(create)h(a)h(community)d(project,)h(to)h(lo)n(wer)g(the)g
("change)f(latenc)o(y",)g(i.e.)h(the)g(time)h(it)g(tak)o(es)396
3847 y(for)f(people)f(to)h(see)h(their)f(w)o(ork)f(li)n(v)o(e.)h(Or)h
(at)f(least,)h(to)f(see)h(that)f(you')l(v)o(e)e(accepted)h(their)h
(pull)g(request.)g(If)g(that)g(is)h(more)396 3955 y(than)f(a)h(day)e
(or)h(tw)o(o,)g(you')l(v)o(e)e(often)i(lost)g(your)f(contrib)n(utor')-5
b(s)19 b(interest.)-2 3984 y
SDict begin H.S end
 -2 3984 a -2 3984 a
SDict begin 13 H.A end
 -2 3984
a -2 3984 a
SDict begin [/View [/XYZ H.V]/Dest (0:5328) cvn /DEST pdfmark end
 -2 3984 a 359 x Fh(9.4.)39 b(Licensing)949
4343 y
SDict begin H.S end
 949 4343 a 949 4343 a
SDict begin 22.464 H.A end
 949 4343 a 949 4343 a
SDict begin [/View [/XYZ H.V]/Dest (14.93.1) cvn /DEST pdfmark end
 949
4343 a -2 4541 a
SDict begin H.S end
 -2 4541 a -2 4541 a
SDict begin 13 H.A end
 -2 4541 a -2 4541
a
SDict begin [/View [/XYZ H.V]/Dest (0:5330) cvn /DEST pdfmark end
 -2 4541 a 396 4617 a Fj(I)21 b(w)o(ant)f(people)f(to)h(reuse)g(the)h
(Guide)e(in)i(their)e(o)n(wn)h(w)o(ork:)g(in)g(presentations,)f
(articles,)h(and)g(e)n(v)o(en)f(other)g(books.)396 4725
y(Ho)n(we)n(v)o(er)m(,)f(the)j(deal)f(is)h(that)f(if)h(the)o(y)e(remix)
g(my)h(w)o(ork,)g(others)f(can)h(remix)g(theirs.)g(I')l(d)f(lik)o(e)i
(credit,)e(and)h(ha)n(v)o(e)f(no)396 4833 y(ar)o(gument)f(against)i
(others)f(making)g(mone)o(y)g(from)g(their)h(remix)o(es.)f(Thus,)g(the)
i(Guide)e(is)i(licensed)f(under)f(cc-by-sa.)p Black 3759
5569 a Fi(375)p Black eop end
%%Page: 376 390
TeXDict begin 376 389 bop -600 -600 a
SDict begin /product where{pop product(Distiller)search{pop pop pop
version(.)search{exch pop exch pop(3011)eq{gsave newpath 0 0 moveto
closepath clip/Courier findfont 10 scalefont setfont 72 72 moveto(.)show
grestore}if}{pop}ifelse}{pop}ifelse}if end
 -600 -600 a 0 TeXcolorgray
-611 -810 a
SDict begin H.S end
 -611 -810 a 0 TeXcolorgray 0 TeXcolorgray
-611 -810 a
SDict begin H.R end
 -611 -810 a -611 -810 a
SDict begin [/View [/XYZ H.V]/Dest (page.376) cvn /DEST pdfmark end
 -611 -810 a Black
Black 3228 -132 a Fi(Chapter)20 b(9.)g(P)-7 b(ostface)p
Black -2 -11 a
SDict begin H.S end
 -2 -11 a -2 -11 a
SDict begin 13 H.A end
 -2 -11 a -2 -11 a
SDict begin [/View [/XYZ H.V]/Dest (0:5331) cvn /DEST pdfmark end
 -2
-11 a 396 72 a Fj(F)o(or)20 b(the)g(e)o(xamples,)f(we)i(started)f(with)
g(GPL,)g(b)n(ut)h(it)g(rapidly)e(became)g(clear)h(this)h(w)o(asn')o(t)e
(w)o(orkable.)g(The)h(point)f(of)396 180 y(e)o(xamples)g(is)i(to)g(gi)n
(v)o(e)e(people)g(reusable)h(code)f(fragments)g(so)i(the)o(y)e(will)i
(use)f(\330MQ)h(more)e(widely)-5 b(,)19 b(and)h(if)g(these)h(are)396
288 y(GPL)g(that)f(w)o(on')o(t)f(happen.)g(W)-7 b(e)21
b(switched)f(to)g(MIT/X11,)f(e)n(v)o(en)g(for)h(the)g(lar)o(ger)f(and)g
(more)h(comple)o(x)e(e)o(xamples)h(that)396 396 y(concei)n(v)n(ably)f
(w)o(ould)i(w)o(ork)f(as)i(LGPL.)-2 580 y
SDict begin H.S end
 -2 580 a -2
580 a
SDict begin 13 H.A end
 -2 580 a -2 580 a
SDict begin [/View [/XYZ H.V]/Dest (0:5332) cvn /DEST pdfmark end
 -2 580 a 396 670 a Fj(Ho)n(we)n(v)o(er)e(when)g
(we)i(started)f(turning)f(the)h(e)o(xamples)f(into)h(stand-alone)e
(projects)i(\(as)h(with)f(Majordomo\),)d(we)k(used)396
778 y(the)f(LGPL.)h(Again,)e(remixability)f(trumps)i(dissemination.)e
(Licenses)j(are)f(tools,)g(use)g(them)g(with)g(intent,)g(not)396
886 y(ideology)-5 b(.)p Black 3757 5569 a Fi(376)p Black
eop end
%%Trailer

userdict /end-hook known{end-hook}if
%%EOF
